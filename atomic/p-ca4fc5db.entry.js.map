{"version":3,"names":["atomicIpxRefineModalCss","AtomicIpxRefineModalStyle0","AtomicIPXRefineModal","this","isOpen","collapseFacetsAfter","watchEnabled","host","querySelector","append","getClonedFacetElements","bindings","store","getFacetElements","interfaceElement","initialize","breadcrumbManager","buildBreadcrumbManager","engine","querySummary","buildQuerySummary","renderHeader","h","class","breadcrumbManagerState","hasBreadcrumbs","Button","onClick","deselectAll","style","text","i18n","t","renderBody","length","Hidden","slot","name","render","Host","key","RefineModalCommon","onClose","querySummaryState","title","openButton","boundary","scope","componentDidLoad","display","__decorate","InitializeBindings","BindStateToController"],"sources":["src/components/ipx/atomic-ipx-refine-modal/atomic-ipx-refine-modal.pcss?tag=atomic-ipx-refine-modal&encapsulation=shadow","src/components/ipx/atomic-ipx-refine-modal/atomic-ipx-refine-modal.tsx"],"sourcesContent":["@import '../../common/refine-modal/refine-modal-common.pcss';\r\n\r\n:host::part(container) {\r\n  @apply rounded;\r\n}\r\n","import {\r\n  BreadcrumbManager,\r\n  BreadcrumbManagerState,\r\n  buildBreadcrumbManager,\r\n  buildQuerySummary,\r\n  QuerySummary,\r\n  QuerySummaryState,\r\n} from '@coveo/headless';\r\nimport {Component, h, State, Prop, Element, Watch, Host} from '@stencil/core';\r\nimport {\r\n  BindStateToController,\r\n  InitializableComponent,\r\n  InitializeBindings,\r\n} from '../../../utils/initialization-utils';\r\nimport {Button} from '../../common/button';\r\nimport {Hidden} from '../../common/hidden';\r\nimport {\r\n  getClonedFacetElements,\r\n  RefineModalCommon,\r\n} from '../../common/refine-modal/refine-modal-common';\r\nimport {Bindings} from '../../search/atomic-search-interface/atomic-search-interface';\r\n\r\n/**\r\n * @internal\r\n */\r\n@Component({\r\n  tag: 'atomic-ipx-refine-modal',\r\n  styleUrl: 'atomic-ipx-refine-modal.pcss',\r\n  shadow: true,\r\n})\r\nexport class AtomicIPXRefineModal implements InitializableComponent {\r\n  @InitializeBindings() public bindings!: Bindings;\r\n  @Element() public host!: HTMLElement;\r\n\r\n  @BindStateToController('querySummary')\r\n  @State()\r\n  public querySummaryState!: QuerySummaryState;\r\n\r\n  @BindStateToController('breadcrumbManager')\r\n  @State()\r\n  public breadcrumbManagerState!: BreadcrumbManagerState;\r\n\r\n  @State()\r\n  public error!: Error;\r\n\r\n  @State()\r\n  public interfaceDimensions?: DOMRect;\r\n\r\n  @Prop({mutable: true}) openButton?: HTMLElement;\r\n\r\n  @Prop({reflect: true, mutable: true}) isOpen = false;\r\n\r\n  /**\r\n   * The number of expanded facets inside the refine modal.\r\n   * Remaining facets are automatically collapsed.\r\n   *\r\n   * Using the value `0` collapses all facets.\r\n   */\r\n  @Prop({reflect: true}) public collapseFacetsAfter = 0;\r\n\r\n  private breadcrumbManager!: BreadcrumbManager;\r\n  public querySummary!: QuerySummary;\r\n\r\n  @Watch('isOpen')\r\n  watchEnabled(isOpen: boolean) {\r\n    if (isOpen) {\r\n      if (!this.host.querySelector('div[slot=\"facets\"]')) {\r\n        this.host.append(\r\n          getClonedFacetElements(\r\n            this.bindings.store.getFacetElements(),\r\n            this.collapseFacetsAfter,\r\n            this.bindings.interfaceElement\r\n          )\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  public initialize() {\r\n    this.breadcrumbManager = buildBreadcrumbManager(this.bindings.engine);\r\n    this.querySummary = buildQuerySummary(this.bindings.engine);\r\n  }\r\n\r\n  private renderHeader() {\r\n    return (\r\n      <div class=\"w-full flex justify-between mb-3\">\r\n        {this.breadcrumbManagerState.hasBreadcrumbs && (\r\n          <Button\r\n            onClick={() => this.breadcrumbManager.deselectAll()}\r\n            style=\"text-primary\"\r\n            text={this.bindings.i18n.t('clear-all-filters')}\r\n            class=\"px-2 py-1\"\r\n          ></Button>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private renderBody() {\r\n    if (!this.bindings.store.getFacetElements().length) {\r\n      return <Hidden></Hidden>;\r\n    }\r\n\r\n    return (\r\n      <aside slot=\"body\" class=\"flex flex-col w-full adjust-for-scroll-bar\">\r\n        {this.renderHeader()}\r\n        <slot name=\"facets\"></slot>\r\n      </aside>\r\n    );\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <Host>\r\n        <RefineModalCommon\r\n          bindings={this.bindings}\r\n          host={this.host}\r\n          isOpen={this.isOpen}\r\n          onClose={() => (this.isOpen = false)}\r\n          querySummaryState={this.querySummaryState}\r\n          title={this.bindings.i18n.t('filters')}\r\n          openButton={this.openButton}\r\n          boundary=\"element\"\r\n          scope={this.bindings.interfaceElement}\r\n        >\r\n          {this.renderBody()}\r\n        </RefineModalCommon>\r\n      </Host>\r\n    );\r\n  }\r\n\r\n  public componentDidLoad() {\r\n    this.host.style.display = '';\r\n  }\r\n}\r\n"],"mappings":"2ZAAA,MAAMA,EAA0B,8muCAChC,MAAAC,EAAeD,E,iXC6BFE,EAAoB,M,yBAoBOC,KAAAC,OAAS,MAQjBD,KAAAE,oBAAsB,E,qKARL,M,yBAQK,C,CAMpD,YAAAC,CAAaF,GACX,GAAIA,EAAQ,CACV,IAAKD,KAAKI,KAAKC,cAAc,sBAAuB,CAClDL,KAAKI,KAAKE,OACRC,EACEP,KAAKQ,SAASC,MAAMC,mBACpBV,KAAKE,oBACLF,KAAKQ,SAASG,kB,GAOjB,UAAAC,GACLZ,KAAKa,kBAAoBC,EAAuBd,KAAKQ,SAASO,QAC9Df,KAAKgB,aAAeC,EAAkBjB,KAAKQ,SAASO,O,CAG9C,YAAAG,GACN,OACEC,EAAA,OAAKC,MAAM,oCACRpB,KAAKqB,uBAAuBC,gBAC3BH,EAACI,EAAM,CACLC,QAAS,IAAMxB,KAAKa,kBAAkBY,cACtCC,MAAM,eACNC,KAAM3B,KAAKQ,SAASoB,KAAKC,EAAE,qBAC3BT,MAAM,c,CAOR,UAAAU,GACN,IAAK9B,KAAKQ,SAASC,MAAMC,mBAAmBqB,OAAQ,CAClD,OAAOZ,EAACa,EAAM,K,CAGhB,OACEb,EAAA,SAAOc,KAAK,OAAOb,MAAM,8CACtBpB,KAAKkB,eACNC,EAAA,QAAMe,KAAK,W,CAKV,MAAAC,GACL,OACEhB,EAACiB,EAAI,CAAAC,IAAA,4CACHlB,EAACmB,EAAiB,CAAAD,IAAA,2CAChB7B,SAAUR,KAAKQ,SACfJ,KAAMJ,KAAKI,KACXH,OAAQD,KAAKC,OACbsC,QAAS,IAAOvC,KAAKC,OAAS,MAC9BuC,kBAAmBxC,KAAKwC,kBACxBC,MAAOzC,KAAKQ,SAASoB,KAAKC,EAAE,WAC5Ba,WAAY1C,KAAK0C,WACjBC,SAAS,UACTC,MAAO5C,KAAKQ,SAASG,kBAEpBX,KAAK8B,c,CAMP,gBAAAe,GACL7C,KAAKI,KAAKsB,MAAMoB,QAAU,E,mFArGCC,EAAA,CAA5BC,K,+BAKMD,EAAA,CAFNE,EAAsB,iB,wCAMhBF,EAAA,CAFNE,EAAsB,sB"}