{"version":3,"names":["atomicRelevanceInspectorCss","AtomicRelevanceInspectorStyle0","AtomicRelevanceInspector","this","open","render","h","key","exportparts","isOpen","close","_a","closeRelevanceInspector","emit","slot","class","Button","style","onClick","target","href","adminHref","extractEnvironmentFromPlatformURL","platformUrl","bindings","engine","state","configuration","fallbackEnv","platformUrlMatch","match","_b","groups","env","organizationEndpointMatch","_d","_c","organizationId","admin","getOrganizationEndpoints","searchResponseId","search"],"sources":["src/components/search/atomic-relevance-inspector/atomic-relevance-inspector.pcss?tag=atomic-relevance-inspector&encapsulation=shadow","src/components/search/atomic-relevance-inspector/atomic-relevance-inspector.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\n","import {PlatformEnvironment, getOrganizationEndpoints} from '@coveo/headless';\nimport {Component, h, Prop, Event, EventEmitter} from '@stencil/core';\nimport {Button} from '../../common/button';\nimport {Bindings} from '../atomic-search-interface/atomic-search-interface';\n\n/**\n * The `atomic-relevance-inspector` component is used internally to offer insight on search page relevance, as well as information to help troubleshoot issues during development.\n */\n@Component({\n  tag: 'atomic-relevance-inspector',\n  styleUrl: 'atomic-relevance-inspector.pcss',\n  shadow: true,\n})\nexport class AtomicRelevanceInspector {\n  /**\n   * The Atomic interface bindings, namely the headless search engine and i18n instances.\n   */\n  @Prop() bindings!: Bindings;\n\n  @Prop({reflect: true}) open = false;\n\n  @Event({eventName: 'atomic/relevanceInspector/close'})\n  closeRelevanceInspector: EventEmitter<null> | undefined;\n\n  public render() {\n    return (\n      <atomic-modal\n        exportparts=\"footer\"\n        isOpen={this.open}\n        close={() => {\n          this.closeRelevanceInspector?.emit();\n        }}\n      >\n        <p slot=\"header\">Open the relevance inspector</p>\n        <p slot=\"body\">\n          The Relevance Inspector will open in the Coveo Administration Console.\n        </p>\n        <div slot=\"footer\" class=\"w-full flex justify-end items-center\">\n          <Button\n            style=\"outline-primary\"\n            class=\"p-2 mr-2\"\n            onClick={() => this.closeRelevanceInspector?.emit()}\n          >\n            Ignore\n          </Button>\n          <a\n            class=\"btn-primary p-2\"\n            target=\"_blank\"\n            href={this.adminHref}\n            onClick={() => this.closeRelevanceInspector?.emit()}\n          >\n            Open\n          </a>\n        </div>\n      </atomic-modal>\n    );\n  }\n\n  private extractEnvironmentFromPlatformURL(): PlatformEnvironment {\n    const {platformUrl} = this.bindings.engine.state.configuration;\n    const fallbackEnv = 'prod';\n\n    const platformUrlMatch = platformUrl.match(\n      /^https:\\/\\/platform(?<env>dev|stg|hipaa)/\n    );\n\n    if (platformUrlMatch) {\n      return (\n        (platformUrlMatch.groups?.env as PlatformEnvironment) ?? fallbackEnv\n      );\n    }\n\n    const organizationEndpointMatch = platformUrl.match(\n      /^https:\\/\\/[a-z0-9]+\\.org(?<env>dev|stg|hipaa)/\n    );\n\n    if (organizationEndpointMatch) {\n      return (\n        (organizationEndpointMatch.groups?.env as PlatformEnvironment) ??\n        fallbackEnv\n      );\n    }\n\n    return fallbackEnv;\n  }\n\n  private get adminHref() {\n    const {organizationId} = this.bindings.engine.state.configuration;\n\n    const {admin} = getOrganizationEndpoints(\n      organizationId,\n      this.extractEnvironmentFromPlatformURL() as PlatformEnvironment\n    );\n    const {searchResponseId} = this.bindings.engine.state.search;\n    return `${admin}/admin/#/${organizationId}/search/relevanceInspector/${searchResponseId}`;\n  }\n}\n"],"mappings":"6LAAA,MAAMA,EAA8B,w+tCACpC,MAAAC,EAAeD,E,MCYFE,EAAwB,M,kGAMZC,KAAAC,KAAO,M,kCAAA,K,CAKvB,MAAAC,GACL,OACEC,EAAA,gBAAAC,IAAA,2CACEC,YAAY,SACZC,OAAQN,KAAKC,KACbM,MAAO,K,OACLC,EAAAR,KAAKS,2BAAuB,MAAAD,SAAA,SAAAA,EAAEE,MAAM,GAGtCP,EAAA,KAAAC,IAAA,2CAAGO,KAAK,UAAQ,gCAChBR,EAAA,KAAAC,IAAA,2CAAGO,KAAK,QAAM,0EAGdR,EAAA,OAAAC,IAAA,2CAAKO,KAAK,SAASC,MAAM,wCACvBT,EAACU,EAAM,CAAAT,IAAA,2CACLU,MAAM,kBACNF,MAAM,WACNG,QAAS,SAAAP,EAAM,OAAAA,EAAAR,KAAKS,2BAAuB,MAAAD,SAAA,SAAAA,EAAEE,MAAM,aAIrDP,EAAA,KAAAC,IAAA,2CACEQ,MAAM,kBACNI,OAAO,SACPC,KAAMjB,KAAKkB,UACXH,QAAS,SAAAP,EAAM,OAAAA,EAAAR,KAAKS,2BAAuB,MAAAD,SAAA,SAAAA,EAAEE,MAAM,Y,CASrD,iCAAAS,G,YACN,MAAMC,YAACA,GAAepB,KAAKqB,SAASC,OAAOC,MAAMC,cACjD,MAAMC,EAAc,OAEpB,MAAMC,EAAmBN,EAAYO,MACnC,4CAGF,GAAID,EAAkB,CACpB,OACEE,GAACpB,EAAAkB,EAAiBG,UAAM,MAAArB,SAAA,SAAAA,EAAEsB,OAA2B,MAAAF,SAAA,EAAAA,EAAIH,C,CAI7D,MAAMM,EAA4BX,EAAYO,MAC5C,kDAGF,GAAII,EAA2B,CAC7B,OACEC,GAACC,EAAAF,EAA0BF,UAAM,MAAAI,SAAA,SAAAA,EAAEH,OAA2B,MAAAE,SAAA,EAAAA,EAC9DP,C,CAIJ,OAAOA,C,CAGT,aAAYP,GACV,MAAMgB,eAACA,GAAkBlC,KAAKqB,SAASC,OAAOC,MAAMC,cAEpD,MAAMW,MAACA,GAASC,EACdF,EACAlC,KAAKmB,qCAEP,MAAMkB,iBAACA,GAAoBrC,KAAKqB,SAASC,OAAOC,MAAMe,OACtD,MAAO,GAAGH,aAAiBD,+BAA4CG,G"}