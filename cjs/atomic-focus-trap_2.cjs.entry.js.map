{"file":"atomic-focus-trap.atomic-modal.entry.cjs.js","mappings":"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","names":["getParent","isAncestorOf","defer","getFirstFocusableDescendant","getFocusedElement","randomID","once","updateBreakpoints","isIOS","listenOnce","h","Host","InitializeBindings"],"sources":["src/components/common/atomic-focus-trap.tsx","src/components/common/atomic-modal/atomic-modal.pcss?tag=atomic-modal&encapsulation=shadow","src/components/common/atomic-modal/atomic-modal.tsx"],"sourcesContent":["import {Component, Element, Listen, Prop, Watch} from '@stencil/core';\r\nimport {getFirstFocusableDescendant} from '../../utils/accessibility-utils';\r\nimport {\r\n  isAncestorOf,\r\n  defer,\r\n  getFocusedElement,\r\n  getParent,\r\n} from '../../utils/utils';\r\n\r\n/**\r\n * @internal\r\n */\r\n@Component({\r\n  tag: 'atomic-focus-trap',\r\n  shadow: false,\r\n})\r\nexport class AtomicFocusTrap {\r\n  @Element() private host!: HTMLElement;\r\n  @Prop() public active = false;\r\n  /**\r\n   * The source to focus when the focus trap becomes inactive.\r\n   */\r\n  @Prop({mutable: true}) source?: HTMLElement;\r\n  /**\r\n   * The container to hide from the tabindex and accessibility DOM when the focus trap is inactive.\r\n   */\r\n  @Prop({mutable: true}) container?: HTMLElement;\r\n\r\n  /**\r\n   * Whether the element should be hidden from screen readers & not interactive with the tab, when not active.\r\n   */\r\n  @Prop() shouldHideSelf = true;\r\n\r\n  /**\r\n   * The common ancestor of the focus trap and of all the elements that should be inaccessible when inside the focus trap.\r\n   */\r\n  @Prop() scope = document.body;\r\n\r\n  private readonly hiddenElements: Element[] = [];\r\n\r\n  hide(element: Element) {\r\n    // aria-hidden -> already hidden\r\n    // aria-live or atomic-aria-live -> must not be hidden otherwise it won't announce dynamic changes in the live region\r\n    if (\r\n      element.hasAttribute('aria-hidden') ||\r\n      element.hasAttribute('aria-live') ||\r\n      element.tagName.toLowerCase() === 'atomic-aria-live'\r\n    ) {\r\n      return;\r\n    }\r\n    element.setAttribute('aria-hidden', 'true');\r\n    this.hiddenElements.push(element);\r\n  }\r\n\r\n  showAll() {\r\n    let el: Element | undefined;\r\n    while ((el = this.hiddenElements.pop())) {\r\n      el.removeAttribute('aria-hidden');\r\n    }\r\n  }\r\n\r\n  hideSiblingsRecursively(element: Element | ShadowRoot) {\r\n    const parent = getParent(element);\r\n    if (parent === null) {\r\n      return;\r\n    }\r\n    Array.from(parent.children as HTMLCollection).forEach((sibling) => {\r\n      if (sibling === element) {\r\n        return;\r\n      }\r\n      if (\r\n        sibling.assignedSlot &&\r\n        isAncestorOf(this.host, sibling.assignedSlot)\r\n      ) {\r\n        return;\r\n      }\r\n      this.hide(sibling);\r\n    });\r\n    if (parent !== this.scope) {\r\n      this.hideSiblingsRecursively(parent);\r\n    }\r\n  }\r\n\r\n  showSelf() {\r\n    this.parentToHide.removeAttribute('aria-hidden');\r\n    this.parentToHide.removeAttribute('tabindex');\r\n  }\r\n\r\n  hideSelf() {\r\n    if (this.shouldHideSelf) {\r\n      this.parentToHide.setAttribute('aria-hidden', 'true');\r\n      this.parentToHide.setAttribute('tabindex', '-1');\r\n    }\r\n  }\r\n\r\n  async onDeactivated(isInitialLoad: boolean) {\r\n    this.showAll();\r\n    if (!isInitialLoad) {\r\n      await defer();\r\n      this.source?.focus();\r\n    }\r\n    this.hideSelf();\r\n  }\r\n\r\n  async onActivated(isInitialLoad: boolean) {\r\n    this.showSelf();\r\n    if (!isInitialLoad) {\r\n      await defer();\r\n      getFirstFocusableDescendant(this.host)?.focus();\r\n    }\r\n    this.hideSiblingsRecursively(this.host);\r\n  }\r\n\r\n  @Watch('active')\r\n  async activeChanged(active: boolean, wasActive: boolean) {\r\n    const isInitialLoad = active === wasActive;\r\n    if (active) {\r\n      await this.onActivated(isInitialLoad);\r\n    } else {\r\n      await this.onDeactivated(isInitialLoad);\r\n    }\r\n  }\r\n\r\n  @Listen('focusin', {target: 'document'})\r\n  onFocusChanged(e: FocusEvent) {\r\n    const elementIsPartOfHost = (focusedElement: Element | ShadowRoot) =>\r\n      isAncestorOf(this.host, focusedElement);\r\n\r\n    const elementIsPartOfScope = (focusedElement: Element | ShadowRoot) =>\r\n      isAncestorOf(this.scope, focusedElement);\r\n\r\n    if (!e.target || !this.active) {\r\n      return;\r\n    }\r\n\r\n    const focusedElement = getFocusedElement();\r\n\r\n    if (\r\n      focusedElement &&\r\n      (elementIsPartOfHost(focusedElement) ||\r\n        !elementIsPartOfScope(focusedElement))\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    getFirstFocusableDescendant(this.host)?.focus();\r\n  }\r\n\r\n  connectedCallback() {\r\n    this.activeChanged(this.active, this.active);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    this.showAll();\r\n  }\r\n\r\n  private get parentToHide() {\r\n    return this.container ?? this.host;\r\n  }\r\n}\r\n","@import '../../../global/global.pcss';\r\n\r\n[part='backdrop'] {\r\n  @apply pointer-events-none;\r\n}\r\n\r\natomic-focus-trap {\r\n  @apply contents;\r\n}\r\n\r\n[part='container'] {\r\n  @apply overflow-hidden;\r\n  grid-area: modal;\r\n}\r\n\r\n.animate-scaleUpModalIPX[part='container'] {\r\n  @apply rounded shadow;\r\n}\r\n\r\n:host(.open) {\r\n  [part='backdrop'] {\r\n    @apply pointer-events-auto;\r\n  }\r\n}\r\n\r\n:host(.open.dialog) {\r\n  [part='backdrop'] {\r\n    background-color: rgba(40, 40, 40, 0.8);\r\n  }\r\n}\r\n\r\n:host(.dialog) {\r\n  [part='backdrop'] {\r\n    @apply grid p-6;\r\n    transition: background-color 500ms ease-in-out;\r\n\r\n    grid-template-areas:\r\n      '. .     .'\r\n      '. modal .'\r\n      '. .     .';\r\n\r\n    grid-template-columns: 1fr min(30rem, 100%) 1fr;\r\n    grid-template-rows: 1fr auto 3fr;\r\n  }\r\n\r\n  [part='container'] {\r\n    @apply rounded shadow;\r\n  }\r\n\r\n  [part='header-wrapper'] {\r\n    @apply px-6 py-4;\r\n  }\r\n\r\n  [part='header'] {\r\n    @apply font-bold;\r\n  }\r\n\r\n  [part='body-wrapper'] {\r\n    @apply p-6;\r\n  }\r\n\r\n  [part='footer-wrapper'] {\r\n    @apply bg-neutral-light;\r\n    padding: 1rem 1.125rem;\r\n  }\r\n}\r\n\r\n:host(.fullscreen) {\r\n  [part='container'] {\r\n    @apply absolute inset-0;\r\n  }\r\n\r\n  [part='header-wrapper'] {\r\n    @apply p-6;\r\n  }\r\n\r\n  [part='body-wrapper'] {\r\n    @apply px-6 pt-8 pb-5;\r\n  }\r\n\r\n  [part='footer-wrapper'] {\r\n    @apply shadow-t-lg px-6 py-4;\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  h,\r\n  State,\r\n  Prop,\r\n  Element,\r\n  Watch,\r\n  Event,\r\n  EventEmitter,\r\n  Host,\r\n  Listen,\r\n} from '@stencil/core';\r\nimport {isIOS} from '../../../utils/device-utils';\r\nimport {listenOnce} from '../../../utils/event-utils';\r\nimport {\r\n  InitializableComponent,\r\n  InitializeBindings,\r\n} from '../../../utils/initialization-utils';\r\nimport {updateBreakpoints} from '../../../utils/replace-breakpoint';\r\nimport {once, randomID} from '../../../utils/utils';\r\nimport {AnyBindings} from '../interface/bindings';\r\n\r\n/**\r\n * When the modal is opened, the class `atomic-modal-opened` is added to the interfaceElement and the body, allowing further customization.\r\n *\r\n * @part backdrop - The transparent backdrop hiding the content behind the modal.\r\n * @part container - The modal's outermost container with the outline and background.\r\n * @part header-wrapper - The wrapper around the header.\r\n * @part header - The header at the top of the modal.\r\n * @part header-ruler - The horizontal ruler underneath the header.\r\n * @part body-wrapper - The wrapper around the body.\r\n * @part body - The body of the modal, between the header and the footer.\r\n * @part footer-wrapper - The wrapper with a shadow or background color around the footer.\r\n * @part footer - The footer at the bottom of the modal.\r\n * @internal\r\n */\r\n@Component({\r\n  tag: 'atomic-modal',\r\n  styleUrl: 'atomic-modal.pcss',\r\n  shadow: true,\r\n})\r\nexport class AtomicModal implements InitializableComponent<AnyBindings> {\r\n  @InitializeBindings() public bindings!: AnyBindings;\r\n  @Element() public host!: HTMLElement;\r\n\r\n  @State() public error!: Error;\r\n\r\n  @Prop({reflect: true, mutable: true}) fullscreen = false;\r\n  @Prop({mutable: true}) source?: HTMLElement;\r\n  /**\r\n   * The container to hide from the tabindex and accessibility DOM when the modal is closed.\r\n   */\r\n  @Prop({mutable: true}) container?: HTMLElement;\r\n  @Prop({reflect: true, mutable: true}) isOpen = false;\r\n  @Prop({mutable: true}) close: () => void = () => (this.isOpen = false);\r\n  @Prop({reflect: true}) scope?: HTMLElement;\r\n  /**\r\n   * Whether to display the open and close animations over the entire page or the atomic-modal only.\r\n   */\r\n  @Prop({reflect: true}) boundary: 'page' | 'element' = 'page';\r\n\r\n  @Event() animationEnded!: EventEmitter<never>;\r\n\r\n  private wasEverOpened = false;\r\n  private headerId = randomID('atomic-modal-header-');\r\n  private focusTrap?: HTMLAtomicFocusTrapElement;\r\n  private animatableContainer?: HTMLElement;\r\n  private currentWatchToggleOpenExecution = 0;\r\n\r\n  @Watch('isOpen')\r\n  async watchToggleOpen(isOpen: boolean) {\r\n    const watchToggleOpenExecution = ++this.currentWatchToggleOpenExecution;\r\n    const modalOpenedClass = 'atomic-modal-opened';\r\n\r\n    if (isOpen) {\r\n      this.wasEverOpened = true;\r\n      //TODO: remove the addition of a class to the body in atomicV3\r\n      document.body.classList.add(modalOpenedClass);\r\n      this.bindings.interfaceElement.classList.add(modalOpenedClass);\r\n      await this.waitForAnimationEnded();\r\n      if (watchToggleOpenExecution !== this.currentWatchToggleOpenExecution) {\r\n        return;\r\n      }\r\n      this.focusTrap!.active = true;\r\n    } else {\r\n      //TODO: remove the removal of a class to the body in atomicV3\r\n      document.body.classList.remove(modalOpenedClass);\r\n      this.bindings.interfaceElement.classList.remove(modalOpenedClass);\r\n      if (isIOS()) {\r\n        await this.waitForAnimationEnded();\r\n      }\r\n      if (watchToggleOpenExecution !== this.currentWatchToggleOpenExecution) {\r\n        return;\r\n      }\r\n      this.focusTrap!.active = false;\r\n    }\r\n  }\r\n\r\n  @Listen('keyup', {target: 'body'})\r\n  handleCloseOnEscape(e: KeyboardEvent) {\r\n    if (e.key?.toLowerCase() === 'escape') {\r\n      this.close();\r\n    }\r\n  }\r\n\r\n  private waitForAnimationEnded() {\r\n    // The focus trap focuses its first child when active. It cannot do that while an animation is ongoing.\r\n    return new Promise((resolve) =>\r\n      listenOnce(this.animatableContainer!, 'animationend', resolve)\r\n    );\r\n  }\r\n\r\n  private getClasses() {\r\n    const classes: string[] = [];\r\n    if (this.isOpen) {\r\n      classes.push('open');\r\n    }\r\n    if (this.fullscreen) {\r\n      classes.push('fullscreen');\r\n    } else {\r\n      classes.push('dialog');\r\n    }\r\n    return classes;\r\n  }\r\n\r\n  @Listen('touchmove', {passive: false})\r\n  onWindowTouchMove(e: Event) {\r\n    this.isOpen && e.preventDefault();\r\n  }\r\n\r\n  public componentDidLoad() {\r\n    this.watchToggleOpen(this.isOpen);\r\n  }\r\n\r\n  private updateBreakpoints = once(() => updateBreakpoints(this.host));\r\n\r\n  public render() {\r\n    this.updateBreakpoints();\r\n\r\n    const Content = () => (\r\n      <article\r\n        part=\"container\"\r\n        class={`flex flex-col justify-between bg-background text-on-background\r\n          ${this.isOpen ? 'animate-scaleUpModal' : 'animate-slideDownModal'}\r\n          ${this.wasEverOpened ? '' : 'invisible'}`}\r\n        onAnimationEnd={() => this.animationEnded.emit()}\r\n        ref={(ref) => (this.animatableContainer = ref)}\r\n      >\r\n        <header part=\"header-wrapper\" class=\"flex flex-col items-center\">\r\n          <div\r\n            part=\"header\"\r\n            class=\"flex justify-between text-xl w-full max-w-lg\"\r\n            id={this.headerId}\r\n          >\r\n            <slot name=\"header\"></slot>\r\n          </div>\r\n        </header>\r\n        <hr part=\"header-ruler\" class=\"border-neutral\"></hr>\r\n        <div\r\n          part=\"body-wrapper\"\r\n          class=\"overflow-auto grow flex flex-col items-center w-full\"\r\n        >\r\n          <div\r\n            part=\"body\"\r\n            class=\"w-full max-w-lg\"\r\n            ref={(element) =>\r\n              element?.addEventListener(\r\n                'touchmove',\r\n                (e) => this.isOpen && e.stopPropagation(),\r\n                {passive: false}\r\n              )\r\n            }\r\n          >\r\n            <slot name=\"body\"></slot>\r\n          </div>\r\n        </div>\r\n        <footer\r\n          part=\"footer-wrapper\"\r\n          class=\"border-neutral border-t bg-background z-10 flex flex-col items-center w-full\"\r\n        >\r\n          <div part=\"footer\" class=\"w-full max-w-lg\">\r\n            <slot name=\"footer\"></slot>\r\n          </div>\r\n        </footer>\r\n      </article>\r\n    );\r\n\r\n    return (\r\n      <Host class={this.getClasses().join(' ')}>\r\n        <div\r\n          part=\"backdrop\"\r\n          class={`\r\n            ${this.boundary === 'page' ? 'fixed' : 'absolute'}\r\n            left-0 top-0 right-0 bottom-0 z-[9999]\r\n          `}\r\n          onClick={(e) => e.target === e.currentTarget && this.close()}\r\n        >\r\n          <atomic-focus-trap\r\n            role=\"dialog\"\r\n            aria-modal={this.isOpen.toString()}\r\n            aria-labelledby={this.headerId}\r\n            source={this.source}\r\n            container={this.container ?? this.host}\r\n            ref={(ref) => (this.focusTrap = ref)}\r\n            scope={this.scope}\r\n          >\r\n            <Content />\r\n          </atomic-focus-trap>\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"version":3}