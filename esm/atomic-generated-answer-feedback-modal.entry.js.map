{"file":"atomic-generated-answer-feedback-modal.entry.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAM,qCAAqC,GAAG,u+tCAAu+tC,CAAC;AACthuC,iDAAe,qCAAqC;;;;;;;;;;;;MC8BvC,kCAAkC;;;;;;;QASP,WAAM,GAAG,KAAK,CAAC;QAQ5C,sBAAiB,GAAY,KAAK,CAAC;QAE3B,WAAM,GAAG,QAAQ,CAChC,8CAA8C,CAC/C,CAAC;QA0DM,sBAAiB,GAAG,IAAI,CAAC,MAAM,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;sBAtEtB,KAAK;;;;iCAQd,KAAK;;IAU3C,eAAe,CAAC,MAAe;QAC7B,IAAI,MAAM,EAAE;YACV,IAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,CAAC;SAC1C;KACF;IAkCO,SAAS,CAAC,MAAe;QAC/B,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;KACtB;IAEO,KAAK;QACX,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;QAC/B,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,IAAI,CAAC,eAAe,CAAC,KAAK,GAAG,EAAE,CAAC;SACjC;QACD,IAAI,CAAC,aAAa,GAAG,SAAS,CAAC;QAC/B,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACtB,IAAI,CAAC,eAAe,CAAC,kBAAkB,EAAE,CAAC;KAC3C;IAIO,gBAAgB,CAAC,MAA0C;QACjE,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC;KAC7B;IAEM,YAAY;QACjB,IAAI,IAAI,CAAC,aAAa,KAAK,OAAO,EAAE;YAClC,IAAI,CAAC,eAAe,CAAC,oBAAoB,CAAC,IAAI,CAAC,eAAgB,CAAC,KAAK,CAAC,CAAC;SACxE;aAAM;YACL,IAAI,CAAC,eAAe,CAAC,YAAY,CAC/B,IAAI,CAAC,aAAwC,CAC9C,CAAC;SACH;QACD,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;KAC1B;IAEO,YAAY;QAClB,QACE,WACE,IAAI,EAAC,QAAQ,EACb,IAAI,EAAC,cAAc,EACnB,KAAK,EAAC,0CAA0C,IAEhD,cAAK,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,CAAM,EAC3C,EAAC,UAAU,IACT,KAAK,EAAC,kBAAkB,EACxB,KAAK,EAAC,qBAAqB,EAC3B,OAAO,EAAE,MAAM,IAAI,CAAC,KAAK,EAAE,EAC3B,IAAI,EAAE,SAAS,EACf,UAAU,EAAE,OAAO,EACnB,SAAS,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,YAAY,CAAC,GAC7C,CACE,EACN;KACH;IAEO,aAAa;QACnB,QACE,oBACE,cAAQ,IAAI,EAAC,cAAc,EAAC,KAAK,EAAC,WAAW,IAC1C,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,wCAAwC,CAAC,CACxD,EACR,kCAAkC,CAAC,OAAO,CAAC,GAAG,CAC7C,CAAC,EAAC,EAAE,EAAE,SAAS,EAAE,mBAAmB,EAAC,MACnC,WACE,KAAK,EAAE,qBAAqB,mBAAmB,qCAAqC,EACpF,GAAG,EAAE,EAAE,EACP,IAAI,EAAC,QAAQ,IAEb,aACE,IAAI,EAAC,cAAc,EACnB,IAAI,EAAC,OAAO,EACZ,IAAI,EAAC,QAAQ,EACb,EAAE,EAAE,EAAE,EACN,OAAO,EAAE,IAAI,CAAC,aAAa,KAAK,mBAAmB,EACnD,QAAQ,EAAE,CAAC,CAAC;;gBACV,OAAA,CAAA,MAAC,CAAC,CAAC,aAAyC,0CAAE,OAAO;oBACrD,IAAI,CAAC,gBAAgB,CAAC,mBAAmB,CAAC,CAAA;aAAA,EAE5C,KAAK,EAAC,MAAM,EACZ,QAAQ,SACR,EACF,aAAO,IAAI,EAAC,cAAc,EAAC,OAAO,EAAE,EAAE,IACnC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,CAC1B,CACJ,CACP,CACF,CACQ,EACX;KACH;IAEO,aAAa;QACnB,IAAI,IAAI,CAAC,aAAa,KAAK,OAAO,EAAE;YAClC,OAAO;SACR;QAED,QACE,oBACE,gBACE,IAAI,EAAC,eAAe,EACpB,IAAI,EAAC,gBAAgB,EACrB,GAAG,EAAE,CAAC,YAAY,MAAM,IAAI,CAAC,eAAe,GAAG,YAAY,CAAC,EAC5D,KAAK,EAAC,+EAA+E,EACrF,IAAI,EAAE,CAAC,EACP,WAAW,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,aAAa,CAAC,EAChD,QAAQ,SACE,CACH,EACX;KACH;IAEO,UAAU;QAChB,OAAO,CAAC,IAAI,CAAC,iBAAiB,IAC5B,YACE,IAAI,EAAC,MAAM,EACX,EAAE,EAAE,IAAI,CAAC,MAAM,EACf,IAAI,EAAC,MAAM,EACX,QAAQ,EAAE,CAAC,CAAC;gBACV,CAAC,CAAC,cAAc,EAAE,CAAC;gBACnB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;gBAC9B,IAAI,CAAC,YAAY,EAAE,CAAC;aACrB,EACD,KAAK,EAAC,+DAA+D,IAEpE,IAAI,CAAC,aAAa,EAAE,EACpB,IAAI,CAAC,aAAa,EAAE,CAChB,KAEP,WAAK,IAAI,EAAC,MAAM,EAAC,KAAK,EAAC,uCAAuC,IAC5D,mBAAa,IAAI,EAAE,OAAO,EAAE,KAAK,EAAC,MAAM,GAAG,EAC3C,SAAG,KAAK,EAAC,WAAW,IACjB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,mCAAmC,CAAC,CACxD,CACA,CACP,CAAC;KACH;IAEO,YAAY;QAClB,QACE,WAAK,IAAI,EAAC,QAAQ,EAAC,IAAI,EAAC,aAAa,IAClC,CAAC,IAAI,CAAC,iBAAiB,IACtB,WAAK,IAAI,EAAC,SAAS,EAAC,KAAK,EAAC,6BAA6B,IACrD,EAAC,MAAM,IACL,IAAI,EAAC,eAAe,EACpB,KAAK,EAAC,iBAAiB,EACvB,KAAK,EAAC,wDAAwD,EAC9D,SAAS,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,EACxC,OAAO,EAAE,MAAM,IAAI,CAAC,KAAK,EAAE,IAE1B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,CACvB,EACT,EAAC,MAAM,IACL,IAAI,EAAC,eAAe,EACpB,KAAK,EAAC,SAAS,EACf,IAAI,EAAC,QAAQ,EACb,IAAI,EAAE,IAAI,CAAC,MAAM,EACjB,KAAK,EAAC,2CAA2C,EACjD,SAAS,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,eAAe,CAAC,IAE/C,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,eAAe,CAAC,CAC/B,CACL,KAEN,WAAK,IAAI,EAAC,SAAS,EAAC,KAAK,EAAC,4BAA4B,IACpD,EAAC,MAAM,IACL,IAAI,EAAC,eAAe,EACpB,KAAK,EAAC,SAAS,EACf,OAAO,EAAE,MAAM,IAAI,CAAC,KAAK,EAAE,EAC3B,KAAK,EAAC,2CAA2C,EACjD,SAAS,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,YAAY,CAAC,IAE5C,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,YAAY,CAAC,CAC5B,CACL,CACP,CACG,EACN;KACH;IAEM,MAAM;QACX,IAAI,CAAC,iBAAiB,EAAE,CAAC;QAEzB,QACE,qEACE,UAAU,EAAE,KAAK,EACjB,MAAM,EAAE,IAAI,CAAC,MAAM,EACnB,KAAK,EAAE,MAAM,IAAI,CAAC,KAAK,EAAE,EACzB,SAAS,EAAE,IAAI,CAAC,IAAI,EACpB,WAAW,EAAC,8GAA8G,IAEzH,IAAI,CAAC,YAAY,EAAE,EACnB,IAAI,CAAC,UAAU,EAAE,EACjB,IAAI,CAAC,YAAY,EAAE,CACP,EACf;KACH;;;;;;AA/Nc,0CAAO,GAIhB;IACJ;QACE,EAAE,EAAE,YAAY;QAChB,SAAS,EAAE,YAAY;QACvB,mBAAmB,EAAE,YAAY;KAClC;IACD;QACE,EAAE,EAAE,aAAa;QACjB,SAAS,EAAE,cAAc;QACzB,mBAAmB,EAAE,aAAa;KACnC;IACD;QACE,EAAE,EAAE,WAAW;QACf,SAAS,EAAE,aAAa;QACxB,mBAAmB,EAAE,WAAW;KACjC;IACD;QACE,EAAE,EAAE,SAAS;QACb,SAAS,EAAE,SAAS;QACpB,mBAAmB,EAAE,SAAS;KAC/B;IACD;QACE,EAAE,EAAE,OAAO;QACX,SAAS,EAAE,OAAO;QAClB,mBAAmB,EAAE,OAAO;KAC7B;CA7BmB,CA8BpB;AA5D2B;IAA5B,kBAAkB,EAAE;oEAA+B;;;;;","names":[],"sources":["src/components/common/generated-answer/atomic-generated-answer-feedback/atomic-generated-answer-feedback-modal.pcss?tag=atomic-generated-answer-feedback-modal&encapsulation=shadow","src/components/common/generated-answer/atomic-generated-answer-feedback/atomic-generated-answer-feedback-modal.tsx"],"sourcesContent":["@import '../../../../global/global.pcss';\r\n","import {GeneratedAnswer, GeneratedAnswerFeedback} from '@coveo/headless';\r\nimport {\r\n  Component,\r\n  State,\r\n  h,\r\n  Watch,\r\n  Prop,\r\n  Element,\r\n  Event,\r\n  EventEmitter,\r\n} from '@stencil/core/internal';\r\nimport {AnyBindings} from '../../../../components';\r\nimport CloseIcon from '../../../../images/close.svg';\r\nimport Success from '../../../../images/success.svg';\r\nimport {\r\n  InitializableComponent,\r\n  InitializeBindings,\r\n} from '../../../../utils/initialization-utils';\r\nimport {updateBreakpoints} from '../../../../utils/replace-breakpoint';\r\nimport {once, randomID} from '../../../../utils/utils';\r\nimport {Button} from '../../button';\r\nimport {IconButton} from '../../iconButton';\r\n\r\n/**\r\n * @internal\r\n */\r\n@Component({\r\n  tag: 'atomic-generated-answer-feedback-modal',\r\n  styleUrl: 'atomic-generated-answer-feedback-modal.pcss',\r\n  shadow: true,\r\n})\r\nexport class AtomicGeneratedAnswerFeedbackModal\r\n  implements InitializableComponent<AnyBindings>\r\n{\r\n  @InitializeBindings() public bindings!: AnyBindings;\r\n  @Element() public host!: HTMLElement;\r\n\r\n  /**\r\n   * Indicates whether the modal is open.\r\n   */\r\n  @Prop({reflect: true, mutable: true}) isOpen = false;\r\n  /**\r\n   * A `GeneratedAnswer` controller instance. It is used when the user interacts with the modal.\r\n   */\r\n  @Prop({reflect: true, mutable: true}) generatedAnswer!: GeneratedAnswer;\r\n\r\n  @State() public error!: Error;\r\n  @State() currentAnswer?: GeneratedAnswerFeedback | 'other' | undefined;\r\n  @State() feedbackSubmitted: boolean = false;\r\n\r\n  private readonly formId = randomID(\r\n    'atomic-generated-answer-feedback-modal-form-'\r\n  );\r\n  private detailsInputRef?: HTMLTextAreaElement;\r\n\r\n  @Event() feedbackSent!: EventEmitter;\r\n\r\n  @Watch('isOpen')\r\n  watchToggleOpen(isOpen: boolean) {\r\n    if (isOpen) {\r\n      this.generatedAnswer.openFeedbackModal();\r\n    }\r\n  }\r\n\r\n  private static options: {\r\n    id: string;\r\n    localeKey: string;\r\n    correspondingAnswer: GeneratedAnswerFeedback | 'other';\r\n  }[] = [\r\n    {\r\n      id: 'irrelevant',\r\n      localeKey: 'irrelevant',\r\n      correspondingAnswer: 'irrelevant',\r\n    },\r\n    {\r\n      id: 'notAccurate',\r\n      localeKey: 'not-accurate',\r\n      correspondingAnswer: 'notAccurate',\r\n    },\r\n    {\r\n      id: 'outOfDate',\r\n      localeKey: 'out-of-date',\r\n      correspondingAnswer: 'outOfDate',\r\n    },\r\n    {\r\n      id: 'harmful',\r\n      localeKey: 'harmful',\r\n      correspondingAnswer: 'harmful',\r\n    },\r\n    {\r\n      id: 'other',\r\n      localeKey: 'other',\r\n      correspondingAnswer: 'other',\r\n    },\r\n  ];\r\n\r\n  private setIsOpen(isOpen: boolean) {\r\n    this.isOpen = isOpen;\r\n  }\r\n\r\n  private close() {\r\n    this.feedbackSubmitted = false;\r\n    if (this.detailsInputRef) {\r\n      this.detailsInputRef.value = '';\r\n    }\r\n    this.currentAnswer = undefined;\r\n    this.setIsOpen(false);\r\n    this.generatedAnswer.closeFeedbackModal();\r\n  }\r\n\r\n  private updateBreakpoints = once(() => updateBreakpoints(this.host));\r\n\r\n  private setCurrentAnswer(answer?: GeneratedAnswerFeedback | 'other') {\r\n    this.currentAnswer = answer;\r\n  }\r\n\r\n  public sendFeedback() {\r\n    if (this.currentAnswer === 'other') {\r\n      this.generatedAnswer.sendDetailedFeedback(this.detailsInputRef!.value);\r\n    } else {\r\n      this.generatedAnswer.sendFeedback(\r\n        this.currentAnswer as GeneratedAnswerFeedback\r\n      );\r\n    }\r\n    this.feedbackSent.emit();\r\n  }\r\n\r\n  private renderHeader() {\r\n    return (\r\n      <div\r\n        slot=\"header\"\r\n        part=\"modal-header\"\r\n        class=\"w-full flex justify-between items-center\"\r\n      >\r\n        <h1>{this.bindings.i18n.t('feedback')}</h1>\r\n        <IconButton\r\n          style=\"text-transparent\"\r\n          class=\"search-clear-button\"\r\n          onClick={() => this.close()}\r\n          icon={CloseIcon}\r\n          partPrefix={'close'}\r\n          ariaLabel={this.bindings.i18n.t('modal-done')}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private renderOptions() {\r\n    return (\r\n      <fieldset>\r\n        <legend part=\"reason-title\" class=\"text-base\">\r\n          {this.bindings.i18n.t('generated-answer-feedback-instructions')}\r\n        </legend>\r\n        {AtomicGeneratedAnswerFeedbackModal.options.map(\r\n          ({id, localeKey, correspondingAnswer}) => (\r\n            <div\r\n              class={`flex items-center ${correspondingAnswer} mobile-only:mt-4 desktop-only:mt-6`}\r\n              key={id}\r\n              part=\"reason\"\r\n            >\r\n              <input\r\n                part=\"reason-radio\"\r\n                type=\"radio\"\r\n                name=\"answer\"\r\n                id={id}\r\n                checked={this.currentAnswer === correspondingAnswer}\r\n                onChange={(e) =>\r\n                  (e.currentTarget as HTMLInputElement | null)?.checked &&\r\n                  this.setCurrentAnswer(correspondingAnswer)\r\n                }\r\n                class=\"mr-2\"\r\n                required\r\n              />\r\n              <label part=\"reason-label\" htmlFor={id}>\r\n                {this.bindings.i18n.t(localeKey)}\r\n              </label>\r\n            </div>\r\n          )\r\n        )}\r\n      </fieldset>\r\n    );\r\n  }\r\n\r\n  private renderDetails() {\r\n    if (this.currentAnswer !== 'other') {\r\n      return;\r\n    }\r\n\r\n    return (\r\n      <fieldset>\r\n        <textarea\r\n          part=\"details-input\"\r\n          name=\"answer-details\"\r\n          ref={(detailsInput) => (this.detailsInputRef = detailsInput)}\r\n          class=\"mt-2 p-2 w-full text-base leading-5 border border-neutral resize-none rounded\"\r\n          rows={4}\r\n          placeholder={this.bindings.i18n.t('add-details')}\r\n          required\r\n        ></textarea>\r\n      </fieldset>\r\n    );\r\n  }\r\n\r\n  private renderBody() {\r\n    return !this.feedbackSubmitted ? (\r\n      <form\r\n        part=\"form\"\r\n        id={this.formId}\r\n        slot=\"body\"\r\n        onSubmit={(e) => {\r\n          e.preventDefault();\r\n          this.feedbackSubmitted = true;\r\n          this.sendFeedback();\r\n        }}\r\n        class=\"flex flex-col gap-8 text-base leading-4 text-neutral-dark p-2\"\r\n      >\r\n        {this.renderOptions()}\r\n        {this.renderDetails()}\r\n      </form>\r\n    ) : (\r\n      <div slot=\"body\" class=\"flex flex-col items-center gap-4 my-4\">\r\n        <atomic-icon icon={Success} class=\"w-48\" />\r\n        <p class=\"text-base\">\r\n          {this.bindings.i18n.t('generated-answer-feedback-success')}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private renderFooter() {\r\n    return (\r\n      <div slot=\"footer\" part=\"modalFooter\">\r\n        {!this.feedbackSubmitted ? (\r\n          <div part=\"buttons\" class=\"flex justify-end gap-2 px-4\">\r\n            <Button\r\n              part=\"cancel-button\"\r\n              style=\"outline-neutral\"\r\n              class=\"text-primary flex justify-center text-sm leading-4 p-2\"\r\n              ariaLabel={this.bindings.i18n.t('close')}\r\n              onClick={() => this.close()}\r\n            >\r\n              {this.bindings.i18n.t('close')}\r\n            </Button>\r\n            <Button\r\n              part=\"submit-button\"\r\n              style=\"primary\"\r\n              type=\"submit\"\r\n              form={this.formId}\r\n              class=\"flex justify-center text-sm leading-4 p-2\"\r\n              ariaLabel={this.bindings.i18n.t('feedback-send')}\r\n            >\r\n              {this.bindings.i18n.t('feedback-send')}\r\n            </Button>\r\n          </div>\r\n        ) : (\r\n          <div part=\"buttons\" class=\"flex justify-end gap-2 p-2\">\r\n            <Button\r\n              part=\"cancel-button\"\r\n              style=\"primary\"\r\n              onClick={() => this.close()}\r\n              class=\"flex justify-center text-sm leading-4 p-2\"\r\n              ariaLabel={this.bindings.i18n.t('modal-done')}\r\n            >\r\n              {this.bindings.i18n.t('modal-done')}\r\n            </Button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  public render() {\r\n    this.updateBreakpoints();\r\n\r\n    return (\r\n      <atomic-modal\r\n        fullscreen={false}\r\n        isOpen={this.isOpen}\r\n        close={() => this.close()}\r\n        container={this.host}\r\n        exportparts=\"backdrop,container,header,header-wrapper,header-ruler,body,body-wrapper,footer,footer-wrapper,footer-wrapper\"\r\n      >\r\n        {this.renderHeader()}\r\n        {this.renderBody()}\r\n        {this.renderFooter()}\r\n      </atomic-modal>\r\n    );\r\n  }\r\n}\r\n"],"version":3}