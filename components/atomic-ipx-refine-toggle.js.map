{"file":"atomic-ipx-refine-toggle.js","mappings":";;;;;;;;;;;AAAA,MAAM,wBAAwB,GAAG,isuCAAisuC,CAAC;AACnuuC,oCAAe,wBAAwB;;;;;;;;;;;;MCwB1B,qBAAqB;;;;;;;;;;;QAoBF,wBAAmB,GAAG,CAAC,CAAC;;;;mCAAF,CAAC;;IAOrD,IAAY,mBAAmB;QAC7B,OAAO;YACL,GAAG,IAAI,CAAC,sBAAsB,CAAC,gBAAgB;YAC/C,GAAG,IAAI,CAAC,sBAAsB,CAAC,wBAAwB;YACvD,GAAG,IAAI,CAAC,sBAAsB,CAAC,uBAAuB;YACtD,GAAG,IAAI,CAAC,sBAAsB,CAAC,oBAAoB;YACnD,GAAG,IAAI,CAAC,sBAAsB,CAAC,uBAAuB;SACvD,CAAC,MAAM,CAAC;KACV;IAEM,UAAU;QACf,IAAI,CAAC,iBAAiB,GAAGA,EAAsB,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACtE,IAAI,CAAC,YAAY,GAAGC,EAAiB,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;KAC7D;IAEO,WAAW;QACjB,IAAI,CAAC,QAAQ,KAAK,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,IAAI,CAAC,CAAC;KAChD;IAEO,SAAS;;QACf,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,OAAO;SACR;QAED,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,yBAAyB,CAAC,CAAC;QAClE,MAAA,IAAI,CAAC,IAAI,CAAC,aAAa,0CAAE,qBAAqB,CAC5C,aAAa,EACb,IAAI,CAAC,QAAQ,CACd,CAAC;QACF,IAAI,CAAC,QAAQ,CAAC,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC;QAC1C,IAAI,CAAC,QAAQ,CAAC,mBAAmB,GAAG,IAAI,CAAC,mBAAmB,CAAC;KAC9D;IAEM,MAAM;QACX,QACE,EAAC,UAAU,qDACT,UAAU,EAAC,mBAAmB,EAC9B,KAAK,EAAC,aAAa,EACnB,KAAK,EAAC,iBAAiB,EACvB,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,EACtC,IAAI,EAAE,UAAU,EAChB,QAAQ,EACN,CAAC,IAAI,CAAC,iBAAiB,CAAC,UAAU,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAEjE,SAAS,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC,EACvC,OAAO,EAAE;gBACP,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,kBAAkB,CAAC;oBACrC,IAAI,CAAC,WAAW,EAAE,CAAC;iBACpB,CAAC,CAAC;aACJ,EACD,SAAS,EAAE,CAAC,MAA0B;gBACpC,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO;iBACR;gBACD,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC;gBACxB,IAAI,CAAC,SAAS,EAAE,CAAC;aAClB,EACD,KAAK,EACH,IAAI,CAAC,sBAAsB,CAAC,cAAc,IACxC,gBAAO,IAAI,CAAC,mBAAmB,CAAC,QAAQ,EAAE,CAAQ,IAChD,SAAS,GAEf,EACF;KACH;;;;;;;;;AA1F4B;IAA5B,kBAAkB,EAAE;uDAA4B;AAOzC;IAFP,qBAAqB,CAAC,mBAAmB,CAAC;qEAEa;AAIhD;IAFP,qBAAqB,CAAC,cAAc,CAAC;gEAEQ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","names":["buildBreadcrumbManager","buildSearchStatus"],"sources":["src/components/ipx/atomic-ipx-refine-toggle/atomic-ipx-refine-toggle.pcss?tag=atomic-ipx-refine-toggle&encapsulation=shadow","src/components/ipx/atomic-ipx-refine-toggle/atomic-ipx-refine-toggle.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\r\n\r\n[part='ipx-refine-toggle-button'] {\r\n  @apply h-full w-auto;\r\n}\r\n\r\n[part='ipx-refine-toggle-badge'] {\r\n  @apply w-5 h-5 leading-5 text-xs;\r\n}\r\n\r\n[part='ipx-refine-toggle-icon'] {\r\n  @apply w-5 h-5;\r\n}\r\n","import {\r\n  BreadcrumbManager,\r\n  BreadcrumbManagerState,\r\n  buildBreadcrumbManager,\r\n  buildSearchStatus,\r\n  SearchStatus,\r\n  SearchStatusState,\r\n} from '@coveo/headless';\r\nimport {Component, h, State, Element, Prop} from '@stencil/core';\r\nimport FilterIcon from '../../../images/filter.svg';\r\nimport {\r\n  InitializeBindings,\r\n  BindStateToController,\r\n} from '../../../utils/initialization-utils';\r\nimport {IconButton} from '../../common/iconButton';\r\nimport {Bindings} from '../../search/atomic-search-interface/atomic-search-interface';\r\n\r\n/**\r\n * @internal\r\n */\r\n@Component({\r\n  tag: 'atomic-ipx-refine-toggle',\r\n  styleUrl: 'atomic-ipx-refine-toggle.pcss',\r\n  shadow: true,\r\n})\r\nexport class AtomicIPXRefineToggle {\r\n  @InitializeBindings() public bindings!: Bindings;\r\n  @Element() public host!: HTMLElement;\r\n\r\n  @State() public error!: Error;\r\n\r\n  @BindStateToController('breadcrumbManager')\r\n  @State()\r\n  private breadcrumbManagerState!: BreadcrumbManagerState;\r\n\r\n  @BindStateToController('searchStatus')\r\n  @State()\r\n  private searchStatusState!: SearchStatusState;\r\n\r\n  /**\r\n   * The number of expanded facets inside the refine modal.\r\n   * Remaining facets are automatically collapsed.\r\n   *\r\n   * Using the value `0` collapses all facets.\r\n   */\r\n  @Prop({reflect: true}) public collapseFacetsAfter = 0;\r\n\r\n  public breadcrumbManager!: BreadcrumbManager;\r\n  public searchStatus!: SearchStatus;\r\n  private modalRef?: HTMLAtomicIpxRefineModalElement;\r\n  private buttonRef?: HTMLButtonElement;\r\n\r\n  private get numberOfBreadcrumbs(): number {\r\n    return [\r\n      ...this.breadcrumbManagerState.facetBreadcrumbs,\r\n      ...this.breadcrumbManagerState.categoryFacetBreadcrumbs,\r\n      ...this.breadcrumbManagerState.numericFacetBreadcrumbs,\r\n      ...this.breadcrumbManagerState.dateFacetBreadcrumbs,\r\n      ...this.breadcrumbManagerState.staticFilterBreadcrumbs,\r\n    ].length;\r\n  }\r\n\r\n  public initialize() {\r\n    this.breadcrumbManager = buildBreadcrumbManager(this.bindings.engine);\r\n    this.searchStatus = buildSearchStatus(this.bindings.engine);\r\n  }\r\n\r\n  private enableModal() {\r\n    this.modalRef && (this.modalRef.isOpen = true);\r\n  }\r\n\r\n  private loadModal() {\r\n    if (this.modalRef) {\r\n      return;\r\n    }\r\n\r\n    this.modalRef = document.createElement('atomic-ipx-refine-modal');\r\n    this.host.parentElement?.insertAdjacentElement(\r\n      'beforebegin',\r\n      this.modalRef\r\n    );\r\n    this.modalRef.openButton = this.buttonRef;\r\n    this.modalRef.collapseFacetsAfter = this.collapseFacetsAfter;\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <IconButton\r\n        partPrefix=\"ipx-refine-toggle\"\r\n        class=\"icon-button\"\r\n        style=\"outline-neutral\"\r\n        title={this.bindings.i18n.t('filters')}\r\n        icon={FilterIcon}\r\n        disabled={\r\n          !this.searchStatusState.hasResults && !this.numberOfBreadcrumbs\r\n        }\r\n        ariaLabel={this.bindings.i18n.t('sort')}\r\n        onClick={() => {\r\n          this.bindings.store.waitUntilAppLoaded(() => {\r\n            this.enableModal();\r\n          });\r\n        }}\r\n        buttonRef={(button?: HTMLButtonElement) => {\r\n          if (!button) {\r\n            return;\r\n          }\r\n          this.buttonRef = button;\r\n          this.loadModal();\r\n        }}\r\n        badge={\r\n          this.breadcrumbManagerState.hasBreadcrumbs ? (\r\n            <slot>{this.numberOfBreadcrumbs.toString()}</slot>\r\n          ) : undefined\r\n        }\r\n      />\r\n    );\r\n  }\r\n}\r\n"],"version":3}