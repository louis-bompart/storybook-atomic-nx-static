{"file":"atomic-relevance-inspector.entry.cjs.js","mappings":";;;;;;;;;;;AAAA,MAAM,2BAA2B,GAAG,u+tCAAu+tC,CAAC;AAC5guC,uCAAe,2BAA2B;;MCY7B,wBAAwB;;;;QAMZ,SAAI,GAAG,KAAK,CAAC;;oBAAN,KAAK;;IAK5B,MAAM;QACX,QACEA,2EACE,WAAW,EAAC,QAAQ,EACpB,MAAM,EAAE,IAAI,CAAC,IAAI,EACjB,KAAK,EAAE;;gBACL,MAAA,IAAI,CAAC,uBAAuB,0CAAE,IAAI,EAAE,CAAC;aACtC,IAEDA,gEAAG,IAAI,EAAC,QAAQ,mCAAiC,EACjDA,gEAAG,IAAI,EAAC,MAAM,6EAEV,EACJA,kEAAK,IAAI,EAAC,QAAQ,EAAC,KAAK,EAAC,sCAAsC,IAC7DA,QAACC,aAAM,qDACL,KAAK,EAAC,iBAAiB,EACvB,KAAK,EAAC,UAAU,EAChB,OAAO,EAAE,gBAAM,OAAA,MAAA,IAAI,CAAC,uBAAuB,0CAAE,IAAI,EAAE,CAAA,EAAA,aAG5C,EACTD,gEACE,KAAK,EAAC,iBAAiB,EACvB,MAAM,EAAC,QAAQ,EACf,IAAI,EAAE,IAAI,CAAC,SAAS,EACpB,OAAO,EAAE,gBAAM,OAAA,MAAA,IAAI,CAAC,uBAAuB,0CAAE,IAAI,EAAE,CAAA,EAAA,WAGjD,CACA,CACO,EACf;KACH;IAEO,iCAAiC;;QACvC,MAAM,EAAC,WAAW,EAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,aAAa,CAAC;QAC/D,MAAM,WAAW,GAAG,MAAM,CAAC;QAE3B,MAAM,gBAAgB,GAAG,WAAW,CAAC,KAAK,CACxC,0CAA0C,CAC3C,CAAC;QAEF,IAAI,gBAAgB,EAAE;YACpB,QACE,MAAC,MAAA,gBAAgB,CAAC,MAAM,0CAAE,GAA2B,mCAAI,WAAW,EACpE;SACH;QAED,MAAM,yBAAyB,GAAG,WAAW,CAAC,KAAK,CACjD,gDAAgD,CACjD,CAAC;QAEF,IAAI,yBAAyB,EAAE;YAC7B,QACE,MAAC,MAAA,yBAAyB,CAAC,MAAM,0CAAE,GAA2B,mCAC9D,WAAW,EACX;SACH;QAED,OAAO,WAAW,CAAC;KACpB;IAED,IAAY,SAAS;QACnB,MAAM,EAAC,cAAc,EAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,aAAa,CAAC;QAElE,MAAM,EAAC,KAAK,EAAC,GAAGE,eAAwB,CACtC,cAAc,EACd,IAAI,CAAC,iCAAiC,EAAyB,CAChE,CAAC;QACF,MAAM,EAAC,gBAAgB,EAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC;QAC7D,OAAO,GAAG,KAAK,YAAY,cAAc,8BAA8B,gBAAgB,EAAE,CAAC;KAC3F;;;;;;","names":["h","Button","getOrganizationEndpoints"],"sources":["src/components/search/atomic-relevance-inspector/atomic-relevance-inspector.pcss?tag=atomic-relevance-inspector&encapsulation=shadow","src/components/search/atomic-relevance-inspector/atomic-relevance-inspector.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\n","import {PlatformEnvironment, getOrganizationEndpoints} from '@coveo/headless';\nimport {Component, h, Prop, Event, EventEmitter} from '@stencil/core';\nimport {Button} from '../../common/button';\nimport {Bindings} from '../atomic-search-interface/atomic-search-interface';\n\n/**\n * The `atomic-relevance-inspector` component is used internally to offer insight on search page relevance, as well as information to help troubleshoot issues during development.\n */\n@Component({\n  tag: 'atomic-relevance-inspector',\n  styleUrl: 'atomic-relevance-inspector.pcss',\n  shadow: true,\n})\nexport class AtomicRelevanceInspector {\n  /**\n   * The Atomic interface bindings, namely the headless search engine and i18n instances.\n   */\n  @Prop() bindings!: Bindings;\n\n  @Prop({reflect: true}) open = false;\n\n  @Event({eventName: 'atomic/relevanceInspector/close'})\n  closeRelevanceInspector: EventEmitter<null> | undefined;\n\n  public render() {\n    return (\n      <atomic-modal\n        exportparts=\"footer\"\n        isOpen={this.open}\n        close={() => {\n          this.closeRelevanceInspector?.emit();\n        }}\n      >\n        <p slot=\"header\">Open the relevance inspector</p>\n        <p slot=\"body\">\n          The Relevance Inspector will open in the Coveo Administration Console.\n        </p>\n        <div slot=\"footer\" class=\"w-full flex justify-end items-center\">\n          <Button\n            style=\"outline-primary\"\n            class=\"p-2 mr-2\"\n            onClick={() => this.closeRelevanceInspector?.emit()}\n          >\n            Ignore\n          </Button>\n          <a\n            class=\"btn-primary p-2\"\n            target=\"_blank\"\n            href={this.adminHref}\n            onClick={() => this.closeRelevanceInspector?.emit()}\n          >\n            Open\n          </a>\n        </div>\n      </atomic-modal>\n    );\n  }\n\n  private extractEnvironmentFromPlatformURL(): PlatformEnvironment {\n    const {platformUrl} = this.bindings.engine.state.configuration;\n    const fallbackEnv = 'prod';\n\n    const platformUrlMatch = platformUrl.match(\n      /^https:\\/\\/platform(?<env>dev|stg|hipaa)/\n    );\n\n    if (platformUrlMatch) {\n      return (\n        (platformUrlMatch.groups?.env as PlatformEnvironment) ?? fallbackEnv\n      );\n    }\n\n    const organizationEndpointMatch = platformUrl.match(\n      /^https:\\/\\/[a-z0-9]+\\.org(?<env>dev|stg|hipaa)/\n    );\n\n    if (organizationEndpointMatch) {\n      return (\n        (organizationEndpointMatch.groups?.env as PlatformEnvironment) ??\n        fallbackEnv\n      );\n    }\n\n    return fallbackEnv;\n  }\n\n  private get adminHref() {\n    const {organizationId} = this.bindings.engine.state.configuration;\n\n    const {admin} = getOrganizationEndpoints(\n      organizationId,\n      this.extractEnvironmentFromPlatformURL() as PlatformEnvironment\n    );\n    const {searchResponseId} = this.bindings.engine.state.search;\n    return `${admin}/admin/#/${organizationId}/search/relevanceInspector/${searchResponseId}`;\n  }\n}\n"],"version":3}