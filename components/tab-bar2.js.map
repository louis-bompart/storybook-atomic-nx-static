{"file":"tab-bar2.js","mappings":"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","names":[],"sources":["src/components/common/tabs/tab-bar.pcss?tag=tab-bar&encapsulation=shadow","src/components/common/tabs/tab-bar.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\n\n:host {\n  white-space: nowrap;\n  width: 100%;\n  overflow-x: visible;\n  display: flex;\n  position: relative;\n}\n","import {h, Component, Element, Host, Listen, State} from '@stencil/core';\nimport {Button} from '../button';\nimport {TabCommonElement} from './tab-common';\n\n/**\n * @internal\n */\n@Component({\n  tag: 'tab-bar',\n  shadow: true,\n  styleUrl: 'tab-bar.pcss',\n})\nexport class TabBar {\n  @Element() private host!: HTMLElement;\n\n  @State()\n  private popoverTabs: (typeof Button)[] = [];\n\n  private resizeObserver: ResizeObserver | undefined;\n\n  private get tabsFromSlot(): TabCommonElement[] {\n    const isTab = (tagName: string) => /atomic-.+-tab$/i.test(tagName);\n    return Array.from(this.host.querySelectorAll<TabCommonElement>('*')).filter(\n      (element) => isTab(element.tagName)\n    );\n  }\n\n  private get selectedTab() {\n    return this.tabsFromSlot.find((tab) => tab.active);\n  }\n\n  private get slotContentWidth() {\n    return this.tabsFromSlot.reduce(\n      (total, el) =>\n        total +\n        parseFloat(window.getComputedStyle(el).getPropertyValue('width')),\n      0\n    );\n  }\n\n  private get containerWidth() {\n    return parseFloat(\n      window.getComputedStyle(this.host).getPropertyValue('width')\n    );\n  }\n\n  private get isOverflow() {\n    return this.slotContentWidth > this.containerWidth;\n  }\n\n  private get tabPopover() {\n    return this.host.shadowRoot?.querySelector('tab-popover');\n  }\n\n  private get popoverWidth() {\n    return this.tabPopover ? this.getElementWidth(this.tabPopover) : 0;\n  }\n\n  private get overflowingTabs() {\n    const containerRelativeRightPosition =\n      this.host.getBoundingClientRect().right;\n    const selectedTabRelativeRightPosition =\n      this.selectedTab?.getBoundingClientRect().right;\n\n    return this.tabsFromSlot.filter((element) => {\n      const isBeforeSelectedTab = selectedTabRelativeRightPosition\n        ? selectedTabRelativeRightPosition >\n          element.getBoundingClientRect().right\n        : false;\n\n      const minimumWidthNeeded = isBeforeSelectedTab\n        ? this.popoverWidth + this.getElementWidth(this.selectedTab)\n        : this.popoverWidth;\n\n      const rightPositionLimit = !this.isOverflow\n        ? containerRelativeRightPosition\n        : containerRelativeRightPosition - minimumWidthNeeded;\n\n      return (\n        element.getBoundingClientRect().right > rightPositionLimit &&\n        !element.active\n      );\n    });\n  }\n\n  private get displayedTabs() {\n    return this.tabsFromSlot.filter((el) => !this.overflowingTabs.includes(el));\n  }\n\n  private get lastDisplayedTab() {\n    const displayedTabs = this.displayedTabs;\n    return displayedTabs[displayedTabs.length - 1];\n  }\n\n  private get lastDisplayedTabRightPosition() {\n    return (\n      this.lastDisplayedTab.getBoundingClientRect().right -\n      this.host.getBoundingClientRect().left\n    );\n  }\n\n  private updatePopoverPosition() {\n    this.tabPopover?.style.setProperty(\n      'left',\n      `${this.displayedTabs.length ? this.lastDisplayedTabRightPosition : 0}px`\n    );\n  }\n\n  private getElementWidth = (element?: Element) => {\n    return element\n      ? parseFloat(window.getComputedStyle(element).getPropertyValue('width'))\n      : 0;\n  };\n\n  private hideElement = (el: HTMLElement) => {\n    el.style.visibility = 'hidden';\n    el.ariaHidden = 'true';\n  };\n\n  private showElement = (el: HTMLElement) => {\n    el.style.visibility = 'visible';\n    el.ariaHidden = 'false';\n  };\n\n  private updateTabVisibility = (\n    tabs: TabCommonElement[],\n    isVisible: boolean\n  ) => {\n    const tabCount = this.tabsFromSlot.length;\n\n    tabs.forEach((tab, index) => {\n      tab.style.setProperty(\n        'order',\n        String(isVisible ? index + 1 : tabCount - tabs.length + index + 1)\n      );\n      if (isVisible) {\n        this.showElement(tab);\n      } else {\n        this.hideElement(tab);\n      }\n    });\n  };\n\n  private updatePopoverTabs = () => {\n    this.popoverTabs = this.overflowingTabs.map((tab) => (\n      <Button\n        part=\"popover-tab\"\n        style=\"text-transparent\"\n        class=\"font-semibold px-4 py-2 rounded truncate\"\n        ariaLabel={tab.label}\n        onClick={() => {\n          tab.select();\n          this.tabPopover?.togglePopover();\n        }}\n      >\n        {tab.label}\n      </Button>\n    ));\n  };\n\n  private updateTabsDisplay = () => {\n    this.updateTabVisibility(this.overflowingTabs, false);\n    this.updateTabVisibility(this.displayedTabs, true);\n    this.updatePopoverPosition();\n    this.tabPopover?.setButtonVisibility(!!this.overflowingTabs.length);\n  };\n\n  @Listen('atomic/tabRendered')\n  public resolveResult(event: CustomEvent<{}>) {\n    event.stopPropagation();\n    this.updatePopoverTabs();\n  }\n\n  public componentDidLoad() {\n    this.resizeObserver = new ResizeObserver(this.render);\n    this.resizeObserver.observe(this.host);\n  }\n\n  public disconnectedCallback() {\n    this.resizeObserver?.disconnect();\n  }\n\n  public render = () => {\n    this.updateTabsDisplay();\n    return (\n      <Host>\n        <slot></slot>\n        <tab-popover>{this.popoverTabs}</tab-popover>\n      </Host>\n    );\n  };\n}\n"],"version":3}