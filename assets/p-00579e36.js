/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var e=Object.create;var t=Object.defineProperty;var r=Object.getOwnPropertyDescriptor;var n=Object.getOwnPropertyNames;var i=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty;var s=(e,r,n)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n;var o=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):e)((function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}));var u=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),c=(e,r)=>{for(var n in r)t(e,n,{get:r[n],enumerable:!0})},l=(e,i,s,o)=>{if(i&&typeof i=="object"||typeof i=="function")for(let u of n(i))!a.call(e,u)&&u!==s&&t(e,u,{get:()=>i[u],enumerable:!(o=r(i,u))||o.enumerable});return e};var d=(r,n,a)=>(a=r!=null?e(i(r)):{},l(n||!r||!r.__esModule?t(a,"default",{value:r,enumerable:!0}):a,r));var f=(e,t,r)=>s(e,typeof t!="symbol"?t+"":t,r);var h=u(((e,t)=>{function r(e){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");if(e=`${e}`,e=e.replace(/[ \t\n\f\r]/g,""),e.length%4===0&&(e=e.replace(/==?$/,"")),e.length%4===1||/[^+/0-9A-Za-z]/.test(e))return null;let t="",r=0,n=0;for(let a=0;a<e.length;a++)r<<=6,r|=i(e[a]),n+=6,n===24&&(t+=String.fromCharCode((r&16711680)>>16),t+=String.fromCharCode((r&65280)>>8),t+=String.fromCharCode(r&255),r=n=0);return n===12?(r>>=4,t+=String.fromCharCode(r)):n===18&&(r>>=2,t+=String.fromCharCode((r&65280)>>8),t+=String.fromCharCode(r&255)),t}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function i(e){let t=n.indexOf(e);return t<0?void 0:t}t.exports=r}));var g=u(((e,t)=>{function r(e){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");let t;for(e=`${e}`,t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return null;let r="";for(t=0;t<e.length;t+=3){let n=[void 0,void 0,void 0,void 0];n[0]=e.charCodeAt(t)>>2,n[1]=(e.charCodeAt(t)&3)<<4,e.length>t+1&&(n[1]|=e.charCodeAt(t+1)>>4,n[2]=(e.charCodeAt(t+1)&15)<<2),e.length>t+2&&(n[2]|=e.charCodeAt(t+2)>>6,n[3]=e.charCodeAt(t+2)&63);for(let e=0;e<n.length;e++)typeof n[e]>"u"?r+="=":r+=i(n[e])}return r}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function i(e){if(e>=0&&e<64)return n[e]}t.exports=r}));var p=u(((e,t)=>{var r=h(),n=g();t.exports={atob:r,btoa:n}}));var y=u(((e,t)=>{var r=typeof self<"u"?self:typeof window<"u"?window:void 0;if(!r)throw new Error("Unable to find global scope. Are you sure this is running in the browser?");if(!r.AbortController)throw new Error('Could not find "AbortController" in the global scope. You need to polyfill it first');t.exports.AbortController=r.AbortController}));var v=u(((e,t)=>{t.exports=fetch}));var m=u((e=>{var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var r={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};function n(e){var n=t(t({},r),e);return n.numOfAttempts<1&&(n.numOfAttempts=1),n}e.getSanitizedOptions=n}));var w=u((e=>{Object.defineProperty(e,"__esModule",{value:!0});function t(e){var t=Math.random()*e;return Math.round(t)}e.fullJitter=t}));var b=u((e=>{Object.defineProperty(e,"__esModule",{value:!0});function t(e){return e}e.noJitter=t}));var S=u((e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=w(),r=b();function n(e){switch(e.jitter){case"full":return t.fullJitter;case"none":default:return r.noJitter}}e.JitterFactory=n}));var I=u((e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=S(),r=function(){function e(e){this.options=e,this.attempt=0}return e.prototype.apply=function(){var e=this;return new Promise((function(t){return setTimeout(t,e.jitteredDelay)}))},e.prototype.setAttemptNumber=function(e){this.attempt=e},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){var e=t.JitterFactory(this.options);return e(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var e=this.options.startingDelay,t=this.options.timeMultiple,r=this.numOfDelayedAttempts,n=e*Math.pow(t,r);return Math.min(n,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}();e.Delay=r}));var O=u((e=>{var t=e&&e.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),r=e&&e.__awaiter||function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,a){function s(e){try{u(n.next(e))}catch(e){a(e)}}function o(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){e.done?r(e.value):i(e.value).then(s,o)}u((n=n.apply(e,t||[])).next())}))},n=e&&e.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(e){return function(t){return u([e,t])}}function u(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=s[0]&2?i.return:s[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[s[0]&2,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,i=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){r.label=s[1];break}if(s[0]===6&&r.label<a[1]){r.label=a[1],a=s;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(s);break}a[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],i=0}finally{n=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var i=I(),a=function(e){t(i,e);function i(){return e!==null&&e.apply(this,arguments)||this}return i.prototype.apply=function(){return r(this,void 0,void 0,(function(){return n(this,(function(t){return[2,this.isFirstAttempt?!0:e.prototype.apply.call(this)]}))}))},Object.defineProperty(i.prototype,"isFirstAttempt",{get:function(){return this.attempt===0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),i}(i.Delay);e.SkipFirstDelay=a}));var A=u((e=>{var t=e&&e.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=I(),n=function(e){t(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r}(r.Delay);e.AlwaysDelay=n}));var q=u((e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=O(),r=A();function n(e,t){var r=i(e);return r.setAttemptNumber(t),r}e.DelayFactory=n;function i(e){return e.delayFirstAttempt?new r.AlwaysDelay(e):new t.SkipFirstDelay(e)}}));var C=u((e=>{var t=e&&e.__awaiter||function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,a){function s(e){try{u(n.next(e))}catch(e){a(e)}}function o(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){e.done?r(e.value):i(e.value).then(s,o)}u((n=n.apply(e,t||[])).next())}))},r=e&&e.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(e){return function(t){return u([e,t])}}function u(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=s[0]&2?i.return:s[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[s[0]&2,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,i=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){r.label=s[1];break}if(s[0]===6&&r.label<a[1]){r.label=a[1],a=s;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(s);break}a[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],i=0}finally{n=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var n=m(),i=q();function a(e,i){return i===void 0&&(i={}),t(this,void 0,void 0,(function(){var t,a;return r(this,(function(r){switch(r.label){case 0:return t=n.getSanitizedOptions(i),a=new s(e,t),[4,a.execute()];case 1:return[2,r.sent()]}}))}))}e.backOff=a;var s=function(){function e(e,t){this.request=e,this.options=t,this.attemptNumber=0}return e.prototype.execute=function(){return t(this,void 0,void 0,(function(){var e,t;return r(this,(function(r){switch(r.label){case 0:if(this.attemptLimitReached)return[3,7];r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return r.sent(),[4,this.request()];case 3:return[2,r.sent()];case 4:return e=r.sent(),this.attemptNumber++,[4,this.options.retry(e,this.attemptNumber)];case 5:if(t=r.sent(),!t||this.attemptLimitReached)throw e;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}}))}))},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return t(this,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return e=i.DelayFactory(this.options,this.attemptNumber),[4,e.apply()];case 1:return t.sent(),[2]}}))}))},e}()}));var k=u(((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs=n()})(e,(function(){var e=1e3,t=6e4,r=36e5,n="millisecond",i="second",a="minute",s="hour",o="day",u="week",c="month",l="quarter",d="year",f="date",h="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}},v=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},m={s:v,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),i=r%60;return(t<=0?"+":"-")+v(n,2,"0")+":"+v(i,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),i=t.clone().add(n,c),a=r-i<0,s=t.clone().add(n+(a?-1:1),c);return+(-(n+(r-i)/(a?i-s:s-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:d,w:u,d:o,D:f,h:s,m:a,s:i,ms:n,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return e===void 0}},w="en",b={};b[w]=y;var S="$isDayjsObject",I=function(e){return e instanceof C||!(!e||!e[S])},O=function e(t,r,n){var i;if(!t)return w;if(typeof t=="string"){var a=t.toLowerCase();b[a]&&(i=a),r&&(b[a]=r,i=a);var s=t.split("-");if(!i&&s.length>1)return e(s[0])}else{var o=t.name;b[o]=t,i=o}return!n&&i&&(w=i),i||!n&&w},A=function(e,t){if(I(e))return e.clone();var r=typeof t=="object"?t:{};return r.date=e,r.args=arguments,new C(r)},q=m;q.l=O,q.i=I,q.w=function(e,t){return A(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var C=function(){function y(e){this.$L=O(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[S]=!0}var v=y.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(t===null)return new Date(NaN);if(q.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var n=t.match(g);if(n){var i=n[2]-1||0,a=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,a)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,a)}}return new Date(t)}(e),this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return q},v.isValid=function(){return this.$d.toString()!==h},v.isSame=function(e,t){var r=A(e);return this.startOf(t)<=r&&r<=this.endOf(t)},v.isAfter=function(e,t){return A(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<A(e)},v.$g=function(e,t,r){return q.u(e)?this[t]:this.set(r,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var r=this,n=!!q.u(t)||t,l=q.p(e),h=function(e,t){var i=q.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return n?i:i.endOf(o)},g=function(e,t){return q.w(r.toDate()[e].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},p=this.$W,y=this.$M,v=this.$D,m="set"+(this.$u?"UTC":"");switch(l){case d:return n?h(1,0):h(31,11);case c:return n?h(1,y):h(0,y+1);case u:var w=this.$locale().weekStart||0,b=(p<w?p+7:p)-w;return h(n?v-b:v+(6-b),y);case o:case f:return g(m+"Hours",0);case s:return g(m+"Minutes",1);case a:return g(m+"Seconds",2);case i:return g(m+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var r,u=q.p(e),l="set"+(this.$u?"UTC":""),h=(r={},r[o]=l+"Date",r[f]=l+"Date",r[c]=l+"Month",r[d]=l+"FullYear",r[s]=l+"Hours",r[a]=l+"Minutes",r[i]=l+"Seconds",r[n]=l+"Milliseconds",r)[u],g=u===o?this.$D+(t-this.$W):t;if(u===c||u===d){var p=this.clone().set(f,1);p.$d[h](g),p.init(),this.$d=p.set(f,Math.min(this.$D,p.daysInMonth())).$d}else h&&this.$d[h](g);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[q.p(e)]()},v.add=function(n,l){var f,h=this;n=Number(n);var g=q.p(l),p=function(e){var t=A(h);return q.w(t.date(t.date()+Math.round(e*n)),h)};if(g===c)return this.set(c,this.$M+n);if(g===d)return this.set(d,this.$y+n);if(g===o)return p(1);if(g===u)return p(7);var y=(f={},f[a]=t,f[s]=r,f[i]=e,f)[g]||1,v=this.$d.getTime()+n*y;return q.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||h;var n=e||"YYYY-MM-DDTHH:mm:ssZ",i=q.z(this),a=this.$H,s=this.$m,o=this.$M,u=r.weekdays,c=r.months,l=r.meridiem,d=function(e,r,i,a){return e&&(e[r]||e(t,n))||i[r].slice(0,a)},f=function(e){return q.s(a%12||12,e,"0")},g=l||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(p,(function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return q.s(t.$y,4,"0");case"M":return o+1;case"MM":return q.s(o+1,2,"0");case"MMM":return d(r.monthsShort,o,c,3);case"MMMM":return d(c,o);case"D":return t.$D;case"DD":return q.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(r.weekdaysMin,t.$W,u,2);case"ddd":return d(r.weekdaysShort,t.$W,u,3);case"dddd":return u[t.$W];case"H":return String(a);case"HH":return q.s(a,2,"0");case"h":return f(1);case"hh":return f(2);case"a":return g(a,s,!0);case"A":return g(a,s,!1);case"m":return String(s);case"mm":return q.s(s,2,"0");case"s":return String(t.$s);case"ss":return q.s(t.$s,2,"0");case"SSS":return q.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(n,f,h){var g,p=this,y=q.p(f),v=A(n),m=(v.utcOffset()-this.utcOffset())*t,w=this-v,b=function(){return q.m(p,v)};switch(y){case d:g=b()/12;break;case c:g=b();break;case l:g=b()/3;break;case u:g=(w-m)/6048e5;break;case o:g=(w-m)/864e5;break;case s:g=w/r;break;case a:g=w/t;break;case i:g=w/e;break;default:g=w}return h?g:q.a(g)},v.daysInMonth=function(){return this.endOf(c).$D},v.$locale=function(){return b[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=O(e,t,!0);return n&&(r.$L=n),r},v.clone=function(){return q.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},y}(),k=C.prototype;return A.prototype=k,[["$ms",n],["$s",i],["$m",a],["$H",s],["$W",o],["$M",c],["$y",d],["$D",f]].forEach((function(e){k[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),A.extend=function(e,t){return e.$i||(e(t,C,A),e.$i=!0),A},A.locale=O,A.isDayjs=I,A.unix=function(e){return A(1e3*e)},A.en=b[w],A.Ls=b,A.p={},A}))}));var x=u(((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_quarterOfYear=n()})(e,(function(){var e="month",t="quarter";return function(r,n){var i=n.prototype;i.quarter=function(e){return this.$utils().u(e)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(e-1))};var a=i.add;i.add=function(r,n){return r=Number(r),this.$utils().p(n)===t?this.add(3*r,e):a.bind(this)(r,n)};var s=i.startOf;i.startOf=function(r,n){var i=this.$utils(),a=!!i.u(n)||n;if(i.p(r)===t){var o=this.quarter()-1;return a?this.month(3*o).startOf(e).startOf("day"):this.month(3*o+2).endOf(e).endOf("day")}return s.bind(this)(r,n)}}}))}));var j=u(((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_customParseFormat=n()})(e,(function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,n=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,a={},s=function(e){return(e=+e)+(e>68?1900:2e3)},o=function(e){return function(t){this[e]=+t}},u=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e||e==="Z")return 0;var t=e.match(/([+-]|\d\d)/g),r=60*t[1]+(+t[2]||0);return r===0?0:t[0]==="+"?-r:r}(e)}],c=function(e){var t=a[e];return t&&(t.indexOf?t:t.s.concat(t.f))},l=function(e,t){var r,n=a.meridiem;if(n){for(var i=1;i<=24;i+=1)if(e.indexOf(n(i,0,t))>-1){r=i>12;break}}else r=e===(t?"pm":"PM");return r},d={A:[i,function(e){this.afternoon=l(e,!1)}],a:[i,function(e){this.afternoon=l(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[r,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[n,o("seconds")],ss:[n,o("seconds")],m:[n,o("minutes")],mm:[n,o("minutes")],H:[n,o("hours")],h:[n,o("hours")],HH:[n,o("hours")],hh:[n,o("hours")],D:[n,o("day")],DD:[r,o("day")],Do:[i,function(e){var t=a.ordinal,r=e.match(/\d+/);if(this.day=r[0],t)for(var n=1;n<=31;n+=1)t(n).replace(/\[|\]/g,"")===e&&(this.day=n)}],M:[n,o("month")],MM:[r,o("month")],MMM:[i,function(e){var t=c("months"),r=(c("monthsShort")||t.map((function(e){return e.slice(0,3)}))).indexOf(e)+1;if(r<1)throw new Error;this.month=r%12||r}],MMMM:[i,function(e){var t=c("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,o("year")],YY:[r,function(e){this.year=s(e)}],YYYY:[/\d{4}/,o("year")],Z:u,ZZ:u};function f(r){var n,i;n=r,i=a&&a.formats;for(var s=(r=n.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,r,n){var a=n&&n.toUpperCase();return r||i[n]||e[n]||i[a].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,r){return t||r.slice(1)}))}))).match(t),o=s.length,u=0;u<o;u+=1){var c=s[u],l=d[c],f=l&&l[0],h=l&&l[1];s[u]=h?{regex:f,parser:h}:c.replace(/^\[|\]$/g,"")}return function(e){for(var t={},r=0,n=0;r<o;r+=1){var i=s[r];if(typeof i=="string")n+=i.length;else{var a=i.regex,u=i.parser,c=e.slice(n),l=a.exec(c)[0];u.call(t,l),e=e.replace(l,"")}}return function(e){var t=e.afternoon;if(t!==void 0){var r=e.hours;t?r<12&&(e.hours+=12):r===12&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,r){r.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(s=e.parseTwoDigitYear);var n=t.prototype,i=n.parse;n.parse=function(e){var t=e.date,n=e.utc,s=e.args;this.$u=n;var o=s[1];if(typeof o=="string"){var u=s[2]===!0,c=s[3]===!0,l=u||c,d=s[2];c&&(d=s[2]),a=this.$locale(),!u&&d&&(a=r.Ls[d]),this.$d=function(e,t,r){try{if(["x","X"].indexOf(t)>-1)return new Date((t==="X"?1e3:1)*e);var n=f(t)(e),i=n.year,a=n.month,s=n.day,o=n.hours,u=n.minutes,c=n.seconds,l=n.milliseconds,d=n.zone,h=new Date,g=s||(i||a?1:h.getDate()),p=i||h.getFullYear(),y=0;i&&!a||(y=a>0?a-1:h.getMonth());var v=o||0,m=u||0,w=c||0,b=l||0;return d?new Date(Date.UTC(p,y,g,v,m,w,b+60*d.offset*1e3)):r?new Date(Date.UTC(p,y,g,v,m,w,b)):new Date(p,y,g,v,m,w,b)}catch{return new Date("")}}(t,o,n),this.init(),d&&d!==!0&&(this.$L=this.locale(d).$L),l&&t!=this.format(o)&&(this.$d=new Date("")),a={}}else if(o instanceof Array)for(var h=o.length,g=1;g<=h;g+=1){s[1]=o[g-1];var p=r.apply(this,s);if(p.isValid()){this.$d=p.$d,this.$L=p.$L,this.init();break}g===h&&(this.$d=new Date(""))}else i.call(this,e)}}}))}));var R=u(((e,t)=>{var r=/(^|; )Coveo-Pendragon=([^;]*)/;t.exports=()=>r.exec(document.cookie)?.pop()||null}));var F=u(((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_timezone=n()})(e,(function(){var e={year:0,month:1,day:2,hour:3,minute:4,second:5},t={};return function(r,n,i){var a,s=function(e,r,n){n===void 0&&(n={});var i=new Date(e),a=function(e,r){r===void 0&&(r={});var n=r.timeZoneName||"short",i=e+"|"+n,a=t[i];return a||(a=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:n}),t[i]=a),a}(r,n);return a.formatToParts(i)},o=function(t,r){for(var n=s(t,r),a=[],o=0;o<n.length;o+=1){var u=n[o],c=u.type,l=u.value,d=e[c];d>=0&&(a[d]=parseInt(l,10))}var f=a[3],h=f===24?0:f,g=a[0]+"-"+a[1]+"-"+a[2]+" "+h+":"+a[4]+":"+a[5]+":000",p=+t;return(i.utc(g).valueOf()-(p-=p%1e3))/6e4},u=n.prototype;u.tz=function(e,t){e===void 0&&(e=a);var r=this.utcOffset(),n=this.toDate(),s=n.toLocaleString("en-US",{timeZone:e}),o=Math.round((n-new Date(s))/1e3/60),u=i(s,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(n.getTimezoneOffset()/15)-o,!0);if(t){var c=u.utcOffset();u=u.add(r-c,"minute")}return u.$x.$timezone=e,u},u.offsetName=function(e){var t=this.$x.$timezone||i.tz.guess(),r=s(this.valueOf(),t,{timeZoneName:e}).find((function(e){return e.type.toLowerCase()==="timezonename"}));return r&&r.value};var c=u.startOf;u.startOf=function(e,t){if(!this.$x||!this.$x.$timezone)return c.call(this,e,t);var r=i(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return c.call(r,e,t).tz(this.$x.$timezone,!0)},i.tz=function(e,t,r){var n=r&&t,s=r||t||a,u=o(+i(),s);if(typeof e!="string")return i(e).tz(s);var c=function(e,t,r){var n=e-60*t*1e3,i=o(n,r);if(t===i)return[n,t];var a=o(n-=60*(i-t)*1e3,r);return i===a?[n,i]:[e-60*Math.min(i,a)*1e3,Math.max(i,a)]}(i.utc(e,n).valueOf(),u,s),l=c[0],d=c[1],f=i(l).utcOffset(d);return f.$x.$timezone=s,f},i.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},i.tz.setDefault=function(e){a=e}}}))}));var T=u(((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_utc=n()})(e,(function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(n,i,a){var s=i.prototype;a.utc=function(e){var t={date:e,utc:!0,args:arguments};return new i(t)},s.utc=function(t){var r=a(this.toDate(),{locale:this.$L,utc:!0});return t?r.add(this.utcOffset(),e):r},s.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var o=s.parse;s.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),o.call(this,e)};var u=s.init;s.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else u.call(this)};var c=s.utcOffset;s.utcOffset=function(n,i){var a=this.$utils().u;if(a(n))return this.$u?0:a(this.$offset)?c.call(this):this.$offset;if(typeof n=="string"&&(n=function(e){e===void 0&&(e="");var n=e.match(t);if(!n)return null;var i=(""+n[0]).match(r)||["-",0,0],a=i[0],s=60*+i[1]+ +i[2];return s===0?0:a==="+"?s:-s}(n),n===null))return this;var s=Math.abs(n)<=16?60*n:n,o=this;if(i)return o.$offset=s,o.$u=n===0,o;if(n!==0){var u=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(o=this.local().add(s+u,e)).$offset=s,o.$x.$localOffset=u}else o=this.utc();return o};var l=s.format;s.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,t)},s.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},s.isUTC=function(){return!!this.$u},s.toISOString=function(){return this.toDate().toISOString()},s.toString=function(){return this.toDate().toUTCString()};var d=s.toDate;s.toDate=function(e){return e==="s"&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var f=s.diff;s.diff=function(e,t,r){if(e&&this.$u===e.$u)return f.call(this,e,t,r);var n=this.local(),i=a(e).local();return f.call(n,i,t,r)}}}))}));var D=u(((e,t)=>{function r(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}t.exports=n;function n(e,t,n){var i=n&&n.stringify||r,a=1;if(typeof e=="object"&&e!==null){var s=t.length+a;if(s===1)return e;var o=new Array(s);o[0]=i(e);for(var u=1;u<s;u++)o[u]=i(t[u]);return o.join(" ")}if(typeof e!="string")return e;var c=t.length;if(c===0)return e;for(var l="",d=1-a,f=-1,h=e&&e.length||0,g=0;g<h;){if(e.charCodeAt(g)===37&&g+1<h){switch(f=f>-1?f:0,e.charCodeAt(g+1)){case 100:case 102:if(d>=c||t[d]==null)break;f<g&&(l+=e.slice(f,g)),l+=Number(t[d]),f=g+2,g++;break;case 105:if(d>=c||t[d]==null)break;f<g&&(l+=e.slice(f,g)),l+=Math.floor(Number(t[d])),f=g+2,g++;break;case 79:case 111:case 106:if(d>=c||t[d]===void 0)break;f<g&&(l+=e.slice(f,g));var p=typeof t[d];if(p==="string"){l+="'"+t[d]+"'",f=g+2,g++;break}if(p==="function"){l+=t[d].name||"<anonymous>",f=g+2,g++;break}l+=i(t[d]),f=g+2,g++;break;case 115:if(d>=c)break;f<g&&(l+=e.slice(f,g)),l+=String(t[d]),f=g+2,g++;break;case 37:f<g&&(l+=e.slice(f,g)),l+="%",f=g+2,g++,d--;break}++d}++g}return f===-1?e:(f<h&&(l+=e.slice(f)),l)}}));var M=u(((e,t)=>{var r=D();t.exports=f;var n=T().console||{},i={mapHttpRequest:q,mapHttpResponse:q,wrapRequestSerializer:C,wrapResponseSerializer:C,wrapErrorSerializer:C,req:q,res:q,err:O,errWithCause:O};function a(e,t){return e==="silent"?1/0:t.levels.values[e]}var s=Symbol("pino.logFuncs"),o=Symbol("pino.hierarchy"),u={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function c(e,t){let r={logger:t,parent:e[o]};t[o]=r}function l(e,t,r){let i={};t.forEach((e=>{i[e]=r[e]?r[e]:n[e]||n[u[e]||"log"]||k})),e[s]=i}function d(e,t){return Array.isArray(e)?e.filter((function(e){return e!=="!stdSerializers.err"})):e===!0?Object.keys(t):!1}function f(e){e=e||{},e.browser=e.browser||{};let t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");let r=e.browser.write||n;e.browser.write&&(e.browser.asObject=!0);let i=e.serializers||{},s=d(e.browser.serialize,i),o=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(o=!1);let u=Object.keys(e.customLevels||{}),f=["error","fatal","warn","info","debug","trace"].concat(u);typeof r=="function"&&f.forEach((function(e){r[e]=r})),(e.enabled===!1||e.browser.disabled)&&(e.level="silent");let g=e.level||"info",p=Object.create(r);p.log||(p.log=k),l(p,f,r),c({},p),Object.defineProperty(p,"levelVal",{get:m}),Object.defineProperty(p,"level",{get:w,set:S});let v={transmit:t,serialize:s,asObject:e.browser.asObject,formatters:e.browser.formatters,levels:f,timestamp:A(e)};p.levels=h(e),p.level=g,p.setMaxListeners=p.getMaxListeners=p.emit=p.addListener=p.on=p.prependListener=p.once=p.prependOnceListener=p.removeListener=p.removeAllListeners=p.listeners=p.listenerCount=p.eventNames=p.write=p.flush=k,p.serializers=i,p._serialize=s,p._stdErrSerialize=o,p.child=O,t&&(p._logEvent=I());function m(){return a(this.level,this)}function w(){return this._level}function S(e){if(e!=="silent"&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,y(this,v,p,"error"),y(this,v,p,"fatal"),y(this,v,p,"warn"),y(this,v,p,"info"),y(this,v,p,"debug"),y(this,v,p,"trace"),u.forEach((e=>{y(this,v,p,e)}))}function O(r,n){if(!r)throw new Error("missing bindings for child Pino");n=n||{},s&&r.serializers&&(n.serializers=r.serializers);let a=n.serializers;if(s&&a){var o=Object.assign({},i,a),u=e.browser.serialize===!0?Object.keys(o):s;delete r.serializers,b([r],u,o,this._stdErrSerialize)}function l(e){this._childLevel=(e._childLevel|0)+1,this.bindings=r,o&&(this.serializers=o,this._serialize=u),t&&(this._logEvent=I([].concat(e._logEvent.bindings,r)))}l.prototype=this;let d=new l(this);return c(this,d),d.level=this.level,d}return p}function h(e){let t=e.customLevels||{},r=Object.assign({},f.levels.values,t),n=Object.assign({},f.levels.labels,g(t));return{values:r,labels:n}}function g(e){let t={};return Object.keys(e).forEach((function(r){t[e[r]]=r})),t}f.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};f.stdSerializers=i;f.stdTimeFunctions=Object.assign({},{nullTime:x,epochTime:j,unixTime:R,isoTime:F});function p(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[o];for(;r.parent;)r=r.parent,r.logger.bindings&&t.push(r.logger.bindings);return t.reverse()}function y(e,t,r,n){if(Object.defineProperty(e,n,{value:a(e.level,r)>a(n,r)?k:r[s][n],writable:!0,enumerable:!0,configurable:!0}),!t.transmit&&e[n]===k)return;e[n]=m(e,t,r,n);let i=p(e);i.length!==0&&(e[n]=v(i,e[n]))}function v(e,t){return function(){return t.apply(this,[...e,...arguments])}}function m(e,t,r,i){return function(s){return function(){let o=t.timestamp(),u=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===n?n:this;for(var l=0;l<u.length;l++)u[l]=arguments[l];if(t.serialize&&!t.asObject&&b(u,this._serialize,this.serializers,this._stdErrSerialize),t.asObject||t.formatters?s.call(c,w(this,i,u,o,t.formatters)):s.apply(c,u),t.transmit){let n=t.transmit.level||e._level,s=r.levels.values[n],c=r.levels.values[i];if(c<s)return;S(this,{ts:o,methodLevel:i,methodValue:c,transmitLevel:n,transmitValue:r.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:a(e._level,r)},u)}}}(e[s][i])}function w(e,t,n,i,a={}){let{level:s=(()=>e.levels.values[t]),log:o=(e=>e)}=a;e._serialize&&b(n,e._serialize,e.serializers,e._stdErrSerialize);let u=n.slice(),c=u[0],l={};i&&(l.time=i),l.level=s(t,e.levels.values[t]);let d=(e._childLevel|0)+1;if(d<1&&(d=1),c!==null&&typeof c=="object"){for(;d--&&typeof u[0]=="object";)Object.assign(l,u.shift());c=u.length?r(u.shift(),u):void 0}else typeof c=="string"&&(c=r(u.shift(),u));return c!==void 0&&(l.msg=c),o(l)}function b(e,t,r,n){for(let i in e)if(n&&e[i]instanceof Error)e[i]=f.stdSerializers.err(e[i]);else if(typeof e[i]=="object"&&!Array.isArray(e[i]))for(let n in e[i])t&&t.indexOf(n)>-1&&n in r&&(e[i][n]=r[n](e[i][n]))}function S(e,t,r){let n=t.send,i=t.ts,a=t.methodLevel,s=t.methodValue,o=t.val,u=e._logEvent.bindings;b(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter((function(e){return u.indexOf(e)===-1})),e._logEvent.level.label=a,e._logEvent.level.value=s,n(a,e._logEvent,o),e._logEvent=I(u)}function I(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function O(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)t[r]===void 0&&(t[r]=e[r]);return t}function A(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?x:j}function q(){return{}}function C(e){return e}function k(){}function x(){return!1}function j(){return Date.now()}function R(){return Math.round(Date.now()/1e3)}function F(){return new Date(Date.now()).toISOString()}function T(){function e(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}t.exports.default=f;t.exports.pino=f}));var E=()=>global.crypto,P=()=>{typeof window<"u"||(E()||(global.crypto=o("crypto")),!E().getRandomValues&&E().webcrypto&&(global.crypto.getRandomValues=E().webcrypto.getRandomValues.bind(E().webcrypto)))};var _={};c(_,{escape:()=>Se,getHighlightedSuggestion:()=>we,highlightString:()=>me});function $(e,t){let r=`\n  The following properties are invalid:\n\n    ${e.join(`\n\t`)}\n  \n  ${t}\n  `;return new U(r)}var U=class extends Error{constructor(e){super(e),this.name="SchemaValidationError"}},V=class{constructor(e){this.definition=e}validate(e={},t=""){let r={...this.default,...e},n=[];for(let e in this.definition){let t=this.definition[e].validate(r[e]);t&&n.push(`${e}: ${t}`)}if(n.length)throw $(n,t);return r}get default(){let e={};for(let t in this.definition){let r=this.definition[t].default;r!==void 0&&(e[t]=r)}return e}},Q=class{constructor(e={}){this.baseConfig=e}validate(e){return this.baseConfig.required&&N(e)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return this.baseConfig.required===!0}};function L(e){return e===void 0}function B(e){return e===null}function N(e){return L(e)||B(e)}var z=class{constructor(e={}){this.config=e,this.value=new Q(e)}validate(e){let t=this.value.validate(e);return t||(H(e)?e<this.config.min?`minimum value of ${this.config.min} not respected.`:e>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}};function H(e){return L(e)||Y(e)}function Y(e){return typeof e=="number"&&!isNaN(e)}var G=class{constructor(e={}){this.value=new Q(e)}validate(e){let t=this.value.validate(e);return t||(W(e)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}};function W(e){return L(e)||J(e)}function J(e){return typeof e=="boolean"}var K=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i,Z=class{constructor(e={}){this.config={emptyAllowed:!0,url:!1,...e},this.value=new Q(this.config)}validate(e){let{emptyAllowed:t,url:r,regex:n,constrainTo:i}=this.config,a=this.value.validate(e);return a||(L(e)?null:X(e)?!t&&!e.length?"value is an empty string.":r&&!K.test(e)?"value is not a valid URL.":n&&!n.test(e)?`value did not match provided regex ${n}`:i&&!i.includes(e)?`value should be one of: ${i.join(", ")}.`:null:"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}};function X(e){return Object.prototype.toString.call(e)==="[object String]"}var ee=class{constructor(e={}){this.config={options:{required:!1},values:{},...e}}validate(e){if(L(e))return this.config.options.required?"value is required and is currently undefined":null;if(!te(e))return"value is not an object";for(let[t,r]of Object.entries(this.config.values))if(r.required&&N(e[t]))return`value does not contain ${t}`;let t="";for(let[r,n]of Object.entries(this.config.values)){let i=e[r],a=n.validate(i);a!==null&&(t+=" "+a)}return t===""?null:t}get default(){}get required(){return!!this.config.options.required}};function te(e){return e!==void 0&&typeof e=="object"}var re=class{constructor(e={}){this.config=e,this.value=new Q(this.config)}validate(e){if(!N(e)&&!Array.isArray(e))return"value is not an array";let t=this.value.validate(e);if(t!==null)return t;if(N(e))return null;if(this.config.max!==void 0&&e.length>this.config.max)return`value contains more than ${this.config.max}`;if(this.config.min!==void 0&&e.length<this.config.min)return`value contains less than ${this.config.min}`;if(this.config.each!==void 0){let t="";return e.forEach((r=>{this.config.each.required&&N(r)&&(t=`value is null or undefined: ${e.join(",")}`);let n=this.validatePrimitiveValue(r,this.config.each);n!==null&&(t+=" "+n)})),t===""?null:t}return null}validatePrimitiveValue(e,t){return J(e)||X(e)||Y(e)||te(e)?t.validate(e):"value is not a primitive value"}get default(){}get required(){return this.value.required}};function ne(e){return Array.isArray(e)}var ie=class{constructor(e){this.config=e,this.value=new Q(e)}validate(e){let t=this.value.validate(e);return t!==null?t:L(e)||Object.values(this.config.enum).find((t=>t===e))?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}};var ae=d(p()),se=(e,t=5)=>e+Math.random().toString(36).substring(2,2+t);function oe(e){return Array.isArray(e)}function ue(e){return e.trim()===""}function ce(e,t){return[...e.reduce(((e,r)=>{let n=t(r);return e.has(n)||e.set(n,r),e}),new Map).values()]}function le(e){return(typeof btoa<"u"?btoa:ae.btoa)(encodeURI(e))}function de(e,t){let{[e]:r,...n}=t;return n}function fe(e){return le(JSON.stringify(e))}var he=new Set(["1",1,"yes",!0]);function ge(){if(typeof navigator>"u"||typeof window>"u")return!1;let e=navigator,t=window;return[e.globalPrivacyControl,e.doNotTrack,e.msDoNotTrack,t.doNotTrack].some((e=>he.has(e)))}function pe(e){let t={};for(let[r,n]of e)t[r]=n;return t}function ye(e,t,r){return clearTimeout(t),setTimeout(e,r)}function ve(e){if(typeof e!="object"||!e)return e;try{return JSON.parse(JSON.stringify(e))}catch{return e}}function me(e){if(ue(e.openingDelimiter)||ue(e.closingDelimiter))throw Error("delimiters should be a non-empty string");if(N(e.content)||ue(e.content))return e.content;if(e.highlights.length===0)return Se(e.content);let t=e.content.length,r="",n=0;for(let i=0;i<e.highlights.length;i++){let a=e.highlights[i],s=a.offset,o=s+a.length;if(o>t)break;r+=Se(e.content.slice(n,s)),r+=e.openingDelimiter,r+=Se(e.content.slice(s,o)),r+=e.closingDelimiter,n=o}return n!==t&&(r+=Se(e.content.slice(n))),r}function we(e,t){return e=Se(e),e.replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,((e,r,n,i)=>r?be(r,t.notMatchDelimiters):n?be(n,t.exactMatchDelimiters):i?be(i,t.correctionDelimiters):e))}function be(e,t){return t?t.open+e+t.close:e}function Se(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r="(?:"+Object.keys(t).join("|")+")",n=RegExp(r),i=RegExp(r,"g");return n.test(e)?e.replace(i,(e=>t[e])):e}async function Ie(e,t){let r=e.getReader(),n;for(;!(n=await r.read()).done;)t(n.value)}function Oe(e){let t,r,n,i=!1;return function(a){t===void 0?(t=a,r=0,n=-1):t=qe(t,a);let s=t.length,o=0;for(;r<s;){i&&(t[r]===10&&(o=++r),i=!1);let a=-1;for(;r<s&&a===-1;++r)switch(t[r]){case 58:n===-1&&(n=r-o);break;case 13:i=!0;case 10:a=r;break}if(a===-1)break;e(t.subarray(o,a),n),o=r,n=-1}o===s?t=void 0:o!==0&&(t=t.subarray(o),r-=o)}}function Ae(e,t,r){let n=Ce(),i=new TextDecoder;return function(a,s){if(a.length===0)r?.(n),n=Ce();else if(s>0){let r=i.decode(a.subarray(0,s)),o=s+(a[s+1]===32?2:1),u=i.decode(a.subarray(o));switch(r){case"data":n.data=n.data?n.data+`\n`+u:u;break;case"event":n.event=u;break;case"id":e(n.id=u);break;case"retry":let r=parseInt(u,10);isNaN(r)||t(n.retry=r);break}}}}function qe(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function Ce(){return{data:"",event:"",id:"",retry:void 0}}var ke=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r},xe="text/event-stream",je=1e3,Re="last-event-id";function Fe(){}function Te(e,t){var{signal:r,headers:n,onopen:i,onmessage:a,onclose:s,onerror:o,openWhenHidden:u,fetch:c}=t,l=ke(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise(((t,d)=>{let f=Object.assign({},n);f.accept||(f.accept=xe);let h;function g(){h?.abort(),document.hidden||b()}!u&&Fe()&&document.addEventListener("visibilitychange",g);let p=je,y=0;function v(){Fe()&&document.removeEventListener("visibilitychange",g),clearTimeout(y),h?.abort()}r?.addEventListener("abort",(()=>{v(),t()}));let m=c??m,w=i??De;async function b(){var r;h=typeof AbortController>"u"?null:new AbortController;try{let r=await m(e,Object.assign(Object.assign({},l),{headers:f,signal:h?.signal}));await w(r),await Ie(r.body,Oe(Ae((e=>{e?f[Re]=e:delete f[Re]}),(e=>{p=e}),a))),s?.(),v(),t()}catch(e){if(!h?.signal.aborted)try{let t=(r=o?.(e))!==null&&r!==void 0?r:p;clearTimeout(y),y=setTimeout(b,t)}catch(e){v(),d(e)}}}b()}))}function De(e){let t=e.headers.get("content-type");if(!t?.startsWith(xe))throw new Error(`Expected content-type to be ${xe}, Actual: ${t}`)}function Me(){if(typeof window>"u"){let{AbortController:e}=y();return new e}return typeof AbortController>"u"?null:new AbortController}var Ee=class{constructor(e){this._params={};this._basePath=e}addParam(e,t){this._params={...this.params,[e]:t}}get basePath(){return this._basePath}get params(){return this._params}get hasParams(){return Object.entries(this._params).length}get href(){return this.hasParams?`${this.basePath}?${Object.entries(this.params).map((([e,t])=>`${e}=${encodeURIComponent(t)}`)).join("&")}`:this.basePath}},Pe=e=>/^https:\/\/platform(dev|stg|hipaa)?(-)?(eu|au)?\.cloud\.coveo\.com/.test(e),_e=(e,t)=>{let r=$e(e);return r&&r.organizationId===t?r:null},$e=e=>{let t=e.match(/^https:\/\/(?<organizationId>\w+)\.org(?<environment>dev|stg|hipaa)?\.coveo\.com/);return t?.groups?t.groups:null};var Ue=(e,t,r)=>new Ee(`${e}/rest/organizations/${t}/machinelearning/streaming/${r}`).href,Ve=3,Qe=5e3,Le="text/event-stream",Be=1,Ne=class extends Error{},ze=class extends Error{constructor(e){super(e.message);this.payload=e}},He=class{constructor(){this.timeouts=new Set}add(e){this.timeouts.add(e)}remove(e){clearTimeout(e),this.timeouts.delete(e)}isActive(e){return this.timeouts.has(e)}},Ye=class{constructor(e){this.logger=e.logger}streamGeneratedAnswer(e,t){let{url:r,organizationId:n,streamId:i,accessToken:a}=e,{write:s,abort:o,close:u,resetAnswer:c}=t,l=new He;if(!i){this.logger.error("No stream ID found");return}let d=0,f,h=()=>{f&&!l.isActive(f)&&(p?.abort(),c(),y())},g=()=>{l.remove(f),f=ye(h,f,Qe),l.add(f)},p=Me(),y=()=>Te(Ue(r,n,i),{method:"GET",fetch,headers:{Authorization:`Bearer ${a}`,accept:"*/*"},openWhenHidden:!0,signal:p?.signal,async onopen(e){if(e.ok&&e.headers.get("content-type")===Le)return;throw e.status>=400&&e.status<500&&e.status!==429?new ze({message:"Error opening stream",code:e.status}):new Ne},onmessage:e=>{if(p?.signal.aborted)return;let t=JSON.parse(e.data);if(t.finishReason==="ERROR"){l.remove(f),p?.abort(),o({message:t.errorMessage,code:t.statusCode});return}s(t),d=0,t.finishReason==="COMPLETED"?(l.remove(f),u()):g()},onerror:e=>{if(!p?.signal.aborted){if(l.remove(f),e instanceof ze)throw p?.abort(),o(e),e;if(++d>Ve){this.logger.info("Maximum retry exceeded.");let e={message:"Failed to complete stream.",code:Be};throw p?.abort(),o(e),new ze(e)}this.logger.info(`Retrying...(${d}/${Ve})`),c()}}});return y(),p}};var Ge=e=>e;var We=d(v()),Je=d(C());var Ke=class extends Error{constructor(){super(),this.name="ExpiredToken",this.message="The token being used to perform the request is expired."}},Ze=class extends Error{constructor(e,t){super(),this.name="Disconnected",this.message=`Client could not connect to the following URL: ${e}`,this.statusCode=t??0}};function Xe(e){let t=[];for(let r in e){let n=encodeURIComponent(r),i=encodeURIComponent(e[r]);t.push(`${n}=${i}`)}return t.join("&")}function et(e){return typeof e!="object"||!e?!1:Object.values(e).every(tt)}function tt(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function rt(e){return e===429}var nt=class e{static async call(t){let r=ut(t),{logger:n}=t,i=await e.preprocessRequest(r,t);n.info(i,"Platform request");let{url:a,...s}=i,o=async()=>{let e=await(0,We.default)(a,s);if(rt(e.status))throw e;return e};try{let e=await(0,Je.backOff)(o,{retry:e=>{let t=e&&rt(e.status);return t&&n.info("Platform retrying request"),t}});if(e.status===419)throw n.info("Platform renewing token"),new Ke;if(e.status===404)throw new Ze(a,e.status);return n.info({response:e,requestInfo:i},"Platform response"),e}catch(e){return e.message==="Failed to fetch"?new Ze(a):e}}static async preprocessRequest(e,t){let{origin:r,preprocessRequest:n,logger:i,requestMetadata:a}=t,{signal:s,...o}=e,u=ve(o);try{let t=await n(e,r,a);return{...e,...t}}catch(e){i.error(e,"Platform request preprocessing failed. Returning default request options.")}return u}};function it(e,t){let r=!t||!t.environment||t.environment==="prod"?"":t.environment,n=!t||!t.region||t.region==="us"?"":`-${t.region}`;return`https://${e}${r}${n}.cloud.coveo.com`}function at(e,t="prod"){let r=t==="prod"?"":t,n=`https://${e}.org${r}.coveo.com`,i=`https://${e}.analytics.org${r}.coveo.com`,a=`${n}/rest/search/v2`,s=`https://${e}.admin.org${r}.coveo.com`;return{platform:n,analytics:i,search:a,admin:s}}function st(e){return e?.multiRegionSubDomain?`https://${e.multiRegionSubDomain}.org.coveo.com`:it("platform",e)}function ot(e){return it("analytics",e)}function ut(e){let{url:t,method:r,requestParams:n,contentType:i,accessToken:a,signal:s}=e,o=e.method==="POST"||e.method==="PUT",u=ct(n,i);return{url:t,method:r,headers:{"Content-Type":i,Authorization:`Bearer ${a}`,...e.headers},...o&&{body:u},signal:s}}function ct(e,t){return t==="application/x-www-form-urlencoded"?et(e)?Xe(e):"":JSON.stringify(e)}function lt(){return{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}}function dt(){return{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:lt(),pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],searchResponseId:"",requestId:"",questionAnswer:lt(),extendedResults:{}}}function ft(e){let{url:t,accessToken:r,organizationId:n,authentication:i,...a}=e;return a}var ht=(e,t)=>{let r=new Ee(`${e.url}${t}`);return r.addParam("access_token",e.accessToken),r.addParam("organizationId",e.organizationId),r.addParam("uniqueId",e.uniqueId),e.q!==void 0&&r.addParam("q",e.q),e.enableNavigation!==void 0&&r.addParam("enableNavigation",`${e.enableNavigation}`),e.requestedOutputSize!==void 0&&r.addParam("requestedOutputSize",`${e.requestedOutputSize}`),e.visitorId!==void 0&&r.addParam("visitorId",`${e.visitorId}`),r.href};function gt(e){return{statusCode:e.statusCode,type:e.name,message:e.message}}function pt(e){return{statusCode:e.code,type:e.name,message:e.message,ignored:!0}}function yt(e,t){if(t&&e.name==="AbortError")return{error:pt(e)};if(e instanceof Ze)return{error:gt(e)};throw e}var vt=e=>e.success!==void 0,mt=e=>e.error!==void 0;function wt(e){return e.results!==void 0}function bt(e){let t=lt();return N(e.questionAnswer)?(e.questionAnswer=t,e):(e.questionAnswer={...t,...e.questionAnswer},e)}var St=(e,t)=>`${e.url}/rest/organizations/${e.organizationId}/insight/v1/configs/${e.insightId}${t??""}`,It=(e,t,r,n)=>{At(e);let i=St(e,n);return{accessToken:e.accessToken,method:t,contentType:r,url:i,origin:"insightApiFetch"}},Ot=e=>{let{insightId:t,...r}=ft(e);return r},At=e=>{if(!e.url)throw new Error("The 'url' attribute must contain a valid platform URL.");if(!e.organizationId)throw new Error("The 'organizationId' attribute must contain a valid organization ID.");if(!e.accessToken)throw new Error("The 'accessToken' attribute must contain a valid platform access token.");if(!e.insightId)throw new Error("The 'insightId' attribute must contain a valid Insight Panel configuration ID.")};var qt=e=>({...It(e,"GET","application/json","/interface"),requestParams:{}});var Ct=e=>({...It(e,"POST","application/json","/search"),requestParams:Ot(e)}),kt=e=>({...It(e,"POST","application/json","/querysuggest"),requestParams:Ot(e)});var xt=e=>{let t=Ot(e);return{...It(e,"POST","application/json","/useractions"),requestParams:{ticketCreationDate:t.ticketCreationDate,numberSessionsBefore:t.numberSessionsBefore??50,numberSessionsAfter:t.numberSessionsAfter??50,maximumSessionInactivityMinutes:t.maximumSessionInactivityMinutes??30,excludedCustomActions:t.excludedCustomActions??[]}}};var jt=class{constructor(e){this.options=e}async getInterface(e){let t=await nt.call({...qt(e),...this.options});if(t instanceof Error)return yt(t);let r=await t.json();return t.ok?{success:r}:{error:r}}async query(e,t){let r=await nt.call({...Ct(e),requestMetadata:{method:"search",origin:t?.origin},...this.options});if(r instanceof Error)return yt(r);let n=await r.json();return wt(n)&&(n=bt(n)),r.ok?{success:n}:{error:n}}async querySuggest(e){let t=await nt.call({...kt(e),...this.options});if(t instanceof Error)return yt(t);let r=await t.json();return r.completions?{success:r}:{error:r}}async userActions(e){let t=await nt.call({...xt(e),...this.options});if(t instanceof Error)return yt(t);let r=await t.json();return t.ok?{success:r}:{error:r}}};var Rt=new Z({required:!0,emptyAllowed:!1}),Ft=new Z({required:!1,emptyAllowed:!1}),Tt=new Z({required:!0,emptyAllowed:!0}),Dt=new Z({required:!1,emptyAllowed:!0}),Mt=new re({each:Rt,required:!0}),Et=new Z({required:!1,emptyAllowed:!1,regex:/^\d+\.\d+\.\d+$/}),Pt=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),_t=(e,t)=>{if("required"in t)return{payload:new V({value:t}).validate({value:e}).value};let r=new ee({options:{required:!0},values:t}).validate(e);if(r)throw new U(r);return{payload:e}},$t=(e,t)=>{try{return _t(e,t)}catch(t){return{payload:e,error:Pt(t)}}},Ut=(e,t,r,n)=>{let i=`Check the initialState of ${n}`;return Qt(e,t,r,i,"Controller initialization error")},Vt=(e,t,r,n)=>{let i=`Check the options of ${n}`;return Qt(e,t,r,i,"Controller initialization error")},Qt=(e,t,r,n,i)=>{try{return t.validate(r,n)}catch(t){throw e.logger.error(t,i),t}};function Lt(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Bt=typeof Symbol=="function"&&Symbol.observable||"@@observable",Nt=Bt,zt=()=>Math.random().toString(36).substring(7).split("").join("."),Ht={INIT:`@@redux/INIT${zt()}`,REPLACE:`@@redux/REPLACE${zt()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${zt()}`},Yt=Ht;function Gt(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Wt(e,t,r){if(typeof e!="function")throw new Error(Lt(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Lt(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Lt(1));return r(Wt)(e,t)}let n=e,i=t,a=new Map,s=a,o=0,u=!1;function c(){s===a&&(s=new Map,a.forEach(((e,t)=>{s.set(t,e)})))}function l(){if(u)throw new Error(Lt(3));return i}function d(e){if(typeof e!="function")throw new Error(Lt(4));if(u)throw new Error(Lt(5));let t=!0;c();let r=o++;return s.set(r,e),function(){if(t){if(u)throw new Error(Lt(6));t=!1,c(),s.delete(r),a=null}}}function f(e){if(!Gt(e))throw new Error(Lt(7));if(typeof e.type>"u")throw new Error(Lt(8));if(typeof e.type!="string")throw new Error(Lt(17));if(u)throw new Error(Lt(9));try{u=!0,i=n(i,e)}finally{u=!1}return(a=s).forEach((e=>{e()})),e}function h(e){if(typeof e!="function")throw new Error(Lt(10));n=e,f({type:Yt.REPLACE})}function g(){let e=d;return{subscribe(t){if(typeof t!="object"||t===null)throw new Error(Lt(11));function r(){let e=t;e.next&&e.next(l())}return r(),{unsubscribe:e(r)}},[Nt](){return this}}}return f({type:Yt.INIT}),{dispatch:f,subscribe:d,getState:l,replaceReducer:h,[Nt]:g}}function Jt(e){Object.keys(e).forEach((t=>{let r=e[t];if(typeof r(void 0,{type:Yt.INIT})>"u")throw new Error(Lt(12));if(typeof r(void 0,{type:Yt.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Lt(13))}))}function Kt(e){let t=Object.keys(e),r={};for(let n=0;n<t.length;n++){let i=t[n];typeof e[i]=="function"&&(r[i]=e[i])}let n=Object.keys(r),i;try{Jt(r)}catch(e){i=e}return function(e={},t){if(i)throw i;let a=!1,s={};for(let i=0;i<n.length;i++){let o=n[i],u=r[o],c=e[o],l=u(c,t);if(typeof l>"u"){throw new Error(Lt(14))}s[o]=l,a=a||l!==c}return a=a||n.length!==Object.keys(e).length,a?s:e}}function Zt(...e){return e.length===0?e=>e:e.length===1?e[0]:e.reduce(((e,t)=>(...r)=>e(t(...r))))}function Xt(...e){return t=>(r,n)=>{let i=t(r,n),a=()=>{throw new Error(Lt(15))},s={getState:i.getState,dispatch:(e,...t)=>a(e,...t)},o=e.map((e=>e(s)));return a=Zt(...o)(i.dispatch),{...i,dispatch:a}}}function er(e){return Gt(e)&&"type"in e&&typeof e.type=="string"}var tr=Symbol.for("immer-nothing"),rr=Symbol.for("immer-draftable"),nr=Symbol.for("immer-state");function ir(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var ar=Object.getPrototypeOf;function sr(e){return!!e&&!!e[nr]}function or(e){return e?cr(e)||Array.isArray(e)||!!e[rr]||!!e.constructor?.[rr]||pr(e)||yr(e):!1}var ur=Object.prototype.constructor.toString();function cr(e){if(!e||typeof e!="object")return!1;let t=ar(e);if(t===null)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===ur}function lr(e,t){dr(e)===0?Object.entries(e).forEach((([r,n])=>{t(r,n,e)})):e.forEach(((r,n)=>t(n,r,e)))}function dr(e){let t=e[nr];return t?t.type_:Array.isArray(e)?1:pr(e)?2:yr(e)?3:0}function fr(e,t){return dr(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function hr(e,t,r){let n=dr(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function gr(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function pr(e){return e instanceof Map}function yr(e){return e instanceof Set}function vr(e){return e.copy_||e.base_}function mr(e,t){if(pr(e))return new Map(e);if(yr(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&cr(e))return ar(e)?{...e}:Object.assign(Object.create(null),e);let r=Object.getOwnPropertyDescriptors(e);delete r[nr];let n=Reflect.ownKeys(r);for(let t=0;t<n.length;t++){let i=n[t],a=r[i];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]})}return Object.create(ar(e),r)}function wr(e,t=!1){return Sr(e)||sr(e)||!or(e)||(dr(e)>1&&(e.set=e.add=e.clear=e.delete=br),Object.freeze(e),t&&lr(e,((e,t)=>wr(t,!0)))),e}function br(){ir(2)}function Sr(e){return Object.isFrozen(e)}var Ir={};function Or(e){let t=Ir[e];return t||ir(0,e),t}var Ar;function qr(){return Ar}function Cr(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function kr(e,t){t&&(Or("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function xr(e){jr(e),e.drafts_.forEach(Fr),e.drafts_=null}function jr(e){e===Ar&&(Ar=e.parent_)}function Rr(e){return Ar=Cr(Ar,e)}function Fr(e){let t=e[nr];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Tr(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[nr].modified_&&(xr(t),ir(4)),or(e)&&(e=Dr(t,e),t.parent_||Er(t,e)),t.patches_&&Or("Patches").generateReplacementPatches_(r[nr].base_,e,t.patches_,t.inversePatches_)):e=Dr(t,r,[]),xr(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==tr?e:void 0}function Dr(e,t,r){if(Sr(t))return t;let n=t[nr];if(!n)return lr(t,((i,a)=>Mr(e,n,t,i,a,r))),t;if(n.scope_!==e)return t;if(!n.modified_)return Er(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let t=n.copy_,i=t,a=!1;n.type_===3&&(i=new Set(t),t.clear(),a=!0),lr(i,((i,s)=>Mr(e,n,t,i,s,r,a))),Er(e,t,!1),r&&e.patches_&&Or("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function Mr(e,t,r,n,i,a,s){if(sr(i)){let s=a&&t&&t.type_!==3&&!fr(t.assigned_,n)?a.concat(n):void 0,o=Dr(e,i,s);if(hr(r,n,o),sr(o))e.canAutoFreeze_=!1;else return}else s&&r.add(i);if(or(i)&&!Sr(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Dr(e,i),(!t||!t.scope_.parent_)&&Er(e,i)}}function Er(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&wr(t,r)}function Pr(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:qr(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},i=n,a=_r;r&&(i=[n],a=$r);let{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var _r={get(e,t){if(t===nr)return e;let r=vr(e);if(!fr(r,t))return Vr(e,r,t);let n=r[t];return e.finalized_||!or(n)?n:n===Ur(e.base_,t)?(Br(e),e.copy_[t]=zr(n,e)):n},has(e,t){return t in vr(e)},ownKeys(e){return Reflect.ownKeys(vr(e))},set(e,t,r){let n=Qr(vr(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let n=Ur(vr(e),t),i=n?.[nr];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(gr(r,n)&&(r!==void 0||fr(e.base_,t)))return!0;Br(e),Lr(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Ur(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Br(e),Lr(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=vr(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){ir(11)},getPrototypeOf(e){return ar(e.base_)},setPrototypeOf(){ir(12)}},$r={};lr(_r,((e,t)=>{$r[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}));$r.deleteProperty=function(e,t){return $r.set.call(this,e,t,void 0)};$r.set=function(e,t,r){return _r.set.call(this,e[0],t,r,e[0])};function Ur(e,t){let r=e[nr];return(r?vr(r):e)[t]}function Vr(e,t,r){let n=Qr(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function Qr(e,t){if(!(t in e))return;let r=ar(e);for(;r;){let e=Object.getOwnPropertyDescriptor(r,t);if(e)return e;r=ar(r)}}function Lr(e){e.modified_||(e.modified_=!0,e.parent_&&Lr(e.parent_))}function Br(e){e.copy_||(e.copy_=mr(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Nr=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){let r=t;t=e;let n=this;return function(e=r,...i){return n.produce(e,(e=>t.call(this,e,...i)))}}typeof t!="function"&&ir(6),r!==void 0&&typeof r!="function"&&ir(7);let n;if(or(e)){let i=Rr(this),a=zr(e,void 0),s=!0;try{n=t(a),s=!1}finally{s?xr(i):jr(i)}return kr(i,r),Tr(n,i)}else if(!e||typeof e!="object"){if(n=t(e),n===void 0&&(n=e),n===tr&&(n=void 0),this.autoFreeze_&&wr(n,!0),r){let t=[],i=[];Or("Patches").generateReplacementPatches_(e,n,t,i),r(t,i)}return n}else ir(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(t,...r)=>this.produceWithPatches(t,(t=>e(t,...r)));let r,n;return[this.produce(e,t,((e,t)=>{r=e,n=t})),r,n]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){or(e)||ir(8),sr(e)&&(e=Hr(e));let t=Rr(this),r=zr(e,void 0);return r[nr].isManual_=!0,jr(t),r}finishDraft(e,t){let r=e&&e[nr];(!r||!r.isManual_)&&ir(9);let{scope_:n}=r;return kr(n,t),Tr(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let n=t[r];if(n.path.length===0&&n.op==="replace"){e=n.value;break}}r>-1&&(t=t.slice(r+1));let n=Or("Patches").applyPatches_;return sr(e)?n(e,t):this.produce(e,(e=>n(e,t)))}};function zr(e,t){let r=pr(e)?Or("MapSet").proxyMap_(e,t):yr(e)?Or("MapSet").proxySet_(e,t):Pr(e,t);return(t?t.scope_:qr()).drafts_.push(r),r}function Hr(e){return sr(e)||ir(10,e),Yr(e)}function Yr(e){if(!or(e)||Sr(e))return e;let t=e[nr],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=mr(e,t.scope_.immer_.useStrictShallowCopy_)}else r=mr(e,!0);return lr(r,((e,t)=>{hr(r,e,Yr(t))})),t&&(t.finalized_=!1),r}var Gr=new Nr,Wr=Gr.produce;Gr.produceWithPatches.bind(Gr);Gr.setAutoFreeze.bind(Gr);Gr.setUseStrictShallowCopy.bind(Gr);Gr.applyPatches.bind(Gr);Gr.createDraft.bind(Gr);Gr.finishDraft.bind(Gr);function Jr(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Kr(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Zr(e,t="expected all items to be functions, instead received the following types: "){if(!e.every((e=>typeof e=="function"))){let r=e.map((e=>typeof e=="function"?`function ${e.name||"unnamed"}()`:typeof e)).join(", ");throw new TypeError(`${t}[${r}]`)}}var Xr=e=>Array.isArray(e)?e:[e];function en(e){let t=Array.isArray(e[0])?e[0]:e;return Zr(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function tn(e,t){let r=[],{length:n}=e;for(let i=0;i<n;i++)r.push(e[i].apply(null,t));return r}var rn=class{constructor(e){this.value=e}deref(){return this.value}},nn=typeof WeakRef<"u"?WeakRef:rn,an=0,sn=1;function on(){return{s:an,v:void 0,o:null,p:null}}function un(e,t={}){let r=on(),{resultEqualityCheck:n}=t,i,a=0;function s(){let t=r,{length:s}=arguments;for(let e=0,r=s;e<r;e++){let r=arguments[e];if(typeof r=="function"||typeof r=="object"&&r!==null){let e=t.o;e===null&&(t.o=e=new WeakMap);let n=e.get(r);n===void 0?(t=on(),e.set(r,t)):t=n}else{let e=t.p;e===null&&(t.p=e=new Map);let n=e.get(r);n===void 0?(t=on(),e.set(r,t)):t=n}}let o=t,u;if(t.s===sn?u=t.v:(u=e.apply(null,arguments),a++),o.s=sn,n){let e=i?.deref?.()??i;e!=null&&n(e,u)&&(u=e,a!==0&&a--),i=typeof u=="object"&&u!==null||typeof u=="function"?new nn(u):u}return o.v=u,u}return s.clearCache=()=>{r=on(),s.resetResultsCount()},s.resultsCount=()=>a,s.resetResultsCount=()=>{a=0},s}function cn(e,...t){let r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...e)=>{let t=0,n=0,i,a={},s=e.pop();typeof s=="object"&&(a=s,s=e.pop()),Jr(s,`createSelector expects an output function after the inputs, but received: [${typeof s}]`);let o={...r,...a},{memoize:u,memoizeOptions:c=[],argsMemoize:l=un,argsMemoizeOptions:d=[],devModeChecks:f={}}=o,h=Xr(c),g=Xr(d),p=en(e),y=u((function(){return t++,s.apply(null,arguments)}),...h),v=l((function(){n++;let e=tn(p,arguments);return i=y.apply(null,e),i}),...g);return Object.assign(v,{resultFunc:s,memoizedResultFunc:y,dependencies:p,dependencyRecomputations:()=>n,resetDependencyRecomputations:()=>{n=0},lastResult:()=>i,recomputations:()=>t,resetRecomputations:()=>{t=0},memoize:u,argsMemoize:l})};return Object.assign(n,{withTypes:()=>n}),n}var ln=cn(un),dn=Object.assign(((e,t=ln)=>{Kr(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e),n=r.map((t=>e[t]));return t(n,((...e)=>e.reduce(((e,t,n)=>(e[r[n]]=t,e)),{})))}),{withTypes:()=>dn});function fn(e){return({dispatch:t,getState:r})=>n=>i=>typeof i=="function"?i(t,r,e):n(i)}var hn=fn(),gn=fn;var pn=(...e)=>{let t=cn(...e),r=Object.assign(((...e)=>{let r=t(...e),n=(e,...t)=>r(sr(e)?Hr(e):e,...t);return Object.assign(n,r),n}),{withTypes:()=>r});return r};pn(un);var yn=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Zt:Zt.apply(null,arguments)},vn=e=>e&&typeof e.match=="function";function mn(e,t){function r(...r){if(t){let n=t(...r);if(!n)throw new Error(Jn(0));return{type:e,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:e,payload:r[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=t=>er(t)&&t.type===e,r}var wn=class e extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(...e){return super.concat.apply(this,e)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new e(...t[0].concat(this)):new e(...t.concat(this))}};function bn(e){return or(e)?Wr(e,(()=>{})):e}function Sn(e){return typeof e=="boolean"}var In=()=>function(e){let{thunk:t=!0,immutableCheck:r=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=e??{},a=new wn;return t&&(Sn(t)?a.push(hn):a.push(gn(t.extraArgument))),a},On="RTK_autoBatch";var An=e=>t=>{setTimeout(t,e)},qn=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:An(10),Cn=(e={type:"raf"})=>t=>(...r)=>{let n=t(...r),i=!0,a=!1,s=!1,o=new Set,u=e.type==="tick"?queueMicrotask:e.type==="raf"?qn:e.type==="callback"?e.queueNotification:An(e.timeout),c=()=>{s=!1,a&&(a=!1,o.forEach((e=>e())))};return Object.assign({},n,{subscribe(e){let t=()=>i&&e(),r=n.subscribe(t);return o.add(e),()=>{r(),o.delete(e)}},dispatch(e){try{return i=!e?.meta?.[On],a=!i,a&&(s||(s=!0,u(c))),n.dispatch(e)}finally{i=!0}}})},kn=e=>function(t){let{autoBatch:r=!0}=t??{},n=new wn(e);return r&&n.push(Cn(typeof r=="object"?r:void 0)),n},xn=!0;function jn(e){let t=In(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:s=void 0}=e||{},o;if(typeof r=="function")o=r;else if(Gt(r))o=Kt(r);else throw new Error(Jn(1));let u;if(typeof n=="function"){if(u=n(t),!xn);}else u=t();let c=Zt;i&&(c=yn({trace:!xn,...typeof i=="object"&&i}));let l=Xt(...u),d=kn(l);let f=typeof s=="function"?s(d):d();let h=c(...f);return Wt(o,a,h)}function Rn(e){let t={},r=[],n,i={addCase(e,r){let n=typeof e=="string"?e:e.type;if(!n)throw new Error(Jn(28));if(n in t)throw new Error(Jn(29));return t[n]=r,i},addMatcher(e,t){return r.push({matcher:e,reducer:t}),i},addDefaultCase(e){return n=e,i}};return e(i),[t,r,n]}function Fn(e){return typeof e=="function"}function Tn(e,t){let[r,n,i]=Rn(t),a;if(Fn(e))a=()=>bn(e());else{let t=bn(e);a=()=>t}function s(e=a(),t){let s=[r[t.type],...n.filter((({matcher:e})=>e(t))).map((({reducer:e})=>e))];return s.filter((e=>!!e)).length===0&&(s=[i]),s.reduce(((e,r)=>{if(r)if(sr(e)){let n=r(e,t);return n===void 0?e:n}else{if(or(e))return Wr(e,(e=>r(e,t)));{let n=r(e,t);if(n===void 0){if(e===null)return e;throw new Error(Jn(9))}return n}}return e}),e)}return s.getInitialState=a,s}var Dn="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Mn=(e=21)=>{let t="",r=e;for(;r--;)t+=Dn[Math.random()*64|0];return t},En=(e,t)=>vn(e)?e.match(t):e(t);function Pn(...e){return t=>e.some((e=>En(e,t)))}var _n=["name","message","stack","code"],$n=class{constructor(e,t){f(this,"_type");this.payload=e,this.meta=t}},Un=class{constructor(e,t){f(this,"_type");this.payload=e,this.meta=t}},Vn=e=>{if(typeof e=="object"&&e!==null){let t={};for(let r of _n)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},Qn=(()=>{function e(e,t,r){let n=mn(e+"/fulfilled",((e,t,r,n)=>({payload:e,meta:{...n||{},arg:r,requestId:t,requestStatus:"fulfilled"}}))),i=mn(e+"/pending",((e,t,r)=>({payload:void 0,meta:{...r||{},arg:t,requestId:e,requestStatus:"pending"}}))),a=mn(e+"/rejected",((e,t,n,i,a)=>({payload:i,error:(r&&r.serializeError||Vn)(e||"Rejected"),meta:{...a||{},arg:n,requestId:t,rejectedWithValue:!!i,requestStatus:"rejected",aborted:e?.name==="AbortError",condition:e?.name==="ConditionError"}})));function s(e){return(s,o,u)=>{let c=r?.idGenerator?r.idGenerator(e):Mn(),l=new AbortController,d,f;function h(e){f=e,l.abort()}let g=async function(){let g;try{let a=r?.condition?.(e,{getState:o,extra:u});if(Bn(a)&&(a=await a),a===!1||l.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};let p=new Promise(((e,t)=>{d=()=>{t({name:"AbortError",message:f||"Aborted"})},l.signal.addEventListener("abort",d)}));s(i(c,e,r?.getPendingMeta?.({requestId:c,arg:e},{getState:o,extra:u}))),g=await Promise.race([p,Promise.resolve(t(e,{dispatch:s,getState:o,extra:u,requestId:c,signal:l.signal,abort:h,rejectWithValue:(e,t)=>new $n(e,t),fulfillWithValue:(e,t)=>new Un(e,t)})).then((t=>{if(t instanceof $n)throw t;return t instanceof Un?n(t.payload,c,e,t.meta):n(t,c,e)}))])}catch(t){g=t instanceof $n?a(null,c,e,t.payload,t.meta):a(t,c,e)}finally{d&&l.signal.removeEventListener("abort",d)}return r&&!r.dispatchConditionRejection&&a.match(g)&&g.meta.condition||s(g),g}();return Object.assign(g,{abort:h,requestId:c,arg:e,unwrap(){return g.then(Ln)}})}}return Object.assign(s,{pending:i,rejected:a,fulfilled:n,settled:Pn(a,n),typePrefix:e})}return e.withTypes=()=>e,e})();function Ln(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function Bn(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var Nn=(e,t)=>{if(typeof e!="function")throw new Error(Jn(32))};var zn="listenerMiddleware";var Hn=e=>{let{type:t,actionCreator:r,matcher:n,predicate:i,effect:a}=e;if(t)i=mn(t).match;else if(r)t=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(Jn(21));return Nn(a),{predicate:i,type:t,effect:a}},Yn=Object.assign((e=>{let{type:t,predicate:r,effect:n}=Hn(e);return{id:Mn(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Jn(22))}}}),{withTypes:()=>Yn});var Gn=Object.assign(mn(`${zn}/add`),{withTypes:()=>Gn});mn(`${zn}/removeAll`);var Wn=Object.assign(mn(`${zn}/remove`),{withTypes:()=>Wn});function Jn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}function Kn({config:e,environment:t,event:r,listenerManager:n}){let{url:i,token:a,mode:s}=e;s!=="disabled"&&(n.call(r),t.send(i,a,r))}var Zn=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Xn(e){return typeof e=="string"&&Zn.test(e)}function ei(e){let t="visitorId";return{getClientId:()=>{let r=e.get(),n=r.storage,i=n.getItem(t),a=i&&Xn(i)?i:r.generateUUID();return n.setItem(t,a),a},clear:()=>{e.get().storage.removeItem(t)}}}var ti="0.7.7";function ri(e){let{trackingId:t}=e;return{trackingId:t}}function ni(e){return(e.source||[]).concat([`relay@${ti}`])}function ii(e,t,r,n){let{getReferrer:i,getLocation:a,getUserAgent:s}=r,o=ri(t),u=n.getClientId();return Object.freeze({type:e,config:o,ts:Date.now(),source:ni(t),clientId:u,userAgent:s(),referrer:i(),location:a()})}function ai(e,t,r,n,i){return{...t,meta:ii(e,r,n,i)}}var si="*";function oi(){let e=[];function t({type:t,callback:r}){return e.findIndex((e=>e.type===t&&e.callback===r))}function r(e,t){return e.type==="*"||t===e.type}function n(r){return t(r)<0&&e.push(r),()=>o(r.type,r.callback)}function i(t){e.forEach((e=>{if(r(e,t.meta.type))try{e.callback(t)}catch(e){console.error(e)}}))}function a(t){if(t===si)e.length=0;else for(let r=e.length-1;r>=0;r--)e[r].type===t&&e.splice(r,1)}function s(r){let n=t(r);n>=0&&e.splice(n,1)}function o(e,t){t?s({type:e,callback:t}):a(e)}return{add:n,call:i,remove:o}}function ui({url:e,token:t,trackingId:r,...n}){return Object.freeze({url:e,token:t,trackingId:r,...!!n.mode&&{mode:n.mode},...!!n.source&&{source:n.source}})}function ci(e){let t=ui(e);return{get:()=>t,update:e=>{t=ui({...t,...e})}}}function li(){let e=typeof window<"u";return{sendMessage(t){e&&window.postMessage(t,"*")}}}var di=fi();function fi(){let e="coveo_",t=e=>{let t=e.split(".").slice(-2);return t.length==2?t.join("."):""};return{getItem(t){let r=`${e}${t}=`,n=document.cookie.split(";");for(let e of n){let t=e.replace(/^\s+/,"");if(t.lastIndexOf(r,0)===0)return t.substring(r.length,t.length)}return null},setItem(r,n,i){let a=t(window.location.hostname),s=`;expires=${new Date((new Date).getTime()+i).toUTCString()}`,o=a?`;domain=${a}`:"";document.cookie=`${e}${r}=${n}${s}${o};path=/;SameSite=Lax`},removeItem(e){this.setItem(e,"",-1)}}}function hi(){return{getItem(e){return di.getItem(e)||localStorage.getItem(e)},removeItem(e){di.removeItem(e),localStorage.removeItem(e)},setItem(e,t){localStorage.setItem(e,t),di.setItem(e,t,31556952e3)}}}function gi(){let e=document.referrer;return e===""?null:e}function pi(){return{runtime:"browser",send:(e,t,r)=>{let n=navigator.sendBeacon(`${e}?access_token=${t}`,new Blob([JSON.stringify([r])],{type:"application/json"}));if(li().sendMessage({kind:"EVENT_PROTOCOL",event:r,url:e,token:t}),!n)throw new Error("Failed to send the event(s) because the payload size exceeded the maximum allowed size (32 KB). Please contact support if the problem persists.")},getReferrer:()=>gi(),getLocation:()=>window.location.href,getUserAgent:()=>navigator.userAgent,generateUUID:()=>crypto.randomUUID(),storage:hi()}}function yi(){return{getItem(){return null},removeItem(){},setItem(){}}}function vi(){return{runtime:"null",send:()=>{},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>"",storage:yi()}}function mi(e){return e.get().mode!=="disabled"&&wi()?pi():vi()}function wi(){try{return typeof window=="object"}catch{return!1}}function bi(e){return{get:()=>Object.freeze(mi(e))}}function Si(e){let t=ci(e),r=oi(),n=bi(t),i=ei(n);return{emit:(e,a)=>{let s=t.get(),o=n.get(),u=ai(e,a,s,o,i);return Kn({config:s,environment:o,event:u,listenerManager:r})},getMeta:e=>ii(e,t.get(),n.get(),i),on:(e,t)=>r.add({type:e,callback:t}),off:(e,t)=>r.remove(e,t),updateConfig:e=>t.update(e),version:ti,clearStorage:()=>{i.clear()}}}var Ii="2.63.3",Oi=["@coveo/atomic","@coveo/quantic"];var Ai=ln((e=>e.source),(e=>[`@coveo/headless@${Ii}`].concat(Object.entries(e).map((([e,t])=>`${e}@${t}`)))));var qi=ln((e=>e.configuration.accessToken),(e=>e.configuration.analytics),(e=>Ai(e.configuration.analytics)),((e,{trackingId:t,nextApiBaseUrl:r,enabled:n},i)=>Si({mode:n?"emit":"disabled",url:r,token:e,trackingId:t,source:i})));function Ci(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function ki(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,a){function s(e){try{u(n.next(e))}catch(e){a(e)}}function o(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){e.done?r(e.value):i(e.value).then(s,o)}u((n=n.apply(e,t||[])).next())}))}var xi;(function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect"})(xi||(xi={}));function ji(){return typeof window<"u"}function Ri(){return typeof navigator<"u"}function Fi(){return typeof document<"u"}function Ti(){try{return typeof localStorage<"u"}catch{return!1}}function Di(){try{return typeof sessionStorage<"u"}catch{return!1}}function Mi(){return Ri()&&navigator.cookieEnabled}var Ei=[xi.click,xi.custom,xi.search,xi.view],Pi=(e,t)=>Ei.indexOf(e)!==-1?Object.assign({language:Fi()?document.documentElement.lang:"unknown",userAgent:Ri()?navigator.userAgent:"unknown"},t):t,_i=class e{static set(e,t,r){var n,i,a,s;r&&(i=new Date,i.setTime(i.getTime()+r)),s=window.location.hostname,s.indexOf(".")===-1?$i(e,t,i):(a=s.split("."),n=a[a.length-2]+"."+a[a.length-1],$i(e,t,i,n))}static get(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){var i=r[n];if(i=i.replace(/^\s+/,""),i.lastIndexOf(t,0)===0)return i.substring(t.length,i.length)}return null}static erase(t){e.set(t,"",-1)}};function $i(e,t,r,n){document.cookie=`${e}=${t}`+(r?`;expires=${r.toUTCString()}`:"")+(n?`;domain=${n}`:"")+";path=/;SameSite=Lax"}function Ui(){return Ti()?localStorage:Mi()?new Vi:Di()?sessionStorage:new Li}var Vi=class e{getItem(t){return _i.get(`${e.prefix}${t}`)}removeItem(t){_i.erase(`${e.prefix}${t}`)}setItem(t,r,n){_i.set(`${e.prefix}${t}`,r,n)}};Vi.prefix="coveo_";var Qi=class{constructor(){this.cookieStorage=new Vi}getItem(e){return localStorage.getItem(e)||this.cookieStorage.getItem(e)}removeItem(e){this.cookieStorage.removeItem(e),localStorage.removeItem(e)}setItem(e,t){localStorage.setItem(e,t),this.cookieStorage.setItem(e,t,31556926e3)}},Li=class{getItem(e){return null}removeItem(e){}setItem(e,t){}},Bi="__coveo.analytics.history",Ni=20,zi=1e3*60,Hi=75,Yi=class{constructor(e){this.store=e||Ui()}addElement(e){e.internalTime=(new Date).getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=this.getHistoryWithInternalTime();t!=null?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}addElementAsync(e){return ki(this,void 0,void 0,(function*(){e.internalTime=(new Date).getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=yield this.getHistoryWithInternalTimeAsync();t!=null?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}))}getHistory(){let e=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(e))}getHistoryAsync(){return ki(this,void 0,void 0,(function*(){let e=yield this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(e))}))}getHistoryWithInternalTime(){try{let e=this.store.getItem(Bi);return e&&typeof e=="string"?JSON.parse(e):[]}catch{return[]}}getHistoryWithInternalTimeAsync(){return ki(this,void 0,void 0,(function*(){try{let e=yield this.store.getItem(Bi);return e?JSON.parse(e):[]}catch{return[]}}))}setHistory(e){try{this.store.setItem(Bi,JSON.stringify(e.slice(0,Ni)))}catch{}}clear(){try{this.store.removeItem(Bi)}catch{}}getMostRecentElement(){let e=this.getHistoryWithInternalTime();return Array.isArray(e)?e.sort(((e,t)=>(t.internalTime||0)-(e.internalTime||0)))[0]:null}cropQueryElement(e){return e.name&&e.value&&e.name.toLowerCase()==="query"&&(e.value=e.value.slice(0,Hi)),e}isValidEntry(e){let t=this.getMostRecentElement();return t&&t.value==e.value?(e.internalTime||0)-(t.internalTime||0)>zi:!0}stripInternalTime(e){return Array.isArray(e)?e.map((e=>{let{name:t,time:r,value:n}=e;return{name:t,time:r,value:n}})):[]}stripEmptyQuery(e){let{name:t,time:r,value:n}=e;return t&&typeof n=="string"&&t.toLowerCase()==="query"&&n.trim()===""?{name:t,time:r}:e}stripEmptyQueries(e){return e.map((e=>this.stripEmptyQuery(e)))}},Gi=Object.freeze({__proto__:null,HistoryStore:Yi,MAX_NUMBER_OF_HISTORY_ELEMENTS:Ni,MAX_VALUE_SIZE:Hi,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:zi,STORE_KEY:Bi,default:Yi}),Wi=(e,t)=>ki(void 0,void 0,void 0,(function*(){return e===xi.view?(yield Ji(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t})),Ji=e=>ki(void 0,void 0,void 0,(function*(){let t=new Yi,r={name:"PageView",value:e,time:(new Date).toISOString()};yield t.addElementAsync(r)})),Ki,Zi=new Uint8Array(16);function Xi(){if(!Ki&&(Ki=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ki))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ki(Zi)}var ea=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function ta(e){return typeof e=="string"&&ea.test(e)}var ra=[];for(let e=0;e<256;++e)ra.push((e+256).toString(16).slice(1));function na(e,t=0){return(ra[e[t+0]]+ra[e[t+1]]+ra[e[t+2]]+ra[e[t+3]]+"-"+ra[e[t+4]]+ra[e[t+5]]+"-"+ra[e[t+6]]+ra[e[t+7]]+"-"+ra[e[t+8]]+ra[e[t+9]]+"-"+ra[e[t+10]]+ra[e[t+11]]+ra[e[t+12]]+ra[e[t+13]]+ra[e[t+14]]+ra[e[t+15]]).toLowerCase()}function ia(e){if(!ta(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}function aa(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var sa="6ba7b810-9dad-11d1-80b4-00c04fd430c8",oa="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function ua(e,t,r){function n(e,n,i,a){var s;if(typeof e=="string"&&(e=aa(e)),typeof n=="string"&&(n=ia(n)),((s=n)===null||s===void 0?void 0:s.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let o=new Uint8Array(16+e.length);if(o.set(n),o.set(e,n.length),o=r(o),o[6]=o[6]&15|t,o[8]=o[8]&63|128,i){a=a||0;for(let e=0;e<16;++e)i[a+e]=o[e];return i}return na(o)}try{n.name=e}catch{}return n.DNS=sa,n.URL=oa,n}var ca=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),la={randomUUID:ca};function da(e,t,r){if(la.randomUUID&&!t&&!e)return la.randomUUID();e=e||{};let n=e.random||(e.rng||Xi)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return na(n)}function fa(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function ha(e,t){return e<<t|e>>>32-t}function ga(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){let t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=e.length/4+2,i=Math.ceil(n/16),a=new Array(i);for(let t=0;t<i;++t){let r=new Uint32Array(16);for(let n=0;n<16;++n)r[n]=e[t*64+n*4]<<24|e[t*64+n*4+1]<<16|e[t*64+n*4+2]<<8|e[t*64+n*4+3];a[t]=r}a[i-1][14]=(e.length-1)*8/Math.pow(2,32),a[i-1][14]=Math.floor(a[i-1][14]),a[i-1][15]=(e.length-1)*8&4294967295;for(let e=0;e<i;++e){let n=new Uint32Array(80);for(let t=0;t<16;++t)n[t]=a[e][t];for(let e=16;e<80;++e)n[e]=ha(n[e-3]^n[e-8]^n[e-14]^n[e-16],1);let i=r[0],s=r[1],o=r[2],u=r[3],c=r[4];for(let e=0;e<80;++e){let r=Math.floor(e/20),a=ha(i,5)+fa(r,s,o,u)+c+t[r]+n[e]>>>0;c=u,u=o,o=ha(s,30)>>>0,s=i,i=a}r[0]=r[0]+i>>>0,r[1]=r[1]+s>>>0,r[2]=r[2]+o>>>0,r[3]=r[3]+u>>>0,r[4]=r[4]+c>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var pa=ua("v5",80,ga),ya=pa,va="2.30.2",ma={pageview:"pageview",event:"event"},wa=class e{constructor(e,t){if(!ta(e))throw Error("Not a valid uuid");this.clientId=e,this.creationDate=Math.floor(t/1e3)}toString(){return this.clientId.replace(/-/g,"")+"."+this.creationDate.toString()}get expired(){let t=Math.floor(Date.now()/1e3)-this.creationDate;return t<0||t>e.expirationTime}validate(e,t){return!this.expired&&this.matchReferrer(e,t)}matchReferrer(e,t){try{let r=new URL(e);return t.some((e=>new RegExp(e.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(r.host)))}catch{return!1}}static fromString(t){let r=t.split(".");if(r.length!==2)return null;let[n,i]=r;if(n.length!==32||isNaN(parseInt(i)))return null;let a=n.substring(0,8)+"-"+n.substring(8,12)+"-"+n.substring(12,16)+"-"+n.substring(16,20)+"-"+n.substring(20,32);return ta(a)?new e(a,Number.parseInt(i)*1e3):null}};wa.cvo_cid="cvo_cid";wa.expirationTime=120;var ba=Object.keys;function Sa(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}var Ia={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},Oa=ba(Ia).map((e=>Ia[e])),Aa=[...Oa].join("|"),qa=new RegExp(`^(${Aa}$)`),Ca={svcAction:"svc_action",svcActionData:"svc_action_data"},ka=e=>qa.test(e),xa=[ka],ja={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},Ra={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr",group:"group"},Fa={action:"pa",list:"pal",listSource:"pls"},Ta={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},Da=["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit"],Ma={id:"quoteId",affiliation:"quoteAffiliation"},Ea={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},Pa={add:Fa,bookmark_add:Fa,bookmark_remove:Fa,click:Fa,checkout:Fa,checkout_option:Fa,detail:Fa,impression:Fa,remove:Fa,refund:Object.assign(Object.assign({},Fa),Ta),purchase:Object.assign(Object.assign({},Fa),Ta),quickview:Fa,quote:Object.assign(Object.assign({},Fa),Ma),review:Object.assign(Object.assign({},Fa),Ea)},_a=ba(ja).map((e=>ja[e])),$a=ba(Ra).map((e=>Ra[e])),Ua=ba(Fa).map((e=>Fa[e])),Va=ba(Ta).map((e=>Ta[e])),Qa=ba(Ea).map((e=>Ea[e])),La=ba(Ma).map((e=>Ma[e])),Ba=[..._a,"custom"].join("|"),Na=[...$a,"custom"].join("|"),za="(pr[0-9]+)",Ha="(il[0-9]+pi[0-9]+)",Ya=new RegExp(`^${za}(${Ba})$`),Ga=new RegExp(`^(${Ha}(${Na}))|(il[0-9]+nm)$`),Wa=new RegExp(`^(${Ua.join("|")})$`),Ja=new RegExp(`^(${Va.join("|")})$`),Ka=new RegExp(`^${za}custom$`),Za=new RegExp(`^${Ha}custom$`),Xa=new RegExp(`^(${[...Da,...Qa,...La].join("|")})$`),es=e=>Ya.test(e),ts=e=>Ga.test(e),rs=e=>Wa.test(e),ns=e=>Ja.test(e),is=e=>Xa.test(e),as=[ts,es,rs,ns,is],ss=[Ka,Za],os={anonymizeIp:"aip"},us={eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"},cs={hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"},ls=["contentId","contentIdKey","contentType","searchHub","tab","searchUid","permanentId","contentLocale","trackingId"],ds=Object.assign(Object.assign(Object.assign(Object.assign({},os),us),cs),ls.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:t})),{})),fs=Object.assign(Object.assign({},ds),Ca),hs=e=>{let t=!!e.action&&Pa[e.action]||{};return ba(e).reduce(((r,n)=>{let i=t[n]||fs[n]||n;return Object.assign(Object.assign({},r),{[i]:e[n]})}),{})},gs=ba(fs).map((e=>fs[e])),ps=e=>gs.indexOf(e)!==-1,ys=e=>e==="custom",vs=e=>[...as,...xa,ps,ys].some((t=>t(e))),ms=e=>ba(e).reduce(((t,r)=>{let n=ws(r);return n?Object.assign(Object.assign({},t),bs(n,e[r])):Object.assign(Object.assign({},t),{[r]:e[r]})}),{}),ws=e=>{let t;return[...ss].every((r=>{var n;return t=(n=r.exec(e))===null||n===void 0?void 0:n[1],!t})),t},bs=(e,t)=>ba(t).reduce(((r,n)=>Object.assign(Object.assign({},r),{[`${e}${n}`]:t[n]})),{}),Ss=class{constructor(e){this.opts=e}sendEvent(e,t){return ki(this,void 0,void 0,(function*(){if(!this.isAvailable())throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');let{baseUrl:r,preprocessRequest:n}=this.opts,i=yield this.getQueryParamsForEventType(e),{url:a,payload:s}=yield this.preProcessRequestAsPotentialJSONString(`${r}/analytics/${e}?${i}`,t,n),o=this.encodeForEventType(e,s),u=new Blob([o],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(a,u)}))}isAvailable(){return"sendBeacon"in navigator}deleteHttpCookieVisitorId(){return Promise.resolve()}preProcessRequestAsPotentialJSONString(e,t,r){return ki(this,void 0,void 0,(function*(){let n=e,i=t;if(r){let a=yield r({url:e,body:JSON.stringify(t)},"analyticsBeacon"),{url:s,body:o}=a;n=s||e;try{i=JSON.parse(o)}catch(e){console.error("Unable to process the request body as a JSON string",e)}}return{payload:i,url:n}}))}encodeForEventType(e,t){return this.isEventTypeLegacy(e)?this.encodeEventToJson(e,t):this.encodeEventToJson(e,t,this.opts.token)}getQueryParamsForEventType(e){return ki(this,void 0,void 0,(function*(){let{token:t,visitorIdProvider:r}=this.opts,n=yield r.getCurrentVisitorId();return[t&&this.isEventTypeLegacy(e)?`access_token=${t}`:"",n?`visitorId=${n}`:"","discardVisitInfo=true"].filter((e=>!!e)).join("&")}))}isEventTypeLegacy(e){return[xi.click,xi.custom,xi.search,xi.view].indexOf(e)!==-1}encodeEventToJson(e,t,r){let n=`${e}Event=${encodeURIComponent(JSON.stringify(t))}`;return r&&(n=`access_token=${encodeURIComponent(r)}&${n}`),n}},Is=class{sendEvent(e,t){return ki(this,void 0,void 0,(function*(){return Promise.resolve()}))}deleteHttpCookieVisitorId(){return ki(this,void 0,void 0,(function*(){return Promise.resolve()}))}},Os=window.fetch,As=class{constructor(e){this.opts=e}sendEvent(e,t){return ki(this,void 0,void 0,(function*(){let{baseUrl:r,visitorIdProvider:n,preprocessRequest:i}=this.opts,a=this.shouldAppendVisitorId(e)?yield this.getVisitorIdParam():"",s={url:`${r}/analytics/${e}${a}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(t)},o=Object.assign(Object.assign({},s),i?yield i(s,"analyticsFetch"):{}),{url:u}=o,c=Ci(o,["url"]),l;try{l=yield Os(u,c)}catch(e){console.error("An error has occured when sending the event.",e);return}if(l.ok){let e=yield l.json();return e.visitorId&&n.setCurrentVisitorId(e.visitorId),e}else{try{l.json()}catch{}throw console.error(`An error has occured when sending the "${e}" event.`,l,t),new Error(`An error has occurred when sending the "${e}" event. Check the console logs for more details.`)}}))}deleteHttpCookieVisitorId(){return ki(this,void 0,void 0,(function*(){let{baseUrl:e}=this.opts,t=`${e}/analytics/visit`;yield Os(t,{headers:this.getHeaders(),method:"DELETE"})}))}shouldAppendVisitorId(e){return[xi.click,xi.custom,xi.search,xi.view].indexOf(e)!==-1}getVisitorIdParam(){return ki(this,void 0,void 0,(function*(){let{visitorIdProvider:e}=this.opts,t=yield e.getCurrentVisitorId();return t?`?visitor=${t}`:""}))}getHeaders(){let{token:e}=this.opts;return Object.assign(Object.assign({},e?{Authorization:`Bearer ${e}`}:{}),{"Content-Type":"application/json"})}},qs=class{constructor(e,t){Ti()&&Mi()?this.storage=new Qi:Ti()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new Li),this.client=new As(e),this.beaconClient=new Ss(e),window.addEventListener("beforeunload",(()=>{let e=t();for(let{eventType:t,payload:r}of e)this.beaconClient.sendEvent(t,r)}))}getClientDependingOnEventType(e){return e==="click"&&this.beaconClient.isAvailable()?this.beaconClient:this.client}},Cs=class{constructor(e,t){this.storage=t||new Li,this.client=new As(e)}getClientDependingOnEventType(e){return this.client}},ks=class{constructor(){this.storage=new Li,this.client=new Is}getClientDependingOnEventType(e){return this.client}},xs="xx",js=e=>e?.startsWith(xs)||!1,Rs=`\n        We've detected you're using React Native but have not provided the corresponding runtime, \n        for an optimal experience please use the "coveo.analytics/react-native" subpackage.\n        Follow the Readme on how to set it up: https://github.com/coveo/coveo.analytics.js#using-react-native\n    `;function Fs(){return typeof navigator<"u"&&navigator.product=="ReactNative"}var Ts=["1",1,"yes",!0];function Ds(){return Ri()&&[navigator.globalPrivacyControl,navigator.doNotTrack,navigator.msDoNotTrack,window.doNotTrack].some((e=>Ts.indexOf(e)!==-1))}var Ms="v15",Es={default:"https://analytics.cloud.coveo.com/rest/ua",production:"https://analytics.cloud.coveo.com/rest/ua",hipaa:"https://analyticshipaa.cloud.coveo.com/rest/ua"};function Ps(e=Es.default,t=Ms,r=!1){if(e=e.replace(/\/$/,""),r)return`${e}/${t}`;let n=e.endsWith("/rest")||e.endsWith("/rest/ua");return`${e}${n?"":"/rest"}/${t}`}var _s="38824e1f-37f5-42d3-8372-a4b8fa9df946",$s=class{get defaultOptions(){return{endpoint:Es.default,isCustomEndpoint:!1,token:"",version:Ms,beforeSendHooks:[],afterSendHooks:[]}}get version(){return va}constructor(e){if(this.acceptedLinkReferrers=[],!e)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[Wi,Pi].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};let t={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};Ds()?this.runtime=new ks:this.runtime=this.options.runtimeEnvironment||this.initRuntime(t),this.addEventTypeMapping(xi.view,{newEventType:xi.view,addClientIdParameter:!0}),this.addEventTypeMapping(xi.click,{newEventType:xi.click,addClientIdParameter:!0}),this.addEventTypeMapping(xi.custom,{newEventType:xi.custom,addClientIdParameter:!0}),this.addEventTypeMapping(xi.search,{newEventType:xi.search,addClientIdParameter:!0})}initRuntime(e){return ji()&&Fi()?new qs(e,(()=>{let e=[...this.bufferedRequests];return this.bufferedRequests=[],e})):(Fs()&&console.warn(Rs),new Cs(e))}get storage(){return this.runtime.storage}determineVisitorId(){return ki(this,void 0,void 0,(function*(){try{return ji()&&this.extractClientIdFromLink(window.location.href)||(yield this.storage.getItem("visitorId"))||da()}catch(e){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",e),da()}}))}getCurrentVisitorId(){return ki(this,void 0,void 0,(function*(){if(!this.visitorId){let e=yield this.determineVisitorId();yield this.setCurrentVisitorId(e)}return this.visitorId}))}setCurrentVisitorId(e){return ki(this,void 0,void 0,(function*(){this.visitorId=e,yield this.storage.setItem("visitorId",e)}))}setClientId(e,t){return ki(this,void 0,void 0,(function*(){if(ta(e))this.setCurrentVisitorId(e.toLowerCase());else{if(!t)throw Error("Cannot generate uuid client id without a specific namespace string.");this.setCurrentVisitorId(ya(e,ya(t,_s)))}}))}getParameters(e,...t){return ki(this,void 0,void 0,(function*(){return yield this.resolveParameters(e,...t)}))}getPayload(e,...t){return ki(this,void 0,void 0,(function*(){let r=yield this.resolveParameters(e,...t);return yield this.resolvePayloadForParameters(e,r)}))}get currentVisitorId(){return typeof(this.visitorId||this.storage.getItem("visitorId"))!="string"&&this.setCurrentVisitorId(da()),this.visitorId}set currentVisitorId(e){this.visitorId=e,this.storage.setItem("visitorId",e)}extractClientIdFromLink(e){if(Ds())return null;try{let t=new URL(e).searchParams.get(wa.cvo_cid);if(t==null)return null;let r=wa.fromString(t);return!r||!Fi()||!r.validate(document.referrer,this.acceptedLinkReferrers)?null:r.clientId}catch{}return null}resolveParameters(e,...t){return ki(this,void 0,void 0,(function*(){let{variableLengthArgumentsNames:r=[],addVisitorIdParameter:n=!1,usesMeasurementProtocol:i=!1,addClientIdParameter:a=!1}=this.eventTypeMapping[e]||{};return yield[e=>r.length>0?this.parseVariableArgumentsPayload(r,e):e[0],e=>ki(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},e),{visitorId:n?yield this.getCurrentVisitorId():""})})),e=>ki(this,void 0,void 0,(function*(){return a?Object.assign(Object.assign({},e),{clientId:yield this.getCurrentVisitorId()}):e})),e=>i?this.ensureAnonymousUserWhenUsingApiKey(e):e,t=>this.beforeSendHooks.reduce(((t,r)=>ki(this,void 0,void 0,(function*(){let n=yield t;return yield r(e,n)}))),t)].reduce(((e,t)=>ki(this,void 0,void 0,(function*(){let r=yield e;return yield t(r)}))),Promise.resolve(t))}))}resolvePayloadForParameters(e,t){return ki(this,void 0,void 0,(function*(){let{usesMeasurementProtocol:r=!1}=this.eventTypeMapping[e]||{};return yield[e=>this.setTrackingIdIfTrackingIdNotPresent(e),t=>this.removeEmptyPayloadValues(t,e),t=>this.validateParams(t,e),e=>r?hs(e):e,e=>r?this.removeUnknownParameters(e):e,e=>r?this.processCustomParameters(e):this.mapCustomParametersToCustomData(e)].reduce(((e,t)=>ki(this,void 0,void 0,(function*(){let r=yield e;return yield t(r)}))),Promise.resolve(t))}))}makeEvent(e,...t){return ki(this,void 0,void 0,(function*(){let{newEventType:r=e}=this.eventTypeMapping[e]||{},n=yield this.resolveParameters(e,...t),i=yield this.resolvePayloadForParameters(e,n);return{eventType:r,payload:i,log:t=>ki(this,void 0,void 0,(function*(){return this.bufferedRequests.push({eventType:r,payload:Object.assign(Object.assign({},i),t)}),yield Promise.all(this.afterSendHooks.map((r=>r(e,Object.assign(Object.assign({},n),t))))),yield this.deferExecution(),yield this.sendFromBuffer()}))}}))}sendEvent(e,...t){return ki(this,void 0,void 0,(function*(){return(yield this.makeEvent(e,...t)).log({})}))}deferExecution(){return new Promise((e=>setTimeout(e,0)))}sendFromBuffer(){return ki(this,void 0,void 0,(function*(){let e=this.bufferedRequests.shift();if(e){let{eventType:t,payload:r}=e;return this.runtime.getClientDependingOnEventType(t).sendEvent(t,r)}}))}clear(){this.storage.removeItem("visitorId"),(new Yi).clear()}deleteHttpOnlyVisitorId(){this.runtime.client.deleteHttpCookieVisitorId()}makeSearchEvent(e){return ki(this,void 0,void 0,(function*(){return this.makeEvent(xi.search,e)}))}sendSearchEvent(e){var{searchQueryUid:t}=e,r=Ci(e,["searchQueryUid"]);return ki(this,void 0,void 0,(function*(){return(yield this.makeSearchEvent(r)).log({searchQueryUid:t})}))}makeClickEvent(e){return ki(this,void 0,void 0,(function*(){return this.makeEvent(xi.click,e)}))}sendClickEvent(e){var{searchQueryUid:t}=e,r=Ci(e,["searchQueryUid"]);return ki(this,void 0,void 0,(function*(){return(yield this.makeClickEvent(r)).log({searchQueryUid:t})}))}makeCustomEvent(e){return ki(this,void 0,void 0,(function*(){return this.makeEvent(xi.custom,e)}))}sendCustomEvent(e){var{lastSearchQueryUid:t}=e,r=Ci(e,["lastSearchQueryUid"]);return ki(this,void 0,void 0,(function*(){return(yield this.makeCustomEvent(r)).log({lastSearchQueryUid:t})}))}makeViewEvent(e){return ki(this,void 0,void 0,(function*(){return this.makeEvent(xi.view,e)}))}sendViewEvent(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeViewEvent(e)).log({})}))}getVisit(){return ki(this,void 0,void 0,(function*(){let e=yield(yield fetch(`${this.baseUrl}/analytics/visit`)).json();return this.visitorId=e.visitorId,e}))}getHealth(){return ki(this,void 0,void 0,(function*(){return yield(yield fetch(`${this.baseUrl}/analytics/monitoring/health`)).json()}))}registerBeforeSendEventHook(e){this.beforeSendHooks.push(e)}registerAfterSendEventHook(e){this.afterSendHooks.push(e)}addEventTypeMapping(e,t){this.eventTypeMapping[e]=t}setAcceptedLinkReferrers(e){if(Array.isArray(e)&&e.every((e=>typeof e=="string")))this.acceptedLinkReferrers=e;else throw Error("Parameter should be an array of domain strings")}parseVariableArgumentsPayload(e,t){let r={};for(let n=0,i=t.length;n<i;n++){let i=t[n];if(typeof i=="string")r[e[n]]=i;else if(typeof i=="object")return Object.assign(Object.assign({},r),i)}return r}isKeyAllowedEmpty(e,t){return({[xi.search]:["queryText"]}[e]||[]).indexOf(t)!==-1}removeEmptyPayloadValues(e,t){let r=e=>typeof e<"u"&&e!==null&&e!=="";return Object.keys(e).filter((n=>this.isKeyAllowedEmpty(t,n)||r(e[n]))).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{})}removeUnknownParameters(e){return Object.keys(e).filter((e=>{if(vs(e))return!0;console.log(e,"is not processed by coveoua")})).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{})}processCustomParameters(e){let{custom:t}=e,r=Ci(e,["custom"]),n={};t&&Sa(t)&&(n=this.lowercaseKeys(t));let i=ms(r);return Object.assign(Object.assign({},n),i)}mapCustomParametersToCustomData(e){let{custom:t}=e,r=Ci(e,["custom"]);if(t&&Sa(t)){let n=this.lowercaseKeys(t);return Object.assign(Object.assign({},r),{customData:Object.assign(Object.assign({},n),e.customData)})}else return e}lowercaseKeys(e){let t=Object.keys(e),r={};return t.forEach((t=>{r[t.toLowerCase()]=e[t]})),r}validateParams(e,t){let{anonymizeIp:r}=e,n=Ci(e,["anonymizeIp"]);return r!==void 0&&["0","false","undefined","null","{}","[]",""].indexOf(`${r}`.toLowerCase())==-1&&(n.anonymizeIp=1),(t==xi.view||t==xi.click||t==xi.search||t==xi.custom)&&(n.originLevel3=this.limit(n.originLevel3,128)),t==xi.view&&(n.location=this.limit(n.location,128)),(t=="pageview"||t=="event")&&(n.referrer=this.limit(n.referrer,2048),n.location=this.limit(n.location,2048),n.page=this.limit(n.page,2048)),n}ensureAnonymousUserWhenUsingApiKey(e){let{userId:t}=e,r=Ci(e,["userId"]);return js(this.options.token)&&!t?(r.userId="anonymous",r):e}setTrackingIdIfTrackingIdNotPresent(e){let{trackingId:t}=e,r=Ci(e,["trackingId"]);return t?e:(r.hasOwnProperty("custom")&&Sa(r.custom)&&(r.custom.hasOwnProperty("context_website")||r.custom.hasOwnProperty("siteName"))&&(r.trackingId=r.custom.context_website||r.custom.siteName),r.hasOwnProperty("customData")&&Sa(r.customData)&&(r.customData.hasOwnProperty("context_website")||r.customData.hasOwnProperty("siteName"))&&(r.trackingId=r.customData.context_website||r.customData.siteName),r)}limit(e,t){return typeof e!="string"?e:e.substring(0,t)}get baseUrl(){return Ps(this.options.endpoint,this.options.version,this.options.isCustomEndpoint)}},Us;(function(e){e.contextChanged="contextChanged",e.expandToFullUI="expandToFullUI",e.openUserActions="openUserActions",e.showPrecedingSessions="showPrecedingSessions",e.showFollowingSessions="showFollowingSessions",e.clickViewedDocument="clickViewedDocument",e.clickPageView="clickPageView",e.createArticle="createArticle"})(Us||(Us={}));var Vs;(function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.undoTriggerQuery="undoQuery",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.staticFilterClearAll="staticFilterClearAll",e.staticFilterSelect="staticFilterSelect",e.staticFilterDeselect="staticFilterDeselect",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",e.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",e.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",e.openSmartSnippetSource="openSmartSnippetSource",e.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",e.openSmartSnippetInlineLink="openSmartSnippetInlineLink",e.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",e.recentQueryClick="recentQueriesClick",e.clearRecentQueries="clearRecentQueries",e.recentResultClick="recentResultClick",e.clearRecentResults="clearRecentResults",e.noResultsBack="noResultsBack",e.showMoreFoldedResults="showMoreFoldedResults",e.showLessFoldedResults="showLessFoldedResults",e.copyToClipboard="copyToClipboard",e.caseSendEmail="Case.SendEmail",e.feedItemTextPost="FeedItem.TextPost",e.caseAttach="caseAttach",e.caseDetach="caseDetach",e.retryGeneratedAnswer="retryGeneratedAnswer",e.likeGeneratedAnswer="likeGeneratedAnswer",e.dislikeGeneratedAnswer="dislikeGeneratedAnswer",e.openGeneratedAnswerSource="openGeneratedAnswerSource",e.generatedAnswerStreamEnd="generatedAnswerStreamEnd",e.generatedAnswerSourceHover="generatedAnswerSourceHover",e.generatedAnswerCopyToClipboard="generatedAnswerCopyToClipboard",e.generatedAnswerHideAnswers="generatedAnswerHideAnswers",e.generatedAnswerShowAnswers="generatedAnswerShowAnswers",e.generatedAnswerExpand="generatedAnswerExpand",e.generatedAnswerCollapse="generatedAnswerCollapse",e.generatedAnswerFeedbackSubmit="generatedAnswerFeedbackSubmit",e.rephraseGeneratedAnswer="rephraseGeneratedAnswer"})(Vs||(Vs={}));var Qs={[Vs.triggerNotify]:"queryPipelineTriggers",[Vs.triggerExecute]:"queryPipelineTriggers",[Vs.triggerQuery]:"queryPipelineTriggers",[Vs.triggerRedirect]:"queryPipelineTriggers",[Vs.queryError]:"errors",[Vs.queryErrorBack]:"errors",[Vs.queryErrorClear]:"errors",[Vs.queryErrorRetry]:"errors",[Vs.pagerNext]:"getMoreResults",[Vs.pagerPrevious]:"getMoreResults",[Vs.pagerNumber]:"getMoreResults",[Vs.pagerResize]:"getMoreResults",[Vs.pagerScrolling]:"getMoreResults",[Vs.facetSearch]:"facet",[Vs.facetShowLess]:"facet",[Vs.facetShowMore]:"facet",[Vs.recommendation]:"recommendation",[Vs.likeSmartSnippet]:"smartSnippet",[Vs.dislikeSmartSnippet]:"smartSnippet",[Vs.expandSmartSnippet]:"smartSnippet",[Vs.collapseSmartSnippet]:"smartSnippet",[Vs.openSmartSnippetFeedbackModal]:"smartSnippet",[Vs.closeSmartSnippetFeedbackModal]:"smartSnippet",[Vs.sendSmartSnippetReason]:"smartSnippet",[Vs.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[Vs.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions",[Vs.showMoreSmartSnippetSuggestion]:"smartSnippetSuggestions",[Vs.showLessSmartSnippetSuggestion]:"smartSnippetSuggestions",[Vs.clearRecentQueries]:"recentQueries",[Vs.recentResultClick]:"recentlyClickedDocuments",[Vs.clearRecentResults]:"recentlyClickedDocuments",[Vs.showLessFoldedResults]:"folding",[Vs.caseDetach]:"case",[Vs.likeGeneratedAnswer]:"generatedAnswer",[Vs.dislikeGeneratedAnswer]:"generatedAnswer",[Vs.openGeneratedAnswerSource]:"generatedAnswer",[Vs.generatedAnswerStreamEnd]:"generatedAnswer",[Vs.generatedAnswerSourceHover]:"generatedAnswer",[Vs.generatedAnswerCopyToClipboard]:"generatedAnswer",[Vs.generatedAnswerHideAnswers]:"generatedAnswer",[Vs.generatedAnswerShowAnswers]:"generatedAnswer",[Vs.generatedAnswerExpand]:"generatedAnswer",[Vs.generatedAnswerCollapse]:"generatedAnswer",[Vs.generatedAnswerFeedbackSubmit]:"generatedAnswer",[Us.expandToFullUI]:"interface",[Us.openUserActions]:"User Actions",[Us.showPrecedingSessions]:"User Actions",[Us.showFollowingSessions]:"User Actions",[Us.clickViewedDocument]:"User Actions",[Us.clickPageView]:"User Actions",[Us.createArticle]:"createArticle"},Ls=class{constructor(){this.runtime=new ks,this.currentVisitorId=""}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}makeEvent(e){return Promise.resolve({eventType:e,payload:null,log:()=>Promise.resolve()})}sendEvent(){return Promise.resolve()}makeSearchEvent(){return this.makeEvent(xi.search)}sendSearchEvent(){return Promise.resolve()}makeClickEvent(){return this.makeEvent(xi.click)}sendClickEvent(){return Promise.resolve()}makeCustomEvent(){return this.makeEvent(xi.custom)}sendCustomEvent(){return Promise.resolve()}makeViewEvent(){return this.makeEvent(xi.view)}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}get version(){return va}};function Bs(e){let t="";return e.filter((e=>{let r=e!==t;return t=e,r}))}function Ns(e){return e.map((e=>e.replace(/;/g,"")))}function zs(e){let t=e.join(";");return t.length<=256?t:zs(e.slice(1))}var Hs=e=>{let t=Ns(e),r=Bs(t);return zs(r)};function Ys(e){let t=typeof e.partialQueries=="string"?e.partialQueries:Hs(e.partialQueries),r=typeof e.suggestions=="string"?e.suggestions:Hs(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}var Gs=class{constructor(e,t){this.opts=e,this.provider=t;let r=e.enableAnalytics===!1||Ds();this.coveoAnalyticsClient=r?new Ls:new $s(e)}disable(){this.coveoAnalyticsClient=new Ls}enable(){this.coveoAnalyticsClient=new $s(this.opts)}makeInterfaceLoad(){return this.makeSearchEvent(Vs.interfaceLoad)}logInterfaceLoad(){return ki(this,void 0,void 0,(function*(){return(yield this.makeInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})}))}makeRecommendationInterfaceLoad(){return this.makeSearchEvent(Vs.recommendationInterfaceLoad)}logRecommendationInterfaceLoad(){return ki(this,void 0,void 0,(function*(){return(yield this.makeRecommendationInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})}))}makeRecommendation(){return this.makeCustomEvent(Vs.recommendation)}logRecommendation(){return ki(this,void 0,void 0,(function*(){return(yield this.makeRecommendation()).log({searchUID:this.provider.getSearchUID()})}))}makeRecommendationOpen(e,t){return this.makeClickEvent(Vs.recommendationOpen,e,t)}logRecommendationOpen(e,t){return ki(this,void 0,void 0,(function*(){return(yield this.makeRecommendationOpen(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeStaticFilterClearAll(e){return this.makeSearchEvent(Vs.staticFilterClearAll,e)}logStaticFilterClearAll(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeStaticFilterClearAll(e)).log({searchUID:this.provider.getSearchUID()})}))}makeStaticFilterSelect(e){return this.makeSearchEvent(Vs.staticFilterSelect,e)}logStaticFilterSelect(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeStaticFilterSelect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeStaticFilterDeselect(e){return this.makeSearchEvent(Vs.staticFilterDeselect,e)}logStaticFilterDeselect(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeStaticFilterDeselect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFetchMoreResults(){return this.makeCustomEvent(Vs.pagerScrolling,{type:"getMoreResults"})}logFetchMoreResults(){return ki(this,void 0,void 0,(function*(){return(yield this.makeFetchMoreResults()).log({searchUID:this.provider.getSearchUID()})}))}makeInterfaceChange(e){return this.makeSearchEvent(Vs.interfaceChange,e)}logInterfaceChange(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeInterfaceChange(e)).log({searchUID:this.provider.getSearchUID()})}))}makeDidYouMeanAutomatic(){return this.makeSearchEvent(Vs.didyoumeanAutomatic)}logDidYouMeanAutomatic(){return ki(this,void 0,void 0,(function*(){return(yield this.makeDidYouMeanAutomatic()).log({searchUID:this.provider.getSearchUID()})}))}makeDidYouMeanClick(){return this.makeSearchEvent(Vs.didyoumeanClick)}logDidYouMeanClick(){return ki(this,void 0,void 0,(function*(){return(yield this.makeDidYouMeanClick()).log({searchUID:this.provider.getSearchUID()})}))}makeResultsSort(e){return this.makeSearchEvent(Vs.resultsSort,e)}logResultsSort(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeResultsSort(e)).log({searchUID:this.provider.getSearchUID()})}))}makeSearchboxSubmit(){return this.makeSearchEvent(Vs.searchboxSubmit)}logSearchboxSubmit(){return ki(this,void 0,void 0,(function*(){return(yield this.makeSearchboxSubmit()).log({searchUID:this.provider.getSearchUID()})}))}makeSearchboxClear(){return this.makeSearchEvent(Vs.searchboxClear)}logSearchboxClear(){return ki(this,void 0,void 0,(function*(){return(yield this.makeSearchboxClear()).log({searchUID:this.provider.getSearchUID()})}))}makeSearchboxAsYouType(){return this.makeSearchEvent(Vs.searchboxAsYouType)}logSearchboxAsYouType(){return ki(this,void 0,void 0,(function*(){return(yield this.makeSearchboxAsYouType()).log({searchUID:this.provider.getSearchUID()})}))}makeBreadcrumbFacet(e){return this.makeSearchEvent(Vs.breadcrumbFacet,e)}logBreadcrumbFacet(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeBreadcrumbFacet(e)).log({searchUID:this.provider.getSearchUID()})}))}makeBreadcrumbResetAll(){return this.makeSearchEvent(Vs.breadcrumbResetAll)}logBreadcrumbResetAll(){return ki(this,void 0,void 0,(function*(){return(yield this.makeBreadcrumbResetAll()).log({searchUID:this.provider.getSearchUID()})}))}makeDocumentQuickview(e,t){return this.makeClickEvent(Vs.documentQuickview,e,t)}logDocumentQuickview(e,t){return ki(this,void 0,void 0,(function*(){return(yield this.makeDocumentQuickview(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeDocumentOpen(e,t){return this.makeClickEvent(Vs.documentOpen,e,t)}logDocumentOpen(e,t){return ki(this,void 0,void 0,(function*(){return(yield this.makeDocumentOpen(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOmniboxAnalytics(e){return this.makeSearchEvent(Vs.omniboxAnalytics,Ys(e))}logOmniboxAnalytics(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeOmniboxAnalytics(e)).log({searchUID:this.provider.getSearchUID()})}))}makeOmniboxFromLink(e){return this.makeSearchEvent(Vs.omniboxFromLink,Ys(e))}logOmniboxFromLink(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeOmniboxFromLink(e)).log({searchUID:this.provider.getSearchUID()})}))}makeSearchFromLink(){return this.makeSearchEvent(Vs.searchFromLink)}logSearchFromLink(){return ki(this,void 0,void 0,(function*(){return(yield this.makeSearchFromLink()).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerNotify(e){return this.makeCustomEvent(Vs.triggerNotify,e)}logTriggerNotify(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeTriggerNotify(e)).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerExecute(e){return this.makeCustomEvent(Vs.triggerExecute,e)}logTriggerExecute(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeTriggerExecute(e)).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerQuery(){return this.makeCustomEvent(Vs.triggerQuery,{query:this.provider.getSearchEventRequestPayload().queryText},"queryPipelineTriggers")}logTriggerQuery(){return ki(this,void 0,void 0,(function*(){return(yield this.makeTriggerQuery()).log({searchUID:this.provider.getSearchUID()})}))}makeUndoTriggerQuery(e){return this.makeSearchEvent(Vs.undoTriggerQuery,e)}logUndoTriggerQuery(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeUndoTriggerQuery(e)).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerRedirect(e){return this.makeCustomEvent(Vs.triggerRedirect,Object.assign(Object.assign({},e),{query:this.provider.getSearchEventRequestPayload().queryText}))}logTriggerRedirect(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeTriggerRedirect(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerResize(e){return this.makeCustomEvent(Vs.pagerResize,e)}logPagerResize(e){return ki(this,void 0,void 0,(function*(){return(yield this.makePagerResize(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerNumber(e){return this.makeCustomEvent(Vs.pagerNumber,e)}logPagerNumber(e){return ki(this,void 0,void 0,(function*(){return(yield this.makePagerNumber(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerNext(e){return this.makeCustomEvent(Vs.pagerNext,e)}logPagerNext(e){return ki(this,void 0,void 0,(function*(){return(yield this.makePagerNext(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerPrevious(e){return this.makeCustomEvent(Vs.pagerPrevious,e)}logPagerPrevious(e){return ki(this,void 0,void 0,(function*(){return(yield this.makePagerPrevious(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerScrolling(){return this.makeCustomEvent(Vs.pagerScrolling)}logPagerScrolling(){return ki(this,void 0,void 0,(function*(){return(yield this.makePagerScrolling()).log({searchUID:this.provider.getSearchUID()})}))}makeFacetClearAll(e){return this.makeSearchEvent(Vs.facetClearAll,e)}logFacetClearAll(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeFacetClearAll(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetSearch(e){return this.makeSearchEvent(Vs.facetSearch,e)}logFacetSearch(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeFacetSearch(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetSelect(e){return this.makeSearchEvent(Vs.facetSelect,e)}logFacetSelect(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeFacetSelect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetDeselect(e){return this.makeSearchEvent(Vs.facetDeselect,e)}logFacetDeselect(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeFacetDeselect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetExclude(e){return this.makeSearchEvent(Vs.facetExclude,e)}logFacetExclude(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeFacetExclude(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetUnexclude(e){return this.makeSearchEvent(Vs.facetUnexclude,e)}logFacetUnexclude(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeFacetUnexclude(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetSelectAll(e){return this.makeSearchEvent(Vs.facetSelectAll,e)}logFacetSelectAll(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeFacetSelectAll(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetUpdateSort(e){return this.makeSearchEvent(Vs.facetUpdateSort,e)}logFacetUpdateSort(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeFacetUpdateSort(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetShowMore(e){return this.makeCustomEvent(Vs.facetShowMore,e)}logFacetShowMore(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeFacetShowMore(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetShowLess(e){return this.makeCustomEvent(Vs.facetShowLess,e)}logFacetShowLess(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeFacetShowLess(e)).log({searchUID:this.provider.getSearchUID()})}))}makeQueryError(e){return this.makeCustomEvent(Vs.queryError,e)}logQueryError(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeQueryError(e)).log({searchUID:this.provider.getSearchUID()})}))}makeQueryErrorBack(){return ki(this,void 0,void 0,(function*(){let e=yield this.makeCustomEvent(Vs.queryErrorBack);return{description:e.description,log:()=>ki(this,void 0,void 0,(function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(Vs.queryErrorBack)}))}}))}logQueryErrorBack(){return ki(this,void 0,void 0,(function*(){return(yield this.makeQueryErrorBack()).log({searchUID:this.provider.getSearchUID()})}))}makeQueryErrorRetry(){return ki(this,void 0,void 0,(function*(){let e=yield this.makeCustomEvent(Vs.queryErrorRetry);return{description:e.description,log:()=>ki(this,void 0,void 0,(function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(Vs.queryErrorRetry)}))}}))}logQueryErrorRetry(){return ki(this,void 0,void 0,(function*(){return(yield this.makeQueryErrorRetry()).log({searchUID:this.provider.getSearchUID()})}))}makeQueryErrorClear(){return ki(this,void 0,void 0,(function*(){let e=yield this.makeCustomEvent(Vs.queryErrorClear);return{description:e.description,log:()=>ki(this,void 0,void 0,(function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(Vs.queryErrorClear)}))}}))}logQueryErrorClear(){return ki(this,void 0,void 0,(function*(){return(yield this.makeQueryErrorClear()).log({searchUID:this.provider.getSearchUID()})}))}makeLikeSmartSnippet(){return this.makeCustomEvent(Vs.likeSmartSnippet)}logLikeSmartSnippet(){return ki(this,void 0,void 0,(function*(){return(yield this.makeLikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeDislikeSmartSnippet(){return this.makeCustomEvent(Vs.dislikeSmartSnippet)}logDislikeSmartSnippet(){return ki(this,void 0,void 0,(function*(){return(yield this.makeDislikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeExpandSmartSnippet(){return this.makeCustomEvent(Vs.expandSmartSnippet)}logExpandSmartSnippet(){return ki(this,void 0,void 0,(function*(){return(yield this.makeExpandSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeCollapseSmartSnippet(){return this.makeCustomEvent(Vs.collapseSmartSnippet)}logCollapseSmartSnippet(){return ki(this,void 0,void 0,(function*(){return(yield this.makeCollapseSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetFeedbackModal(){return this.makeCustomEvent(Vs.openSmartSnippetFeedbackModal)}logOpenSmartSnippetFeedbackModal(){return ki(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})}))}makeCloseSmartSnippetFeedbackModal(){return this.makeCustomEvent(Vs.closeSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return ki(this,void 0,void 0,(function*(){return(yield this.makeCloseSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})}))}makeSmartSnippetFeedbackReason(e,t){return this.makeCustomEvent(Vs.sendSmartSnippetReason,{reason:e,details:t})}logSmartSnippetFeedbackReason(e,t){return ki(this,void 0,void 0,(function*(){return(yield this.makeSmartSnippetFeedbackReason(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeExpandSmartSnippetSuggestion(e){return this.makeCustomEvent(Vs.expandSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logExpandSmartSnippetSuggestion(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeExpandSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeCollapseSmartSnippetSuggestion(e){return this.makeCustomEvent(Vs.collapseSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logCollapseSmartSnippetSuggestion(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeCollapseSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeShowMoreSmartSnippetSuggestion(e){return this.makeCustomEvent(Vs.showMoreSmartSnippetSuggestion,e)}logShowMoreSmartSnippetSuggestion(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeShowMoreSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeShowLessSmartSnippetSuggestion(e){return this.makeCustomEvent(Vs.showLessSmartSnippetSuggestion,e)}logShowLessSmartSnippetSuggestion(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeShowLessSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetSource(e,t){return this.makeClickEvent(Vs.openSmartSnippetSource,e,t)}logOpenSmartSnippetSource(e,t){return ki(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetSource(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetSuggestionSource(e,t){return this.makeClickEvent(Vs.openSmartSnippetSuggestionSource,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}makeCopyToClipboard(e,t){return this.makeClickEvent(Vs.copyToClipboard,e,t)}logCopyToClipboard(e,t){return ki(this,void 0,void 0,(function*(){return(yield this.makeCopyToClipboard(e,t)).log({searchUID:this.provider.getSearchUID()})}))}logOpenSmartSnippetSuggestionSource(e,t){return ki(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetSuggestionSource(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetInlineLink(e,t){return this.makeClickEvent(Vs.openSmartSnippetInlineLink,e,{contentIDKey:t.contentIDKey,contentIDValue:t.contentIDValue},t)}logOpenSmartSnippetInlineLink(e,t){return ki(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetSuggestionInlineLink(e,t){return this.makeClickEvent(Vs.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}logOpenSmartSnippetSuggestionInlineLink(e,t){return ki(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetSuggestionInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeRecentQueryClick(){return this.makeSearchEvent(Vs.recentQueryClick)}logRecentQueryClick(){return ki(this,void 0,void 0,(function*(){return(yield this.makeRecentQueryClick()).log({searchUID:this.provider.getSearchUID()})}))}makeClearRecentQueries(){return this.makeCustomEvent(Vs.clearRecentQueries)}logClearRecentQueries(){return ki(this,void 0,void 0,(function*(){return(yield this.makeClearRecentQueries()).log({searchUID:this.provider.getSearchUID()})}))}makeRecentResultClick(e,t){return this.makeCustomEvent(Vs.recentResultClick,{info:e,identifier:t})}logRecentResultClick(e,t){return ki(this,void 0,void 0,(function*(){return(yield this.makeRecentResultClick(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeClearRecentResults(){return this.makeCustomEvent(Vs.clearRecentResults)}logClearRecentResults(){return ki(this,void 0,void 0,(function*(){return(yield this.makeClearRecentResults()).log({searchUID:this.provider.getSearchUID()})}))}makeNoResultsBack(){return this.makeSearchEvent(Vs.noResultsBack)}logNoResultsBack(){return ki(this,void 0,void 0,(function*(){return(yield this.makeNoResultsBack()).log({searchUID:this.provider.getSearchUID()})}))}makeShowMoreFoldedResults(e,t){return this.makeClickEvent(Vs.showMoreFoldedResults,e,t)}logShowMoreFoldedResults(e,t){return ki(this,void 0,void 0,(function*(){return(yield this.makeShowMoreFoldedResults(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeShowLessFoldedResults(){return this.makeCustomEvent(Vs.showLessFoldedResults)}logShowLessFoldedResults(){return ki(this,void 0,void 0,(function*(){return(yield this.makeShowLessFoldedResults()).log({searchUID:this.provider.getSearchUID()})}))}makeEventDescription(e,t){var r;return{actionCause:t,customData:(r=e.payload)===null||r===void 0?void 0:r.customData}}makeCustomEvent(e,t,r=Qs[e]){return ki(this,void 0,void 0,(function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),i=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:r,eventValue:e}),a=yield this.coveoAnalyticsClient.makeCustomEvent(i);return{description:this.makeEventDescription(a,e),log:({searchUID:e})=>a.log({lastSearchQueryUid:e})}}))}logCustomEvent(e,t,r=Qs[e]){return ki(this,void 0,void 0,(function*(){return(yield this.makeCustomEvent(e,t,r)).log({searchUID:this.provider.getSearchUID()})}))}makeCustomEventWithType(e,t,r){return ki(this,void 0,void 0,(function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),i=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:t,eventValue:e}),a=yield this.coveoAnalyticsClient.makeCustomEvent(i);return{description:this.makeEventDescription(a,e),log:({searchUID:e})=>a.log({lastSearchQueryUid:e})}}))}logCustomEventWithType(e,t,r){return ki(this,void 0,void 0,(function*(){return(yield this.makeCustomEventWithType(e,t,r)).log({searchUID:this.provider.getSearchUID()})}))}logSearchEvent(e,t){return ki(this,void 0,void 0,(function*(){return(yield this.makeSearchEvent(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeSearchEvent(e,t){return ki(this,void 0,void 0,(function*(){let r=yield this.getBaseSearchEventRequest(e,t),n=yield this.coveoAnalyticsClient.makeSearchEvent(r);return{description:this.makeEventDescription(n,e),log:({searchUID:e})=>n.log({searchQueryUid:e})}}))}makeClickEvent(e,t,r,n){return ki(this,void 0,void 0,(function*(){let i=Object.assign(Object.assign(Object.assign({},t),yield this.getBaseEventRequest(Object.assign(Object.assign({},r),n))),{queryPipeline:this.provider.getPipeline(),actionCause:e}),a=yield this.coveoAnalyticsClient.makeClickEvent(i);return{description:this.makeEventDescription(a,e),log:({searchUID:e})=>a.log({searchQueryUid:e})}}))}logClickEvent(e,t,r,n){return ki(this,void 0,void 0,(function*(){return(yield this.makeClickEvent(e,t,r,n)).log({searchUID:this.provider.getSearchUID()})}))}getBaseSearchEventRequest(e,t){var r,n;return ki(this,void 0,void 0,(function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},t),(n=(r=this.provider).getGeneratedAnswerMetadata)===null||n===void 0?void 0:n.call(r)))),this.provider.getSearchEventRequestPayload()),{queryPipeline:this.provider.getPipeline(),actionCause:e})}))}getBaseEventRequest(e){return ki(this,void 0,void 0,(function*(){let t=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign(Object.assign({},this.getOrigins()),this.getSplitTestRun()),{customData:t,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})}))}getOrigins(){var e,t;return{originContext:(t=(e=this.provider).getOriginContext)===null||t===void 0?void 0:t.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof $s?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getSplitTestRun(){let e=this.provider.getSplitTestRunName?this.provider.getSplitTestRunName():"",t=this.provider.getSplitTestRunVersion?this.provider.getSplitTestRunVersion():"";return Object.assign(Object.assign({},e&&{splitTestRunName:e}),t&&{splitTestRunVersion:t})}makeLikeGeneratedAnswer(e){return this.makeCustomEvent(Vs.likeGeneratedAnswer,e)}logLikeGeneratedAnswer(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeLikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})}))}makeDislikeGeneratedAnswer(e){return this.makeCustomEvent(Vs.dislikeGeneratedAnswer,e)}logDislikeGeneratedAnswer(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeDislikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenGeneratedAnswerSource(e){return this.makeCustomEvent(Vs.openGeneratedAnswerSource,e)}logOpenGeneratedAnswerSource(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeOpenGeneratedAnswerSource(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerSourceHover(e){return this.makeCustomEvent(Vs.generatedAnswerSourceHover,e)}logGeneratedAnswerSourceHover(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerSourceHover(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerCopyToClipboard(e){return this.makeCustomEvent(Vs.generatedAnswerCopyToClipboard,e)}logGeneratedAnswerCopyToClipboard(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerCopyToClipboard(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerHideAnswers(e){return this.makeCustomEvent(Vs.generatedAnswerHideAnswers,e)}logGeneratedAnswerHideAnswers(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerHideAnswers(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerShowAnswers(e){return this.makeCustomEvent(Vs.generatedAnswerShowAnswers,e)}logGeneratedAnswerShowAnswers(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerShowAnswers(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerExpand(e){return this.makeCustomEvent(Vs.generatedAnswerExpand,e)}logGeneratedAnswerExpand(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerExpand(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerCollapse(e){return this.makeCustomEvent(Vs.generatedAnswerCollapse,e)}logGeneratedAnswerCollapse(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerCollapse(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerFeedbackSubmit(e){return this.makeCustomEvent(Vs.generatedAnswerFeedbackSubmit,e)}logGeneratedAnswerFeedbackSubmit(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerFeedbackSubmit(e)).log({searchUID:this.provider.getSearchUID()})}))}makeRephraseGeneratedAnswer(e){return this.makeSearchEvent(Vs.rephraseGeneratedAnswer,e)}logRephraseGeneratedAnswer(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeRephraseGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})}))}makeRetryGeneratedAnswer(){return this.makeSearchEvent(Vs.retryGeneratedAnswer)}logRetryGeneratedAnswer(){return ki(this,void 0,void 0,(function*(){return(yield this.makeRetryGeneratedAnswer()).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerStreamEnd(e){return this.makeCustomEvent(Vs.generatedAnswerStreamEnd,e)}logGeneratedAnswerStreamEnd(e){return ki(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerStreamEnd(e)).log({searchUID:this.provider.getSearchUID()})}))}},Ws=Object.assign({},ma);Object.keys(Ws).map((e=>Ws[e]));var Js;(function(e){e.click="click",e.flowStart="flowStart"})(Js||(Js={}));var Ks;(function(e){e.enterInterface="ticket_create_start",e.fieldUpdate="ticket_field_update",e.fieldSuggestionClick="ticket_classification_click",e.suggestionClick="suggestion_click",e.suggestionRate="suggestion_rate",e.nextCaseStep="ticket_next_stage",e.caseCancelled="ticket_cancel",e.caseSolved="ticket_cancel",e.caseCreated="ticket_create"})(Ks||(Ks={}));var Zs;(function(e){e.quit="Quit",e.solved="Solved"})(Zs||(Zs={}));var Xs=e=>{let t={};return e.caseContext&&Object.keys(e.caseContext).forEach((r=>{var n;let i=(n=e.caseContext)===null||n===void 0?void 0:n[r];if(i){let e=`context_${r}`;t[e]=i}})),t},eo=(e,t=!0)=>{let{caseContext:r,caseId:n,caseNumber:i}=e,a=Ci(e,["caseContext","caseId","caseNumber"]),s=Xs(e);return Object.assign(Object.assign(Object.assign({CaseId:n,CaseNumber:i},a),!!s.context_Case_Subject&&{CaseSubject:s.context_Case_Subject}),t&&s)},to=class{constructor(e,t){this.opts=e,this.provider=t;let r=e.enableAnalytics===!1||Ds();this.coveoAnalyticsClient=r?new Ls:new $s(e)}disable(){this.coveoAnalyticsClient=new Ls}enable(){this.coveoAnalyticsClient=new $s(this.opts)}logInterfaceLoad(e){if(e){let t=eo(e);return this.logSearchEvent(Vs.interfaceLoad,t)}return this.logSearchEvent(Vs.interfaceLoad)}logInterfaceChange(e){let t=eo(e);return this.logSearchEvent(Vs.interfaceChange,t)}logStaticFilterDeselect(e){let t=eo(e);return this.logSearchEvent(Vs.staticFilterDeselect,t)}logFetchMoreResults(e){if(e){let t=eo(e);return this.logCustomEvent(Vs.pagerScrolling,Object.assign(Object.assign({},t),{type:"getMoreResults"}))}return this.logCustomEvent(Vs.pagerScrolling,{type:"getMoreResults"})}logBreadcrumbFacet(e){let t=eo(e);return this.logSearchEvent(Vs.breadcrumbFacet,t)}logBreadcrumbResetAll(e){if(e){let t=eo(e);return this.logSearchEvent(Vs.breadcrumbResetAll,t)}return this.logSearchEvent(Vs.breadcrumbResetAll)}logFacetSelect(e){let t=eo(e);return this.logSearchEvent(Vs.facetSelect,t)}logFacetExclude(e){let t=eo(e);return this.logSearchEvent(Vs.facetExclude,t)}logFacetDeselect(e){let t=eo(e);return this.logSearchEvent(Vs.facetDeselect,t)}logFacetUpdateSort(e){let t=eo(e);return this.logSearchEvent(Vs.facetUpdateSort,t)}logFacetClearAll(e){let t=eo(e);return this.logSearchEvent(Vs.facetClearAll,t)}logFacetShowMore(e){let t=eo(e,!1);return this.logCustomEvent(Vs.facetShowMore,t)}logFacetShowLess(e){let t=eo(e,!1);return this.logCustomEvent(Vs.facetShowLess,t)}logQueryError(e){let t=eo(e,!1);return this.logCustomEvent(Vs.queryError,t)}logPagerNumber(e){let t=eo(e,!1);return this.logCustomEvent(Vs.pagerNumber,t)}logPagerNext(e){let t=eo(e,!1);return this.logCustomEvent(Vs.pagerNext,t)}logPagerPrevious(e){let t=eo(e,!1);return this.logCustomEvent(Vs.pagerPrevious,t)}logDidYouMeanAutomatic(e){if(e){let t=eo(e);return this.logSearchEvent(Vs.didyoumeanAutomatic,t)}return this.logSearchEvent(Vs.didyoumeanAutomatic)}logDidYouMeanClick(e){if(e){let t=eo(e);return this.logSearchEvent(Vs.didyoumeanClick,t)}return this.logSearchEvent(Vs.didyoumeanClick)}logResultsSort(e){let t=eo(e);return this.logSearchEvent(Vs.resultsSort,t)}logSearchboxSubmit(e){if(e){let t=eo(e);return this.logSearchEvent(Vs.searchboxSubmit,t)}return this.logSearchEvent(Vs.searchboxSubmit)}logContextChanged(e){let t=eo(e);return this.logSearchEvent(Us.contextChanged,t)}logExpandToFullUI(e){let t=eo(e);return this.logCustomEvent(Us.expandToFullUI,t)}logOpenUserActions(e){let t=eo(e,!1);return this.logCustomEvent(Us.openUserActions,t)}logShowPrecedingSessions(e){let t=eo(e,!1);return this.logCustomEvent(Us.showPrecedingSessions,t)}logShowFollowingSessions(e){let t=eo(e,!1);return this.logCustomEvent(Us.showFollowingSessions,t)}logViewedDocumentClick(e,t){return this.logCustomEvent(Us.clickViewedDocument,Object.assign(Object.assign({},eo(t,!1)),{document:e}))}logPageViewClick(e,t){return this.logCustomEvent(Us.clickPageView,Object.assign(Object.assign({},eo(t,!1)),{pageView:e}))}logCreateArticle(e,t){return this.logCustomEvent(Us.createArticle,t?Object.assign(Object.assign({},eo(t,!1)),e):e)}logDocumentOpen(e,t,r){return this.logClickEvent(Vs.documentOpen,e,t,r?eo(r,!1):void 0)}logCopyToClipboard(e,t,r){return this.logClickEvent(Vs.copyToClipboard,e,t,r?eo(r,!1):void 0)}logCaseSendEmail(e,t,r){return this.logClickEvent(Vs.caseSendEmail,e,t,r?eo(r,!1):void 0)}logFeedItemTextPost(e,t,r){return this.logClickEvent(Vs.feedItemTextPost,e,t,r?eo(r,!1):void 0)}logDocumentQuickview(e,t,r){let n={documentTitle:e.documentTitle,documentURL:e.documentUrl};return this.logClickEvent(Vs.documentQuickview,e,t,r?Object.assign(Object.assign({},eo(r,!1)),n):n)}logCaseAttach(e,t,r){let n={documentTitle:e.documentTitle,documentURL:e.documentUrl,resultUriHash:e.documentUriHash};return this.logClickEvent(Vs.caseAttach,e,t,r?Object.assign(Object.assign({},eo(r,!1)),n):n)}logCaseDetach(e,t){return this.logCustomEvent(Vs.caseDetach,t?Object.assign(Object.assign({},eo(t,!1)),{resultUriHash:e}):{resultUriHash:e})}logLikeSmartSnippet(e){return this.logCustomEvent(Vs.likeSmartSnippet,e?eo(e,!1):void 0)}logDislikeSmartSnippet(e){return this.logCustomEvent(Vs.dislikeSmartSnippet,e?eo(e,!1):void 0)}logExpandSmartSnippet(e){return this.logCustomEvent(Vs.expandSmartSnippet,e?eo(e,!1):void 0)}logCollapseSmartSnippet(e){return this.logCustomEvent(Vs.collapseSmartSnippet,e?eo(e,!1):void 0)}logOpenSmartSnippetFeedbackModal(e){return this.logCustomEvent(Vs.openSmartSnippetFeedbackModal,e?eo(e,!1):void 0)}logCloseSmartSnippetFeedbackModal(e){return this.logCustomEvent(Vs.closeSmartSnippetFeedbackModal,e?eo(e,!1):void 0)}logSmartSnippetFeedbackReason(e,t,r){return this.logCustomEvent(Vs.sendSmartSnippetReason,r?Object.assign(Object.assign({},eo(r,!1)),{reason:e,details:t}):{reason:e,details:t})}logExpandSmartSnippetSuggestion(e,t){let r="documentId"in e?e:{documentId:e};return this.logCustomEvent(Vs.expandSmartSnippetSuggestion,t?Object.assign(Object.assign({},eo(t,!1)),r):r)}logCollapseSmartSnippetSuggestion(e,t){let r="documentId"in e?e:{documentId:e};return this.logCustomEvent(Vs.collapseSmartSnippetSuggestion,t?Object.assign(Object.assign({},eo(t,!1)),r):r)}logOpenSmartSnippetSource(e,t,r){return this.logClickEvent(Vs.openSmartSnippetSource,e,t,r?eo(r,!1):void 0)}logOpenSmartSnippetSuggestionSource(e,t,r){return this.logClickEvent(Vs.openSmartSnippetSuggestionSource,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},r?Object.assign(Object.assign({},eo(r,!1)),t):t)}logOpenSmartSnippetInlineLink(e,t,r){return this.logClickEvent(Vs.openSmartSnippetInlineLink,e,{contentIDKey:t.contentIDKey,contentIDValue:t.contentIDValue},r?Object.assign(Object.assign({},eo(r,!1)),t):t)}logOpenSmartSnippetSuggestionInlineLink(e,t,r){return this.logClickEvent(Vs.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},r?Object.assign(Object.assign({},eo(r,!1)),t):t)}logLikeGeneratedAnswer(e,t){return this.logCustomEvent(Vs.likeGeneratedAnswer,t?Object.assign(Object.assign({},eo(t,!1)),e):e)}logDislikeGeneratedAnswer(e,t){return this.logCustomEvent(Vs.dislikeGeneratedAnswer,t?Object.assign(Object.assign({},eo(t,!1)),e):e)}logOpenGeneratedAnswerSource(e,t){return this.logCustomEvent(Vs.openGeneratedAnswerSource,t?Object.assign(Object.assign({},eo(t,!1)),e):e)}logGeneratedAnswerSourceHover(e,t){return this.logCustomEvent(Vs.generatedAnswerSourceHover,t?Object.assign(Object.assign({},eo(t,!1)),e):e)}logGeneratedAnswerCopyToClipboard(e,t){return this.logCustomEvent(Vs.generatedAnswerCopyToClipboard,t?Object.assign(Object.assign({},eo(t,!1)),e):e)}logGeneratedAnswerHideAnswers(e,t){return this.logCustomEvent(Vs.generatedAnswerHideAnswers,t?Object.assign(Object.assign({},eo(t,!1)),e):e)}logGeneratedAnswerShowAnswers(e,t){return this.logCustomEvent(Vs.generatedAnswerShowAnswers,t?Object.assign(Object.assign({},eo(t,!1)),e):e)}logGeneratedAnswerExpand(e,t){return this.logCustomEvent(Vs.generatedAnswerExpand,t?Object.assign(Object.assign({},eo(t,!1)),e):e)}logGeneratedAnswerCollapse(e,t){return this.logCustomEvent(Vs.generatedAnswerCollapse,t?Object.assign(Object.assign({},eo(t,!1)),e):e)}logGeneratedAnswerFeedbackSubmit(e,t){return this.logCustomEvent(Vs.generatedAnswerFeedbackSubmit,t?Object.assign(Object.assign({},eo(t,!1)),e):e)}logRephraseGeneratedAnswer(e,t){return this.logSearchEvent(Vs.rephraseGeneratedAnswer,t?Object.assign(Object.assign({},eo(t,!1)),e):e)}logRetryGeneratedAnswer(e){return this.logSearchEvent(Vs.retryGeneratedAnswer,e?Object.assign({},eo(e,!1)):{})}logGeneratedAnswerStreamEnd(e,t){return this.logCustomEvent(Vs.generatedAnswerStreamEnd,t?Object.assign(Object.assign({},eo(t,!1)),e):e)}logCustomEvent(e,t){return ki(this,void 0,void 0,(function*(){let r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),n=Object.assign(Object.assign({},yield this.getBaseCustomEventRequest(r)),{eventType:Qs[e],eventValue:e});return this.coveoAnalyticsClient.sendCustomEvent(n)}))}logSearchEvent(e,t){return ki(this,void 0,void 0,(function*(){return this.coveoAnalyticsClient.sendSearchEvent(yield this.getBaseSearchEventRequest(e,t))}))}logClickEvent(e,t,r,n){return ki(this,void 0,void 0,(function*(){let i=Object.assign(Object.assign(Object.assign({},t),yield this.getBaseEventRequest(Object.assign(Object.assign({},r),n))),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e});return this.coveoAnalyticsClient.sendClickEvent(i)}))}logShowMoreFoldedResults(e,t,r){return ki(this,void 0,void 0,(function*(){return this.logClickEvent(Vs.showMoreFoldedResults,e,t,r?eo(r,!1):void 0)}))}logShowLessFoldedResults(e){return ki(this,void 0,void 0,(function*(){return this.logCustomEvent(Vs.showLessFoldedResults,e?eo(e,!1):void 0)}))}getBaseCustomEventRequest(e){return ki(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},yield this.getBaseEventRequest(e)),{lastSearchQueryUid:this.provider.getSearchUID()})}))}getBaseSearchEventRequest(e,t){var r,n;return ki(this,void 0,void 0,(function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},t),(n=(r=this.provider).getGeneratedAnswerMetadata)===null||n===void 0?void 0:n.call(r)))),this.provider.getSearchEventRequestPayload()),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e})}))}getBaseEventRequest(e){return ki(this,void 0,void 0,(function*(){let t=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign({},this.getOrigins()),{customData:t,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})}))}getOrigins(){var e,t;return{originContext:(t=(e=this.provider).getOriginContext)===null||t===void 0?void 0:t.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof $s?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}};var ro=()=>"default";var no=e=>new $s(e).getCurrentVisitorId(),io=new Gi.HistoryStore,ao=(e,t)=>typeof t=="function"?(...r)=>{let n=ve(r[0]);try{return t.apply(t,r)}catch(t){return e.error(t,"Error in analytics preprocessRequest. Returning original request."),n}}:void 0,so=(e,t)=>(...r)=>{let n=ve(r[1]);try{return t.apply(t,r)}catch(t){return e.error(t,"Error in analytics hook. Returning original request."),n}};var oo=()=>({url:"",clientId:"",additionalFields:[],advancedParameters:{debug:!1},products:[],facets:{results:[]},error:null,isLoading:!1,responseId:""});var uo=e=>{let t=e.configuration.search.locale.split("-")[0];return!t||t.length!==2?"en":t},co=class{constructor(e){this.getState=e;this.state=e()}getLanguage(){return uo(this.state)}getBaseMetadata(){let{context:e,configuration:t}=this.state,r=e?.contextValues||{},n={};for(let[e,t]of Object.entries(r)){let r=`context_${e}`;n[r]=t}return t.analytics.analyticsMode==="legacy"&&(n.coveoHeadlessVersion=Ii),n}getOriginContext(){return this.state.configuration.analytics.originContext}getOriginLevel1(){return this.state.searchHub||ro()}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3}getIsAnonymous(){return this.state.configuration.analytics.anonymous}};function lo(){return{desiredCount:5,numberOfValues:8,set:{}}}var fo=(e,t)=>{let r=e=>e.facetId===t;if("productListing"in e&&e.productListing&&"facets"in e.productListing&&"results"in e.productListing.facets)return e.productListing.facets.results.find(r);if("search"in e&&e.search)return e.search.response.facets.find(r)},ho=(e,t)=>e.facetSet[t]?.request;function go(e,t){return!!t&&t.facetId in e.facetSet}var po=(e,t)=>{let r=fo(e,t);if(go(e,r))return r};var yo=(e,t)=>{let r=po(e,t);return r?r.values.filter((e=>e.state!=="idle")):[]},vo=e=>"productListing"in e?e.productListing.isLoading:e.search.isLoading;function mo(e){let{activeValue:t,ancestryMap:r}=wo(e);return t?bo(t,r):[]}function wo(e){let t=[...e],r=new Map;for(;t.length>0;){let e=t.shift();if(e.state==="selected")return{activeValue:e,ancestryMap:r};if(r)for(let t of e.children)r.set(t,e);t.unshift(...e.children)}return{}}function bo(e,t){let r=[];if(!e)return[];let n=e;do{r.unshift(n),n=t.get(n)}while(n);return r}function So(e,t){return!!t&&t.facetId in e.categoryFacetSet}var Io=(e,t)=>{let r=fo(e,t);if(So(e,r))return r},Oo=(e,t)=>e.categoryFacetSet[t]?.request,Ao=(e,t)=>{let r=Io(e,t);return mo(r?.values??[])},qo=(e,t)=>{let r=Oo(e,t);return mo(r?.currentValues??[])};function Co(){return{}}function ko(e){return{request:e}}function xo(){return{}}function jo(e){return{request:e}}function Ro(){return{}}function Fo(e){return{request:e,hasBreadcrumbs:!0}}function To(){return{}}var Do=(e,t)=>{let r=Wo(t,e),n=r?r.field:"",i=Go(n,e);return{facetId:e,facetField:n,facetTitle:i}};function Mo(e,t){let{facetId:r,facetValue:n}=e,i=Do(r,t),a=Jo(t,r);return{...i,facetValue:a==="hierarchical"?No(t,r):n}}function Eo(e){return{facetSet:e.facetSet??To(),categoryFacetSet:e.categoryFacetSet??Co(),dateFacetSet:e.dateFacetSet??xo(),numericFacetSet:e.numericFacetSet??Ro(),automaticFacetSet:e.automaticFacetSet??lo()}}var Po=e=>{let t=[];return Uo(e).forEach(((r,n)=>{let i=Jo(e,r.facetId),a=Yo(r,n+1);if($o(r)){if(!!!qo(e,r.facetId).length)return;t.push({...a,...zo(e,r.facetId),facetType:i,state:"selected"});return}r.currentValues.forEach(((e,n)=>{if(e.state==="idle")return;let s=Qo(e,n+1,i),o=_o(r)?Bo(e):Lo(e);t.push({...a,...s,...o})}))})),Vo(e).forEach(((e,r)=>{let n=Ho(e,r+1);e.values.forEach(((e,r)=>{if(e.state==="idle")return;let i=Qo(e,r+1,"specific"),a=Bo(e);t.push({...n,...i,...a})}))})),t},_o=e=>e.type==="specific",$o=e=>e.type==="hierarchical",Uo=e=>[...Object.values(e.facetSet),...Object.values(e.categoryFacetSet),...Object.values(e.dateFacetSet),...Object.values(e.numericFacetSet)].map((e=>e.request)),Vo=e=>[...Object.values(e.automaticFacetSet.set)].map((e=>e.response)),Qo=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),Lo=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),Bo=e=>({displayValue:e.value,value:e.value}),No=(e,t)=>qo(e,t).map((e=>e.value)).join(";"),zo=(e,t)=>{let r=No(e,t);return{value:r,valuePosition:1,displayValue:r}},Ho=(e,t)=>({title:Go(e.field,e.field),field:e.field,id:e.field,facetPosition:t}),Yo=(e,t)=>({title:Go(e.field,e.facetId),field:e.field,id:e.facetId,facetPosition:t}),Go=(e,t)=>`${e}_${t}`,Wo=(e,t)=>e.facetSet[t]?.request||e.categoryFacetSet[t]?.request||e.dateFacetSet[t]?.request||e.numericFacetSet[t]?.request||e.automaticFacetSet.set[t]?.response,Jo=(e,t)=>{let r=Wo(e,t);return r?r.type:"specific"};var Ko=()=>({q:"",enableQuerySyntax:!1});var Zo=class extends co{getSearchUID(){let e=this.getState();return e.search?.searchResponseId||e.search?.response.searchUid||dt().response.searchUid}getPipeline(){return this.state.pipeline||this.state.search?.response.pipeline||"default"}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getFacetState(){return Po(Eo(this.state))}getBaseMetadata(){let e=this.getState(),t=super.getBaseMetadata(),r=e.search?.response?.extendedResults?.generativeQuestionAnsweringId;return r&&(t.generativeQuestionAnsweringId=r),t}getGeneratedAnswerMetadata(){let e=this.getState();return{...e.generatedAnswer?.isVisible!==void 0&&{showGeneratedAnswer:e.generatedAnswer.isVisible}}}get queryText(){return this.state.query?.q||Ko().q}get responseTime(){return this.state.search?.duration||dt().duration}mapResultsToAnalyticsDocument(){return this.state.search?.response.results.map((e=>({documentUri:e.uri,documentUriHash:e.raw.urihash})))}get numberOfResults(){return this.state.search?.response.results.length||dt().response.results.length}},Xo=({logger:e,getState:t,analyticsClientMiddleware:r=((e,t)=>t),preprocessRequest:n,provider:i=new Zo(t)})=>{let a=t(),s=a.configuration.accessToken,o=a.configuration.analytics.apiBaseUrl,u=a.configuration.analytics.runtimeEnvironment,c=a.configuration.analytics.enabled,l=new to({enableAnalytics:c,token:s,endpoint:o,runtimeEnvironment:u,preprocessRequest:ao(e,n),beforeSendHooks:[so(e,r),(t,r)=>(e.info({...r,type:t,endpoint:o,token:s},"Analytics request"),r)]},i);return c||l.disable(),l};var eu=class extends co{constructor(){super(...arguments);this.initialState=oo()}getPipeline(){return""}getSearchEventRequestPayload(){return{queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){return this.getState().productListing?.responseId||this.initialState.responseId}mapResultsToAnalyticsDocument(){return this.state.productListing?.products.map((e=>({documentUri:e.documentUri,documentUriHash:e.documentUriHash,permanentid:e.permanentid})))}get numberOfResults(){return this.state.productListing.products.length}},tu=({logger:e,getState:t,analyticsClientMiddleware:r=((e,t)=>t),preprocessRequest:n,provider:i=new eu(t)})=>{let a=t(),s=a.configuration.accessToken,o=a.configuration.analytics.apiBaseUrl,u=a.configuration.analytics.runtimeEnvironment,c=a.configuration.analytics.enabled,l=new Gs({token:s,endpoint:o,runtimeEnvironment:u,preprocessRequest:ao(e,n),beforeSendHooks:[so(e,r),(t,r)=>(e.info({...r,type:t,endpoint:o,token:s},"Analytics request"),r)]},i);return c||l.disable(),l};var ru=(e=>(e.Ascending="ascending",e.Descending="descending",e))(ru||{}),nu=(e=>(e.Relevancy="relevancy",e.QRE="qre",e.Date="date",e.Field="field",e.NoSort="nosort",e))(nu||{}),iu=e=>{if(ne(e))return e.map((e=>iu(e))).join(",");switch(e.by){case"relevancy":case"qre":case"nosort":return e.by;case"date":return`date ${e.order}`;case"field":return`@${e.field} ${e.order}`;default:return""}},au=()=>({by:"relevancy"});new ee({values:{by:new ie({enum:nu,required:!0}),order:new ie({enum:ru}),field:new Z}});function su(){return iu(au())}var ou=class e extends co{constructor(){super(...arguments);this.getFacetRequest=e=>this.state.facetSet?.[e]?.request||this.state.categoryFacetSet?.[e]?.request||this.state.dateFacetSet?.[e]?.request||this.state.numericFacetSet?.[e]?.request||this.state.automaticFacetSet?.set[e]?.response}getFacetState(){return Po(Eo(this.getState()))}getPipeline(){return this.state.pipeline||this.state.search?.response.pipeline||e.fallbackPipelineName}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.resultURIs,numberOfResults:this.numberOfResults}}getSearchUID(){let e=this.getState();return e.search?.searchResponseId||e.search?.response.searchUid||dt().response.searchUid}getSplitTestRunName(){return this.state.search?.response.splitTestRun}getSplitTestRunVersion(){let t=!!this.getSplitTestRunName(),r=this.state.search?.response.pipeline||this.state.pipeline||e.fallbackPipelineName;return t?r:void 0}getBaseMetadata(){let e=this.getState(),t=super.getBaseMetadata(),r=e.search?.response?.extendedResults?.generativeQuestionAnsweringId;return r&&(t.generativeQuestionAnsweringId=r),t}getFacetMetadata(e,t){let r=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),facetId:e,facetField:r,facetValue:t,facetTitle:`${r}_${e}`}}getFacetClearAllMetadata(e){let t=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),facetId:e,facetField:t,facetTitle:`${t}_${e}`}}getFacetUpdateSortMetadata(e,t){let r=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),facetId:e,facetField:r,criteria:t,facetTitle:`${r}_${e}`}}getRangeBreadcrumbFacetMetadata(e,t){let r=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),facetId:e,facetField:r,facetRangeEnd:t.end,facetRangeEndInclusive:t.endInclusive,facetRangeStart:t.start,facetTitle:`${r}_${e}`}}getResultSortMetadata(){return{...this.getBaseMetadata(),resultsSortBy:this.state.sortCriteria??su()}}getStaticFilterToggleMetadata(e,t){return{...this.getBaseMetadata(),staticFilterId:e,staticFilterValue:t}}getStaticFilterClearAllMetadata(e){return{...this.getBaseMetadata(),staticFilterId:e}}getUndoTriggerQueryMetadata(e){return{...this.getBaseMetadata(),undoneQuery:e}}getCategoryBreadcrumbFacetMetadata(e,t){let r=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),categoryFacetId:e,categoryFacetField:r,categoryFacetPath:t,categoryFacetTitle:`${r}_${e}`}}getOmniboxAnalyticsMetadata(e,t){let r=this.state.querySuggest&&this.state.querySuggest[e],n=r.completions.map((e=>e.expression)),i=r.partialQueries.length-1,a=r.partialQueries[i]||"",s=r.responseId;return{...this.getBaseMetadata(),suggestionRanking:n.indexOf(t),partialQuery:a,partialQueries:r.partialQueries.length>0?r.partialQueries:"",suggestions:n.length>0?n:"",querySuggestResponseId:s}}getInterfaceChangeMetadata(){return{...this.getBaseMetadata(),interfaceChangeTo:this.state.configuration.analytics.originLevel2}}getOmniboxFromLinkMetadata(e){return{...this.getBaseMetadata(),...e}}getGeneratedAnswerMetadata(){let e=this.getState(),t={};return e.generatedAnswer?.isVisible!==void 0&&(t.showGeneratedAnswer=e.generatedAnswer.isVisible),t}get resultURIs(){return this.results?.map((e=>({documentUri:e.uri,documentUriHash:e.raw.urihash})))}get results(){return this.state.search?.response.results}get queryText(){return this.state.query?.q||Ko().q}get responseTime(){return this.state.search?.duration||dt().duration}get numberOfResults(){return this.state.search?.response.totalCountFiltered||dt().response.totalCountFiltered}};ou.fallbackPipelineName="default";var uu=ou,cu=({logger:e,getState:t,analyticsClientMiddleware:r=((e,t)=>t),preprocessRequest:n,provider:i=new uu(t)})=>{let a=t(),s=a.configuration.accessToken,o=a.configuration.analytics.apiBaseUrl,u=a.configuration.analytics.runtimeEnvironment,c=a.configuration.analytics.enabled,l=new Gs({token:s,endpoint:o,runtimeEnvironment:u,preprocessRequest:ao(e,n),beforeSendHooks:[so(e,r),(t,r)=>(e.info({...r,type:t,endpoint:o,token:s},"Analytics request"),r)]},i);return c||l.disable(),l},lu=()=>{let e=io.getHistory().reverse().find((e=>e.name==="PageView"&&e.value));return e?e.value:""};function du(e){let t=fu(e),r=[e,...t].filter((e=>e.parentResult)).map((e=>e.parentResult));return ce([e,...t,...r],(e=>e.uniqueId))}function fu(e){return e.childResults?e.childResults.flatMap((e=>[e,...fu(e)])):[]}var hu=()=>"";function gu(e,t){return{...new uu(t).getBaseMetadata(),actionCause:e,type:e}}function pu(e){return Object.assign(e,{instantlyCallable:!0})}function yu(e,t){let r=t=>pu(Qn(e,t)),n=r((async(e,{getState:r,extra:n})=>{let{analyticsClientMiddleware:i,preprocessRequest:a,logger:s}=n;return await(await t({getState:r,analyticsClientMiddleware:i,preprocessRequest:a,logger:s})).log({state:r(),extra:n})}));return Object.assign(n,{prepare:async({getState:e,analyticsClientMiddleware:n,preprocessRequest:i,logger:a})=>{let{description:s,log:o}=await t({getState:e,analyticsClientMiddleware:n,preprocessRequest:i,logger:a});return{description:s,action:r((async(e,{getState:t,extra:r})=>await o({state:t(),extra:r})))}}}),n}var vu=(e,t,r)=>{function n(...n){let i=n.length===1?{...n[0],__legacy__getBuilder:t(n[0].__legacy__getBuilder),analyticsConfigurator:e,providerClass:r}:{prefix:n[0],__legacy__getBuilder:t(n[1]),__legacy__provider:n[2],analyticsConfigurator:e,providerClass:r};return bu(i)}return n},mu=e=>e.configuration.analytics.analyticsMode==="legacy",wu=e=>e.configuration.analytics.analyticsMode==="next",bu=({prefix:e,__legacy__getBuilder:t,__legacy__provider:r,analyticsPayloadBuilder:n,analyticsType:i,analyticsConfigurator:a,providerClass:s})=>(r??(r=e=>new s(e)),yu(e,(async({getState:e,analyticsClientMiddleware:s,preprocessRequest:o,logger:u})=>{let c=[],l={log:async({state:e})=>{for(let t of c)await t(e)}},d=e(),f=a({getState:e,logger:u,analyticsClientMiddleware:s,preprocessRequest:o,provider:r(e)}),h=await t(f,e());l.description=h?.description,c.push((async e=>{mu(e)&&await Su(h,r,e,u,f.coveoAnalyticsClient)}));let{emit:g}=qi(d);return c.push((async e=>{if(wu(e)&&i&&n){let t=n(e);await $u(g,i,t)}})),l})));async function Su(e,t,r,n,i){t((()=>r));let a=await(e?.log({searchUID:t((()=>r)).getSearchUID()}));n.info({client:i,response:a},"Analytics response")}var Iu=e=>t=>(r,n)=>Promise.resolve({description:{actionCause:e},log:async e=>{t(r,n)}}),Ou=vu(cu,(e=>e),uu),Au=e=>vu(Xo,Iu(e),Zo),qu=vu(tu,(e=>e),eu);var Cu=(e,t)=>{let r=e=>e+(t.pagination?.firstResult??0),n=-1,i=t.search?.results;return n=_u(e,i),n<0&&(n=Pu(e,i)),n<0&&(n=0),ku(e,r(n),t)};function ku(e,t,r){let n=e.raw.collection;return{collectionName:typeof n=="string"?n:"default",documentAuthor:Du(e),documentPosition:t+1,documentTitle:e.title,documentUri:e.uri,documentUriHash:e.raw.urihash,documentUrl:e.clickUri,rankingModifier:e.rankingModifier||"",sourceName:Mu(e),queryPipeline:r.pipeline||hu()}}var xu=e=>(e.raw.permanentid||console.warn("Missing field permanentid on result. This might cause many issues with your Coveo deployment. See https://docs.coveo.com/en/1913 and https://docs.coveo.com/en/1640 for more information.",e),{contentIDKey:"permanentid",contentIDValue:e.raw.permanentid||""}),ju={urihash:new Z,sourcetype:new Z,permanentid:new Z},Ru={uniqueId:Rt,raw:new ee({values:ju}),title:Rt,uri:Rt,clickUri:Rt,rankingModifier:new Z({required:!1,emptyAllowed:!0})};function Fu(e){return Object.assign({},...Object.keys(ju).map((t=>({[t]:e[t]}))))}function Tu(e){return Object.assign({},...Object.keys(Ru).map((t=>({[t]:e[t]}))),{raw:Fu(e.raw)})}function Du(e){let t=e.raw.author;return N(t)?"unknown":Array.isArray(t)?t.join(";"):`${t}`}function Mu(e){let t=e.raw.source;return N(t)?"unknown":t}var Eu=e=>new V(Ru).validate(Tu(e));function Pu(e,t){for(let[r,n]of t.entries()){let t=du(n);if(_u(e,t)!==-1)return r}return-1}function _u(e,t=[]){return t.findIndex((({uniqueId:t})=>t===e.uniqueId))}async function $u(e,t,r){await e(t,r)}var Uu=(e,t)=>{let r=xu(e),n=Cu(e,t);return{uniqueFieldName:r.contentIDKey,uniqueFieldValue:r.contentIDValue,title:n.documentTitle,author:n.documentAuthor,url:n.documentUri}};var Vu=()=>({actionCause:"interfaceLoad"}),Qu=()=>({actionCause:"interfaceChange"});var Lu=mn("insightConfiguration/set",(e=>$t(e,{insightId:Rt})));var Bu=()=>({insightId:""});var Nu=Tn(Bu(),(e=>{e.addCase(Lu,((e,t)=>{e.insightId=t.payload.insightId}))}));var zu=mn("searchHub/set",(e=>$t(e,new Z({required:!0,emptyAllowed:!0}))));var Hu=Qn("insight/interface/fetch",(async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:{apiClient:i}})=>{let a=t(),s=await i.getInterface(Yu(a));return mt(s)?n(s.error):(r(zu(s.success.searchHub)),{response:s.success})})),Yu=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.platformUrl,insightId:e.insightConfiguration.insightId});var Gu=()=>({loading:!1,config:void 0});var Wu=Tn(Gu(),(e=>{e.addCase(Hu.pending,(e=>{e.loading=!0,e.error=void 0})).addCase(Hu.rejected,((e,t)=>{e.loading=!1,e.error=t.payload})).addCase(Hu.fulfilled,((e,t)=>{e.loading=!1,e.error=void 0;let{searchHub:r,...n}=t.payload.response;e.config=n}))}));var Ju=d(k()),Ku=d(x());var Zu=d(k()),Xu=d(j());Zu.default.extend(Xu.default);var ec="YYYY/MM/DD@HH:mm:ss",tc="1401-01-01";function rc(e,t){let r=(0,Zu.default)(e,t);return!r.isValid()&&!t?(0,Zu.default)(e,ec):r}function nc(e){return e.format(ec)}function ic(e,t){let r=rc(e,t);if(!r.isValid()){let r=". Please provide a date format string in the configuration options. See https://day.js.org/docs/en/parse/string-format for more information.",n=` with the format "${t}"`;throw new Error(`Could not parse the provided date "${e}"${t?n:r}`)}ac(r)}function ac(e){if(e.isBefore(tc))throw new Error(`Date is before year 1401, which is unsupported by the API: ${e}`)}Ju.default.extend(Ku.default);var sc=["past","now","next"],oc=["minute","hour","day","week","month","quarter","year"],uc=e=>{let t=e==="now";return{amount:new z({required:!t,min:1}),unit:new Z({required:!t,constrainTo:oc}),period:new Z({required:!0,constrainTo:sc})}};function cc(e){if(typeof e=="string"&&!gc(e))throw new Error(`The value "${e}" is not respecting the relative date format "period-amount-unit"`);let t=typeof e=="string"?yc(e):e;new V(uc(t.period)).validate(t);let r=dc(t),n=JSON.stringify(t);if(!r.isValid())throw new Error(`Date is invalid: ${n}`);ac(r)}function lc(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":case"next":return`${t}-${r}-${n}`;case"now":return t}}function dc(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":return(0,Ju.default)().subtract(r,n);case"next":return(0,Ju.default)().add(r,n);case"now":return(0,Ju.default)()}}function fc(e){return nc(dc(yc(e)))}function hc(e){return e.toLocaleLowerCase().split("-")}function gc(e){let[t,r,n]=hc(e);if(t==="now")return!0;if(!sc.includes(t)||!oc.includes(n))return!1;let i=parseInt(r);return!(isNaN(i)||i<=0)}function pc(e){return!!e&&typeof e=="object"&&"period"in e}function yc(e){let[t,r,n]=hc(e);return t==="now"?{period:"now"}:{period:t,amount:r?parseInt(r):void 0,unit:n||void 0}}function vc(e){return cc(e),yc(e)}function mc(e){return e.type==="dateRange"}function wc(e){return`start${e}`}function bc(e){return`end${e}`}var Sc=()=>({dateFacetValueMap:{}});function Ic(e,t,r){let n=e.start,i=e.end;return gc(n)&&(n=fc(n),r.dateFacetValueMap[t][wc(n)]=e.start),gc(i)&&(i=fc(i),r.dateFacetValueMap[t][bc(i)]=e.end),{...e,start:n,end:i}}function Oc(e,t){if(mc(e)){let{facetId:r,currentValues:n}=e;return t.dateFacetValueMap[r]={},{...e,currentValues:n.map((e=>Ic(e,r,t)))}}return e}function Ac(e){let t=Sc();return{request:{...e,facets:e.facets?.map((e=>Oc(e,t)))},mappings:t}}function qc(e,t,r){return{...e,start:r.dateFacetValueMap[t][wc(e.start)]||e.start,end:r.dateFacetValueMap[t][bc(e.end)]||e.end}}function Cc(e,t){return e.facetId in t.dateFacetValueMap}function kc(e,t){return Cc(e,t)?{...e,values:e.values.map((r=>qc(r,e.facetId,t)))}:e}function xc(e,t){return"success"in e?{success:{...e.success,facets:e.success.facets?.map((e=>kc(e,t)))}}:e}var jc=async(e,t)=>{let r=e.analyticsMode==="next";return{analytics:{clientId:await no(e),clientTimestamp:(new Date).toISOString(),documentReferrer:e.originLevel3,originContext:e.originContext,...t&&{actionCause:t.actionCause,customData:t.customData},...t&&!r&&{customData:t.customData},...e.userDisplayName&&{userDisplayName:e.userDisplayName},...e.documentLocation&&{documentLocation:e.documentLocation},...e.deviceId&&{deviceId:e.deviceId},...lu()&&{pageId:lu()},...r&&e.trackingId&&{trackingId:e.trackingId},capture:r,...r&&{source:Ai(e)}}}};var Rc=async(e,t)=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.platformUrl,count:t.querySuggest[e].count,insightId:t.insightConfiguration.insightId,q:t.querySet?.[e],timezone:t.configuration.search.timezone,actionsHistory:t.configuration.analytics.enabled?io.getHistory():[],...t.insightCaseContext?.caseContext&&{context:t.insightCaseContext.caseContext},...t.configuration.analytics.enabled&&{visitorId:await no(t.configuration.analytics),...t.configuration.analytics.enabled&&await jc(t.configuration.analytics)}});var Fc=mn("didYouMean/enable"),Tc=mn("didYouMean/disable"),Dc=mn("didYouMean/automaticCorrections/disable"),Mc=mn("didYouMean/automaticCorrections/enable"),Ec=mn("didYouMean/correction",(e=>$t(e,Rt))),Pc=mn("didYouMean/automaticCorrections/mode",(e=>$t(e,new Z({constrainTo:["next","legacy"],emptyAllowed:!1,required:!0}))));var _c=()=>({correctedQuery:"",wordCorrections:[],originalQuery:""}),$c=()=>({correctedQuery:"",corrections:[],originalQuery:""});function Uc(){return{enableDidYouMean:!1,wasCorrectedTo:"",wasAutomaticallyCorrected:!1,queryCorrection:_c(),originalQuery:"",automaticallyCorrectQuery:!0,queryCorrectionMode:"legacy"}}var Vc=mn("history/undo"),Qc=mn("history/redo"),Lc=mn("history/snapshot");Qn("history/back",(async(e,{dispatch:t})=>{t(Vc()),await t(Bc())}));Qn("history/forward",(async(e,{dispatch:t})=>{t(Qc()),await t(Bc())}));var Bc=Qn("history/change",(async(e,{getState:t})=>t().history.present));var Nc=()=>({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,lq:"",lqWasSet:!1,dq:"",dqWasSet:!1,defaultFilters:{cq:"",aq:"",lq:"",dq:""}});function zc(){return{contextValues:{}}}var Hc=()=>!1;function Yc(){return{contextValues:{}}}function Gc(){return{enabled:!0}}function Wc(){return{freezeFacetOrder:!1,facets:{}}}function Jc(){return[]}function Kc(){return{firstResult:0,defaultNumberOfResults:10,numberOfResults:10,totalCountFiltered:0}}function Zc(){return{}}function Xc(){return{}}function el(){return{}}function tl(e){return{context:e.context||zc(),dictionaryFieldContext:e.dictionaryFieldContext||Yc(),facetSet:e.facetSet||To(),numericFacetSet:e.numericFacetSet||Ro(),dateFacetSet:e.dateFacetSet||xo(),categoryFacetSet:e.categoryFacetSet||Co(),automaticFacetSet:e.automaticFacetSet??lo(),pagination:e.pagination||Kc(),query:e.query||Ko(),tabSet:e.tabSet||el(),advancedSearchQueries:e.advancedSearchQueries||Nc(),staticFilterSet:e.staticFilterSet||Xc(),querySet:e.querySet||Zc(),sortCriteria:e.sortCriteria||su(),pipeline:e.pipeline||hu(),searchHub:e.searchHub||ro(),facetOptions:e.facetOptions||Wc(),facetOrder:e.facetOrder??Jc(),debug:e.debug??Hc()}}var rl=mn("query/updateQuery",(e=>$t(e,{q:new Z,enableQuerySyntax:new G})));var nl=()=>({caseContext:{},caseId:"",caseNumber:""}),il=e=>({caseContext:e?.caseContext||{},caseId:e?.caseId,caseNumber:e?.caseNumber});var al=()=>Au("pagerScrolling")("search/logFetchMoreResults",((e,t)=>e.logFetchMoreResults(il(t.insightCaseContext)))),sl=e=>Au("query")("search/queryError",((t,r)=>t.logQueryError({...il(r.insightCaseContext),query:r.query?.q||Ko().q,aq:"",cq:"",dq:"",errorType:e.type,errorMessage:e.message}))),ol=()=>Au("interfaceLoad")("analytics/interface/load",((e,t)=>e.logInterfaceLoad(il(t.insightCaseContext)))),ul=()=>Au("interfaceChange")("analytics/interface/change",((e,t)=>{e.logInterfaceChange({...il(t.insightCaseContext),interfaceChangeTo:t.configuration.analytics.originLevel2})}));function cl(e){return Object.values(e).map((e=>e.request))}var ll=async(e,t)=>{let r=yl(e),n=pl(e);return Ac({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.platformUrl,insightId:e.insightConfiguration.insightId,...e.configuration.analytics.enabled&&await jc(e.configuration.analytics,t),q:e.query?.q,...n.length&&{facets:n},caseContext:e.insightCaseContext?.caseContext,...r&&{cq:r},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},...e.sortCriteria&&{sortCriteria:e.sortCriteria},tab:e.configuration.analytics.originLevel2,...e.folding&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.context&&{context:e.context.contextValues},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})},dl=async(e,t)=>{let r=()=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0,n=await ll(e,t);return{...n,request:{...n.request,...e.pagination&&{firstResult:e.pagination.firstResult,numberOfResults:r()}}}},fl=async(e,t)=>{let r=await ll(e);return{...r,request:{...r.request,filterFieldRange:100,cq:`@${e?.folding?.fields.collection}="${t}"`}}},hl=async(e,t)=>{let r=await dl(e,t);return r.request={...r.request,firstResult:(e.pagination?.firstResult??0)+(e.pagination?.numberOfResults??0)},r},gl=async(e,t)=>{let r=await dl(e,t);return r.request={...r.request,numberOfResults:0},r};function pl(e){return cl({...e.facetSet,...e.numericFacetSet,...e.dateFacetSet,...e.categoryFacetSet})}function yl(e){return Object.values(e.tabSet||{}).find((e=>e.isActive))?.expression.trim()||""}var vl=class{constructor(e){this.config=e}async fetchFromAPI({request:e,mappings:t},r){let n=(new Date).getTime(),i=xc(await this.extra.apiClient.query(e,r),t),a=(new Date).getTime()-n,s=this.getState().query?.q||"";return{response:i,duration:a,queryExecuted:s,requestExecuted:e}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return mt(e.response)?(this.dispatch(sl(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){if(!this.shouldReExecuteTheQueryWithCorrections(e)||mt(e.response))return null;let{correctedQuery:t}=e.response.success.queryCorrections?e.response.success.queryCorrections[0]:_c(),r=this.getCurrentQuery(),n=await this.automaticallyRetryQueryWithCorrection(t);return mt(n.response)?(this.dispatch(sl(n.response.error)),this.rejectWithValue(n.response.error)):(this.dispatch(Lc(tl(this.getState()))),{...n,response:{...n.response.success,queryCorrections:e.response.success.queryCorrections},automaticallyCorrected:!0,originalQuery:r})}shouldReExecuteTheQueryWithCorrections(e){let t=this.getState(),r=this.getSuccessResponse(e);return!!(t.didYouMean?.enableDidYouMean===!0&&r?.results.length===0&&r?.queryCorrections&&r?.queryCorrections.length!==0)}async automaticallyRetryQueryWithCorrection(e){this.dispatch(rl({q:e}));let t=this.getState(),r=await this.fetchFromAPI(await dl(t));return this.dispatch(Ec(e)),r}processSuccessResponse(e){return this.dispatch(Lc(tl(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery()}}getSuccessResponse(e){return vt(e.response)?e.response.success:null}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}getCurrentQuery(){let e=this.getState();return e.query?.q!==void 0?e.query.q:""}};var ml=()=>Au("didyoumeanAutomatic")("analytics/didyoumean/automatic",((e,t)=>e.logDidYouMeanAutomatic(il(t.insightCaseContext))));var wl=class{constructor(e){this.config=e}async fetchFromAPI({request:e,mappings:t},r){let n=(new Date).getTime(),i=xc(await this.extra.apiClient.query(e,r),t),a=(new Date).getTime()-n,s=this.getState().query?.q||"";return{response:i,duration:a,queryExecuted:s,requestExecuted:e}}async process(e,t){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e,t)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return mt(e.response)?(this.dispatch(sl(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e,t){if(!this.shouldReExecuteTheQueryWithCorrections(e)||mt(e.response))return null;let{correctedQuery:r}=e.response.success.queryCorrections?e.response.success.queryCorrections[0]:_c(),n=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithCorrection(r);return mt(i.response)?(this.dispatch(sl(i.response.error)),this.rejectWithValue(i.response.error)):(this.logOriginalAnalyticsQueryBeforeAutoCorrection(e,t),this.dispatch(Lc(tl(this.getState()))),{...i,response:{...i.response.success,queryCorrections:e.response.success.queryCorrections},automaticallyCorrected:!0,originalQuery:n,analyticsAction:ml()})}shouldReExecuteTheQueryWithCorrections(e){let t=this.getState(),r=this.getSuccessResponse(e);return!!(t.didYouMean?.enableDidYouMean===!0&&r?.results.length===0&&r?.queryCorrections&&r?.queryCorrections.length!==0)}async automaticallyRetryQueryWithCorrection(e){this.dispatch(rl({q:e}));let t=this.getState(),r=await this.fetchFromAPI(await dl(t));return this.dispatch(Ec(e)),r}processSuccessResponse(e){return this.dispatch(Lc(tl(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(e){return vt(e.response)?e.response.success:null}getStateAfterResponse(e,t,r,n){return{...r,query:{q:e,enableQuerySyntax:r.query?.enableQuerySyntax??Ko().enableQuerySyntax},search:{...dt(),duration:t,response:n,results:n.results}}}logOriginalAnalyticsQueryBeforeAutoCorrection(e,t){let r=this.getState(),n=xc(e.response,t.mappings).success;this.analyticsAction&&this.analyticsAction()(this.dispatch,(()=>this.getStateAfterResponse(e.queryExecuted,e.duration,r,n)),this.extra)}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}getCurrentQuery(){let e=this.getState();return e.query?.q!==void 0?e.query.q:""}get analyticsAction(){return this.config.analyticsAction}};async function bl(e,t,r){Ml(e);let n=new wl({...t,analyticsAction:r}),{analyticsClientMiddleware:i,preprocessRequest:a,logger:s}=t.extra,{description:o}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:i,preprocessRequest:a,logger:s}),u=await dl(e,o),c=await n.fetchFromAPI(u);return await n.process(c,u)}async function Sl(e,t,r){Ml(e);let n=new wl({...t,analyticsAction:r}),{analyticsClientMiddleware:i,preprocessRequest:a,logger:s}=t.extra,{description:o}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:i,preprocessRequest:a,logger:s}),u=await dl(e,o),c=await n.fetchFromAPI(u);return await n.process(c,u)}async function Il(e,t){let r=new wl({...t,analyticsAction:al}),{analyticsClientMiddleware:n,preprocessRequest:i,logger:a}=t.extra,{description:s}=await al().prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:i,logger:a}),o=await hl(e,s),u=await r.fetchFromAPI(o);return await r.process(u,o)}async function Ol(e,t,r){let n=new wl({...t,analyticsAction:r}),{analyticsClientMiddleware:i,preprocessRequest:a,logger:s}=t.extra,{description:o}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:i,preprocessRequest:a,logger:s}),u=await gl(e,o),c=await n.fetchFromAPI(u);return await n.process(c,u)}var Al=Qn("search/executeSearch",(async(e,t)=>{let r=t.getState();return await bl(r,t,e)})),ql=Qn("search/fetchPage",(async(e,t)=>{let r=t.getState();return await Sl(r,t,e)})),Cl=Qn("search/fetchMoreResults",(async(e,t)=>{let r=t.getState();return await Il(r,t)})),kl=Qn("search/fetchFacetValues",(async(e,t)=>{let r=t.getState();return await Ol(r,t,e)}));var xl=async(e,t,{request:r,mappings:n},i)=>{let a=(new Date).getTime(),s=xc(await e.query(r,i),n),o=(new Date).getTime()-a,u=t.query?.q||"";return{response:s,duration:o,queryExecuted:u,requestExecuted:r}},jl=Qn("search/executeSearch",(async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return bl(r,t,e.legacy);Ml(r);let n=new vl({...t}),i=El(e.next),a=await dl(r,i),s=await n.fetchFromAPI(a);return await n.process(s)})),Rl=Qn("search/fetchPage",(async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return Sl(r,t,e.legacy);Ml(r);let n=new vl({...t}),i=El(e.next),a=await dl(r,i),s=await n.fetchFromAPI(a);return await n.process(s)})),Fl=Qn("search/fetchMoreResults",(async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return Il(r,t);let n=new vl({...t}),i=El({actionCause:"pagerScrolling"}),a=await hl(r,i),s=await n.fetchFromAPI(a);return await n.process(s)})),Tl=Qn("search/fetchFacetValues",(async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return Ol(r,t,e.legacy);let n=new vl({...t}),i=El(e.next),a=await gl(r,i),s=await n.fetchFromAPI(a);return await n.process(s)})),Dl=Qn("querySuggest/fetch",(async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:i}})=>{i(e,{id:Rt});let a=e.id,s=await Rc(a,t()),o=await n.querySuggest(s);return mt(o)?r(o.error):{id:a,q:s.q,...o.success}})),Ml=e=>{e.configuration.analytics.enabled&&io.addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)})},El=e=>({actionCause:e.actionCause,type:e.actionCause});var Pl=mn("breadcrumb/deselectAll"),_l=mn("breadcrumb/deselectAllNonBreadcrumbs");var $l=mn("facet/updateFacetAutoSelection",(e=>$t(e,{allow:new G({required:!0})})));var Ul=class extends uu{constructor(e){super(e);this.getState=e}get activeInstantResultQuery(){let e=this.getState().instantResults;for(let t in e)for(let r in e[t].cache)if(e[t].cache[r].isActive)return e[t].q;return null}get activeInstantResultCache(){let e=this.getState().instantResults;for(let t in e)for(let r in e[t].cache)if(e[t].cache[r].isActive)return e[t].cache[r];return null}get results(){return this.activeInstantResultCache?.results}get queryText(){return this.activeInstantResultQuery??Ko().q}get responseTime(){return this.activeInstantResultCache?.duration??dt().duration}get numberOfResults(){return this.activeInstantResultCache?.totalCountFiltered??dt().response.totalCountFiltered}getSearchUID(){return this.activeInstantResultCache?.searchUid||super.getSearchUID()}};var Vl=()=>Ou("analytics/instantResult/searchboxAsYouType",(e=>e.makeSearchboxAsYouType()),(e=>new Ul(e))),Ql=()=>({actionCause:"searchboxAsYouType"});var Ll={id:Rt},Bl={...Ll,q:Tt};mn("instantResults/register",(e=>$t(e,Ll)));var Nl=mn("instantResults/updateQuery",(e=>$t(e,Bl)));mn("instantResults/clearExpired",(e=>$t(e,Ll)));var zl=new z({required:!0,min:0}),Hl=mn("pagination/registerNumberOfResults",(e=>$t(e,zl))),Yl=mn("pagination/updateNumberOfResults",(e=>$t(e,zl))),Gl=mn("pagination/registerPage",(e=>$t(e,zl))),Wl=mn("pagination/updatePage",(e=>$t(e,zl))),Jl=mn("pagination/nextPage"),Kl=mn("pagination/previousPage");var Zl=async(e,t)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await no(e.configuration.analytics),actionsHistory:io.getHistory()},...e.advancedSearchQueries?.aq&&{aq:e.advancedSearchQueries.aq},...e.advancedSearchQueries?.cq&&{cq:e.advancedSearchQueries.cq},...e.advancedSearchQueries?.lq&&{lq:e.advancedSearchQueries.lq},...e.advancedSearchQueries?.dq&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await jc(e.configuration.analytics,t),...e.excerptLength&&!N(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});var Xl=async(e,t)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await no(e.configuration.analytics),actionsHistory:io.getHistory()},...e.advancedSearchQueries?.aq&&{aq:e.advancedSearchQueries.aq},...e.advancedSearchQueries?.cq&&{cq:e.advancedSearchQueries.cq},...e.advancedSearchQueries?.lq&&{lq:e.advancedSearchQueries.lq},...e.advancedSearchQueries?.dq&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await jc(e.configuration.analytics,t),...e.excerptLength&&!N(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});var ed=()=>Ou("search/logFetchMoreResults",(e=>e.makeFetchMoreResults())),td=e=>Ou("search/queryError",((t,r)=>t.makeQueryError({query:r.query?.q||Ko().q,aq:r.advancedSearchQueries?.aq||Nc().aq,cq:r.advancedSearchQueries?.cq||Nc().cq,dq:r.advancedSearchQueries?.dq||Nc().dq,errorType:e.type,errorMessage:e.message})));function rd(e,t){let r={};e.forEach((e=>r[e.facetId]=e));let n=[];t.forEach((e=>{e in r&&(n.push(r[e]),delete r[e])}));let i=Object.values(r);return[...n,...i]}var nd=async(e,t)=>{let r=dd(e),n=id(e),i=ad(e),a=e.configuration.analytics.analyticsMode==="legacy"?await Xl(e,t):await Zl(e,t),s=()=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0;return Ac({...a,...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="next",options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="legacy"},...r&&{cq:r},...n.length&&{facets:n},...e.pagination&&{numberOfResults:s(),firstResult:e.pagination.firstResult},...e.facetOptions&&{facetOptions:{freezeFacetOrder:e.facetOptions.freezeFacetOrder}},...e.folding?.enabled&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.automaticFacetSet&&{generateAutomaticFacets:{desiredCount:e.automaticFacetSet.desiredCount,numberOfValues:e.automaticFacetSet.numberOfValues,currentFacets:i}},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})};function id(e){return rd(od(e),e.facetOrder??[])}function ad(e){let t=e.automaticFacetSet?.set;return t?Object.values(t).map((e=>e.response)).map(sd).filter((e=>e.currentValues.length>0)):void 0}function sd(e){let{field:t,label:r,values:n}=e,i=n.filter((e=>e.state==="selected"));return{field:t,label:r,currentValues:i}}function od(e){return ud(e).filter((({facetId:t})=>e.facetOptions?.facets[t]?.enabled??!0))}function ud(e){return[...cd(e.facetSet??{}),...ld(e.numericFacetSet??{}),...ld(e.dateFacetSet??{}),...cl(e.categoryFacetSet??{})]}function cd(e){return cl(e).map((e=>e.sortCriteria==="alphanumericDescending"?{...e,sortCriteria:{type:"alphanumeric",order:"descending"}}:e))}function ld(e){return cl(e).map((e=>{let t=e.currentValues.some((({state:e})=>e!=="idle"));return e.generateAutomaticRanges&&!t?{...e,currentValues:[]}:e}))}function dd(e){let t=e.advancedSearchQueries?.cq.trim()||"",r=Object.values(e.tabSet||{}).find((e=>e.isActive))?.expression.trim()||"",n=fd(e);return[t,r,...n].filter((e=>!!e)).join(" AND ")}function fd(e){return Object.values(e.staticFilterSet||{}).map((e=>{let t=e.values.filter((e=>e.state==="selected"&&!!e.expression.trim())),r=t.map((e=>e.expression)).join(" OR ");return t.length>1?`(${r})`:r}))}var hd=()=>Ou("analytics/didyoumean/automatic",(e=>e.makeDidYouMeanAutomatic())),gd=()=>({actionCause:"didyoumeanAutomatic"});new ee({values:{undoneQuery:Tt},options:{required:!0}});var pd=()=>Ou("analytics/trigger/query",((e,t)=>t.triggers?.queryModification.newQuery?e.makeTriggerQuery():null));var yd=mn("trigger/query/ignore",(e=>$t(e,new Z({emptyAllowed:!0,required:!0})))),vd=mn("trigger/query/modification",(e=>$t(e,new ee({values:{originalQuery:Ft,modification:Ft}}))));var md=class{constructor(e,t=(e=>{this.dispatch(rl({q:e}))})){this.config=e;this.onUpdateQueryForCorrection=t}async fetchFromAPI({mappings:e,request:t},r){let n=(new Date).getTime(),i=xc(await this.extra.apiClient.search(t,r),e),a=(new Date).getTime()-n,s=this.getState().query?.q||"";return{response:i,duration:a,queryExecuted:s,requestExecuted:t}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return mt(e.response)?(this.dispatch(td(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:i}=t.didYouMean,{results:a,queryCorrections:s,queryCorrection:o}=r;if(!n||!i)return null;let u=a.length===0&&s&&s.length!==0,c=!N(o)&&!N(o.correctedQuery);if(!u&&!c)return null;let l=u?await this.processLegacyDidYouMeanAutoCorrection(e):this.processModernDidYouMeanAutoCorrection(e);return this.dispatch(Lc(tl(this.getState()))),l}async processLegacyDidYouMeanAutoCorrection(e){let t=this.getCurrentQuery(),r=this.getSuccessResponse(e);if(!r.queryCorrections)return null;let{correctedQuery:n}=r.queryCorrections[0],i=await this.automaticallyRetryQueryWithCorrection(n);return mt(i.response)?(this.dispatch(td(i.response.error)),this.rejectWithValue(i.response.error)):(this.logOriginalAnalyticsQueryBeforeAutoCorrection(e),this.dispatch(Lc(tl(this.getState()))),{...i,response:{...i.response.success,queryCorrections:r.queryCorrections},automaticallyCorrected:!0,originalQuery:t,analyticsAction:hd()})}processModernDidYouMeanAutoCorrection(e){let t=this.getSuccessResponse(e),{correctedQuery:r,originalQuery:n}=t.queryCorrection;return this.onUpdateQueryForCorrection(r),{...e,response:{...t},queryExecuted:r,automaticallyCorrected:!0,originalQuery:n,analyticsAction:hd()}}logOriginalAnalyticsQueryBeforeAutoCorrection(e){let t=this.getState(),r=this.getSuccessResponse(e);this.analyticsAction&&this.analyticsAction()(this.dispatch,(()=>this.getStateAfterResponse(e.queryExecuted,e.duration,t,r)),this.extra)}async processQueryTriggersOrContinue(e){let t=this.getSuccessResponse(e);if(!t)return null;let r=t.triggers.find((e=>e.type==="query"))?.content||"";if(!r)return null;if(this.getState().triggers?.queryModification.queryToIgnore===r)return this.dispatch(yd("")),null;this.analyticsAction&&await this.dispatch(this.analyticsAction);let n=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(r);return mt(i.response)?(this.dispatch(td(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(Lc(tl(this.getState()))),{...i,response:{...i.response.success},automaticallyCorrected:!1,originalQuery:n,analyticsAction:pd()})}getStateAfterResponse(e,t,r,n){return{...r,query:{q:e,enableQuerySyntax:r.query?.enableQuerySyntax??Ko().enableQuerySyntax},search:{...dt(),duration:t,response:n,results:n.results}}}processSuccessResponse(e){return this.dispatch(Lc(tl(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(e){return vt(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let t=await this.fetchFromAPI(await nd(this.getState()),{origin:"mainSearch"});return this.dispatch(Ec(e)),t}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(vd({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await nd(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){let e=this.getState();return e.query?.q!==void 0?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get analyticsAction(){return this.config.analyticsAction}get rejectWithValue(){return this.config.rejectWithValue}};Qn("search/prepareForSearchWithQuery",((e,t)=>{let{dispatch:r}=t;$t(e,{q:new Z,enableQuerySyntax:new G,clearFilters:new G}),e.clearFilters&&(r(Pl()),r(_l())),r($l({allow:!0})),r(rl({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(Wl(1))}));var wd=Qn("search/executeSearch",(async(e,t)=>{let r=t.getState();return await Fd(r,t,e)})),bd=Qn("search/fetchPage",(async(e,t)=>{let r=t.getState();return await xd(r,t,e)})),Sd=Qn("search/fetchMoreResults",(async(e,t)=>{let r=t.getState();return await jd(t,r)})),Id=Qn("search/fetchFacetValues",(async(e,t)=>{let r=t.getState();return await Rd(t,e,r)}));Qn("search/fetchInstantResults",(async(e,t)=>kd(e,t)));var Od=async(e,t)=>{let r=await nd(e,t);return r.request={...r.request,firstResult:(e.pagination?.firstResult??0)+(e.search?.results.length??0)},r},Ad=async(e,t,r)=>{let n=await Xl(e);return Ac({...n,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},qd=async(e,t)=>{let r=await nd(e,t);return r.request.numberOfResults=0,r},Cd=e=>{e.configuration.analytics.enabled&&io.addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)})};async function kd(e,t){$t(e,{id:Rt,q:Rt,maxResultsPerQuery:new z({required:!0,min:1}),cacheTimeout:new z});let{q:r,maxResultsPerQuery:n}=e,i=t.getState(),a=new md({...t,analyticsAction:Vl()},(r=>{t.dispatch(Nl({q:r,id:e.id}))})),s=await Ad(i,r,n),o=await a.fetchFromAPI(s,{origin:"instantResults",disableAbortWarning:!0}),u=await a.process(o);return"response"in u?{results:u.response.results,searchUid:u.response.searchUid,analyticsAction:u.analyticsAction,totalCountFiltered:u.response.totalCountFiltered,duration:u.duration}:u}async function xd(e,t,r){Cd(e);let{analyticsClientMiddleware:n,preprocessRequest:i,logger:a}=t.extra,{description:s}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:i,logger:a}),o=new md({...t,analyticsAction:r}),u=await nd(e,s),c=await o.fetchFromAPI(u,{origin:"mainSearch"});return await o.process(c)}async function jd(e,t){let{analyticsClientMiddleware:r,preprocessRequest:n,logger:i}=e.extra,{description:a}=await ed().prepare({getState:()=>e.getState(),analyticsClientMiddleware:r,preprocessRequest:n,logger:i}),s=new md({...e,analyticsAction:ed()}),o=await Od(t,a),u=await s.fetchFromAPI(o,{origin:"mainSearch"});return await s.process(u)}async function Rd(e,t,r){let{analyticsClientMiddleware:n,preprocessRequest:i,logger:a}=e.extra,{description:s}=await t.prepare({getState:()=>e.getState(),analyticsClientMiddleware:n,preprocessRequest:i,logger:a}),o=new md({...e,analyticsAction:t}),u=await qd(r,s),c=await o.fetchFromAPI(u,{origin:"facetValues"});return await o.process(c)}async function Fd(e,t,r){Cd(e);let{analyticsClientMiddleware:n,preprocessRequest:i,logger:a}=t.extra,{description:s}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:i,logger:a}),o=await nd(e,s),u=new md({...t,analyticsAction:r}),c=await u.fetchFromAPI(o,{origin:"mainSearch"});return await u.process(c)}var Td=class{constructor(e,t=(e=>{this.dispatch(rl({q:e}))})){this.config=e;this.onUpdateQueryForCorrection=t}async fetchFromAPI({mappings:e,request:t},r){let n=(new Date).getTime(),i=xc(await this.extra.apiClient.search(t,r),e),a=(new Date).getTime()-n,s=this.getState().query?.q||"";return{response:i,duration:a,queryExecuted:s,requestExecuted:t}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return mt(e.response)?(this.dispatch(td(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:i}=t.didYouMean,{results:a,queryCorrections:s,queryCorrection:o}=r;if(!n||!i)return null;let u=a.length===0&&s&&s.length!==0,c=!N(o)&&!N(o.correctedQuery);if(!u&&!c)return null;let l=u?await this.processLegacyDidYouMeanAutoCorrection(e):this.processModernDidYouMeanAutoCorrection(e);return this.dispatch(Lc(tl(this.getState()))),l}async processLegacyDidYouMeanAutoCorrection(e){let t=this.getCurrentQuery(),r=this.getSuccessResponse(e);if(!r.queryCorrections)return null;let{correctedQuery:n}=r.queryCorrections[0],i=await this.automaticallyRetryQueryWithCorrection(n);return mt(i.response)?(this.dispatch(td(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(Lc(tl(this.getState()))),{...i,response:{...i.response.success,queryCorrections:r.queryCorrections},automaticallyCorrected:!0,originalQuery:t})}processModernDidYouMeanAutoCorrection(e){let t=this.getSuccessResponse(e),{correctedQuery:r,originalQuery:n}=t.queryCorrection;return this.onUpdateQueryForCorrection(r),{...e,response:{...t},queryExecuted:r,automaticallyCorrected:!0,originalQuery:n}}async processQueryTriggersOrContinue(e){let t=this.getSuccessResponse(e);if(!t)return null;let r=t.triggers.find((e=>e.type==="query"))?.content||"";if(!r)return null;if(this.getState().triggers?.queryModification.queryToIgnore===r)return this.dispatch(yd("")),null;let n=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(r);return mt(i.response)?(this.dispatch(td(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(Lc(tl(this.getState()))),{...i,response:{...i.response.success},automaticallyCorrected:!1,originalQuery:n})}processSuccessResponse(e){return this.dispatch(Lc(tl(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery()}}getSuccessResponse(e){return vt(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let t=this.getState(),{actionCause:r}=gd(),n=await this.fetchFromAPI(await nd(t,{actionCause:r}),{origin:"mainSearch"});return this.dispatch(Ec(e)),n}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(vd({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await nd(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){let e=this.getState();return e.query?.q!==void 0?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}};var Dd=Qn("search/prepareForSearchWithQuery",((e,t)=>{let{dispatch:r}=t;$t(e,{q:new Z,enableQuerySyntax:new G,clearFilters:new G}),e.clearFilters&&(r(Pl()),r(_l())),r($l({allow:!0})),r(rl({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(Wl(1))})),Md=Qn("search/executeSearch",(async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return Fd(r,t,e.legacy);Qd(r);let n=Ld(e.next),i=await nd(r,n),a=new Td({...t,analyticsAction:n}),s=await a.fetchFromAPI(i,{origin:"mainSearch"});return await a.process(s)})),Ed=Qn("search/fetchPage",(async(e,t)=>{let r=t.getState();if(Qd(r),r.configuration.analytics.analyticsMode==="legacy"||!e.next)return xd(r,t,e.legacy);let n=new Td({...t,analyticsAction:e.next}),i=await nd(r,e.next),a=await n.fetchFromAPI(i,{origin:"mainSearch"});return await n.process(a)})),Pd=Qn("search/fetchMoreResults",(async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return jd(t,r);let n=gu("pagerScrolling",t.getState),i=new Td({...t,analyticsAction:n}),a=await $d(r,n),s=await i.fetchFromAPI(a,{origin:"mainSearch"});return await i.process(s)})),_d=Qn("search/fetchFacetValues",(async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return Fd(r,t,e.legacy);let n=Ld(e.next),i=new Td({...t,analyticsAction:n}),a=await Vd(r,n),s=await i.fetchFromAPI(a,{origin:"facetValues"});return await i.process(s)}));Qn("search/fetchInstantResults",(async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return kd(e,t);$t(e,{id:Rt,q:Rt,maxResultsPerQuery:new z({required:!0,min:1}),cacheTimeout:new z});let{q:n,maxResultsPerQuery:i}=e,a=Ld(Ql()),s=await Ud(r,n,i,a),o=new Td({...t,analyticsAction:a},(r=>{t.dispatch(Nl({q:r,id:e.id}))})),u=await o.fetchFromAPI(s,{origin:"instantResults",disableAbortWarning:!0}),c=await o.process(u);return"response"in c?{results:c.response.results,searchUid:c.response.searchUid,totalCountFiltered:c.response.totalCountFiltered,duration:c.duration}:c}));var $d=async(e,t)=>{let r=await nd(e,t);return r.request={...r.request,firstResult:(e.pagination?.firstResult??0)+(e.search?.results.length??0)},r},Ud=async(e,t,r,n)=>{let i=await Zl(e,n);return Ac({...i,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},Vd=async(e,t)=>{let r=await nd(e,t);return r.request.numberOfResults=0,r},Qd=e=>{e.configuration.analytics.enabled&&io.addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)})},Ld=e=>({actionCause:e.actionCause,type:e.actionCause});async function Bd(e,t){let{search:r,accessToken:n,organizationId:i,analytics:a}=e.configuration,s=e.query?.q||"";return{url:r.apiBaseUrl,accessToken:n,organizationId:i,enableNavigation:!1,...a.enabled&&{visitorId:await no(e.configuration.analytics)},q:s,...t,requestedOutputSize:t.requestedOutputSize||0,...r.authenticationProviders.length&&{authentication:r.authenticationProviders.join(",")}}}var Nd=Qn("resultPreview/fetchResultContent",(async(e,{extra:t,getState:r,rejectWithValue:n})=>{let i=r(),a=await Bd(i,e),s=await t.apiClient.html(a);return mt(s)?n(s.error):{content:s.success,uniqueId:e.uniqueId}})),zd=mn("resultPreview/next"),Hd=mn("resultPreview/previous"),Yd=mn("resultPreview/prepare",(e=>$t(e,{results:new re({required:!0})}))),Gd=2048,Wd=Qn("resultPreview/updateContentURL",(async(e,{getState:t,extra:r})=>{let n=t(),i=ht(await e.buildResultPreviewRequest(n,{uniqueId:e.uniqueId,requestedOutputSize:e.requestedOutputSize}),e.path);return i?.length>Gd&&r.logger.error(`The content URL was truncated as it exceeds the maximum allowed length of ${Gd} characters.`),{contentURL:i}}));function Jd(){return{uniqueId:"",content:"",isLoading:!1,position:-1,resultsWithPreview:[]}}var Kd=e=>{let{content:t,isLoading:r,uniqueId:n,contentURL:i}=Jd();e.content=t,e.isLoading=r,e.uniqueId=n,e.contentURL=i},Zd=e=>e.filter((e=>e.hasHtmlVersion)).map((e=>e.uniqueId)),Xd=Tn(Jd(),(e=>{e.addCase(Nd.pending,(e=>{e.isLoading=!0})).addCase(Nd.fulfilled,((e,t)=>{let{content:r,uniqueId:n}=t.payload;e.position=e.resultsWithPreview.indexOf(n),e.content=r,e.uniqueId=n,e.isLoading=!1})).addCase(Md.fulfilled,((e,t)=>{Kd(e),e.resultsWithPreview=Zd(t.payload.response.results)})).addCase(Pd.fulfilled,((e,t)=>{Kd(e),e.resultsWithPreview=e.resultsWithPreview.concat(Zd(t.payload.response.results))})).addCase(Ed.fulfilled,Kd).addCase(Yd,((e,t)=>{e.resultsWithPreview=Zd(t.payload.results)})).addCase(zd,(e=>{if(e.isLoading)return;let t=e.position+1;t>e.resultsWithPreview.length-1&&(t=0),e.position=t})).addCase(Hd,(e=>{if(e.isLoading)return;let t=e.position-1;t<0&&(t=e.resultsWithPreview.length-1),e.position=t})).addCase(Wd.fulfilled,((e,t)=>{e.contentURL=t.payload.contentURL}))}));var ef=()=>Ft,tf=()=>Rt,rf=mn("configuration/updateBasicConfiguration",(e=>$t(e,{accessToken:Ft,organizationId:Ft,platformUrl:Ft}))),nf=mn("configuration/updateSearchConfiguration",(e=>$t(e,{apiBaseUrl:Ft,pipeline:new Z({required:!1,emptyAllowed:!0}),searchHub:Ft,timezone:Ft,locale:Ft,authenticationProviders:new re({required:!1,each:Rt})}))),af={enabled:new G({default:!0}),originContext:ef(),originLevel2:ef(),originLevel3:ef(),apiBaseUrl:Ft,nextApiBaseUrl:Ft,runtimeEnvironment:new Q,anonymous:new G({default:!1}),deviceId:Ft,userDisplayName:Ft,documentLocation:Ft,trackingId:Ft,analyticsMode:new Z({constrainTo:["legacy","next"],required:!1,default:"legacy"}),source:new ee({options:{required:!1},values:Oi.reduce(((e,t)=>(e[t]=Et,e)),{})})},sf=mn("configuration/updateAnalyticsConfiguration",(e=>(ge()&&(e.enabled=!1),$t(e,af)))),of=mn("configuration/analytics/disable"),uf=mn("configuration/analytics/enable"),cf=mn("configuration/analytics/originlevel2",(e=>$t(e,{originLevel2:tf()}))),lf=mn("configuration/analytics/originlevel3",(e=>$t(e,{originLevel3:tf()})));var df=Tn(ro(),(e=>{e.addCase(zu,((e,t)=>t.payload)).addCase(Bc.fulfilled,((e,t)=>t.payload?.searchHub??e)).addCase(nf,((e,t)=>t.payload.searchHub||e))}));var ff=(e,t)=>{let r=e;return N(r[t])?N(e.raw[t])?null:e.raw[t]:r[t]};function hf(e){return e.search.response.searchUid!==""}function gf(e,t,r){return e.search.results.find((e=>ff(e,t)===r))}function pf(e,t){let r=t.payload??null;r&&(e.response=dt().response,e.results=[],e.questionAnswer=lt()),e.error=r,e.isLoading=!1}function yf(e,t){e.error=null,e.response=t.payload.response,e.queryExecuted=t.payload.queryExecuted,e.duration=t.payload.duration,e.isLoading=!1}function vf(e,t){yf(e,t),e.results=t.payload.response.results,e.searchResponseId=t.payload.response.searchUid,e.questionAnswer=t.payload.response.questionAnswer,e.extendedResults=t.payload.response.extendedResults}function mf(e,t){e.isLoading=!0,e.requestId=t.meta.requestId}var wf=Tn(dt(),(e=>{e.addCase(wd.rejected,((e,t)=>pf(e,t))),e.addCase(Sd.rejected,((e,t)=>pf(e,t))),e.addCase(bd.rejected,((e,t)=>pf(e,t))),e.addCase(wd.fulfilled,((e,t)=>{vf(e,t)})),e.addCase(Sd.fulfilled,((e,t)=>{yf(e,t),e.results=[...e.results,...t.payload.response.results]})),e.addCase(bd.fulfilled,((e,t)=>{yf(e,t),e.results=t.payload.response.results})),e.addCase(Id.fulfilled,((e,t)=>{e.response.facets=t.payload.response.facets,e.response.searchUid=t.payload.response.searchUid})),e.addCase(wd.pending,mf),e.addCase(Sd.pending,mf),e.addCase(bd.pending,mf)}));var bf=Tn(Ii,(e=>e));function Sf(){return typeof window<"u"&&typeof document<"u"}function If(e){let t=e.payload?.analyticsAction;return Of(e)&&!N(t)}function Of(e){return"type"in e}var Af=e=>t=>r=>{let n;If(r)&&(n=r.payload.analyticsAction,delete r.payload.analyticsAction);let i=t(r);return Of(r)&&(r.type==="search/executeSearch/fullfilled"&&n===void 0&&console.error("No analytics action associated with search:",r),r.type==="recommendation/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with recommendation:",r),r.type==="productRecommendations/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with product recommendation:",r)),n!==void 0&&e.dispatch(n),i};var qf=d(R());var Cf={q:new Z,enableQuerySyntax:new G,aq:new Z,cq:new Z,firstResult:new z({min:0}),numberOfResults:new z({min:0}),sortCriteria:new Z,f:new ee,fExcluded:new ee,cf:new ee,nf:new ee,df:new ee,debug:new G,sf:new ee,tab:new Z,af:new ee};var kf=mn("searchParameters/restore",(e=>$t(e,Cf)));var xf=mn("tab/register",(e=>{let t=new ee({values:{id:Rt,expression:Tt}});return $t(e,t)})),jf=mn("tab/updateActiveTab",(e=>$t(e,Rt)));var Rf=d(k()),Ff=d(F()),Tf=d(T());Rf.default.extend(Tf.default);Rf.default.extend(Ff.default);var Df="/rest/search/v2",Mf="/rest/ua",Ef=()=>({organizationId:"",accessToken:"",platformUrl:st(),search:{apiBaseUrl:`${st()}${Df}`,locale:"en-US",timezone:Rf.default.tz.guess(),authenticationProviders:[]},analytics:{enabled:!0,apiBaseUrl:`${ot()}${Mf}`,nextApiBaseUrl:"",originContext:"Search",originLevel2:"default",originLevel3:"default",anonymous:!1,deviceId:"",userDisplayName:"",documentLocation:"",trackingId:"",analyticsMode:"legacy",source:{}}});function Pf(e,t){if(Pe(e))return e.replace(/^(https:\/\/)platform/,"$1analytics")+Mf;let r=_e(e,t);return r?at(t,r.environment).analytics:e}var _f=Tn(Ef(),(e=>e.addCase(rf,((e,t)=>{t.payload.accessToken&&(e.accessToken=t.payload.accessToken),t.payload.organizationId&&(e.organizationId=t.payload.organizationId),t.payload.platformUrl&&(e.platformUrl=t.payload.platformUrl,e.search.apiBaseUrl=`${t.payload.platformUrl}${Df}`,e.analytics.apiBaseUrl=Pf(t.payload.platformUrl,e.organizationId))})).addCase(nf,((e,t)=>{t.payload.apiBaseUrl&&(e.search.apiBaseUrl=t.payload.apiBaseUrl),t.payload.locale&&(e.search.locale=t.payload.locale),t.payload.timezone&&(e.search.timezone=t.payload.timezone),t.payload.authenticationProviders&&(e.search.authenticationProviders=t.payload.authenticationProviders)})).addCase(sf,((e,t)=>{N(t.payload.enabled)||(e.analytics.enabled=t.payload.enabled),N(t.payload.originContext)||(e.analytics.originContext=t.payload.originContext),N(t.payload.originLevel2)||(e.analytics.originLevel2=t.payload.originLevel2),N(t.payload.originLevel3)||(e.analytics.originLevel3=t.payload.originLevel3),N(t.payload.apiBaseUrl)||(e.analytics.apiBaseUrl=t.payload.apiBaseUrl),N(t.payload.nextApiBaseUrl)||(e.analytics.nextApiBaseUrl=t.payload.nextApiBaseUrl),N(t.payload.trackingId)||(e.analytics.trackingId=t.payload.trackingId),N(t.payload.analyticsMode)||(e.analytics.analyticsMode=t.payload.analyticsMode),N(t.payload.source)||(e.analytics.source=t.payload.source);let r=(0,qf.default)();r&&(e.analytics.analyticsMode="next",e.analytics.trackingId=r),N(t.payload.runtimeEnvironment)||(e.analytics.runtimeEnvironment=t.payload.runtimeEnvironment),N(t.payload.anonymous)||(e.analytics.anonymous=t.payload.anonymous),N(t.payload.deviceId)||(e.analytics.deviceId=t.payload.deviceId),N(t.payload.userDisplayName)||(e.analytics.userDisplayName=t.payload.userDisplayName),N(t.payload.documentLocation)||(e.analytics.documentLocation=t.payload.documentLocation)})).addCase(of,(e=>{e.analytics.enabled=!1})).addCase(uf,(e=>{e.analytics.enabled=!0})).addCase(cf,((e,t)=>{e.analytics.originLevel2=t.payload.originLevel2})).addCase(lf,((e,t)=>{e.analytics.originLevel3=t.payload.originLevel3})).addCase(jf,((e,t)=>{e.analytics.originLevel2=t.payload})).addCase(kf,((e,t)=>{e.analytics.originLevel2=t.payload.tab||e.analytics.originLevel2}))));var $f=_f;function Uf(e){return e.instantlyCallable}var Vf=()=>e=>t=>e(Uf(t)?t():t);var Qf=e=>()=>t=>r=>{let n=r;if(!n.error)return t(r);let i=n.error;if(n.payload?.ignored||e.error(i.stack||i.message||i.name||"Error",`Action dispatch error ${n.type}`,r),n.error.name!=="SchemaValidationError")return t(r)},Lf=e=>t=>r=>n=>(e.debug({action:n,nextState:t.getState()},`Action dispatched: ${n.type}`),r(n));var Bf=()=>({referrer:document.referrer,userAgent:navigator.userAgent,location:window.location.href}),Nf=()=>({referrer:"default",userAgent:"Node.js",location:"default"});function zf(e,t){let r={...e},n,i=e=>(t,r)=>{let i=e(t,r);return n?n(i,r):i};return{get combinedReducer(){let e=pe(Object.entries(t).filter((([e])=>!(e in r))).map((([e,t])=>[e,()=>t])));return i(Kt({...e,...r}))},containsAll(e){return Object.keys(e).every((e=>e in r))},add(e){Object.keys(e).filter((e=>!(e in r))).forEach((t=>r[t]=e[t]))},addCrossReducer(e){n=e}}}function Hf(e,t,r){var n,i,a;t===void 0&&(t=50),r===void 0&&(r={});var s=(n=r.isImmediate)!=null&&n,o=(i=r.callback)!=null&&i,u=r.maxWait,c=Date.now(),l=[];function d(){if(u!==void 0){var e=Date.now()-c;if(e+t>=u)return u-e}return t}var f=function(){var t=[].slice.call(arguments),r=this;return new Promise((function(n,i){var u=s&&a===void 0;if(a!==void 0&&clearTimeout(a),a=setTimeout((function(){if(a=void 0,c=Date.now(),!s){var n=e.apply(r,t);o&&o(n),l.forEach((function(e){return(0,e.resolve)(n)})),l=[]}}),d()),u){var f=e.apply(r,t);return o&&o(f),n(f)}l.push({resolve:n,reject:i})}))};return f.cancel=function(e){a!==void 0&&clearTimeout(a),l.forEach((function(t){return(0,t.reject)(e)})),l=[]},f}function Yf(e,t){let r=0,n=Hf((()=>r=0),500);return i=>a=>async s=>{if(!(typeof s=="function"))return a(s);let o=await a(s);if(!Gf(o))return o;if(typeof t!="function")return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),o;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),o;r++,n();let u=await Wf(t);i.dispatch(rf({accessToken:u})),i.dispatch(s)}}function Gf(e){return e?.error?.name===(new Ke).name}async function Wf(e){try{return await e()}catch{return""}}function Jf({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:n,name:i}){return jn({reducer:e,preloadedState:t,devTools:{stateSanitizer:e=>e.history?{...e,history:"<<OMIT>>"}:e,name:i,shouldHotReload:!1},middleware:e=>e({thunk:{extraArgument:n}}).prepend(...r).concat(Lf(n.logger))})}var Kf={configuration:$f,version:bf};function Zf(e,t){let r=e.organizationEndpoints?.analytics||void 0,{analyticsClientMiddleware:n,...i}=e.analytics??{},a={...i,nextApiBaseUrl:`${r}/rest/organizations/${e.organizationId}/events/v1`,apiBaseUrl:r};if(ge())return t.info("Analytics disabled since doNotTrack is active."),{...a,enabled:!1};if(a.analyticsMode==="next"&&!i.trackingId)throw new sh('analytics.trackingId is required when analytics.analyticsMode="next"');return a}function Xf(e,t){let r=eh(e,t),{accessToken:n,organizationId:i}=e.configuration,{organizationEndpoints:a}=e.configuration,s=a?.platform||e.configuration.platformUrl;ih(e.configuration)&&r.logger.warn(`The \`platformUrl\` (${e.configuration.platformUrl}) option will be deprecated in the next major version. Consider using the \`organizationEndpoints\` option instead. See [Organization endpoints](https://docs.coveo.com/en/mcc80216).`),nh(e.configuration)?r.logger.warn("The `organizationEndpoints` options was not explicitly set in the Headless engine configuration. Coveo recommends setting this option, as it has resiliency benefits and simplifies the overall configuration for multi-region deployments. See [Organization endpoints](https://docs.coveo.com/en/mcc80216)."):ah(e.configuration)&&r.logger.warn(`There is a mismatch between the \`organizationId\` option (${e.configuration.organizationId}) and the organization configured in the \`organizationEndpoints\` option (${e.configuration.organizationEndpoints?.platform}). This could lead to issues that are complex to troubleshoot. Please make sure both values match.`),r.dispatch(rf({accessToken:n,organizationId:i,platformUrl:s}));let o=Zf(e.configuration,r.logger);return o&&r.dispatch(sf(o)),r}function eh(e,t){let{reducers:r}=e,n=zf({...Kf,...r},e.preloadedState??{});e.crossReducer&&n.addCrossReducer(e.crossReducer);let i=t.logger,a=e.navigatorContextProvider??Sf()?Bf:Nf,s={...t,get relay(){return qi(u.state)},get navigatorContext(){return a()}},o=th(e,s,n),u={addReducers(e){n.containsAll(e)||(n.add(e),o.replaceReducer(n.combinedReducer))},dispatch:o.dispatch,subscribe:o.subscribe,enableAnalytics(){o.dispatch(uf())},disableAnalytics(){o.dispatch(of())},get state(){return o.getState()},get relay(){return qi(this.state)},get navigatorContext(){return a()},logger:i,store:o};return u}function th(e,t,r){let{preloadedState:n,configuration:i}=e,a=i.name||"coveo-headless",s=rh(e,t.logger);return Jf({preloadedState:n,reducer:r.combinedReducer,middlewares:s,thunkExtraArguments:t,name:a})}function rh(e,t){let{renewAccessToken:r}=e.configuration,n=Yf(t,r);return[Vf,n,Qf(t),Af].concat(e.middlewares||[])}function nh(e){return L(e.organizationEndpoints)}function ih(e){return!N(e.platformUrl)||N(e.organizationEndpoints?.platform)}function ah(e){let{platform:t}=e.organizationEndpoints;if(L(t))return!1;let r=$e(t);return r&&r.organizationId!==e.organizationId}var sh=class extends Error{constructor(e){super(e),this.name="InvalidEngineConfiguration"}};var oh=d(M());function uh(e){return(0,oh.default)({name:"@coveo/headless",level:e?.level||"warn",formatters:{log:e?.logFormatter}})}function ch(e,t){let r=lh(e),n=_t,i=dh(e);return{analyticsClientMiddleware:r,validatePayload:n,preprocessRequest:i,logger:t}}function lh(e){let{analytics:t}=e,r=(e,t)=>t;return t?.analyticsClientMiddleware||r}function dh(e){return e.preprocessRequest||Ge}var fh={organizationId:Rt,accessToken:Rt,platformUrl:new Z({required:!1,emptyAllowed:!1}),name:new Z({required:!1,emptyAllowed:!1}),analytics:new ee({options:{required:!1},values:{enabled:new G({required:!1}),originContext:new Z({required:!1}),originLevel2:new Z({required:!1}),originLevel3:new Z({required:!1}),analyticsMode:new Z({constrainTo:["legacy","next"],required:!1})}})};var hh=new V({...fh,insightId:Rt});var gh={insightConfiguration:Nu,search:wf,insightInterface:Wu,searchHub:df,resultPreview:Xd};function ph(e){let t=uh(e.loggerOptions);yh(e.configuration,t);let r=vh(e.configuration,t),n=mh(t),i={...ch(e.configuration,t),apiClient:r,streamingClient:n},a={...e,reducers:gh},s=Xf(a,i),{insightId:o}=e.configuration;return s.dispatch(Lu({insightId:o})),{...s,get state(){return s.state},executeFirstSearch(e=ol()){hf(s.state)||s.dispatch(jl({legacy:e,next:Vu()}))}}}function yh(e,t){try{hh.validate(e)}catch(e){throw t.error(e,"Insight engine configuration error"),e}}function vh(e,t){return new jt({logger:t,preprocessRequest:e.preprocessRequest||Ge})}function mh(e){return new Ye({logger:e})}var wh={id:Rt},bh=mn("querySuggest/register",(e=>$t(e,{...wh,count:new z({min:0})}))),Sh=mn("querySuggest/unregister",(e=>$t(e,wh))),Ih=mn("querySuggest/selectSuggestion",(e=>$t(e,{...wh,expression:Tt}))),Oh=mn("querySuggest/clear",(e=>$t(e,wh))),Ah=Qn("querySuggest/fetch",(async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:i}})=>{i(e,wh);let a=e.id,s=await qh(a,t()),o=await n.querySuggest(s);return mt(o)?r(o.error):{id:a,q:s.q,...o.success}})),qh=async(e,t)=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl,count:t.querySuggest[e].count,q:t.querySet[e],locale:t.configuration.search.locale,timezone:t.configuration.search.timezone,actionsHistory:t.configuration.analytics.enabled?io.getHistory():[],...t.context&&{context:t.context.contextValues},...t.pipeline&&{pipeline:t.pipeline},...t.searchHub&&{searchHub:t.searchHub},tab:t.configuration.analytics.originLevel2,...t.configuration.analytics.enabled&&{visitorId:await no(t.configuration.analytics),...t.configuration.analytics.enabled&&await jc(t.configuration.analytics)},...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")}});function Ch(e){return e.addReducers({search:wf}),{executeSearch:Al,fetchFacetValues:kl,fetchMoreResults:Cl,fetchPage:ql,fetchQuerySuggestions:Dl,registerQuerySuggest:bh}}var kh={q:new Z},xh={};var jh=mn("commerce/searchParameters/restore",(e=>$t(e,kh)));mn("commerce/productListingParameters/restore",(e=>$t(e,xh)));var Rh={id:Rt,query:Tt},Fh=mn("querySet/register",(e=>$t(e,Rh))),Th=mn("querySet/update",(e=>$t(e,Rh)));var Dh=Tn(Zc(),(e=>{e.addCase(Fh,((e,t)=>{let{id:r,query:n}=t.payload;r in e||(e[r]=n)})).addCase(Th,((e,t)=>{let{id:r,query:n}=t.payload;Ph(e,r,n)})).addCase(Ih,((e,t)=>{let{id:r,expression:n}=t.payload;Ph(e,r,n)})).addCase(Md.fulfilled,((e,t)=>{let{queryExecuted:r}=t.payload;Eh(e,r)})).addCase(kf,Mh).addCase(jh,Mh).addCase(Bc.fulfilled,((e,t)=>{if(t.payload)for(let[r,n]of Object.entries(t.payload.querySet))Ph(e,r,n)}))}));function Mh(e,t){N(t.payload.q)||Eh(e,t.payload.q)}function Eh(e,t){Object.keys(e).forEach((r=>e[r]=t))}var Ph=(e,t,r)=>{t in e&&(e[t]=r)};var _h=Rt;var $h={categoryFacetId:_h,categoryFacetPath:new re({required:!0,each:Rt})},Uh=(e,{categoryFacetId:t,categoryFacetPath:r})=>{let n=e.categoryFacetSet[t]?.request.field,i=`${n}_${t}`;return{categoryFacetId:t,categoryFacetPath:r,categoryFacetField:n,categoryFacetTitle:i}},Vh=e=>Au("breadcrumbFacet")("analytics/categoryFacet/breadcrumb",((t,r)=>{$t(e,$h);let n={...Uh(r,e),...il(r.insightCaseContext)};return t.logBreadcrumbFacet(n)}));var Qh=e=>Au("showMoreFacetResults")("analytics/facet/showMore",((t,r)=>{$t(e,_h);let n={...Do(e,Eo(r)),...il(r.insightCaseContext)};return t.logFacetShowMore(n)})),Lh=e=>Au("showLessFacetResults")("analytics/facet/showLess",((t,r)=>{$t(e,_h);let n={...Do(e,Eo(r)),...il(r.insightCaseContext)};return t.logFacetShowLess(n)})),Bh=e=>Au("facetUpdateSort")("analytics/facet/sortChange",((t,r)=>{$t(e,{facetId:_h,sortCriterion:new Q({required:!0})});let{facetId:n,sortCriterion:i}=e,a=Eo(r),s={...Do(n,a),criteria:i,...il(r.insightCaseContext)};return t.logFacetUpdateSort(s)})),Nh=e=>Au("facetClearAll")("analytics/facet/reset",((t,r)=>{$t(e,_h);let n=Eo(r),i={...Do(e,n),...il(r.insightCaseContext)};return t.logFacetClearAll(i)})),zh=e=>Au("facetSelect")("analytics/facet/select",((t,r)=>{$t(e,{facetId:_h,facetValue:Rt});let n=Eo(r),i={...Mo(e,n),...il(r.insightCaseContext)};return t.logFacetSelect(i)})),Hh=e=>Au("facetDeselect")("analytics/facet/deselect",((t,r)=>{$t(e,{facetId:_h,facetValue:Rt});let n=Eo(r),i={...Mo(e,n),...il(r.insightCaseContext)};return t.logFacetDeselect(i)})),Yh=e=>Au("breadcrumbFacet")("analytics/facet/breadcrumb",((t,r)=>{$t(e,{facetId:_h,facetValue:Rt});let n={...Mo(e,Eo(r)),...il(r.insightCaseContext)};return t.logBreadcrumbFacet(n)}));var Gh=()=>Au("breadcrumbResetAll")("analytics/facet/deselectAllBreadcrumbs",((e,t)=>e.logBreadcrumbResetAll(il(t.insightCaseContext))));var Wh=(e,{facetId:t,selection:r})=>{let n=(e.dateFacetSet[t]||e.numericFacetSet[t]).request.field,i=`${n}_${t}`;return{facetId:t,facetField:n,facetTitle:i,facetRangeEndInclusive:r.endInclusive,facetRangeEnd:`${r.end}`,facetRangeStart:`${r.start}`}},Jh=()=>({actionCause:"breadcrumbFacet"});var Kh={state:Rt,start:new z({required:!0}),end:new z({required:!0}),endInclusive:new G({required:!0}),numberOfResults:new z({required:!0,min:0})},Zh={start:Rt,end:Rt,endInclusive:new G({required:!0}),state:Rt,numberOfResults:new z({required:!0,min:0})},Xh=e=>({facetId:_h,selection:typeof e.start=="string"?new ee({values:Zh}):new ee({values:Kh})});var eg=e=>Au("breadcrumbFacet")("analytics/dateFacet/breadcrumb",((t,r)=>{$t(e,Xh(e.selection));let n={...Wh(r,e),...il(r.insightCaseContext)};return t.logBreadcrumbFacet(n)}));var tg=(e,{facetId:t,selection:r})=>{let n=(e.dateFacetSet[t]||e.numericFacetSet[t]).request.field,i=`${n}_${t}`;return{facetId:t,facetField:n,facetTitle:i,facetRangeEndInclusive:r.endInclusive,facetRangeEnd:`${r.end}`,facetRangeStart:`${r.start}`}};var rg=e=>Au("breadcrumbFacet")("analytics/numericFacet/breadcrumb",((t,r)=>{$t(e,Xh(e.selection));let n={...tg(r,e),...il(r.insightCaseContext)};return t.logBreadcrumbFacet(n)}));var ng={value:Rt,numberOfResults:new z({min:0}),state:Rt};var ig=new z({min:1,default:8,required:!1}),ag=new z({min:1,max:20,default:5,required:!1}),sg={desiredCount:ag,numberOfValues:ig};mn("automaticFacet/setOptions",(e=>$t(e,sg)));mn("automaticFacet/deselectAll",(e=>$t(e,_h)));var og=Rt,ug=mn("automaticFacet/toggleSelectValue",(e=>$t(e,{field:og,selection:new ee({values:ng})})));var cg={state:new Q({required:!0}),numberOfResults:new z({required:!0,min:0}),value:new Z({required:!0,emptyAllowed:!0}),path:new re({required:!0,each:Rt}),moreValuesAvailable:new G({required:!1})};function lg(e){e.children.forEach((e=>{lg(e)})),_t({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},cg)}var dg={facetId:_h,field:Rt,delimitingCharacter:new Z({required:!1,emptyAllowed:!0}),filterFacetCount:new G({required:!1}),injectionDepth:new z({required:!1,min:0}),numberOfValues:new z({required:!1,min:1}),sortCriteria:new Q({required:!1}),basePath:new re({required:!1,each:Rt}),filterByBasePath:new G({required:!1})};var fg=mn("categoryFacet/register",(e=>$t(e,dg))),hg=mn("categoryFacet/toggleSelectValue",(e=>{try{return _t(e.facetId,Rt),lg(e.selection),{payload:e,error:null}}catch(t){return{payload:e,error:Pt(t)}}})),gg=mn("categoryFacet/deselectAll",(e=>$t(e,dg.facetId))),pg=mn("categoryFacet/updateNumberOfValues",(e=>$t(e,{facetId:dg.facetId,numberOfValues:dg.numberOfValues}))),yg=mn("categoryFacet/updateSortCriterion",(e=>$t(e,{facetId:dg.facetId,criterion:new Q}))),vg=mn("categoryFacet/updateBasePath",(e=>$t(e,{facetId:dg.facetId,basePath:new re({each:Rt})})));var mg={facetId:_h,captions:new ee({options:{required:!1}}),numberOfValues:new z({required:!1,min:1}),query:new Z({required:!1,emptyAllowed:!0})};var wg={path:new re({required:!0,each:Rt}),displayValue:Tt,rawValue:Tt,count:new z({required:!0,min:0})},bg=mn("categoryFacet/selectSearchResult",(e=>$t(e,{facetId:_h,value:new ee({values:wg})}))),Sg=mn("categoryFacetSearch/register",(e=>$t(e,mg)));var Ig={facetId:_h,value:new ee({values:{displayValue:Tt,rawValue:Tt,count:new z({required:!0,min:0})}})},Og=mn("facetSearch/register",(e=>$t(e,mg))),Ag=mn("facetSearch/update",(e=>$t(e,mg))),qg=mn("facetSearch/toggleSelectValue",(e=>$t(e,Ig))),Cg=mn("facetSearch/toggleExcludeValue",(e=>$t(e,Ig)));function kg(e){let t=xg(e.start,e),r=xg(e.end,e),n=e.endInclusive??!1,i=e.state??"idle";return{start:t,end:r,endInclusive:n,state:i}}function xg(e,t){let{dateFormat:r}=t;return pc(e)?(cc(e),lc(e)):typeof e=="string"&&gc(e)?(cc(e),e):(ic(e,r),nc(rc(e,r)))}var jg=new Z({regex:/^[a-zA-Z0-9-_]+$/}),Rg=new Z({required:!0}),Fg=new re({each:new Z}),Tg=new Z,Dg=new G,Mg=new G,Eg=new z({min:0}),Pg=new z({min:1}),_g=new G({required:!0}),$g=new ee,Ug=new Z,Vg={captions:$g,numberOfValues:Pg,query:Ug},Qg=new ee({values:Vg}),Lg=new ee({options:{required:!1},values:{type:new Z({constrainTo:["simple"],emptyAllowed:!1,required:!0}),values:new re({required:!0,max:25,each:new Z({emptyAllowed:!1,required:!0})})}});new G;var Bg=new re({min:1,max:25,required:!1,each:new Z({emptyAllowed:!1,required:!0})});var Ng={facetId:_h,field:new Z({required:!0,emptyAllowed:!0}),filterFacetCount:new G({required:!1}),injectionDepth:new z({required:!1,min:0}),numberOfValues:new z({required:!1,min:1}),sortCriteria:new Q({required:!1}),resultsMustMatch:new Q({required:!1}),allowedValues:Lg,customSort:Bg},zg=mn("facet/register",(e=>$t(e,Ng))),Hg=mn("facet/toggleSelectValue",(e=>$t(e,{facetId:_h,selection:new ee({values:ng})}))),Yg=mn("facet/toggleExcludeValue",(e=>$t(e,{facetId:_h,selection:new ee({values:ng})}))),Gg=mn("facet/deselectAll",(e=>$t(e,_h))),Wg=mn("facet/updateSortCriterion",(e=>$t(e,{facetId:_h,criterion:new Q({required:!0})}))),Jg=mn("facet/updateNumberOfValues",(e=>$t(e,{facetId:_h,numberOfValues:new z({required:!0,min:1})}))),Kg=mn("facet/updateIsFieldExpanded",(e=>$t(e,{facetId:_h,isFieldExpanded:new G({required:!0})}))),Zg=mn("facet/updateFreezeCurrentValues",(e=>$t(e,{facetId:_h,freezeCurrentValues:new G({required:!0})})));var Xg=mn("rangeFacet/updateSortCriterion",(e=>$t(e,{facetId:_h,criterion:new Q({required:!0})})));var ep={start:Rt,end:Rt,endInclusive:new G({required:!0}),state:Rt},tp={facetId:_h,field:Rt,currentValues:new re({required:!1,each:new ee({values:ep})}),generateAutomaticRanges:new G({required:!0}),filterFacetCount:new G({required:!1}),injectionDepth:new z({required:!1,min:0}),numberOfValues:new z({required:!1,min:1}),sortCriteria:new Q({required:!1}),rangeAlgorithm:new Q({required:!1})};function rp(e){return gc(e)?fc(e):e}function np(e){e.currentValues&&e.currentValues.forEach((e=>{let{start:t,end:r}=kg(e);if(rc(rp(t)).isAfter(rc(rp(r))))throw new Error(`The start value is greater than the end value for the date range ${e.start} to ${e.end}`)}))}var ip=mn("dateFacet/register",(e=>{try{return _t(e,tp),np(e),{payload:e,error:null}}catch(t){return{payload:e,error:Pt(t)}}})),ap=mn("dateFacet/toggleSelectValue",(e=>$t(e,{facetId:_h,selection:new ee({values:Zh})}))),sp=mn("dateFacet/toggleExcludeValue",(e=>$t(e,{facetId:_h,selection:new ee({values:Zh})}))),op=mn("dateFacet/updateFacetValues",(e=>{try{return _t(e,{facetId:_h,values:new re({each:new ee({values:Zh})})}),np({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:Pt(t)}}})),up=Xg,cp=Gg;var lp={state:Rt,start:new z({required:!0}),end:new z({required:!0}),endInclusive:new G({required:!0})},dp={facetId:_h,field:Rt,currentValues:new re({required:!1,each:new ee({values:lp})}),generateAutomaticRanges:new G({required:!0}),filterFacetCount:new G({required:!1}),injectionDepth:new z({required:!1,min:0}),numberOfValues:new z({required:!1,min:1}),sortCriteria:new Q({required:!1}),rangeAlgorithm:new Q({required:!1})};function fp(e){e.currentValues&&e.currentValues.forEach((({start:e,end:t})=>{if(e>t)throw new Error(`The start value is greater than the end value for the numeric range ${e} to ${t}`)}))}var hp=mn("numericFacet/register",(e=>{try{return $t(e,dp),fp(e),{payload:e,error:null}}catch(t){return{payload:e,error:Pt(t)}}})),gp=mn("numericFacet/toggleSelectValue",(e=>$t(e,{facetId:_h,selection:new ee({values:Kh})}))),pp=mn("numericFacet/toggleExcludeValue",(e=>$t(e,{facetId:_h,selection:new ee({values:Kh})}))),yp=mn("numericFacet/updateFacetValues",(e=>{try{return _t(e,{facetId:_h,values:new re({each:new ee({values:Kh})})}),fp({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:Pt(t)}}})),vp=Xg,mp=Gg;var wp=e=>e.error!==void 0;var bp=(e=>(e.Relevance="relevance",e.Fields="fields",e))(bp||{}),Sp=(e=>(e.Ascending="asc",e.Descending="desc",e))(Sp||{});new ee({options:{required:!1},values:{by:new ie({enum:bp,required:!0}),fields:new re({each:new ee({values:{name:new Z,direction:new ie({enum:Sp})}})})}});var Ip=()=>qu("analytics/productListing/load",(e=>e.makeInterfaceLoad()),(e=>new eu(e)));mn("productlisting/setUrl",(e=>$t(e,{url:new Z({required:!0,url:!0})})));mn("productlisting/setAdditionalFields",(e=>$t(e,{additionalFields:new re({required:!0,each:new Z({required:!0,emptyAllowed:!1})})})));var Op=Qn("productlisting/fetch",(async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:i})=>{let a=t(),{apiClient:s}=i,o=await s.getProducts(await Ap(a));return wp(o)?(r(td(o.error)),n(o.error)):{response:o.success,analyticsAction:Ip()}})),Ap=async e=>{let t=Cp(e),r=await no(e.configuration.analytics);return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,platformUrl:e.configuration.platformUrl,url:e.productListing?.url,...e.configuration.analytics.enabled&&r?{clientId:r}:{},...e.productListing.additionalFields?.length?{additionalFields:e.productListing.additionalFields}:{},...e.productListing.advancedParameters&&qp(e.productListing.advancedParameters)?{advancedParameters:e.productListing.advancedParameters||{}}:{},...t.length&&{facets:{requests:t}},...e.pagination&&{pagination:{numberOfValues:e.pagination.numberOfResults,page:Math.ceil(e.pagination.firstResult/(e.pagination.numberOfResults||1))+1}},...(e.sort?.by||"relevance")!=="relevance"&&{sort:e.sort},...e.context&&{userContext:e.context.contextValues}}};function qp(e){return e.debug}function Cp(e){return rd(kp(e),e.facetOrder??[])}function kp(e){return[...cl(e.facetSet??{}),...cl(e.numericFacetSet??{}),...cl(e.dateFacetSet??{}),...cl(e.categoryFacetSet??{})]}var xp=Tn(Kc(),(e=>{e.addCase(Hl,((e,t)=>{let r=Rp(e),n=t.payload;e.defaultNumberOfResults=e.numberOfResults=n,e.firstResult=Tp(r,n)})).addCase(Yl,((e,t)=>{e.numberOfResults=t.payload,e.firstResult=0})).addCase(jf,(e=>{e.firstResult=0})).addCase(Gl,((e,t)=>{let r=t.payload;e.firstResult=Tp(r,e.numberOfResults)})).addCase(Wl,((e,t)=>{let r=t.payload;e.firstResult=Tp(r,e.numberOfResults)})).addCase(Kl,(e=>{let t=Rp(e),r=Math.max(t-1,1);e.firstResult=Tp(r,e.numberOfResults)})).addCase(Jl,(e=>{let t=Rp(e),r=Fp(e),n=Math.min(t+1,r);e.firstResult=Tp(n,e.numberOfResults)})).addCase(Bc.fulfilled,((e,t)=>{t.payload&&(e.numberOfResults=t.payload.pagination.numberOfResults,e.firstResult=t.payload.pagination.firstResult)})).addCase(kf,((e,t)=>{e.firstResult=t.payload.firstResult??e.firstResult,e.numberOfResults=t.payload.numberOfResults??e.defaultNumberOfResults})).addCase(Md.fulfilled,((e,t)=>{let{response:r}=t.payload;e.totalCountFiltered=r.totalCountFiltered})).addCase(Op.fulfilled,((e,t)=>{let{response:r}=t.payload;e.totalCountFiltered=r.pagination.totalCount})).addCase(Gg,(e=>{jp(e)})).addCase(sp,(e=>{jp(e)})).addCase(Yg,(e=>{jp(e)})).addCase(pp,(e=>{jp(e)})).addCase(Cg,(e=>{jp(e)})).addCase(Hg,(e=>{jp(e)})).addCase(gg,(e=>{jp(e)})).addCase(hg,(e=>{jp(e)})).addCase(bg,(e=>{jp(e)})).addCase(ap,(e=>{jp(e)})).addCase(gp,(e=>{jp(e)})).addCase(Pl,(e=>{jp(e)})).addCase(op,(e=>{jp(e)})).addCase(yp,(e=>{jp(e)})).addCase(qg,(e=>{jp(e)})).addCase(ug,(e=>{jp(e)}))}));function jp(e){e.firstResult=Kc().firstResult}function Rp(e){let{firstResult:t,numberOfResults:r}=e;return Dp(t,r)}function Fp(e){let{totalCountFiltered:t,numberOfResults:r}=e;return Mp(t,r)}function Tp(e,t){return(e-1)*t}function Dp(e,t){return Math.round(e/t)+1}function Mp(e,t){let r=Math.min(e,5e3);return Math.ceil(r/t)}function Ep(e){return e.pagination.firstResult}function Pp(e){return e.pagination.numberOfResults}function _p(e){return e.pagination.totalCountFiltered}var $p=e=>{let t=Ep(e),r=Pp(e);return Dp(t,r)},Up=e=>{let t=_p(e),r=Pp(e);return Mp(t,r)},Vp=(e,t)=>{let r=$p(e),n=Up(e),i=Qp(r,t);return i=Lp(i),i=Bp(i,n),Np(i)};function Qp(e,t){let r=t%2===0,n=Math.floor(t/2),i=r?n-1:n,a=e-n,s=e+i;return{start:a,end:s}}function Lp(e){let t=Math.max(1-e.start,0),r=e.start+t,n=e.end+t;return{start:r,end:n}}function Bp(e,t){let r=Math.max(e.end-t,0),n=Math.max(e.start-r,1),i=e.end-r;return{start:n,end:i}}function Np(e){let t=[];for(let r=e.start;r<=e.end;++r)t.push(r);return t}var zp=()=>Au("pagerNumber")("analytics/pager/number",((e,t)=>e.logPagerNumber({pagerNumber:$p(t),...il(t.insightCaseContext)}))),Hp=()=>Au("pagerNext")("analytics/pager/next",((e,t)=>e.logPagerNext({pagerNumber:$p(t),...il(t.insightCaseContext)}))),Yp=()=>Au("pagerPrevious")("analytics/pager/previous",((e,t)=>e.logPagerPrevious({pagerNumber:$p(t),...il(t.insightCaseContext)})));var Gp=e=>{let t=il(e.insightCaseContext);return{targetId:t.caseId||"",targetType:"Case",caseNumber:t.caseNumber}};var Wp=e=>Au("staticFilterDeselect")("analytics/staticFilter/deselect",((t,r)=>t.logStaticFilterDeselect({...e,...il(r.insightCaseContext)})));var Jp=mn("facetOptions/update",((e={freezeFacetOrder:!0})=>$t(e,{freezeFacetOrder:new G({required:!1})}))),Kp=mn("facetOptions/facet/enable",(e=>$t(e,_h))),Zp=mn("facetOptions/facet/disable",(e=>$t(e,_h)));function Xp(e,t){let{facetId:r,criterion:n}=t,i=e[r]?.request;i&&(i.sortCriteria=n)}function ey(e){e&&(e.currentValues=e.currentValues.map((e=>({...e,state:"idle"}))),e.preventAutoSelect=!0)}function ty(e,t){e&&(e.numberOfValues=t)}var ry={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"ascending",rangeAlgorithm:"even",resultsMustMatch:"atLeastOneValue"};function ny(e,t){let{request:r}=t,{facetId:n}=r;if(n in e)return;let i=dy(r);r.numberOfValues=i,e[n]=t}function iy(e,t,r){let n=e[t]?.request;n&&(n.currentValues=r,n.numberOfValues=dy(n))}function ay(e,t,r){let n=e[t]?.request;if(!n)return;let i=ly(n.currentValues,r);if(!i)return;let a=i.state==="selected";i.state=a?"idle":"selected",n.preventAutoSelect=!0}function sy(e,t,r){let n=e[t]?.request;if(!n)return;let i=ly(n.currentValues,r);if(!i)return;let a=i.state==="excluded";i.state=a?"idle":"excluded",n.preventAutoSelect=!0}function oy(e,t){let r=e[t]?.request;r&&r.currentValues.forEach((e=>e.state="idle"))}function uy(e,t){Object.entries(e).forEach((([e,{request:r}])=>{let n=t[e]||[];r.currentValues.forEach((e=>{let t=!!ly(n,e);return e.state=t?"selected":"idle",e}));let i=n.filter((e=>!ly(r.currentValues,e))),a=r.currentValues;a.push(...i),r.numberOfValues=Math.max(r.numberOfValues,a.length)}))}function cy(e,t,r){t.forEach((t=>{let n=t.facetId,i=e[n]?.request;if(!i)return;let a=r(t.values);i.currentValues=a,i.preventAutoSelect=!1}))}function ly(e,t){let{start:r,end:n}=t;return e.find((e=>e.start===r&&e.end===n))}function dy(e){let{generateAutomaticRanges:t,currentValues:r,numberOfValues:n}=e;return t?Math.max(n,r.length):r.length}var fy=Tn(xo(),(e=>{e.addCase(ip,((e,t)=>{let{payload:r}=t,n=hy(r);ny(e,ko(n))})).addCase(Bc.fulfilled,((e,t)=>t.payload?.dateFacetSet??e)).addCase(kf,((e,t)=>{let r=t.payload.df||{};uy(e,r)})).addCase(ap,((e,t)=>{let{facetId:r,selection:n}=t.payload;ay(e,r,n)})).addCase(sp,((e,t)=>{let{facetId:r,selection:n}=t.payload;sy(e,r,n)})).addCase(op,((e,t)=>{let{facetId:r,values:n}=t.payload;iy(e,r,n)})).addCase(cp,((e,t)=>{oy(e,t.payload)})).addCase(Pl,(e=>{Object.keys(e).forEach((t=>{oy(e,t)}))})).addCase(up,((e,t)=>{Xp(e,t.payload)})).addCase(Md.fulfilled,((e,t)=>{let r=t.payload.response.facets;cy(e,r,gy)})).addCase(Op.fulfilled,((e,t)=>{let r=t.payload.response?.facets?.results||[];cy(e,r,gy)})).addCase(Zp,((e,t)=>{oy(e,t.payload)}))}));function hy(e){return{...ry,currentValues:[],preventAutoSelect:!1,type:"dateRange",...e}}function gy(e){return e.map((e=>{let{numberOfResults:t,...r}=e;return r}))}function py(e){return e.addReducers({dateFacetSet:fy}),{deselectAllDateFacetValues:cp,registerDateFacet:ip,toggleSelectDateFacetValue:ap,toggleExcludeDateFacetValue:sp,updateDateFacetSortCriterion:up,updateDateFacetValues:op}}var yy=Tn(Ro(),(e=>{e.addCase(hp,((e,t)=>{let{payload:r}=t,n=vy(r);ny(e,jo(n))})).addCase(Bc.fulfilled,((e,t)=>t.payload?.numericFacetSet??e)).addCase(kf,((e,t)=>{let r=t.payload.nf||{};uy(e,r)})).addCase(gp,((e,t)=>{let{facetId:r,selection:n}=t.payload;ay(e,r,n)})).addCase(pp,((e,t)=>{let{facetId:r,selection:n}=t.payload;sy(e,r,n)})).addCase(yp,((e,t)=>{let{facetId:r,values:n}=t.payload;iy(e,r,n)})).addCase(mp,((e,t)=>{oy(e,t.payload)})).addCase(Pl,(e=>{Object.keys(e).forEach((t=>{oy(e,t)}))})).addCase(vp,((e,t)=>{Xp(e,t.payload)})).addCase(Md.fulfilled,((e,t)=>{let r=t.payload.response.facets;cy(e,r,my)})).addCase(Op.fulfilled,((e,t)=>{let r=t.payload.response?.facets?.results||[];cy(e,r,my)})).addCase(Zp,((e,t)=>{oy(e,t.payload)}))}));function vy(e){return{...ry,currentValues:[],preventAutoSelect:!1,type:"numericalRange",...e}}function my(e){return e.map((e=>{let{numberOfResults:t,...r}=e;return r}))}function wy(e){return e.addReducers({numericFacetSet:yy}),{deselectAllNumericFacetValues:mp,registerNumericFacet:hp,toggleSelectNumericFacetValue:gp,toggleExcludeNumericFacetValue:pp,updateNumericFacetSortCriterion:vp,updateNumericFacetValues:yp}}var by={results:new re({required:!0,each:new ee({values:Ru})}),maxLength:new z({required:!0,min:1,default:10})},Sy=mn("recentResults/registerRecentResults",(e=>$t(e,by))),Iy=mn("recentResults/pushRecentResult",(e=>(Eu(e),{payload:e}))),Oy=mn("recentResults/clearRecentResults");function Ay(){return{results:[],maxLength:10}}Tn(Ay(),(e=>{e.addCase(Sy,((e,t)=>{e.results=t.payload.results.slice(0,t.payload.maxLength),e.maxLength=t.payload.maxLength})).addCase(Oy,(e=>{e.results=[]})).addCase(Iy,((e,t)=>{let r=t.payload;e.results=e.results.filter((e=>e.uniqueId!==r.uniqueId));let n=e.results.slice(0,e.maxLength-1);e.results=[r,...n]}))}));var qy=mn("insight/caseContext/set",(e=>{let t=new ee({options:{required:!0}}),r=$t(e,t).error;if(r)return{payload:e,error:r};let n=Object.values(e),i=new re({each:Tt}),a=$t(n,i).error;return a?{payload:e,error:a}:{payload:e}})),Cy=mn("insight/caseId/set",(e=>{let t=$t(e,Tt).error;return t?{payload:e,error:t}:{payload:e}})),ky=mn("insight/caseNumber/set",(e=>{let t=$t(e,Tt).error;return t?{payload:e,error:t}:{payload:e}}));Tn(nl(),(e=>{e.addCase(qy,((e,t)=>{e.caseContext=t.payload})).addCase(Cy,((e,t)=>{e.caseId=t.payload})).addCase(ky,((e,t)=>{e.caseNumber=t.payload}))}));var xy=new re({each:Rt,required:!0}),jy=(e,t)=>($t(e,Rt),X(t)?$t(t,Rt):$t(t,xy),{payload:{contextKey:e,contextValue:t}}),Ry=mn("context/set",(e=>{for(let[t,r]of Object.entries(e))jy(t,r);return{payload:e}})),Fy=mn("context/add",(e=>jy(e.contextKey,e.contextValue))),Ty=mn("context/remove",(e=>$t(e,Rt)));Tn(zc(),(e=>{e.addCase(Ry,((e,t)=>{e.contextValues=t.payload})).addCase(Fy,((e,t)=>{e.contextValues[t.payload.contextKey]=t.payload.contextValue})).addCase(Ty,((e,t)=>{delete e.contextValues[t.payload]})).addCase(Bc.fulfilled,((e,t)=>{t.payload&&(e.contextValues=t.payload.context.contextValues)}))}));var Dy={collectionField:new Z({emptyAllowed:!1,required:!1}),parentField:new Z({emptyAllowed:!1,required:!1}),childField:new Z({emptyAllowed:!1,required:!1}),numberOfFoldedResults:new z({min:0,required:!1})},My=mn("folding/register",(e=>$t(e,Dy))),Ey=Qn("folding/loadCollection",(async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let i=t(),a=i.configuration.analytics.analyticsMode==="legacy"?await Xl(i):await Zl(i),s=await n.search({...a,q:Py(i),enableQuerySyntax:!0,cq:`@${i.folding.fields.collection}="${e}"`,filterField:i.folding.fields.collection,childField:i.folding.fields.parent,parentField:i.folding.fields.child,filterFieldRange:100},{origin:"foldingCollection"});return mt(s)?r(s.error):{collectionId:e,results:s.success.results,rootResult:i.folding.collections[e].result}}));function Py(e){return e.query.q===""?"":e.query.enableQuerySyntax?`${e.query.q} OR @uri`:`( <@- ${e.query.q} -@> ) OR @uri`}var _y=()=>({enabled:!1,fields:{collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"},filterFieldRange:2,collections:{}});var $y=mn("fields/registerFieldsToInclude",(e=>$t(e,Mt))),Uy=mn("fields/fetchall/enable"),Vy=mn("fields/fetchall/disable"),Qy=Qn("fields/fetchDescription",(async(e,{extra:t,getState:r,rejectWithValue:n})=>{let i=r(),{accessToken:a,organizationId:s}=i.configuration,{apiBaseUrl:o}=i.configuration.search,u=await t.apiClient.fieldDescriptions({accessToken:a,organizationId:s,url:o});return mt(u)?n(u.error):u.success.fields}));var Ly=["author","language","urihash","objecttype","collection","source","permanentid"],By=()=>({fieldsToInclude:Ly,fetchAllFields:!1,fieldsDescription:[]});var Ny=Tn(By(),(e=>e.addCase($y,((e,t)=>{e.fieldsToInclude=[...new Set(e.fieldsToInclude.concat(t.payload))]})).addCase(Uy,(e=>{e.fetchAllFields=!0})).addCase(Vy,(e=>{e.fetchAllFields=!1})).addCase(Qy.fulfilled,((e,{payload:t})=>{e.fieldsDescription=t})).addCase(My,((e,{payload:t})=>{let r=_y().fields;e.fieldsToInclude.push(t.collectionField??r.collection,t.parentField??r.parent,t.childField??r.child)}))));function zy(e){return e.addReducers({fields:Ny}),{registerFieldsToInclude:$y,enableFetchAllFields:Uy,disableFetchAllFields:Vy,fetchFieldsDescription:Qy}}var Hy=new ee({options:{required:!0},values:{articleLanguage:Ft,articlePublishStatus:Ft,articleVersionNumber:Ft,caseId:Rt,knowledgeArticleId:Ft,name:Ft,permanentId:Ft,resultUrl:Ft,source:Ft,title:Rt,uriHash:Ft}}),Yy=mn("insight/attachToCase/setAttachedResults",(e=>$t(e,{results:new re({each:Hy}),loading:new G({required:!1,default:!1})}))),Gy=mn("insight/attachToCase/attach",(e=>Jy(e))),Wy=mn("insight/attachToCase/detach",(e=>Jy(e))),Jy=e=>N(e.result.permanentId)&&N(e.result.uriHash)?{payload:e,error:Pt(new U("Either permanentId or uriHash is required"))}:$t(e,{result:Hy});function Ky(){return{results:[],loading:!1}}Tn(Ky(),(e=>{e.addCase(Yy,((e,t)=>{let{results:r,loading:n}=t.payload;"results"in e&&e.results?.length>0||(e.results=r,n&&(e.loading=n))})).addCase(Gy,((e,t)=>{(!N(t.payload.result.permanentId)||!N(t.payload.result.uriHash))&&(e.results=[...e.results,t.payload.result])})).addCase(Wy,((e,t)=>{e.results=e.results.filter((e=>Zy(e,t.payload.result)))}))}));var Zy=(e,t)=>{let r=!N(e.permanentId)&&e?.permanentId===t?.permanentId,n=!N(e.uriHash)&&e?.uriHash===t?.uriHash;return!(e.caseId===t.caseId)||!r&&!n};var Xy=()=>new ee({values:{questionAnswerId:Rt},options:{required:!0}}),ev=()=>new ee({values:{linkText:Tt,linkURL:Tt},options:{required:!0}});function tv(e){return $t(e,Xy())}var rv=mn("smartSnippet/expand"),nv=mn("smartSnippet/collapse"),iv=mn("smartSnippet/like"),av=mn("smartSnippet/dislike"),sv=mn("smartSnippet/feedbackModal/open"),ov=mn("smartSnippet/feedbackModal/close"),uv=mn("smartSnippet/related/expand",(e=>tv(e))),cv=mn("smartSnippet/related/collapse",(e=>tv(e)));var lv=()=>({liked:!1,disliked:!1,expanded:!1,feedbackModalOpen:!1,relatedQuestions:[]});var dv=(e,t)=>e.findIndex((e=>e.questionAnswerId===t.questionAnswerId));function fv({question:e,answerSnippet:t,documentId:{contentIdKey:r,contentIdValue:n}}){return fe({question:e,answerSnippet:t,contentIdKey:r,contentIdValue:n})}function hv(e,t){let r=fv(e);return t&&r===t.questionAnswerId?t:{contentIdKey:e.documentId.contentIdKey,contentIdValue:e.documentId.contentIdValue,expanded:!1,questionAnswerId:r}}var gv=Tn(lv(),(e=>e.addCase(rv,(e=>{e.expanded=!0})).addCase(nv,(e=>{e.expanded=!1})).addCase(iv,(e=>{e.liked=!0,e.disliked=!1,e.feedbackModalOpen=!1})).addCase(av,(e=>{e.liked=!1,e.disliked=!0})).addCase(sv,(e=>{e.feedbackModalOpen=!0})).addCase(ov,(e=>{e.feedbackModalOpen=!1})).addCase(Md.fulfilled,((e,t)=>{let r=t.payload.response.questionAnswer.relatedQuestions.map(((t,r)=>hv(t,e.relatedQuestions[r]))),n=fv(t.payload.response.questionAnswer);return e.questionAnswerId===n?{...e,relatedQuestions:r}:{...lv(),relatedQuestions:r,questionAnswerId:n}})).addCase(uv,((e,t)=>{let r=dv(e.relatedQuestions,t.payload);r!==-1&&(e.relatedQuestions[r].expanded=!0)})).addCase(cv,((e,t)=>{let r=dv(e.relatedQuestions,t.payload);r!==-1&&(e.relatedQuestions[r].expanded=!1)}))));function pv(e,t){return e.raw[t.collection]}function yv(e,t){return e.raw[t.parent]}function vv(e,t){let r=e.raw[t.child];return oe(r)?r[0]:r}function mv(e,t){return(e||t)!==void 0&&e===t}function wv(e,t,r,n=[]){let i=vv(e,r);return i?n.indexOf(i)!==-1?[]:t.filter((t=>{let n=vv(t,r)===vv(e,r);return yv(t,r)===i&&!n})).map((e=>({result:e,children:wv(e,t,r,[...n,i])}))):[]}function bv(e,t){return e.find((e=>{let r=yv(e,t)===void 0,n=mv(yv(e,t),vv(e,t));return r||n}))}function Sv(e){return e.parentResult?Sv(e.parentResult):e}function Iv(e,t,r){let n=du(e),i=r??bv(n,t)??Sv(e);return{result:i,children:wv(i,n,t),moreResultsAvailable:!0,isLoadingMoreResults:!1}}function Ov(e,t,r){let n={};return e.forEach((e=>{let i=pv(e,t);i&&(!vv(e,t)&&!e.parentResult||(n[i]=Iv(e,t,r)))})),n}function Av(e,t){if(!e.collections[t])throw new Error(`Missing collection ${t} from ${Object.keys(e.collections)}: Folding most probably in an invalid state...`);return e.collections[t]}var qv=Tn(_y(),(e=>e.addCase(Md.fulfilled,((e,{payload:t})=>{e.collections=e.enabled?Ov(t.response.results,e.fields):{}})).addCase(Ed.fulfilled,((e,{payload:t})=>{e.collections=e.enabled?Ov(t.response.results,e.fields):{}})).addCase(Pd.fulfilled,((e,{payload:t})=>{e.collections=e.enabled?{...e.collections,...Ov(t.response.results,e.fields)}:{}})).addCase(My,((e,{payload:t})=>e.enabled?e:{enabled:!0,collections:{},fields:{collection:t.collectionField??e.fields.collection,parent:t.parentField??e.fields.parent,child:t.childField??e.fields.child},filterFieldRange:t.numberOfFoldedResults??e.filterFieldRange})).addCase(Ey.pending,((e,{meta:t})=>{let r=t.arg;Av(e,r).isLoadingMoreResults=!0})).addCase(Ey.rejected,((e,{meta:t})=>{let r=t.arg;Av(e,r).isLoadingMoreResults=!1})).addCase(Ey.fulfilled,((e,{payload:{collectionId:t,results:r,rootResult:n}})=>{let i=Ov(r,e.fields,n);if(!i||!i[t])throw new Error(`Unable to create collection ${t} from received results: ${JSON.stringify(r)}. Folding most probably in an invalid state... `);e.collections[t]=i[t],e.collections[t].moreResultsAvailable=!1}))));function Cv(e){let t,r=new Map,n=()=>r.size===0,i=e=>{try{let r=JSON.stringify(e),n=t!==r;return t=r,n}catch(e){return console.warn('Could not detect if state has changed, check the controller "get state method"',e),!0}};return{subscribe(a){a();let s=Symbol(),o;return n()&&(t=JSON.stringify(this.state),o=e.subscribe((()=>{i(this.state)&&r.forEach((e=>e()))}))),r.set(s,a),()=>{r.delete(s),n()&&o&&o()}},get state(){return{}}}}ln((e=>e.queryCorrection.correctedQuery!==""||e.wasCorrectedTo!==""),(e=>e));var kv=(e,t)=>{let r={...$c(),...t,correctedQuery:t?.correctedQuery||t?.corrections[0]?.correctedQuery||""};e.queryCorrection=r,e.wasCorrectedTo=r.correctedQuery};Tn(Uc(),(e=>{e.addCase(Fc,(e=>{e.enableDidYouMean=!0})).addCase(Tc,(e=>{e.enableDidYouMean=!1})).addCase(Mc,(e=>{e.automaticallyCorrectQuery=!0})).addCase(Dc,(e=>{e.automaticallyCorrectQuery=!1})).addCase(Md.pending,(e=>{e.queryCorrection=_c(),e.wasAutomaticallyCorrected=!1,e.wasCorrectedTo=""})).addCase(Md.fulfilled,((e,t)=>{let{queryCorrection:r,queryCorrections:n}=t.payload.response;if(e.queryCorrectionMode==="legacy"){let t=n&&n[0]?n[0]:_c();e.queryCorrection=t}e.queryCorrectionMode==="next"&&kv(e,r),e.wasAutomaticallyCorrected=t.payload.automaticallyCorrected,e.originalQuery=t.payload.originalQuery})).addCase(Ec,((e,t)=>{e.wasCorrectedTo=t.payload})).addCase(Pc,((e,t)=>{e.queryCorrectionMode=t.payload}))}));({categoryFacetId:_h,categoryFacetPath:new re({required:!0,each:Rt})});var xv=()=>({actionCause:"breadcrumbFacet"});function jv(e,t){let r=e[t];r&&(r.request.numberOfValues=r.initialNumberOfValues,r.request.currentValues=[],r.request.preventAutoSelect=!0)}function Rv(e,t,r){e.currentValues=Fv(t,r),e.numberOfValues=t.length?1:r,e.preventAutoSelect=!0}function Fv(e,t){if(!e.length)return[];let r=Tv(e[0],t),n=r;for(let r of e.splice(1)){let e=Tv(r,t);n.children.push(e),n=e}return n.state="selected",n.retrieveChildren=!0,[r]}function Tv(e,t){return{value:e,retrieveCount:t,children:[],state:"idle",retrieveChildren:!1}}var Dv=Tn(Co(),(e=>{e.addCase(fg,((e,t)=>{let r=t.payload,{facetId:n}=r;if(n in e)return;let i=Pv(r),a=i.numberOfValues;e[n]={request:i,initialNumberOfValues:a}})).addCase(Bc.fulfilled,((e,t)=>t.payload?.categoryFacetSet??e)).addCase(kf,((e,t)=>{let r=t.payload.cf||{};Object.keys(e).forEach((t=>{let n=e[t].request,i=r[t]||[];(i.length||n.currentValues.length)&&Rv(n,i,e[t].initialNumberOfValues)}))})).addCase(yg,((e,t)=>{let{facetId:r,criterion:n}=t.payload,i=e[r]?.request;i&&(i.sortCriteria=n)})).addCase(vg,((e,t)=>{let{facetId:r,basePath:n}=t.payload,i=e[r]?.request;i&&(i.basePath=[...n])})).addCase(hg,((e,t)=>{let{facetId:r,selection:n,retrieveCount:i}=t.payload,a=e[r]?.request;if(!a)return;let{path:s}=n,o=s.slice(0,s.length-1),u=Ev(a,o,i);if(u.length){let e=u[0];e.retrieveChildren=!0,e.state="selected",e.children=[];return}let c=_v(n.value,i);c.state="selected",u.push(c),a.numberOfValues=1})).addCase(gg,((e,t)=>{let r=t.payload;jv(e,r)})).addCase(Pl,(e=>{Object.keys(e).forEach((t=>jv(e,t)))})).addCase($l,((e,t)=>Object.keys(e).forEach((r=>{e[r].request.preventAutoSelect=!t.payload.allow})))).addCase(pg,((e,t)=>{let{facetId:r,numberOfValues:n}=t.payload,i=e[r]?.request;if(i){if(!i.currentValues.length)return ty(i,n);Uv(e,t.payload)}})).addCase(bg,((e,t)=>{let{facetId:r,value:n}=t.payload,i=e[r];if(!i)return;let a=[...n.path,n.rawValue];Rv(i.request,a,i.initialNumberOfValues)})).addCase(_d.fulfilled,((e,t)=>{$v(e,t.payload.response.facets)})).addCase(Md.fulfilled,((e,t)=>{$v(e,t.payload.response.facets)})).addCase(Zp,((e,t)=>{jv(e,t.payload)}))})),Mv={delimitingCharacter:";",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:5,sortCriteria:"occurrences",basePath:[],filterByBasePath:!0,resultsMustMatch:"atLeastOneValue"};function Ev(e,t,r){let n=e.currentValues;for(let e of t){let t=n[0];(!t||e!==t.value)&&(t=_v(e,r),n.length=0,n.push(t)),t.retrieveChildren=!1,t.state="idle",n=t.children}return n}function Pv(e){return{...Mv,currentValues:[],preventAutoSelect:!1,type:"hierarchical",...e}}function _v(e,t){return{value:e,state:"idle",children:[],retrieveChildren:!0,retrieveCount:t}}function $v(e,t){t.forEach((t=>{if(!Vv(e,t))return;let r=t.facetId,n=e[r]?.request;if(!n)return;let i=Qv(n,t);n.currentValues=i?[]:n.currentValues,n.preventAutoSelect=!1}))}function Uv(e,t){let{facetId:r,numberOfValues:n}=t,i=e[r]?.request.currentValues[0];if(i){for(;i.children.length&&i?.state!=="selected";)i=i.children[0];i.retrieveCount=n}}function Vv(e,t){return t.facetId in e}function Qv(e,t){let r=mo(e.currentValues),n=mo(t.values);return r.length!==n.length}var Lv=()=>({actionCause:"facetUpdateSort"}),Bv=()=>({actionCause:"facetClearAll"}),Nv=()=>({actionCause:"facetSelect"}),zv=()=>({actionCause:"facetDeselect"});var Hv=()=>({actionCause:"breadcrumbFacet"}),Yv=()=>({actionCause:"showLessFacetResults"}),Gv=()=>({actionCause:"showMoreFacetResults"});var Wv=Tn(To(),(e=>{e.addCase(zg,((e,t)=>{let{facetId:r}=t.payload;r in e||(e[r]=Fo(Xv(t.payload)))})).addCase(Bc.fulfilled,((e,t)=>{if(t.payload&&Object.keys(t.payload.facetSet).length!==0)return t.payload.facetSet})).addCase(kf,((e,t)=>{let r=t.payload.f||{},n=t.payload.fExcluded||{};Object.keys(e).forEach((t=>{let{request:i}=e[t],a=r[t]||[],s=n[t]||[],o=a.length+s.length,u=i.currentValues.filter((e=>!a.includes(e.value)&&!s.includes(e.value)));i.currentValues=[...a.map(tm),...s.map(rm),...u.map(nm)],i.preventAutoSelect=o>0,i.numberOfValues=Math.max(o,i.numberOfValues)}))})).addCase(Hg,((e,t)=>{let{facetId:r,selection:n}=t.payload,i=e[r]?.request;if(!i)return;i.preventAutoSelect=!0;let a=i.currentValues.find((e=>e.value===n.value));if(!a){Jv(i,n);return}let s=a.state==="selected";a.state=s?"idle":"selected",i.freezeCurrentValues=!0})).addCase(Yg,((e,t)=>{let{facetId:r,selection:n}=t.payload,i=e[r]?.request;if(!i)return;i.preventAutoSelect=!0;let a=i.currentValues.find((e=>e.value===n.value));if(!a){Jv(i,n);return}let s=a.state==="excluded";a.state=s?"idle":"excluded",i.freezeCurrentValues=!0})).addCase(Zg,((e,t)=>{let{facetId:r,freezeCurrentValues:n}=t.payload,i=e[r]?.request;i&&(i.freezeCurrentValues=n)})).addCase(Gg,((e,t)=>{ey(e[t.payload]?.request)})).addCase(Pl,(e=>{Object.values(e).filter((e=>e.hasBreadcrumbs)).forEach((({request:e})=>ey(e)))})).addCase(_l,(e=>{Object.values(e).filter((e=>!e.hasBreadcrumbs)).forEach((({request:e})=>ey(e)))})).addCase($l,((e,t)=>Object.values(e).forEach((e=>{e.request.preventAutoSelect=!t.payload.allow})))).addCase(Wg,((e,t)=>{Xp(e,t.payload)})).addCase(Jg,((e,t)=>{let{facetId:r,numberOfValues:n}=t.payload;ty(e[r]?.request,n)})).addCase(Kg,((e,t)=>{let{facetId:r,isFieldExpanded:n}=t.payload,i=e[r]?.request;i&&(i.isFieldExpanded=n)})).addCase(Md.fulfilled,((e,t)=>{t.payload.response.facets.forEach((t=>Kv(e[t.facetId]?.request,t)))})).addCase(Op.fulfilled,((e,t)=>{(t.payload.response?.facets?.results||[]).forEach((t=>Kv(e[t.facetId]?.request,t)))})).addCase(_d.fulfilled,((e,t)=>{t.payload.response.facets.forEach((t=>Kv(e[t.facetId]?.request,t)))})).addCase(qg,((e,t)=>{let{facetId:r,value:n}=t.payload,i=e[r]?.request;if(!i)return;let{rawValue:a}=n,{currentValues:s}=i,o=s.find((e=>e.value===a));if(o){o.state="selected";return}let u=tm(a);Jv(i,u),i.freezeCurrentValues=!0,i.preventAutoSelect=!0})).addCase(Cg,((e,t)=>{let{facetId:r,value:n}=t.payload,i=e[r]?.request;if(!i)return;let{rawValue:a}=n,{currentValues:s}=i,o=s.find((e=>e.value===a));if(o){o.state="excluded";return}let u=rm(a);Jv(i,u),i.freezeCurrentValues=!0,i.preventAutoSelect=!0})).addCase(Zp,((e,t)=>{if(!(t.payload in e))return;let{request:r}=e[t.payload];ey(r)}))}));function Jv(e,t){let{currentValues:r}=e,n=r.findIndex((e=>e.state==="idle")),i=n===-1?r.length:n,a=r.slice(0,i),s=r.slice(i+1);e.currentValues=[...a,t,...s],e.numberOfValues=e.currentValues.length}function Kv(e,t){e&&(e.currentValues=t.values.map(em),e.freezeCurrentValues=!1,e.preventAutoSelect=!1)}var Zv={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"automatic",resultsMustMatch:"atLeastOneValue"};function Xv(e){return{...Zv,type:"specific",currentValues:[],freezeCurrentValues:!1,isFieldExpanded:!1,preventAutoSelect:!1,...e}}function em(e){let{value:t,state:r}=e;return{value:t,state:r}}function tm(e){return{value:e,state:"selected"}}function rm(e){return{value:e,state:"excluded"}}function nm(e){return{...e,state:"idle"}}var im=()=>({actionCause:"breadcrumbResetAll"});var am=Jh;function sm(e,t){return!!t&&t.facetId in e.dateFacetSet}var om=(e,t)=>{let r=fo(e,t);if(sm(e,r))return r},um=(e,t)=>(om(e,t)||{values:[]}).values.filter((e=>e.state==="selected")),cm=(e,t)=>(om(e,t)||{values:[]}).values.filter((e=>e.state!=="idle"));var lm=Jh;function dm(e,t){return!!t&&t.facetId in e.numericFacetSet}var fm=(e,t)=>{let r=fo(e,t);if(dm(e,r))return r},hm=(e,t)=>(fm(e,t)||{values:[]}).values.filter((e=>e.state!=="idle")),gm=(e,t)=>(fm(e,t)||{values:[]}).values.filter((e=>e.state==="selected"));var pm=Rt,ym=new ee({options:{required:!0},values:{caption:Tt,expression:Tt,state:new Z({constrainTo:["idle","selected","excluded"]})}}),vm=new re({required:!0,each:ym});mn("staticFilter/register",(e=>$t(e,{id:pm,values:vm})));var mm=mn("staticFilter/toggleSelect",(e=>$t(e,{id:pm,value:ym}))),wm=mn("staticFilter/toggleExclude",(e=>$t(e,{id:pm,value:ym})));mn("staticFilter/deselectAllFilterValues",(e=>$t(e,pm)));var bm=()=>({actionCause:"staticFilterDeselect"});var Sm=e=>Object.keys(e.facetSet).map((t=>{let r=e.facetValuesSelector(e.engine.state,t).map((r=>({value:r,deselect:()=>{r.state==="selected"?e.executeToggleSelect({facetId:t,selection:r}):r.state==="excluded"&&e.executeToggleExclude({facetId:t,selection:r})}})));return{facetId:t,field:e.facetSet[t].request.field,values:r}})).filter((e=>e.values.length));function Im(e){let t=Cv(e),{dispatch:r}=e;return{...t,get state(){return{facetBreadcrumbs:[],categoryFacetBreadcrumbs:[],numericFacetBreadcrumbs:[],dateFacetBreadcrumbs:[],staticFilterBreadcrumbs:[],hasBreadcrumbs:!1}},deselectAll:()=>{r(Pl())},deselectBreadcrumb(e){e.deselect()}}}function Om(e){if(!Am(e));let t=Im(e),{dispatch:r}=e,n=()=>e.state,i=()=>{let t={engine:e,facetSet:n().facetSet,executeToggleSelect:({facetId:e,selection:t})=>{let n=Yh({facetId:e,facetValue:t.value});r(Hg({facetId:e,selection:t})),r(Zg({facetId:e,freezeCurrentValues:!1})),r(jl({legacy:n,next:Hv()}))},executeToggleExclude:({facetId:e,selection:t})=>{let n=Yh({facetId:e,facetValue:t.value});r(Yg({facetId:e,selection:t})),r(Zg({facetId:e,freezeCurrentValues:!1})),r(jl({legacy:n,next:Hv()}))},facetValuesSelector:yo};return Sm(t)},a=()=>{let t={engine:e,facetSet:n().numericFacetSet,executeToggleSelect:e=>{r(gp(e)),r(jl({legacy:rg(e),next:lm()}))},executeToggleExclude:e=>{r(pp(e)),r(jl({legacy:rg(e),next:lm()}))},facetValuesSelector:hm};return Sm(t)},s=()=>{let t={engine:e,facetSet:n().dateFacetSet,executeToggleSelect:e=>{r(ap(e)),r(jl({legacy:eg(e),next:am()}))},executeToggleExclude:e=>{r(sp(e)),r(jl({legacy:eg(e),next:am()}))},facetValuesSelector:cm};return Sm(t)},o=e=>{let t=Ao(n(),e);return{facetId:e,field:n().categoryFacetSet[e].request.field,path:t,deselect:()=>{r(gg(e)),r(jl({legacy:Vh({categoryFacetPath:t.map((e=>e.value)),categoryFacetId:e}),next:xv()}))}}},u=()=>Object.keys(n().categoryFacetSet).map(o).filter((e=>e.path.length)),c=()=>{let e=n().staticFilterSet||{};return Object.values(e).map(l)},l=e=>{let{id:t,values:r}=e,n=r.filter((e=>e.state!=="idle")).map((e=>d(t,e)));return{id:t,values:n}},d=(e,t)=>({value:t,deselect:()=>{let{caption:n,expression:i}=t,a=Wp({staticFilterId:e,staticFilterValue:{caption:n,expression:i}});t.state==="selected"?r(mm({id:e,value:t})):t.state==="excluded"&&r(wm({id:e,value:t})),r(jl({legacy:a,next:bm()}))}});function f(){return!![...i(),...a(),...s(),...u(),...c()].length}return{...t,get state(){return{facetBreadcrumbs:i(),categoryFacetBreadcrumbs:u(),numericFacetBreadcrumbs:a(),dateFacetBreadcrumbs:s(),staticFilterBreadcrumbs:c(),hasBreadcrumbs:f()}},deselectAll:()=>{t.deselectAll(),r(jl({legacy:Gh(),next:im()}))}}}function Am(e){return e.addReducers({configuration:$f,search:wf,facetSet:Wv,numericFacetSet:yy,dateFacetSet:fy,categoryFacetSet:Dv}),!0}var qm=()=>Ou("analytics/searchbox/submit",(e=>e.makeSearchboxSubmit()));var Cm=()=>Ou("analytics/pager/resize",((e,t)=>e.makePagerResize({currentResultsPerPage:t.pagination?.numberOfResults||Kc().numberOfResults})));var km=()=>({actionCause:"pagerResize"}),xm=()=>({actionCause:"pagerNext"}),jm=()=>({actionCause:"pagerPrevious"}),Rm=()=>({actionCause:"pagerNumber"});var Fm=()=>Au("searchboxSubmit")("analytics/searchbox/submit",((e,t)=>e.logSearchboxSubmit(il(t.insightCaseContext))));var Tm=Object.getOwnPropertyNames,Dm=Object.getOwnPropertySymbols,Mm=Object.prototype.hasOwnProperty;function Em(e,t){return function(r,n,i){return e(r,n,i)&&t(r,n,i)}}function Pm(e){return function(t,r,n){if(!t||!r||typeof t!="object"||typeof r!="object")return e(t,r,n);var i=n.cache,a=i.get(t),s=i.get(r);if(a&&s)return a===r&&s===t;i.set(t,r),i.set(r,t);var o=e(t,r,n);return i.delete(t),i.delete(r),o}}function _m(e){return Tm(e).concat(Dm(e))}var $m=Object.hasOwn||function(e,t){return Mm.call(e,t)};function Um(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var Vm="_owner",Qm=Object.getOwnPropertyDescriptor,Lm=Object.keys;function Bm(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function Nm(e,t){return Um(e.getTime(),t.getTime())}function zm(e,t,r){if(e.size!==t.size)return!1;for(var n={},i=e.entries(),a=0,s,o;(s=i.next())&&!s.done;){for(var u=t.entries(),c=!1,l=0;(o=u.next())&&!o.done;){var d=s.value,f=d[0],h=d[1],g=o.value,p=g[0],y=g[1];!c&&!n[l]&&(c=r.equals(f,p,a,l,e,t,r)&&r.equals(h,y,f,p,e,t,r))&&(n[l]=!0),l++}if(!c)return!1;a++}return!0}function Hm(e,t,r){var n=Lm(e),i=n.length;if(Lm(t).length!==i)return!1;for(var a;i-- >0;)if(a=n[i],a===Vm&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!$m(t,a)||!r.equals(e[a],t[a],a,a,e,t,r))return!1;return!0}function Ym(e,t,r){var n=_m(e),i=n.length;if(_m(t).length!==i)return!1;for(var a,s,o;i-- >0;)if(a=n[i],a===Vm&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!$m(t,a)||!r.equals(e[a],t[a],a,a,e,t,r)||(s=Qm(e,a),o=Qm(t,a),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function Gm(e,t){return Um(e.valueOf(),t.valueOf())}function Wm(e,t){return e.source===t.source&&e.flags===t.flags}function Jm(e,t,r){if(e.size!==t.size)return!1;for(var n={},i=e.values(),a,s;(a=i.next())&&!a.done;){for(var o=t.values(),u=!1,c=0;(s=o.next())&&!s.done;)!u&&!n[c]&&(u=r.equals(a.value,s.value,a.value,s.value,e,t,r))&&(n[c]=!0),c++;if(!u)return!1}return!0}function Km(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}var Zm="[object Arguments]",Xm="[object Boolean]",ew="[object Date]",tw="[object Map]",rw="[object Number]",nw="[object Object]",iw="[object RegExp]",aw="[object Set]",sw="[object String]",ow=Array.isArray,uw=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,cw=Object.assign,lw=Object.prototype.toString.call.bind(Object.prototype.toString);function dw(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areMapsEqual,i=e.areObjectsEqual,a=e.arePrimitiveWrappersEqual,s=e.areRegExpsEqual,o=e.areSetsEqual,u=e.areTypedArraysEqual;return function(e,c,l){if(e===c)return!0;if(e==null||c==null||typeof e!="object"||typeof c!="object")return e!==e&&c!==c;var d=e.constructor;if(d!==c.constructor)return!1;if(d===Object)return i(e,c,l);if(ow(e))return t(e,c,l);if(uw!=null&&uw(e))return u(e,c,l);if(d===Date)return r(e,c,l);if(d===RegExp)return s(e,c,l);if(d===Map)return n(e,c,l);if(d===Set)return o(e,c,l);var f=lw(e);return f===ew?r(e,c,l):f===iw?s(e,c,l):f===tw?n(e,c,l):f===aw?o(e,c,l):f===nw?typeof e.then!="function"&&typeof c.then!="function"&&i(e,c,l):f===Zm?i(e,c,l):f===Xm||f===rw||f===sw?a(e,c,l):!1}}function fw(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,i={areArraysEqual:n?Ym:Bm,areDatesEqual:Nm,areMapsEqual:n?Em(zm,Ym):zm,areObjectsEqual:n?Ym:Hm,arePrimitiveWrappersEqual:Gm,areRegExpsEqual:Wm,areSetsEqual:n?Em(Jm,Ym):Jm,areTypedArraysEqual:n?Ym:Km};if(r&&(i=cw({},i,r(i))),t){var a=Pm(i.areArraysEqual),s=Pm(i.areMapsEqual),o=Pm(i.areObjectsEqual),u=Pm(i.areSetsEqual);i=cw({},i,{areArraysEqual:a,areMapsEqual:s,areObjectsEqual:o,areSetsEqual:u})}return i}function hw(e){return function(t,r,n,i,a,s,o){return e(t,r,o)}}function gw(e){var t=e.circular,r=e.comparator,n=e.createState,i=e.equals,a=e.strict;if(n)return function(e,s){var o=n(),u=o.cache,c=u===void 0?t?new WeakMap:void 0:u,l=o.meta;return r(e,s,{cache:c,equals:i,meta:l,strict:a})};if(t)return function(e,t){return r(e,t,{cache:new WeakMap,equals:i,meta:void 0,strict:a})};var s={cache:void 0,equals:i,meta:void 0,strict:a};return function(e,t){return r(e,t,s)}}pw();pw({strict:!0});pw({circular:!0});pw({circular:!0,strict:!0});pw({createInternalComparator:function(){return Um}});pw({strict:!0,createInternalComparator:function(){return Um}});pw({circular:!0,createInternalComparator:function(){return Um}});pw({circular:!0,createInternalComparator:function(){return Um},strict:!0});function pw(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,i=e.createState,a=e.strict,s=a===void 0?!1:a,o=fw(e),u=dw(o),c=n?n(u):hw(u);return gw({circular:r,comparator:u,createState:i,equals:c,strict:s})}function yw(e,t){return e.length!==t.length?!1:e.every((e=>t.findIndex((t=>vw(e,t)))!==-1))}var vw=pw({createCustomConfig:e=>({...e,areArraysEqual:yw})});new V({parameters:new ee({options:{required:!0},values:Cf})});var mw=Tn(Wc(),(e=>{e.addCase(Jp,((e,t)=>({...e,...t.payload}))).addCase(Md.fulfilled,(e=>{e.freezeFacetOrder=!1})).addCase(Md.rejected,(e=>{e.freezeFacetOrder=!1})).addCase(Bc.fulfilled,((e,t)=>t.payload?.facetOptions??e)).addCase(fg,((e,t)=>{e.facets[t.payload.facetId]=Gc()})).addCase(zg,((e,t)=>{e.facets[t.payload.facetId]=Gc()})).addCase(ip,((e,t)=>{e.facets[t.payload.facetId]=Gc()})).addCase(hp,((e,t)=>{e.facets[t.payload.facetId]=Gc()})).addCase(Kp,((e,t)=>{e.facets[t.payload].enabled=!0})).addCase(Zp,((e,t)=>{e.facets[t.payload].enabled=!1})).addCase(kf,((e,t)=>{[...Object.keys(t.payload.f??{}),...Object.keys(t.payload.fExcluded??{}),...Object.keys(t.payload.cf??{}),...Object.keys(t.payload.nf??{}),...Object.keys(t.payload.df??{})].forEach((t=>{t in e||(e.facets[t]=Gc()),e.facets[t].enabled=!0}))}))}));var ww=(e,t)=>e.facetOptions.facets[t]?.enabled??!0;var bw=e=>Sw(e.cartItems,e.cart);function Sw(e,t){let r=e.reduce(((e,r)=>{let{productId:n,quantity:i}=t[r];return n in e||(e[n]={productId:n,quantity:0}),e[n].quantity+=i,e}),{});return[...Object.values(r)]}new ee({options:{required:!1},values:{by:new ie({enum:bp,required:!0}),fields:new re({each:new ee({values:{field:new Z({required:!0}),direction:new ie({enum:Sp}),displayName:new Z}})})}});var Iw=async e=>({...await Ow(e),facets:qw(e),...e.commerceSort&&{sort:Cw(e.commerceSort.appliedSort)}}),Ow=async(e,t)=>{let{view:r,user:n,...i}=e.commerceContext;return{accessToken:e.configuration.accessToken,url:e.configuration.platformUrl,organizationId:e.configuration.organizationId,trackingId:e.configuration.analytics.trackingId,...i,clientId:await no(e.configuration.analytics),context:{user:n,view:r,cart:bw(e.cart)},...Aw(e,t)}},Aw=(e,t)=>{let r=t?e.commercePagination?.recommendations[t]:e.commercePagination?.principal;return r&&{page:r.page,...r.perPage&&{perPage:r.perPage}}};function qw(e){return!e.facetOrder||!e.commerceFacetSet?[]:e.facetOrder.map((t=>e.commerceFacetSet[t].request)).filter((e=>e.values.length>0))}function Cw(e){return e.by==="relevance"?{sortCriteria:"relevance"}:{sortCriteria:"fields",fields:e.fields.map((({name:e,direction:t})=>({field:e,direction:t})))}}var kw=async(e,t,r)=>{let n=`*${t.categoryFacetSearchSet[e].options.query}*`,i=t.commerceFacetSet[e]?.request,a=i&&xw(i)?i&&jw(i):[],s=a.length?[a]:[],o=t.commerceQuery?.query,{url:u,accessToken:c,organizationId:l,trackingId:d,language:f,country:h,currency:g,clientId:p,context:y,...v}=await Iw(t);return{url:u,accessToken:c,organizationId:l,facetId:e,facetQuery:n,ignorePaths:s,trackingId:d,language:f,country:h,currency:g,clientId:p,context:y,...!r&&{...v,query:o}}};function xw(e){return e.type==="hierarchical"}var jw=e=>{let t=[],r=e.values[0];for(;r;)t.push(r.value),r=r.children[0];return t};var Rw=async(e,t,r)=>{let n=`*${t.facetSearchSet[e].options.query}*`,i=t.commerceQuery?.query;i===void 0&&(i="");let{url:a,accessToken:s,organizationId:o,trackingId:u,language:c,country:l,currency:d,clientId:f,context:h,...g}=await Iw(t);return{url:a,accessToken:s,organizationId:o,facetId:e,facetQuery:n,trackingId:u,language:c,country:l,currency:d,clientId:f,context:h,...!r&&{...g,query:i}}};var Fw=e=>async(t,{getState:r,extra:{apiClient:n,validatePayload:i}})=>{let a=r();i(t,Rt);let s=Mw(a,t)||Ew(a,t)?Rw(t,a,e):kw(t,a,e),o=await n.facetSearch(await s);return{facetId:t,response:o}},Tw=Qn("commerce/facetSearch/executeSearch",Fw(!1)),Dw=Qn("commerce/facetSearch/facetFieldSuggest",Fw(!1)),Mw=(e,t)=>"facetSearchSet"in e&&e.facetSearchSet[t]!==void 0&&e.commerceFacetSet[t]!==void 0,Ew=(e,t)=>"fieldSuggestionsOrder"in e?e.fieldSuggestionsOrder.some((e=>e.facetId===t&&e.type==="regular")):!1;var Pw=ln((e=>e.commercePagination?.principal.perPage||0),(e=>e));ln(((e,t)=>e.commercePagination?.recommendations[t]?.perPage||0),(e=>e));var _w=ln((e=>e.commercePagination?.principal.totalEntries||0),(e=>e));ln(((e,t)=>e.commercePagination?.recommendations[t]?.totalEntries||0),(e=>e));ln((e=>e.commercePagination?.principal.page||0),(e=>e));ln(((e,t)=>e.commercePagination?.recommendations[t]?.page||0),(e=>e));ln((e=>e.productListing.responseId),(e=>e));ln((e=>e.productListing.requestId),(e=>e));var $w=ln((e=>e.productListing?.products.length||0),(e=>e)),Uw=ln((e=>({total:_w(e),current:$w(e)})),(({current:e,total:t})=>e<t));ln((e=>e.productListing?.isLoading),(e=>N(e)?!1:e));ln((e=>e.productListing?.error),(e=>e));var Vw=Qn("commerce/productListing/fetch",(async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:i})=>{let a=t(),{apiClient:s}=i,o=await s.getProductListing(await Iw(a));return wp(o)?(r(td(o.error)),n(o.error)):{response:o.success}}));Qn("commerce/productListing/fetchMoreProducts",(async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:i})=>{let a=t();if(!Uw(a))return null;let{apiClient:s}=i,o=Pw(a),u=$w(a)/o,c=await s.getProductListing({...await Iw(a),page:u});return wp(c)?(r(td(c.error)),n(c.error)):{response:c.success}}));var Qw=Qn("commerce/querySuggest/fetch",(async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:i}})=>{i(e,wh);let a=t(),s=await Lw(e.id,a),o=await n.querySuggest(s);return wp(o)?r(o.error):{id:e.id,query:s.query,...o.success}})),Lw=async(e,t)=>{let{view:r,user:n,...i}=t.commerceContext;return{accessToken:t.configuration.accessToken,url:t.configuration.platformUrl,organizationId:t.configuration.organizationId,trackingId:t.configuration.analytics.trackingId,query:t.querySet[e],...i,clientId:await no(t.configuration.analytics),context:{user:n,view:r,cart:bw(t.cart)}}};var Bw=mn("query/updateQuery",(e=>$t(e,{query:new Z})));ln((e=>e.commerceSearch.responseId),(e=>e));ln((e=>e.commerceSearch.requestId),(e=>e));var Nw=ln((e=>e.commerceSearch?.products.length||0),(e=>e)),zw=ln((e=>({total:_w(e),current:Nw(e)})),(({current:e,total:t})=>e<t));ln((e=>e.commerceSearch?.isLoading),(e=>N(e)?!1:e));ln((e=>e.commerceSearch?.error),(e=>e));var Hw=ln((e=>e.commerceQuery?.query),(e=>e??""));ln((e=>e.commerceSearch?.queryExecuted),(e=>e));var Yw=(e,t)=>t.queryCorrection?.correctedQuery!==void 0?t.queryCorrection?.correctedQuery:Hw(e);var Gw=Qn("commerce/search/executeSearch",(async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:i})=>{let a=t(),{apiClient:s}=i,o=Hw(a),u=await s.search({...await Iw(a),query:o});return wp(u)?(r(td(u.error)),n(u.error)):{response:u.success,originalQuery:o,queryExecuted:Yw(a,u.success)}}));Qn("commerce/search/fetchMoreProducts",(async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:i})=>{let a=t();if(!zw(a))return null;let{apiClient:s}=i,o=Pw(a),u=Nw(a)/o,c=Hw(a),l=await s.search({...await Iw(a),query:c,page:u});return wp(l)?(r(td(l.error)),n(l.error)):{response:l.success,originalQuery:c,queryExecuted:Yw(a,l.success)}}));Qn("commerce/search/prepareForSearchWithQuery",((e,t)=>{let{dispatch:r}=t;$t(e,{query:new Z,clearFilters:new G}),e.clearFilters&&(r(Pl()),r(_l())),r($l({allow:!0})),r(Bw({query:e.query})),r(Wl(1))}));Qn("commerce/search/fetchInstantProducts",(async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:i})=>{let a=t(),{q:s}=e,{apiClient:o}=i,u=await o.productSuggestions({...await Iw(a),query:s});if(wp(u))return r(td(u.error)),n(u.error);let c=u.success.products.slice(0,5);return{response:{...u.success,products:c}}}));function Ww(e,t,r){let{facetId:n}=t;if(e[n])return;let i=!1,a={...sb,...t},s=r();e[n]={options:a,isLoading:i,response:s,initialNumberOfValues:a.numberOfValues,requestId:""}}function Jw(e,t){let{facetId:r,...n}=t,i=e[r];i&&(i.options={...i.options,...n})}function Kw(e,t,r){let n=e[t];n&&(n.requestId=r,n.isLoading=!0)}function Zw(e,t){let r=e[t];r&&(r.isLoading=!1)}function Xw(e,t,r){let{facetId:n,response:i}=t,a=e[n];a&&a.requestId===r&&(a.isLoading=!1,a.response=i)}function eb(e,t,r){let{facetId:n,response:i}=t,a=e[n];a&&a.requestId===r&&(a.isLoading=!1,"success"in i&&(a.response=i.success))}function tb(e,t,r,n){let{facetId:i,response:a}=t,s=e[i];if(!s)Ww(e,{facetId:i},n),s=e[i];else if(s.requestId!==r)return;s.isLoading=!1,"success"in a&&(s.response=a.success)}function rb(e,t,r,n){if(t.fieldSuggestionsFacets)for(let i of t.fieldSuggestionsFacets)i.facetId in e||i.type!=="regular"||(e[i.facetId]={options:{...sb,query:t.query??""},isLoading:!1,response:n(),initialNumberOfValues:sb.numberOfValues,requestId:r})}function nb(e,t,r,n){if(t.fieldSuggestionsFacets)for(let i of t.fieldSuggestionsFacets)i.facetId in e||i.type!=="hierarchical"||(e[i.facetId]={options:{...sb,query:t.query??""},isLoading:!1,response:n(),initialNumberOfValues:sb.numberOfValues,requestId:r})}function ib(e,t,r){let{facetId:n}=t,i=e[n];i&&(i.requestId="",i.isLoading=!1,i.response=r(),i.options.numberOfValues=i.initialNumberOfValues,i.options.query=sb.query)}function ab(e,t){Object.keys(e).forEach((r=>ib(e,{facetId:r},t)))}var sb={captions:{},numberOfValues:10,query:""};var ob=async(e,t,r)=>{let n=t.categoryFacetSearchSet[e].options,i=t.categoryFacetSet[e].request,{captions:a,query:s,numberOfValues:o}=n,{field:u,delimitingCharacter:c,basePath:l,filterFacetCount:d}=i,f=ub(i),h=f.length?[f]:[],g=`*${s}*`;return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")},basePath:l,captions:a,numberOfValues:o,query:g,field:u,delimitingCharacter:c,ignorePaths:h,filterFacetCount:d,type:"hierarchical",...r?{}:{searchContext:(await nd(t)).request}}},ub=e=>{let t=[],r=e.currentValues[0];for(;r;)t.push(r.value),r=r.children[0];return t};var cb=async(e,t,r)=>{let{captions:n,query:i,numberOfValues:a}=t.facetSearchSet[e].options,{field:s,currentValues:o,filterFacetCount:u}=t.facetSet[e].request,c=o.filter((e=>e.state!=="idle")).map((e=>e.value)),l=`*${i}*`;return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders&&{authentication:t.configuration.search.authenticationProviders.join(",")},captions:n,numberOfValues:a,query:l,field:s,ignoreValues:c,filterFacetCount:u,type:"specific",...r?{}:{searchContext:(await nd(t)).request}}};var lb=e=>async(t,{getState:r,extra:{apiClient:n,validatePayload:i}})=>{let a=r(),s;i(t,Rt),hb(a,t)?s=await cb(t,a,e):s=await ob(t,a,e);let o=await n.facetSearch(s);return{facetId:t,response:o}},db=Qn("facetSearch/executeSearch",lb(!1));Qn("facetSearch/executeSearch",lb(!0));var fb=mn("facetSearch/clearResults",(e=>$t(e,{facetId:_h}))),hb=(e,t)=>e.facetSearchSet!==void 0&&e.facetSet!==void 0&&e.facetSet[t]!==void 0;function gb(){return{}}Tn(gb(),(e=>{e.addCase(Sg,((e,t)=>{let r=t.payload;Ww(e,r,pb)})).addCase(Ag,((e,t)=>{Jw(e,t.payload)})).addCase(Tw.pending,((e,t)=>{let r=t.meta.arg;Kw(e,r,t.meta.requestId)})).addCase(Dw.pending,((e,t)=>{let r=t.meta.arg;Kw(e,r,t.meta.requestId)})).addCase(db.pending,((e,t)=>{let r=t.meta.arg;Kw(e,r,t.meta.requestId)})).addCase(Tw.rejected,((e,t)=>{let r=t.meta.arg;Zw(e,r)})).addCase(Dw.rejected,((e,t)=>{let r=t.meta.arg;Zw(e,r)})).addCase(db.rejected,((e,t)=>{let r=t.meta.arg;Zw(e,r)})).addCase(Tw.fulfilled,((e,t)=>{eb(e,t.payload,t.meta.requestId)})).addCase(Dw.fulfilled,((e,t)=>{tb(e,t.payload,t.meta.requestId,pb)})).addCase(Qw.fulfilled,((e,t)=>{nb(e,t.payload,t.meta.requestId,pb)})).addCase(db.fulfilled,((e,t)=>{Xw(e,t.payload,t.meta.requestId)})).addCase(fb,((e,{payload:{facetId:t}})=>{ib(e,{facetId:t},pb)})).addCase(Vw.fulfilled,(e=>ab(e,pb))).addCase(Gw.fulfilled,(e=>ab(e,pb))).addCase(Md.fulfilled,(e=>{ab(e,pb)}))}));function pb(){return{moreValuesAvailable:!1,values:[]}}function yb(e,t){let{field:r,state:n}=e;if(!vb(e))return r;let i=`${r}_`,a=mb(i,n);return Sb(r,t),`${i}${a}`}function vb(e){let{field:t,state:r}=e;return wb(r).some((e=>e&&t in e))}function mb(e,t){let r=wb(t).map((e=>Object.keys(e||{}))).reduce(((e,t)=>e.concat(t)),[]);return bb(r,e)+1}function wb(e){let{facetSet:t,numericFacetSet:r,dateFacetSet:n,categoryFacetSet:i}=e;return[t,r,n,i]}function bb(e,t){return e.map((e=>{let r=e.split(t)[1],n=parseInt(r,10);return Number.isNaN(n)?0:n})).sort().pop()??0}function Sb(e,t){let r=`A facet with field "${e}" already exists.\n  To avoid unexpected behaviour, configure the #id option on the facet controller.`;t.warn(r)}function Ib(e,t){let{state:r,logger:n}=e,{field:i,facetId:a}=t;return a||yb({field:i,state:r},n)}var Ob=["alphanumeric","occurrences"];new V({field:Rg,basePath:Fg,delimitingCharacter:Tg,facetId:jg,facetSearch:Qg,filterByBasePath:Dg,filterFacetCount:Mg,injectionDepth:Eg,numberOfValues:Pg,sortCriteria:new Z({constrainTo:Ob})});var Ab=Intl.supportedValuesOf("currency"),qb=new Z({required:!0,emptyAllowed:!1,constrainTo:Ab}),Cb={url:Rt,referrer:Dt},kb={userId:Ft,email:Ft,userIp:Ft,userAgent:Ft},xb=new ee({options:{required:!0},values:{productId:Ft,sku:Ft,name:Ft,price:Ft,quantity:Ft}});({items:new re({each:xb})});var jb={language:Rt,country:Rt,currency:qb,user:new ee({values:kb}),view:new ee({options:{required:!0},values:Cb})};new V(jb);mn("commerce/setContext",(e=>$t(e,jb)));mn("commerce/setUser",(e=>N(e.userId)&&N(e.email)?{payload:e,error:Pt(new U("Either userId or email is required"))}:$t(e,kb)));var Rb=mn("commerce/setView",(e=>$t(e,Cb)));function Fb(){return{}}var Tb=Tn(Fb(),(e=>{e.addCase(Og,((e,t)=>{let r=t.payload;Ww(e,r,Db)})).addCase(Ag,((e,t)=>{Jw(e,t.payload)})).addCase(Tw.pending,((e,t)=>{let r=t.meta.arg;Kw(e,r,t.meta.requestId)})).addCase(Dw.pending,((e,t)=>{let r=t.meta.arg;Kw(e,r,t.meta.requestId)})).addCase(db.pending,((e,t)=>{let r=t.meta.arg;Kw(e,r,t.meta.requestId)})).addCase(Tw.rejected,((e,t)=>{let r=t.meta.arg;Zw(e,r)})).addCase(Dw.rejected,((e,t)=>{let r=t.meta.arg;Zw(e,r)})).addCase(db.rejected,((e,t)=>{let r=t.meta.arg;Zw(e,r)})).addCase(Tw.fulfilled,((e,t)=>{eb(e,t.payload,t.meta.requestId)})).addCase(Dw.fulfilled,((e,t)=>{tb(e,t.payload,t.meta.requestId,Db)})).addCase(Qw.fulfilled,((e,t)=>{rb(e,t.payload,t.meta.requestId,Db)})).addCase(db.fulfilled,((e,t)=>{Xw(e,t.payload,t.meta.requestId)})).addCase(fb,((e,{payload:t})=>{ib(e,t,Db)})).addCase(Md.fulfilled,(e=>{ab(e,Db)})).addCase(Vw.fulfilled,(e=>ab(e,Db))).addCase(Gw.fulfilled,(e=>ab(e,Db))).addCase(Rb,(e=>ab(e,Db)))}));function Db(){return{moreValuesAvailable:!1,values:[]}}var Mb=e=>e.state==="selected",Eb=(e,t)=>{let r={facetId:e,facetValue:t.value};return Mb(t)?Hh(r):zh(r)};var Pb=e=>e.state==="selected",_b=e=>e.state==="excluded";var $b=e=>Pb(e)?zv():Nv();var Ub={facetId:_h,selection:new ee({values:ng})},Vb=Qn("facet/executeToggleSelect",(({facetId:e,selection:t},r)=>{let{dispatch:n,extra:{validatePayload:i}}=r;i({facetId:e,selection:t},Ub),n(Hg({facetId:e,selection:t})),n(Jp())})),Qb=Qn("facet/executeToggleExclude",(({facetId:e,selection:t},r)=>{let{dispatch:n,extra:{validatePayload:i}}=r;i({facetId:e,selection:t},Ub),n(Yg({facetId:e,selection:t})),n(Jp())}));var Lb=["allValues","atLeastOneValue"];var Bb=["score","alphanumeric","alphanumericDescending","occurrences","automatic"];var Nb=new V({facetId:jg,field:Rg,filterFacetCount:Mg,injectionDepth:Eg,numberOfValues:Pg,sortCriteria:new Z({constrainTo:Bb}),resultsMustMatch:new Z({constrainTo:Lb}),facetSearch:Qg});function zb(e,t,r=Nb){if(!Hb(e));let{dispatch:n}=e,i=Cv(e),a=Ib(e,t.options),s={...Zv,...de("facetSearch",t.options),field:t.options.field,facetId:a},o={facetSearch:{...sb,...t.options.facetSearch},...s};Vt(e,r,o,"buildFacet");let u=()=>ho(e.state,a),c=()=>po(e.state,a),l=()=>vo(e.state),d=()=>ww(e.state,a),f=()=>{let{currentValues:e}=u();return e.filter((e=>e.state!=="idle")).length},h=()=>{let{currentValues:e}=u(),t=o.numberOfValues,r=!!e.find((e=>e.state==="idle"));return t<e.length&&r};return n(zg(s)),{...i,toggleSelect:e=>n(Vb({facetId:o.facetId,selection:e})),toggleExclude:e=>n(Qb({facetId:o.facetId,selection:e})),toggleSingleSelect:function(e){e.state==="idle"&&n(Gg(a)),this.toggleSelect(e)},toggleSingleExclude:function(e){e.state==="idle"&&n(Gg(a)),this.toggleExclude(e)},isValueSelected:Pb,isValueExcluded:_b,deselectAll(){n(Gg(a)),n(Jp())},sortBy(e){n(Wg({facetId:a,criterion:e})),n(Jp())},isSortedBy(e){return this.state.sortCriterion===e},showMoreValues(){let e=u().numberOfValues,t=o.numberOfValues,r=t-e%t,i=e+r;n(Jg({facetId:a,numberOfValues:i})),n(Kg({facetId:a,isFieldExpanded:!0})),n(Jp())},showLessValues(){let e=o.numberOfValues,t=Math.max(e,f());n(Jg({facetId:a,numberOfValues:t})),n(Kg({facetId:a,isFieldExpanded:!1})),n(Jp())},enable(){n(Kp(a))},disable(){n(Zp(a))},get state(){let e=u(),t=c(),r=l(),n=d(),i;typeof e.sortCriteria=="object"?i=e.sortCriteria.order==="descending"?"alphanumericDescending":"alphanumeric":i=e.sortCriteria;let s=t?t.values:[],o=s.some((e=>e.state!=="idle")),f=t?t.moreValuesAvailable:!1,g=e.resultsMustMatch;return{label:t?.label,facetId:a,values:s,sortCriterion:i,resultsMustMatch:g,isLoading:r,hasActiveValues:o,canShowMoreValues:f,canShowLessValues:h(),enabled:n}}}}function Hb(e){return e.addReducers({facetSet:Wv,facetOptions:mw,configuration:$f,facetSearchSet:Tb}),!0}var Yb=new V({facetId:jg,field:Rg,filterFacetCount:Mg,injectionDepth:Eg,numberOfValues:Pg,sortCriteria:new Z({constrainTo:Bb}),resultsMustMatch:new Z({constrainTo:Lb}),facetSearch:Qg,allowedValues:Lg,customSort:Bg});function Gb(e,t){if(!Wb(e));let{dispatch:r}=e,n=zb(e,{...t,options:{...t.options,...t.options.allowedValues&&{allowedValues:{type:"simple",values:t.options.allowedValues}}}},Yb),i=()=>n.state.facetId,a={updateText(){},showMoreResults(){},search(){},clear(){},updateCaptions(){},select(){},exclude(){},singleSelect(){},singleExclude(){},get state(){return{values:[],isLoading:!1,moreValuesAvailable:!1,query:""}}},{state:s,...o}=a;return{...n,facetSearch:o,toggleSelect(e){n.toggleSelect(e),r(jl({legacy:Eb(i(),e),next:$b(e)}))},deselectAll(){n.deselectAll(),r(jl({legacy:Nh(i()),next:Bv()}))},sortBy(e){n.sortBy(e),r(jl({legacy:Bh({facetId:i(),sortCriterion:e}),next:Lv()}))},isSortedBy(e){return this.state.sortCriterion===e},showMoreValues(){n.showMoreValues(),r(Tl({legacy:Qh(i()),next:Gv()}))},showLessValues(){n.showLessValues(),r(Tl({legacy:Lh(i()),next:Yv()}))},get state(){return{...n.state,facetSearch:a.state}}}}function Wb(e){return e.addReducers({facetSet:Wv,configuration:$f,facetSearchSet:Tb,search:wf}),!0}var Jb=e=>e.state==="selected",Kb=e=>e.state==="excluded";var Zb=e=>Jb(e)?zv():Nv();var Xb=(e,t)=>{let r=`${t.start}..${t.end}`,n={facetId:e,facetValue:r};return Jb(t)?Hh(n):zh(n)};var eS=mn("rangeFacet/executeToggleSelect",(e=>$t(e,Xh(e.selection)))),tS=mn("rangeFacet/executeToggleExclude",(e=>$t(e,Xh(e.selection))));var rS={facetId:_h,selection:new ee({values:Zh})},nS=Qn("dateFacet/executeToggleSelect",((e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,rS),t(ap(e)),t(eS(e)),t(Jp())})),iS=Qn("dateFacet/executeToggleExclude",((e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,rS),t(sp(e)),t(tS(e)),t(Jp())}));function aS(e,t){let{facetId:r,getRequest:n}=t,i=Cv(e),a=e.dispatch,s=()=>ww(e.state,r);return{...i,isValueSelected:Jb,isValueExcluded:Kb,deselectAll(){a(Gg(r)),a(Jp())},sortBy(e){a(Xg({facetId:r,criterion:e})),a(Jp())},isSortedBy(e){return this.state.sortCriterion===e},enable(){a(Kp(r))},disable(){a(Zp(r))},get state(){let t=n(),i=fo(e.state,r),a=t.sortCriteria,o=t.resultsMustMatch,u=i?i.values:[],c=vo(e.state),l=s(),d=u.some((e=>e.state!=="idle"));return{facetId:r,values:u,sortCriterion:a,resultsMustMatch:o,hasActiveValues:d,isLoading:c,enabled:l}}}}function sS(e,t){if(!e.generateAutomaticRanges&&e.currentValues===void 0){let e=`currentValues should be specified for ${t} when generateAutomaticRanges is false.`;throw new Error(e)}}var oS=["idle","selected","excluded"];var uS=["ascending","descending"],cS=["even","equiprobable"];var lS={start:new Z,end:new Z,endInclusive:new G,state:new Z({constrainTo:oS})},dS=new V({facetId:jg,field:Rg,generateAutomaticRanges:_g,filterFacetCount:Mg,injectionDepth:Eg,numberOfValues:Pg,currentValues:new re({each:new ee({values:lS})}),sortCriteria:new Z({constrainTo:uS}),rangeAlgorithm:new Z({constrainTo:cS})});function fS(e,t){Vt(e,dS,t,"buildDateFacet"),np(t)}function hS(e,t){if(!gS(e));sS(t.options,"buildDateFacet");let r=e.dispatch,n=Ib(e,t.options),i={currentValues:[],...t.options,facetId:n};fS(e,i),r(ip(i));let a=aS(e,{facetId:n,getRequest:()=>e.state.dateFacetSet[n].request});return{...a,toggleSelect:e=>r(nS({facetId:n,selection:e})),toggleSingleSelect:function(e){e.state==="idle"&&r(Gg(n)),this.toggleSelect(e)},toggleExclude:e=>r(iS({facetId:n,selection:e})),toggleSingleExclude:function(e){e.state==="idle"&&r(Gg(n)),this.toggleExclude(e)},get state(){return a.state}}}function gS(e){return e.addReducers({configuration:$f,search:wf,dateFacetSet:fy,facetOptions:mw}),!0}function pS(e,t){let r=hS(e,t),n=e.dispatch,i=()=>r.state.facetId;return{...r,deselectAll(){r.deselectAll(),n(jl({legacy:Nh(i()),next:Bv()}))},sortBy(e){r.sortBy(e),n(jl({legacy:Bh({facetId:i(),sortCriterion:e}),next:Lv()}))},toggleSelect:e=>{r.toggleSelect(e),n(jl({legacy:Xb(i(),e),next:Zb(e)}))},get state(){return r.state}}}var yS={facetId:_h,selection:new ee({values:Kh})},vS=Qn("numericFacet/executeToggleSelect",((e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,yS),t(gp(e)),t(eS(e)),t(Jp())}));Qn("numericFacet/executeToggleExclude",((e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,yS),t(pp(e)),t(tS(e)),t(Jp())}));var mS={start:new z,end:new z,endInclusive:new G,state:new Z({constrainTo:oS})},wS=new V({facetId:jg,field:Rg,generateAutomaticRanges:_g,filterFacetCount:Mg,injectionDepth:Eg,numberOfValues:Pg,currentValues:new re({each:new ee({values:mS})}),sortCriteria:new Z({constrainTo:uS}),resultsMustMatch:new Z({constrainTo:Lb}),rangeAlgorithm:new Z({constrainTo:cS})});function bS(e,t){Vt(e,wS,t,"buildNumericFacet"),fp(t)}function SS(e){return{endInclusive:!1,state:"idle",...e}}function IS(e,t){if(!OS(e));sS(t.options,"buildNumericFacet");let r=e.dispatch,n=Ib(e,t.options),i={currentValues:[],...t.options,facetId:n};bS(e,i),r(hp(i));let a=aS(e,{facetId:n,getRequest:()=>e.state.numericFacetSet[n].request});return{...a,toggleSelect:e=>r(vS({facetId:n,selection:e})),toggleSingleSelect(e){e.state==="idle"&&r(Gg(n)),this.toggleSelect(e)},get state(){return a.state}}}function OS(e){return e.addReducers({numericFacetSet:yy,facetOptions:mw,configuration:$f,search:wf}),!0}function AS(e,t){let r=IS(e,t),n=e.dispatch,i=()=>r.state.facetId;return{...r,deselectAll(){r.deselectAll(),n(jl({legacy:Nh(i()),next:Bv()}))},sortBy(e){r.sortBy(e),n(jl({legacy:Bh({facetId:i(),sortCriterion:e}),next:Lv()}))},toggleSelect:e=>{r.toggleSelect(e),n(jl({legacy:Xb(i(),e),next:Zb(e)}))},get state(){return{...r.state}}}}function qS(e,t){if(!CS(e));let r=Cv(e),{dispatch:n}=e,i=()=>e.state,a=Ib(e,t.options),s={...t.options,currentValues:t.initialState?.range?[{...t.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:a};bS(e,s),n(hp(s));let o=()=>ww(e.state,a);return{...r,clear:()=>{n(yp({facetId:a,values:[]})),n(Jp())},setRange:e=>{let t={...e,state:"selected",numberOfResults:0,endInclusive:!0},r=yp({facetId:a,values:[t]});return r.error?!1:(n(r),n(Jp()),!0)},enable(){n(Kp(a))},disable(){n(Zp(a))},get state(){let e=vo(i()),t=o(),r=gm(i(),a),n=r.length?r[0]:void 0;return{facetId:a,isLoading:e,range:n,enabled:t}}}}function CS(e){return e.addReducers({numericFacetSet:yy,facetOptions:mw,configuration:$f,search:wf}),!0}function kS(e,t){let r=qS(e,t),{dispatch:n}=e,i=()=>r.state.facetId;return{...r,clear:()=>{r.clear(),n(jl({legacy:Nh(i()),next:Bv()}))},setRange:e=>{let t=r.setRange(e);return t&&n(jl({legacy:zh({facetId:i(),facetValue:`${e.start}..${e.end}`}),next:Nv()})),t},get state(){return{...r.state}}}}function xS(e,t){if(!jS(e));let r=Cv(e),{dispatch:n}=e,i=()=>e.state,a=Ib(e,t.options),s={...t.options,currentValues:t.initialState?.range?[{...t.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:a};fS(e,s),n(ip(s));let o=()=>ww(e.state,a);return{...r,clear:()=>{n(op({facetId:a,values:[]})),n(Jp())},setRange:e=>{let t={...e,state:"selected",numberOfResults:0,endInclusive:!0},r=op({facetId:a,values:[t]});return r.error?!1:(n(r),n(Jp()),!0)},enable(){n(Kp(a))},disable(){n(Zp(a))},get state(){let e=vo(i()),t=o(),r=um(i(),a),n=r.length?r[0]:void 0;return{facetId:a,isLoading:e,range:n,enabled:t}}}}function jS(e){return e.addReducers({dateFacetSet:fy,facetOptions:mw,configuration:$f,search:wf}),!0}function RS(e,t){if(!FS(e));let r=xS(e,t),{dispatch:n}=e,i=()=>r.state.facetId;return{...r,clear:()=>{r.clear(),n(jl({legacy:Nh(i()),next:Bv()}))},setRange:e=>{let t=r.setRange(e);return t&&n(jl({legacy:zh({facetId:i(),facetValue:`${e.start}..${e.end}`}),next:Nv()})),t},get state(){return{...r.state}}}}function FS(e){return e.addReducers({dateFacetSet:fy,configuration:$f,search:wf}),!0}var TS=new V({numberOfPages:new z({default:5,min:0})}),DS=new V({page:new z({min:1})});function MS(e,t={}){if(!ES(e));let r=Cv(e),{dispatch:n}=e,i=Vt(e,TS,t.options,"buildPager"),a=Ut(e,DS,t.initialState,"buildPager").page;a&&n(Gl(a));let s=()=>$p(e.state),o=()=>{let{numberOfPages:t}=i;return Vp(e.state,t)},u=()=>Up(e.state);return{...r,get state(){let e=s(),t=u(),r=e>1&&t>0,n=e<t;return{currentPage:e,currentPages:o(),maxPage:t,hasPreviousPage:r,hasNextPage:n}},selectPage(e){n(Wl(e))},nextPage(){n(Jl())},previousPage(){n(Kl())},isCurrentPage(e){return e===this.state.currentPage}}}function ES(e){return e.addReducers({configuration:$f,pagination:xp}),!0}function PS(e,t={}){let{dispatch:r}=e,n=MS(e,t);return{...n,get state(){return n.state},selectPage(e){n.selectPage(e),r(Rl({legacy:zp(),next:Rm()}))},nextPage(){n.nextPage(),r(Rl({legacy:Hp(),next:xm()}))},previousPage(){n.previousPage(),r(Rl({legacy:Yp(),next:jm()}))}}}function _S(e){if(!$S(e));let t=Cv(e),r=()=>e.state;return{...t,get state(){let e=r();return{hasError:e.search.error!==null,isLoading:e.search.isLoading,hasResults:!!e.search.results.length,firstSearchExecuted:hf(e)}}}}function $S(e){return e.addReducers({search:wf}),!0}function US(e){if(!VS(e));let t=Cv(e),r=_S(e),n=()=>e.state,i=()=>{let e=n().search.duration/1e3;return Math.round((e+Number.EPSILON)*100)/100};return{...t,get state(){return{...r.state,durationInMilliseconds:n().search.duration,durationInSeconds:i(),firstResult:n().pagination.firstResult+1,hasDuration:n().search.duration!==0,hasQuery:n().search.queryExecuted!=="",lastResult:n().pagination.firstResult+n().search.results.length,query:n().search.queryExecuted,total:n().pagination.totalCountFiltered}}}}function VS(e){return e.addReducers({search:wf,pagination:xp}),!0}function QS(e){return US(e)}var LS=new V({fieldsToInclude:new re({required:!1,each:new Z({required:!0,emptyAllowed:!1})})});function BS(e,t){if(!NS(e));let r=Cv(e),n=_S(e),{dispatch:i}=e,a=()=>e.state,s=Vt(e,LS,t?.options,"buildCoreResultList");s.fieldsToInclude&&i($y(s.fieldsToInclude));let o=()=>e.state.search.results.length<e.state.search.response.totalCountFiltered,u=0,c=0,l=5,d=200,f=!1;return{...r,get state(){let e=a();return{...n.state,results:e.search.results,moreResultsAvailable:o(),searchResponseId:e.search.searchResponseId}},fetchMoreResults:async()=>{if(e.state.search.isLoading)return;if(!o()){e.logger.info("No more results are available for the result list to fetch.");return}if(Date.now()-u<d){if(c++,c>=l){u=Date.now(),!f&&e.logger.error(`The result list method "fetchMoreResults" execution prevented because it has been triggered consecutively ${l} times, with little delay. Please verify the conditions under which the function is called.`),f=!0;return}}else c=0;f=!1,t?.fetchMoreResultsActionCreator&&(await i(t?.fetchMoreResultsActionCreator()),u=Date.now())}}}function NS(e){return e.addReducers({search:wf,configuration:$f,fields:Ny}),!0}function zS(e,t){return BS(e,{...t,fetchMoreResultsActionCreator:Fl})}var HS=e=>Au("showMoreFoldedResults")("analytics/folding/showMore",((t,r)=>(Eu(e),t.logShowMoreFoldedResults(Cu(e,r),xu(e),il(r.insightCaseContext))))),YS=()=>Au("showLessFoldedResults")("analytics/folding/showLess",((e,t)=>e.logShowLessFoldedResults(il(t.insightCaseContext)))),GS={logShowMoreFoldedResults:HS,logShowLessFoldedResults:YS};mn("folding/register",(e=>$t(e,Dy)));var WS=Qn("folding/loadCollection",(async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let i=t(),a=await fl(i,e),s=(await xl(n,i,a,{origin:"foldingCollection"})).response;return mt(s)?r(s.error):{collectionId:e,results:s.success.results,rootResult:i.folding.collections[e].result}}));var JS=Tn(Ko(),(e=>e.addCase(rl,((e,t)=>({...e,...t.payload}))).addCase(Ec,((e,t)=>{e.q=t.payload})).addCase(Ih,((e,t)=>{e.q=t.payload.expression})).addCase(Bc.fulfilled,((e,t)=>t.payload?.query??e)).addCase(kf,((e,t)=>{e.q=t.payload.q??e.q,e.enableQuerySyntax=t.payload.enableQuerySyntax??e.enableQuerySyntax}))));var KS=new V(Dy);function ZS(e,t,r){if(!XS(e));let n=BS(e,t),{dispatch:i}=e,a=()=>e.state,s=t.options?.folding?Vt(e,KS,t.options.folding,"buildFoldedResultList"):{};return i(My({...s})),{...n,loadCollection:n=>{i(t.loadCollectionActionCreator(n.result.raw[e.state.folding.fields.collection])),i(r.logShowMoreFoldedResults(n.result))},logShowMoreFoldedResults:e=>{i(r.logShowMoreFoldedResults(e))},logShowLessFoldedResults:()=>{i(r.logShowLessFoldedResults())},findResultById(e){return eI(this.state.results,(t=>t.result.uniqueId===e.result.uniqueId))},findResultByCollection(e){return eI(this.state.results,(t=>t.result.raw.foldingcollection===e.result.raw.foldingcollection))},get state(){let e=a();return{...n.state,results:n.state.results.map((t=>{let r=t.raw[e.folding.fields.collection];return!r||!e.folding.collections[r]?{result:t,moreResultsAvailable:!1,isLoadingMoreResults:!1,children:[]}:e.folding.collections[r]}))}}}}function XS(e){return e.addReducers({search:wf,configuration:_f,folding:qv,query:JS}),!0}function eI(e,t){for(let r=0;r<e.length;r++){let n=e[r];if(t(n))return n;if(n.children.length){let e=eI(n.children,t);if(e)return e}}return null}function tI(e,t={}){let r=ZS(e,{...t,loadCollectionActionCreator:WS,fetchMoreResultsActionCreator:Fl},GS);return{...r,get state(){return r.state}}}var rI=e=>Au("documentOpen")({prefix:"analytics/insight/result/open",__legacy__getBuilder:(t,r)=>{Eu(e);let n=il(r.insightCaseContext);return t.logDocumentOpen(Cu(e,r),xu(e),n)},analyticsType:"InsightPanel.ItemAction",analyticsPayloadBuilder:t=>{let r=Cu(e,t);return{itemMetadata:Uu(e,t),position:r.documentPosition,searchUid:t.search?.response.searchUid||"",action:"open",context:Gp(t)}}});function nI(e,t,r){if(!iI(e));let n=1e3,i={selectionDelay:n,debounceWait:n,...t.options},a;return{select:Hf(r,i.debounceWait,{isImmediate:!0}),beginDelayedSelect(){a=setTimeout(r,i.selectionDelay)},cancelPendingSelect(){a&&clearTimeout(a)}}}function iI(e){return e.addReducers({configuration:$f}),!0}function aI(e,t){let r=!1,n=()=>{r||(r=!0,e.dispatch(rI(t.options.result)))};return nI(e,t,(()=>{n(),e.dispatch(Iy(t.options.result))}))}var sI=new V({numberOfResults:new z({min:0})});function oI(e,t={}){if(!uI(e));let r=Cv(e),{dispatch:n}=e,i=()=>e.state,a=Ut(e,sI,t.initialState,"buildResultsPerPage").numberOfResults;return a!==void 0&&n(Hl(a)),{...r,get state(){return{numberOfResults:i().pagination.numberOfResults}},set(e){n(Yl(e))},isSetTo(e){return e===this.state.numberOfResults}}}function uI(e){return e.addReducers({pagination:xp,configuration:$f}),!0}function cI(e,t={}){let r=oI(e,t),{dispatch:n}=e;return{...r,get state(){return{...r.state}},set(e){r.set(e),n(jl({legacy:Cm(),next:km()}))}}}var lI=e=>Ou("analytics/querySuggest",((t,r)=>{let n=fI(r,e);return t.makeOmniboxAnalytics(n)})),dI=()=>({actionCause:"omniboxAnalytics"});function fI(e,t){let{id:r,suggestion:n}=t,i=e.querySuggest&&e.querySuggest[r];if(!i)throw new Error(`Unable to determine the query suggest analytics metadata to send because no query suggest with id "${r}" was found. Please check the sent #id.`);let a=i.completions.map((e=>e.expression)),s=i.partialQueries.length-1,o=i.partialQueries[s]||"",u=i.responseId;return{suggestionRanking:a.indexOf(n),partialQuery:o,partialQueries:i.partialQueries,suggestions:a,querySuggestResponseId:u}}var hI=()=>({});var gI=Tn(hI(),(e=>e.addCase(bh,((e,t)=>{let r=t.payload.id;r in e||(e[r]=pI(t.payload))})).addCase(Sh,((e,t)=>{delete e[t.payload.id]})).addCase(Ah.pending,yI).addCase(Ah.fulfilled,((e,t)=>{let r=e[t.meta.arg.id];if(!r||t.meta.requestId!==r.currentRequestId)return;let{q:n}=t.payload;n&&r.partialQueries.push(n.replace(/;/,encodeURIComponent(";"))),r.responseId=t.payload.responseId,r.completions=t.payload.completions,r.isLoading=!1,r.error=null})).addCase(Ah.rejected,vI).addCase(Qw.pending,yI).addCase(Qw.fulfilled,((e,t)=>{let r=e[t.meta.arg.id];if(!r||t.meta.requestId!==r.currentRequestId)return;let{query:n}=t.payload;n&&r.partialQueries.push(n.replace(/;/,encodeURIComponent(";"))),r.responseId=t.payload.responseId,r.completions=t.payload.completions.map((e=>({expression:e.expression,highlighted:e.highlighted,score:0,executableConfidence:0}))),r.isLoading=!1,r.error=null})).addCase(Qw.rejected,vI).addCase(Oh,((e,t)=>{let r=e[t.payload.id];r&&(r.responseId="",r.completions=[],r.partialQueries=[])}))));function pI(e){return{id:"",completions:[],responseId:"",count:5,currentRequestId:"",error:null,partialQueries:[],isLoading:!1,...e}}function yI(e,t){let r=e[t.meta.arg.id];r&&(r.currentRequestId=t.meta.requestId,r.isLoading=!0)}function vI(e,t){let r=e[t.meta.arg.id];r&&(r.error=t.payload||null,r.isLoading=!1)}var mI={enableQuerySyntax:!1,numberOfSuggestions:5,clearFilters:!0},wI={open:new Z,close:new Z},bI={id:Rt,numberOfSuggestions:new z({min:0}),enableQuerySyntax:new G,highlightOptions:new ee({values:{notMatchDelimiters:new ee({values:wI}),exactMatchDelimiters:new ee({values:wI}),correctionDelimiters:new ee({values:wI})}}),clearFilters:new G},SI=new V(bI);function II(e,t){if(!AI(e));let r=Cv(e),{dispatch:n}=e,i=()=>e.state,a=t.options?.id||se("search_box"),s={id:a,highlightOptions:{...t.options?.highlightOptions},...mI,...t.options};Vt(e,SI,s,"buildSearchBox"),n(Fh({id:a,query:e.state.query.q})),s.numberOfSuggestions&&n(bh({id:a,count:s.numberOfSuggestions}));let o=()=>e.state.querySet[s.id],u=async e=>{let{enableQuerySyntax:r,clearFilters:i}=s;n(Dd({q:o(),enableQuerySyntax:r,clearFilters:i})),t.isNextAnalyticsReady?n(t.executeSearchActionCreator(e)):n(t.executeSearchActionCreator(e.legacy))};return{...r,updateText(e){n(Th({id:a,query:e})),this.showSuggestions()},clear(){n(Th({id:a,query:""})),n(Oh({id:a}))},showSuggestions(){s.numberOfSuggestions&&n(t.fetchQuerySuggestionsActionCreator({id:a}))},selectSuggestion(e){n(Ih({id:a,expression:e})),u({legacy:lI({id:a,suggestion:e}),next:dI()}).then((()=>{n(Oh({id:a}))}))},submit(e=qm(),t){u({legacy:e,next:t}),n(Oh({id:a}))},get state(){let e=i(),t=e.querySuggest[s.id],r=OI(t,s.highlightOptions),n=t?t.isLoading:!1;return{value:o(),suggestions:r,isLoading:e.search.isLoading,isLoadingSuggestions:n}}}}function OI(e,t){return e?e.completions.map((e=>({highlightedValue:we(e.highlighted,t),rawValue:e.expression}))):[]}function AI(e){return e.addReducers({query:JS,querySuggest:gI,configuration:$f,querySet:Dh,search:wf}),!0}function qI(e,t={}){let r=II(e,{...t,executeSearchActionCreator:jl,fetchQuerySuggestionsActionCreator:Dl,isNextAnalyticsReady:!0});return{...r,submit(){r.submit(Fm())},get state(){return r.state}}}function CI(e){return _S(e)}var kI={by:new ie({enum:nu,required:!0})},xI=mn("sortCriteria/register",(e=>RI(e))),jI=mn("sortCriteria/update",(e=>RI(e))),RI=e=>ne(e)?(e.forEach((e=>$t(e,kI))),{payload:e}):$t(e,kI);Tn(su(),(e=>{e.addCase(xI,((e,t)=>iu(t.payload))).addCase(jI,((e,t)=>iu(t.payload))).addCase(Bc.fulfilled,((e,t)=>t.payload?.sortCriteria??e)).addCase(kf,((e,t)=>t.payload.sortCriteria??e))}));var FI=Tn(el(),(e=>{e.addCase(xf,((e,t)=>{let r=t.payload,{id:n}=r;n in e||(e[n]={...r,isActive:!1})})).addCase(jf,((e,t)=>{let r=t.payload;TI(e,r)})).addCase(kf,((e,t)=>{let r=t.payload.tab||"";TI(e,r)})).addCase(Bc.fulfilled,((e,t)=>t.payload?.tabSet??e))}));function TI(e,t){t in e&&Object.keys(e).forEach((r=>{e[r].isActive=r===t}))}var DI=new V({expression:Tt,id:Rt}),MI=new V({isActive:new G});function EI(e,t){if(_I(t.options.id),!PI(e));let r=Cv(e),{dispatch:n}=e;Vt(e,DI,t.options,"buildTab");let i=Ut(e,MI,t.initialState,"buildTab"),{id:a,expression:s}=t.options;return n(xf({id:a,expression:s})),i.isActive&&n(jf(a)),{...r,select(){n(jf(a))},get state(){return{isActive:e.state.tabSet[a]?.isActive}}}}function PI(e){return e.addReducers({configuration:$f,tabSet:FI}),!0}function _I(e){let t=Ef().analytics.originLevel2;if(e===t)throw new Error(`The #id option on the Tab controller cannot use the reserved value "${t}". Please specify a different value.`)}function $I(e,t){let{dispatch:r}=e,n=EI(e,t),i=()=>r(jl({legacy:ul(),next:Qu()}));return{...n,get state(){return n.state},select(){n.select(),i()}}}function UI(e,t){if(!VI(e));let r=t=>e.state.facetOptions.facets[t]?.enabled??!1,n=t=>e.state.facetSet?.[t]?.request?.currentValues??e.state.categoryFacetSet?.[t]?.request?.currentValues??e.state.numericFacetSet?.[t]?.request?.currentValues??e.state.dateFacetSet?.[t]?.request?.currentValues??null,i=t=>t in e.state.facetOptions.facets,a=()=>fe({isFacetRegistered:i(t.facetId),parentFacets:t.conditions.map((({parentFacetId:e})=>i(e)?{enabled:r(e),values:n(e)}:null))}),s=()=>{let e=a();return e===l?!1:(l=e,!0)},o=()=>t.conditions.some((e=>{if(!r(e.parentFacetId))return!1;let t=n(e.parentFacetId);return t===null?!1:e.condition(t)})),u=()=>{e.state.facetSet&&Object.entries(e.state.facetSet).forEach((([t,r])=>r.request.freezeCurrentValues&&e.dispatch(Zg({facetId:t,freezeCurrentValues:!1}))))},c=()=>{if(!i(t.facetId))return;let n=r(t.facetId),a=o();n!==a&&(e.dispatch(a?Kp(t.facetId):Zp(t.facetId)),u())};if(!t.conditions.length)return{stopWatching(){}};let l=a(),d=e.subscribe((()=>{s()&&c()}));return c(),{stopWatching(){d()}}}function VI(e){return e.addReducers({facetOptions:mw}),!0}function QI(e,t){return UI(e,t)}function LI(e,t){let r=t??e.search?.questionAnswer?.documentId;return r&&e.search&&gf(e,r.contentIdKey,r.contentIdValue)}function BI(e,t){let r=e.questionAnswering?.relatedQuestions.findIndex((e=>e.questionAnswerId===t))??-1;return r===-1?null:e.search?.questionAnswer?.relatedQuestions?.[r]??null}var NI=()=>Au("expandSmartSnippet")({prefix:"analytics/smartSnippet/expand",__legacy__getBuilder:(e,t)=>e.logExpandSmartSnippet(il(t.insightCaseContext)),analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"expand",answer:{responseId:e.search?.response.searchUid||"",type:"SmartSnippet"}})}),zI=()=>Au("collapseSmartSnippet")({prefix:"analytics/smartSnippet/collapse",__legacy__getBuilder:(e,t)=>e.logCollapseSmartSnippet(il(t.insightCaseContext)),analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"collapse",answer:{responseId:e.search?.response.searchUid||"",type:"SmartSnippet"}})}),HI=()=>Au("likeSmartSnippet")({prefix:"analytics/smartSnippet/like",__legacy__getBuilder:(e,t)=>e.logLikeSmartSnippet(il(t.insightCaseContext)),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>({answer:{responseId:e.search?.response.searchUid||"",type:"SmartSnippet"},feedback:{liked:!0}})}),YI=()=>Au("dislikeSmartSnippet")({prefix:"analytics/smartSnippet/dislike",__legacy__getBuilder:(e,t)=>e.logDislikeSmartSnippet(il(t.insightCaseContext)),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>({answer:{responseId:e.search?.response.searchUid||"",type:"SmartSnippet"},feedback:{liked:!1}})}),GI=()=>Au("openSmartSnippetSource")({prefix:"analytics/smartSnippet/source/open",__legacy__getBuilder:(e,t)=>{let r=LI(t);return e.logOpenSmartSnippetSource(Cu(r,t),xu(r),il(t.insightCaseContext))},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:e=>{let t=LI(e),r=xu(t);return{answer:{responseId:e.search?.response.searchUid||"",type:"SmartSnippet"},citation:{id:r.contentIDValue,type:"Source"}}}}),WI=e=>Au("openSmartSnippetSource")({prefix:"analytics/smartSnippet/source/open",__legacy__getBuilder:(t,r)=>{$t(e,ev());let n=LI(r);return t.logOpenSmartSnippetInlineLink(Cu(n,r),{...xu(n),...e},il(r.insightCaseContext))},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:e=>{let t=LI(e),r=xu(t);return{answer:{responseId:e.search?.response.searchUid||"",type:"SmartSnippet"},citation:{id:r.contentIDValue,type:"InlineLink"}}}}),JI=()=>Au("openSmartSnippetFeedbackModal")("analytics/smartSnippet/feedbackModal/open",((e,t)=>e.logOpenSmartSnippetFeedbackModal(il(t.insightCaseContext)))),KI=()=>Au("closeSmartSnippetFeedbackModal")("analytics/smartSnippet/feedbackModal/close",((e,t)=>e.logCloseSmartSnippetFeedbackModal(il(t.insightCaseContext)))),ZI=e=>Au("sendSmartSnippetReason")({prefix:"analytics/smartSnippet/sendFeedback",__legacy__getBuilder:(t,r)=>t.logSmartSnippetFeedbackReason(e,void 0,il(r.insightCaseContext)),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>({answer:{responseId:t.search?.response.searchUid||"",type:"SmartSnippet"},feedback:{liked:!1,reason:e}})}),XI=e=>Au("sendSmartSnippetReason")({prefix:"analytics/smartSnippet/sendFeedback",__legacy__getBuilder:(t,r)=>t.logSmartSnippetFeedbackReason("other",e,il(r.insightCaseContext)),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>({answer:{responseId:t.search?.response.searchUid||"",type:"SmartSnippet"},feedback:{liked:!1,reason:"other",details:e}})}),eO=e=>Au("expandSmartSnippetSuggestion")({prefix:"analytics/smartSnippetSuggestion/expand",__legacy__getBuilder:(t,r)=>{tv(e);let n=BI(r,e.questionAnswerId);return n?t.logExpandSmartSnippetSuggestion({question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId},il(r.insightCaseContext)):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"expand",answer:{responseId:e.search?.response.searchUid||"",type:"SmartSnippetSuggestion"}})}),tO=e=>Au("collapseSmartSnippetSuggestion")({prefix:"analytics/smartSnippetSuggestion/collapse",__legacy__getBuilder:(t,r)=>{tv(e);let n=BI(r,e.questionAnswerId);return n?t.logCollapseSmartSnippetSuggestion({question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId},il(r.insightCaseContext)):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"collapse",answer:{responseId:e.search?.response.searchUid||"",type:"SmartSnippetSuggestion"}})}),rO=e=>Au("openSmartSnippetSuggestionSource")({prefix:"analytics/smartSnippetSuggestion/source/open",__legacy__getBuilder:(t,r)=>{$t(e,Xy());let n=BI(r,e.questionAnswerId);if(!n)return null;let i=LI(r,n.documentId);return i?t.logOpenSmartSnippetSuggestionSource(Cu(i,r),{question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId},il(r.insightCaseContext)):null},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:t=>{let r=BI(t,e.questionAnswerId);return{answer:{responseId:t.search?.response.searchUid||"",type:"SmartSnippetSuggestion"},citation:{id:r?.documentId.contentIdValue||"",type:"Source"}}}}),nO=(e,t)=>Au("openSmartSnippetSuggestionSource")({prefix:"analytics/smartSnippetSuggestion/source/open",__legacy__getBuilder:(r,n)=>{$t(e,Xy()),$t(t,ev());let i=BI(n,e.questionAnswerId);if(!i)return null;let a=LI(n,i.documentId);return a?r.logOpenSmartSnippetSuggestionInlineLink(Cu(a,n),{question:i.question,answerSnippet:i.answerSnippet,documentId:i.documentId,linkText:t.linkText,linkURL:t.linkURL},il(n.insightCaseContext)):null},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:t=>{let r=BI(t,e.questionAnswerId);return{answer:{responseId:t.search?.response.searchUid||"",type:"SmartSnippetSuggestion"},citation:{id:r?.documentId.contentIdValue||"",type:"InlineLink"}}}}),iO={logExpandSmartSnippet:NI,logCollapseSmartSnippet:zI,logLikeSmartSnippet:HI,logDislikeSmartSnippet:YI,logOpenSmartSnippetSource:GI,logOpenSmartSnippetInlineLink:WI,logOpenSmartSnippetFeedbackModal:JI,logCloseSmartSnippetFeedbackModal:KI,logSmartSnippetFeedback:ZI,logSmartSnippetDetailedFeedback:XI,logExpandSmartSnippetSuggestion:eO,logCollapseSmartSnippetSuggestion:tO,logOpenSmartSnippetSuggestionSource:rO};function aO(e,t,r){if(!sO(e));let n=Cv(e),i=()=>e.state,a=()=>LI(i()),s=null,o=nI(e,{options:{selectionDelay:r?.options?.selectionDelay}},(()=>{let r=a();if(!r){s=null;return}let{searchResponseId:n}=i().search;s!==n&&(s=n,e.dispatch(t.logOpenSmartSnippetSource()),e.dispatch(Iy(r)))}));return{...n,get state(){let e=i();return{question:e.search.questionAnswer.question,answer:e.search.questionAnswer.answerSnippet,documentId:e.search.questionAnswer.documentId,expanded:e.questionAnswering.expanded,answerFound:e.search.questionAnswer.answerSnippet!=="",liked:e.questionAnswering.liked,disliked:e.questionAnswering.disliked,feedbackModalOpen:e.questionAnswering.feedbackModalOpen,source:a()}},expand(){e.dispatch(t.logExpandSmartSnippet()),e.dispatch(rv())},collapse(){e.dispatch(t.logCollapseSmartSnippet()),e.dispatch(nv())},like(){e.dispatch(t.logLikeSmartSnippet()),e.dispatch(iv())},dislike(){e.dispatch(t.logDislikeSmartSnippet()),e.dispatch(av())},openFeedbackModal(){e.dispatch(t.logOpenSmartSnippetFeedbackModal()),e.dispatch(sv())},closeFeedbackModal(){e.dispatch(t.logCloseSmartSnippetFeedbackModal()),e.dispatch(ov())},sendFeedback(r){e.dispatch(t.logSmartSnippetFeedback(r)),e.dispatch(ov())},sendDetailedFeedback(r){e.dispatch(t.logSmartSnippetDetailedFeedback(r)),e.dispatch(ov())},selectSource(){o.select()},beginDelayedSelectSource(){o.beginDelayedSelect()},cancelPendingSelectSource(){o.cancelPendingSelect()}}}function sO(e){return e.addReducers({search:wf,questionAnswering:gv}),!0}function oO(e,t){if(!uO(e));let r=()=>e.state,n=new Set,i=e=>n.has(e)?!0:(n.add(e),!1),a=null,s=e=>{a!==e&&(a=e,u={},n.clear())},o=(r,n,a)=>nI(e,{options:{selectionDelay:t?.options?.selectionDelay}},(()=>{i(n)||e.dispatch(a?nO({questionAnswerId:a},r):WI(r))})),u={},c=(e,t)=>{let{searchResponseId:n}=r().search;s(n);let i=fe({...e,questionAnswerId:t});return i in u||(u[i]=o(e,i,t)),u[i]};return{selectInlineLink(e,t){c(e,t)?.select()},beginDelayedSelectInlineLink(e,t){c(e,t)?.beginDelayedSelect()},cancelPendingSelectInlineLink(e,t){c(e,t)?.cancelPendingSelect()}}}function uO(e){return e.addReducers({search:wf,questionAnswering:gv}),!0}function cO(e,t){let r=aO(e,iO,t),n=oO(e,{options:{selectionDelay:t?.options?.selectionDelay}});return{...r,get state(){return r.state},selectInlineLink(e){n.selectInlineLink(e)},beginDelayedSelectInlineLink(e){n.beginDelayedSelectInlineLink(e)},cancelPendingSelectInlineLink(e){n.cancelPendingSelectInlineLink(e)}}}function lO(e,t){if(!dO(e));let r=Cv(e),n=()=>e.state,i=t=>{let{contentIdKey:r,contentIdValue:n}=t;return e.state.search.results.find((e=>ff(e,r)===n))};return{...r,get state(){let e=n();return{questions:e.search.questionAnswer.relatedQuestions.map(((t,r)=>({question:t.question,answer:t.answerSnippet,documentId:t.documentId,questionAnswerId:e.questionAnswering.relatedQuestions[r].questionAnswerId,expanded:e.questionAnswering.relatedQuestions[r].expanded,source:i(t.documentId)})))}},expand(r){let n={questionAnswerId:r};e.dispatch(t.logExpandSmartSnippetSuggestion(n)),e.dispatch(uv(n))},collapse(r){let n={questionAnswerId:r};e.dispatch(t.logCollapseSmartSnippetSuggestion(n)),e.dispatch(cv(n))}}}function dO(e){return e.addReducers({search:wf,questionAnswering:gv}),!0}function fO(e,t){if(!hO(e));let r=()=>e.state,n=e=>{let t=r(),n=BI(t,e);return n?LI(t,n.documentId):null},i=new Set,a=e=>i.has(e)?!0:(i.add(e),!1),s=null,o=e=>{s!==e&&(s=e,c={},i.clear())},u=(r,n)=>nI(e,{options:{selectionDelay:t?.options?.selectionDelay}},(()=>{a(n)||(e.dispatch(rO({questionAnswerId:n})),e.dispatch(Iy(r)))})),c={},l=e=>{let{searchResponseId:t}=r().search;o(t);let i=n(e);return i?(e in c||(c[e]=u(i,e)),c[e]):null};return{selectSource(e){l(e)?.select()},beginDelayedSelectSource(e){l(e)?.beginDelayedSelect()},cancelPendingSelectSource(e){l(e)?.cancelPendingSelect()}}}function hO(e){return e.addReducers({search:wf,questionAnswering:gv}),!0}function gO(e,t){let r=lO(e,iO),n=oO(e,{options:{selectionDelay:t?.options?.selectionDelay}}),i=fO(e,{options:{selectionDelay:t?.options?.selectionDelay}});return{...r,get state(){return r.state},selectSource(e){i.selectSource(e)},beginDelayedSelectSource(e){i.beginDelayedSelectSource(e)},cancelPendingSelectSource(e){i.cancelPendingSelectSource(e)},selectInlineLink(e,t){n.selectInlineLink(t,e)},beginDelayedSelectInlineLink(e,t){n.beginDelayedSelectInlineLink(t,e)},cancelPendingSelectInlineLink(e,t){n.cancelPendingSelectInlineLink(t,e)}}}function pO(e,t){return e.generatedAnswer?.citations?.find((e=>e.id===t))}function yO(e){return e.search?.response?.extendedResults?.generativeQuestionAnsweringId}var vO=e=>Ou("analytics/generatedAnswer/streamEnd",((t,r)=>{let n=yO(r),i=e?!r.generatedAnswer?.answer||!r.generatedAnswer?.answer.length:void 0;return n?t.makeGeneratedAnswerStreamEnd({generativeQuestionAnsweringId:n,answerGenerated:e,answerTextIsEmpty:i}):null}));var mO=()=>({actionCause:"retryGeneratedAnswer"}),wO=()=>({actionCause:"rephraseGeneratedAnswer"});var bO="RGA",SO=()=>Au("retryGeneratedAnswer")("analytics/generatedAnswer/retry",((e,t)=>e.logRetryGeneratedAnswer(il(t.insightCaseContext)))),IO=e=>Au("rephraseGeneratedAnswer")("analytics/generatedAnswer/rephrase",((t,r)=>{let n=yO(r);return n?t.logRephraseGeneratedAnswer({generativeQuestionAnsweringId:n,rephraseFormat:e.answerStyle},il(r.insightCaseContext)):null})),OO=e=>Au("openGeneratedAnswerSource")({prefix:"analytics/generatedAnswer/openAnswerSource",__legacy__getBuilder:(t,r)=>{let n=yO(r),i=pO(r,e);return!n||!i?null:t.logOpenGeneratedAnswerSource({generativeQuestionAnsweringId:n,permanentId:i.permanentid,citationId:i.id},il(r.insightCaseContext))},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:t=>({answer:{responseId:t.search?.response.searchUid||"",type:bO},citation:{id:e,type:"Source"}})}),AO=(e,t)=>Au("generatedAnswerSourceHover")({prefix:"analytics/generatedAnswer/hoverCitation",__legacy__getBuilder:(r,n)=>{let i=yO(n),a=pO(n,e);return!i||!a?null:r.logGeneratedAnswerSourceHover({generativeQuestionAnsweringId:i,permanentId:a.permanentid,citationId:a.id,citationHoverTimeMs:t},il(n.insightCaseContext))},analyticsType:"Qna.CitationHover",analyticsPayloadBuilder:r=>({answer:{responseId:r.search?.response.searchUid||"",type:bO},citation:{id:e,type:"Source"},citationHoverTimeInMs:t})}),qO=()=>Au("likeGeneratedAnswer")({prefix:"analytics/generatedAnswer/like",__legacy__getBuilder:(e,t)=>{let r=yO(t);return r?e.logLikeGeneratedAnswer({generativeQuestionAnsweringId:r},il(t.insightCaseContext)):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>({answer:{responseId:e.search?.response.searchUid||"",type:bO},feedback:{liked:!0}})}),CO=()=>Au("dislikeGeneratedAnswer")({prefix:"analytics/generatedAnswer/dislike",__legacy__getBuilder:(e,t)=>{let r=yO(t);return r?e.logDislikeGeneratedAnswer({generativeQuestionAnsweringId:r},il(t.insightCaseContext)):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>({answer:{responseId:e.search?.response.searchUid||"",type:bO},feedback:{liked:!1}})}),kO=e=>Au("generatedAnswerFeedbackSubmit")({prefix:"analytics/generatedAnswer/sendFeedback",__legacy__getBuilder:(t,r)=>{let n=yO(r);return n?t.logGeneratedAnswerFeedbackSubmit({generativeQuestionAnsweringId:n,reason:e},il(r.insightCaseContext)):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>({answer:{responseId:t.search?.response.searchUid||"",type:bO},feedback:{liked:!1,reason:e}})}),xO=e=>Au("generatedAnswerFeedbackSubmit")({prefix:"analytics/generatedAnswer/sendFeedback",__legacy__getBuilder:(t,r)=>{let n=yO(r);return n?t.logGeneratedAnswerFeedbackSubmit({generativeQuestionAnsweringId:n,reason:"other",details:e},il(r.insightCaseContext)):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>({answer:{responseId:t.search?.response.searchUid||"",type:bO},feedback:{liked:!1,reason:"other",details:e}})}),jO=e=>Au("generatedAnswerStreamEnd")("analytics/generatedAnswer/streamEnd",((t,r)=>{let n=yO(r);return n?t.logGeneratedAnswerStreamEnd({generativeQuestionAnsweringId:n,answerGenerated:e},il(r.insightCaseContext)):null})),RO=()=>Au("generatedAnswerShowAnswers")({prefix:"analytics/generatedAnswer/show",__legacy__getBuilder:(e,t)=>{let r=yO(t);return r?e.logGeneratedAnswerShowAnswers({generativeQuestionAnsweringId:r},il(t.insightCaseContext)):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"show",answer:{responseId:e.search?.response.searchUid||"",type:bO}})}),FO=()=>Au("generatedAnswerHideAnswers")({prefix:"analytics/generatedAnswer/hide",__legacy__getBuilder:(e,t)=>{let r=yO(t);return r?e.logGeneratedAnswerHideAnswers({generativeQuestionAnsweringId:r},il(t.insightCaseContext)):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"hide",answer:{responseId:e.search?.response.searchUid||"",type:bO}})}),TO=()=>Au("generatedAnswerExpand")({prefix:"analytics/generatedAnswer/expand",__legacy__getBuilder:(e,t)=>{let r=yO(t);return r?e.logGeneratedAnswerExpand({generativeQuestionAnsweringId:r},il(t.insightCaseContext)):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"expand",answer:{responseId:e.search?.response.searchUid||"",type:bO}})}),DO=()=>Au("generatedAnswerCollapse")({prefix:"analytics/generatedAnswer/collapse",__legacy__getBuilder:(e,t)=>{let r=yO(t);return r?e.logGeneratedAnswerCollapse({generativeQuestionAnsweringId:r},il(t.insightCaseContext)):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"collapse",answer:{responseId:e.search?.response.searchUid||"",type:bO}})}),MO=()=>Au("generatedAnswerCopyToClipboard")({prefix:"analytics/generatedAnswer/copy",__legacy__getBuilder:(e,t)=>{let r=yO(t);return r?e.logGeneratedAnswerCopyToClipboard({generativeQuestionAnsweringId:r},il(t.insightCaseContext)):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"copyToClipboard",answer:{responseId:e.search?.response.searchUid||"",type:bO}})}),EO={logCopyGeneratedAnswer:MO,logGeneratedAnswerHideAnswers:FO,logGeneratedAnswerShowAnswers:RO,logGeneratedAnswerStreamEnd:jO,logGeneratedAnswerDetailedFeedback:xO,logGeneratedAnswerFeedback:kO,logDislikeGeneratedAnswer:CO,logLikeGeneratedAnswer:qO,logHoverCitation:AO,logOpenGeneratedAnswerSource:OO,logRetryGeneratedAnswer:SO,logRephraseGeneratedAnswer:IO,logGeneratedAnswerExpand:TO,logGeneratedAnswerCollapse:DO};var PO=async e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.platformUrl,streamId:e.search.extendedResults?.generativeQuestionAnsweringId});var _O=["default","bullet","step","concise"],$O=["text/plain","text/markdown"];var UO=new Z({required:!0}),VO=new Z,QO=new G({required:!0}),LO={id:UO,title:UO,uri:UO,permanentid:UO,clickUri:VO},BO=new Z({required:!0,constrainTo:$O}),NO=mn("generatedAnswer/setIsVisible",(e=>$t(e,QO))),zO=mn("generatedAnswer/updateMessage",(e=>$t(e,{textDelta:UO}))),HO=mn("generatedAnswer/updateCitations",(e=>$t(e,{citations:new re({required:!0,each:new ee({values:LO})})}))),YO=mn("generatedAnswer/updateError",(e=>$t(e,{message:VO,code:new z({min:0})}))),GO=mn("generatedAnswer/resetAnswer"),WO=mn("generatedAnswer/like"),JO=mn("generatedAnswer/dislike"),KO=mn("generatedAnswer/feedbackModal/open"),ZO=mn("generatedAnswer/expand"),XO=mn("generatedAnswer/collapse"),eA=mn("generatedAnswer/setId",(e=>$t(e,{id:new Z({required:!0})}))),tA=mn("generatedAnswer/feedbackModal/close"),rA=mn("generatedAnswer/sendFeedback"),nA=mn("generatedAnswer/setIsLoading",(e=>$t(e,QO))),iA=mn("generatedAnswer/setIsStreaming",(e=>$t(e,QO))),aA=mn("generatedAnswer/setAnswerContentFormat",(e=>$t(e,BO))),sA=mn("generatedAnswer/updateResponseFormat",(e=>$t(e,{answerStyle:new Z({required:!0,constrainTo:_O}),contentFormat:new re({each:BO,default:["text/plain"]})}))),oA=mn("generatedAnswer/registerFieldsToIncludeInCitations",(e=>$t(e,Mt))),uA=mn("generatedAnswer/setIsAnswerGenerated",(e=>$t(e,QO))),cA=Qn("generatedAnswer/streamAnswer",(async(e,t)=>{let r=t.getState(),{dispatch:n,extra:i}=t,{setAbortControllerRef:a}=e,s=await PO(r),o=(e,t)=>{switch(e){case"genqa.headerMessageType":{let e=JSON.parse(t);n(aA(e.contentFormat));break}case"genqa.messageType":n(zO(JSON.parse(t)));break;case"genqa.citationsType":n(HO(JSON.parse(t)));break;case"genqa.endOfStreamType":{let e=JSON.parse(t).answerGenerated;n(iA(!1)),n(uA(e)),n(vO(e));break}default:r.debug&&i.logger.warn(`Unknown payloadType: "${e}"`)}};n(nA(!0));let u=e=>e.streamId===t.getState().search.extendedResults.generativeQuestionAnsweringId,c=i.streamingClient?.streamGeneratedAnswer(s,{write:e=>{u(s)&&(n(nA(!1)),e.payload&&e.payloadType&&o(e.payloadType,e.payload))},abort:e=>{u(s)&&n(YO(e))},close:()=>{u(s)&&n(iA(!1))},resetAnswer:()=>{u(s)&&n(GO())}});c?a(c):n(nA(!1))}));function lA(){return{id:"",isVisible:!0,isLoading:!1,isStreaming:!1,citations:[],liked:!1,disliked:!1,responseFormat:{answerStyle:"default",contentFormat:["text/plain"]},feedbackModalOpen:!1,feedbackSubmitted:!1,fieldsToIncludeInCitations:[],isAnswerGenerated:!1,expanded:!1}}var dA=Tn(lA(),(e=>e.addCase(NO,((e,{payload:t})=>{e.isVisible=t})).addCase(eA,((e,{payload:t})=>{e.id=t.id})).addCase(zO,((e,{payload:t})=>{e.isLoading=!1,e.isStreaming=!0,e.answer||(e.answer=""),e.answer+=t.textDelta,delete e.error})).addCase(HO,((e,{payload:t})=>{e.isLoading=!1,e.isStreaming=!0,e.citations=e.citations.concat(t.citations),delete e.error})).addCase(YO,((e,{payload:t})=>{e.isLoading=!1,e.isStreaming=!1,e.error={...t,isRetryable:t.code===Be},e.citations=[],delete e.answer})).addCase(WO,(e=>{e.liked=!0,e.disliked=!1})).addCase(JO,(e=>{e.liked=!1,e.disliked=!0})).addCase(KO,(e=>{e.feedbackModalOpen=!0})).addCase(tA,(e=>{e.feedbackModalOpen=!1})).addCase(rA,(e=>{e.feedbackSubmitted=!0})).addCase(GO,(e=>({...lA(),responseFormat:e.responseFormat,fieldsToIncludeInCitations:e.fieldsToIncludeInCitations,isVisible:e.isVisible,id:e.id}))).addCase(nA,((e,{payload:t})=>{e.isLoading=t})).addCase(iA,((e,{payload:t})=>{e.isStreaming=t})).addCase(aA,((e,{payload:t})=>{e.answerContentFormat=t})).addCase(sA,((e,{payload:t})=>{e.responseFormat=t})).addCase(oA,((e,t)=>{e.fieldsToIncludeInCitations=[...new Set(e.fieldsToIncludeInCitations.concat(t.payload))]})).addCase(uA,((e,{payload:t})=>{e.isAnswerGenerated=t})).addCase(ZO,(e=>{e.expanded=!0})).addCase(XO,(e=>{e.expanded=!1}))));var fA={engines:{},setAbortControllerRef:(e,t)=>{fA.engines[t].abortController=e},getIsStreamInProgress:e=>!fA.engines[e].abortController||fA.engines[e].abortController?.signal.aborted?(fA.engines[e].abortController=void 0,!1):!0,subscribeToSearchRequests:e=>{let t=()=>{let t=e.state,r=t.search.requestId,n=t.search.extendedResults.generativeQuestionAnsweringId,i=t.generatedAnswer.id;fA.engines[i].lastRequestId!==r&&(fA.engines[i].lastRequestId=r,fA.engines[i].abortController?.abort(),e.dispatch(GO())),!fA.getIsStreamInProgress(i)&&n&&n!==fA.engines[i].lastStreamId&&(fA.engines[i].lastStreamId=n,e.dispatch(cA({setAbortControllerRef:e=>fA.setAbortControllerRef(e,i)})))};return e.subscribe(t)}};function hA(e,t,r={}){if(!gA(e));let{dispatch:n}=e,i=Cv(e),a=()=>e.state;if(!e.state.generatedAnswer.id){let e=se("genQA-",12);n(eA({id:e})),fA.engines[e]={abortController:void 0,lastRequestId:"",lastStreamId:""}}let s=r.initialState?.isVisible;s!==void 0&&n(NO(s));let o=r.initialState?.responseFormat;o&&n(sA(o));let u=r.fieldsToIncludeInCitations;return u&&n(oA(u)),r.initialState?.expanded&&n(ZO()),fA.subscribeToSearchRequests(e),{...i,get state(){return a().generatedAnswer},like(){this.state.liked||(n(WO()),n(t.logLikeGeneratedAnswer()))},dislike(){this.state.disliked||(n(JO()),n(t.logDislikeGeneratedAnswer()))},openFeedbackModal(){n(KO())},closeFeedbackModal(){n(tA())},sendFeedback(e){n(t.logGeneratedAnswerFeedback(e)),n(rA())},sendDetailedFeedback(e){n(t.logGeneratedAnswerDetailedFeedback(e)),n(rA())},logCitationClick(e){n(t.logOpenGeneratedAnswerSource(e))},logCitationHover(e,r){n(t.logHoverCitation(e,r))},rephrase(e){n(sA(e))},show(){this.state.isVisible||(n(NO(!0)),n(t.logGeneratedAnswerShowAnswers()))},hide(){this.state.isVisible&&(n(NO(!1)),n(t.logGeneratedAnswerHideAnswers()))},expand(){this.state.expanded||(n(ZO()),n(t.logGeneratedAnswerExpand()))},collapse(){this.state.expanded&&(n(XO()),n(t.logGeneratedAnswerCollapse()))},logCopyToClipboard(){n(t.logCopyGeneratedAnswer())},retry(){}}}function gA(e){return e.addReducers({generatedAnswer:dA}),!0}function pA(e,t={}){let{dispatch:r}=e,n=hA(e,EO,t);return{...n,get state(){return n.state},retry(){r(jl({legacy:EO.logRetryGeneratedAnswer(),next:mO()}))},rephrase(e){n.rephrase(e),r(jl({legacy:EO.logRephraseGeneratedAnswer(e),next:wO()}))}}}function yA(e,t,r){let n=!1,i=()=>{n||(n=!0,e.dispatch(t.logOpenGeneratedAnswerSource(r.options.citation.id)))};return nI(e,r,(()=>{i()}))}function vA(e,t){return yA(e,{logOpenGeneratedAnswerSource:OO},t)}new V({content:new Q({required:!0}),conditions:new Q({required:!0}),priority:new z({required:!1,default:0,min:0}),fields:new re({required:!1,each:Rt})});function mA(e){if(!wA(e));let t=Cv(e),r=()=>e.state;return{...t,get state(){return{hasError:r().search.error!==null,error:r().search.error}}}}function wA(e){return e.addReducers({search:wf}),!0}function bA(e){return mA(e)}P();
/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */export{cI as C,Gb as D,py as E,Om as F,kS as G,RS as H,CI as I,wy as K,QI as M,pS as Q,kg as S,$I as V,at as W,PS as X,SS as Z,vA as a,zy as b,bA as c,Ch as d,cO as e,ph as f,tI as g,aI as h,AS as j,QS as n,gO as r,vc as t,zS as u,qI as v,pA as y};
//# sourceMappingURL=p-00579e36.js.map