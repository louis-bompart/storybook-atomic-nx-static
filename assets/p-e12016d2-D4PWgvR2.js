/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zp=Object.create,Wn=Object.defineProperty,Xp=Object.getOwnPropertyDescriptor,eg=Object.getOwnPropertyNames,tg=Object.getPrototypeOf,rg=Object.prototype.hasOwnProperty,ng=(e,t,r)=>t in e?Wn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ag=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),pe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ig=(e,t)=>{for(var r in t)Wn(e,r,{get:t[r],enumerable:!0})},sg=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of eg(t))!rg.call(e,a)&&a!==r&&Wn(e,a,{get:()=>t[a],enumerable:!(n=Xp(t,a))||n.enumerable});return e},Re=(e,t,r)=>(r=e!=null?Zp(tg(e)):{},sg(!e||!e.__esModule?Wn(r,"default",{value:e,enumerable:!0}):r,e)),zc=(e,t,r)=>ng(e,t+"",r),og=pe((e,t)=>{function r(a){try{return JSON.stringify(a)}catch{return'"[Circular]"'}}t.exports=n;function n(a,i,s){var o=s&&s.stringify||r,c=1;if(typeof a=="object"&&a!==null){var u=i.length+c;if(u===1)return a;var d=new Array(u);d[0]=o(a);for(var f=1;f<u;f++)d[f]=o(i[f]);return d.join(" ")}if(typeof a!="string")return a;var l=i.length;if(l===0)return a;for(var g="",v=1-c,p=-1,h=a&&a.length||0,y=0;y<h;){if(a.charCodeAt(y)===37&&y+1<h){switch(p=p>-1?p:0,a.charCodeAt(y+1)){case 100:case 102:if(v>=l||i[v]==null)break;p<y&&(g+=a.slice(p,y)),g+=Number(i[v]),p=y+2,y++;break;case 105:if(v>=l||i[v]==null)break;p<y&&(g+=a.slice(p,y)),g+=Math.floor(Number(i[v])),p=y+2,y++;break;case 79:case 111:case 106:if(v>=l||i[v]===void 0)break;p<y&&(g+=a.slice(p,y));var k=typeof i[v];if(k==="string"){g+="'"+i[v]+"'",p=y+2,y++;break}if(k==="function"){g+=i[v].name||"<anonymous>",p=y+2,y++;break}g+=o(i[v]),p=y+2,y++;break;case 115:if(v>=l)break;p<y&&(g+=a.slice(p,y)),g+=String(i[v]),p=y+2,y++;break;case 37:p<y&&(g+=a.slice(p,y)),g+="%",p=y+2,y++,v--;break}++v}++y}return p===-1?a:(p<h&&(g+=a.slice(p)),g)}}),Nc=pe((e,t)=>{var r=og();t.exports=l;var n=A().console||{},a={mapHttpRequest:se,mapHttpResponse:se,wrapRequestSerializer:J,wrapResponseSerializer:J,wrapErrorSerializer:J,req:se,res:se,err:L,errWithCause:L};function i(m,b){return m==="silent"?1/0:b.levels.values[m]}var s=Symbol("pino.logFuncs"),o=Symbol("pino.hierarchy"),c={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function u(m,b){let q={logger:b,parent:m[o]};b[o]=q}function d(m,b,q){let O={};b.forEach(M=>{O[M]=q[M]?q[M]:n[M]||n[c[M]||"log"]||$}),m[s]=O}function f(m,b){return Array.isArray(m)?m.filter(function(q){return q!=="!stdSerializers.err"}):m===!0?Object.keys(b):!1}function l(m){m=m||{},m.browser=m.browser||{};let b=m.browser.transmit;if(b&&typeof b.send!="function")throw Error("pino: transmit option must have a send function");let q=m.browser.write||n;m.browser.write&&(m.browser.asObject=!0);let O=m.serializers||{},M=f(m.browser.serialize,O),Y=m.browser.serialize;Array.isArray(m.browser.serialize)&&m.browser.serialize.indexOf("!stdSerializers.err")>-1&&(Y=!1);let ee=Object.keys(m.customLevels||{}),X=["error","fatal","warn","info","debug","trace"].concat(ee);typeof q=="function"&&X.forEach(function(de){q[de]=q}),(m.enabled===!1||m.browser.disabled)&&(m.level="silent");let te=m.level||"info",j=Object.create(q);j.log||(j.log=$),d(j,X,q),u({},j),Object.defineProperty(j,"levelVal",{get:Ie}),Object.defineProperty(j,"level",{get:Ee,set:ge});let le={transmit:b,serialize:M,asObject:m.browser.asObject,formatters:m.browser.formatters,levels:X,timestamp:N(m)};j.levels=g(m),j.level=te,j.setMaxListeners=j.getMaxListeners=j.emit=j.addListener=j.on=j.prependListener=j.once=j.prependOnceListener=j.removeListener=j.removeAllListeners=j.listeners=j.listenerCount=j.eventNames=j.write=j.flush=$,j.serializers=O,j._serialize=M,j._stdErrSerialize=Y,j.child=xe,b&&(j._logEvent=H());function Ie(){return i(this.level,this)}function Ee(){return this._level}function ge(de){if(de!=="silent"&&!this.levels.values[de])throw Error("unknown level "+de);this._level=de,h(this,le,j,"error"),h(this,le,j,"fatal"),h(this,le,j,"warn"),h(this,le,j,"info"),h(this,le,j,"debug"),h(this,le,j,"trace"),ee.forEach(Ae=>{h(this,le,j,Ae)})}function xe(de,Ae){if(!de)throw new Error("missing bindings for child Pino");Ae=Ae||{},M&&de.serializers&&(Ae.serializers=de.serializers);let _t=Ae.serializers;if(M&&_t){var ot=Object.assign({},O,_t),go=m.browser.serialize===!0?Object.keys(ot):M;delete de.serializers,U([de],go,ot,this._stdErrSerialize)}function ho(yo){this._childLevel=(yo._childLevel|0)+1,this.bindings=de,ot&&(this.serializers=ot,this._serialize=go),b&&(this._logEvent=H([].concat(yo._logEvent.bindings,de)))}ho.prototype=this;let Ra=new ho(this);return u(this,Ra),Ra.level=this.level,Ra}return j}function g(m){let b=m.customLevels||{},q=Object.assign({},l.levels.values,b),O=Object.assign({},l.levels.labels,v(b));return{values:q,labels:O}}function v(m){let b={};return Object.keys(m).forEach(function(q){b[m[q]]=q}),b}l.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},l.stdSerializers=a,l.stdTimeFunctions=Object.assign({},{nullTime:ye,epochTime:Oe,unixTime:V,isoTime:F});function p(m){let b=[];m.bindings&&b.push(m.bindings);let q=m[o];for(;q.parent;)q=q.parent,q.logger.bindings&&b.push(q.logger.bindings);return b.reverse()}function h(m,b,q,O){if(Object.defineProperty(m,O,{value:i(m.level,q)>i(O,q)?$:q[s][O],writable:!0,enumerable:!0,configurable:!0}),!b.transmit&&m[O]===$)return;m[O]=k(m,b,q,O);let M=p(m);M.length!==0&&(m[O]=y(M,m[O]))}function y(m,b){return function(){return b.apply(this,[...m,...arguments])}}function k(m,b,q,O){return function(M){return function(){let Y=b.timestamp(),ee=new Array(arguments.length),X=Object.getPrototypeOf&&Object.getPrototypeOf(this)===n?n:this;for(var te=0;te<ee.length;te++)ee[te]=arguments[te];if(b.serialize&&!b.asObject&&U(ee,this._serialize,this.serializers,this._stdErrSerialize),b.asObject||b.formatters?M.call(X,D(this,O,ee,Y,b.formatters)):M.apply(X,ee),b.transmit){let j=b.transmit.level||m._level,le=q.levels.values[j],Ie=q.levels.values[O];if(Ie<le)return;_(this,{ts:Y,methodLevel:O,methodValue:Ie,transmitLevel:j,transmitValue:q.levels.values[b.transmit.level||m._level],send:b.transmit.send,val:i(m._level,q)},ee)}}}(m[s][O])}function D(m,b,q,O,M={}){let{level:Y=()=>m.levels.values[b],log:ee=Ie=>Ie}=M;m._serialize&&U(q,m._serialize,m.serializers,m._stdErrSerialize);let X=q.slice(),te=X[0],j={};O&&(j.time=O),j.level=Y(b,m.levels.values[b]);let le=(m._childLevel|0)+1;if(le<1&&(le=1),te!==null&&typeof te=="object"){for(;le--&&typeof X[0]=="object";)Object.assign(j,X.shift());te=X.length?r(X.shift(),X):void 0}else typeof te=="string"&&(te=r(X.shift(),X));return te!==void 0&&(j.msg=te),ee(j)}function U(m,b,q,O){for(let M in m)if(O&&m[M]instanceof Error)m[M]=l.stdSerializers.err(m[M]);else if(typeof m[M]=="object"&&!Array.isArray(m[M]))for(let Y in m[M])b&&b.indexOf(Y)>-1&&Y in q&&(m[M][Y]=q[Y](m[M][Y]))}function _(m,b,q){let O=b.send,M=b.ts,Y=b.methodLevel,ee=b.methodValue,X=b.val,te=m._logEvent.bindings;U(q,m._serialize||Object.keys(m.serializers),m.serializers,m._stdErrSerialize===void 0?!0:m._stdErrSerialize),m._logEvent.ts=M,m._logEvent.messages=q.filter(function(j){return te.indexOf(j)===-1}),m._logEvent.level.label=Y,m._logEvent.level.value=ee,O(Y,m._logEvent,X),m._logEvent=H(te)}function H(m){return{ts:0,messages:[],bindings:m||[],level:{label:"",value:0}}}function L(m){let b={type:m.constructor.name,msg:m.message,stack:m.stack};for(let q in m)b[q]===void 0&&(b[q]=m[q]);return b}function N(m){return typeof m.timestamp=="function"?m.timestamp:m.timestamp===!1?ye:Oe}function se(){return{}}function J(m){return m}function $(){}function ye(){return!1}function Oe(){return Date.now()}function V(){return Math.round(Date.now()/1e3)}function F(){return new Date(Date.now()).toISOString()}function A(){function m(b){return typeof b<"u"&&b}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return m(self)||m(window)||m(this)||{}}}t.exports.default=l,t.exports.pino=l}),Bi=pe((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs=n()})(e,function(){var r=1e3,n=6e4,a=36e5,i="millisecond",s="second",o="minute",c="hour",u="day",d="week",f="month",l="quarter",g="year",v="date",p="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,k={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(V){var F=["th","st","nd","rd"],A=V%100;return"["+V+(F[(A-20)%10]||F[A]||F[0])+"]"}},D=function(V,F,A){var m=String(V);return!m||m.length>=F?V:""+Array(F+1-m.length).join(A)+V},U={s:D,z:function(V){var F=-V.utcOffset(),A=Math.abs(F),m=Math.floor(A/60),b=A%60;return(F<=0?"+":"-")+D(m,2,"0")+":"+D(b,2,"0")},m:function V(F,A){if(F.date()<A.date())return-V(A,F);var m=12*(A.year()-F.year())+(A.month()-F.month()),b=F.clone().add(m,f),q=A-b<0,O=F.clone().add(m+(q?-1:1),f);return+(-(m+(A-b)/(q?b-O:O-b))||0)},a:function(V){return V<0?Math.ceil(V)||0:Math.floor(V)},p:function(V){return{M:f,y:g,w:d,d:u,D:v,h:c,m:o,s,ms:i,Q:l}[V]||String(V||"").toLowerCase().replace(/s$/,"")},u:function(V){return V===void 0}},_="en",H={};H[_]=k;var L="$isDayjsObject",N=function(V){return V instanceof ye||!(!V||!V[L])},se=function V(F,A,m){var b;if(!F)return _;if(typeof F=="string"){var q=F.toLowerCase();H[q]&&(b=q),A&&(H[q]=A,b=q);var O=F.split("-");if(!b&&O.length>1)return V(O[0])}else{var M=F.name;H[M]=F,b=M}return!m&&b&&(_=b),b||!m&&_},J=function(V,F){if(N(V))return V.clone();var A=typeof F=="object"?F:{};return A.date=V,A.args=arguments,new ye(A)},$=U;$.l=se,$.i=N,$.w=function(V,F){return J(V,{locale:F.$L,utc:F.$u,x:F.$x,$offset:F.$offset})};var ye=function(){function V(A){this.$L=se(A.locale,null,!0),this.parse(A),this.$x=this.$x||A.x||{},this[L]=!0}var F=V.prototype;return F.parse=function(A){this.$d=function(m){var b=m.date,q=m.utc;if(b===null)return new Date(NaN);if($.u(b))return new Date;if(b instanceof Date)return new Date(b);if(typeof b=="string"&&!/Z$/i.test(b)){var O=b.match(h);if(O){var M=O[2]-1||0,Y=(O[7]||"0").substring(0,3);return q?new Date(Date.UTC(O[1],M,O[3]||1,O[4]||0,O[5]||0,O[6]||0,Y)):new Date(O[1],M,O[3]||1,O[4]||0,O[5]||0,O[6]||0,Y)}}return new Date(b)}(A),this.init()},F.init=function(){var A=this.$d;this.$y=A.getFullYear(),this.$M=A.getMonth(),this.$D=A.getDate(),this.$W=A.getDay(),this.$H=A.getHours(),this.$m=A.getMinutes(),this.$s=A.getSeconds(),this.$ms=A.getMilliseconds()},F.$utils=function(){return $},F.isValid=function(){return this.$d.toString()!==p},F.isSame=function(A,m){var b=J(A);return this.startOf(m)<=b&&b<=this.endOf(m)},F.isAfter=function(A,m){return J(A)<this.startOf(m)},F.isBefore=function(A,m){return this.endOf(m)<J(A)},F.$g=function(A,m,b){return $.u(A)?this[m]:this.set(b,A)},F.unix=function(){return Math.floor(this.valueOf()/1e3)},F.valueOf=function(){return this.$d.getTime()},F.startOf=function(A,m){var b=this,q=!!$.u(m)||m,O=$.p(A),M=function(Ee,ge){var xe=$.w(b.$u?Date.UTC(b.$y,ge,Ee):new Date(b.$y,ge,Ee),b);return q?xe:xe.endOf(u)},Y=function(Ee,ge){return $.w(b.toDate()[Ee].apply(b.toDate("s"),(q?[0,0,0,0]:[23,59,59,999]).slice(ge)),b)},ee=this.$W,X=this.$M,te=this.$D,j="set"+(this.$u?"UTC":"");switch(O){case g:return q?M(1,0):M(31,11);case f:return q?M(1,X):M(0,X+1);case d:var le=this.$locale().weekStart||0,Ie=(ee<le?ee+7:ee)-le;return M(q?te-Ie:te+(6-Ie),X);case u:case v:return Y(j+"Hours",0);case c:return Y(j+"Minutes",1);case o:return Y(j+"Seconds",2);case s:return Y(j+"Milliseconds",3);default:return this.clone()}},F.endOf=function(A){return this.startOf(A,!1)},F.$set=function(A,m){var b,q=$.p(A),O="set"+(this.$u?"UTC":""),M=(b={},b[u]=O+"Date",b[v]=O+"Date",b[f]=O+"Month",b[g]=O+"FullYear",b[c]=O+"Hours",b[o]=O+"Minutes",b[s]=O+"Seconds",b[i]=O+"Milliseconds",b)[q],Y=q===u?this.$D+(m-this.$W):m;if(q===f||q===g){var ee=this.clone().set(v,1);ee.$d[M](Y),ee.init(),this.$d=ee.set(v,Math.min(this.$D,ee.daysInMonth())).$d}else M&&this.$d[M](Y);return this.init(),this},F.set=function(A,m){return this.clone().$set(A,m)},F.get=function(A){return this[$.p(A)]()},F.add=function(A,m){var b,q=this;A=Number(A);var O=$.p(m),M=function(X){var te=J(q);return $.w(te.date(te.date()+Math.round(X*A)),q)};if(O===f)return this.set(f,this.$M+A);if(O===g)return this.set(g,this.$y+A);if(O===u)return M(1);if(O===d)return M(7);var Y=(b={},b[o]=n,b[c]=a,b[s]=r,b)[O]||1,ee=this.$d.getTime()+A*Y;return $.w(ee,this)},F.subtract=function(A,m){return this.add(-1*A,m)},F.format=function(A){var m=this,b=this.$locale();if(!this.isValid())return b.invalidDate||p;var q=A||"YYYY-MM-DDTHH:mm:ssZ",O=$.z(this),M=this.$H,Y=this.$m,ee=this.$M,X=b.weekdays,te=b.months,j=b.meridiem,le=function(ge,xe,de,Ae){return ge&&(ge[xe]||ge(m,q))||de[xe].slice(0,Ae)},Ie=function(ge){return $.s(M%12||12,ge,"0")},Ee=j||function(ge,xe,de){var Ae=ge<12?"AM":"PM";return de?Ae.toLowerCase():Ae};return q.replace(y,function(ge,xe){return xe||function(de){switch(de){case"YY":return String(m.$y).slice(-2);case"YYYY":return $.s(m.$y,4,"0");case"M":return ee+1;case"MM":return $.s(ee+1,2,"0");case"MMM":return le(b.monthsShort,ee,te,3);case"MMMM":return le(te,ee);case"D":return m.$D;case"DD":return $.s(m.$D,2,"0");case"d":return String(m.$W);case"dd":return le(b.weekdaysMin,m.$W,X,2);case"ddd":return le(b.weekdaysShort,m.$W,X,3);case"dddd":return X[m.$W];case"H":return String(M);case"HH":return $.s(M,2,"0");case"h":return Ie(1);case"hh":return Ie(2);case"a":return Ee(M,Y,!0);case"A":return Ee(M,Y,!1);case"m":return String(Y);case"mm":return $.s(Y,2,"0");case"s":return String(m.$s);case"ss":return $.s(m.$s,2,"0");case"SSS":return $.s(m.$ms,3,"0");case"Z":return O}return null}(ge)||O.replace(":","")})},F.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},F.diff=function(A,m,b){var q,O=this,M=$.p(m),Y=J(A),ee=(Y.utcOffset()-this.utcOffset())*n,X=this-Y,te=function(){return $.m(O,Y)};switch(M){case g:q=te()/12;break;case f:q=te();break;case l:q=te()/3;break;case d:q=(X-ee)/6048e5;break;case u:q=(X-ee)/864e5;break;case c:q=X/a;break;case o:q=X/n;break;case s:q=X/r;break;default:q=X}return b?q:$.a(q)},F.daysInMonth=function(){return this.endOf(f).$D},F.$locale=function(){return H[this.$L]},F.locale=function(A,m){if(!A)return this.$L;var b=this.clone(),q=se(A,m,!0);return q&&(b.$L=q),b},F.clone=function(){return $.w(this.$d,this)},F.toDate=function(){return new Date(this.valueOf())},F.toJSON=function(){return this.isValid()?this.toISOString():null},F.toISOString=function(){return this.$d.toISOString()},F.toString=function(){return this.$d.toUTCString()},V}(),Oe=ye.prototype;return J.prototype=Oe,[["$ms",i],["$s",s],["$m",o],["$H",c],["$W",u],["$M",f],["$y",g],["$D",v]].forEach(function(V){Oe[V[1]]=function(F){return this.$g(F,V[0],V[1])}}),J.extend=function(V,F){return V.$i||(V(F,ye,J),V.$i=!0),J},J.locale=se,J.isDayjs=N,J.unix=function(V){return J(1e3*V)},J.en=H[_],J.Ls=H,J.p={},J})}),cg=pe((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_timezone=n()})(e,function(){var r={year:0,month:1,day:2,hour:3,minute:4,second:5},n={};return function(a,i,s){var o,c=function(l,g,v){v===void 0&&(v={});var p=new Date(l),h=function(y,k){k===void 0&&(k={});var D=k.timeZoneName||"short",U=y+"|"+D,_=n[U];return _||(_=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:y,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:D}),n[U]=_),_}(g,v);return h.formatToParts(p)},u=function(l,g){for(var v=c(l,g),p=[],h=0;h<v.length;h+=1){var y=v[h],k=y.type,D=y.value,U=r[k];U>=0&&(p[U]=parseInt(D,10))}var _=p[3],H=_===24?0:_,L=p[0]+"-"+p[1]+"-"+p[2]+" "+H+":"+p[4]+":"+p[5]+":000",N=+l;return(s.utc(L).valueOf()-(N-=N%1e3))/6e4},d=i.prototype;d.tz=function(l,g){l===void 0&&(l=o);var v=this.utcOffset(),p=this.toDate(),h=p.toLocaleString("en-US",{timeZone:l}),y=Math.round((p-new Date(h))/1e3/60),k=s(h,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(p.getTimezoneOffset()/15)-y,!0);if(g){var D=k.utcOffset();k=k.add(v-D,"minute")}return k.$x.$timezone=l,k},d.offsetName=function(l){var g=this.$x.$timezone||s.tz.guess(),v=c(this.valueOf(),g,{timeZoneName:l}).find(function(p){return p.type.toLowerCase()==="timezonename"});return v&&v.value};var f=d.startOf;d.startOf=function(l,g){if(!this.$x||!this.$x.$timezone)return f.call(this,l,g);var v=s(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return f.call(v,l,g).tz(this.$x.$timezone,!0)},s.tz=function(l,g,v){var p=v&&g,h=v||g||o,y=u(+s(),h);if(typeof l!="string")return s(l).tz(h);var k=function(H,L,N){var se=H-60*L*1e3,J=u(se,N);if(L===J)return[se,L];var $=u(se-=60*(J-L)*1e3,N);return J===$?[se,J]:[H-60*Math.min(J,$)*1e3,Math.max(J,$)]}(s.utc(l,p).valueOf(),y,h),D=k[0],U=k[1],_=s(D).utcOffset(U);return _.$x.$timezone=h,_},s.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},s.tz.setDefault=function(l){o=l}}})}),ug=pe((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_utc=n()})(e,function(){var r="minute",n=/[+-]\d\d(?::?\d\d)?/g,a=/([+-]|\d\d)/g;return function(i,s,o){var c=s.prototype;o.utc=function(p){var h={date:p,utc:!0,args:arguments};return new s(h)},c.utc=function(p){var h=o(this.toDate(),{locale:this.$L,utc:!0});return p?h.add(this.utcOffset(),r):h},c.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var u=c.parse;c.parse=function(p){p.utc&&(this.$u=!0),this.$utils().u(p.$offset)||(this.$offset=p.$offset),u.call(this,p)};var d=c.init;c.init=function(){if(this.$u){var p=this.$d;this.$y=p.getUTCFullYear(),this.$M=p.getUTCMonth(),this.$D=p.getUTCDate(),this.$W=p.getUTCDay(),this.$H=p.getUTCHours(),this.$m=p.getUTCMinutes(),this.$s=p.getUTCSeconds(),this.$ms=p.getUTCMilliseconds()}else d.call(this)};var f=c.utcOffset;c.utcOffset=function(p,h){var y=this.$utils().u;if(y(p))return this.$u?0:y(this.$offset)?f.call(this):this.$offset;if(typeof p=="string"&&(p=function(_){_===void 0&&(_="");var H=_.match(n);if(!H)return null;var L=(""+H[0]).match(a)||["-",0,0],N=L[0],se=60*+L[1]+ +L[2];return se===0?0:N==="+"?se:-se}(p),p===null))return this;var k=Math.abs(p)<=16?60*p:p,D=this;if(h)return D.$offset=k,D.$u=p===0,D;if(p!==0){var U=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(D=this.local().add(k+U,r)).$offset=k,D.$x.$localOffset=U}else D=this.utc();return D};var l=c.format;c.format=function(p){var h=p||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,h)},c.valueOf=function(){var p=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*p},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var g=c.toDate;c.toDate=function(p){return p==="s"&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():g.call(this)};var v=c.diff;c.diff=function(p,h,y){if(p&&this.$u===p.$u)return v.call(this,p,h,y);var k=this.local(),D=o(p).local();return v.call(k,D,h,y)}}})}),lg=pe((e,t)=>{t.exports=fetch}),dg=pe(e=>{var t=e&&e.__assign||function(){return t=Object.assign||function(a){for(var i,s=1,o=arguments.length;s<o;s++){i=arguments[s];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(a[c]=i[c])}return a},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var r={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};function n(a){var i=t(t({},r),a);return i.numOfAttempts<1&&(i.numOfAttempts=1),i}e.getSanitizedOptions=n}),fg=pe(e=>{Object.defineProperty(e,"__esModule",{value:!0});function t(r){var n=Math.random()*r;return Math.round(n)}e.fullJitter=t}),pg=pe(e=>{Object.defineProperty(e,"__esModule",{value:!0});function t(r){return r}e.noJitter=t}),gg=pe(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=fg(),r=pg();function n(a){switch(a.jitter){case"full":return t.fullJitter;case"none":default:return r.noJitter}}e.JitterFactory=n}),Bc=pe(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=gg(),r=function(){function n(a){this.options=a,this.attempt=0}return n.prototype.apply=function(){var a=this;return new Promise(function(i){return setTimeout(i,a.jitteredDelay)})},n.prototype.setAttemptNumber=function(a){this.attempt=a},Object.defineProperty(n.prototype,"jitteredDelay",{get:function(){var a=t.JitterFactory(this.options);return a(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"delay",{get:function(){var a=this.options.startingDelay,i=this.options.timeMultiple,s=this.numOfDelayedAttempts,o=a*Math.pow(i,s);return Math.min(o,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),n}();e.Delay=r}),hg=pe(e=>{var t=e&&e.__extends||function(){var s=function(o,c){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var f in d)d.hasOwnProperty(f)&&(u[f]=d[f])},s(o,c)};return function(o,c){s(o,c);function u(){this.constructor=o}o.prototype=c===null?Object.create(c):(u.prototype=c.prototype,new u)}}(),r=e&&e.__awaiter||function(s,o,c,u){function d(f){return f instanceof c?f:new c(function(l){l(f)})}return new(c||(c=Promise))(function(f,l){function g(h){try{p(u.next(h))}catch(y){l(y)}}function v(h){try{p(u.throw(h))}catch(y){l(y)}}function p(h){h.done?f(h.value):d(h.value).then(g,v)}p((u=u.apply(s,o||[])).next())})},n=e&&e.__generator||function(s,o){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,d,f,l;return l={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function g(p){return function(h){return v([p,h])}}function v(p){if(u)throw new TypeError("Generator is already executing.");for(;c;)try{if(u=1,d&&(f=p[0]&2?d.return:p[0]?d.throw||((f=d.return)&&f.call(d),0):d.next)&&!(f=f.call(d,p[1])).done)return f;switch(d=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return c.label++,{value:p[1],done:!1};case 5:c.label++,d=p[1],p=[0];continue;case 7:p=c.ops.pop(),c.trys.pop();continue;default:if(f=c.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){c=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){c.label=p[1];break}if(p[0]===6&&c.label<f[1]){c.label=f[1],f=p;break}if(f&&c.label<f[2]){c.label=f[2],c.ops.push(p);break}f[2]&&c.ops.pop(),c.trys.pop();continue}p=o.call(s,c)}catch(h){p=[6,h],d=0}finally{u=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var a=Bc(),i=function(s){t(o,s);function o(){return s!==null&&s.apply(this,arguments)||this}return o.prototype.apply=function(){return r(this,void 0,void 0,function(){return n(this,function(c){return[2,this.isFirstAttempt?!0:s.prototype.apply.call(this)]})})},Object.defineProperty(o.prototype,"isFirstAttempt",{get:function(){return this.attempt===0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),o}(a.Delay);e.SkipFirstDelay=i}),yg=pe(e=>{var t=e&&e.__extends||function(){var a=function(i,s){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var u in c)c.hasOwnProperty(u)&&(o[u]=c[u])},a(i,s)};return function(i,s){a(i,s);function o(){this.constructor=i}i.prototype=s===null?Object.create(s):(o.prototype=s.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=Bc(),n=function(a){t(i,a);function i(){return a!==null&&a.apply(this,arguments)||this}return i}(r.Delay);e.AlwaysDelay=n}),mg=pe(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=hg(),r=yg();function n(i,s){var o=a(i);return o.setAttemptNumber(s),o}e.DelayFactory=n;function a(i){return i.delayFirstAttempt?new r.AlwaysDelay(i):new t.SkipFirstDelay(i)}}),vg=pe(e=>{var t=e&&e.__awaiter||function(o,c,u,d){function f(l){return l instanceof u?l:new u(function(g){g(l)})}return new(u||(u=Promise))(function(l,g){function v(y){try{h(d.next(y))}catch(k){g(k)}}function p(y){try{h(d.throw(y))}catch(k){g(k)}}function h(y){y.done?l(y.value):f(y.value).then(v,p)}h((d=d.apply(o,c||[])).next())})},r=e&&e.__generator||function(o,c){var u={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},d,f,l,g;return g={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function v(h){return function(y){return p([h,y])}}function p(h){if(d)throw new TypeError("Generator is already executing.");for(;u;)try{if(d=1,f&&(l=h[0]&2?f.return:h[0]?f.throw||((l=f.return)&&l.call(f),0):f.next)&&!(l=l.call(f,h[1])).done)return l;switch(f=0,l&&(h=[h[0]&2,l.value]),h[0]){case 0:case 1:l=h;break;case 4:return u.label++,{value:h[1],done:!1};case 5:u.label++,f=h[1],h=[0];continue;case 7:h=u.ops.pop(),u.trys.pop();continue;default:if(l=u.trys,!(l=l.length>0&&l[l.length-1])&&(h[0]===6||h[0]===2)){u=0;continue}if(h[0]===3&&(!l||h[1]>l[0]&&h[1]<l[3])){u.label=h[1];break}if(h[0]===6&&u.label<l[1]){u.label=l[1],l=h;break}if(l&&u.label<l[2]){u.label=l[2],u.ops.push(h);break}l[2]&&u.ops.pop(),u.trys.pop();continue}h=c.call(o,u)}catch(y){h=[6,y],f=0}finally{d=l=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var n=dg(),a=mg();function i(o,c){return c===void 0&&(c={}),t(this,void 0,void 0,function(){var u,d;return r(this,function(f){switch(f.label){case 0:return u=n.getSanitizedOptions(c),d=new s(o,u),[4,d.execute()];case 1:return[2,f.sent()]}})})}e.backOff=i;var s=function(){function o(c,u){this.request=c,this.options=u,this.attemptNumber=0}return o.prototype.execute=function(){return t(this,void 0,void 0,function(){var c,u;return r(this,function(d){switch(d.label){case 0:if(this.attemptLimitReached)return[3,7];d.label=1;case 1:return d.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return d.sent(),[4,this.request()];case 3:return[2,d.sent()];case 4:return c=d.sent(),this.attemptNumber++,[4,this.options.retry(c,this.attemptNumber)];case 5:if(u=d.sent(),!u||this.attemptLimitReached)throw c;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}})})},Object.defineProperty(o.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),o.prototype.applyDelay=function(){return t(this,void 0,void 0,function(){var c;return r(this,function(u){switch(u.label){case 0:return c=a.DelayFactory(this.options,this.attemptNumber),[4,c.apply()];case 1:return u.sent(),[2]}})})},o}()}),Sg=pe((e,t)=>{function r(i){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");if(i=`${i}`,i=i.replace(/[ \t\n\f\r]/g,""),i.length%4===0&&(i=i.replace(/==?$/,"")),i.length%4===1||/[^+/0-9A-Za-z]/.test(i))return null;let s="",o=0,c=0;for(let u=0;u<i.length;u++)o<<=6,o|=a(i[u]),c+=6,c===24&&(s+=String.fromCharCode((o&16711680)>>16),s+=String.fromCharCode((o&65280)>>8),s+=String.fromCharCode(o&255),o=c=0);return c===12?(o>>=4,s+=String.fromCharCode(o)):c===18&&(o>>=2,s+=String.fromCharCode((o&65280)>>8),s+=String.fromCharCode(o&255)),s}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function a(i){let s=n.indexOf(i);return s<0?void 0:s}t.exports=r}),wg=pe((e,t)=>{function r(i){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");let s;for(i=`${i}`,s=0;s<i.length;s++)if(i.charCodeAt(s)>255)return null;let o="";for(s=0;s<i.length;s+=3){let c=[void 0,void 0,void 0,void 0];c[0]=i.charCodeAt(s)>>2,c[1]=(i.charCodeAt(s)&3)<<4,i.length>s+1&&(c[1]|=i.charCodeAt(s+1)>>4,c[2]=(i.charCodeAt(s+1)&15)<<2),i.length>s+2&&(c[2]|=i.charCodeAt(s+2)>>6,c[3]=i.charCodeAt(s+2)&63);for(let u=0;u<c.length;u++)typeof c[u]>"u"?o+="=":o+=a(c[u])}return o}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function a(i){if(i>=0&&i<64)return n[i]}t.exports=r}),Hc=pe((e,t)=>{var r=Sg(),n=wg();t.exports={atob:r,btoa:n}}),bg=pe((e,t)=>{var r=typeof self<"u"?self:typeof window<"u"?window:void 0;if(!r)throw new Error("Unable to find global scope. Are you sure this is running in the browser?");if(!r.AbortController)throw new Error('Could not find "AbortController" in the global scope. You need to polyfill it first');t.exports.AbortController=r.AbortController}),Cg=pe((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_quarterOfYear=n()})(e,function(){var r="month",n="quarter";return function(a,i){var s=i.prototype;s.quarter=function(u){return this.$utils().u(u)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(u-1))};var o=s.add;s.add=function(u,d){return u=Number(u),this.$utils().p(d)===n?this.add(3*u,r):o.bind(this)(u,d)};var c=s.startOf;s.startOf=function(u,d){var f=this.$utils(),l=!!f.u(d)||d;if(f.p(u)===n){var g=this.quarter()-1;return l?this.month(3*g).startOf(r).startOf("day"):this.month(3*g+2).endOf(r).endOf("day")}return c.bind(this)(u,d)}}})}),Ig=pe((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_customParseFormat=n()})(e,function(){var r={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},n=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,a=/\d\d/,i=/\d\d?/,s=/\d*[^-_:/,()\s\d]+/,o={},c=function(p){return(p=+p)+(p>68?1900:2e3)},u=function(p){return function(h){this[p]=+h}},d=[/[+-]\d\d:?(\d\d)?|Z/,function(p){(this.zone||(this.zone={})).offset=function(h){if(!h||h==="Z")return 0;var y=h.match(/([+-]|\d\d)/g),k=60*y[1]+(+y[2]||0);return k===0?0:y[0]==="+"?-k:k}(p)}],f=function(p){var h=o[p];return h&&(h.indexOf?h:h.s.concat(h.f))},l=function(p,h){var y,k=o.meridiem;if(k){for(var D=1;D<=24;D+=1)if(p.indexOf(k(D,0,h))>-1){y=D>12;break}}else y=p===(h?"pm":"PM");return y},g={A:[s,function(p){this.afternoon=l(p,!1)}],a:[s,function(p){this.afternoon=l(p,!0)}],S:[/\d/,function(p){this.milliseconds=100*+p}],SS:[a,function(p){this.milliseconds=10*+p}],SSS:[/\d{3}/,function(p){this.milliseconds=+p}],s:[i,u("seconds")],ss:[i,u("seconds")],m:[i,u("minutes")],mm:[i,u("minutes")],H:[i,u("hours")],h:[i,u("hours")],HH:[i,u("hours")],hh:[i,u("hours")],D:[i,u("day")],DD:[a,u("day")],Do:[s,function(p){var h=o.ordinal,y=p.match(/\d+/);if(this.day=y[0],h)for(var k=1;k<=31;k+=1)h(k).replace(/\[|\]/g,"")===p&&(this.day=k)}],M:[i,u("month")],MM:[a,u("month")],MMM:[s,function(p){var h=f("months"),y=(f("monthsShort")||h.map(function(k){return k.slice(0,3)})).indexOf(p)+1;if(y<1)throw new Error;this.month=y%12||y}],MMMM:[s,function(p){var h=f("months").indexOf(p)+1;if(h<1)throw new Error;this.month=h%12||h}],Y:[/[+-]?\d+/,u("year")],YY:[a,function(p){this.year=c(p)}],YYYY:[/\d{4}/,u("year")],Z:d,ZZ:d};function v(p){var h,y;h=p,y=o&&o.formats;for(var k=(p=h.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(se,J,$){var ye=$&&$.toUpperCase();return J||y[$]||r[$]||y[ye].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(Oe,V,F){return V||F.slice(1)})})).match(n),D=k.length,U=0;U<D;U+=1){var _=k[U],H=g[_],L=H&&H[0],N=H&&H[1];k[U]=N?{regex:L,parser:N}:_.replace(/^\[|\]$/g,"")}return function(se){for(var J={},$=0,ye=0;$<D;$+=1){var Oe=k[$];if(typeof Oe=="string")ye+=Oe.length;else{var V=Oe.regex,F=Oe.parser,A=se.slice(ye),m=V.exec(A)[0];F.call(J,m),se=se.replace(m,"")}}return function(b){var q=b.afternoon;if(q!==void 0){var O=b.hours;q?O<12&&(b.hours+=12):O===12&&(b.hours=0),delete b.afternoon}}(J),J}}return function(p,h,y){y.p.customParseFormat=!0,p&&p.parseTwoDigitYear&&(c=p.parseTwoDigitYear);var k=h.prototype,D=k.parse;k.parse=function(U){var _=U.date,H=U.utc,L=U.args;this.$u=H;var N=L[1];if(typeof N=="string"){var se=L[2]===!0,J=L[3]===!0,$=se||J,ye=L[2];J&&(ye=L[2]),o=this.$locale(),!se&&ye&&(o=y.Ls[ye]),this.$d=function(A,m,b){try{if(["x","X"].indexOf(m)>-1)return new Date((m==="X"?1e3:1)*A);var q=v(m)(A),O=q.year,M=q.month,Y=q.day,ee=q.hours,X=q.minutes,te=q.seconds,j=q.milliseconds,le=q.zone,Ie=new Date,Ee=Y||(O||M?1:Ie.getDate()),ge=O||Ie.getFullYear(),xe=0;O&&!M||(xe=M>0?M-1:Ie.getMonth());var de=ee||0,Ae=X||0,_t=te||0,ot=j||0;return le?new Date(Date.UTC(ge,xe,Ee,de,Ae,_t,ot+60*le.offset*1e3)):b?new Date(Date.UTC(ge,xe,Ee,de,Ae,_t,ot)):new Date(ge,xe,Ee,de,Ae,_t,ot)}catch{return new Date("")}}(_,N,H),this.init(),ye&&ye!==!0&&(this.$L=this.locale(ye).$L),$&&_!=this.format(N)&&(this.$d=new Date("")),o={}}else if(N instanceof Array)for(var Oe=N.length,V=1;V<=Oe;V+=1){L[1]=N[V-1];var F=y.apply(this,L);if(F.isValid()){this.$d=F.$d,this.$L=F.$L,this.init();break}V===Oe&&(this.$d=new Date(""))}else D.call(this,U)}}})}),kg=pe((e,t)=>{var r=/(^|; )Coveo-Pendragon=([^;]*)/;t.exports=()=>{var n;return((n=r.exec(document.cookie))==null?void 0:n.pop())||null}}),ur=()=>global.crypto,qg=()=>{typeof window<"u"||(ur()||(global.crypto=ag("crypto")),!ur().getRandomValues&&ur().webcrypto&&(global.crypto.getRandomValues=ur().webcrypto.getRandomValues.bind(ur().webcrypto)))};Re(Nc());var xg=()=>({referrer:document.referrer,userAgent:navigator.userAgent,location:window.location.href}),Ag=()=>({referrer:"default",userAgent:"Node.js",location:"default"}),Og="coveo-headless-internal-state",Yc=Symbol.for(Og),Fg=10,Wc=e=>({past:[],present:e,future:[]}),Rg=e=>{let{past:t,present:r,future:n}=e;if(!r||t.length===0)return e;let a=t[t.length-1];return{past:t.slice(0,t.length-1),present:a,future:[r,...n]}},Eg=e=>{let{past:t,present:r,future:n}=e;if(!r||n.length===0)return e;let a=n[0],i=n.slice(1);return{past:[...t,r],present:a,future:i}},Dg=e=>{let{action:t,state:r,reducer:n}=e,{past:a,present:i}=r,s=n(i,t);return i?i===s?r:{past:[...a,i].slice(-Fg),present:s,future:[]}:Wc(s)},Tg=e=>{let{actionTypes:t,reducer:r}=e,n=Wc();return(a=n,i)=>{switch(i.type){case t.undo:return Rg(a);case t.redo:return Eg(a);case t.snapshot:return Dg({state:a,reducer:r,action:i});default:return a}}},At=()=>({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,lq:"",lqWasSet:!1,dq:"",dqWasSet:!1,defaultFilters:{cq:"",aq:"",lq:"",dq:""}}),Hi=Re(Bi()),Mg=Re(cg()),Pg=Re(ug()),Ug=Re(lg()),jg=Re(vg()),Gc=class extends Error{constructor(){super(),this.name="ExpiredToken",this.message="The token being used to perform the request is expired."}},ci=class extends Error{constructor(e,t){super(),this.name="Disconnected",this.message=`Client could not connect to the following URL: ${e}`,this.statusCode=t??0}},Vg=Re(Hc()),Gn=(e,t=5)=>e+Math.random().toString(36).substring(2,2+t);function Jc(e){return Array.isArray(e)}function Ea(e){return e.trim()===""}function _g(e,t){return[...e.reduce((r,n)=>{let a=t(n);return r.has(a)||r.set(a,n),r},new Map).values()]}function Lg(e){return(typeof btoa<"u"?btoa:Vg.btoa)(encodeURI(e))}function Kc(e,t){let{[e]:r,...n}=t;return n}function Yi(e){return Lg(JSON.stringify(e))}var $g=new Set(["1",1,"yes",!0]);function Zc(){if(typeof navigator>"u"||typeof window>"u")return!1;let e=navigator,t=window;return[e.globalPrivacyControl,e.doNotTrack,e.msDoNotTrack,t.doNotTrack].some(r=>$g.has(r))}function Qg(e){let t={};for(let[r,n]of e)t[r]=n;return t}function zg(e,t,r){return clearTimeout(t),setTimeout(e,r)}function Wi(e){if(typeof e!="object"||!e)return e;try{return JSON.parse(JSON.stringify(e))}catch{return e}}function Ng(e){let t=[];for(let r in e){let n=encodeURIComponent(r),a=encodeURIComponent(e[r]);t.push(`${n}=${a}`)}return t.join("&")}function Bg(e){return typeof e!="object"||!e?!1:Object.values(e).every(Hg)}function Hg(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function mo(e){return e===429}var ut=class Xc{static async call(t){let r=Gg(t),{logger:n}=t,a=await Xc.preprocessRequest(r,t);n.info(a,"Platform request");let{url:i,...s}=a,o=async()=>{let c=await(0,Ug.default)(i,s);if(mo(c.status))throw c;return c};try{let c=await(0,jg.backOff)(o,{retry:u=>{let d=u&&mo(u.status);return d&&n.info("Platform retrying request"),d}});if(c.status===419)throw n.info("Platform renewing token"),new Gc;if(c.status===404)throw new ci(i,c.status);return n.info({response:c,requestInfo:a},"Platform response"),c}catch(c){return c.message==="Failed to fetch"?new ci(i):c}}static async preprocessRequest(t,r){let{origin:n,preprocessRequest:a,logger:i,requestMetadata:s}=r,{signal:o,...c}=t,u=Wi(c);try{let d=await a(t,n,s);return{...t,...d}}catch(d){i.error(d,"Platform request preprocessing failed. Returning default request options.")}return u}};function eu(e,t){return`https://${e}.cloud.coveo.com`}function Yg(e,t="prod"){let r=t==="prod"?"":t,n=`https://${e}.org${r}.coveo.com`,a=`https://${e}.analytics.org${r}.coveo.com`,i=`${n}/rest/search/v2`,s=`https://${e}.admin.org${r}.coveo.com`;return{platform:n,analytics:a,search:i,admin:s}}function vo(e){return eu("platform")}function Wg(e){return eu("analytics")}function Gg(e){let{url:t,method:r,requestParams:n,contentType:a,accessToken:i,signal:s}=e,o=e.method==="POST"||e.method==="PUT",c=Jg(n,a);return{url:t,method:r,headers:{"Content-Type":a,Authorization:`Bearer ${i}`,...e.headers},...o&&{body:c},signal:s}}function Jg(e,t){return t==="application/x-www-form-urlencoded"?Bg(e)?Ng(e):"":JSON.stringify(e)}Hi.default.extend(Pg.default);Hi.default.extend(Mg.default);var tu="/rest/search/v2",ru="/rest/ua",Gi=()=>({organizationId:"",accessToken:"",platformUrl:vo(),search:{apiBaseUrl:`${vo()}${tu}`,locale:"en-US",timezone:Hi.default.tz.guess(),authenticationProviders:[]},analytics:{enabled:!0,apiBaseUrl:`${Wg()}${ru}`,nextApiBaseUrl:"",originContext:"Search",originLevel2:"default",originLevel3:"default",anonymous:!1,deviceId:"",userDisplayName:"",documentLocation:"",trackingId:"",analyticsMode:"legacy",source:{}}});function nu(){return{contextValues:{}}}var Jn=()=>!1;function au(){return{contextValues:{}}}var ui=()=>({correctedQuery:"",wordCorrections:[],originalQuery:""}),Kg=()=>({correctedQuery:"",corrections:[],originalQuery:""});function Zg(){return{enableDidYouMean:!1,wasCorrectedTo:"",wasAutomaticallyCorrected:!1,queryCorrection:ui(),originalQuery:"",automaticallyCorrectQuery:!0,queryCorrectionMode:"legacy"}}function Xg(){return{length:void 0}}function lr(){return{enabled:!0}}function iu(){return{freezeFacetOrder:!1,facets:{}}}function Ji(){return{desiredCount:5,numberOfValues:8,set:{}}}function Ki(){return{}}function su(){return[]}function eh(){return{}}function th(){return{}}function rh(e){return{request:e,hasBreadcrumbs:!0}}function Zi(){return{}}function nh(e){return{request:e}}function Xi(){return{}}function ah(e){return{request:e}}function es(){return{}}var ou=["author","language","urihash","objecttype","collection","source","permanentid"],ih=[...ou,"date","filetype","parents"],JA=[...ih,"ec_price","ec_name","ec_description","ec_brand","ec_category","ec_item_group_id","ec_shortdesc","ec_thumbnails","ec_images","ec_promo_price","ec_in_stock","ec_rating"],sh=()=>({fieldsToInclude:ou,fetchAllFields:!1,fieldsDescription:[]}),cu=()=>({enabled:!1,fields:{collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"},filterFieldRange:2,collections:{}});function So(){return{id:"",isVisible:!0,isLoading:!1,isStreaming:!1,citations:[],liked:!1,disliked:!1,responseFormat:{answerStyle:"default",contentFormat:["text/plain"]},feedbackModalOpen:!1,feedbackSubmitted:!1,fieldsToIncludeInCitations:[],isAnswerGenerated:!1,expanded:!1}}function Ot(){return{firstResult:0,defaultNumberOfResults:10,numberOfResults:10,totalCountFiltered:0}}var Kn=()=>"";function uu(){return{}}var Ge=()=>({q:"",enableQuerySyntax:!1}),Zn=()=>"default";function oh(e,t){let r=`
  The following properties are invalid:

    ${e.join(`
	`)}
  
  ${t}
  `;return new Xn(r)}var Xn=class extends Error{constructor(e){super(e),this.name="SchemaValidationError"}},oe=class{constructor(e){this.definition=e}validate(e={},t=""){let r={...this.default,...e},n=[];for(let a in this.definition){let i=this.definition[a].validate(r[a]);i&&n.push(`${a}: ${i}`)}if(n.length)throw oh(n,t);return r}get default(){let e={};for(let t in this.definition){let r=this.definition[t].default;r!==void 0&&(e[t]=r)}return e}},he=class{constructor(e={}){this.baseConfig=e}validate(e){return this.baseConfig.required&&z(e)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return this.baseConfig.required===!0}};function ve(e){return e===void 0}function ch(e){return e===null}function z(e){return ve(e)||ch(e)}var Q=class{constructor(e={}){this.config=e,this.value=new he(e)}validate(e){return this.value.validate(e)||(uh(e)?e<this.config.min?`minimum value of ${this.config.min} not respected.`:e>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}};function uh(e){return ve(e)||lu(e)}function lu(e){return typeof e=="number"&&!isNaN(e)}var K=class{constructor(e={}){this.value=new he(e)}validate(e){return this.value.validate(e)||(lh(e)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}};function lh(e){return ve(e)||ts(e)}function ts(e){return typeof e=="boolean"}var dh=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i,x=class{constructor(e={}){this.config={emptyAllowed:!0,url:!1,...e},this.value=new he(this.config)}validate(e){let{emptyAllowed:t,url:r,regex:n,constrainTo:a}=this.config;return this.value.validate(e)||(ve(e)?null:ea(e)?!t&&!e.length?"value is an empty string.":r&&!dh.test(e)?"value is not a valid URL.":n&&!n.test(e)?`value did not match provided regex ${n}`:a&&!a.includes(e)?`value should be one of: ${a.join(", ")}.`:null:"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}};function ea(e){return Object.prototype.toString.call(e)==="[object String]"}var P=class{constructor(e={}){this.config={options:{required:!1},values:{},...e}}validate(e){if(ve(e))return this.config.options.required?"value is required and is currently undefined":null;if(!du(e))return"value is not an object";for(let[r,n]of Object.entries(this.config.values))if(n.required&&z(e[r]))return`value does not contain ${r}`;let t="";for(let[r,n]of Object.entries(this.config.values)){let a=e[r],i=n.validate(a);i!==null&&(t+=" "+i)}return t===""?null:t}get default(){}get required(){return!!this.config.options.required}};function du(e){return e!==void 0&&typeof e=="object"}var re=class{constructor(e={}){this.config=e,this.value=new he(this.config)}validate(e){if(!z(e)&&!Array.isArray(e))return"value is not an array";let t=this.value.validate(e);if(t!==null)return t;if(z(e))return null;if(this.config.max!==void 0&&e.length>this.config.max)return`value contains more than ${this.config.max}`;if(this.config.min!==void 0&&e.length<this.config.min)return`value contains less than ${this.config.min}`;if(this.config.each!==void 0){let r="";return e.forEach(n=>{this.config.each.required&&z(n)&&(r=`value is null or undefined: ${e.join(",")}`);let a=this.validatePrimitiveValue(n,this.config.each);a!==null&&(r+=" "+a)}),r===""?null:r}return null}validatePrimitiveValue(e,t){return ts(e)||ea(e)||lu(e)||du(e)?t.validate(e):"value is not a primitive value"}get default(){}get required(){return this.value.required}};function rs(e){return Array.isArray(e)}var Ft=class{constructor(e){this.config=e,this.value=new he(e)}validate(e){let t=this.value.validate(e);return t!==null?t:ve(e)||Object.values(this.config.enum).find(r=>r===e)?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}},fu=(e=>(e.Ascending="ascending",e.Descending="descending",e))(fu||{}),ns=(e=>(e.Relevancy="relevancy",e.QRE="qre",e.Date="date",e.Field="field",e.NoSort="nosort",e))(ns||{}),kr=e=>{if(rs(e))return e.map(t=>kr(t)).join(",");switch(e.by){case"relevancy":case"qre":case"nosort":return e.by;case"date":return`date ${e.order}`;case"field":return`@${e.field} ${e.order}`;default:return""}},pu=()=>({by:"relevancy"}),fh=e=>({by:"date",order:e}),ph=(e,t)=>({by:"field",order:t,field:e}),gh=()=>({by:"qre"}),hh=()=>({by:"nosort"}),yh=new P({values:{by:new Ft({enum:ns,required:!0}),order:new Ft({enum:fu}),field:new x}});function Xt(){return kr(pu())}function gu(){return{}}function hu(){return{}}function mh(){return et({})}function et(e){return{context:e.context||nu(),dictionaryFieldContext:e.dictionaryFieldContext||au(),facetSet:e.facetSet||Zi(),numericFacetSet:e.numericFacetSet||es(),dateFacetSet:e.dateFacetSet||Xi(),categoryFacetSet:e.categoryFacetSet||Ki(),automaticFacetSet:e.automaticFacetSet??Ji(),pagination:e.pagination||Ot(),query:e.query||Ge(),tabSet:e.tabSet||hu(),advancedSearchQueries:e.advancedSearchQueries||At(),staticFilterSet:e.staticFilterSet||gu(),querySet:e.querySet||uu(),sortCriteria:e.sortCriteria||Xt(),pipeline:e.pipeline||Kn(),searchHub:e.searchHub||Zn(),facetOptions:e.facetOptions||iu(),facetOrder:e.facetOrder??su(),debug:e.debug??Jn()}}function vh(){return{}}var wo=()=>({liked:!1,disliked:!1,expanded:!1,feedbackModalOpen:!1,relatedQuestions:[]});function Sh(){return{queries:[],maxLength:10}}function wh(){return{results:[],maxLength:10}}function yu(){return{uniqueId:"",content:"",isLoading:!1,position:-1,resultsWithPreview:[]}}function On(){return{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}}function ft(){return{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:On(),pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],searchResponseId:"",requestId:"",questionAnswer:On(),extendedResults:{}}}function bh(){return{}}var Ch=()=>({redirectTo:"",query:"",executions:[],notifications:[],queryModification:{originalQuery:"",newQuery:"",queryToIgnore:""}}),Ih={};ig(Ih,{escape:()=>$t,getHighlightedSuggestion:()=>mu,highlightString:()=>kh});function kh(e){if(Ea(e.openingDelimiter)||Ea(e.closingDelimiter))throw Error("delimiters should be a non-empty string");if(z(e.content)||Ea(e.content))return e.content;if(e.highlights.length===0)return $t(e.content);let t=e.content.length,r="",n=0;for(let a=0;a<e.highlights.length;a++){let i=e.highlights[a],s=i.offset,o=s+i.length;if(o>t)break;r+=$t(e.content.slice(n,s)),r+=e.openingDelimiter,r+=$t(e.content.slice(s,o)),r+=e.closingDelimiter,n=o}return n!==t&&(r+=$t(e.content.slice(n))),r}function mu(e,t){return e=$t(e),e.replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,(r,n,a,i)=>n?Da(n,t.notMatchDelimiters):a?Da(a,t.exactMatchDelimiters):i?Da(i,t.correctionDelimiters):r)}function Da(e,t){return t?t.open+e+t.close:e}function $t(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r="(?:"+Object.keys(t).join("|")+")",n=RegExp(r),a=RegExp(r,"g");return n.test(e)?e.replace(a,i=>t[i]):e}function be(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var qh=typeof Symbol=="function"&&Symbol.observable||"@@observable",bo=qh,Ta=()=>Math.random().toString(36).substring(7).split("").join("."),xh={INIT:`@@redux/INIT${Ta()}`,REPLACE:`@@redux/REPLACE${Ta()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Ta()}`},Fn=xh;function as(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function vu(e,t,r){if(typeof e!="function")throw new Error(be(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(be(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(be(1));return r(vu)(e,t)}let n=e,a=t,i=new Map,s=i,o=0,c=!1;function u(){s===i&&(s=new Map,i.forEach((p,h)=>{s.set(h,p)}))}function d(){if(c)throw new Error(be(3));return a}function f(p){if(typeof p!="function")throw new Error(be(4));if(c)throw new Error(be(5));let h=!0;u();let y=o++;return s.set(y,p),function(){if(h){if(c)throw new Error(be(6));h=!1,u(),s.delete(y),i=null}}}function l(p){if(!as(p))throw new Error(be(7));if(typeof p.type>"u")throw new Error(be(8));if(typeof p.type!="string")throw new Error(be(17));if(c)throw new Error(be(9));try{c=!0,a=n(a,p)}finally{c=!1}return(i=s).forEach(h=>{h()}),p}function g(p){if(typeof p!="function")throw new Error(be(10));n=p,l({type:Fn.REPLACE})}function v(){let p=f;return{subscribe(h){if(typeof h!="object"||h===null)throw new Error(be(11));function y(){let k=h;k.next&&k.next(d())}return y(),{unsubscribe:p(y)}},[bo](){return this}}}return l({type:Fn.INIT}),{dispatch:l,subscribe:f,getState:d,replaceReducer:g,[bo]:v}}function Ah(e){Object.keys(e).forEach(t=>{let r=e[t];if(typeof r(void 0,{type:Fn.INIT})>"u")throw new Error(be(12));if(typeof r(void 0,{type:Fn.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(be(13))})}function Su(e){let t=Object.keys(e),r={};for(let i=0;i<t.length;i++){let s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}let n=Object.keys(r),a;try{Ah(r)}catch(i){a=i}return function(i={},s){if(a)throw a;let o=!1,c={};for(let u=0;u<n.length;u++){let d=n[u],f=r[d],l=i[d],g=f(l,s);if(typeof g>"u")throw new Error(be(14));c[d]=g,o=o||g!==l}return o=o||n.length!==Object.keys(i).length,o?c:i}}function Rn(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function Oh(...e){return t=>(r,n)=>{let a=t(r,n),i=()=>{throw new Error(be(15))},s={getState:a.getState,dispatch:(c,...u)=>i(c,...u)},o=e.map(c=>c(s));return i=Rn(...o)(a.dispatch),{...a,dispatch:i}}}function Fh(e){return as(e)&&"type"in e&&typeof e.type=="string"}var wu=Symbol.for("immer-nothing"),Co=Symbol.for("immer-draftable"),Me=Symbol.for("immer-state");function Le(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Gt=Object.getPrototypeOf;function pt(e){return!!e&&!!e[Me]}function rt(e){var t;return e?bu(e)||Array.isArray(e)||!!e[Co]||!!((t=e.constructor)!=null&&t[Co])||ra(e)||na(e):!1}var Rh=Object.prototype.constructor.toString();function bu(e){if(!e||typeof e!="object")return!1;let t=Gt(e);if(t===null)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Rh}function qr(e,t){ta(e)===0?Object.entries(e).forEach(([r,n])=>{t(r,n,e)}):e.forEach((r,n)=>t(n,r,e))}function ta(e){let t=e[Me];return t?t.type_:Array.isArray(e)?1:ra(e)?2:na(e)?3:0}function li(e,t){return ta(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Cu(e,t,r){let n=ta(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Eh(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function ra(e){return e instanceof Map}function na(e){return e instanceof Set}function Ct(e){return e.copy_||e.base_}function di(e,t){if(ra(e))return new Map(e);if(na(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&bu(e))return Gt(e)?{...e}:Object.assign(Object.create(null),e);let r=Object.getOwnPropertyDescriptors(e);delete r[Me];let n=Reflect.ownKeys(r);for(let a=0;a<n.length;a++){let i=n[a],s=r[i];s.writable===!1&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(r[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[i]})}return Object.create(Gt(e),r)}function is(e,t=!1){return aa(e)||pt(e)||!rt(e)||(ta(e)>1&&(e.set=e.add=e.clear=e.delete=Dh),Object.freeze(e),t&&qr(e,(r,n)=>is(n,!0))),e}function Dh(){Le(2)}function aa(e){return Object.isFrozen(e)}var Th={};function Rt(e){let t=Th[e];return t||Le(0,e),t}var xr;function Iu(){return xr}function Mh(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Io(e,t){t&&(Rt("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function fi(e){pi(e),e.drafts_.forEach(Ph),e.drafts_=null}function pi(e){e===xr&&(xr=e.parent_)}function ko(e){return xr=Mh(xr,e)}function Ph(e){let t=e[Me];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function qo(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[Me].modified_&&(fi(t),Le(4)),rt(e)&&(e=En(t,e),t.parent_||Dn(t,e)),t.patches_&&Rt("Patches").generateReplacementPatches_(r[Me].base_,e,t.patches_,t.inversePatches_)):e=En(t,r,[]),fi(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==wu?e:void 0}function En(e,t,r){if(aa(t))return t;let n=t[Me];if(!n)return qr(t,(a,i)=>xo(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Dn(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let a=n.copy_,i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),qr(i,(o,c)=>xo(e,n,a,o,c,r,s)),Dn(e,a,!1),r&&e.patches_&&Rt("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function xo(e,t,r,n,a,i,s){if(pt(a)){let o=i&&t&&t.type_!==3&&!li(t.assigned_,n)?i.concat(n):void 0,c=En(e,a,o);if(Cu(r,n,c),pt(c))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(rt(a)&&!aa(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;En(e,a),(!t||!t.scope_.parent_)&&Dn(e,a)}}function Dn(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&is(t,r)}function Uh(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Iu(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},a=n,i=ss;r&&(a=[n],i=Ar);let{revoke:s,proxy:o}=Proxy.revocable(a,i);return n.draft_=o,n.revoke_=s,o}var ss={get(e,t){if(t===Me)return e;let r=Ct(e);if(!li(r,t))return jh(e,r,t);let n=r[t];return e.finalized_||!rt(n)?n:n===Ma(e.base_,t)?(Pa(e),e.copy_[t]=hi(n,e)):n},has(e,t){return t in Ct(e)},ownKeys(e){return Reflect.ownKeys(Ct(e))},set(e,t,r){let n=ku(Ct(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let a=Ma(Ct(e),t),i=a==null?void 0:a[Me];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Eh(r,a)&&(r!==void 0||li(e.base_,t)))return!0;Pa(e),gi(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Ma(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Pa(e),gi(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=Ct(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Le(11)},getPrototypeOf(e){return Gt(e.base_)},setPrototypeOf(){Le(12)}},Ar={};qr(ss,(e,t)=>{Ar[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Ar.deleteProperty=function(e,t){return Ar.set.call(this,e,t,void 0)};Ar.set=function(e,t,r){return ss.set.call(this,e[0],t,r,e[0])};function Ma(e,t){let r=e[Me];return(r?Ct(r):e)[t]}function jh(e,t,r){var a;let n=ku(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function ku(e,t){if(!(t in e))return;let r=Gt(e);for(;r;){let n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Gt(r)}}function gi(e){e.modified_||(e.modified_=!0,e.parent_&&gi(e.parent_))}function Pa(e){e.copy_||(e.copy_=di(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Vh=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){let i=r;r=t;let s=this;return function(o=i,...c){return s.produce(o,u=>r.call(this,u,...c))}}typeof r!="function"&&Le(6),n!==void 0&&typeof n!="function"&&Le(7);let a;if(rt(t)){let i=ko(this),s=hi(t,void 0),o=!0;try{a=r(s),o=!1}finally{o?fi(i):pi(i)}return Io(i,n),qo(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===wu&&(a=void 0),this.autoFreeze_&&is(a,!0),n){let i=[],s=[];Rt("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else Le(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...s)=>this.produceWithPatches(i,o=>t(o,...s));let n,a;return[this.produce(t,r,(i,s)=>{n=i,a=s}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){rt(e)||Le(8),pt(e)&&(e=qu(e));let t=ko(this),r=hi(e,void 0);return r[Me].isManual_=!0,pi(t),r}finishDraft(e,t){let r=e&&e[Me];(!r||!r.isManual_)&&Le(9);let{scope_:n}=r;return Io(n,t),qo(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));let n=Rt("Patches").applyPatches_;return pt(e)?n(e,t):this.produce(e,a=>n(a,t))}};function hi(e,t){let r=ra(e)?Rt("MapSet").proxyMap_(e,t):na(e)?Rt("MapSet").proxySet_(e,t):Uh(e,t);return(t?t.scope_:Iu()).drafts_.push(r),r}function qu(e){return pt(e)||Le(10,e),xu(e)}function xu(e){if(!rt(e)||aa(e))return e;let t=e[Me],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=di(e,t.scope_.immer_.useStrictShallowCopy_)}else r=di(e,!0);return qr(r,(n,a)=>{Cu(r,n,xu(a))}),t&&(t.finalized_=!1),r}var Pe=new Vh,Au=Pe.produce;Pe.produceWithPatches.bind(Pe);Pe.setAutoFreeze.bind(Pe);Pe.setUseStrictShallowCopy.bind(Pe);Pe.applyPatches.bind(Pe);Pe.createDraft.bind(Pe);Pe.finishDraft.bind(Pe);function _h(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Lh(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function $h(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){let r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var Ao=e=>Array.isArray(e)?e:[e];function Qh(e){let t=Array.isArray(e[0])?e[0]:e;return $h(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function zh(e,t){let r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var Nh=class{constructor(e){this.value=e}deref(){return this.value}},Bh=typeof WeakRef<"u"?WeakRef:Nh,Hh=0,Oo=1;function dn(){return{s:Hh,v:void 0,o:null,p:null}}function os(e,t={}){let r=dn(),{resultEqualityCheck:n}=t,a,i=0;function s(){var f;let o=r,{length:c}=arguments;for(let l=0,g=c;l<g;l++){let v=arguments[l];if(typeof v=="function"||typeof v=="object"&&v!==null){let p=o.o;p===null&&(o.o=p=new WeakMap);let h=p.get(v);h===void 0?(o=dn(),p.set(v,o)):o=h}else{let p=o.p;p===null&&(o.p=p=new Map);let h=p.get(v);h===void 0?(o=dn(),p.set(v,o)):o=h}}let u=o,d;if(o.s===Oo?d=o.v:(d=e.apply(null,arguments),i++),u.s=Oo,n){let l=((f=a==null?void 0:a.deref)==null?void 0:f.call(a))??a;l!=null&&n(l,d)&&(d=l,i!==0&&i--),a=typeof d=="object"&&d!==null||typeof d=="function"?new Bh(d):d}return u.v=d,d}return s.clearCache=()=>{r=dn(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function Ou(e,...t){let r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,o,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),_h(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);let d={...r,...c},{memoize:f,memoizeOptions:l=[],argsMemoize:g=os,argsMemoizeOptions:v=[],devModeChecks:p={}}=d,h=Ao(l),y=Ao(v),k=Qh(a),D=f(function(){return i++,u.apply(null,arguments)},...h),U=g(function(){s++;let _=zh(k,arguments);return o=D.apply(null,_),o},...y);return Object.assign(U,{resultFunc:u,memoizedResultFunc:D,dependencies:k,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:f,argsMemoize:g})};return Object.assign(n,{withTypes:()=>n}),n}var fe=Ou(os),Yh=Object.assign((e,t=fe)=>{Lh(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e),n=r.map(a=>e[a]);return t(n,(...a)=>a.reduce((i,s,o)=>(i[r[o]]=s,i),{}))},{withTypes:()=>Yh});function Fu(e){return({dispatch:t,getState:r})=>n=>a=>typeof a=="function"?a(t,r,e):n(a)}var Wh=Fu(),Gh=Fu,Jh=(...e)=>{let t=Ou(...e),r=Object.assign((...n)=>{let a=t(...n),i=(s,...o)=>a(pt(s)?qu(s):s,...o);return Object.assign(i,a),i},{withTypes:()=>r});return r};Jh(os);var Kh=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Rn:Rn.apply(null,arguments)},Zh=e=>e&&typeof e.match=="function";function S(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(gt(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>Fh(n)&&n.type===e,r}var Ru=class hr extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,hr.prototype)}static get[Symbol.species](){return hr}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new hr(...t[0].concat(this)):new hr(...t.concat(this))}};function Fo(e){return rt(e)?Au(e,()=>{}):e}function Xh(e){return typeof e=="boolean"}var ey=()=>function(e){let{thunk:t=!0,immutableCheck:r=!0,serializableCheck:n=!0,actionCreatorCheck:a=!0}=e??{},i=new Ru;return t&&(Xh(t)?i.push(Wh):i.push(Gh(t.extraArgument))),i},ty="RTK_autoBatch",Eu=e=>t=>{setTimeout(t,e)},ry=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Eu(10),ny=(e={type:"raf"})=>t=>(...r)=>{let n=t(...r),a=!0,i=!1,s=!1,o=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?ry:e.type==="callback"?e.queueNotification:Eu(e.timeout),u=()=>{s=!1,i&&(i=!1,o.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){let f=()=>a&&d(),l=n.subscribe(f);return o.add(d),()=>{l(),o.delete(d)}},dispatch(d){var f;try{return a=!((f=d==null?void 0:d.meta)!=null&&f[ty]),i=!a,i&&(s||(s=!0,c(u))),n.dispatch(d)}finally{a=!0}}})},ay=e=>function(t){let{autoBatch:r=!0}=t??{},n=new Ru(e);return r&&n.push(ny(typeof r=="object"?r:void 0)),n},Ro=!0;function iy(e){let t=ey(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{},o;if(typeof r=="function")o=r;else if(as(r))o=Su(r);else throw new Error(gt(1));let c;typeof n=="function"?c=n(t):c=t();let u=Rn;a&&(u=Kh({trace:!Ro,...typeof a=="object"&&a}));let d=Oh(...c),f=ay(d),l=typeof s=="function"?s(f):f(),g=u(...l);return vu(o,i,g)}function sy(e){let t={},r=[],n,a={addCase(i,s){let o=typeof i=="string"?i:i.type;if(!o)throw new Error(gt(28));if(o in t)throw new Error(gt(29));return t[o]=s,a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function oy(e){return typeof e=="function"}function W(e,t){let[r,n,a]=sy(t),i;if(oy(e))i=()=>Fo(e());else{let o=Fo(e);i=()=>o}function s(o=i(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[a]),u.reduce((d,f)=>{if(f)if(pt(d)){let l=f(d,c);return l===void 0?d:l}else{if(rt(d))return Au(d,l=>f(l,c));{let l=f(d,c);if(l===void 0){if(d===null)return d;throw new Error(gt(9))}return l}}return d},o)}return s.getInitialState=i,s}var cy="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Du=(e=21)=>{let t="",r=e;for(;r--;)t+=cy[Math.random()*64|0];return t},uy=(e,t)=>Zh(e)?e.match(t):e(t);function ly(...e){return t=>e.some(r=>uy(r,t))}var dy=["name","message","stack","code"],Ua=class{constructor(e,t){zc(this,"_type"),this.payload=e,this.meta=t}},Eo=class{constructor(e,t){zc(this,"_type"),this.payload=e,this.meta=t}},fy=e=>{if(typeof e=="object"&&e!==null){let t={};for(let r of dy)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},B=(()=>{function e(t,r,n){let a=S(t+"/fulfilled",(c,u,d,f)=>({payload:c,meta:{...f||{},arg:d,requestId:u,requestStatus:"fulfilled"}})),i=S(t+"/pending",(c,u,d)=>({payload:void 0,meta:{...d||{},arg:u,requestId:c,requestStatus:"pending"}})),s=S(t+"/rejected",(c,u,d,f,l)=>({payload:f,error:(n&&n.serializeError||fy)(c||"Rejected"),meta:{...l||{},arg:d,requestId:u,rejectedWithValue:!!f,requestStatus:"rejected",aborted:(c==null?void 0:c.name)==="AbortError",condition:(c==null?void 0:c.name)==="ConditionError"}}));function o(c){return(u,d,f)=>{let l=n!=null&&n.idGenerator?n.idGenerator(c):Du(),g=new AbortController,v,p;function h(k){p=k,g.abort()}let y=async function(){var D,U;let k;try{let _=(D=n==null?void 0:n.condition)==null?void 0:D.call(n,c,{getState:d,extra:f});if(gy(_)&&(_=await _),_===!1||g.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};let H=new Promise((L,N)=>{v=()=>{N({name:"AbortError",message:p||"Aborted"})},g.signal.addEventListener("abort",v)});u(i(l,c,(U=n==null?void 0:n.getPendingMeta)==null?void 0:U.call(n,{requestId:l,arg:c},{getState:d,extra:f}))),k=await Promise.race([H,Promise.resolve(r(c,{dispatch:u,getState:d,extra:f,requestId:l,signal:g.signal,abort:h,rejectWithValue:(L,N)=>new Ua(L,N),fulfillWithValue:(L,N)=>new Eo(L,N)})).then(L=>{if(L instanceof Ua)throw L;return L instanceof Eo?a(L.payload,l,c,L.meta):a(L,l,c)})])}catch(_){k=_ instanceof Ua?s(null,l,c,_.payload,_.meta):s(_,l,c)}finally{v&&g.signal.removeEventListener("abort",v)}return n&&!n.dispatchConditionRejection&&s.match(k)&&k.meta.condition||u(k),k}();return Object.assign(y,{abort:h,requestId:l,arg:c,unwrap(){return y.then(py)}})}}return Object.assign(o,{pending:i,rejected:s,fulfilled:a,settled:ly(s,a),typePrefix:t})}return e.withTypes=()=>e,e})();function py(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function gy(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var hy=(e,t)=>{if(typeof e!="function")throw new Error(gt(32))},cs="listenerMiddleware",yy=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=S(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(gt(21));return hy(i),{predicate:a,type:t,effect:i}},my=Object.assign(e=>{let{type:t,predicate:r,effect:n}=yy(e);return{id:Du(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(gt(22))}}},{withTypes:()=>my}),vy=Object.assign(S(`${cs}/add`),{withTypes:()=>vy});S(`${cs}/removeAll`);var Sy=Object.assign(S(`${cs}/remove`),{withTypes:()=>Sy});function gt(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}async function wy(e,t){let r=e.getReader(),n;for(;!(n=await r.read()).done;)t(n.value)}function by(e){let t,r,n,a=!1;return function(i){t===void 0?(t=i,r=0,n=-1):t=Iy(t,i);let s=t.length,o=0;for(;r<s;){a&&(t[r]===10&&(o=++r),a=!1);let c=-1;for(;r<s&&c===-1;++r)switch(t[r]){case 58:n===-1&&(n=r-o);break;case 13:a=!0;case 10:c=r;break}if(c===-1)break;e(t.subarray(o,c),n),o=r,n=-1}o===s?t=void 0:o!==0&&(t=t.subarray(o),r-=o)}}function Cy(e,t,r){let n=Do(),a=new TextDecoder;return function(i,s){if(i.length===0)r==null||r(n),n=Do();else if(s>0){let o=a.decode(i.subarray(0,s)),c=s+(i[s+1]===32?2:1),u=a.decode(i.subarray(c));switch(o){case"data":n.data=n.data?n.data+`
`+u:u;break;case"event":n.event=u;break;case"id":e(n.id=u);break;case"retry":let d=parseInt(u,10);isNaN(d)||t(n.retry=d);break}}}}function Iy(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function Do(){return{data:"",event:"",id:"",retry:void 0}}var ky=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},yi="text/event-stream",qy=1e3,To="last-event-id";function xy(e,t){var{signal:r,headers:n,onopen:a,onmessage:i,onclose:s,onerror:o,openWhenHidden:c,fetch:u}=t,d=ky(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise((f,l)=>{let g=Object.assign({},n);g.accept||(g.accept=yi);let v;function p(){v==null||v.abort(),document.hidden||_()}!c&&void 0&&document.addEventListener("visibilitychange",p);let h=qy,y=0;function k(){void 0&&document.removeEventListener("visibilitychange",p),clearTimeout(y),v==null||v.abort()}r==null||r.addEventListener("abort",()=>{k(),f()});let D=u??D,U=a??Ay;async function _(){var H;v=typeof AbortController>"u"?null:new AbortController;try{let L=await D(e,Object.assign(Object.assign({},d),{headers:g,signal:v==null?void 0:v.signal}));await U(L),await wy(L.body,by(Cy(N=>{N?g[To]=N:delete g[To]},N=>{h=N},i))),s==null||s(),k(),f()}catch(L){if(!(v!=null&&v.signal.aborted))try{let N=(H=o==null?void 0:o(L))!==null&&H!==void 0?H:h;clearTimeout(y),y=setTimeout(_,N)}catch(N){k(),l(N)}}}_()})}function Ay(e){let t=e.headers.get("content-type");if(!(t!=null&&t.startsWith(yi)))throw new Error(`Expected content-type to be ${yi}, Actual: ${t}`)}function Tu(){if(typeof window>"u"){let{AbortController:e}=bg();return new e}return typeof AbortController>"u"?null:new AbortController}var us=class{constructor(e){this._params={},this._basePath=e}addParam(e,t){this._params={...this.params,[e]:t}}get basePath(){return this._basePath}get params(){return this._params}get hasParams(){return Object.entries(this._params).length}get href(){return this.hasParams?`${this.basePath}?${Object.entries(this.params).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&")}`:this.basePath}},Oy=e=>/^https:\/\/platform(dev|stg|hipaa)?(-)?(eu|au)?\.cloud\.coveo\.com/.test(e),Fy=(e,t)=>{let r=Mu(e);return r&&r.organizationId===t?r:null},Mu=e=>{let t=e.match(/^https:\/\/(?<organizationId>\w+)\.org(?<environment>dev|stg|hipaa)?\.coveo\.com/);return t!=null&&t.groups?t.groups:null},Ry=(e,t,r)=>new us(`${e}/rest/organizations/${t}/machinelearning/streaming/${r}`).href,Mo=3,Ey=5e3,Dy="text/event-stream",Pu=1,Ty=class extends Error{},ja=class extends Error{constructor(e){super(e.message),this.payload=e}},My=class{constructor(){this.timeouts=new Set}add(e){this.timeouts.add(e)}remove(e){clearTimeout(e),this.timeouts.delete(e)}isActive(e){return this.timeouts.has(e)}},Py=class{constructor(e){this.logger=e.logger}streamGeneratedAnswer(e,t){let{url:r,organizationId:n,streamId:a,accessToken:i}=e,{write:s,abort:o,close:c,resetAnswer:u}=t,d=new My;if(!a){this.logger.error("No stream ID found");return}let f=0,l,g=()=>{l&&!d.isActive(l)&&(p==null||p.abort(),u(),h())},v=()=>{d.remove(l),l=zg(g,l,Ey),d.add(l)},p=Tu(),h=()=>xy(Ry(r,n,a),{method:"GET",fetch,headers:{Authorization:`Bearer ${i}`,accept:"*/*"},openWhenHidden:!0,signal:p==null?void 0:p.signal,async onopen(y){if(!(y.ok&&y.headers.get("content-type")===Dy))throw y.status>=400&&y.status<500&&y.status!==429?new ja({message:"Error opening stream",code:y.status}):new Ty},onmessage:y=>{if(p!=null&&p.signal.aborted)return;let k=JSON.parse(y.data);if(k.finishReason==="ERROR"){d.remove(l),p==null||p.abort(),o({message:k.errorMessage,code:k.statusCode});return}s(k),f=0,k.finishReason==="COMPLETED"?(d.remove(l),c()):v()},onerror:y=>{if(!(p!=null&&p.signal.aborted)){if(d.remove(l),y instanceof ja)throw p==null||p.abort(),o(y),y;if(++f>Mo){this.logger.info("Maximum retry exceeded.");let k={message:"Failed to complete stream.",code:Pu};throw p==null||p.abort(),o(k),new ja(k)}this.logger.info(`Retrying...(${f}/${Mo})`),u()}}});return h(),p}},Uu=e=>e;function It(e){let{url:t,accessToken:r,organizationId:n,authentication:a,...i}=e;return i}var kt=e=>{let{response:t}=e;return t.body?Uy(e):jy(t)},Uy=e=>_y(e)?Ly(e):Vy(e)?e.body:{message:"unknown",statusCode:0,type:"unknown"},jy=e=>{let t=JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)));return{...t,message:`Client side error: ${t.message||""}`,statusCode:400,type:"ClientError"}};function Vy(e){return e.body.statusCode!==void 0}function _y(e){return e.body.exception!==void 0}var Ly=e=>({message:e.body.exception.code,statusCode:e.response.status,type:e.body.exception.code}),dr=class{constructor(){this.currentAbortController=null}async enqueue(e,t){let r=this.currentAbortController,n=this.currentAbortController=Tu();r&&(t.warnOnAbort&&t.logger.warn("Cancelling current pending search query"),r.abort());try{return await e((n==null?void 0:n.signal)??null)}finally{this.currentAbortController===n&&(this.currentAbortController=null)}}};function $y(e){return((e.headers.get("content-type")||"").split(";").find(t=>t.indexOf("charset=")!==-1)||"").split("=")[1]||"UTF-8"}var lt=(e,t,r,n)=>{let a=new us(`${e.url}${n}`);return a.addParam("organizationId",e.organizationId),e.authentication&&a.addParam("authentication",e.authentication),{accessToken:e.accessToken,method:t,contentType:r,url:a.href,origin:"searchApiFetch"}},Qy=(e,t)=>{let r=new us(`${e.url}${t}`);return r.addParam("access_token",e.accessToken),r.addParam("organizationId",e.organizationId),r.addParam("uniqueId",e.uniqueId),e.q!==void 0&&r.addParam("q",e.q),e.enableNavigation!==void 0&&r.addParam("enableNavigation",`${e.enableNavigation}`),e.requestedOutputSize!==void 0&&r.addParam("requestedOutputSize",`${e.requestedOutputSize}`),e.visitorId!==void 0&&r.addParam("visitorId",`${e.visitorId}`),r.href},zy=async(e,t)=>{let r=await ut.call({...lt(e,"POST","application/x-www-form-urlencoded","/html"),requestParams:It(e),requestMetadata:{method:"html"},...t});if(r instanceof Error)throw r;let n=$y(r),a=await r.arrayBuffer(),i=new TextDecoder(n).decode(a);return Ny(i)?{success:i}:{error:kt({response:r,body:i})}};function Ny(e){return typeof e=="string"}function By(e){return{statusCode:e.statusCode,type:e.name,message:e.message}}function Hy(e){return{statusCode:e.code,type:e.name,message:e.message,ignored:!0}}function Va(e,t){if(t&&e.name==="AbortError")return{error:Hy(e)};if(e instanceof ci)return{error:By(e)};throw e}var Yy=class{constructor(e){this.options=e,this.apiCallsQueues={unknown:new dr,mainSearch:new dr,facetValues:new dr,foldingCollection:new dr,instantResults:new dr}}async plan(e){let t=await ut.call({...lt(e,"POST","application/json","/plan"),requestParams:It(e),requestMetadata:{method:"plan"},...this.options});if(t instanceof Error)return Va(t);let r=await t.json();return Jy(r)?{success:r}:{error:kt({response:t,body:r})}}async querySuggest(e){let t=await ut.call({...lt(e,"POST","application/json","/querySuggest"),requestMetadata:{method:"querySuggest"},requestParams:It(e),...this.options});if(t instanceof Error)return Va(t);let r=await t.json(),n={response:t,body:r};return Gy(r)?{success:(await this.options.postprocessQuerySuggestResponseMiddleware(n)).body}:{error:kt(n)}}async search(e,t){let r=(t==null?void 0:t.origin)??"unknown",n=await this.apiCallsQueues[r].enqueue(s=>ut.call({...lt(e,"POST","application/json",""),requestParams:It(e),requestMetadata:{method:"search",origin:t==null?void 0:t.origin},...this.options,signal:s??void 0}),{logger:this.options.logger,warnOnAbort:!(t!=null&&t.disableAbortWarning)});if(n instanceof Error)return Va(n,t==null?void 0:t.disableAbortWarning);let a=await n.json(),i={response:n,body:a};return _a(a)?(i.body=Wy(a),{success:(await this.options.postprocessSearchResponseMiddleware(i)).body}):{error:kt(i)}}async facetSearch(e){let t=await ut.call({...lt(e,"POST","application/json","/facet"),requestParams:It(e),requestMetadata:{method:"facetSearch"},...this.options});if(t instanceof Error)throw t;let r=await t.json(),n={response:t,body:r};return(await this.options.postprocessFacetSearchResponseMiddleware(n)).body}async recommendations(e){let t=await ut.call({...lt(e,"POST","application/json",""),requestParams:It(e),requestMetadata:{method:"recommendations"},...this.options});if(t instanceof Error)throw t;let r=await t.json();return _a(r)?{success:r}:{error:kt({response:t,body:r})}}async html(e){return zy(e,{...this.options})}async productRecommendations(e){let t=await ut.call({...lt(e,"POST","application/json",""),requestParams:It(e),requestMetadata:{method:"productRecommendations"},...this.options});if(t instanceof Error)throw t;let r=await t.json();return _a(r)?{success:r}:{error:kt({response:t,body:r})}}async fieldDescriptions(e){let t=await ut.call({...lt(e,"GET","application/json","/fields"),requestParams:{},requestMetadata:{method:"fieldDescriptions"},...this.options});if(t instanceof Error)throw t;let r=await t.json();return Ky(r)?{success:r}:{error:kt({response:t,body:r})}}},ju=e=>e.success!==void 0,$e=e=>e.error!==void 0;function _a(e){return e.results!==void 0}function Wy(e){let t=On();return z(e.questionAnswer)?(e.questionAnswer=t,e):(e.questionAnswer={...t,...e.questionAnswer},e)}function Gy(e){return e.completions!==void 0}function Jy(e){return e.preprocessingOutput!==void 0}function Ky(e){return e.fields!==void 0}var Zy=e=>e,Xy=e=>e,em=e=>e,T=new x({required:!0,emptyAllowed:!1}),ae=new x({required:!1,emptyAllowed:!1}),Se=new x({required:!0,emptyAllowed:!0}),tm=new x({required:!1,emptyAllowed:!0}),Vu=new re({each:T,required:!0}),rm=new x({required:!1,emptyAllowed:!1,regex:/^\d+\.\d+\.\d+$/}),Dt=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),Tt=(e,t)=>{if("required"in t)return{payload:new oe({value:t}).validate({value:e}).value};let r=new P({options:{required:!0},values:t}).validate(e);if(r)throw new Xn(r);return{payload:e}},I=(e,t)=>{try{return Tt(e,t)}catch(r){return{payload:e,error:Dt(r)}}},Mt=(e,t,r,n)=>{let a=`Check the initialState of ${n}`;return _u(e,t,r,a,"Controller initialization error")},_e=(e,t,r,n)=>{let a=`Check the options of ${n}`;return _u(e,t,r,a,"Controller initialization error")},_u=(e,t,r,n,a)=>{try{return t.validate(r,n)}catch(i){throw e.logger.error(i,a),i}};function nm({config:e,environment:t,event:r,listenerManager:n}){let{url:a,token:i,mode:s}=e;s!=="disabled"&&(n.call(r),t.send(a,i,r))}var am=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function im(e){return typeof e=="string"&&am.test(e)}function sm(e){let t="visitorId";return{getClientId:()=>{let r=e.get(),n=r.storage,a=n.getItem(t),i=a&&im(a)?a:r.generateUUID();return n.setItem(t,i),i},clear:()=>{e.get().storage.removeItem(t)}}}var Lu="0.7.7";function om(e){let{trackingId:t}=e;return{trackingId:t}}function cm(e){return(e.source||[]).concat([`relay@${Lu}`])}function $u(e,t,r,n){let{getReferrer:a,getLocation:i,getUserAgent:s}=r,o=om(t),c=n.getClientId();return Object.freeze({type:e,config:o,ts:Date.now(),source:cm(t),clientId:c,userAgent:s(),referrer:a(),location:i()})}function um(e,t,r,n,a){return{...t,meta:$u(e,r,n,a)}}var lm="*";function dm(){let e=[];function t({type:c,callback:u}){return e.findIndex(d=>d.type===c&&d.callback===u)}function r(c,u){return c.type==="*"||u===c.type}function n(c){return t(c)<0&&e.push(c),()=>o(c.type,c.callback)}function a(c){e.forEach(u=>{if(r(u,c.meta.type))try{u.callback(c)}catch(d){console.error(d)}})}function i(c){if(c===lm)e.length=0;else for(let u=e.length-1;u>=0;u--)e[u].type===c&&e.splice(u,1)}function s(c){let u=t(c);u>=0&&e.splice(u,1)}function o(c,u){u?s({type:c,callback:u}):i(c)}return{add:n,call:a,remove:o}}function Po({url:e,token:t,trackingId:r,...n}){return Object.freeze({url:e,token:t,trackingId:r,...!!n.mode&&{mode:n.mode},...!!n.source&&{source:n.source}})}function fm(e){let t=Po(e);return{get:()=>t,update:r=>{t=Po({...t,...r})}}}function pm(){let e=typeof window<"u";return{sendMessage(t){e&&window.postMessage(t,"*")}}}var La=gm();function gm(){let e="coveo_",t=r=>{let n=r.split(".").slice(-2);return n.length==2?n.join("."):""};return{getItem(r){let n=`${e}${r}=`,a=document.cookie.split(";");for(let i of a){let s=i.replace(/^\s+/,"");if(s.lastIndexOf(n,0)===0)return s.substring(n.length,s.length)}return null},setItem(r,n,a){let i=t(window.location.hostname),s=`;expires=${new Date(new Date().getTime()+a).toUTCString()}`,o=i?`;domain=${i}`:"";document.cookie=`${e}${r}=${n}${s}${o};path=/;SameSite=Lax`},removeItem(r){this.setItem(r,"",-1)}}}function hm(){return{getItem(e){return La.getItem(e)||localStorage.getItem(e)},removeItem(e){La.removeItem(e),localStorage.removeItem(e)},setItem(e,t){localStorage.setItem(e,t),La.setItem(e,t,31556952e3)}}}function ym(){let e=document.referrer;return e===""?null:e}function mm(){return{runtime:"browser",send:(e,t,r)=>{let n=navigator.sendBeacon(`${e}?access_token=${t}`,new Blob([JSON.stringify([r])],{type:"application/json"}));if(pm().sendMessage({kind:"EVENT_PROTOCOL",event:r,url:e,token:t}),!n)throw new Error("Failed to send the event(s) because the payload size exceeded the maximum allowed size (32 KB). Please contact support if the problem persists.")},getReferrer:()=>ym(),getLocation:()=>window.location.href,getUserAgent:()=>navigator.userAgent,generateUUID:()=>crypto.randomUUID(),storage:hm()}}function vm(){return{getItem(){return null},removeItem(){},setItem(){}}}function Sm(){return{runtime:"null",send:()=>{},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>"",storage:vm()}}function wm(e){return e.get().mode!=="disabled"&&bm()?mm():Sm()}function bm(){try{return typeof window=="object"}catch{return!1}}function Cm(e){return{get:()=>Object.freeze(wm(e))}}function Im(e){let t=fm(e),r=dm(),n=Cm(t),a=sm(n);return{emit:(i,s)=>{let o=t.get(),c=n.get(),u=um(i,s,o,c,a);return nm({config:o,environment:c,event:u,listenerManager:r})},getMeta:i=>$u(i,t.get(),n.get(),a),on:(i,s)=>r.add({type:i,callback:s}),off:(i,s)=>r.remove(i,s),updateConfig:i=>t.update(i),version:Lu,clearStorage:()=>{a.clear()}}}var ls="2.63.3",km=["@coveo/atomic","@coveo/quantic"],Qu=fe(e=>e.source,e=>[`@coveo/headless@${ls}`].concat(Object.entries(e).map(([t,r])=>`${t}@${r}`))),mi=fe(e=>e.configuration.accessToken,e=>e.configuration.analytics,e=>Qu(e.configuration.analytics),(e,{trackingId:t,nextApiBaseUrl:r,enabled:n},a)=>Im({mode:n?"emit":"disabled",url:r,token:e,trackingId:t,source:a}));function Ze(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function w(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(d){try{u(n.next(d))}catch(f){s(f)}}function c(d){try{u(n.throw(d))}catch(f){s(f)}}function u(d){d.done?i(d.value):a(d.value).then(o,c)}u((n=n.apply(e,[])).next())})}var Z;(function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect"})(Z||(Z={}));function Uo(){return typeof window<"u"}function ds(){return typeof navigator<"u"}function vi(){return typeof document<"u"}function Si(){try{return typeof localStorage<"u"}catch{return!1}}function qm(){try{return typeof sessionStorage<"u"}catch{return!1}}function zu(){return ds()&&navigator.cookieEnabled}var xm=[Z.click,Z.custom,Z.search,Z.view],Am=(e,t)=>xm.indexOf(e)!==-1?Object.assign({language:vi()?document.documentElement.lang:"unknown",userAgent:ds()?navigator.userAgent:"unknown"},t):t,$a=class Nu{static set(t,r,n){var a,i,s,o;n&&(i=new Date,i.setTime(i.getTime()+n)),o=window.location.hostname,o.indexOf(".")===-1?jo(t,r,i):(s=o.split("."),a=s[s.length-2]+"."+s[s.length-1],jo(t,r,i,a))}static get(t){for(var r=t+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){var i=n[a];if(i=i.replace(/^\s+/,""),i.lastIndexOf(r,0)===0)return i.substring(r.length,i.length)}return null}static erase(t){Nu.set(t,"",-1)}};function jo(e,t,r,n){document.cookie=`${e}=${t}`+(r?`;expires=${r.toUTCString()}`:"")+(n?`;domain=${n}`:"")+";path=/;SameSite=Lax"}function Om(){return Si()?localStorage:zu()?new fs:qm()?sessionStorage:new ia}var fs=class vn{getItem(t){return $a.get(`${vn.prefix}${t}`)}removeItem(t){$a.erase(`${vn.prefix}${t}`)}setItem(t,r,n){$a.set(`${vn.prefix}${t}`,r,n)}};fs.prefix="coveo_";var Fm=class{constructor(){this.cookieStorage=new fs}getItem(e){return localStorage.getItem(e)||this.cookieStorage.getItem(e)}removeItem(e){this.cookieStorage.removeItem(e),localStorage.removeItem(e)}setItem(e,t){localStorage.setItem(e,t),this.cookieStorage.setItem(e,t,31556926e3)}},ia=class{getItem(e){return null}removeItem(e){}setItem(e,t){}},yr="__coveo.analytics.history",Bu=20,Hu=1e3*60,Yu=75,Tn=class{constructor(e){this.store=e||Om()}addElement(e){e.internalTime=new Date().getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=this.getHistoryWithInternalTime();t!=null?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}addElementAsync(e){return w(this,void 0,void 0,function*(){e.internalTime=new Date().getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=yield this.getHistoryWithInternalTimeAsync();t!=null?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])})}getHistory(){let e=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(e))}getHistoryAsync(){return w(this,void 0,void 0,function*(){let e=yield this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(e))})}getHistoryWithInternalTime(){try{let e=this.store.getItem(yr);return e&&typeof e=="string"?JSON.parse(e):[]}catch{return[]}}getHistoryWithInternalTimeAsync(){return w(this,void 0,void 0,function*(){try{let e=yield this.store.getItem(yr);return e?JSON.parse(e):[]}catch{return[]}})}setHistory(e){try{this.store.setItem(yr,JSON.stringify(e.slice(0,Bu)))}catch{}}clear(){try{this.store.removeItem(yr)}catch{}}getMostRecentElement(){let e=this.getHistoryWithInternalTime();return Array.isArray(e)?e.sort((t,r)=>(r.internalTime||0)-(t.internalTime||0))[0]:null}cropQueryElement(e){return e.name&&e.value&&e.name.toLowerCase()==="query"&&(e.value=e.value.slice(0,Yu)),e}isValidEntry(e){let t=this.getMostRecentElement();return t&&t.value==e.value?(e.internalTime||0)-(t.internalTime||0)>Hu:!0}stripInternalTime(e){return Array.isArray(e)?e.map(t=>{let{name:r,time:n,value:a}=t;return{name:r,time:n,value:a}}):[]}stripEmptyQuery(e){let{name:t,time:r,value:n}=e;return t&&typeof n=="string"&&t.toLowerCase()==="query"&&n.trim()===""?{name:t,time:r}:e}stripEmptyQueries(e){return e.map(t=>this.stripEmptyQuery(t))}},Rm=Object.freeze({__proto__:null,HistoryStore:Tn,MAX_NUMBER_OF_HISTORY_ELEMENTS:Bu,MAX_VALUE_SIZE:Yu,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:Hu,STORE_KEY:yr,default:Tn}),Em=(e,t)=>w(void 0,void 0,void 0,function*(){return e===Z.view?(yield Dm(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t}),Dm=e=>w(void 0,void 0,void 0,function*(){let t=new Tn,r={name:"PageView",value:e,time:new Date().toISOString()};yield t.addElementAsync(r)}),fn,Tm=new Uint8Array(16);function Mm(){if(!fn&&(fn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!fn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return fn(Tm)}var Pm=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Mn(e){return typeof e=="string"&&Pm.test(e)}var we=[];for(let e=0;e<256;++e)we.push((e+256).toString(16).slice(1));function Wu(e,t=0){return(we[e[t+0]]+we[e[t+1]]+we[e[t+2]]+we[e[t+3]]+"-"+we[e[t+4]]+we[e[t+5]]+"-"+we[e[t+6]]+we[e[t+7]]+"-"+we[e[t+8]]+we[e[t+9]]+"-"+we[e[t+10]]+we[e[t+11]]+we[e[t+12]]+we[e[t+13]]+we[e[t+14]]+we[e[t+15]]).toLowerCase()}function Um(e){if(!Mn(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}function jm(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var Vm="6ba7b810-9dad-11d1-80b4-00c04fd430c8",_m="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Lm(e,t,r){function n(a,i,s,o){var c;if(typeof a=="string"&&(a=jm(a)),typeof i=="string"&&(i=Um(i)),((c=i)===null||c===void 0?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+a.length);if(u.set(i),u.set(a,i.length),u=r(u),u[6]=u[6]&15|t,u[8]=u[8]&63|128,s){o=o||0;for(let d=0;d<16;++d)s[o+d]=u[d];return s}return Wu(u)}try{n.name=e}catch{}return n.DNS=Vm,n.URL=_m,n}var $m=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Vo={randomUUID:$m};function Qa(e,t,r){if(Vo.randomUUID&&!t&&!e)return Vo.randomUUID();e=e||{};let n=e.random||(e.rng||Mm)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Wu(n)}function Qm(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function za(e,t){return e<<t|e>>>32-t}function zm(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){let s=unescape(encodeURIComponent(e));e=[];for(let o=0;o<s.length;++o)e.push(s.charCodeAt(o))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=e.length/4+2,a=Math.ceil(n/16),i=new Array(a);for(let s=0;s<a;++s){let o=new Uint32Array(16);for(let c=0;c<16;++c)o[c]=e[s*64+c*4]<<24|e[s*64+c*4+1]<<16|e[s*64+c*4+2]<<8|e[s*64+c*4+3];i[s]=o}i[a-1][14]=(e.length-1)*8/Math.pow(2,32),i[a-1][14]=Math.floor(i[a-1][14]),i[a-1][15]=(e.length-1)*8&4294967295;for(let s=0;s<a;++s){let o=new Uint32Array(80);for(let g=0;g<16;++g)o[g]=i[s][g];for(let g=16;g<80;++g)o[g]=za(o[g-3]^o[g-8]^o[g-14]^o[g-16],1);let c=r[0],u=r[1],d=r[2],f=r[3],l=r[4];for(let g=0;g<80;++g){let v=Math.floor(g/20),p=za(c,5)+Qm(v,u,d,f)+l+t[v]+o[g]>>>0;l=f,f=d,d=za(u,30)>>>0,u=c,c=p}r[0]=r[0]+c>>>0,r[1]=r[1]+u>>>0,r[2]=r[2]+d>>>0,r[3]=r[3]+f>>>0,r[4]=r[4]+l>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var Nm=Lm("v5",80,zm),_o=Nm,Gu="2.30.2",Bm={pageview:"pageview",event:"event"},Pn=class wi{constructor(t,r){if(!Mn(t))throw Error("Not a valid uuid");this.clientId=t,this.creationDate=Math.floor(r/1e3)}toString(){return this.clientId.replace(/-/g,"")+"."+this.creationDate.toString()}get expired(){let t=Math.floor(Date.now()/1e3)-this.creationDate;return t<0||t>wi.expirationTime}validate(t,r){return!this.expired&&this.matchReferrer(t,r)}matchReferrer(t,r){try{let n=new URL(t);return r.some(a=>new RegExp(a.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(n.host))}catch{return!1}}static fromString(t){let r=t.split(".");if(r.length!==2)return null;let[n,a]=r;if(n.length!==32||isNaN(parseInt(a)))return null;let i=n.substring(0,8)+"-"+n.substring(8,12)+"-"+n.substring(12,16)+"-"+n.substring(16,20)+"-"+n.substring(20,32);return Mn(i)?new wi(i,Number.parseInt(a)*1e3):null}};Pn.cvo_cid="cvo_cid";Pn.expirationTime=120;var Ne=Object.keys;function pn(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}var Lo={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},Hm=Ne(Lo).map(e=>Lo[e]),Ym=[...Hm].join("|"),Wm=new RegExp(`^(${Ym}$)`),Gm={svcAction:"svc_action",svcActionData:"svc_action_data"},Jm=e=>Wm.test(e),Km=[Jm],$o={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},Qo={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr",group:"group"},qe={action:"pa",list:"pal",listSource:"pls"},Un={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},Zm=["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit"],bi={id:"quoteId",affiliation:"quoteAffiliation"},Ci={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},Xm={add:qe,bookmark_add:qe,bookmark_remove:qe,click:qe,checkout:qe,checkout_option:qe,detail:qe,impression:qe,remove:qe,refund:Object.assign(Object.assign({},qe),Un),purchase:Object.assign(Object.assign({},qe),Un),quickview:qe,quote:Object.assign(Object.assign({},qe),bi),review:Object.assign(Object.assign({},qe),Ci)},ev=Ne($o).map(e=>$o[e]),tv=Ne(Qo).map(e=>Qo[e]),rv=Ne(qe).map(e=>qe[e]),nv=Ne(Un).map(e=>Un[e]),av=Ne(Ci).map(e=>Ci[e]),iv=Ne(bi).map(e=>bi[e]),sv=[...ev,"custom"].join("|"),ov=[...tv,"custom"].join("|"),Ju="(pr[0-9]+)",Ku="(il[0-9]+pi[0-9]+)",cv=new RegExp(`^${Ju}(${sv})$`),uv=new RegExp(`^(${Ku}(${ov}))|(il[0-9]+nm)$`),lv=new RegExp(`^(${rv.join("|")})$`),dv=new RegExp(`^(${nv.join("|")})$`),fv=new RegExp(`^${Ju}custom$`),pv=new RegExp(`^${Ku}custom$`),gv=new RegExp(`^(${[...Zm,...av,...iv].join("|")})$`),hv=e=>cv.test(e),yv=e=>uv.test(e),mv=e=>lv.test(e),vv=e=>dv.test(e),Sv=e=>gv.test(e),wv=[yv,hv,mv,vv,Sv],bv=[fv,pv],Cv={anonymizeIp:"aip"},Iv={eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"},kv={hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"},qv=["contentId","contentIdKey","contentType","searchHub","tab","searchUid","permanentId","contentLocale","trackingId"],xv=Object.assign(Object.assign(Object.assign(Object.assign({},Cv),Iv),kv),qv.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:t}),{})),Ii=Object.assign(Object.assign({},xv),Gm),Av=e=>{let t=!!e.action&&Xm[e.action]||{};return Ne(e).reduce((r,n)=>{let a=t[n]||Ii[n]||n;return Object.assign(Object.assign({},r),{[a]:e[n]})},{})},Ov=Ne(Ii).map(e=>Ii[e]),Fv=e=>Ov.indexOf(e)!==-1,Rv=e=>e==="custom",Ev=e=>[...wv,...Km,Fv,Rv].some(t=>t(e)),Dv=e=>Ne(e).reduce((t,r)=>{let n=Tv(r);return n?Object.assign(Object.assign({},t),Mv(n,e[r])):Object.assign(Object.assign({},t),{[r]:e[r]})},{}),Tv=e=>{let t;return[...bv].every(r=>{var n;return t=(n=r.exec(e))===null||n===void 0?void 0:n[1],!t}),t},Mv=(e,t)=>Ne(t).reduce((r,n)=>Object.assign(Object.assign({},r),{[`${e}${n}`]:t[n]}),{}),Pv=class{constructor(e){this.opts=e}sendEvent(e,t){return w(this,void 0,void 0,function*(){if(!this.isAvailable())throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');let{baseUrl:r,preprocessRequest:n}=this.opts,a=yield this.getQueryParamsForEventType(e),{url:i,payload:s}=yield this.preProcessRequestAsPotentialJSONString(`${r}/analytics/${e}?${a}`,t,n),o=this.encodeForEventType(e,s),c=new Blob([o],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(i,c)})}isAvailable(){return"sendBeacon"in navigator}deleteHttpCookieVisitorId(){return Promise.resolve()}preProcessRequestAsPotentialJSONString(e,t,r){return w(this,void 0,void 0,function*(){let n=e,a=t;if(r){let i=yield r({url:e,body:JSON.stringify(t)},"analyticsBeacon"),{url:s,body:o}=i;n=s||e;try{a=JSON.parse(o)}catch(c){console.error("Unable to process the request body as a JSON string",c)}}return{payload:a,url:n}})}encodeForEventType(e,t){return this.isEventTypeLegacy(e)?this.encodeEventToJson(e,t):this.encodeEventToJson(e,t,this.opts.token)}getQueryParamsForEventType(e){return w(this,void 0,void 0,function*(){let{token:t,visitorIdProvider:r}=this.opts,n=yield r.getCurrentVisitorId();return[t&&this.isEventTypeLegacy(e)?`access_token=${t}`:"",n?`visitorId=${n}`:"","discardVisitInfo=true"].filter(a=>!!a).join("&")})}isEventTypeLegacy(e){return[Z.click,Z.custom,Z.search,Z.view].indexOf(e)!==-1}encodeEventToJson(e,t,r){let n=`${e}Event=${encodeURIComponent(JSON.stringify(t))}`;return r&&(n=`access_token=${encodeURIComponent(r)}&${n}`),n}},Uv=class{sendEvent(e,t){return w(this,void 0,void 0,function*(){return Promise.resolve()})}deleteHttpCookieVisitorId(){return w(this,void 0,void 0,function*(){return Promise.resolve()})}},zo=window.fetch,Zu=class{constructor(e){this.opts=e}sendEvent(e,t){return w(this,void 0,void 0,function*(){let{baseUrl:r,visitorIdProvider:n,preprocessRequest:a}=this.opts,i=this.shouldAppendVisitorId(e)?yield this.getVisitorIdParam():"",s={url:`${r}/analytics/${e}${i}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(t)},o=Object.assign(Object.assign({},s),a?yield a(s,"analyticsFetch"):{}),{url:c}=o,u=Ze(o,["url"]),d;try{d=yield zo(c,u)}catch(f){console.error("An error has occured when sending the event.",f);return}if(d.ok){let f=yield d.json();return f.visitorId&&n.setCurrentVisitorId(f.visitorId),f}else{try{d.json()}catch{}throw console.error(`An error has occured when sending the "${e}" event.`,d,t),new Error(`An error has occurred when sending the "${e}" event. Check the console logs for more details.`)}})}deleteHttpCookieVisitorId(){return w(this,void 0,void 0,function*(){let{baseUrl:e}=this.opts,t=`${e}/analytics/visit`;yield zo(t,{headers:this.getHeaders(),method:"DELETE"})})}shouldAppendVisitorId(e){return[Z.click,Z.custom,Z.search,Z.view].indexOf(e)!==-1}getVisitorIdParam(){return w(this,void 0,void 0,function*(){let{visitorIdProvider:e}=this.opts,t=yield e.getCurrentVisitorId();return t?`?visitor=${t}`:""})}getHeaders(){let{token:e}=this.opts;return Object.assign(Object.assign({},e?{Authorization:`Bearer ${e}`}:{}),{"Content-Type":"application/json"})}},jv=class{constructor(e,t){Si()&&zu()?this.storage=new Fm:Si()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new ia),this.client=new Zu(e),this.beaconClient=new Pv(e),window.addEventListener("beforeunload",()=>{let r=t();for(let{eventType:n,payload:a}of r)this.beaconClient.sendEvent(n,a)})}getClientDependingOnEventType(e){return e==="click"&&this.beaconClient.isAvailable()?this.beaconClient:this.client}},Vv=class{constructor(e,t){this.storage=t||new ia,this.client=new Zu(e)}getClientDependingOnEventType(e){return this.client}},Xu=class{constructor(){this.storage=new ia,this.client=new Uv}getClientDependingOnEventType(e){return this.client}},_v="xx",Lv=e=>(e==null?void 0:e.startsWith(_v))||!1,$v=`
        We've detected you're using React Native but have not provided the corresponding runtime, 
        for an optimal experience please use the "coveo.analytics/react-native" subpackage.
        Follow the Readme on how to set it up: https://github.com/coveo/coveo.analytics.js#using-react-native
    `;function Qv(){return typeof navigator<"u"&&navigator.product=="ReactNative"}var zv=["1",1,"yes",!0];function ki(){return ds()&&[navigator.globalPrivacyControl,navigator.doNotTrack,navigator.msDoNotTrack,window.doNotTrack].some(e=>zv.indexOf(e)!==-1)}var el="v15",tl={default:"https://analytics.cloud.coveo.com/rest/ua",production:"https://analytics.cloud.coveo.com/rest/ua",hipaa:"https://analyticshipaa.cloud.coveo.com/rest/ua"};function Nv(e=tl.default,t=el,r=!1){if(e=e.replace(/\/$/,""),r)return`${e}/${t}`;let n=e.endsWith("/rest")||e.endsWith("/rest/ua");return`${e}${n?"":"/rest"}/${t}`}var Bv="38824e1f-37f5-42d3-8372-a4b8fa9df946",Sn=class{get defaultOptions(){return{endpoint:tl.default,isCustomEndpoint:!1,token:"",version:el,beforeSendHooks:[],afterSendHooks:[]}}get version(){return Gu}constructor(e){if(this.acceptedLinkReferrers=[],!e)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[Em,Am].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};let t={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};ki()?this.runtime=new Xu:this.runtime=this.options.runtimeEnvironment||this.initRuntime(t),this.addEventTypeMapping(Z.view,{newEventType:Z.view,addClientIdParameter:!0}),this.addEventTypeMapping(Z.click,{newEventType:Z.click,addClientIdParameter:!0}),this.addEventTypeMapping(Z.custom,{newEventType:Z.custom,addClientIdParameter:!0}),this.addEventTypeMapping(Z.search,{newEventType:Z.search,addClientIdParameter:!0})}initRuntime(e){return Uo()&&vi()?new jv(e,()=>{let t=[...this.bufferedRequests];return this.bufferedRequests=[],t}):(Qv()&&console.warn($v),new Vv(e))}get storage(){return this.runtime.storage}determineVisitorId(){return w(this,void 0,void 0,function*(){try{return Uo()&&this.extractClientIdFromLink(window.location.href)||(yield this.storage.getItem("visitorId"))||Qa()}catch(e){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",e),Qa()}})}getCurrentVisitorId(){return w(this,void 0,void 0,function*(){if(!this.visitorId){let e=yield this.determineVisitorId();yield this.setCurrentVisitorId(e)}return this.visitorId})}setCurrentVisitorId(e){return w(this,void 0,void 0,function*(){this.visitorId=e,yield this.storage.setItem("visitorId",e)})}setClientId(e,t){return w(this,void 0,void 0,function*(){if(Mn(e))this.setCurrentVisitorId(e.toLowerCase());else{if(!t)throw Error("Cannot generate uuid client id without a specific namespace string.");this.setCurrentVisitorId(_o(e,_o(t,Bv)))}})}getParameters(e,...t){return w(this,void 0,void 0,function*(){return yield this.resolveParameters(e,...t)})}getPayload(e,...t){return w(this,void 0,void 0,function*(){let r=yield this.resolveParameters(e,...t);return yield this.resolvePayloadForParameters(e,r)})}get currentVisitorId(){return typeof(this.visitorId||this.storage.getItem("visitorId"))!="string"&&this.setCurrentVisitorId(Qa()),this.visitorId}set currentVisitorId(e){this.visitorId=e,this.storage.setItem("visitorId",e)}extractClientIdFromLink(e){if(ki())return null;try{let t=new URL(e).searchParams.get(Pn.cvo_cid);if(t==null)return null;let r=Pn.fromString(t);return!r||!vi()||!r.validate(document.referrer,this.acceptedLinkReferrers)?null:r.clientId}catch{}return null}resolveParameters(e,...t){return w(this,void 0,void 0,function*(){let{variableLengthArgumentsNames:r=[],addVisitorIdParameter:n=!1,usesMeasurementProtocol:a=!1,addClientIdParameter:i=!1}=this.eventTypeMapping[e]||{};return yield[s=>r.length>0?this.parseVariableArgumentsPayload(r,s):s[0],s=>w(this,void 0,void 0,function*(){return Object.assign(Object.assign({},s),{visitorId:n?yield this.getCurrentVisitorId():""})}),s=>w(this,void 0,void 0,function*(){return i?Object.assign(Object.assign({},s),{clientId:yield this.getCurrentVisitorId()}):s}),s=>a?this.ensureAnonymousUserWhenUsingApiKey(s):s,s=>this.beforeSendHooks.reduce((o,c)=>w(this,void 0,void 0,function*(){let u=yield o;return yield c(e,u)}),s)].reduce((s,o)=>w(this,void 0,void 0,function*(){let c=yield s;return yield o(c)}),Promise.resolve(t))})}resolvePayloadForParameters(e,t){return w(this,void 0,void 0,function*(){let{usesMeasurementProtocol:r=!1}=this.eventTypeMapping[e]||{};return yield[n=>this.setTrackingIdIfTrackingIdNotPresent(n),n=>this.removeEmptyPayloadValues(n,e),n=>this.validateParams(n,e),n=>r?Av(n):n,n=>r?this.removeUnknownParameters(n):n,n=>r?this.processCustomParameters(n):this.mapCustomParametersToCustomData(n)].reduce((n,a)=>w(this,void 0,void 0,function*(){let i=yield n;return yield a(i)}),Promise.resolve(t))})}makeEvent(e,...t){return w(this,void 0,void 0,function*(){let{newEventType:r=e}=this.eventTypeMapping[e]||{},n=yield this.resolveParameters(e,...t),a=yield this.resolvePayloadForParameters(e,n);return{eventType:r,payload:a,log:i=>w(this,void 0,void 0,function*(){return this.bufferedRequests.push({eventType:r,payload:Object.assign(Object.assign({},a),i)}),yield Promise.all(this.afterSendHooks.map(s=>s(e,Object.assign(Object.assign({},n),i)))),yield this.deferExecution(),yield this.sendFromBuffer()})}})}sendEvent(e,...t){return w(this,void 0,void 0,function*(){return(yield this.makeEvent(e,...t)).log({})})}deferExecution(){return new Promise(e=>setTimeout(e,0))}sendFromBuffer(){return w(this,void 0,void 0,function*(){let e=this.bufferedRequests.shift();if(e){let{eventType:t,payload:r}=e;return this.runtime.getClientDependingOnEventType(t).sendEvent(t,r)}})}clear(){this.storage.removeItem("visitorId"),new Tn().clear()}deleteHttpOnlyVisitorId(){this.runtime.client.deleteHttpCookieVisitorId()}makeSearchEvent(e){return w(this,void 0,void 0,function*(){return this.makeEvent(Z.search,e)})}sendSearchEvent(e){var{searchQueryUid:t}=e,r=Ze(e,["searchQueryUid"]);return w(this,void 0,void 0,function*(){return(yield this.makeSearchEvent(r)).log({searchQueryUid:t})})}makeClickEvent(e){return w(this,void 0,void 0,function*(){return this.makeEvent(Z.click,e)})}sendClickEvent(e){var{searchQueryUid:t}=e,r=Ze(e,["searchQueryUid"]);return w(this,void 0,void 0,function*(){return(yield this.makeClickEvent(r)).log({searchQueryUid:t})})}makeCustomEvent(e){return w(this,void 0,void 0,function*(){return this.makeEvent(Z.custom,e)})}sendCustomEvent(e){var{lastSearchQueryUid:t}=e,r=Ze(e,["lastSearchQueryUid"]);return w(this,void 0,void 0,function*(){return(yield this.makeCustomEvent(r)).log({lastSearchQueryUid:t})})}makeViewEvent(e){return w(this,void 0,void 0,function*(){return this.makeEvent(Z.view,e)})}sendViewEvent(e){return w(this,void 0,void 0,function*(){return(yield this.makeViewEvent(e)).log({})})}getVisit(){return w(this,void 0,void 0,function*(){let e=yield(yield fetch(`${this.baseUrl}/analytics/visit`)).json();return this.visitorId=e.visitorId,e})}getHealth(){return w(this,void 0,void 0,function*(){return yield(yield fetch(`${this.baseUrl}/analytics/monitoring/health`)).json()})}registerBeforeSendEventHook(e){this.beforeSendHooks.push(e)}registerAfterSendEventHook(e){this.afterSendHooks.push(e)}addEventTypeMapping(e,t){this.eventTypeMapping[e]=t}setAcceptedLinkReferrers(e){if(Array.isArray(e)&&e.every(t=>typeof t=="string"))this.acceptedLinkReferrers=e;else throw Error("Parameter should be an array of domain strings")}parseVariableArgumentsPayload(e,t){let r={};for(let n=0,a=t.length;n<a;n++){let i=t[n];if(typeof i=="string")r[e[n]]=i;else if(typeof i=="object")return Object.assign(Object.assign({},r),i)}return r}isKeyAllowedEmpty(e,t){return({[Z.search]:["queryText"]}[e]||[]).indexOf(t)!==-1}removeEmptyPayloadValues(e,t){let r=n=>typeof n<"u"&&n!==null&&n!=="";return Object.keys(e).filter(n=>this.isKeyAllowedEmpty(t,n)||r(e[n])).reduce((n,a)=>Object.assign(Object.assign({},n),{[a]:e[a]}),{})}removeUnknownParameters(e){return Object.keys(e).filter(t=>{if(Ev(t))return!0;console.log(t,"is not processed by coveoua")}).reduce((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]}),{})}processCustomParameters(e){let{custom:t}=e,r=Ze(e,["custom"]),n={};t&&pn(t)&&(n=this.lowercaseKeys(t));let a=Dv(r);return Object.assign(Object.assign({},n),a)}mapCustomParametersToCustomData(e){let{custom:t}=e,r=Ze(e,["custom"]);if(t&&pn(t)){let n=this.lowercaseKeys(t);return Object.assign(Object.assign({},r),{customData:Object.assign(Object.assign({},n),e.customData)})}else return e}lowercaseKeys(e){let t=Object.keys(e),r={};return t.forEach(n=>{r[n.toLowerCase()]=e[n]}),r}validateParams(e,t){let{anonymizeIp:r}=e,n=Ze(e,["anonymizeIp"]);return r!==void 0&&["0","false","undefined","null","{}","[]",""].indexOf(`${r}`.toLowerCase())==-1&&(n.anonymizeIp=1),(t==Z.view||t==Z.click||t==Z.search||t==Z.custom)&&(n.originLevel3=this.limit(n.originLevel3,128)),t==Z.view&&(n.location=this.limit(n.location,128)),(t=="pageview"||t=="event")&&(n.referrer=this.limit(n.referrer,2048),n.location=this.limit(n.location,2048),n.page=this.limit(n.page,2048)),n}ensureAnonymousUserWhenUsingApiKey(e){let{userId:t}=e,r=Ze(e,["userId"]);return Lv(this.options.token)&&!t?(r.userId="anonymous",r):e}setTrackingIdIfTrackingIdNotPresent(e){let{trackingId:t}=e,r=Ze(e,["trackingId"]);return t?e:(r.hasOwnProperty("custom")&&pn(r.custom)&&(r.custom.hasOwnProperty("context_website")||r.custom.hasOwnProperty("siteName"))&&(r.trackingId=r.custom.context_website||r.custom.siteName),r.hasOwnProperty("customData")&&pn(r.customData)&&(r.customData.hasOwnProperty("context_website")||r.customData.hasOwnProperty("siteName"))&&(r.trackingId=r.customData.context_website||r.customData.siteName),r)}limit(e,t){return typeof e!="string"?e:e.substring(0,t)}get baseUrl(){return Nv(this.options.endpoint,this.options.version,this.options.isCustomEndpoint)}},Xe;(function(e){e.contextChanged="contextChanged",e.expandToFullUI="expandToFullUI",e.openUserActions="openUserActions",e.showPrecedingSessions="showPrecedingSessions",e.showFollowingSessions="showFollowingSessions",e.clickViewedDocument="clickViewedDocument",e.clickPageView="clickPageView",e.createArticle="createArticle"})(Xe||(Xe={}));var C;(function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.undoTriggerQuery="undoQuery",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.staticFilterClearAll="staticFilterClearAll",e.staticFilterSelect="staticFilterSelect",e.staticFilterDeselect="staticFilterDeselect",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",e.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",e.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",e.openSmartSnippetSource="openSmartSnippetSource",e.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",e.openSmartSnippetInlineLink="openSmartSnippetInlineLink",e.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",e.recentQueryClick="recentQueriesClick",e.clearRecentQueries="clearRecentQueries",e.recentResultClick="recentResultClick",e.clearRecentResults="clearRecentResults",e.noResultsBack="noResultsBack",e.showMoreFoldedResults="showMoreFoldedResults",e.showLessFoldedResults="showLessFoldedResults",e.copyToClipboard="copyToClipboard",e.caseSendEmail="Case.SendEmail",e.feedItemTextPost="FeedItem.TextPost",e.caseAttach="caseAttach",e.caseDetach="caseDetach",e.retryGeneratedAnswer="retryGeneratedAnswer",e.likeGeneratedAnswer="likeGeneratedAnswer",e.dislikeGeneratedAnswer="dislikeGeneratedAnswer",e.openGeneratedAnswerSource="openGeneratedAnswerSource",e.generatedAnswerStreamEnd="generatedAnswerStreamEnd",e.generatedAnswerSourceHover="generatedAnswerSourceHover",e.generatedAnswerCopyToClipboard="generatedAnswerCopyToClipboard",e.generatedAnswerHideAnswers="generatedAnswerHideAnswers",e.generatedAnswerShowAnswers="generatedAnswerShowAnswers",e.generatedAnswerExpand="generatedAnswerExpand",e.generatedAnswerCollapse="generatedAnswerCollapse",e.generatedAnswerFeedbackSubmit="generatedAnswerFeedbackSubmit",e.rephraseGeneratedAnswer="rephraseGeneratedAnswer"})(C||(C={}));var No={[C.triggerNotify]:"queryPipelineTriggers",[C.triggerExecute]:"queryPipelineTriggers",[C.triggerQuery]:"queryPipelineTriggers",[C.triggerRedirect]:"queryPipelineTriggers",[C.queryError]:"errors",[C.queryErrorBack]:"errors",[C.queryErrorClear]:"errors",[C.queryErrorRetry]:"errors",[C.pagerNext]:"getMoreResults",[C.pagerPrevious]:"getMoreResults",[C.pagerNumber]:"getMoreResults",[C.pagerResize]:"getMoreResults",[C.pagerScrolling]:"getMoreResults",[C.facetSearch]:"facet",[C.facetShowLess]:"facet",[C.facetShowMore]:"facet",[C.recommendation]:"recommendation",[C.likeSmartSnippet]:"smartSnippet",[C.dislikeSmartSnippet]:"smartSnippet",[C.expandSmartSnippet]:"smartSnippet",[C.collapseSmartSnippet]:"smartSnippet",[C.openSmartSnippetFeedbackModal]:"smartSnippet",[C.closeSmartSnippetFeedbackModal]:"smartSnippet",[C.sendSmartSnippetReason]:"smartSnippet",[C.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[C.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions",[C.showMoreSmartSnippetSuggestion]:"smartSnippetSuggestions",[C.showLessSmartSnippetSuggestion]:"smartSnippetSuggestions",[C.clearRecentQueries]:"recentQueries",[C.recentResultClick]:"recentlyClickedDocuments",[C.clearRecentResults]:"recentlyClickedDocuments",[C.showLessFoldedResults]:"folding",[C.caseDetach]:"case",[C.likeGeneratedAnswer]:"generatedAnswer",[C.dislikeGeneratedAnswer]:"generatedAnswer",[C.openGeneratedAnswerSource]:"generatedAnswer",[C.generatedAnswerStreamEnd]:"generatedAnswer",[C.generatedAnswerSourceHover]:"generatedAnswer",[C.generatedAnswerCopyToClipboard]:"generatedAnswer",[C.generatedAnswerHideAnswers]:"generatedAnswer",[C.generatedAnswerShowAnswers]:"generatedAnswer",[C.generatedAnswerExpand]:"generatedAnswer",[C.generatedAnswerCollapse]:"generatedAnswer",[C.generatedAnswerFeedbackSubmit]:"generatedAnswer",[Xe.expandToFullUI]:"interface",[Xe.openUserActions]:"User Actions",[Xe.showPrecedingSessions]:"User Actions",[Xe.showFollowingSessions]:"User Actions",[Xe.clickViewedDocument]:"User Actions",[Xe.clickPageView]:"User Actions",[Xe.createArticle]:"createArticle"},Bo=class{constructor(){this.runtime=new Xu,this.currentVisitorId=""}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}makeEvent(e){return Promise.resolve({eventType:e,payload:null,log:()=>Promise.resolve()})}sendEvent(){return Promise.resolve()}makeSearchEvent(){return this.makeEvent(Z.search)}sendSearchEvent(){return Promise.resolve()}makeClickEvent(){return this.makeEvent(Z.click)}sendClickEvent(){return Promise.resolve()}makeCustomEvent(){return this.makeEvent(Z.custom)}sendCustomEvent(){return Promise.resolve()}makeViewEvent(){return this.makeEvent(Z.view)}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}get version(){return Gu}};function Hv(e){let t="";return e.filter(r=>{let n=r!==t;return t=r,n})}function Yv(e){return e.map(t=>t.replace(/;/g,""))}function rl(e){let t=e.join(";");return t.length<=256?t:rl(e.slice(1))}var Ho=e=>{let t=Yv(e),r=Hv(t);return rl(r)};function Yo(e){let t=typeof e.partialQueries=="string"?e.partialQueries:Ho(e.partialQueries),r=typeof e.suggestions=="string"?e.suggestions:Ho(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}var nl=class{constructor(e,t){this.opts=e,this.provider=t;let r=e.enableAnalytics===!1||ki();this.coveoAnalyticsClient=r?new Bo:new Sn(e)}disable(){this.coveoAnalyticsClient=new Bo}enable(){this.coveoAnalyticsClient=new Sn(this.opts)}makeInterfaceLoad(){return this.makeSearchEvent(C.interfaceLoad)}logInterfaceLoad(){return w(this,void 0,void 0,function*(){return(yield this.makeInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationInterfaceLoad(){return this.makeSearchEvent(C.recommendationInterfaceLoad)}logRecommendationInterfaceLoad(){return w(this,void 0,void 0,function*(){return(yield this.makeRecommendationInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendation(){return this.makeCustomEvent(C.recommendation)}logRecommendation(){return w(this,void 0,void 0,function*(){return(yield this.makeRecommendation()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationOpen(e,t){return this.makeClickEvent(C.recommendationOpen,e,t)}logRecommendationOpen(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeRecommendationOpen(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterClearAll(e){return this.makeSearchEvent(C.staticFilterClearAll,e)}logStaticFilterClearAll(e){return w(this,void 0,void 0,function*(){return(yield this.makeStaticFilterClearAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterSelect(e){return this.makeSearchEvent(C.staticFilterSelect,e)}logStaticFilterSelect(e){return w(this,void 0,void 0,function*(){return(yield this.makeStaticFilterSelect(e)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterDeselect(e){return this.makeSearchEvent(C.staticFilterDeselect,e)}logStaticFilterDeselect(e){return w(this,void 0,void 0,function*(){return(yield this.makeStaticFilterDeselect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFetchMoreResults(){return this.makeCustomEvent(C.pagerScrolling,{type:"getMoreResults"})}logFetchMoreResults(){return w(this,void 0,void 0,function*(){return(yield this.makeFetchMoreResults()).log({searchUID:this.provider.getSearchUID()})})}makeInterfaceChange(e){return this.makeSearchEvent(C.interfaceChange,e)}logInterfaceChange(e){return w(this,void 0,void 0,function*(){return(yield this.makeInterfaceChange(e)).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanAutomatic(){return this.makeSearchEvent(C.didyoumeanAutomatic)}logDidYouMeanAutomatic(){return w(this,void 0,void 0,function*(){return(yield this.makeDidYouMeanAutomatic()).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanClick(){return this.makeSearchEvent(C.didyoumeanClick)}logDidYouMeanClick(){return w(this,void 0,void 0,function*(){return(yield this.makeDidYouMeanClick()).log({searchUID:this.provider.getSearchUID()})})}makeResultsSort(e){return this.makeSearchEvent(C.resultsSort,e)}logResultsSort(e){return w(this,void 0,void 0,function*(){return(yield this.makeResultsSort(e)).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxSubmit(){return this.makeSearchEvent(C.searchboxSubmit)}logSearchboxSubmit(){return w(this,void 0,void 0,function*(){return(yield this.makeSearchboxSubmit()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxClear(){return this.makeSearchEvent(C.searchboxClear)}logSearchboxClear(){return w(this,void 0,void 0,function*(){return(yield this.makeSearchboxClear()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxAsYouType(){return this.makeSearchEvent(C.searchboxAsYouType)}logSearchboxAsYouType(){return w(this,void 0,void 0,function*(){return(yield this.makeSearchboxAsYouType()).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbFacet(e){return this.makeSearchEvent(C.breadcrumbFacet,e)}logBreadcrumbFacet(e){return w(this,void 0,void 0,function*(){return(yield this.makeBreadcrumbFacet(e)).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbResetAll(){return this.makeSearchEvent(C.breadcrumbResetAll)}logBreadcrumbResetAll(){return w(this,void 0,void 0,function*(){return(yield this.makeBreadcrumbResetAll()).log({searchUID:this.provider.getSearchUID()})})}makeDocumentQuickview(e,t){return this.makeClickEvent(C.documentQuickview,e,t)}logDocumentQuickview(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeDocumentQuickview(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeDocumentOpen(e,t){return this.makeClickEvent(C.documentOpen,e,t)}logDocumentOpen(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeDocumentOpen(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxAnalytics(e){return this.makeSearchEvent(C.omniboxAnalytics,Yo(e))}logOmniboxAnalytics(e){return w(this,void 0,void 0,function*(){return(yield this.makeOmniboxAnalytics(e)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxFromLink(e){return this.makeSearchEvent(C.omniboxFromLink,Yo(e))}logOmniboxFromLink(e){return w(this,void 0,void 0,function*(){return(yield this.makeOmniboxFromLink(e)).log({searchUID:this.provider.getSearchUID()})})}makeSearchFromLink(){return this.makeSearchEvent(C.searchFromLink)}logSearchFromLink(){return w(this,void 0,void 0,function*(){return(yield this.makeSearchFromLink()).log({searchUID:this.provider.getSearchUID()})})}makeTriggerNotify(e){return this.makeCustomEvent(C.triggerNotify,e)}logTriggerNotify(e){return w(this,void 0,void 0,function*(){return(yield this.makeTriggerNotify(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerExecute(e){return this.makeCustomEvent(C.triggerExecute,e)}logTriggerExecute(e){return w(this,void 0,void 0,function*(){return(yield this.makeTriggerExecute(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerQuery(){return this.makeCustomEvent(C.triggerQuery,{query:this.provider.getSearchEventRequestPayload().queryText},"queryPipelineTriggers")}logTriggerQuery(){return w(this,void 0,void 0,function*(){return(yield this.makeTriggerQuery()).log({searchUID:this.provider.getSearchUID()})})}makeUndoTriggerQuery(e){return this.makeSearchEvent(C.undoTriggerQuery,e)}logUndoTriggerQuery(e){return w(this,void 0,void 0,function*(){return(yield this.makeUndoTriggerQuery(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerRedirect(e){return this.makeCustomEvent(C.triggerRedirect,Object.assign(Object.assign({},e),{query:this.provider.getSearchEventRequestPayload().queryText}))}logTriggerRedirect(e){return w(this,void 0,void 0,function*(){return(yield this.makeTriggerRedirect(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerResize(e){return this.makeCustomEvent(C.pagerResize,e)}logPagerResize(e){return w(this,void 0,void 0,function*(){return(yield this.makePagerResize(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerNumber(e){return this.makeCustomEvent(C.pagerNumber,e)}logPagerNumber(e){return w(this,void 0,void 0,function*(){return(yield this.makePagerNumber(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerNext(e){return this.makeCustomEvent(C.pagerNext,e)}logPagerNext(e){return w(this,void 0,void 0,function*(){return(yield this.makePagerNext(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerPrevious(e){return this.makeCustomEvent(C.pagerPrevious,e)}logPagerPrevious(e){return w(this,void 0,void 0,function*(){return(yield this.makePagerPrevious(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerScrolling(){return this.makeCustomEvent(C.pagerScrolling)}logPagerScrolling(){return w(this,void 0,void 0,function*(){return(yield this.makePagerScrolling()).log({searchUID:this.provider.getSearchUID()})})}makeFacetClearAll(e){return this.makeSearchEvent(C.facetClearAll,e)}logFacetClearAll(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetClearAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSearch(e){return this.makeSearchEvent(C.facetSearch,e)}logFacetSearch(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetSearch(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelect(e){return this.makeSearchEvent(C.facetSelect,e)}logFacetSelect(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetSelect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetDeselect(e){return this.makeSearchEvent(C.facetDeselect,e)}logFacetDeselect(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetDeselect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetExclude(e){return this.makeSearchEvent(C.facetExclude,e)}logFacetExclude(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetExclude(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUnexclude(e){return this.makeSearchEvent(C.facetUnexclude,e)}logFacetUnexclude(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetUnexclude(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelectAll(e){return this.makeSearchEvent(C.facetSelectAll,e)}logFacetSelectAll(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetSelectAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUpdateSort(e){return this.makeSearchEvent(C.facetUpdateSort,e)}logFacetUpdateSort(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetUpdateSort(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowMore(e){return this.makeCustomEvent(C.facetShowMore,e)}logFacetShowMore(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetShowMore(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowLess(e){return this.makeCustomEvent(C.facetShowLess,e)}logFacetShowLess(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetShowLess(e)).log({searchUID:this.provider.getSearchUID()})})}makeQueryError(e){return this.makeCustomEvent(C.queryError,e)}logQueryError(e){return w(this,void 0,void 0,function*(){return(yield this.makeQueryError(e)).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorBack(){return w(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(C.queryErrorBack);return{description:e.description,log:()=>w(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(C.queryErrorBack)})}})}logQueryErrorBack(){return w(this,void 0,void 0,function*(){return(yield this.makeQueryErrorBack()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorRetry(){return w(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(C.queryErrorRetry);return{description:e.description,log:()=>w(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(C.queryErrorRetry)})}})}logQueryErrorRetry(){return w(this,void 0,void 0,function*(){return(yield this.makeQueryErrorRetry()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorClear(){return w(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(C.queryErrorClear);return{description:e.description,log:()=>w(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(C.queryErrorClear)})}})}logQueryErrorClear(){return w(this,void 0,void 0,function*(){return(yield this.makeQueryErrorClear()).log({searchUID:this.provider.getSearchUID()})})}makeLikeSmartSnippet(){return this.makeCustomEvent(C.likeSmartSnippet)}logLikeSmartSnippet(){return w(this,void 0,void 0,function*(){return(yield this.makeLikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeDislikeSmartSnippet(){return this.makeCustomEvent(C.dislikeSmartSnippet)}logDislikeSmartSnippet(){return w(this,void 0,void 0,function*(){return(yield this.makeDislikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippet(){return this.makeCustomEvent(C.expandSmartSnippet)}logExpandSmartSnippet(){return w(this,void 0,void 0,function*(){return(yield this.makeExpandSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippet(){return this.makeCustomEvent(C.collapseSmartSnippet)}logCollapseSmartSnippet(){return w(this,void 0,void 0,function*(){return(yield this.makeCollapseSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetFeedbackModal(){return this.makeCustomEvent(C.openSmartSnippetFeedbackModal)}logOpenSmartSnippetFeedbackModal(){return w(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeCloseSmartSnippetFeedbackModal(){return this.makeCustomEvent(C.closeSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return w(this,void 0,void 0,function*(){return(yield this.makeCloseSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeSmartSnippetFeedbackReason(e,t){return this.makeCustomEvent(C.sendSmartSnippetReason,{reason:e,details:t})}logSmartSnippetFeedbackReason(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeSmartSnippetFeedbackReason(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippetSuggestion(e){return this.makeCustomEvent(C.expandSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logExpandSmartSnippetSuggestion(e){return w(this,void 0,void 0,function*(){return(yield this.makeExpandSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippetSuggestion(e){return this.makeCustomEvent(C.collapseSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logCollapseSmartSnippetSuggestion(e){return w(this,void 0,void 0,function*(){return(yield this.makeCollapseSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreSmartSnippetSuggestion(e){return this.makeCustomEvent(C.showMoreSmartSnippetSuggestion,e)}logShowMoreSmartSnippetSuggestion(e){return w(this,void 0,void 0,function*(){return(yield this.makeShowMoreSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessSmartSnippetSuggestion(e){return this.makeCustomEvent(C.showLessSmartSnippetSuggestion,e)}logShowLessSmartSnippetSuggestion(e){return w(this,void 0,void 0,function*(){return(yield this.makeShowLessSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSource(e,t){return this.makeClickEvent(C.openSmartSnippetSource,e,t)}logOpenSmartSnippetSource(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSource(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionSource(e,t){return this.makeClickEvent(C.openSmartSnippetSuggestionSource,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}makeCopyToClipboard(e,t){return this.makeClickEvent(C.copyToClipboard,e,t)}logCopyToClipboard(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeCopyToClipboard(e,t)).log({searchUID:this.provider.getSearchUID()})})}logOpenSmartSnippetSuggestionSource(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSuggestionSource(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetInlineLink(e,t){return this.makeClickEvent(C.openSmartSnippetInlineLink,e,{contentIDKey:t.contentIDKey,contentIDValue:t.contentIDValue},t)}logOpenSmartSnippetInlineLink(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionInlineLink(e,t){return this.makeClickEvent(C.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}logOpenSmartSnippetSuggestionInlineLink(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSuggestionInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeRecentQueryClick(){return this.makeSearchEvent(C.recentQueryClick)}logRecentQueryClick(){return w(this,void 0,void 0,function*(){return(yield this.makeRecentQueryClick()).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentQueries(){return this.makeCustomEvent(C.clearRecentQueries)}logClearRecentQueries(){return w(this,void 0,void 0,function*(){return(yield this.makeClearRecentQueries()).log({searchUID:this.provider.getSearchUID()})})}makeRecentResultClick(e,t){return this.makeCustomEvent(C.recentResultClick,{info:e,identifier:t})}logRecentResultClick(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeRecentResultClick(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentResults(){return this.makeCustomEvent(C.clearRecentResults)}logClearRecentResults(){return w(this,void 0,void 0,function*(){return(yield this.makeClearRecentResults()).log({searchUID:this.provider.getSearchUID()})})}makeNoResultsBack(){return this.makeSearchEvent(C.noResultsBack)}logNoResultsBack(){return w(this,void 0,void 0,function*(){return(yield this.makeNoResultsBack()).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreFoldedResults(e,t){return this.makeClickEvent(C.showMoreFoldedResults,e,t)}logShowMoreFoldedResults(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeShowMoreFoldedResults(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessFoldedResults(){return this.makeCustomEvent(C.showLessFoldedResults)}logShowLessFoldedResults(){return w(this,void 0,void 0,function*(){return(yield this.makeShowLessFoldedResults()).log({searchUID:this.provider.getSearchUID()})})}makeEventDescription(e,t){var r;return{actionCause:t,customData:(r=e.payload)===null||r===void 0?void 0:r.customData}}makeCustomEvent(e,t,r=No[e]){return w(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),a=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:r,eventValue:e}),i=yield this.coveoAnalyticsClient.makeCustomEvent(a);return{description:this.makeEventDescription(i,e),log:({searchUID:s})=>i.log({lastSearchQueryUid:s})}})}logCustomEvent(e,t,r=No[e]){return w(this,void 0,void 0,function*(){return(yield this.makeCustomEvent(e,t,r)).log({searchUID:this.provider.getSearchUID()})})}makeCustomEventWithType(e,t,r){return w(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),a=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:t,eventValue:e}),i=yield this.coveoAnalyticsClient.makeCustomEvent(a);return{description:this.makeEventDescription(i,e),log:({searchUID:s})=>i.log({lastSearchQueryUid:s})}})}logCustomEventWithType(e,t,r){return w(this,void 0,void 0,function*(){return(yield this.makeCustomEventWithType(e,t,r)).log({searchUID:this.provider.getSearchUID()})})}logSearchEvent(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeSearchEvent(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeSearchEvent(e,t){return w(this,void 0,void 0,function*(){let r=yield this.getBaseSearchEventRequest(e,t),n=yield this.coveoAnalyticsClient.makeSearchEvent(r);return{description:this.makeEventDescription(n,e),log:({searchUID:a})=>n.log({searchQueryUid:a})}})}makeClickEvent(e,t,r,n){return w(this,void 0,void 0,function*(){let a=Object.assign(Object.assign(Object.assign({},t),yield this.getBaseEventRequest(Object.assign(Object.assign({},r),n))),{queryPipeline:this.provider.getPipeline(),actionCause:e}),i=yield this.coveoAnalyticsClient.makeClickEvent(a);return{description:this.makeEventDescription(i,e),log:({searchUID:s})=>i.log({searchQueryUid:s})}})}logClickEvent(e,t,r,n){return w(this,void 0,void 0,function*(){return(yield this.makeClickEvent(e,t,r,n)).log({searchUID:this.provider.getSearchUID()})})}getBaseSearchEventRequest(e,t){var r,n;return w(this,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},t),(n=(r=this.provider).getGeneratedAnswerMetadata)===null||n===void 0?void 0:n.call(r)))),this.provider.getSearchEventRequestPayload()),{queryPipeline:this.provider.getPipeline(),actionCause:e})})}getBaseEventRequest(e){return w(this,void 0,void 0,function*(){let t=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign(Object.assign({},this.getOrigins()),this.getSplitTestRun()),{customData:t,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})})}getOrigins(){var e,t;return{originContext:(t=(e=this.provider).getOriginContext)===null||t===void 0?void 0:t.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof Sn?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getSplitTestRun(){let e=this.provider.getSplitTestRunName?this.provider.getSplitTestRunName():"",t=this.provider.getSplitTestRunVersion?this.provider.getSplitTestRunVersion():"";return Object.assign(Object.assign({},e&&{splitTestRunName:e}),t&&{splitTestRunVersion:t})}makeLikeGeneratedAnswer(e){return this.makeCustomEvent(C.likeGeneratedAnswer,e)}logLikeGeneratedAnswer(e){return w(this,void 0,void 0,function*(){return(yield this.makeLikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeDislikeGeneratedAnswer(e){return this.makeCustomEvent(C.dislikeGeneratedAnswer,e)}logDislikeGeneratedAnswer(e){return w(this,void 0,void 0,function*(){return(yield this.makeDislikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeOpenGeneratedAnswerSource(e){return this.makeCustomEvent(C.openGeneratedAnswerSource,e)}logOpenGeneratedAnswerSource(e){return w(this,void 0,void 0,function*(){return(yield this.makeOpenGeneratedAnswerSource(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerSourceHover(e){return this.makeCustomEvent(C.generatedAnswerSourceHover,e)}logGeneratedAnswerSourceHover(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerSourceHover(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCopyToClipboard(e){return this.makeCustomEvent(C.generatedAnswerCopyToClipboard,e)}logGeneratedAnswerCopyToClipboard(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerCopyToClipboard(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerHideAnswers(e){return this.makeCustomEvent(C.generatedAnswerHideAnswers,e)}logGeneratedAnswerHideAnswers(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerHideAnswers(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerShowAnswers(e){return this.makeCustomEvent(C.generatedAnswerShowAnswers,e)}logGeneratedAnswerShowAnswers(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerShowAnswers(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerExpand(e){return this.makeCustomEvent(C.generatedAnswerExpand,e)}logGeneratedAnswerExpand(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerExpand(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCollapse(e){return this.makeCustomEvent(C.generatedAnswerCollapse,e)}logGeneratedAnswerCollapse(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerCollapse(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerFeedbackSubmit(e){return this.makeCustomEvent(C.generatedAnswerFeedbackSubmit,e)}logGeneratedAnswerFeedbackSubmit(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerFeedbackSubmit(e)).log({searchUID:this.provider.getSearchUID()})})}makeRephraseGeneratedAnswer(e){return this.makeSearchEvent(C.rephraseGeneratedAnswer,e)}logRephraseGeneratedAnswer(e){return w(this,void 0,void 0,function*(){return(yield this.makeRephraseGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeRetryGeneratedAnswer(){return this.makeSearchEvent(C.retryGeneratedAnswer)}logRetryGeneratedAnswer(){return w(this,void 0,void 0,function*(){return(yield this.makeRetryGeneratedAnswer()).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerStreamEnd(e){return this.makeCustomEvent(C.generatedAnswerStreamEnd,e)}logGeneratedAnswerStreamEnd(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerStreamEnd(e)).log({searchUID:this.provider.getSearchUID()})})}},Wo=Object.assign({},Bm);Object.keys(Wo).map(e=>Wo[e]);var Go;(function(e){e.click="click",e.flowStart="flowStart"})(Go||(Go={}));var Jo;(function(e){e.enterInterface="ticket_create_start",e.fieldUpdate="ticket_field_update",e.fieldSuggestionClick="ticket_classification_click",e.suggestionClick="suggestion_click",e.suggestionRate="suggestion_rate",e.nextCaseStep="ticket_next_stage",e.caseCancelled="ticket_cancel",e.caseSolved="ticket_cancel",e.caseCreated="ticket_create"})(Jo||(Jo={}));var Ko;(function(e){e.quit="Quit",e.solved="Solved"})(Ko||(Ko={}));var it=e=>new Sn(e).getCurrentVisitorId(),Pt=new Rm.HistoryStore,al=(e,t)=>typeof t=="function"?(...r)=>{let n=Wi(r[0]);try{return t.apply(t,r)}catch(a){return e.error(a,"Error in analytics preprocessRequest. Returning original request."),n}}:void 0,il=(e,t)=>(...r)=>{let n=Wi(r[1]);try{return t.apply(t,r)}catch(a){return e.error(a,"Error in analytics hook. Returning original request."),n}},Wv=()=>({url:"",clientId:"",additionalFields:[],advancedParameters:{debug:!1},products:[],facets:{results:[]},error:null,isLoading:!1,responseId:""}),Gv=e=>{let t=e.configuration.search.locale.split("-")[0];return!t||t.length!==2?"en":t},sl=class{constructor(e){this.getState=e,this.state=e()}getLanguage(){return Gv(this.state)}getBaseMetadata(){let{context:e,configuration:t}=this.state,r=(e==null?void 0:e.contextValues)||{},n={};for(let[a,i]of Object.entries(r)){let s=`context_${a}`;n[s]=i}return t.analytics.analyticsMode==="legacy"&&(n.coveoHeadlessVersion=ls),n}getOriginContext(){return this.state.configuration.analytics.originContext}getOriginLevel1(){return this.state.searchHub||Zn()}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3}getIsAnonymous(){return this.state.configuration.analytics.anonymous}},Ur=(e,t)=>{let r=n=>n.facetId===t;if("productListing"in e&&e.productListing&&"facets"in e.productListing&&"results"in e.productListing.facets)return e.productListing.facets.results.find(r);if("search"in e&&e.search)return e.search.response.facets.find(r)},Jv=(e,t)=>{var r;return(r=e.facetSet[t])==null?void 0:r.request};function Kv(e,t){return!!t&&t.facetId in e.facetSet}var ol=(e,t)=>{let r=Ur(e,t);if(Kv(e,r))return r},Zv=(e,t)=>{let r=ol(e,t);return r?r.values.filter(n=>n.state!=="idle"):[]},jr=e=>"productListing"in e?e.productListing.isLoading:e.search.isLoading;function Xv(e){if(!e)return{parents:[],values:[]};let t=[],r=e;for(;r.length&&r[0].children.length;)t=[...t,...r],r=r[0].children;let n=r.find(a=>a.state==="selected");return n&&(t=[...t,n],r=[]),{parents:t,values:r}}function ht(e){let{activeValue:t,ancestryMap:r}=eS(e);return t?tS(t,r):[]}function eS(e){let t=[...e],r=new Map;for(;t.length>0;){let n=t.shift();if(n.state==="selected")return{activeValue:n,ancestryMap:r};if(r)for(let a of n.children)r.set(a,n);t.unshift(...n.children)}return{}}function tS(e,t){let r=[];if(!e)return[];let n=e;do r.unshift(n),n=t.get(n);while(n);return r}function rS(e,t){return!!t&&t.facetId in e.categoryFacetSet}var cl=(e,t)=>{let r=Ur(e,t);if(rS(e,r))return r},ul=(e,t)=>{var r;return(r=e.categoryFacetSet[t])==null?void 0:r.request},nS=(e,t)=>{let r=cl(e,t);return ht((r==null?void 0:r.values)??[])},ll=(e,t)=>{let r=ul(e,t);return ht((r==null?void 0:r.currentValues)??[])},Vr=(e,t)=>{let r=fl(t,e),n=r?r.field:"",a=ps(n,e);return{facetId:e,facetField:n,facetTitle:a}};function _r(e,t){let{facetId:r,facetValue:n}=e,a=Vr(r,t),i=pl(t,r);return{...a,facetValue:i==="hierarchical"?dl(t,r):n}}function Ke(e){return{facetSet:e.facetSet??Zi(),categoryFacetSet:e.categoryFacetSet??Ki(),dateFacetSet:e.dateFacetSet??Xi(),numericFacetSet:e.numericFacetSet??es(),automaticFacetSet:e.automaticFacetSet??Ji()}}var aS=e=>{let t=[];return oS(e).forEach((r,n)=>{let a=pl(e,r.facetId),i=fS(r,n+1);if(sS(r)){if(!ll(e,r.facetId).length)return;t.push({...i,...lS(e,r.facetId),facetType:a,state:"selected"});return}r.currentValues.forEach((s,o)=>{if(s.state==="idle")return;let c=Zo(s,o+1,a),u=iS(r)?Xo(s):uS(s);t.push({...i,...c,...u})})}),cS(e).forEach((r,n)=>{let a=dS(r,n+1);r.values.forEach((i,s)=>{if(i.state==="idle")return;let o=Zo(i,s+1,"specific"),c=Xo(i);t.push({...a,...o,...c})})}),t},iS=e=>e.type==="specific",sS=e=>e.type==="hierarchical",oS=e=>[...Object.values(e.facetSet),...Object.values(e.categoryFacetSet),...Object.values(e.dateFacetSet),...Object.values(e.numericFacetSet)].map(t=>t.request),cS=e=>[...Object.values(e.automaticFacetSet.set)].map(t=>t.response),Zo=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),uS=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),Xo=e=>({displayValue:e.value,value:e.value}),dl=(e,t)=>ll(e,t).map(r=>r.value).join(";"),lS=(e,t)=>{let r=dl(e,t);return{value:r,valuePosition:1,displayValue:r}},dS=(e,t)=>({title:ps(e.field,e.field),field:e.field,id:e.field,facetPosition:t}),fS=(e,t)=>({title:ps(e.field,e.facetId),field:e.field,id:e.facetId,facetPosition:t}),ps=(e,t)=>`${e}_${t}`,fl=(e,t)=>{var r,n,a,i,s;return((r=e.facetSet[t])==null?void 0:r.request)||((n=e.categoryFacetSet[t])==null?void 0:n.request)||((a=e.dateFacetSet[t])==null?void 0:a.request)||((i=e.numericFacetSet[t])==null?void 0:i.request)||((s=e.automaticFacetSet.set[t])==null?void 0:s.response)},pl=(e,t)=>{let r=fl(e,t);return r?r.type:"specific"},gs=class extends sl{constructor(){super(...arguments),this.initialState=Wv()}getPipeline(){return""}getSearchEventRequestPayload(){return{queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){var e;return((e=this.getState().productListing)==null?void 0:e.responseId)||this.initialState.responseId}mapResultsToAnalyticsDocument(){var e;return(e=this.state.productListing)==null?void 0:e.products.map(t=>({documentUri:t.documentUri,documentUriHash:t.documentUriHash,permanentid:t.permanentid}))}get numberOfResults(){return this.state.productListing.products.length}},pS=({logger:e,getState:t,analyticsClientMiddleware:r=(i,s)=>s,preprocessRequest:n,provider:a=new gs(t)})=>{let i=t(),s=i.configuration.accessToken,o=i.configuration.analytics.apiBaseUrl,c=i.configuration.analytics.runtimeEnvironment,u=i.configuration.analytics.enabled,d=new nl({token:s,endpoint:o,runtimeEnvironment:c,preprocessRequest:al(e,n),beforeSendHooks:[il(e,r),(f,l)=>(e.info({...l,type:f,endpoint:o,token:s},"Analytics request"),l)]},a);return u||d.disable(),d},gl=class qi extends sl{constructor(){super(...arguments),this.getFacetRequest=t=>{var r,n,a,i,s,o,c,u,d,f;return((n=(r=this.state.facetSet)==null?void 0:r[t])==null?void 0:n.request)||((i=(a=this.state.categoryFacetSet)==null?void 0:a[t])==null?void 0:i.request)||((o=(s=this.state.dateFacetSet)==null?void 0:s[t])==null?void 0:o.request)||((u=(c=this.state.numericFacetSet)==null?void 0:c[t])==null?void 0:u.request)||((f=(d=this.state.automaticFacetSet)==null?void 0:d.set[t])==null?void 0:f.response)}}getFacetState(){return aS(Ke(this.getState()))}getPipeline(){var t;return this.state.pipeline||((t=this.state.search)==null?void 0:t.response.pipeline)||qi.fallbackPipelineName}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.resultURIs,numberOfResults:this.numberOfResults}}getSearchUID(){var r,n;let t=this.getState();return((r=t.search)==null?void 0:r.searchResponseId)||((n=t.search)==null?void 0:n.response.searchUid)||ft().response.searchUid}getSplitTestRunName(){var t;return(t=this.state.search)==null?void 0:t.response.splitTestRun}getSplitTestRunVersion(){var n;let t=!!this.getSplitTestRunName(),r=((n=this.state.search)==null?void 0:n.response.pipeline)||this.state.pipeline||qi.fallbackPipelineName;return t?r:void 0}getBaseMetadata(){var a,i,s;let t=this.getState(),r=super.getBaseMetadata(),n=(s=(i=(a=t.search)==null?void 0:a.response)==null?void 0:i.extendedResults)==null?void 0:s.generativeQuestionAnsweringId;return n&&(r.generativeQuestionAnsweringId=n),r}getFacetMetadata(t,r){var a;let n=((a=this.getFacetRequest(t))==null?void 0:a.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:n,facetValue:r,facetTitle:`${n}_${t}`}}getFacetClearAllMetadata(t){var n;let r=((n=this.getFacetRequest(t))==null?void 0:n.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:r,facetTitle:`${r}_${t}`}}getFacetUpdateSortMetadata(t,r){var a;let n=((a=this.getFacetRequest(t))==null?void 0:a.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:n,criteria:r,facetTitle:`${n}_${t}`}}getRangeBreadcrumbFacetMetadata(t,r){var a;let n=((a=this.getFacetRequest(t))==null?void 0:a.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:n,facetRangeEnd:r.end,facetRangeEndInclusive:r.endInclusive,facetRangeStart:r.start,facetTitle:`${n}_${t}`}}getResultSortMetadata(){return{...this.getBaseMetadata(),resultsSortBy:this.state.sortCriteria??Xt()}}getStaticFilterToggleMetadata(t,r){return{...this.getBaseMetadata(),staticFilterId:t,staticFilterValue:r}}getStaticFilterClearAllMetadata(t){return{...this.getBaseMetadata(),staticFilterId:t}}getUndoTriggerQueryMetadata(t){return{...this.getBaseMetadata(),undoneQuery:t}}getCategoryBreadcrumbFacetMetadata(t,r){var a;let n=((a=this.getFacetRequest(t))==null?void 0:a.field)??"";return{...this.getBaseMetadata(),categoryFacetId:t,categoryFacetField:n,categoryFacetPath:r,categoryFacetTitle:`${n}_${t}`}}getOmniboxAnalyticsMetadata(t,r){let n=this.state.querySuggest&&this.state.querySuggest[t],a=n.completions.map(c=>c.expression),i=n.partialQueries.length-1,s=n.partialQueries[i]||"",o=n.responseId;return{...this.getBaseMetadata(),suggestionRanking:a.indexOf(r),partialQuery:s,partialQueries:n.partialQueries.length>0?n.partialQueries:"",suggestions:a.length>0?a:"",querySuggestResponseId:o}}getInterfaceChangeMetadata(){return{...this.getBaseMetadata(),interfaceChangeTo:this.state.configuration.analytics.originLevel2}}getOmniboxFromLinkMetadata(t){return{...this.getBaseMetadata(),...t}}getGeneratedAnswerMetadata(){var n;let t=this.getState(),r={};return((n=t.generatedAnswer)==null?void 0:n.isVisible)!==void 0&&(r.showGeneratedAnswer=t.generatedAnswer.isVisible),r}get resultURIs(){var t;return(t=this.results)==null?void 0:t.map(r=>({documentUri:r.uri,documentUriHash:r.raw.urihash}))}get results(){var t;return(t=this.state.search)==null?void 0:t.response.results}get queryText(){var t;return((t=this.state.query)==null?void 0:t.q)||Ge().q}get responseTime(){var t;return((t=this.state.search)==null?void 0:t.duration)||ft().duration}get numberOfResults(){var t;return((t=this.state.search)==null?void 0:t.response.totalCountFiltered)||ft().response.totalCountFiltered}};gl.fallbackPipelineName="default";var sa=gl,gS=({logger:e,getState:t,analyticsClientMiddleware:r=(i,s)=>s,preprocessRequest:n,provider:a=new sa(t)})=>{let i=t(),s=i.configuration.accessToken,o=i.configuration.analytics.apiBaseUrl,c=i.configuration.analytics.runtimeEnvironment,u=i.configuration.analytics.enabled,d=new nl({token:s,endpoint:o,runtimeEnvironment:c,preprocessRequest:al(e,n),beforeSendHooks:[il(e,r),(f,l)=>(e.info({...l,type:f,endpoint:o,token:s},"Analytics request"),l)]},a);return u||d.disable(),d},ec=()=>{let e=Pt.getHistory().reverse().find(t=>t.name==="PageView"&&t.value);return e?e.value:""};function hl(e){let t=yl(e),r=[e,...t].filter(n=>n.parentResult).map(n=>n.parentResult);return _g([e,...t,...r],n=>n.uniqueId)}function yl(e){return e.childResults?e.childResults.flatMap(t=>[t,...yl(t)]):[]}function hS(e,t){return{...new sa(t).getBaseMetadata(),actionCause:e,type:e}}function yS(e){return Object.assign(e,{instantlyCallable:!0})}function mS(e,t){let r=a=>yS(B(e,a)),n=r(async(a,{getState:i,extra:s})=>{let{analyticsClientMiddleware:o,preprocessRequest:c,logger:u}=s;return await(await t({getState:i,analyticsClientMiddleware:o,preprocessRequest:c,logger:u})).log({state:i(),extra:s})});return Object.assign(n,{prepare:async({getState:a,analyticsClientMiddleware:i,preprocessRequest:s,logger:o})=>{let{description:c,log:u}=await t({getState:a,analyticsClientMiddleware:i,preprocessRequest:s,logger:o});return{description:c,action:r(async(d,{getState:f,extra:l})=>await u({state:f(),extra:l}))}}}),n}var ml=(e,t,r)=>{function n(...a){let i=a.length===1?{...a[0],__legacy__getBuilder:t(a[0].__legacy__getBuilder),analyticsConfigurator:e,providerClass:r}:{prefix:a[0],__legacy__getBuilder:t(a[1]),__legacy__provider:a[2],analyticsConfigurator:e,providerClass:r};return wS(i)}return n},vS=e=>e.configuration.analytics.analyticsMode==="legacy",SS=e=>e.configuration.analytics.analyticsMode==="next",wS=({prefix:e,__legacy__getBuilder:t,__legacy__provider:r,analyticsPayloadBuilder:n,analyticsType:a,analyticsConfigurator:i,providerClass:s})=>(r??(r=o=>new s(o)),mS(e,async({getState:o,analyticsClientMiddleware:c,preprocessRequest:u,logger:d})=>{let f=[],l={log:async({state:y})=>{for(let k of f)await k(y)}},g=o(),v=i({getState:o,logger:d,analyticsClientMiddleware:c,preprocessRequest:u,provider:r(o)}),p=await t(v,o());l.description=p==null?void 0:p.description,f.push(async y=>{vS(y)&&await bS(p,r,y,d,v.coveoAnalyticsClient)});let{emit:h}=mi(g);return f.push(async y=>{if(SS(y)&&a&&n){let k=n(y);await FS(h,a,k)}}),l}));async function bS(e,t,r,n,a){t(()=>r);let i=await(e==null?void 0:e.log({searchUID:t(()=>r).getSearchUID()}));n.info({client:a,response:i},"Analytics response")}var R=ml(gS,e=>e,sa),CS=ml(pS,e=>e,gs),Qe=(e,t)=>{var i;let r=s=>{var o;return s+(((o=t.pagination)==null?void 0:o.firstResult)??0)},n=-1,a=(i=t.search)==null?void 0:i.results;return n=Sl(e,a),n<0&&(n=OS(e,a)),n<0&&(n=0),IS(e,r(n),t)};function IS(e,t,r){let n=e.raw.collection;return{collectionName:typeof n=="string"?n:"default",documentAuthor:xS(e),documentPosition:t+1,documentTitle:e.title,documentUri:e.uri,documentUriHash:e.raw.urihash,documentUrl:e.clickUri,rankingModifier:e.rankingModifier||"",sourceName:AS(e),queryPipeline:r.pipeline||Kn()}}var ze=e=>(e.raw.permanentid||console.warn("Missing field permanentid on result. This might cause many issues with your Coveo deployment. See https://docs.coveo.com/en/1913 and https://docs.coveo.com/en/1640 for more information.",e),{contentIDKey:"permanentid",contentIDValue:e.raw.permanentid||""}),vl={urihash:new x,sourcetype:new x,permanentid:new x},hs={uniqueId:T,raw:new P({values:vl}),title:T,uri:T,clickUri:T,rankingModifier:new x({required:!1,emptyAllowed:!0})};function kS(e){return Object.assign({},...Object.keys(vl).map(t=>({[t]:e[t]})))}function qS(e){return Object.assign({},...Object.keys(hs).map(t=>({[t]:e[t]})),{raw:kS(e.raw)})}function xS(e){let t=e.raw.author;return z(t)?"unknown":Array.isArray(t)?t.join(";"):`${t}`}function AS(e){let t=e.raw.source;return z(t)?"unknown":t}var Lr=e=>new oe(hs).validate(qS(e));function OS(e,t){for(let[r,n]of t.entries()){let a=hl(n);if(Sl(e,a)!==-1)return r}return-1}function Sl(e,t=[]){return t.findIndex(({uniqueId:r})=>r===e.uniqueId)}async function FS(e,t,r){await e(t,r)}var RS=()=>R("analytics/interface/load",e=>e.makeInterfaceLoad()),jn=()=>R("analytics/interface/change",(e,t)=>e.makeInterfaceChange({interfaceChangeTo:t.configuration.analytics.originLevel2})),ES=()=>R("analytics/interface/searchFromLink",e=>e.makeSearchFromLink()),DS=e=>R("analytics/interface/omniboxFromLink",t=>t.makeOmniboxFromLink(e)),TS=()=>({actionCause:"interfaceLoad"}),Vn=()=>({actionCause:"interfaceChange"}),MS=()=>({actionCause:"searchFromLink"}),PS=()=>({actionCause:"omniboxFromLink"}),Na=()=>ae,wl=()=>T,oa=S("configuration/updateBasicConfiguration",e=>I(e,{accessToken:ae,organizationId:ae,platformUrl:ae})),er=S("configuration/updateSearchConfiguration",e=>I(e,{apiBaseUrl:ae,pipeline:new x({required:!1,emptyAllowed:!0}),searchHub:ae,timezone:ae,locale:ae,authenticationProviders:new re({required:!1,each:T})})),US={enabled:new K({default:!0}),originContext:Na(),originLevel2:Na(),originLevel3:Na(),apiBaseUrl:ae,nextApiBaseUrl:ae,runtimeEnvironment:new he,anonymous:new K({default:!1}),deviceId:ae,userDisplayName:ae,documentLocation:ae,trackingId:ae,analyticsMode:new x({constrainTo:["legacy","next"],required:!1,default:"legacy"}),source:new P({options:{required:!1},values:km.reduce((e,t)=>(e[t]=rm,e),{})})},ys=S("configuration/updateAnalyticsConfiguration",e=>(Zc()&&(e.enabled=!1),I(e,US))),bl=S("configuration/analytics/disable"),Cl=S("configuration/analytics/enable"),jS=S("configuration/analytics/originlevel2",e=>I(e,{originLevel2:wl()})),VS=S("configuration/analytics/originlevel3",e=>I(e,{originLevel3:wl()})),Il={q:new x,enableQuerySyntax:new K,aq:new x,cq:new x,firstResult:new Q({min:0}),numberOfResults:new Q({min:0}),sortCriteria:new x,f:new P,fExcluded:new P,cf:new P,nf:new P,df:new P,debug:new K,sf:new P,tab:new x,af:new P},Ce=S("searchParameters/restore",e=>I(e,Il)),_S=S("debug/enable"),LS=S("debug/disable"),$S=W(Jn(),e=>{e.addCase(_S,()=>!0).addCase(LS,()=>!1).addCase(Ce,(t,r)=>r.payload.debug??t)}),kl=S("history/undo"),ql=S("history/redo"),We=S("history/snapshot"),tc=B("history/back",async(e,{dispatch:t})=>{t(kl()),await t(me())}),QS=B("history/forward",async(e,{dispatch:t})=>{t(ql()),await t(me())}),me=B("history/change",async(e,{getState:t})=>t().history.present),xl=S("pipeline/set",e=>I(e,new x({required:!0,emptyAllowed:!0}))),Al=W(Kn(),e=>{e.addCase(xl,(t,r)=>r.payload).addCase(me.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.pipeline)??t}).addCase(er,(t,r)=>r.payload.pipeline||t)}),Ol=S("searchHub/set",e=>I(e,new x({required:!0,emptyAllowed:!0}))),Fl=W(Zn(),e=>{e.addCase(Ol,(t,r)=>r.payload).addCase(me.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.searchHub)??t}).addCase(er,(t,r)=>r.payload.searchHub||t)}),Be=S("breadcrumb/deselectAll"),ca=S("breadcrumb/deselectAllNonBreadcrumbs"),$r=S("facet/updateFacetAutoSelection",e=>I(e,{allow:new K({required:!0})})),Rl=class extends sa{constructor(e){super(e),this.getState=e}get activeInstantResultQuery(){let e=this.getState().instantResults;for(let t in e)for(let r in e[t].cache)if(e[t].cache[r].isActive)return e[t].q;return null}get activeInstantResultCache(){let e=this.getState().instantResults;for(let t in e)for(let r in e[t].cache)if(e[t].cache[r].isActive)return e[t].cache[r];return null}get results(){var e;return(e=this.activeInstantResultCache)==null?void 0:e.results}get queryText(){return this.activeInstantResultQuery??Ge().q}get responseTime(){var e;return((e=this.activeInstantResultCache)==null?void 0:e.duration)??ft().duration}get numberOfResults(){var e;return((e=this.activeInstantResultCache)==null?void 0:e.totalCountFiltered)??ft().response.totalCountFiltered}getSearchUID(){var e;return((e=this.activeInstantResultCache)==null?void 0:e.searchUid)||super.getSearchUID()}},zS=e=>R({prefix:"analytics/instantResult/open",__legacy__getBuilder:(t,r)=>(Lr(e),t.makeDocumentOpen(Qe(e,r),ze(e))),__legacy__provider:t=>new Rl(t),analyticsType:"itemClick",analyticsPayloadBuilder:t=>{var a;let r=Qe(e,t),n=ze(e);return{searchUid:((a=t.search)==null?void 0:a.response.searchUid)??"",position:r.documentPosition,actionCause:"open",itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}}),NS=()=>R("analytics/instantResult/searchboxAsYouType",e=>e.makeSearchboxAsYouType(),e=>new Rl(e)),BS=()=>({actionCause:"searchboxAsYouType"}),ms={id:T},HS={...ms,q:Se},El=S("instantResults/register",e=>I(e,ms)),ua=S("instantResults/updateQuery",e=>I(e,HS)),Dl=S("instantResults/clearExpired",e=>I(e,ms)),la=new Q({required:!0,min:0}),Tl=S("pagination/registerNumberOfResults",e=>I(e,la)),Ml=S("pagination/updateNumberOfResults",e=>I(e,la)),Pl=S("pagination/registerPage",e=>I(e,la)),tr=S("pagination/updatePage",e=>I(e,la)),Ul=S("pagination/nextPage"),jl=S("pagination/previousPage"),mt=S("query/updateQuery",e=>I(e,{q:new x,enableQuerySyntax:new K})),da=async(e,t)=>{let r=e.analyticsMode==="next";return{analytics:{clientId:await it(e),clientTimestamp:new Date().toISOString(),documentReferrer:e.originLevel3,originContext:e.originContext,...t&&{actionCause:t.actionCause,customData:t.customData},...t&&!r&&{customData:t.customData},...e.userDisplayName&&{userDisplayName:e.userDisplayName},...e.documentLocation&&{documentLocation:e.documentLocation},...e.deviceId&&{deviceId:e.deviceId},...ec()&&{pageId:ec()},...r&&e.trackingId&&{trackingId:e.trackingId},capture:r,...r&&{source:Qu(e)}}}},vs=async(e,t)=>{var r,n,a,i;return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await it(e.configuration.analytics),actionsHistory:Pt.getHistory()},...((r=e.advancedSearchQueries)==null?void 0:r.aq)&&{aq:e.advancedSearchQueries.aq},...((n=e.advancedSearchQueries)==null?void 0:n.cq)&&{cq:e.advancedSearchQueries.cq},...((a=e.advancedSearchQueries)==null?void 0:a.lq)&&{lq:e.advancedSearchQueries.lq},...((i=e.advancedSearchQueries)==null?void 0:i.dq)&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await da(e.configuration.analytics,t),...e.excerptLength&&!z(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}}},Ss=async(e,t)=>{var r,n,a,i;return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await it(e.configuration.analytics),actionsHistory:Pt.getHistory()},...((r=e.advancedSearchQueries)==null?void 0:r.aq)&&{aq:e.advancedSearchQueries.aq},...((n=e.advancedSearchQueries)==null?void 0:n.cq)&&{cq:e.advancedSearchQueries.cq},...((a=e.advancedSearchQueries)==null?void 0:a.lq)&&{lq:e.advancedSearchQueries.lq},...((i=e.advancedSearchQueries)==null?void 0:i.dq)&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await da(e.configuration.analytics,t),...e.excerptLength&&!z(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}}},rc=()=>R("search/logFetchMoreResults",e=>e.makeFetchMoreResults()),Ve=e=>R("search/queryError",(t,r)=>{var n,a,i,s;return t.makeQueryError({query:((n=r.query)==null?void 0:n.q)||Ge().q,aq:((a=r.advancedSearchQueries)==null?void 0:a.aq)||At().aq,cq:((i=r.advancedSearchQueries)==null?void 0:i.cq)||At().cq,dq:((s=r.advancedSearchQueries)==null?void 0:s.dq)||At().dq,errorType:e.type,errorMessage:e.message})}),wn=Re(Bi()),YS=Re(Cg()),xi=Re(Bi()),WS=Re(Ig());xi.default.extend(WS.default);var ws="YYYY/MM/DD@HH:mm:ss",GS="1401-01-01";function Or(e,t){let r=(0,xi.default)(e,t);return!r.isValid()&&!t?(0,xi.default)(e,ws):r}function bs(e){return e.format(ws)}function JS(e){return bs(Or(e))===e}function Vl(e,t){let r=Or(e,t);if(!r.isValid()){let n=". Please provide a date format string in the configuration options. See https://day.js.org/docs/en/parse/string-format for more information.",a=` with the format "${t}"`;throw new Error(`Could not parse the provided date "${e}"${t?a:n}`)}_l(r)}function _l(e){if(e.isBefore(GS))throw new Error(`Date is before year 1401, which is unsupported by the API: ${e}`)}wn.default.extend(YS.default);var Ll=["past","now","next"],$l=["minute","hour","day","week","month","quarter","year"],KS=e=>{let t=e==="now";return{amount:new Q({required:!t,min:1}),unit:new x({required:!t,constrainTo:$l}),period:new x({required:!0,constrainTo:Ll})}};function _n(e){if(typeof e=="string"&&!Jt(e))throw new Error(`The value "${e}" is not respecting the relative date format "period-amount-unit"`);let t=typeof e=="string"?Cs(e):e;new oe(KS(t.period)).validate(t);let r=Ql(t),n=JSON.stringify(t);if(!r.isValid())throw new Error(`Date is invalid: ${n}`);_l(r)}function ZS(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":case"next":return`${t}-${r}-${n}`;case"now":return t}}function Ql(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":return(0,wn.default)().subtract(r,n);case"next":return(0,wn.default)().add(r,n);case"now":return(0,wn.default)()}}function Ai(e){return bs(Ql(Cs(e)))}function zl(e){return e.toLocaleLowerCase().split("-")}function Jt(e){let[t,r,n]=zl(e);if(t==="now")return!0;if(!Ll.includes(t)||!$l.includes(n))return!1;let a=parseInt(r);return!(isNaN(a)||a<=0)}function XS(e){return!!e&&typeof e=="object"&&"period"in e}function Cs(e){let[t,r,n]=zl(e);return t==="now"?{period:"now"}:{period:t,amount:r?parseInt(r):void 0,unit:n||void 0}}function KA(e){return _n(e),Cs(e)}function ew(e){return e.type==="dateRange"}function Nl(e){return`start${e}`}function Bl(e){return`end${e}`}var tw=()=>({dateFacetValueMap:{}});function rw(e,t,r){let n=e.start,a=e.end;return Jt(n)&&(n=Ai(n),r.dateFacetValueMap[t][Nl(n)]=e.start),Jt(a)&&(a=Ai(a),r.dateFacetValueMap[t][Bl(a)]=e.end),{...e,start:n,end:a}}function nw(e,t){if(ew(e)){let{facetId:r,currentValues:n}=e;return t.dateFacetValueMap[r]={},{...e,currentValues:n.map(a=>rw(a,r,t))}}return e}function Is(e){var r;let t=tw();return{request:{...e,facets:(r=e.facets)==null?void 0:r.map(n=>nw(n,t))},mappings:t}}function aw(e,t,r){return{...e,start:r.dateFacetValueMap[t][Nl(e.start)]||e.start,end:r.dateFacetValueMap[t][Bl(e.end)]||e.end}}function iw(e,t){return e.facetId in t.dateFacetValueMap}function sw(e,t){return iw(e,t)?{...e,values:e.values.map(r=>aw(r,e.facetId,t))}:e}function Hl(e,t){var r;return"success"in e?{success:{...e.success,facets:(r=e.success.facets)==null?void 0:r.map(n=>sw(n,t))}}:e}function ks(e,t){let r={};e.forEach(i=>r[i.facetId]=i);let n=[];t.forEach(i=>{i in r&&(n.push(r[i]),delete r[i])});let a=Object.values(r);return[...n,...a]}function qt(e){return Object.values(e).map(t=>t.request)}var Fe=async(e,t)=>{var o;let r=pw(e),n=ow(e),a=cw(e),i=e.configuration.analytics.analyticsMode==="legacy"?await Ss(e,t):await vs(e,t),s=()=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0;return Is({...i,...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="next",options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="legacy"},...r&&{cq:r},...n.length&&{facets:n},...e.pagination&&{numberOfResults:s(),firstResult:e.pagination.firstResult},...e.facetOptions&&{facetOptions:{freezeFacetOrder:e.facetOptions.freezeFacetOrder}},...((o=e.folding)==null?void 0:o.enabled)&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.automaticFacetSet&&{generateAutomaticFacets:{desiredCount:e.automaticFacetSet.desiredCount,numberOfValues:e.automaticFacetSet.numberOfValues,currentFacets:a}},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})};function ow(e){return ks(lw(e),e.facetOrder??[])}function cw(e){var r;let t=(r=e.automaticFacetSet)==null?void 0:r.set;return t?Object.values(t).map(n=>n.response).map(uw).filter(n=>n.currentValues.length>0):void 0}function uw(e){let{field:t,label:r,values:n}=e,a=n.filter(i=>i.state==="selected");return{field:t,label:r,currentValues:a}}function lw(e){return dw(e).filter(({facetId:t})=>{var r,n;return((n=(r=e.facetOptions)==null?void 0:r.facets[t])==null?void 0:n.enabled)??!0})}function dw(e){return[...fw(e.facetSet??{}),...nc(e.numericFacetSet??{}),...nc(e.dateFacetSet??{}),...qt(e.categoryFacetSet??{})]}function fw(e){return qt(e).map(t=>t.sortCriteria==="alphanumericDescending"?{...t,sortCriteria:{type:"alphanumeric",order:"descending"}}:t)}function nc(e){return qt(e).map(t=>{let r=t.currentValues.some(({state:n})=>n!=="idle");return t.generateAutomaticRanges&&!r?{...t,currentValues:[]}:t})}function pw(e){var a,i;let t=((a=e.advancedSearchQueries)==null?void 0:a.cq.trim())||"",r=((i=Object.values(e.tabSet||{}).find(s=>s.isActive))==null?void 0:i.expression.trim())||"",n=gw(e);return[t,r,...n].filter(s=>!!s).join(" AND ")}function gw(e){return Object.values(e.staticFilterSet||{}).map(t=>{let r=t.values.filter(a=>a.state==="selected"&&!!a.expression.trim()),n=r.map(a=>a.expression).join(" OR ");return r.length>1?`(${n})`:n})}var Yl=S("didYouMean/enable"),hw=S("didYouMean/disable"),Wl=S("didYouMean/automaticCorrections/disable"),yw=S("didYouMean/automaticCorrections/enable"),Qr=S("didYouMean/correction",e=>I(e,T)),Gl=S("didYouMean/automaticCorrections/mode",e=>I(e,new x({constrainTo:["next","legacy"],emptyAllowed:!1,required:!0}))),mw=()=>R("analytics/didyoumean/click",e=>e.makeDidYouMeanClick()),ac=()=>R("analytics/didyoumean/automatic",e=>e.makeDidYouMeanAutomatic()),vw=()=>({actionCause:"didyoumeanClick"}),Sw=()=>({actionCause:"didyoumeanAutomatic"}),ww=new P({values:{undoneQuery:Se},options:{required:!0}}),bw=()=>R("analytics/trigger/query",(e,t)=>{var r;return(r=t.triggers)!=null&&r.queryModification.newQuery?e.makeTriggerQuery():null}),Cw=e=>R("analytics/trigger/query/undo",t=>(I(e,ww),t.makeUndoTriggerQuery(e))),Iw=()=>R("analytics/trigger/notify",(e,t)=>{var r;return(r=t.triggers)!=null&&r.notifications.length?e.makeTriggerNotify({notifications:t.triggers.notifications}):null}),kw=()=>({actionCause:"undoQuery"}),fa=S("trigger/query/ignore",e=>I(e,new x({emptyAllowed:!0,required:!0}))),qs=S("trigger/query/modification",e=>I(e,new P({values:{originalQuery:ae,modification:ae}}))),zr=class{constructor(e,t=r=>{this.dispatch(mt({q:r}))}){this.config=e,this.onUpdateQueryForCorrection=t}async fetchFromAPI({mappings:e,request:t},r){var o;let n=new Date().getTime(),a=Hl(await this.extra.apiClient.search(t,r),e),i=new Date().getTime()-n,s=((o=this.getState().query)==null?void 0:o.q)||"";return{response:a,duration:i,queryExecuted:s,requestExecuted:t}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return $e(e.response)?(this.dispatch(Ve(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:a}=t.didYouMean,{results:i,queryCorrections:s,queryCorrection:o}=r;if(!n||!a)return null;let c=i.length===0&&s&&s.length!==0,u=!z(o)&&!z(o.correctedQuery);if(!c&&!u)return null;let d=c?await this.processLegacyDidYouMeanAutoCorrection(e):this.processModernDidYouMeanAutoCorrection(e);return this.dispatch(We(et(this.getState()))),d}async processLegacyDidYouMeanAutoCorrection(e){let t=this.getCurrentQuery(),r=this.getSuccessResponse(e);if(!r.queryCorrections)return null;let{correctedQuery:n}=r.queryCorrections[0],a=await this.automaticallyRetryQueryWithCorrection(n);return $e(a.response)?(this.dispatch(Ve(a.response.error)),this.rejectWithValue(a.response.error)):(this.logOriginalAnalyticsQueryBeforeAutoCorrection(e),this.dispatch(We(et(this.getState()))),{...a,response:{...a.response.success,queryCorrections:r.queryCorrections},automaticallyCorrected:!0,originalQuery:t,analyticsAction:ac()})}processModernDidYouMeanAutoCorrection(e){let t=this.getSuccessResponse(e),{correctedQuery:r,originalQuery:n}=t.queryCorrection;return this.onUpdateQueryForCorrection(r),{...e,response:{...t},queryExecuted:r,automaticallyCorrected:!0,originalQuery:n,analyticsAction:ac()}}logOriginalAnalyticsQueryBeforeAutoCorrection(e){let t=this.getState(),r=this.getSuccessResponse(e);this.analyticsAction&&this.analyticsAction()(this.dispatch,()=>this.getStateAfterResponse(e.queryExecuted,e.duration,t,r),this.extra)}async processQueryTriggersOrContinue(e){var i,s;let t=this.getSuccessResponse(e);if(!t)return null;let r=((i=t.triggers.find(o=>o.type==="query"))==null?void 0:i.content)||"";if(!r)return null;if(((s=this.getState().triggers)==null?void 0:s.queryModification.queryToIgnore)===r)return this.dispatch(fa("")),null;this.analyticsAction&&await this.dispatch(this.analyticsAction);let n=this.getCurrentQuery(),a=await this.automaticallyRetryQueryWithTriggerModification(r);return $e(a.response)?(this.dispatch(Ve(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(We(et(this.getState()))),{...a,response:{...a.response.success},automaticallyCorrected:!1,originalQuery:n,analyticsAction:bw()})}getStateAfterResponse(e,t,r,n){var a;return{...r,query:{q:e,enableQuerySyntax:((a=r.query)==null?void 0:a.enableQuerySyntax)??Ge().enableQuerySyntax},search:{...ft(),duration:t,response:n,results:n.results}}}processSuccessResponse(e){return this.dispatch(We(et(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(e){return ju(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let t=await this.fetchFromAPI(await Fe(this.getState()),{origin:"mainSearch"});return this.dispatch(Qr(e)),t}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(qs({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await Fe(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){var t;let e=this.getState();return((t=e.query)==null?void 0:t.q)!==void 0?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get analyticsAction(){return this.config.analyticsAction}get rejectWithValue(){return this.config.rejectWithValue}};B("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;I(e,{q:new x,enableQuerySyntax:new K,clearFilters:new K}),e.clearFilters&&(r(Be()),r(ca())),r($r({allow:!0})),r(mt({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(tr(1))});var Ba=B("search/executeSearch",async(e,t)=>{let r=t.getState();return await xs(r,t,e)}),Ha=B("search/fetchPage",async(e,t)=>{let r=t.getState();return await Zl(r,t,e)}),Ya=B("search/fetchMoreResults",async(e,t)=>{let r=t.getState();return await Xl(t,r)}),qw=B("search/fetchFacetValues",async(e,t)=>{let r=t.getState();return await Fw(t,e,r)});B("search/fetchInstantResults",async(e,t)=>Kl(e,t));var xw=async(e,t)=>{var n,a;let r=await Fe(e,t);return r.request={...r.request,firstResult:(((n=e.pagination)==null?void 0:n.firstResult)??0)+(((a=e.search)==null?void 0:a.results.length)??0)},r},Aw=async(e,t,r)=>{let n=await Ss(e);return Is({...n,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},Ow=async(e,t)=>{let r=await Fe(e,t);return r.request.numberOfResults=0,r},Jl=e=>{var t;e.configuration.analytics.enabled&&Pt.addElement({name:"Query",...((t=e.query)==null?void 0:t.q)&&{value:e.query.q},time:JSON.stringify(new Date)})};async function Kl(e,t){I(e,{id:T,q:T,maxResultsPerQuery:new Q({required:!0,min:1}),cacheTimeout:new Q});let{q:r,maxResultsPerQuery:n}=e,a=t.getState(),i=new zr({...t,analyticsAction:NS()},u=>{t.dispatch(ua({q:u,id:e.id}))}),s=await Aw(a,r,n),o=await i.fetchFromAPI(s,{origin:"instantResults",disableAbortWarning:!0}),c=await i.process(o);return"response"in c?{results:c.response.results,searchUid:c.response.searchUid,analyticsAction:c.analyticsAction,totalCountFiltered:c.response.totalCountFiltered,duration:c.duration}:c}async function Zl(e,t,r){Jl(e);let{analyticsClientMiddleware:n,preprocessRequest:a,logger:i}=t.extra,{description:s}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:i}),o=new zr({...t,analyticsAction:r}),c=await Fe(e,s),u=await o.fetchFromAPI(c,{origin:"mainSearch"});return await o.process(u)}async function Xl(e,t){let{analyticsClientMiddleware:r,preprocessRequest:n,logger:a}=e.extra,{description:i}=await rc().prepare({getState:()=>e.getState(),analyticsClientMiddleware:r,preprocessRequest:n,logger:a}),s=new zr({...e,analyticsAction:rc()}),o=await xw(t,i),c=await s.fetchFromAPI(o,{origin:"mainSearch"});return await s.process(c)}async function Fw(e,t,r){let{analyticsClientMiddleware:n,preprocessRequest:a,logger:i}=e.extra,{description:s}=await t.prepare({getState:()=>e.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:i}),o=new zr({...e,analyticsAction:t}),c=await Ow(r,s),u=await o.fetchFromAPI(c,{origin:"facetValues"});return await o.process(u)}async function xs(e,t,r){Jl(e);let{analyticsClientMiddleware:n,preprocessRequest:a,logger:i}=t.extra,{description:s}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:i}),o=await Fe(e,s),c=new zr({...t,analyticsAction:r}),u=await c.fetchFromAPI(o,{origin:"mainSearch"});return await c.process(u)}var Nr=class{constructor(e,t=r=>{this.dispatch(mt({q:r}))}){this.config=e,this.onUpdateQueryForCorrection=t}async fetchFromAPI({mappings:e,request:t},r){var o;let n=new Date().getTime(),a=Hl(await this.extra.apiClient.search(t,r),e),i=new Date().getTime()-n,s=((o=this.getState().query)==null?void 0:o.q)||"";return{response:a,duration:i,queryExecuted:s,requestExecuted:t}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return $e(e.response)?(this.dispatch(Ve(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:a}=t.didYouMean,{results:i,queryCorrections:s,queryCorrection:o}=r;if(!n||!a)return null;let c=i.length===0&&s&&s.length!==0,u=!z(o)&&!z(o.correctedQuery);if(!c&&!u)return null;let d=c?await this.processLegacyDidYouMeanAutoCorrection(e):this.processModernDidYouMeanAutoCorrection(e);return this.dispatch(We(et(this.getState()))),d}async processLegacyDidYouMeanAutoCorrection(e){let t=this.getCurrentQuery(),r=this.getSuccessResponse(e);if(!r.queryCorrections)return null;let{correctedQuery:n}=r.queryCorrections[0],a=await this.automaticallyRetryQueryWithCorrection(n);return $e(a.response)?(this.dispatch(Ve(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(We(et(this.getState()))),{...a,response:{...a.response.success,queryCorrections:r.queryCorrections},automaticallyCorrected:!0,originalQuery:t})}processModernDidYouMeanAutoCorrection(e){let t=this.getSuccessResponse(e),{correctedQuery:r,originalQuery:n}=t.queryCorrection;return this.onUpdateQueryForCorrection(r),{...e,response:{...t},queryExecuted:r,automaticallyCorrected:!0,originalQuery:n}}async processQueryTriggersOrContinue(e){var i,s;let t=this.getSuccessResponse(e);if(!t)return null;let r=((i=t.triggers.find(o=>o.type==="query"))==null?void 0:i.content)||"";if(!r)return null;if(((s=this.getState().triggers)==null?void 0:s.queryModification.queryToIgnore)===r)return this.dispatch(fa("")),null;let n=this.getCurrentQuery(),a=await this.automaticallyRetryQueryWithTriggerModification(r);return $e(a.response)?(this.dispatch(Ve(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(We(et(this.getState()))),{...a,response:{...a.response.success},automaticallyCorrected:!1,originalQuery:n})}processSuccessResponse(e){return this.dispatch(We(et(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery()}}getSuccessResponse(e){return ju(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let t=this.getState(),{actionCause:r}=Sw(),n=await this.fetchFromAPI(await Fe(t,{actionCause:r}),{origin:"mainSearch"});return this.dispatch(Qr(e)),n}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(qs({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await Fe(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){var t;let e=this.getState();return((t=e.query)==null?void 0:t.q)!==void 0?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}},ed=B("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;I(e,{q:new x,enableQuerySyntax:new K,clearFilters:new K}),e.clearFilters&&(r(Be()),r(ca())),r($r({allow:!0})),r(mt({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(tr(1))}),E=B("search/executeSearch",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return xs(r,t,e.legacy);td(r);let n=As(e.next),a=await Fe(r,n),i=new Nr({...t,analyticsAction:n}),s=await i.fetchFromAPI(a,{origin:"mainSearch"});return await i.process(s)}),zt=B("search/fetchPage",async(e,t)=>{let r=t.getState();if(td(r),r.configuration.analytics.analyticsMode==="legacy"||!e.next)return Zl(r,t,e.legacy);let n=new Nr({...t,analyticsAction:e.next}),a=await Fe(r,e.next),i=await n.fetchFromAPI(a,{origin:"mainSearch"});return await n.process(i)}),pa=B("search/fetchMoreResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return Xl(t,r);let n=hS("pagerScrolling",t.getState),a=new Nr({...t,analyticsAction:n}),i=await Rw(r,n),s=await a.fetchFromAPI(i,{origin:"mainSearch"});return await a.process(s)}),Kt=B("search/fetchFacetValues",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return xs(r,t,e.legacy);let n=As(e.next),a=new Nr({...t,analyticsAction:n}),i=await Dw(r,n),s=await a.fetchFromAPI(i,{origin:"facetValues"});return await a.process(s)}),bn=B("search/fetchInstantResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return Kl(e,t);I(e,{id:T,q:T,maxResultsPerQuery:new Q({required:!0,min:1}),cacheTimeout:new Q});let{q:n,maxResultsPerQuery:a}=e,i=As(BS()),s=await Ew(r,n,a,i),o=new Nr({...t,analyticsAction:i},d=>{t.dispatch(ua({q:d,id:e.id}))}),c=await o.fetchFromAPI(s,{origin:"instantResults",disableAbortWarning:!0}),u=await o.process(c);return"response"in u?{results:u.response.results,searchUid:u.response.searchUid,totalCountFiltered:u.response.totalCountFiltered,duration:u.duration}:u}),Rw=async(e,t)=>{var n,a;let r=await Fe(e,t);return r.request={...r.request,firstResult:(((n=e.pagination)==null?void 0:n.firstResult)??0)+(((a=e.search)==null?void 0:a.results.length)??0)},r},Ew=async(e,t,r,n)=>{let a=await vs(e,n);return Is({...a,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},Dw=async(e,t)=>{let r=await Fe(e,t);return r.request.numberOfResults=0,r},td=e=>{var t;e.configuration.analytics.enabled&&Pt.addElement({name:"Query",...((t=e.query)==null?void 0:t.q)&&{value:e.query.q},time:JSON.stringify(new Date)})},As=e=>({actionCause:e.actionCause,type:e.actionCause}),rr=(e,t)=>{let r=e;return z(r[t])?z(e.raw[t])?null:e.raw[t]:r[t]},Tw=e=>t=>e.every(r=>!z(rr(t,r))),Mw=e=>t=>e.every(r=>z(rr(t,r))),Pw=(e,t)=>r=>{let n=rd(e,r);return t.some(a=>n.some(i=>`${i}`.toLowerCase()===a.toLowerCase()))},Uw=(e,t)=>r=>{let n=rd(e,r);return t.every(a=>n.every(i=>`${i}`.toLowerCase()!==a.toLowerCase()))},rd=(e,t)=>{let r=rr(t,e);return Jc(r)?r:[r]},ZA={getResultProperty:rr,fieldsMustBeDefined:Tw,fieldsMustNotBeDefined:Mw,fieldMustMatch:Pw,fieldMustNotMatch:Uw};function Oi(e){return e.search.response.searchUid!==""}function jw(e,t,r){return e.search.results.find(n=>rr(n,t)===r)}function Wa(e,t){let r=t.payload??null;r&&(e.response=ft().response,e.results=[],e.questionAnswer=On()),e.error=r,e.isLoading=!1}function Fi(e,t){e.error=null,e.response=t.payload.response,e.queryExecuted=t.payload.queryExecuted,e.duration=t.payload.duration,e.isLoading=!1}function Vw(e,t){Fi(e,t),e.results=t.payload.response.results,e.searchResponseId=t.payload.response.searchUid,e.questionAnswer=t.payload.response.questionAnswer,e.extendedResults=t.payload.response.extendedResults}function Ga(e,t){e.isLoading=!0,e.requestId=t.meta.requestId}var ce=W(ft(),e=>{e.addCase(Ba.rejected,(t,r)=>Wa(t,r)),e.addCase(Ya.rejected,(t,r)=>Wa(t,r)),e.addCase(Ha.rejected,(t,r)=>Wa(t,r)),e.addCase(Ba.fulfilled,(t,r)=>{Vw(t,r)}),e.addCase(Ya.fulfilled,(t,r)=>{Fi(t,r),t.results=[...t.results,...r.payload.response.results]}),e.addCase(Ha.fulfilled,(t,r)=>{Fi(t,r),t.results=r.payload.response.results}),e.addCase(qw.fulfilled,(t,r)=>{t.response.facets=r.payload.response.facets,t.response.searchUid=r.payload.response.searchUid}),e.addCase(Ba.pending,Ga),e.addCase(Ya.pending,Ga),e.addCase(Ha.pending,Ga)}),_w=W(ls,e=>e);function Lw(){return typeof window<"u"&&typeof document<"u"}function $w(e){var r;let t=(r=e.payload)==null?void 0:r.analyticsAction;return nd(e)&&!z(t)}function nd(e){return"type"in e}var Qw=e=>t=>r=>{let n;$w(r)&&(n=r.payload.analyticsAction,delete r.payload.analyticsAction);let a=t(r);return nd(r)&&(r.type==="search/executeSearch/fullfilled"&&n===void 0&&console.error("No analytics action associated with search:",r),r.type==="recommendation/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with recommendation:",r),r.type==="productRecommendations/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with product recommendation:",r)),n!==void 0&&e.dispatch(n),a},zw=Re(kg()),ad=S("tab/register",e=>{let t=new P({values:{id:T,expression:Se}});return I(e,t)}),Fr=S("tab/updateActiveTab",e=>I(e,T));function Nw(e,t){if(Oy(e))return e.replace(/^(https:\/\/)platform/,"$1analytics")+ru;let r=Fy(e,t);return r?Yg(t,r.environment).analytics:e}var id=W(Gi(),e=>e.addCase(oa,(t,r)=>{r.payload.accessToken&&(t.accessToken=r.payload.accessToken),r.payload.organizationId&&(t.organizationId=r.payload.organizationId),r.payload.platformUrl&&(t.platformUrl=r.payload.platformUrl,t.search.apiBaseUrl=`${r.payload.platformUrl}${tu}`,t.analytics.apiBaseUrl=Nw(r.payload.platformUrl,t.organizationId))}).addCase(er,(t,r)=>{r.payload.apiBaseUrl&&(t.search.apiBaseUrl=r.payload.apiBaseUrl),r.payload.locale&&(t.search.locale=r.payload.locale),r.payload.timezone&&(t.search.timezone=r.payload.timezone),r.payload.authenticationProviders&&(t.search.authenticationProviders=r.payload.authenticationProviders)}).addCase(ys,(t,r)=>{z(r.payload.enabled)||(t.analytics.enabled=r.payload.enabled),z(r.payload.originContext)||(t.analytics.originContext=r.payload.originContext),z(r.payload.originLevel2)||(t.analytics.originLevel2=r.payload.originLevel2),z(r.payload.originLevel3)||(t.analytics.originLevel3=r.payload.originLevel3),z(r.payload.apiBaseUrl)||(t.analytics.apiBaseUrl=r.payload.apiBaseUrl),z(r.payload.nextApiBaseUrl)||(t.analytics.nextApiBaseUrl=r.payload.nextApiBaseUrl),z(r.payload.trackingId)||(t.analytics.trackingId=r.payload.trackingId),z(r.payload.analyticsMode)||(t.analytics.analyticsMode=r.payload.analyticsMode),z(r.payload.source)||(t.analytics.source=r.payload.source);let n=(0,zw.default)();n&&(t.analytics.analyticsMode="next",t.analytics.trackingId=n),z(r.payload.runtimeEnvironment)||(t.analytics.runtimeEnvironment=r.payload.runtimeEnvironment),z(r.payload.anonymous)||(t.analytics.anonymous=r.payload.anonymous),z(r.payload.deviceId)||(t.analytics.deviceId=r.payload.deviceId),z(r.payload.userDisplayName)||(t.analytics.userDisplayName=r.payload.userDisplayName),z(r.payload.documentLocation)||(t.analytics.documentLocation=r.payload.documentLocation)}).addCase(bl,t=>{t.analytics.enabled=!1}).addCase(Cl,t=>{t.analytics.enabled=!0}).addCase(jS,(t,r)=>{t.analytics.originLevel2=r.payload.originLevel2}).addCase(VS,(t,r)=>{t.analytics.originLevel3=r.payload.originLevel3}).addCase(Fr,(t,r)=>{t.analytics.originLevel2=r.payload}).addCase(Ce,(t,r)=>{t.analytics.originLevel2=r.payload.tab||t.analytics.originLevel2})),ie=id;function Bw(e){return e.instantlyCallable}var Hw=()=>e=>t=>e(Bw(t)?t():t),Yw=e=>()=>t=>r=>{var i;let n=r;if(!n.error)return t(r);let a=n.error;if((i=n.payload)!=null&&i.ignored||e.error(a.stack||a.message||a.name||"Error",`Action dispatch error ${n.type}`,r),n.error.name!=="SchemaValidationError")return t(r)},Ww=e=>t=>r=>n=>(e.debug({action:n,nextState:t.getState()},`Action dispatched: ${n.type}`),r(n));function Gw(e,t){let r={...e},n,a=i=>(s,o)=>{let c=i(s,o);return n?n(c,o):c};return{get combinedReducer(){let i=Qg(Object.entries(t).filter(([s])=>!(s in r)).map(([s,o])=>[s,()=>o]));return a(Su({...i,...r}))},containsAll(i){return Object.keys(i).every(s=>s in r)},add(i){Object.keys(i).filter(s=>!(s in r)).forEach(s=>r[s]=i[s])},addCrossReducer(i){n=i}}}function sd(e,t,r){var n,a,i;t===void 0&&(t=50),r===void 0&&(r={});var s=(n=r.isImmediate)!=null&&n,o=(a=r.callback)!=null&&a,c=r.maxWait,u=Date.now(),d=[];function f(){if(c!==void 0){var g=Date.now()-u;if(g+t>=c)return c-g}return t}var l=function(){var g=[].slice.call(arguments),v=this;return new Promise(function(p,h){var y=s&&i===void 0;if(i!==void 0&&clearTimeout(i),i=setTimeout(function(){if(i=void 0,u=Date.now(),!s){var D=e.apply(v,g);o&&o(D),d.forEach(function(U){return(0,U.resolve)(D)}),d=[]}},f()),y){var k=e.apply(v,g);return o&&o(k),p(k)}d.push({resolve:p,reject:h})})};return l.cancel=function(g){i!==void 0&&clearTimeout(i),d.forEach(function(v){return(0,v.reject)(g)}),d=[]},l}function Jw(e,t){let r=0,n=sd(()=>r=0,500);return a=>i=>async s=>{if(typeof s!="function")return i(s);let o=await i(s);if(!Kw(o))return o;if(typeof t!="function")return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),o;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),o;r++,n();let c=await Zw(t);a.dispatch(oa({accessToken:c})),a.dispatch(s)}}function Kw(e){var t;return((t=e==null?void 0:e.error)==null?void 0:t.name)===new Gc().name}async function Zw(e){try{return await e()}catch{return""}}function Xw({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:n,name:a}){return iy({reducer:e,preloadedState:t,devTools:{stateSanitizer:i=>i.history?{...i,history:"<<OMIT>>"}:i,name:a,shouldHotReload:!1},middleware:i=>i({thunk:{extraArgument:n}}).prepend(...r).concat(Ww(n.logger))})}var eb={configuration:ie,version:_w};function tb(e,t){var s;let r=((s=e.organizationEndpoints)==null?void 0:s.analytics)||void 0,{analyticsClientMiddleware:n,...a}=e.analytics??{},i={...a,nextApiBaseUrl:`${r}/rest/organizations/${e.organizationId}/events/v1`,apiBaseUrl:r};if(Zc())return t.info("Analytics disabled since doNotTrack is active."),{...i,enabled:!1};if(i.analyticsMode==="next"&&!a.trackingId)throw new ub('analytics.trackingId is required when analytics.analyticsMode="next"');return i}function rb(e,t){var c;let r=nb(e,t),{accessToken:n,organizationId:a}=e.configuration,{organizationEndpoints:i}=e.configuration,s=(i==null?void 0:i.platform)||e.configuration.platformUrl;ob(e.configuration)&&r.logger.warn(`The \`platformUrl\` (${e.configuration.platformUrl}) option will be deprecated in the next major version. Consider using the \`organizationEndpoints\` option instead. See [Organization endpoints](https://docs.coveo.com/en/mcc80216).`),sb(e.configuration)?r.logger.warn("The `organizationEndpoints` options was not explicitly set in the Headless engine configuration. Coveo recommends setting this option, as it has resiliency benefits and simplifies the overall configuration for multi-region deployments. See [Organization endpoints](https://docs.coveo.com/en/mcc80216)."):cb(e.configuration)&&r.logger.warn(`There is a mismatch between the \`organizationId\` option (${e.configuration.organizationId}) and the organization configured in the \`organizationEndpoints\` option (${(c=e.configuration.organizationEndpoints)==null?void 0:c.platform}). This could lead to issues that are complex to troubleshoot. Please make sure both values match.`),r.dispatch(oa({accessToken:n,organizationId:a,platformUrl:s}));let o=tb(e.configuration,r.logger);return o&&r.dispatch(ys(o)),r}function nb(e,t){let{reducers:r}=e,n=Gw({...eb,...r},e.preloadedState??{});e.crossReducer&&n.addCrossReducer(e.crossReducer);let a=t.logger,i=e.navigatorContextProvider??Lw()?xg:Ag,s={...t,get relay(){return mi(c.state)},get navigatorContext(){return i()}},o=ab(e,s,n),c={addReducers(u){n.containsAll(u)||(n.add(u),o.replaceReducer(n.combinedReducer))},dispatch:o.dispatch,subscribe:o.subscribe,enableAnalytics(){o.dispatch(Cl())},disableAnalytics(){o.dispatch(bl())},get state(){return o.getState()},get relay(){return mi(this.state)},get navigatorContext(){return i()},logger:a,store:o};return c}function ab(e,t,r){let{preloadedState:n,configuration:a}=e,i=a.name||"coveo-headless",s=ib(e,t.logger);return Xw({preloadedState:n,reducer:r.combinedReducer,middlewares:s,thunkExtraArguments:t,name:i})}function ib(e,t){let{renewAccessToken:r}=e.configuration,n=Jw(t,r);return[Hw,n,Yw(t),Qw].concat(e.middlewares||[])}function sb(e){return ve(e.organizationEndpoints)}function ob(e){var t;return!z(e.platformUrl)||z((t=e.organizationEndpoints)==null?void 0:t.platform)}function cb(e){let{platform:t}=e.organizationEndpoints;if(ve(t))return!1;let r=Mu(t);return r&&r.organizationId!==e.organizationId}var ub=class extends Error{constructor(e){super(e),this.name="InvalidEngineConfiguration"}},lb=Re(Nc());function db(e){return(0,lb.default)({name:"@coveo/headless",level:(e==null?void 0:e.level)||"warn",formatters:{log:e==null?void 0:e.logFormatter}})}function fb(e,t){let r=pb(e),n=Tt,a=gb(e);return{analyticsClientMiddleware:r,validatePayload:n,preprocessRequest:a,logger:t}}function pb(e){let{analytics:t}=e,r=(n,a)=>a;return(t==null?void 0:t.analyticsClientMiddleware)||r}function gb(e){return e.preprocessRequest||Uu}var hb=Re(Hc()),Os=(e,t,r,n,a,i)=>{let s=e[t];z(s)||z(a)||a!==s&&a!==n&&(i.warn(`Mismatch on access token (JWT Token) ${t} and engine configuration.`),i.warn(`To remove this warning, make sure that access token value [${s}] matches engine configuration value [${r}]`))},Fs=(e,t)=>!(z(e)||t===e),fr=e=>{try{let t=typeof atob<"u"?atob:hb.atob,r=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=t(r);if(!n)return!1;let a=decodeURIComponent(n.split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(a)}catch{return!1}},od=(e,t)=>(Fs(e.searchHub,t.searchHub)&&(t.searchHub=e.searchHub),t),ic=(e,t,r,n)=>(Os(e,"searchHub",t.searchHub,Zn(),r,n),od(e,t)),cd=(e,t)=>(Fs(e.pipeline,t.pipeline)&&(t.pipeline=e.pipeline),t),sc=(e,t,r,n)=>(Os(e,"pipeline",t.pipeline,Kn(),r,n),cd(e,t)),ud=(e,t)=>(Fs(e.userDisplayName,t.configuration.analytics.userDisplayName)&&(t.configuration.analytics.userDisplayName=e.userDisplayName),t),yb=(e,t,r,n)=>(Os(e,"userDisplayName",t.configuration.analytics.userDisplayName,Gi().analytics.userDisplayName,r,n),ud(e,t)),mb=e=>W({},t=>{t.addCase(Ol,(r,n)=>{let a=fr(r.configuration.accessToken);return a?ic(a,r,n.payload,e):r}).addCase(xl,(r,n)=>{let a=fr(r.configuration.accessToken);return a?sc(a,r,n.payload,e):r}).addCase(oa,(r,n)=>{if(r.configuration.accessToken!==n.payload.accessToken)return r;let{accessToken:a}=n.payload;if(!a)return r;let i=fr(a);return i?[cd,od,ud].reduce((s,o)=>o(i,s),r):r}).addCase(er,(r,n)=>{var s;let a=fr(r.configuration.accessToken);if(!a)return r;let i=ic(a,r,n.payload.searchHub,e);return sc(a,i,(s=n.payload)==null?void 0:s.pipeline,e)}).addCase(ys,(r,n)=>{let a=fr(r.configuration.accessToken);return a?yb(a,r,n.payload.userDisplayName,e):r})}),vb={organizationId:T,accessToken:T,platformUrl:new x({required:!1,emptyAllowed:!1}),name:new x({required:!1,emptyAllowed:!1}),analytics:new P({options:{required:!1},values:{enabled:new K({required:!1}),originContext:new x({required:!1}),originLevel2:new x({required:!1}),originLevel3:new x({required:!1}),analyticsMode:new x({constrainTo:["legacy","next"],required:!1})}})},Sb=new oe({...vb,search:new P({options:{required:!1},values:{pipeline:new x({required:!1,emptyAllowed:!0}),searchHub:ae,locale:ae,timezone:ae,authenticationProviders:new re({required:!1,each:T})}})}),wb={debug:$S,pipeline:Al,searchHub:Fl,search:ce};function bb(e){var n;let t=e.configuration.search,r=((n=e.configuration.organizationEndpoints)==null?void 0:n.search)||void 0;return{...t,apiBaseUrl:r}}function XA(e){let t=db(e.loggerOptions);Cb(e.configuration,t);let r=Ib(e.configuration,t),n=kb(t),a={...fb(e.configuration,t),apiClient:r,streamingClient:n},i={...e,reducers:wb,crossReducer:mb(t)},s=rb(i,a),o=bb(e);return o&&s.dispatch(er(o)),{...s,get state(){return s.state},executeFirstSearch(c=RS()){if(Oi(s.state))return;let u=E({legacy:c,next:TS()});s.dispatch(u)},executeFirstSearchAfterStandaloneSearchBoxRedirect(c){let{cause:u,metadata:d}=c;if(Oi(s.state))return;let f=d&&u==="omniboxFromLink",l=E({legacy:f?DS(d):ES(),next:f?PS():MS()});s.dispatch(l)}}}function Cb(e,t){try{Sb.validate(e)}catch(r){throw t.error(r,"Search engine configuration error"),r}}function Ib(e,t){let{search:r}=e;return new Yy({logger:t,preprocessRequest:e.preprocessRequest||Uu,postprocessSearchResponseMiddleware:(r==null?void 0:r.preprocessSearchResponseMiddleware)||Zy,postprocessFacetSearchResponseMiddleware:(r==null?void 0:r.preprocessFacetSearchResponseMiddleware)||Xy,postprocessQuerySuggestResponseMiddleware:(r==null?void 0:r.preprocessQuerySuggestResponseMiddleware)||em})}function kb(e){return new Py({logger:e})}function ne(e){let t,r=new Map,n=()=>r.size===0,a=i=>{try{let s=JSON.stringify(i),o=t!==s;return t=s,o}catch(s){return console.warn('Could not detect if state has changed, check the controller "get state method"',s),!0}};return{subscribe(i){i();let s=Symbol(),o;return n()&&(t=JSON.stringify(this.state),o=e.subscribe(()=>{a(this.state)&&r.forEach(c=>c())})),r.set(s,i),()=>{r.delete(s),n()&&o&&o()}},get state(){return{}}}}var ga=S("fields/registerFieldsToInclude",e=>I(e,Vu)),ld=S("fields/fetchall/enable"),dd=S("fields/fetchall/disable"),fd=B("fields/fetchDescription",async(e,{extra:t,getState:r,rejectWithValue:n})=>{let a=r(),{accessToken:i,organizationId:s}=a.configuration,{apiBaseUrl:o}=a.configuration.search,c=await t.apiClient.fieldDescriptions({accessToken:i,organizationId:s,url:o});return $e(c)?n(c.error):c.success.fields}),pd={collectionField:new x({emptyAllowed:!1,required:!1}),parentField:new x({emptyAllowed:!1,required:!1}),childField:new x({emptyAllowed:!1,required:!1}),numberOfFoldedResults:new Q({min:0,required:!1})},Rs=S("folding/register",e=>I(e,pd)),Cn=B("folding/loadCollection",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let a=t(),i=a.configuration.analytics.analyticsMode==="legacy"?await Ss(a):await vs(a),s=await n.search({...i,q:qb(a),enableQuerySyntax:!0,cq:`@${a.folding.fields.collection}="${e}"`,filterField:a.folding.fields.collection,childField:a.folding.fields.parent,parentField:a.folding.fields.child,filterFieldRange:100},{origin:"foldingCollection"});return $e(s)?r(s.error):{collectionId:e,results:s.success.results,rootResult:a.folding.collections[e].result}});function qb(e){return e.query.q===""?"":e.query.enableQuerySyntax?`${e.query.q} OR @uri`:`( <@- ${e.query.q} -@> ) OR @uri`}var Es=W(sh(),e=>e.addCase(ga,(t,r)=>{t.fieldsToInclude=[...new Set(t.fieldsToInclude.concat(r.payload))]}).addCase(ld,t=>{t.fetchAllFields=!0}).addCase(dd,t=>{t.fetchAllFields=!1}).addCase(fd.fulfilled,(t,{payload:r})=>{t.fieldsDescription=r}).addCase(Rs,(t,{payload:r})=>{let n=cu().fields;t.fieldsToInclude.push(r.collectionField??n.collection,r.parentField??n.parent,r.childField??n.child)})),xb=new re({each:T,required:!0}),gd=(e,t)=>(I(e,T),ea(t)?I(t,T):I(t,xb),{payload:{contextKey:e,contextValue:t}}),Ab=S("context/set",e=>{for(let[t,r]of Object.entries(e))gd(t,r);return{payload:e}}),Ob=S("context/add",e=>gd(e.contextKey,e.contextValue)),Fb=S("context/remove",e=>I(e,T));W(nu(),e=>{e.addCase(Ab,(t,r)=>{t.contextValues=r.payload}).addCase(Ob,(t,r)=>{t.contextValues[r.payload.contextKey]=r.payload.contextValue}).addCase(Fb,(t,r)=>{delete t.contextValues[r.payload]}).addCase(me.fulfilled,(t,r)=>{r.payload&&(t.contextValues=r.payload.context.contextValues)})});new oe({values:new P({options:{required:!1}})});var Rb=S("dictionaryFieldContext/set",e=>{let t=new P({options:{required:!0}}),r=I(e,t).error;if(r)return{payload:e,error:r};let n=Object.values(e),a=new re({each:Se}),i=I(n,a).error;return i?{payload:e,error:i}:{payload:e}}),Eb=S("dictionaryFieldContext/add",e=>{let t=new P({options:{required:!0},values:{field:Se,key:Se}});return I(e,t)}),Db=S("dictionaryFieldContext/remove",e=>I(e,Se));W(au(),e=>{e.addCase(Rb,(t,r)=>{t.contextValues=r.payload}).addCase(Eb,(t,r)=>{let{field:n,key:a}=r.payload;t.contextValues[n]=a}).addCase(Db,(t,r)=>{delete t.contextValues[r.payload]}).addCase(me.fulfilled,(t,r)=>{r.payload&&(t.contextValues=r.payload.dictionaryFieldContext.contextValues)})});var Tb=fe(e=>e.queryCorrection.correctedQuery!==""||e.wasCorrectedTo!=="",e=>e),Mb=(e,t)=>{var n;let r={...Kg(),...t,correctedQuery:(t==null?void 0:t.correctedQuery)||((n=t==null?void 0:t.corrections[0])==null?void 0:n.correctedQuery)||""};e.queryCorrection=r,e.wasCorrectedTo=r.correctedQuery},Pb=W(Zg(),e=>{e.addCase(Yl,t=>{t.enableDidYouMean=!0}).addCase(hw,t=>{t.enableDidYouMean=!1}).addCase(yw,t=>{t.automaticallyCorrectQuery=!0}).addCase(Wl,t=>{t.automaticallyCorrectQuery=!1}).addCase(E.pending,t=>{t.queryCorrection=ui(),t.wasAutomaticallyCorrected=!1,t.wasCorrectedTo=""}).addCase(E.fulfilled,(t,r)=>{let{queryCorrection:n,queryCorrections:a}=r.payload.response;if(t.queryCorrectionMode==="legacy"){let i=a&&a[0]?a[0]:ui();t.queryCorrection=i}t.queryCorrectionMode==="next"&&Mb(t,n),t.wasAutomaticallyCorrected=r.payload.automaticallyCorrected,t.originalQuery=r.payload.originalQuery}).addCase(Qr,(t,r)=>{t.wasCorrectedTo=r.payload}).addCase(Gl,(t,r)=>{t.queryCorrectionMode=r.payload})});function Ub(e,t={}){var s,o;jb(e);let r=ne(e),{dispatch:n}=e;n(Yl()),((s=t.options)==null?void 0:s.automaticallyCorrectQuery)===!1&&n(Wl()),n(Gl(((o=t.options)==null?void 0:o.queryCorrectionMode)||"legacy"));let a=()=>e.state,i=()=>Tb(a().didYouMean);return{...r,get state(){let c=a();return{originalQuery:c.didYouMean.originalQuery,wasCorrectedTo:c.didYouMean.wasCorrectedTo,wasAutomaticallyCorrected:c.didYouMean.wasAutomaticallyCorrected,queryCorrection:c.didYouMean.queryCorrection,hasQueryCorrection:i()}},applyCorrection(){n(Qr(this.state.queryCorrection.correctedQuery))}}}function jb(e){return e.addReducers({configuration:ie,didYouMean:Pb}),!0}function eO(e,t={}){let r=Ub(e,t),{dispatch:n}=e;return{...r,get state(){return r.state},applyCorrection(){r.applyCorrection(),n(E({legacy:mw(),next:vw()}))}}}var G=T,ue=S("facetOptions/update",(e={freezeFacetOrder:!0})=>I(e,{freezeFacetOrder:new K({required:!1})})),Ut=S("facetOptions/facet/enable",e=>I(e,G)),He=S("facetOptions/facet/disable",e=>I(e,G)),Ds={facetId:G,captions:new P({options:{required:!1}}),numberOfValues:new Q({required:!1,min:1}),query:new x({required:!1,emptyAllowed:!0})},Vb={path:new re({required:!0,each:T}),displayValue:Se,rawValue:Se,count:new Q({required:!0,min:0})},Ts=S("categoryFacet/selectSearchResult",e=>I(e,{facetId:G,value:new P({values:Vb})})),Ms=S("categoryFacetSearch/register",e=>I(e,Ds));function Ps(e,t){var i;let{facetId:r,criterion:n}=t,a=(i=e[r])==null?void 0:i.request;a&&(a.sortCriteria=n)}function gn(e){e&&(e.currentValues=e.currentValues.map(t=>({...t,state:"idle"})),e.preventAutoSelect=!0)}function hd(e,t){e&&(e.numberOfValues=t)}function Ja(e,t){let r=e[t];r&&(r.request.numberOfValues=r.initialNumberOfValues,r.request.currentValues=[],r.request.preventAutoSelect=!0)}function oc(e,t,r){e.currentValues=_b(t,r),e.numberOfValues=t.length?1:r,e.preventAutoSelect=!0}function _b(e,t){if(!e.length)return[];let r=cc(e[0],t),n=r;for(let a of e.splice(1)){let i=cc(a,t);n.children.push(i),n=i}return n.state="selected",n.retrieveChildren=!0,[r]}function cc(e,t){return{value:e,retrieveCount:t,children:[],state:"idle",retrieveChildren:!1}}var Lb={state:new he({required:!0}),numberOfResults:new Q({required:!0,min:0}),value:new x({required:!0,emptyAllowed:!0}),path:new re({required:!0,each:T}),moreValuesAvailable:new K({required:!1})};function yd(e){e.children.forEach(t=>{yd(t)}),Tt({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},Lb)}var Zt={facetId:G,field:T,delimitingCharacter:new x({required:!1,emptyAllowed:!0}),filterFacetCount:new K({required:!1}),injectionDepth:new Q({required:!1,min:0}),numberOfValues:new Q({required:!1,min:1}),sortCriteria:new he({required:!1}),basePath:new re({required:!1,each:T}),filterByBasePath:new K({required:!1})},Us=S("categoryFacet/register",e=>I(e,Zt)),js=S("categoryFacet/toggleSelectValue",e=>{try{return Tt(e.facetId,T),yd(e.selection),{payload:e,error:null}}catch(t){return{payload:e,error:Dt(t)}}}),ha=S("categoryFacet/deselectAll",e=>I(e,Zt.facetId)),Ri=S("categoryFacet/updateNumberOfValues",e=>I(e,{facetId:Zt.facetId,numberOfValues:Zt.numberOfValues})),md=S("categoryFacet/updateSortCriterion",e=>I(e,{facetId:Zt.facetId,criterion:new he})),$b=S("categoryFacet/updateBasePath",e=>I(e,{facetId:Zt.facetId,basePath:new re({each:T})})),Vs=W(Ki(),e=>{e.addCase(Us,(t,r)=>{let n=r.payload,{facetId:a}=n;if(a in t)return;let i=zb(n),s=i.numberOfValues;t[a]={request:i,initialNumberOfValues:s}}).addCase(me.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.categoryFacetSet)??t}).addCase(Ce,(t,r)=>{let n=r.payload.cf||{};Object.keys(t).forEach(a=>{let i=t[a].request,s=n[a]||[];(s.length||i.currentValues.length)&&oc(i,s,t[a].initialNumberOfValues)})}).addCase(md,(t,r)=>{var s;let{facetId:n,criterion:a}=r.payload,i=(s=t[n])==null?void 0:s.request;i&&(i.sortCriteria=a)}).addCase($b,(t,r)=>{var s;let{facetId:n,basePath:a}=r.payload,i=(s=t[n])==null?void 0:s.request;i&&(i.basePath=[...a])}).addCase(js,(t,r)=>{var f;let{facetId:n,selection:a,retrieveCount:i}=r.payload,s=(f=t[n])==null?void 0:f.request;if(!s)return;let{path:o}=a,c=o.slice(0,o.length-1),u=Qb(s,c,i);if(u.length){let l=u[0];l.retrieveChildren=!0,l.state="selected",l.children=[];return}let d=Sd(a.value,i);d.state="selected",u.push(d),s.numberOfValues=1}).addCase(ha,(t,r)=>{let n=r.payload;Ja(t,n)}).addCase(Be,t=>{Object.keys(t).forEach(r=>Ja(t,r))}).addCase($r,(t,r)=>Object.keys(t).forEach(n=>{t[n].request.preventAutoSelect=!r.payload.allow})).addCase(Ri,(t,r)=>{var s;let{facetId:n,numberOfValues:a}=r.payload,i=(s=t[n])==null?void 0:s.request;if(i){if(!i.currentValues.length)return hd(i,a);Nb(t,r.payload)}}).addCase(Ts,(t,r)=>{let{facetId:n,value:a}=r.payload,i=t[n];if(!i)return;let s=[...a.path,a.rawValue];oc(i.request,s,i.initialNumberOfValues)}).addCase(Kt.fulfilled,(t,r)=>{uc(t,r.payload.response.facets)}).addCase(E.fulfilled,(t,r)=>{uc(t,r.payload.response.facets)}).addCase(He,(t,r)=>{Ja(t,r.payload)})}),vd={delimitingCharacter:";",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:5,sortCriteria:"occurrences",basePath:[],filterByBasePath:!0,resultsMustMatch:"atLeastOneValue"};function Qb(e,t,r){let n=e.currentValues;for(let a of t){let i=n[0];(!i||a!==i.value)&&(i=Sd(a,r),n.length=0,n.push(i)),i.retrieveChildren=!1,i.state="idle",n=i.children}return n}function zb(e){return{...vd,currentValues:[],preventAutoSelect:!1,type:"hierarchical",...e}}function Sd(e,t){return{value:e,state:"idle",children:[],retrieveChildren:!0,retrieveCount:t}}function uc(e,t){t.forEach(r=>{var s;if(!Bb(e,r))return;let n=r.facetId,a=(s=e[n])==null?void 0:s.request;if(!a)return;let i=Hb(a,r);a.currentValues=i?[]:a.currentValues,a.preventAutoSelect=!1})}function Nb(e,t){var i;let{facetId:r,numberOfValues:n}=t,a=(i=e[r])==null?void 0:i.request.currentValues[0];if(a){for(;a.children.length&&(a==null?void 0:a.state)!=="selected";)a=a.children[0];a.retrieveCount=n}}function Bb(e,t){return t.facetId in e}function Hb(e,t){let r=ht(e.currentValues),n=ht(t.values);return r.length!==n.length}var wd=e=>Yb(e.cartItems,e.cart);function Yb(e,t){let r=e.reduce((n,a)=>{let{productId:i,quantity:s}=t[a];return i in n||(n[i]={productId:i,quantity:0}),n[i].quantity+=s,n},{});return[...Object.values(r)]}var _s=(e=>(e.Relevance="relevance",e.Fields="fields",e))(_s||{}),Ls=(e=>(e.Ascending="asc",e.Descending="desc",e))(Ls||{});new P({options:{required:!1},values:{by:new Ft({enum:_s,required:!0}),fields:new re({each:new P({values:{name:new x,direction:new Ft({enum:Ls})}})})}});new P({options:{required:!1},values:{by:new Ft({enum:_s,required:!0}),fields:new re({each:new P({values:{field:new x({required:!0}),direction:new Ft({enum:Ls}),displayName:new x}})})}});var jt=async e=>({...await Wb(e),facets:Jb(e),...e.commerceSort&&{sort:Kb(e.commerceSort.appliedSort)}}),Wb=async(e,t)=>{let{view:r,user:n,...a}=e.commerceContext;return{accessToken:e.configuration.accessToken,url:e.configuration.platformUrl,organizationId:e.configuration.organizationId,trackingId:e.configuration.analytics.trackingId,...a,clientId:await it(e.configuration.analytics),context:{user:n,view:r,cart:wd(e.cart)},...Gb(e,t)}},Gb=(e,t)=>{var n,a;let r=t?(n=e.commercePagination)==null?void 0:n.recommendations[t]:(a=e.commercePagination)==null?void 0:a.principal;return r&&{page:r.page,...r.perPage&&{perPage:r.perPage}}};function Jb(e){return!e.facetOrder||!e.commerceFacetSet?[]:e.facetOrder.map(t=>e.commerceFacetSet[t].request).filter(t=>t.values.length>0)}function Kb(e){return e.by==="relevance"?{sortCriteria:"relevance"}:{sortCriteria:"fields",fields:e.fields.map(({name:t,direction:r})=>({field:t,direction:r}))}}var Zb=async(e,t,r)=>{var k,D;let n=`*${t.categoryFacetSearchSet[e].options.query}*`,a=(k=t.commerceFacetSet[e])==null?void 0:k.request,i=a&&Xb(a)?a&&e0(a):[],s=i.length?[i]:[],o=(D=t.commerceQuery)==null?void 0:D.query,{url:c,accessToken:u,organizationId:d,trackingId:f,language:l,country:g,currency:v,clientId:p,context:h,...y}=await jt(t);return{url:c,accessToken:u,organizationId:d,facetId:e,facetQuery:n,ignorePaths:s,trackingId:f,language:l,country:g,currency:v,clientId:p,context:h,...y,query:o}};function Xb(e){return e.type==="hierarchical"}var e0=e=>{let t=[],r=e.values[0];for(;r;)t.push(r.value),r=r.children[0];return t},t0=async(e,t,r)=>{var p;let n=`*${t.facetSearchSet[e].options.query}*`,a=(p=t.commerceQuery)==null?void 0:p.query;a===void 0&&(a="");let{url:i,accessToken:s,organizationId:o,trackingId:c,language:u,country:d,currency:f,clientId:l,context:g,...v}=await jt(t);return{url:i,accessToken:s,organizationId:o,facetId:e,facetQuery:n,trackingId:c,language:u,country:d,currency:f,clientId:l,context:g,...v,query:a}},bd=e=>async(t,{getState:r,extra:{apiClient:n,validatePayload:a}})=>{let i=r();a(t,T);let s=r0(i,t)||n0(i,t)?t0(t,i):Zb(t,i),o=await n.facetSearch(await s);return{facetId:t,response:o}},Nt=B("commerce/facetSearch/executeSearch",bd()),Bt=B("commerce/facetSearch/facetFieldSuggest",bd()),r0=(e,t)=>"facetSearchSet"in e&&e.facetSearchSet[t]!==void 0&&e.commerceFacetSet[t]!==void 0,n0=(e,t)=>"fieldSuggestionsOrder"in e?e.fieldSuggestionsOrder.some(r=>r.facetId===t&&r.type==="regular"):!1,Vt=e=>e.error!==void 0,Cd=fe(e=>{var t;return((t=e.commercePagination)==null?void 0:t.principal.perPage)||0},e=>e);fe((e,t)=>{var r,n;return((n=(r=e.commercePagination)==null?void 0:r.recommendations[t])==null?void 0:n.perPage)||0},e=>e);var Id=fe(e=>{var t;return((t=e.commercePagination)==null?void 0:t.principal.totalEntries)||0},e=>e);fe((e,t)=>{var r,n;return((n=(r=e.commercePagination)==null?void 0:r.recommendations[t])==null?void 0:n.totalEntries)||0},e=>e);fe(e=>{var t;return((t=e.commercePagination)==null?void 0:t.principal.page)||0},e=>e);fe((e,t)=>{var r,n;return((n=(r=e.commercePagination)==null?void 0:r.recommendations[t])==null?void 0:n.page)||0},e=>e);fe(e=>e.productListing.responseId,e=>e);fe(e=>e.productListing.requestId,e=>e);var kd=fe(e=>{var t;return((t=e.productListing)==null?void 0:t.products.length)||0},e=>e),a0=fe(e=>({total:Id(e),current:kd(e)}),({current:e,total:t})=>e<t);fe(e=>{var t;return(t=e.productListing)==null?void 0:t.isLoading},e=>z(e)?!1:e);fe(e=>{var t;return(t=e.productListing)==null?void 0:t.error},e=>e);var $s=B("commerce/productListing/fetch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t(),{apiClient:s}=a,o=await s.getProductListing(await jt(i));return Vt(o)?(r(Ve(o.error)),n(o.error)):{response:o.success}});B("commerce/productListing/fetchMoreProducts",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t();if(!a0(i))return null;let{apiClient:s}=a,o=Cd(i),c=kd(i)/o,u=await s.getProductListing({...await jt(i),page:c});return Vt(u)?(r(Ve(u.error)),n(u.error)):{response:u.success}});var nr={id:T},Qs=S("querySuggest/register",e=>I(e,{...nr,count:new Q({min:0})})),i0=S("querySuggest/unregister",e=>I(e,nr)),Br=S("querySuggest/selectSuggestion",e=>I(e,{...nr,expression:Se})),Sr=S("querySuggest/clear",e=>I(e,nr)),wr=B("querySuggest/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:a}})=>{a(e,nr);let i=e.id,s=await s0(i,t()),o=await n.querySuggest(s);return $e(o)?r(o.error):{id:i,q:s.q,...o.success}}),s0=async(e,t)=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl,count:t.querySuggest[e].count,q:t.querySet[e],locale:t.configuration.search.locale,timezone:t.configuration.search.timezone,actionsHistory:t.configuration.analytics.enabled?Pt.getHistory():[],...t.context&&{context:t.context.contextValues},...t.pipeline&&{pipeline:t.pipeline},...t.searchHub&&{searchHub:t.searchHub},tab:t.configuration.analytics.originLevel2,...t.configuration.analytics.enabled&&{visitorId:await it(t.configuration.analytics),...t.configuration.analytics.enabled&&await da(t.configuration.analytics)},...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")}}),br=B("commerce/querySuggest/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:a}})=>{a(e,nr);let i=t(),s=await o0(e.id,i),o=await n.querySuggest(s);return Vt(o)?r(o.error):{id:e.id,query:s.query,...o.success}}),o0=async(e,t)=>{let{view:r,user:n,...a}=t.commerceContext;return{accessToken:t.configuration.accessToken,url:t.configuration.platformUrl,organizationId:t.configuration.organizationId,trackingId:t.configuration.analytics.trackingId,query:t.querySet[e],...a,clientId:await it(t.configuration.analytics),context:{user:n,view:r,cart:wd(t.cart)}}},c0=S("query/updateQuery",e=>I(e,{query:new x}));fe(e=>e.commerceSearch.responseId,e=>e);fe(e=>e.commerceSearch.requestId,e=>e);var qd=fe(e=>{var t;return((t=e.commerceSearch)==null?void 0:t.products.length)||0},e=>e),u0=fe(e=>({total:Id(e),current:qd(e)}),({current:e,total:t})=>e<t);fe(e=>{var t;return(t=e.commerceSearch)==null?void 0:t.isLoading},e=>z(e)?!1:e);fe(e=>{var t;return(t=e.commerceSearch)==null?void 0:t.error},e=>e);var zs=fe(e=>{var t;return(t=e.commerceQuery)==null?void 0:t.query},e=>e??"");fe(e=>{var t;return(t=e.commerceSearch)==null?void 0:t.queryExecuted},e=>e);var xd=(e,t)=>{var r,n;return((r=t.queryCorrection)==null?void 0:r.correctedQuery)!==void 0?(n=t.queryCorrection)==null?void 0:n.correctedQuery:zs(e)},Ns=B("commerce/search/executeSearch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t(),{apiClient:s}=a,o=zs(i),c=await s.search({...await jt(i),query:o});return Vt(c)?(r(Ve(c.error)),n(c.error)):{response:c.success,originalQuery:o,queryExecuted:xd(i,c.success)}});B("commerce/search/fetchMoreProducts",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t();if(!u0(i))return null;let{apiClient:s}=a,o=Cd(i),c=qd(i)/o,u=zs(i),d=await s.search({...await jt(i),query:u,page:c});return Vt(d)?(r(Ve(d.error)),n(d.error)):{response:d.success,originalQuery:u,queryExecuted:xd(i,d.success)}});B("commerce/search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;I(e,{query:new x,clearFilters:new K}),e.clearFilters&&(r(Be()),r(ca())),r($r({allow:!0})),r(c0({query:e.query})),r(tr(1))});B("commerce/search/fetchInstantProducts",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t(),{q:s}=e,{apiClient:o}=a,c=await o.productSuggestions({...await jt(i),query:s});if(Vt(c))return r(Ve(c.error)),n(c.error);let u=c.success.products.slice(0,5);return{response:{...c.success,products:u}}});function Bs(e,t,r){let{facetId:n}=t;if(e[n])return;let a=!1,i={...Je,...t},s=r();e[n]={options:i,isLoading:a,response:s,initialNumberOfValues:i.numberOfValues,requestId:""}}function Ad(e,t){let{facetId:r,...n}=t,a=e[r];a&&(a.options={...a.options,...n})}function Ht(e,t,r){let n=e[t];n&&(n.requestId=r,n.isLoading=!0)}function Yt(e,t){let r=e[t];r&&(r.isLoading=!1)}function Od(e,t,r){let{facetId:n,response:a}=t,i=e[n];i&&i.requestId===r&&(i.isLoading=!1,i.response=a)}function Fd(e,t,r){let{facetId:n,response:a}=t,i=e[n];i&&i.requestId===r&&(i.isLoading=!1,"success"in a&&(i.response=a.success))}function Rd(e,t,r,n){let{facetId:a,response:i}=t,s=e[a];if(!s)Bs(e,{facetId:a},n),s=e[a];else if(s.requestId!==r)return;s.isLoading=!1,"success"in i&&(s.response=i.success)}function l0(e,t,r,n){if(t.fieldSuggestionsFacets)for(let a of t.fieldSuggestionsFacets)a.facetId in e||a.type!=="regular"||(e[a.facetId]={options:{...Je,query:t.query??""},isLoading:!1,response:n(),initialNumberOfValues:Je.numberOfValues,requestId:r})}function d0(e,t,r,n){if(t.fieldSuggestionsFacets)for(let a of t.fieldSuggestionsFacets)a.facetId in e||a.type!=="hierarchical"||(e[a.facetId]={options:{...Je,query:t.query??""},isLoading:!1,response:n(),initialNumberOfValues:Je.numberOfValues,requestId:r})}function Hs(e,t,r){let{facetId:n}=t,a=e[n];a&&(a.requestId="",a.isLoading=!1,a.response=r(),a.options.numberOfValues=a.initialNumberOfValues,a.options.query=Je.query)}function xt(e,t){Object.keys(e).forEach(r=>Hs(e,{facetId:r},t))}var Je={captions:{},numberOfValues:10,query:""},f0=async(e,t,r)=>{let n=t.categoryFacetSearchSet[e].options,a=t.categoryFacetSet[e].request,{captions:i,query:s,numberOfValues:o}=n,{field:c,delimitingCharacter:u,basePath:d,filterFacetCount:f}=a,l=p0(a),g=l.length?[l]:[],v=`*${s}*`;return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")},basePath:d,captions:i,numberOfValues:o,query:v,field:c,delimitingCharacter:u,ignorePaths:g,filterFacetCount:f,type:"hierarchical",...r?{}:{searchContext:(await Fe(t)).request}}},p0=e=>{let t=[],r=e.currentValues[0];for(;r;)t.push(r.value),r=r.children[0];return t},g0=async(e,t,r)=>{let{captions:n,query:a,numberOfValues:i}=t.facetSearchSet[e].options,{field:s,currentValues:o,filterFacetCount:c}=t.facetSet[e].request,u=o.filter(f=>f.state!=="idle").map(f=>f.value),d=`*${a}*`;return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders&&{authentication:t.configuration.search.authenticationProviders.join(",")},captions:n,numberOfValues:i,query:d,field:s,ignoreValues:u,filterFacetCount:c,type:"specific",...r?{}:{searchContext:(await Fe(t)).request}}},Ed=e=>async(t,{getState:r,extra:{apiClient:n,validatePayload:a}})=>{let i=r(),s;a(t,T),h0(i,t)?s=await g0(t,i,e):s=await f0(t,i,e);let o=await n.facetSearch(s);return{facetId:t,response:o}},tt=B("facetSearch/executeSearch",Ed(!1)),Ys=B("facetSearch/executeSearch",Ed(!0)),Ws=S("facetSearch/clearResults",e=>I(e,{facetId:G})),h0=(e,t)=>e.facetSearchSet!==void 0&&e.facetSet!==void 0&&e.facetSet[t]!==void 0,Dd={facetId:G,value:new P({values:{displayValue:Se,rawValue:Se,count:new Q({required:!0,min:0})}})},Td=S("facetSearch/register",e=>I(e,Ds)),Cr=S("facetSearch/update",e=>I(e,Ds)),Ln=S("facetSearch/toggleSelectValue",e=>I(e,Dd)),$n=S("facetSearch/toggleExcludeValue",e=>I(e,Dd)),Md=W(eh(),e=>{e.addCase(Ms,(t,r)=>{let n=r.payload;Bs(t,n,bt)}).addCase(Cr,(t,r)=>{Ad(t,r.payload)}).addCase(Nt.pending,(t,r)=>{let n=r.meta.arg;Ht(t,n,r.meta.requestId)}).addCase(Bt.pending,(t,r)=>{let n=r.meta.arg;Ht(t,n,r.meta.requestId)}).addCase(tt.pending,(t,r)=>{let n=r.meta.arg;Ht(t,n,r.meta.requestId)}).addCase(Nt.rejected,(t,r)=>{let n=r.meta.arg;Yt(t,n)}).addCase(Bt.rejected,(t,r)=>{let n=r.meta.arg;Yt(t,n)}).addCase(tt.rejected,(t,r)=>{let n=r.meta.arg;Yt(t,n)}).addCase(Nt.fulfilled,(t,r)=>{Fd(t,r.payload,r.meta.requestId)}).addCase(Bt.fulfilled,(t,r)=>{Rd(t,r.payload,r.meta.requestId,bt)}).addCase(br.fulfilled,(t,r)=>{d0(t,r.payload,r.meta.requestId,bt)}).addCase(tt.fulfilled,(t,r)=>{Od(t,r.payload,r.meta.requestId)}).addCase(Ws,(t,{payload:{facetId:r}})=>{Hs(t,{facetId:r},bt)}).addCase($s.fulfilled,t=>xt(t,bt)).addCase(Ns.fulfilled,t=>xt(t,bt)).addCase(E.fulfilled,t=>{xt(t,bt)})});function bt(){return{moreValuesAvailable:!1,values:[]}}var Pd=e=>R("analytics/facet/showMore",(t,r)=>{I(e,G);let n=Vr(e,Ke(r));return t.makeFacetShowMore(n)}),Ud=e=>R("analytics/facet/showLess",(t,r)=>{I(e,G);let n=Vr(e,Ke(r));return t.makeFacetShowLess(n)}),ya=e=>R("analytics/facet/sortChange",(t,r)=>{I(e,{facetId:G,criterion:new he({required:!0})});let{facetId:n,criterion:a}=e,i=Ke(r),s={...Vr(n,i),criteria:a};return t.makeFacetUpdateSort(s)}),vt=e=>R("analytics/facet/reset",(t,r)=>{I(e,G);let n=Ke(r),a=Vr(e,n);return t.makeFacetClearAll(a)}),nt=e=>R("analytics/facet/select",(t,r)=>{I(e,{facetId:G,facetValue:T});let n=Ke(r),a=_r(e,n);return t.makeFacetSelect(a)}),Rr=e=>R("analytics/facet/exclude",(t,r)=>{I(e,{facetId:G,facetValue:T});let n=Ke(r),a=_r(e,n);return t.makeFacetExclude(a)}),Er=e=>R("analytics/facet/deselect",(t,r)=>{I(e,{facetId:G,facetValue:T});let n=Ke(r),a=_r(e,n);return t.makeFacetDeselect(a)}),Qn=e=>R("analytics/facet/unexclude",(t,r)=>{I(e,{facetId:G,facetValue:T});let n=Ke(r),a=_r(e,n);return t.makeFacetUnexclude(a)}),Ka=e=>R("analytics/facet/breadcrumb",(t,r)=>{I(e,{facetId:G,facetValue:T});let n=_r(e,Ke(r));return t.makeBreadcrumbFacet(n)}),ma=()=>({actionCause:"facetUpdateSort"}),St=()=>({actionCause:"facetClearAll"}),at=()=>({actionCause:"facetSelect"}),zn=()=>({actionCause:"facetExclude"}),Dr=()=>({actionCause:"facetDeselect"}),y0=()=>({actionCause:"facetUnexclude"}),Za=()=>({actionCause:"breadcrumbFacet"}),Hr=(e,t)=>{var r;return((r=e.facetOptions.facets[t])==null?void 0:r.enabled)??!0},Yr=new x({regex:/^[a-zA-Z0-9-_]+$/}),Wr=new x({required:!0}),m0=new re({each:new x}),v0=new x,S0=new K,Gr=new K,Jr=new Q({min:0}),ar=new Q({min:1}),jd=new K({required:!0}),w0=new P,b0=new x,C0={captions:w0,numberOfValues:ar,query:b0},Gs=new P({values:C0}),Vd=new P({options:{required:!1},values:{type:new x({constrainTo:["simple"],emptyAllowed:!1,required:!0}),values:new re({required:!0,max:25,each:new x({emptyAllowed:!1,required:!0})})}}),I0=new K,_d=new re({min:1,max:25,required:!1,each:new x({emptyAllowed:!1,required:!0})}),va={value:T,numberOfResults:new Q({min:0}),state:T},k0={facetId:G,field:new x({required:!0,emptyAllowed:!0}),filterFacetCount:new K({required:!1}),injectionDepth:new Q({required:!1,min:0}),numberOfValues:new Q({required:!1,min:1}),sortCriteria:new he({required:!1}),resultsMustMatch:new he({required:!1}),allowedValues:Vd,customSort:_d},Js=S("facet/register",e=>I(e,k0)),Sa=S("facet/toggleSelectValue",e=>I(e,{facetId:G,selection:new P({values:va})})),wa=S("facet/toggleExcludeValue",e=>I(e,{facetId:G,selection:new P({values:va})})),Te=S("facet/deselectAll",e=>I(e,G)),Ld=S("facet/updateSortCriterion",e=>I(e,{facetId:G,criterion:new he({required:!0})})),Ei=S("facet/updateNumberOfValues",e=>I(e,{facetId:G,numberOfValues:new Q({required:!0,min:1})})),Di=S("facet/updateIsFieldExpanded",e=>I(e,{facetId:G,isFieldExpanded:new K({required:!0})})),Nn=S("facet/updateFreezeCurrentValues",e=>I(e,{facetId:G,freezeCurrentValues:new K({required:!0})}));function $d(e){let t=lc(e.start,e),r=lc(e.end,e),n=e.endInclusive??!1,a=e.state??"idle";return{start:t,end:r,endInclusive:n,state:a}}function lc(e,t){let{dateFormat:r}=t;return XS(e)?(_n(e),ZS(e)):typeof e=="string"&&Jt(e)?(_n(e),e):(Vl(e,r),bs(Or(e,r)))}var Ks=S("rangeFacet/updateSortCriterion",e=>I(e,{facetId:G,criterion:new he({required:!0})})),Kr={state:T,start:new Q({required:!0}),end:new Q({required:!0}),endInclusive:new K({required:!0}),numberOfResults:new Q({required:!0,min:0})},Zr={start:T,end:T,endInclusive:new K({required:!0}),state:T,numberOfResults:new Q({required:!0,min:0})},ba=e=>({facetId:G,selection:typeof e.start=="string"?new P({values:Zr}):new P({values:Kr})}),q0={start:T,end:T,endInclusive:new K({required:!0}),state:T},x0={facetId:G,field:T,currentValues:new re({required:!1,each:new P({values:q0})}),generateAutomaticRanges:new K({required:!0}),filterFacetCount:new K({required:!1}),injectionDepth:new Q({required:!1,min:0}),numberOfValues:new Q({required:!1,min:1}),sortCriteria:new he({required:!1}),rangeAlgorithm:new he({required:!1})};function dc(e){return Jt(e)?Ai(e):e}function Zs(e){e.currentValues&&e.currentValues.forEach(t=>{let{start:r,end:n}=$d(t);if(Or(dc(r)).isAfter(Or(dc(n))))throw new Error(`The start value is greater than the end value for the date range ${t.start} to ${t.end}`)})}var Xr=S("dateFacet/register",e=>{try{return Tt(e,x0),Zs(e),{payload:e,error:null}}catch(t){return{payload:e,error:Dt(t)}}}),en=S("dateFacet/toggleSelectValue",e=>I(e,{facetId:G,selection:new P({values:Zr})})),tn=S("dateFacet/toggleExcludeValue",e=>I(e,{facetId:G,selection:new P({values:Zr})})),Tr=S("dateFacet/updateFacetValues",e=>{try{return Tt(e,{facetId:G,values:new re({each:new P({values:Zr})})}),Zs({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:Dt(t)}}}),Qd=Ks,zd=Te,A0={state:T,start:new Q({required:!0}),end:new Q({required:!0}),endInclusive:new K({required:!0})},O0={facetId:G,field:T,currentValues:new re({required:!1,each:new P({values:A0})}),generateAutomaticRanges:new K({required:!0}),filterFacetCount:new K({required:!1}),injectionDepth:new Q({required:!1,min:0}),numberOfValues:new Q({required:!1,min:1}),sortCriteria:new he({required:!1}),rangeAlgorithm:new he({required:!1})};function Xs(e){e.currentValues&&e.currentValues.forEach(({start:t,end:r})=>{if(t>r)throw new Error(`The start value is greater than the end value for the numeric range ${t} to ${r}`)})}var rn=S("numericFacet/register",e=>{try{return I(e,O0),Xs(e),{payload:e,error:null}}catch(t){return{payload:e,error:Dt(t)}}}),nn=S("numericFacet/toggleSelectValue",e=>I(e,{facetId:G,selection:new P({values:Kr})})),an=S("numericFacet/toggleExcludeValue",e=>I(e,{facetId:G,selection:new P({values:Kr})})),Mr=S("numericFacet/updateFacetValues",e=>{try{return Tt(e,{facetId:G,values:new re({each:new P({values:Kr})})}),Xs({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:Dt(t)}}}),Nd=Ks,Bd=Te,wt=W(iu(),e=>{e.addCase(ue,(t,r)=>({...t,...r.payload})).addCase(E.fulfilled,t=>{t.freezeFacetOrder=!1}).addCase(E.rejected,t=>{t.freezeFacetOrder=!1}).addCase(me.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.facetOptions)??t}).addCase(Us,(t,r)=>{t.facets[r.payload.facetId]=lr()}).addCase(Js,(t,r)=>{t.facets[r.payload.facetId]=lr()}).addCase(Xr,(t,r)=>{t.facets[r.payload.facetId]=lr()}).addCase(rn,(t,r)=>{t.facets[r.payload.facetId]=lr()}).addCase(Ut,(t,r)=>{t.facets[r.payload].enabled=!0}).addCase(He,(t,r)=>{t.facets[r.payload].enabled=!1}).addCase(Ce,(t,r)=>{[...Object.keys(r.payload.f??{}),...Object.keys(r.payload.fExcluded??{}),...Object.keys(r.payload.cf??{}),...Object.keys(r.payload.nf??{}),...Object.keys(r.payload.df??{})].forEach(n=>{n in t||(t.facets[n]=lr()),t.facets[n].enabled=!0})})});function F0(e,t){let{field:r,state:n}=e;if(!R0(e))return r;let a=`${r}_`,i=E0(a,n);return T0(r,t),`${a}${i}`}function R0(e){let{field:t,state:r}=e;return Hd(r).some(n=>n&&t in n)}function E0(e,t){let r=Hd(t).map(n=>Object.keys(n||{})).reduce((n,a)=>n.concat(a),[]);return D0(r,e)+1}function Hd(e){let{facetSet:t,numericFacetSet:r,dateFacetSet:n,categoryFacetSet:a}=e;return[t,r,n,a]}function D0(e,t){return e.map(r=>{let n=r.split(t)[1],a=parseInt(n,10);return Number.isNaN(a)?0:a}).sort().pop()??0}function T0(e,t){let r=`A facet with field "${e}" already exists.
  To avoid unexpected behaviour, configure the #id option on the facet controller.`;t.warn(r)}function ir(e,t){let{state:r,logger:n}=e,{field:a,facetId:i}=t;return i||F0({field:a,state:r},n)}var M0=["alphanumeric","occurrences"],P0=new oe({field:Wr,basePath:m0,delimitingCharacter:v0,facetId:Yr,facetSearch:Gs,filterByBasePath:S0,filterFacetCount:Gr,injectionDepth:Jr,numberOfValues:ar,sortCriteria:new x({constrainTo:M0})});function U0(e,t){j0(e);let r=ne(e),{dispatch:n}=e,a=ir(e,t.options),i={...vd,...Kc("facetSearch",t.options),field:t.options.field,facetId:a},s={facetSearch:{...Je,...t.options.facetSearch},...i};_e(e,P0,s,"buildCategoryFacet");let o=()=>ul(e.state,a),c=()=>cl(e.state,a),u=()=>jr(e.state),d=()=>Hr(e.state,a);return n(Us(i)),{...r,toggleSelect(f){let l=s.numberOfValues;n(js({facetId:a,selection:f,retrieveCount:l})),n(ue())},deselectAll(){n(ha(a)),n(ue())},sortBy(f){n(md({facetId:a,criterion:f})),n(ue())},isSortedBy(f){return o().sortCriteria===f},showMoreValues(){let{numberOfValues:f}=s,{activeValue:l,valuesAsTrees:g}=this.state,v=((l==null?void 0:l.children.length)??g.length)+f;n(Ri({facetId:a,numberOfValues:v})),n(ue())},showLessValues(){let{numberOfValues:f}=s;n(Ri({facetId:a,numberOfValues:f})),n(ue())},enable(){n(Ut(a))},disable(){n(He(a))},get state(){let f=o(),l=c(),g=u(),v=d(),p=(l==null?void 0:l.values)??[],h=p.some(N=>N.children.length>0)??!1,{parents:y,values:k}=Xv(l==null?void 0:l.values),D=ht(p),U=D.length?D[D.length-1]:void 0,_=!!U,H=(U==null?void 0:U.moreValuesAvailable)??(l==null?void 0:l.moreValuesAvailable)??!1,L=U?U.children.length>s.numberOfValues:p.length>s.numberOfValues;return{facetId:a,parents:y,selectedValueAncestry:D,values:k,isHierarchical:h,valuesAsTrees:p,activeValue:U,isLoading:g,hasActiveValues:_,canShowMoreValues:H,canShowLessValues:L,sortCriteria:f.sortCriteria,enabled:v}}}}function j0(e){return e.addReducers({categoryFacetSet:Vs,categoryFacetSearchSet:Md,facetOptions:wt,configuration:ie,search:ce}),!0}function eo(e,t){let r=e.dispatch,{options:n,getFacetSearch:a,executeFacetSearchActionCreator:i,executeFieldSuggestActionCreator:s}=t,{facetId:o}=n;return{updateText(c){r(Cr({facetId:o,query:c,numberOfValues:a().initialNumberOfValues}))},showMoreResults(){let{initialNumberOfValues:c,options:u}=a();r(Cr({facetId:o,numberOfValues:u.numberOfValues+c})),r(t.isForFieldSuggestions?s(o):i(o))},search(){r(t.isForFieldSuggestions?s(o):i(o))},clear(){r(Ws({facetId:o}))},updateCaptions(c){r(Cr({facetId:o,captions:c}))},get state(){let{response:c,isLoading:u,options:d}=a(),{query:f}=d,l=c.values;return{...c,values:l,isLoading:u,query:f}}}}function V0(e,t){let{dispatch:r}=e,n={...Je,...t.options},{facetId:a}=n,i=()=>"state"in e?e.state.categoryFacetSearchSet[a]:e[Yc].categoryFacetSearchSet[a];r(Ms(n));let s=eo(e,{options:n,getFacetSearch:i,isForFieldSuggestions:t.isForFieldSuggestions,executeFacetSearchActionCreator:t.executeFacetSearchActionCreator,executeFieldSuggestActionCreator:t.executeFieldSuggestActionCreator});return{...s,select(o){r(Ts({facetId:a,value:o})),t.select(o)},get state(){return s.state}}}function _0(e,t){let{executeFacetSearchActionCreator:r,executeFieldSuggestActionCreator:n,select:a,isForFieldSuggestions:i}=t,{dispatch:s}=e,o={...Je,...t.options},{facetId:c}=o,u=()=>e.state.categoryFacetSearchSet[c],d=V0(e,{options:{...o},executeFacetSearchActionCreator:r,executeFieldSuggestActionCreator:n,select:a,isForFieldSuggestions:i});s(Ms(o));let f=eo(e,{options:o,getFacetSearch:u,isForFieldSuggestions:t.isForFieldSuggestions,executeFacetSearchActionCreator:tt,executeFieldSuggestActionCreator:Ys});return{...f,...d,get state(){return{...f.state,...d.state}}}}function tO(e,t){L0(e);let r=U0(e,t),{dispatch:n}=e,a=()=>r.state.facetId,i=_0(e,{options:{facetId:a(),...t.options.facetSearch},executeFacetSearchActionCreator:tt,executeFieldSuggestActionCreator:Ys,select:c=>{n(ue()),n(E({legacy:nt({facetId:a(),facetValue:c.rawValue}),next:at()}))},isForFieldSuggestions:!1}),{state:s,...o}=i;return{...r,facetSearch:o,toggleSelect(c){r.toggleSelect(c),n(E({legacy:$0(a(),c),next:Q0(c)}))},deselectAll(){r.deselectAll(),n(E({legacy:vt(a()),next:St()}))},sortBy(c){r.sortBy(c),n(E({legacy:ya({facetId:a(),criterion:c}),next:ma()}))},showMoreValues(){r.showMoreValues(),n(Kt({legacy:Pd(a())}))},showLessValues(){r.showLessValues(),n(Kt({legacy:Ud(a())}))},get state(){return{...r.state,facetSearch:i.state}}}}function L0(e){return e.addReducers({categoryFacetSet:Vs,categoryFacetSearchSet:Md,configuration:ie,search:ce}),!0}function $0(e,t){let r={facetId:e,facetValue:t.value};return t.state==="selected"?Er(r):nt(r)}function Q0(e){return e.state==="selected"?Dr():at()}var z0=Intl.supportedValuesOf("currency"),N0=new x({required:!0,emptyAllowed:!1,constrainTo:z0}),Yd={url:T,referrer:tm},Wd={userId:ae,email:ae,userIp:ae,userAgent:ae};new P({options:{required:!0},values:{productId:ae,sku:ae,name:ae,price:ae,quantity:ae}});var B0={language:T,country:T,currency:N0,user:new P({values:Wd}),view:new P({options:{required:!0},values:Yd})};S("commerce/setContext",e=>I(e,B0));S("commerce/setUser",e=>z(e.userId)&&z(e.email)?{payload:e,error:Dt(new Xn("Either userId or email is required"))}:I(e,Wd));var H0=S("commerce/setView",e=>I(e,Yd)),Gd=W(th(),e=>{e.addCase(Td,(t,r)=>{let n=r.payload;Bs(t,n,ct)}).addCase(Cr,(t,r)=>{Ad(t,r.payload)}).addCase(Nt.pending,(t,r)=>{let n=r.meta.arg;Ht(t,n,r.meta.requestId)}).addCase(Bt.pending,(t,r)=>{let n=r.meta.arg;Ht(t,n,r.meta.requestId)}).addCase(tt.pending,(t,r)=>{let n=r.meta.arg;Ht(t,n,r.meta.requestId)}).addCase(Nt.rejected,(t,r)=>{let n=r.meta.arg;Yt(t,n)}).addCase(Bt.rejected,(t,r)=>{let n=r.meta.arg;Yt(t,n)}).addCase(tt.rejected,(t,r)=>{let n=r.meta.arg;Yt(t,n)}).addCase(Nt.fulfilled,(t,r)=>{Fd(t,r.payload,r.meta.requestId)}).addCase(Bt.fulfilled,(t,r)=>{Rd(t,r.payload,r.meta.requestId,ct)}).addCase(br.fulfilled,(t,r)=>{l0(t,r.payload,r.meta.requestId,ct)}).addCase(tt.fulfilled,(t,r)=>{Od(t,r.payload,r.meta.requestId)}).addCase(Ws,(t,{payload:r})=>{Hs(t,r,ct)}).addCase(E.fulfilled,t=>{xt(t,ct)}).addCase($s.fulfilled,t=>xt(t,ct)).addCase(Ns.fulfilled,t=>xt(t,ct)).addCase(H0,t=>xt(t,ct))});function ct(){return{moreValuesAvailable:!1,values:[]}}var Y0=()=>CS("analytics/productListing/load",e=>e.makeInterfaceLoad(),e=>new gs(e));S("productlisting/setUrl",e=>I(e,{url:new x({required:!0,url:!0})}));S("productlisting/setAdditionalFields",e=>I(e,{additionalFields:new re({required:!0,each:new x({required:!0,emptyAllowed:!1})})}));var Ca=B("productlisting/fetch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t(),{apiClient:s}=a,o=await s.getProducts(await W0(i));return Vt(o)?(r(Ve(o.error)),n(o.error)):{response:o.success,analyticsAction:Y0()}}),W0=async e=>{var n,a,i;let t=J0(e),r=await it(e.configuration.analytics);return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,platformUrl:e.configuration.platformUrl,url:(n=e.productListing)==null?void 0:n.url,...e.configuration.analytics.enabled&&r?{clientId:r}:{},...(a=e.productListing.additionalFields)!=null&&a.length?{additionalFields:e.productListing.additionalFields}:{},...e.productListing.advancedParameters&&G0(e.productListing.advancedParameters)?{advancedParameters:e.productListing.advancedParameters||{}}:{},...t.length&&{facets:{requests:t}},...e.pagination&&{pagination:{numberOfValues:e.pagination.numberOfResults,page:Math.ceil(e.pagination.firstResult/(e.pagination.numberOfResults||1))+1}},...(((i=e.sort)==null?void 0:i.by)||"relevance")!=="relevance"&&{sort:e.sort},...e.context&&{userContext:e.context.contextValues}}};function G0(e){return e.debug}function J0(e){return ks(K0(e),e.facetOrder??[])}function K0(e){return[...qt(e.facetSet??{}),...qt(e.numericFacetSet??{}),...qt(e.dateFacetSet??{}),...qt(e.categoryFacetSet??{})]}var to=W(Zi(),e=>{e.addCase(Js,(t,r)=>{let{facetId:n}=r.payload;n in t||(t[n]=rh(Z0(r.payload)))}).addCase(me.fulfilled,(t,r)=>{if(r.payload&&Object.keys(r.payload.facetSet).length!==0)return r.payload.facetSet}).addCase(Ce,(t,r)=>{let n=r.payload.f||{},a=r.payload.fExcluded||{};Object.keys(t).forEach(i=>{let{request:s}=t[i],o=n[i]||[],c=a[i]||[],u=o.length+c.length,d=s.currentValues.filter(f=>!o.includes(f.value)&&!c.includes(f.value));s.currentValues=[...o.map(fc),...c.map(pc),...d.map(eC)],s.preventAutoSelect=u>0,s.numberOfValues=Math.max(u,s.numberOfValues)})}).addCase(Sa,(t,r)=>{var c;let{facetId:n,selection:a}=r.payload,i=(c=t[n])==null?void 0:c.request;if(!i)return;i.preventAutoSelect=!0;let s=i.currentValues.find(u=>u.value===a.value);if(!s){hn(i,a);return}let o=s.state==="selected";s.state=o?"idle":"selected",i.freezeCurrentValues=!0}).addCase(wa,(t,r)=>{var c;let{facetId:n,selection:a}=r.payload,i=(c=t[n])==null?void 0:c.request;if(!i)return;i.preventAutoSelect=!0;let s=i.currentValues.find(u=>u.value===a.value);if(!s){hn(i,a);return}let o=s.state==="excluded";s.state=o?"idle":"excluded",i.freezeCurrentValues=!0}).addCase(Nn,(t,r)=>{var s;let{facetId:n,freezeCurrentValues:a}=r.payload,i=(s=t[n])==null?void 0:s.request;i&&(i.freezeCurrentValues=a)}).addCase(Te,(t,r)=>{var n;gn((n=t[r.payload])==null?void 0:n.request)}).addCase(Be,t=>{Object.values(t).filter(r=>r.hasBreadcrumbs).forEach(({request:r})=>gn(r))}).addCase(ca,t=>{Object.values(t).filter(r=>!r.hasBreadcrumbs).forEach(({request:r})=>gn(r))}).addCase($r,(t,r)=>Object.values(t).forEach(n=>{n.request.preventAutoSelect=!r.payload.allow})).addCase(Ld,(t,r)=>{Ps(t,r.payload)}).addCase(Ei,(t,r)=>{var i;let{facetId:n,numberOfValues:a}=r.payload;hd((i=t[n])==null?void 0:i.request,a)}).addCase(Di,(t,r)=>{var s;let{facetId:n,isFieldExpanded:a}=r.payload,i=(s=t[n])==null?void 0:s.request;i&&(i.isFieldExpanded=a)}).addCase(E.fulfilled,(t,r)=>{r.payload.response.facets.forEach(n=>{var a;return Xa((a=t[n.facetId])==null?void 0:a.request,n)})}).addCase(Ca.fulfilled,(t,r)=>{var n,a;(((a=(n=r.payload.response)==null?void 0:n.facets)==null?void 0:a.results)||[]).forEach(i=>{var s;return Xa((s=t[i.facetId])==null?void 0:s.request,i)})}).addCase(Kt.fulfilled,(t,r)=>{r.payload.response.facets.forEach(n=>{var a;return Xa((a=t[n.facetId])==null?void 0:a.request,n)})}).addCase(Ln,(t,r)=>{var d;let{facetId:n,value:a}=r.payload,i=(d=t[n])==null?void 0:d.request;if(!i)return;let{rawValue:s}=a,{currentValues:o}=i,c=o.find(f=>f.value===s);if(c){c.state="selected";return}let u=fc(s);hn(i,u),i.freezeCurrentValues=!0,i.preventAutoSelect=!0}).addCase($n,(t,r)=>{var d;let{facetId:n,value:a}=r.payload,i=(d=t[n])==null?void 0:d.request;if(!i)return;let{rawValue:s}=a,{currentValues:o}=i,c=o.find(f=>f.value===s);if(c){c.state="excluded";return}let u=pc(s);hn(i,u),i.freezeCurrentValues=!0,i.preventAutoSelect=!0}).addCase(He,(t,r)=>{if(!(r.payload in t))return;let{request:n}=t[r.payload];gn(n)})});function hn(e,t){let{currentValues:r}=e,n=r.findIndex(o=>o.state==="idle"),a=n===-1?r.length:n,i=r.slice(0,a),s=r.slice(a+1);e.currentValues=[...i,t,...s],e.numberOfValues=e.currentValues.length}function Xa(e,t){e&&(e.currentValues=t.values.map(X0),e.freezeCurrentValues=!1,e.preventAutoSelect=!1)}var Jd={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"automatic",resultsMustMatch:"atLeastOneValue"};function Z0(e){return{...Jd,type:"specific",currentValues:[],freezeCurrentValues:!1,isFieldExpanded:!1,preventAutoSelect:!1,...e}}function X0(e){let{value:t,state:r}=e;return{value:t,state:r}}function fc(e){return{value:e,state:"selected"}}function pc(e){return{value:e,state:"excluded"}}function eC(e){return{...e,state:"idle"}}var ro=e=>e.state==="selected",no=e=>e.state==="excluded",Kd=(e,t)=>{let r={facetId:e,facetValue:t.value};return ro(t)?Er(r):nt(r)},Zd=e=>ro(e)?Dr():at(),tC=(e,t)=>{let r={facetId:e,facetValue:t.value};return no(t)?Qn(r):Rr(r)},rC=e=>no(e)?y0():zn();function nC(e,t){let{dispatch:r}=e,{options:n,select:a,exclude:i,isForFieldSuggestions:s,executeFacetSearchActionCreator:o,executeFieldSuggestActionCreator:c}=t,{facetId:u}=n,d=()=>"state"in e?e.state.facetSearchSet[u]:e[Yc].facetSearchSet[u];r(Td(n));let f=eo(e,{options:n,getFacetSearch:d,isForFieldSuggestions:s,executeFacetSearchActionCreator:o,executeFieldSuggestActionCreator:c});return{...f,select(l){r(Ln({facetId:u,value:l})),a(l)},exclude(l){r($n({facetId:u,value:l})),i(l)},singleSelect(l){r(Te(u)),r(Ln({facetId:u,value:l})),a(l)},singleExclude(l){r(Te(u)),r($n({facetId:u,value:l})),i(l)},get state(){let{values:l}=f.state;return{...f.state,values:l.map(({count:g,displayValue:v,rawValue:p})=>({count:g,displayValue:v,rawValue:p}))}}}}var Xd={facetId:G,selection:new P({values:va})},aC=B("facet/executeToggleSelect",({facetId:e,selection:t},r)=>{let{dispatch:n,extra:{validatePayload:a}}=r;a({facetId:e,selection:t},Xd),n(Sa({facetId:e,selection:t})),n(ue())}),iC=B("facet/executeToggleExclude",({facetId:e,selection:t},r)=>{let{dispatch:n,extra:{validatePayload:a}}=r;a({facetId:e,selection:t},Xd),n(wa({facetId:e,selection:t})),n(ue())}),ao=["allValues","atLeastOneValue"],ef=["score","alphanumeric","alphanumericDescending","occurrences","automatic"],sC=new oe({facetId:Yr,field:Wr,filterFacetCount:Gr,injectionDepth:Jr,numberOfValues:ar,sortCriteria:new x({constrainTo:ef}),resultsMustMatch:new x({constrainTo:ao}),facetSearch:Gs});function oC(e,t,r=sC){cC(e);let{dispatch:n}=e,a=ne(e),i=ir(e,t.options),s={...Jd,...Kc("facetSearch",t.options),field:t.options.field,facetId:i},o={facetSearch:{...Je,...t.options.facetSearch},...s};_e(e,r,o,"buildFacet");let c=()=>Jv(e.state,i),u=()=>ol(e.state,i),d=()=>jr(e.state),f=()=>Hr(e.state,i),l=()=>{let{currentValues:v}=c();return v.filter(p=>p.state!=="idle").length},g=()=>{let{currentValues:v}=c(),p=o.numberOfValues,h=!!v.find(y=>y.state==="idle");return p<v.length&&h};return n(Js(s)),{...a,toggleSelect:v=>n(aC({facetId:o.facetId,selection:v})),toggleExclude:v=>n(iC({facetId:o.facetId,selection:v})),toggleSingleSelect:function(v){v.state==="idle"&&n(Te(i)),this.toggleSelect(v)},toggleSingleExclude:function(v){v.state==="idle"&&n(Te(i)),this.toggleExclude(v)},isValueSelected:ro,isValueExcluded:no,deselectAll(){n(Te(i)),n(ue())},sortBy(v){n(Ld({facetId:i,criterion:v})),n(ue())},isSortedBy(v){return this.state.sortCriterion===v},showMoreValues(){let v=c().numberOfValues,p=o.numberOfValues,h=p-v%p,y=v+h;n(Ei({facetId:i,numberOfValues:y})),n(Di({facetId:i,isFieldExpanded:!0})),n(ue())},showLessValues(){let v=o.numberOfValues,p=Math.max(v,l());n(Ei({facetId:i,numberOfValues:p})),n(Di({facetId:i,isFieldExpanded:!1})),n(ue())},enable(){n(Ut(i))},disable(){n(He(i))},get state(){let v=c(),p=u(),h=d(),y=f(),k;typeof v.sortCriteria=="object"?k=v.sortCriteria.order==="descending"?"alphanumericDescending":"alphanumeric":k=v.sortCriteria;let D=p?p.values:[],U=D.some(L=>L.state!=="idle"),_=p?p.moreValuesAvailable:!1,H=v.resultsMustMatch;return{label:p==null?void 0:p.label,facetId:i,values:D,sortCriterion:k,resultsMustMatch:H,isLoading:h,hasActiveValues:U,canShowMoreValues:_,canShowLessValues:g(),enabled:y}}}}function cC(e){return e.addReducers({facetSet:to,facetOptions:wt,configuration:ie,facetSearchSet:Gd}),!0}var uC=new oe({facetId:Yr,field:Wr,filterFacetCount:Gr,injectionDepth:Jr,numberOfValues:ar,sortCriteria:new x({constrainTo:ef}),resultsMustMatch:new x({constrainTo:ao}),facetSearch:Gs,allowedValues:Vd,hasBreadcrumbs:I0,customSort:_d});function rO(e,t){lC(e);let{dispatch:r}=e,n=oC(e,{...t,options:{...t.options,...t.options.allowedValues&&{allowedValues:{type:"simple",values:t.options.allowedValues}}}},uC),a=()=>n.state.facetId,i=(()=>{let{facetSearch:c}=t.options;return nC(e,{options:{facetId:a(),...c},select:u=>{r(ue()),r(E({legacy:nt({facetId:a(),facetValue:u.rawValue}),next:at()}))},exclude:u=>{r(ue()),r(E({legacy:Rr({facetId:a(),facetValue:u.rawValue}),next:zn()}))},isForFieldSuggestions:!1,executeFacetSearchActionCreator:tt,executeFieldSuggestActionCreator:Ys})})(),{state:s,...o}=i;return{...n,facetSearch:o,toggleSelect(c){n.toggleSelect(c),r(E({legacy:Kd(a(),c),next:Zd(c)}))},toggleExclude(c){n.toggleExclude(c),r(E({legacy:tC(a(),c),next:rC(c)}))},deselectAll(){n.deselectAll(),r(E({legacy:vt(a()),next:St()}))},sortBy(c){n.sortBy(c),r(E({legacy:ya({facetId:a(),criterion:c}),next:ma()}))},isSortedBy(c){return this.state.sortCriterion===c},showMoreValues(){n.showMoreValues(),r(Kt({legacy:Pd(a())}))},showLessValues(){n.showLessValues(),r(Kt({legacy:Ud(a())}))},get state(){return{...n.state,facetSearch:i.state}}}}function lC(e){return e.addReducers({facetSet:to,configuration:ie,facetSearchSet:Gd,search:ce}),!0}var io=e=>e.state==="selected",tf=e=>e.state==="excluded",rf=(e,t)=>{let r=`${t.start}..${t.end}`,n={facetId:e,facetValue:r};return io(t)?Er(n):nt(n)},nf=e=>io(e)?Dr():at(),dC=(e,t)=>{let r=`${t.start}..${t.end}`,n={facetId:e,facetValue:r};return tf(t)?Qn(n):Rr(n)},af=S("rangeFacet/executeToggleSelect",e=>I(e,ba(e.selection))),sf=S("rangeFacet/executeToggleExclude",e=>I(e,ba(e.selection))),of={facetId:G,selection:new P({values:Zr})},fC=B("dateFacet/executeToggleSelect",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,of),t(en(e)),t(af(e)),t(ue())}),pC=B("dateFacet/executeToggleExclude",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,of),t(tn(e)),t(sf(e)),t(ue())}),cf={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"ascending",rangeAlgorithm:"even",resultsMustMatch:"atLeastOneValue"};function uf(e,t){let{request:r}=t,{facetId:n}=r;if(n in e)return;let a=gf(r);r.numberOfValues=a,e[n]=t}function lf(e,t,r){var a;let n=(a=e[t])==null?void 0:a.request;n&&(n.currentValues=r,n.numberOfValues=gf(n))}function df(e,t,r){var s;let n=(s=e[t])==null?void 0:s.request;if(!n)return;let a=Hn(n.currentValues,r);if(!a)return;let i=a.state==="selected";a.state=i?"idle":"selected",n.preventAutoSelect=!0}function ff(e,t,r){var s;let n=(s=e[t])==null?void 0:s.request;if(!n)return;let a=Hn(n.currentValues,r);if(!a)return;let i=a.state==="excluded";a.state=i?"idle":"excluded",n.preventAutoSelect=!0}function Wt(e,t){var n;let r=(n=e[t])==null?void 0:n.request;r&&r.currentValues.forEach(a=>a.state="idle")}function pf(e,t){Object.entries(e).forEach(([r,{request:n}])=>{let a=t[r]||[];n.currentValues.forEach(o=>{let c=!!Hn(a,o);return o.state=c?"selected":"idle",o});let i=a.filter(o=>!Hn(n.currentValues,o)),s=n.currentValues;s.push(...i),n.numberOfValues=Math.max(n.numberOfValues,s.length)})}function Bn(e,t,r){t.forEach(n=>{var o;let a=n.facetId,i=(o=e[a])==null?void 0:o.request;if(!i)return;let s=r(n.values);i.currentValues=s,i.preventAutoSelect=!1})}function Hn(e,t){let{start:r,end:n}=t;return e.find(a=>a.start===r&&a.end===n)}function gf(e){let{generateAutomaticRanges:t,currentValues:r,numberOfValues:n}=e;return t?Math.max(n,r.length):r.length}var sn=W(Xi(),e=>{e.addCase(Xr,(t,r)=>{let{payload:n}=r,a=gC(n);uf(t,nh(a))}).addCase(me.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.dateFacetSet)??t}).addCase(Ce,(t,r)=>{let n=r.payload.df||{};pf(t,n)}).addCase(en,(t,r)=>{let{facetId:n,selection:a}=r.payload;df(t,n,a)}).addCase(tn,(t,r)=>{let{facetId:n,selection:a}=r.payload;ff(t,n,a)}).addCase(Tr,(t,r)=>{let{facetId:n,values:a}=r.payload;lf(t,n,a)}).addCase(zd,(t,r)=>{Wt(t,r.payload)}).addCase(Be,t=>{Object.keys(t).forEach(r=>{Wt(t,r)})}).addCase(Qd,(t,r)=>{Ps(t,r.payload)}).addCase(E.fulfilled,(t,r)=>{let n=r.payload.response.facets;Bn(t,n,gc)}).addCase(Ca.fulfilled,(t,r)=>{var a,i;let n=((i=(a=r.payload.response)==null?void 0:a.facets)==null?void 0:i.results)||[];Bn(t,n,gc)}).addCase(He,(t,r)=>{Wt(t,r.payload)})});function gC(e){return{...cf,currentValues:[],preventAutoSelect:!1,type:"dateRange",...e}}function gc(e){return e.map(t=>{let{numberOfResults:r,...n}=t;return n})}function hf(e,t){let{facetId:r,getRequest:n}=t,a=ne(e),i=e.dispatch,s=()=>Hr(e.state,r);return{...a,isValueSelected:io,isValueExcluded:tf,deselectAll(){i(Te(r)),i(ue())},sortBy(o){i(Ks({facetId:r,criterion:o})),i(ue())},isSortedBy(o){return this.state.sortCriterion===o},enable(){i(Ut(r))},disable(){i(He(r))},get state(){let o=n(),c=Ur(e.state,r),u=o.sortCriteria,d=o.resultsMustMatch,f=c?c.values:[],l=jr(e.state),g=s(),v=f.some(p=>p.state!=="idle");return{facetId:r,values:f,sortCriterion:u,resultsMustMatch:d,hasActiveValues:v,isLoading:l,enabled:g}}}}function yf(e,t){if(!e.generateAutomaticRanges&&e.currentValues===void 0){let r=`currentValues should be specified for ${t} when generateAutomaticRanges is false.`;throw new Error(r)}}var mf=["idle","selected","excluded"],vf=["ascending","descending"],Sf=["even","equiprobable"],hC={start:new x,end:new x,endInclusive:new K,state:new x({constrainTo:mf})},yC=new oe({facetId:Yr,field:Wr,generateAutomaticRanges:jd,filterFacetCount:Gr,injectionDepth:Jr,numberOfValues:ar,currentValues:new re({each:new P({values:hC})}),sortCriteria:new x({constrainTo:vf}),rangeAlgorithm:new x({constrainTo:Sf})});function wf(e,t){_e(e,yC,t,"buildDateFacet"),Zs(t)}function mC(e,t){vC(e),yf(t.options,"buildDateFacet");let r=e.dispatch,n=ir(e,t.options),a={currentValues:[],...t.options,facetId:n};wf(e,a),r(Xr(a));let i=hf(e,{facetId:n,getRequest:()=>e.state.dateFacetSet[n].request});return{...i,toggleSelect:s=>r(fC({facetId:n,selection:s})),toggleSingleSelect:function(s){s.state==="idle"&&r(Te(n)),this.toggleSelect(s)},toggleExclude:s=>r(pC({facetId:n,selection:s})),toggleSingleExclude:function(s){s.state==="idle"&&r(Te(n)),this.toggleExclude(s)},get state(){return i.state}}}function vC(e){return e.addReducers({configuration:ie,search:ce,dateFacetSet:sn,facetOptions:wt}),!0}function nO(e,t){let r=mC(e,t),n=e.dispatch,a=()=>r.state.facetId;return{...r,deselectAll(){r.deselectAll(),n(E({legacy:vt(a()),next:St()}))},sortBy(i){r.sortBy(i),n(E({legacy:ya({facetId:a(),criterion:i}),next:ma()}))},toggleSelect:i=>{r.toggleSelect(i),n(E({legacy:rf(a(),i),next:nf(i)}))},toggleExclude:i=>{r.toggleExclude(i),n(E({legacy:dC(a(),i)}))},get state(){return r.state}}}var sr=W(es(),e=>{e.addCase(rn,(t,r)=>{let{payload:n}=r,a=SC(n);uf(t,ah(a))}).addCase(me.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.numericFacetSet)??t}).addCase(Ce,(t,r)=>{let n=r.payload.nf||{};pf(t,n)}).addCase(nn,(t,r)=>{let{facetId:n,selection:a}=r.payload;df(t,n,a)}).addCase(an,(t,r)=>{let{facetId:n,selection:a}=r.payload;ff(t,n,a)}).addCase(Mr,(t,r)=>{let{facetId:n,values:a}=r.payload;lf(t,n,a)}).addCase(Bd,(t,r)=>{Wt(t,r.payload)}).addCase(Be,t=>{Object.keys(t).forEach(r=>{Wt(t,r)})}).addCase(Nd,(t,r)=>{Ps(t,r.payload)}).addCase(E.fulfilled,(t,r)=>{let n=r.payload.response.facets;Bn(t,n,hc)}).addCase(Ca.fulfilled,(t,r)=>{var a,i;let n=((i=(a=r.payload.response)==null?void 0:a.facets)==null?void 0:i.results)||[];Bn(t,n,hc)}).addCase(He,(t,r)=>{Wt(t,r.payload)})});function SC(e){return{...cf,currentValues:[],preventAutoSelect:!1,type:"numericalRange",...e}}function hc(e){return e.map(t=>{let{numberOfResults:r,...n}=t;return n})}var bf={facetId:G,selection:new P({values:Kr})},wC=B("numericFacet/executeToggleSelect",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,bf),t(nn(e)),t(af(e)),t(ue())});B("numericFacet/executeToggleExclude",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,bf),t(an(e)),t(sf(e)),t(ue())});var bC={start:new Q,end:new Q,endInclusive:new K,state:new x({constrainTo:mf})},CC=new oe({facetId:Yr,field:Wr,generateAutomaticRanges:jd,filterFacetCount:Gr,injectionDepth:Jr,numberOfValues:ar,currentValues:new re({each:new P({values:bC})}),sortCriteria:new x({constrainTo:vf}),resultsMustMatch:new x({constrainTo:ao}),rangeAlgorithm:new x({constrainTo:Sf})});function Cf(e,t){_e(e,CC,t,"buildNumericFacet"),Xs(t)}function IC(e){return{endInclusive:!1,state:"idle",...e}}function kC(e,t){qC(e),yf(t.options,"buildNumericFacet");let r=e.dispatch,n=ir(e,t.options),a={currentValues:[],...t.options,facetId:n};Cf(e,a),r(rn(a));let i=hf(e,{facetId:n,getRequest:()=>e.state.numericFacetSet[n].request});return{...i,toggleSelect:s=>r(wC({facetId:n,selection:s})),toggleSingleSelect(s){s.state==="idle"&&r(Te(n)),this.toggleSelect(s)},get state(){return i.state}}}function qC(e){return e.addReducers({numericFacetSet:sr,facetOptions:wt,configuration:ie,search:ce}),!0}function aO(e,t){xC(e);let r=kC(e,t),n=e.dispatch,a=()=>r.state.facetId;return{...r,deselectAll(){r.deselectAll(),n(E({legacy:vt(a()),next:St()}))},sortBy(i){r.sortBy(i),n(E({legacy:ya({facetId:a(),criterion:i}),next:ma()}))},toggleSelect:i=>{r.toggleSelect(i),n(E({legacy:rf(a(),i),next:nf(i)}))},get state(){return{...r.state}}}}function xC(e){return e.addReducers({numericFacetSet:sr,configuration:ie,search:ce}),!0}function AC(e,t){return!!t&&t.facetId in e.numericFacetSet}var If=(e,t)=>{let r=Ur(e,t);if(AC(e,r))return r},OC=(e,t)=>(If(e,t)||{values:[]}).values.filter(r=>r.state!=="idle"),FC=(e,t)=>(If(e,t)||{values:[]}).values.filter(r=>r.state==="selected");function RC(e,t){var c;EC(e);let r=ne(e),{dispatch:n}=e,a=()=>e.state,i=ir(e,t.options),s={...t.options,currentValues:(c=t.initialState)!=null&&c.range?[{...t.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:i};Cf(e,s),n(rn(s));let o=()=>Hr(e.state,i);return{...r,clear:()=>{n(Mr({facetId:i,values:[]})),n(ue())},setRange:u=>{let d={...u,state:"selected",numberOfResults:0,endInclusive:!0},f=Mr({facetId:i,values:[d]});return f.error?!1:(n(f),n(ue()),!0)},enable(){n(Ut(i))},disable(){n(He(i))},get state(){let u=jr(a()),d=o(),f=FC(a(),i),l=f.length?f[0]:void 0;return{facetId:i,isLoading:u,range:l,enabled:d}}}}function EC(e){return e.addReducers({numericFacetSet:sr,facetOptions:wt,configuration:ie,search:ce}),!0}function iO(e,t){DC(e);let r=RC(e,t),{dispatch:n}=e,a=()=>r.state.facetId;return{...r,clear:()=>{r.clear(),n(E({legacy:vt(a()),next:St()}))},setRange:i=>{let s=r.setRange(i);return s&&n(E({legacy:nt({facetId:a(),facetValue:`${i.start}..${i.end}`}),next:at()})),s},get state(){return{...r.state}}}}function DC(e){return e.addReducers({numericFacetSet:sr,configuration:ie,search:ce}),!0}function TC(e,t){return!!t&&t.facetId in e.dateFacetSet}var kf=(e,t)=>{let r=Ur(e,t);if(TC(e,r))return r},MC=(e,t)=>(kf(e,t)||{values:[]}).values.filter(r=>r.state==="selected"),PC=(e,t)=>(kf(e,t)||{values:[]}).values.filter(r=>r.state!=="idle");function UC(e,t){var c;jC(e);let r=ne(e),{dispatch:n}=e,a=()=>e.state,i=ir(e,t.options),s={...t.options,currentValues:(c=t.initialState)!=null&&c.range?[{...t.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:i};wf(e,s),n(Xr(s));let o=()=>Hr(e.state,i);return{...r,clear:()=>{n(Tr({facetId:i,values:[]})),n(ue())},setRange:u=>{let d={...u,state:"selected",numberOfResults:0,endInclusive:!0},f=Tr({facetId:i,values:[d]});return f.error?!1:(n(f),n(ue()),!0)},enable(){n(Ut(i))},disable(){n(He(i))},get state(){let u=jr(a()),d=o(),f=MC(a(),i),l=f.length?f[0]:void 0;return{facetId:i,isLoading:u,range:l,enabled:d}}}}function jC(e){return e.addReducers({dateFacetSet:sn,facetOptions:wt,configuration:ie,search:ce}),!0}function sO(e,t){VC(e);let r=UC(e,t),{dispatch:n}=e,a=()=>r.state.facetId;return{...r,clear:()=>{r.clear(),n(E({legacy:vt(a()),next:St()}))},setRange:i=>{let s=r.setRange(i);return s&&n(E({legacy:nt({facetId:a(),facetValue:`${i.start}..${i.end}`}),next:at()})),s},get state(){return{...r.state}}}}function VC(e){return e.addReducers({dateFacetSet:sn,configuration:ie,search:ce}),!0}var _C=W(su(),e=>{e.addCase(E.fulfilled,ei).addCase($s.fulfilled,ei).addCase(Ns.fulfilled,ei).addCase(me.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.facetOrder)??t})});function ei(e,t){return t.payload.response.facets.map(r=>r.facetId)}var LC=()=>R("history/analytics/forward",e=>e.makeSearchEvent("historyForward")),$C=()=>R("history/analytics/backward",e=>e.makeSearchEvent("historyBackward")),QC=()=>R("history/analytics/noresultsback",e=>e.makeNoResultsBack()),zC=()=>({actionCause:"historyForward"}),NC=()=>({actionCause:"historyBackward"}),BC=()=>({actionCause:"noResultsBack"}),HC=Object.getOwnPropertyNames,YC=Object.getOwnPropertySymbols,WC=Object.prototype.hasOwnProperty;function yc(e,t){return function(r,n,a){return e(r,n,a)&&t(r,n,a)}}function yn(e){return function(t,r,n){if(!t||!r||typeof t!="object"||typeof r!="object")return e(t,r,n);var a=n.cache,i=a.get(t),s=a.get(r);if(i&&s)return i===r&&s===t;a.set(t,r),a.set(r,t);var o=e(t,r,n);return a.delete(t),a.delete(r),o}}function mc(e){return HC(e).concat(YC(e))}var qf=Object.hasOwn||function(e,t){return WC.call(e,t)};function or(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var xf="_owner",vc=Object.getOwnPropertyDescriptor,Sc=Object.keys;function GC(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function JC(e,t){return or(e.getTime(),t.getTime())}function wc(e,t,r){if(e.size!==t.size)return!1;for(var n={},a=e.entries(),i=0,s,o;(s=a.next())&&!s.done;){for(var c=t.entries(),u=!1,d=0;(o=c.next())&&!o.done;){var f=s.value,l=f[0],g=f[1],v=o.value,p=v[0],h=v[1];!u&&!n[d]&&(u=r.equals(l,p,i,d,e,t,r)&&r.equals(g,h,l,p,e,t,r))&&(n[d]=!0),d++}if(!u)return!1;i++}return!0}function KC(e,t,r){var n=Sc(e),a=n.length;if(Sc(t).length!==a)return!1;for(var i;a-- >0;)if(i=n[a],i===xf&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!qf(t,i)||!r.equals(e[i],t[i],i,i,e,t,r))return!1;return!0}function pr(e,t,r){var n=mc(e),a=n.length;if(mc(t).length!==a)return!1;for(var i,s,o;a-- >0;)if(i=n[a],i===xf&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!qf(t,i)||!r.equals(e[i],t[i],i,i,e,t,r)||(s=vc(e,i),o=vc(t,i),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function ZC(e,t){return or(e.valueOf(),t.valueOf())}function XC(e,t){return e.source===t.source&&e.flags===t.flags}function bc(e,t,r){if(e.size!==t.size)return!1;for(var n={},a=e.values(),i,s;(i=a.next())&&!i.done;){for(var o=t.values(),c=!1,u=0;(s=o.next())&&!s.done;)!c&&!n[u]&&(c=r.equals(i.value,s.value,i.value,s.value,e,t,r))&&(n[u]=!0),u++;if(!c)return!1}return!0}function eI(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}var tI="[object Arguments]",rI="[object Boolean]",nI="[object Date]",aI="[object Map]",iI="[object Number]",sI="[object Object]",oI="[object RegExp]",cI="[object Set]",uI="[object String]",lI=Array.isArray,Cc=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Ic=Object.assign,dI=Object.prototype.toString.call.bind(Object.prototype.toString);function fI(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areMapsEqual,a=e.areObjectsEqual,i=e.arePrimitiveWrappersEqual,s=e.areRegExpsEqual,o=e.areSetsEqual,c=e.areTypedArraysEqual;return function(u,d,f){if(u===d)return!0;if(u==null||d==null||typeof u!="object"||typeof d!="object")return u!==u&&d!==d;var l=u.constructor;if(l!==d.constructor)return!1;if(l===Object)return a(u,d,f);if(lI(u))return t(u,d,f);if(Cc!=null&&Cc(u))return c(u,d,f);if(l===Date)return r(u,d,f);if(l===RegExp)return s(u,d,f);if(l===Map)return n(u,d,f);if(l===Set)return o(u,d,f);var g=dI(u);return g===nI?r(u,d,f):g===oI?s(u,d,f):g===aI?n(u,d,f):g===cI?o(u,d,f):g===sI?typeof u.then!="function"&&typeof d.then!="function"&&a(u,d,f):g===tI?a(u,d,f):g===rI||g===iI||g===uI?i(u,d,f):!1}}function pI(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?pr:GC,areDatesEqual:JC,areMapsEqual:n?yc(wc,pr):wc,areObjectsEqual:n?pr:KC,arePrimitiveWrappersEqual:ZC,areRegExpsEqual:XC,areSetsEqual:n?yc(bc,pr):bc,areTypedArraysEqual:n?pr:eI};if(r&&(a=Ic({},a,r(a))),t){var i=yn(a.areArraysEqual),s=yn(a.areMapsEqual),o=yn(a.areObjectsEqual),c=yn(a.areSetsEqual);a=Ic({},a,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:o,areSetsEqual:c})}return a}function gI(e){return function(t,r,n,a,i,s,o){return e(t,r,o)}}function hI(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(o,c){var u=n(),d=u.cache,f=d===void 0?t?new WeakMap:void 0:d,l=u.meta;return r(o,c,{cache:f,equals:a,meta:l,strict:i})};if(t)return function(o,c){return r(o,c,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var s={cache:void 0,equals:a,meta:void 0,strict:i};return function(o,c){return r(o,c,s)}}st();st({strict:!0});st({circular:!0});st({circular:!0,strict:!0});st({createInternalComparator:function(){return or}});st({strict:!0,createInternalComparator:function(){return or}});st({circular:!0,createInternalComparator:function(){return or}});st({circular:!0,createInternalComparator:function(){return or},strict:!0});function st(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,i=e.strict,s=i===void 0?!1:i,o=pI(e),c=fI(o),u=n?n(c):gI(c);return hI({circular:r,comparator:c,createState:a,equals:u,strict:s})}function Af(e,t,r=(n,a)=>n===a){return e.length===t.length&&e.findIndex((n,a)=>!r(t[a],n))===-1}function yI(e,t){return e.length!==t.length?!1:e.every(r=>t.findIndex(n=>so(r,n))!==-1)}var so=st({createCustomConfig:e=>({...e,areArraysEqual:yI})}),mI=W(mh(),e=>{e.addCase(We,(t,r)=>vI(t,r.payload)?void 0:r.payload)}),vI=(e,t)=>SI(e.context,t.context)&&wI(e.dictionaryFieldContext,t.dictionaryFieldContext)&&AI(e.advancedSearchQueries,t.advancedSearchQueries)&&bI(e.tabSet,t.tabSet)&&CI(e.staticFilterSet,t.staticFilterSet)&&ti(e.facetSet,t.facetSet)&&ti(e.dateFacetSet,t.dateFacetSet)&&ti(e.numericFacetSet,t.numericFacetSet)&&kI(e.automaticFacetSet,t.automaticFacetSet)&&II(e.categoryFacetSet,t.categoryFacetSet)&&qI(e.pagination,t.pagination)&&xI(e.query,t.query)&&OI(e,t)&&FI(e.pipeline,t.pipeline)&&RI(e.searchHub,t.searchHub)&&EI(e.facetOrder,t.facetOrder)&&DI(e.debug,t.debug),SI=(e,t)=>JSON.stringify(e.contextValues)===JSON.stringify(t.contextValues),wI=(e,t)=>JSON.stringify(e.contextValues)===JSON.stringify(t.contextValues),bI=(e,t)=>{let r=kc(e),n=kc(t);return(r==null?void 0:r.id)===(n==null?void 0:n.id)},kc=e=>Object.values(e).find(t=>t.isActive),CI=(e,t)=>{for(let[r,n]of Object.entries(t)){if(!e[r])return!1;let a=qc(e[r]),i=qc(n);if(JSON.stringify(a)!==JSON.stringify(i))return!1}return!0},qc=e=>e.values.filter(t=>t.state!=="idle"),ti=(e,t)=>{for(let[r,n]of Object.entries(t)){if(!e[r])return!1;let a=e[r].request.currentValues.filter(s=>s.state!=="idle"),i=n.request.currentValues.filter(s=>s.state!=="idle");if(JSON.stringify(a)!==JSON.stringify(i))return!1}return!0},II=(e,t)=>{var r;for(let[n,a]of Object.entries(t)){if(!e[n])return!1;let i=ht((r=e[n])==null?void 0:r.request.currentValues).map(({value:o})=>o),s=ht(a==null?void 0:a.request.currentValues).map(({value:o})=>o);if(JSON.stringify(i)!==JSON.stringify(s))return!1}return!0},kI=(e,t)=>{for(let[r,n]of Object.entries(t.set)){if(!e.set[r])return!1;let a=e.set[r].response.values.filter(s=>s.state!=="idle"),i=n.response.values.filter(s=>s.state!=="idle");if(JSON.stringify(a)!==JSON.stringify(i))return!1}return!0},qI=(e,t)=>e.firstResult===t.firstResult&&e.numberOfResults===t.numberOfResults,xI=(e,t)=>JSON.stringify(e)===JSON.stringify(t),AI=(e,t)=>JSON.stringify(e)===JSON.stringify(t),OI=(e,t)=>e.sortCriteria===t.sortCriteria,FI=(e,t)=>e===t,RI=(e,t)=>e===t,EI=(e,t)=>Af(e,t),DI=(e,t)=>e===t,TI=Tg({actionTypes:{redo:ql.type,undo:kl.type,snapshot:We.type},reducer:mI});function oO(e){MI(e);let t=ne(e),{dispatch:r}=e,n=()=>e.state,a=i=>i.past.length>0&&!z(i.present);return{...t,subscribe(i){i();let s=JSON.stringify(n().history.present),o=()=>{let c=JSON.stringify(n().history.present);s!==c&&(s=c,i())};return e.subscribe(()=>o())},get state(){return n().history},async back(){a(this.state)&&(await r(tc()),r(E({legacy:$C(),next:NC()})))},async forward(){!this.state.future.length||!this.state.present||(await r(QS()),r(E({legacy:LC(),next:zC()})))},async backOnNoResults(){a(this.state)&&(await r(tc()),r(E({legacy:QC(),next:BC()})))}}}function MI(e){return e.addReducers({history:TI,configuration:ie,facetOrder:_C}),!0}var PI=new Q({min:1,default:8,required:!1}),UI=new Q({min:1,max:20,default:5,required:!1}),jI={desiredCount:UI,numberOfValues:PI},Of=S("automaticFacet/setOptions",e=>I(e,jI)),Ff=S("automaticFacet/deselectAll",e=>I(e,G)),VI=T,Ia=S("automaticFacet/toggleSelectValue",e=>I(e,{field:VI,selection:new P({values:va})})),ka=W(Ot(),e=>{e.addCase(Tl,(t,r)=>{let n=ri(t),a=r.payload;t.defaultNumberOfResults=t.numberOfResults=a,t.firstResult=gr(n,a)}).addCase(Ml,(t,r)=>{t.numberOfResults=r.payload,t.firstResult=0}).addCase(Fr,t=>{t.firstResult=0}).addCase(Pl,(t,r)=>{let n=r.payload;t.firstResult=gr(n,t.numberOfResults)}).addCase(tr,(t,r)=>{let n=r.payload;t.firstResult=gr(n,t.numberOfResults)}).addCase(jl,t=>{let r=ri(t),n=Math.max(r-1,1);t.firstResult=gr(n,t.numberOfResults)}).addCase(Ul,t=>{let r=ri(t),n=_I(t),a=Math.min(r+1,n);t.firstResult=gr(a,t.numberOfResults)}).addCase(me.fulfilled,(t,r)=>{r.payload&&(t.numberOfResults=r.payload.pagination.numberOfResults,t.firstResult=r.payload.pagination.firstResult)}).addCase(Ce,(t,r)=>{t.firstResult=r.payload.firstResult??t.firstResult,t.numberOfResults=r.payload.numberOfResults??t.defaultNumberOfResults}).addCase(E.fulfilled,(t,r)=>{let{response:n}=r.payload;t.totalCountFiltered=n.totalCountFiltered}).addCase(Ca.fulfilled,(t,r)=>{let{response:n}=r.payload;t.totalCountFiltered=n.pagination.totalCount}).addCase(Te,t=>{ke(t)}).addCase(tn,t=>{ke(t)}).addCase(wa,t=>{ke(t)}).addCase(an,t=>{ke(t)}).addCase($n,t=>{ke(t)}).addCase(Sa,t=>{ke(t)}).addCase(ha,t=>{ke(t)}).addCase(js,t=>{ke(t)}).addCase(Ts,t=>{ke(t)}).addCase(en,t=>{ke(t)}).addCase(nn,t=>{ke(t)}).addCase(Be,t=>{ke(t)}).addCase(Tr,t=>{ke(t)}).addCase(Mr,t=>{ke(t)}).addCase(Ln,t=>{ke(t)}).addCase(Ia,t=>{ke(t)})});function ke(e){e.firstResult=Ot().firstResult}function ri(e){let{firstResult:t,numberOfResults:r}=e;return Rf(t,r)}function _I(e){let{totalCountFiltered:t,numberOfResults:r}=e;return Ef(t,r)}function gr(e,t){return(e-1)*t}function Rf(e,t){return Math.round(e/t)+1}function Ef(e,t){let r=Math.min(e,5e3);return Math.ceil(r/t)}function LI(e){return e.pagination.firstResult}function Df(e){return e.pagination.numberOfResults}function $I(e){return e.pagination.totalCountFiltered}var on=e=>{let t=LI(e),r=Df(e);return Rf(t,r)},Tf=e=>{let t=$I(e),r=Df(e);return Ef(t,r)},QI=(e,t)=>{let r=on(e),n=Tf(e),a=zI(r,t);return a=NI(a),a=BI(a,n),HI(a)};function zI(e,t){let r=t%2===0,n=Math.floor(t/2),a=r?n-1:n,i=e-n,s=e+a;return{start:i,end:s}}function NI(e){let t=Math.max(1-e.start,0),r=e.start+t,n=e.end+t;return{start:r,end:n}}function BI(e,t){let r=Math.max(e.end-t,0),n=Math.max(e.start-r,1),a=e.end-r;return{start:n,end:a}}function HI(e){let t=[];for(let r=e.start;r<=e.end;++r)t.push(r);return t}var Mf=()=>R("analytics/pager/resize",(e,t)=>{var r;return e.makePagerResize({currentResultsPerPage:((r=t.pagination)==null?void 0:r.numberOfResults)||Ot().numberOfResults})}),Pf=()=>R("analytics/pager/number",(e,t)=>e.makePagerNumber({pagerNumber:on(t)})),YI=()=>R("analytics/pager/next",(e,t)=>e.makePagerNext({pagerNumber:on(t)})),WI=()=>R("analytics/pager/previous",(e,t)=>e.makePagerPrevious({pagerNumber:on(t)})),GI=new oe({numberOfPages:new Q({default:5,min:0})}),JI=new oe({page:new Q({min:1})});function KI(e,t={}){ZI(e);let r=ne(e),{dispatch:n}=e,a=_e(e,GI,t.options,"buildPager"),i=Mt(e,JI,t.initialState,"buildPager").page;i&&n(Pl(i));let s=()=>on(e.state),o=()=>{let{numberOfPages:u}=a;return QI(e.state,u)},c=()=>Tf(e.state);return{...r,get state(){let u=s(),d=c(),f=u>1&&d>0,l=u<d;return{currentPage:u,currentPages:o(),maxPage:d,hasPreviousPage:f,hasNextPage:l}},selectPage(u){n(tr(u))},nextPage(){n(Ul())},previousPage(){n(jl())},isCurrentPage(u){return u===this.state.currentPage}}}function ZI(e){return e.addReducers({configuration:ie,pagination:ka}),!0}function cO(e,t={}){let{dispatch:r}=e,n=KI(e,t);return{...n,get state(){return n.state},selectPage(a){n.selectPage(a),r(zt({legacy:Pf()}))},nextPage(){n.nextPage(),r(zt({legacy:YI()}))},previousPage(){n.previousPage(),r(zt({legacy:WI()}))}}}function XI(e){ek(e);let t=ne(e),r=()=>e.state;return{...t,get state(){return{hasError:r().search.error!==null,error:r().search.error}}}}function ek(e){return e.addReducers({search:ce}),!0}function uO(e){return XI(e)}function oo(e){tk(e);let t=ne(e),r=()=>e.state;return{...t,get state(){let n=r();return{hasError:n.search.error!==null,isLoading:n.search.isLoading,hasResults:!!n.search.results.length,firstSearchExecuted:Oi(n)}}}}function tk(e){return e.addReducers({search:ce}),!0}function rk(e){nk(e);let t=ne(e),r=oo(e),n=()=>e.state,a=()=>{let i=n().search.duration/1e3;return Math.round((i+Number.EPSILON)*100)/100};return{...t,get state(){return{...r.state,durationInMilliseconds:n().search.duration,durationInSeconds:a(),firstResult:n().pagination.firstResult+1,hasDuration:n().search.duration!==0,hasQuery:n().search.queryExecuted!=="",lastResult:n().pagination.firstResult+n().search.results.length,query:n().search.queryExecuted,total:n().pagination.totalCountFiltered}}}}function nk(e){return e.addReducers({search:ce,pagination:ka}),!0}function lO(e){return rk(e)}var ak=new oe({fieldsToInclude:new re({required:!1,each:new x({required:!0,emptyAllowed:!1})})});function Uf(e,t){ik(e);let r=ne(e),n=oo(e),{dispatch:a}=e,i=()=>e.state,s=_e(e,ak,t==null?void 0:t.options,"buildCoreResultList");s.fieldsToInclude&&a(ga(s.fieldsToInclude));let o=()=>e.state.search.results.length<e.state.search.response.totalCountFiltered,c=0,u=0,d=5,f=200,l=!1;return{...r,get state(){let g=i();return{...n.state,results:g.search.results,moreResultsAvailable:o(),searchResponseId:g.search.searchResponseId}},fetchMoreResults:async()=>{if(!e.state.search.isLoading){if(!o()){e.logger.info("No more results are available for the result list to fetch.");return}if(Date.now()-c<f){if(u++,u>=d){c=Date.now(),!l&&e.logger.error(`The result list method "fetchMoreResults" execution prevented because it has been triggered consecutively ${d} times, with little delay. Please verify the conditions under which the function is called.`),l=!0;return}}else u=0;l=!1,t!=null&&t.fetchMoreResultsActionCreator&&(await a(t==null?void 0:t.fetchMoreResultsActionCreator()),c=Date.now())}}}}function ik(e){return e.addReducers({search:ce,configuration:ie,fields:Es}),!0}function dO(e,t){return Uf(e,{...t,fetchMoreResultsActionCreator:pa})}var sk={results:new re({required:!0,each:new P({values:hs})}),maxLength:new Q({required:!0,min:1,default:10})},ok=S("recentResults/registerRecentResults",e=>I(e,sk)),cn=S("recentResults/pushRecentResult",e=>(Lr(e),{payload:e})),ck=S("recentResults/clearRecentResults"),uk=e=>R({prefix:"analytics/result/open",__legacy__getBuilder:(t,r)=>(Lr(e),t.makeDocumentOpen(Qe(e,r),ze(e))),analyticsType:"itemClick",analyticsPayloadBuilder:t=>{var a;let r=Qe(e,t),n=ze(e);return{searchUid:((a=t.search)==null?void 0:a.response.searchUid)??"",position:r.documentPosition,itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}});function cr(e,t,r){lk(e);let n=1e3,a={selectionDelay:n,debounceWait:n,...t.options},i;return{select:sd(r,a.debounceWait,{isImmediate:!0}),beginDelayedSelect(){i=setTimeout(r,a.selectionDelay)},cancelPendingSelect(){i&&clearTimeout(i)}}}function lk(e){return e.addReducers({configuration:ie}),!0}function fO(e,t){let r=!1,n=()=>{r||(r=!0,e.dispatch(uk(t.options.result)))};return cr(e,t,()=>{n(),e.dispatch(cn(t.options.result))})}function pO(e,t){let r=!1,n=()=>{r||(r=!0,e.dispatch(zS(t.options.result)))};return cr(e,t,()=>{n(),e.dispatch(cn(t.options.result))})}var dk=new oe({numberOfResults:new Q({min:0})});function fk(e,t={}){pk(e);let r=ne(e),{dispatch:n}=e,a=()=>e.state,i=Mt(e,dk,t.initialState,"buildResultsPerPage").numberOfResults;return i!==void 0&&n(Tl(i)),{...r,get state(){return{numberOfResults:a().pagination.numberOfResults}},set(s){n(Ml(s))},isSetTo(s){return s===this.state.numberOfResults}}}function pk(e){return e.addReducers({pagination:ka,configuration:ie}),!0}function gO(e,t={}){gk(e);let r=fk(e,t),{dispatch:n}=e;return{...r,get state(){return{...r.state}},set(a){r.set(a),n(zt({legacy:Mf()}))}}}function gk(e){return e.addReducers({pagination:ka,configuration:ie}),!0}var co=()=>R("analytics/searchbox/submit",e=>e.makeSearchboxSubmit()),jf=()=>({actionCause:"searchboxSubmit"}),Vf={id:T,query:Se},_f=S("querySet/register",e=>I(e,Vf)),Ti=S("querySet/update",e=>I(e,Vf)),hk={q:new x},yk={},mk=S("commerce/searchParameters/restore",e=>I(e,hk));S("commerce/productListingParameters/restore",e=>I(e,yk));var Lf=W(uu(),e=>{e.addCase(_f,(t,r)=>{let{id:n,query:a}=r.payload;n in t||(t[n]=a)}).addCase(Ti,(t,r)=>{let{id:n,query:a}=r.payload;ni(t,n,a)}).addCase(Br,(t,r)=>{let{id:n,expression:a}=r.payload;ni(t,n,a)}).addCase(E.fulfilled,(t,r)=>{let{queryExecuted:n}=r.payload;$f(t,n)}).addCase(Ce,xc).addCase(mk,xc).addCase(me.fulfilled,(t,r)=>{if(r.payload)for(let[n,a]of Object.entries(r.payload.querySet))ni(t,n,a)})});function xc(e,t){z(t.payload.q)||$f(e,t.payload.q)}function $f(e,t){Object.keys(e).forEach(r=>e[r]=t)}var ni=(e,t,r)=>{t in e&&(e[t]=r)},vk=e=>R("analytics/querySuggest",(t,r)=>{let n=Qf(r,e);return t.makeOmniboxAnalytics(n)}),Sk=()=>({actionCause:"omniboxAnalytics"});function Qf(e,t){let{id:r,suggestion:n}=t,a=e.querySuggest&&e.querySuggest[r];if(!a)throw new Error(`Unable to determine the query suggest analytics metadata to send because no query suggest with id "${r}" was found. Please check the sent #id.`);let i=a.completions.map(u=>u.expression),s=a.partialQueries.length-1,o=a.partialQueries[s]||"",c=a.responseId;return{suggestionRanking:i.indexOf(n),partialQuery:o,partialQueries:a.partialQueries,suggestions:i,querySuggestResponseId:c}}var wk=()=>({}),uo=W(wk(),e=>e.addCase(Qs,(t,r)=>{let n=r.payload.id;n in t||(t[n]=bk(r.payload))}).addCase(i0,(t,r)=>{delete t[r.payload.id]}).addCase(wr.pending,Ac).addCase(wr.fulfilled,(t,r)=>{let n=t[r.meta.arg.id];if(!n||r.meta.requestId!==n.currentRequestId)return;let{q:a}=r.payload;a&&n.partialQueries.push(a.replace(/;/,encodeURIComponent(";"))),n.responseId=r.payload.responseId,n.completions=r.payload.completions,n.isLoading=!1,n.error=null}).addCase(wr.rejected,Oc).addCase(br.pending,Ac).addCase(br.fulfilled,(t,r)=>{let n=t[r.meta.arg.id];if(!n||r.meta.requestId!==n.currentRequestId)return;let{query:a}=r.payload;a&&n.partialQueries.push(a.replace(/;/,encodeURIComponent(";"))),n.responseId=r.payload.responseId,n.completions=r.payload.completions.map(i=>({expression:i.expression,highlighted:i.highlighted,score:0,executableConfidence:0})),n.isLoading=!1,n.error=null}).addCase(br.rejected,Oc).addCase(Sr,(t,r)=>{let n=t[r.payload.id];n&&(n.responseId="",n.completions=[],n.partialQueries=[])}));function bk(e){return{id:"",completions:[],responseId:"",count:5,currentRequestId:"",error:null,partialQueries:[],isLoading:!1,...e}}function Ac(e,t){let r=e[t.meta.arg.id];r&&(r.currentRequestId=t.meta.requestId,r.isLoading=!0)}function Oc(e,t){let r=e[t.meta.arg.id];r&&(r.error=t.payload||null,r.isLoading=!1)}var un=W(Ge(),e=>e.addCase(mt,(t,r)=>({...t,...r.payload})).addCase(Qr,(t,r)=>{t.q=r.payload}).addCase(Br,(t,r)=>{t.q=r.payload.expression}).addCase(me.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.query)??t}).addCase(Ce,(t,r)=>{t.q=r.payload.q??t.q,t.enableQuerySyntax=r.payload.enableQuerySyntax??t.enableQuerySyntax})),zf={enableQuerySyntax:!1,numberOfSuggestions:5,clearFilters:!0},ai={open:new x,close:new x},Nf={id:T,numberOfSuggestions:new Q({min:0}),enableQuerySyntax:new K,highlightOptions:new P({values:{notMatchDelimiters:new P({values:ai}),exactMatchDelimiters:new P({values:ai}),correctionDelimiters:new P({values:ai})}}),clearFilters:new K},Ck=new oe(Nf);function Ik(e,t){var u,d;qk(e);let r=ne(e),{dispatch:n}=e,a=()=>e.state,i=((u=t.options)==null?void 0:u.id)||Gn("search_box"),s={id:i,highlightOptions:{...(d=t.options)==null?void 0:d.highlightOptions},...zf,...t.options};_e(e,Ck,s,"buildSearchBox"),n(_f({id:i,query:e.state.query.q})),s.numberOfSuggestions&&n(Qs({id:i,count:s.numberOfSuggestions}));let o=()=>e.state.querySet[s.id],c=async f=>{let{enableQuerySyntax:l,clearFilters:g}=s;n(ed({q:o(),enableQuerySyntax:l,clearFilters:g})),t.isNextAnalyticsReady?n(t.executeSearchActionCreator(f)):n(t.executeSearchActionCreator(f.legacy))};return{...r,updateText(f){n(Ti({id:i,query:f})),this.showSuggestions()},clear(){n(Ti({id:i,query:""})),n(Sr({id:i}))},showSuggestions(){s.numberOfSuggestions&&n(t.fetchQuerySuggestionsActionCreator({id:i}))},selectSuggestion(f){n(Br({id:i,expression:f})),c({legacy:vk({id:i,suggestion:f}),next:Sk()}).then(()=>{n(Sr({id:i}))})},submit(f=co(),l){c({legacy:f,next:l}),n(Sr({id:i}))},get state(){let f=a(),l=f.querySuggest[s.id],g=kk(l,s.highlightOptions),v=l?l.isLoading:!1;return{value:o(),suggestions:g,isLoading:f.search.isLoading,isLoadingSuggestions:v}}}}function kk(e,t){return e?e.completions.map(r=>({highlightedValue:mu(r.highlighted,t),rawValue:r.expression})):[]}function qk(e){return e.addReducers({query:un,querySuggest:uo,configuration:ie,querySet:Lf,search:ce}),!0}function xk(e,t={}){let r=Ik(e,{...t,executeSearchActionCreator:E,fetchQuerySuggestionsActionCreator:wr,isNextAnalyticsReady:!0});return{...r,submit(){r.submit(co(),jf())},get state(){return r.state}}}function Bf(e){return e?e.expiresAt&&Date.now()>=e.expiresAt:!1}var Ak=(e,t)=>{let{id:r}=e;if(!t[r])return t[r]={q:"",cache:{}},t},Ok=(e,t)=>{let{q:r,id:n}=e;r&&(t[n].q=r)},Fk=(e,t)=>{let{id:r}=e;Object.entries(t[r].cache).forEach(([n,a])=>{Bf(a)&&delete t[r].cache[n]})},Rk=(e,t,r)=>{for(let a in t)for(let i in t[a].cache)t[a].cache[i].isActive=!1;if(!Mi(e,t)){Tk(e,t,r);return}let n=Mi(e,t);n.isLoading=!0,n.isActive=!0,n.error=null},Ek=(e,t,r)=>{let{id:n,q:a,searchUid:i,cacheTimeout:s,totalCountFiltered:o,duration:c}=e;t[n].cache[a]={...Mi(e,t),...r,isActive:!0,searchUid:i,isLoading:!1,error:null,expiresAt:s?s+Date.now():0,totalCountFiltered:o,duration:c}},Dk=(e,t)=>{let{id:r,q:n,error:a}=e;t[r].cache[n].error=a||null,t[r].cache[n].isLoading=!1,t[r].cache[n].isActive=!1},Mi=(e,t)=>{let{q:r,id:n}=e;return t[n].cache[r]||null},Tk=(e,t,r)=>{let{q:n,id:a}=e;t[a].cache[n]={isLoading:!0,error:null,expiresAt:0,isActive:!0,searchUid:"",totalCountFiltered:0,duration:0,...r}},Mk=W(vh(),e=>{e.addCase(El,(t,r)=>{Ak(r.payload,t)}),e.addCase(ua,(t,r)=>{Ok(r.payload,t)}),e.addCase(Dl,(t,r)=>{Fk(r.payload,t)}),e.addCase(bn.pending,(t,r)=>{Rk(r.meta.arg,t,{results:[]})}),e.addCase(bn.fulfilled,(t,r)=>{let{results:n}=r.payload;Ek({...r.payload,...r.meta.arg},t,{results:n})}),e.addCase(bn.rejected,(t,r)=>{Dk(r.meta.arg,t)})}),Pk={searchBoxId:ae,maxResultsPerQuery:new Q({required:!0,min:1}),cacheTimeout:new Q},Uk=new oe(Pk);function hO(e,t){jk(e);let r=ne(e),{dispatch:n}=e,a=()=>e.state,i={searchBoxId:t.options.searchBoxId||Gn("instant-results-"),cacheTimeout:t.options.cacheTimeout||6e4,maxResultsPerQuery:t.options.maxResultsPerQuery};_e(e,Uk,i,"buildInstantResults");let s=i.searchBoxId;n(El({id:s}));let o=()=>a().instantResults[s],c=f=>o().cache[f],u=()=>o().q,d=()=>{let f=c(u());return f?f.isLoading?[]:f.results:[]};return{...r,updateQuery(f){if(!f)return;let l=c(f);(!l||!l.isLoading&&(l.error||Bf(l)))&&n(bn({id:s,q:f,maxResultsPerQuery:i.maxResultsPerQuery,cacheTimeout:i.cacheTimeout})),n(ua({id:s,q:f}))},clearExpired(){n(Dl({id:s}))},get state(){let f=u(),l=c(f);return{q:f,isLoading:(l==null?void 0:l.isLoading)||!1,error:(l==null?void 0:l.error)||null,results:d()}}}}function jk(e){return e.addReducers({instantResults:Mk}),!0}var Hf=()=>R("analytics/sort/results",(e,t)=>e.makeResultsSort({resultsSortBy:t.sortCriteria||Xt()})),Yf=()=>({actionCause:"resultsSort"}),Fc={by:new Ft({enum:ns,required:!0})},Wf=S("sortCriteria/register",e=>Jf(e)),Gf=S("sortCriteria/update",e=>Jf(e)),Jf=e=>rs(e)?(e.forEach(t=>I(t,Fc)),{payload:e}):I(e,Fc),Vk=W(Xt(),e=>{e.addCase(Wf,(t,r)=>kr(r.payload)).addCase(Gf,(t,r)=>kr(r.payload)).addCase(me.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.sortCriteria)??t}).addCase(Ce,(t,r)=>r.payload.sortCriteria??t)});function _k(e,t){if(!t)return;let r=new oe({criterion:new re({each:yh})}),n=Lk(t),a={...t,criterion:n};Mt(e,r,a,"buildSort")}function Lk(e){return e.criterion?rs(e.criterion)?e.criterion:[e.criterion]:[]}function $k(e,t){var s;Qk(e);let r=ne(e),{dispatch:n}=e,a=()=>e.state;_k(e,t.initialState);let i=(s=t.initialState)==null?void 0:s.criterion;return i&&n(Wf(i)),{...r,sortBy(o){n(Gf(o)),n(tr(1))},isSortedBy(o){return this.state.sortCriteria===kr(o)},get state(){return{sortCriteria:a().sortCriteria}}}}function Qk(e){return e.addReducers({configuration:ie,sortCriteria:Vk}),!0}function yO(e,t={}){let{dispatch:r}=e,n=$k(e,t),a=()=>r(E({legacy:Hf(),next:Yf()}));return{...n,get state(){return n.state},sortBy(i){n.sortBy(i),a()}}}var qa=T,lo=new P({options:{required:!0},values:{caption:Se,expression:Se,state:new x({constrainTo:["idle","selected","excluded"]})}}),zk=new re({required:!0,each:lo}),Nk=S("staticFilter/register",e=>I(e,{id:qa,values:zk})),Kf=S("staticFilter/toggleSelect",e=>I(e,{id:qa,value:lo})),Zf=S("staticFilter/toggleExclude",e=>I(e,{id:qa,value:lo})),Bk=S("staticFilter/deselectAllFilterValues",e=>I(e,qa)),Hk=e=>R("analytics/staticFilter/deselect",t=>t.makeStaticFilterDeselect(e)),Yk=()=>({actionCause:"staticFilterDeselect"});W(gu(),e=>e.addCase(Nk,(t,r)=>{let n=r.payload,{id:a}=n;a in t||(t[a]=n)}).addCase(Kf,(t,r)=>{let{id:n,value:a}=r.payload,i=t[n];if(!i)return;let s=i.values.find(c=>c.caption===a.caption);if(!s)return;let o=s.state==="selected";s.state=o?"idle":"selected"}).addCase(Zf,(t,r)=>{let{id:n,value:a}=r.payload,i=t[n];if(!i)return;let s=i.values.find(c=>c.caption===a.caption);if(!s)return;let o=s.state==="excluded";s.state=o?"idle":"excluded"}).addCase(Bk,(t,r)=>{let n=r.payload,a=t[n];a&&a.values.forEach(i=>i.state="idle")}).addCase(Be,t=>{Object.values(t).forEach(r=>{r.values.forEach(n=>n.state="idle")})}).addCase(Ce,(t,r)=>{let n=r.payload.sf||{};Object.entries(t).forEach(([a,i])=>{let s=n[a]||[];i.values.forEach(o=>{o.state=s.includes(o.caption)?"selected":"idle"})})}));var Wk=W(hu(),e=>{e.addCase(ad,(t,r)=>{let n=r.payload,{id:a}=n;a in t||(t[a]={...n,isActive:!1})}).addCase(Fr,(t,r)=>{let n=r.payload;Rc(t,n)}).addCase(Ce,(t,r)=>{let n=r.payload.tab||"";Rc(t,n)}).addCase(me.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.tabSet)??t})});function Rc(e,t){t in e&&Object.keys(e).forEach(r=>{e[r].isActive=r===t})}var Gk=new oe({expression:Se,id:T}),Jk=new oe({isActive:new K});function Kk(e,t){Xk(t.options.id),Zk(e);let r=ne(e),{dispatch:n}=e;_e(e,Gk,t.options,"buildTab");let a=Mt(e,Jk,t.initialState,"buildTab"),{id:i,expression:s}=t.options;return n(ad({id:i,expression:s})),a.isActive&&n(Fr(i)),{...r,select(){n(Fr(i))},get state(){var o;return{isActive:(o=e.state.tabSet[i])==null?void 0:o.isActive}}}}function Zk(e){return e.addReducers({configuration:ie,tabSet:Wk}),!0}function Xk(e){let t=Gi().analytics.originLevel2;if(e===t)throw new Error(`The #id option on the Tab controller cannot use the reserved value "${t}". Please specify a different value.`)}function mO(e,t){let{dispatch:r}=e,n=Kk(e,t),a=()=>r(E({legacy:jn(),next:Vn()}));return{...n,get state(){return n.state},select(){n.select(),a()}}}function eq(e){tq(e);let t=ne(e),r=()=>e.state;return{...t,sort(n){return ks(n,this.state.facetIds)},get state(){return{facetIds:r().search.response.facets.map(n=>n.facetId)}}}}function tq(e){return e.addReducers({search:ce,facetOptions:wt}),!0}function vO(e){return eq(e)}var rq={categoryFacetId:G,categoryFacetPath:new re({required:!0,each:T})},nq=(e,{categoryFacetId:t,categoryFacetPath:r})=>{var i;let n=(i=e.categoryFacetSet[t])==null?void 0:i.request.field,a=`${n}_${t}`;return{categoryFacetId:t,categoryFacetPath:r,categoryFacetField:n,categoryFacetTitle:a}},aq=e=>R("analytics/categoryFacet/breadcrumb",(t,r)=>(I(e,rq),t.makeBreadcrumbFacet(nq(r,e)))),iq=()=>({actionCause:"breadcrumbFacet"}),sq=()=>R("analytics/facet/deselectAllBreadcrumbs",e=>e.makeBreadcrumbResetAll()),oq=()=>({actionCause:"breadcrumbResetAll"}),Xf=(e,{facetId:t,selection:r})=>{let n=(e.dateFacetSet[t]||e.numericFacetSet[t]).request.field,a=`${n}_${t}`;return{facetId:t,facetField:n,facetTitle:a,facetRangeEndInclusive:r.endInclusive,facetRangeEnd:`${r.end}`,facetRangeStart:`${r.start}`}},ep=()=>({actionCause:"breadcrumbFacet"}),Ec=e=>R("analytics/dateFacet/breadcrumb",(t,r)=>{I(e,ba(e.selection));let n=Xf(r,e);return t.makeBreadcrumbFacet(n)}),Dc=ep,Tc=e=>R("analytics/numericFacet/breadcrumb",(t,r)=>{I(e,ba(e.selection));let n=Xf(r,e);return t.makeBreadcrumbFacet(n)}),Mc=ep,ii=e=>Object.keys(e.facetSet).map(t=>{let r=e.facetValuesSelector(e.engine.state,t).map(n=>({value:n,deselect:()=>{n.state==="selected"?e.executeToggleSelect({facetId:t,selection:n}):n.state==="excluded"&&e.executeToggleExclude({facetId:t,selection:n})}}));return{facetId:t,field:e.facetSet[t].request.field,values:r}}).filter(t=>t.values.length);function cq(e){let t=ne(e),{dispatch:r}=e;return{...t,get state(){return{facetBreadcrumbs:[],categoryFacetBreadcrumbs:[],numericFacetBreadcrumbs:[],dateFacetBreadcrumbs:[],staticFilterBreadcrumbs:[],hasBreadcrumbs:!1}},deselectAll:()=>{r(Be())},deselectBreadcrumb(n){n.deselect()}}}function SO(e){uq(e);let t=cq(e),{dispatch:r}=e,n=()=>e.state,a=()=>{let h={engine:e,facetSet:n().facetSet,executeToggleSelect:({facetId:y,selection:k})=>{r(Sa({facetId:y,selection:k})),r(Nn({facetId:y,freezeCurrentValues:!1})),r(E({legacy:Ka({facetId:y,facetValue:k.value}),next:Za()}))},executeToggleExclude:({facetId:y,selection:k})=>{r(wa({facetId:y,selection:k})),r(Nn({facetId:y,freezeCurrentValues:!1})),r(E({legacy:Ka({facetId:y,facetValue:k.value}),next:Za()}))},facetValuesSelector:Zv};return ii(h)},i=()=>{let h={engine:e,facetSet:n().numericFacetSet,executeToggleSelect:y=>{r(nn(y)),r(E({legacy:Tc(y),next:Mc()}))},executeToggleExclude:y=>{r(an(y)),r(E({legacy:Tc(y),next:Mc()}))},facetValuesSelector:OC};return ii(h)},s=()=>{let h={engine:e,facetSet:n().dateFacetSet,executeToggleSelect:y=>{r(en(y)),r(E({legacy:Ec(y),next:Dc()}))},executeToggleExclude:y=>{r(tn(y)),r(E({legacy:Ec(y),next:Dc()}))},facetValuesSelector:PC};return ii(h)},o=()=>Object.keys(n().categoryFacetSet).map(c).filter(h=>h.path.length),c=h=>{let y=nS(n(),h);return{facetId:h,field:n().categoryFacetSet[h].request.field,path:y,deselect:()=>{r(ha(h)),r(E({legacy:aq({categoryFacetPath:y.map(k=>k.value),categoryFacetId:h}),next:iq()}))}}},u=()=>{let h=n().staticFilterSet??{};return Object.values(h).map(d)},d=h=>{let{id:y,values:k}=h,D=k.filter(U=>U.state!=="idle").map(U=>f(y,U));return{id:y,values:D}},f=(h,y)=>({value:y,deselect:()=>{let{caption:k,expression:D}=y;y.state==="selected"?r(Kf({id:h,value:y})):y.state==="excluded"&&r(Zf({id:h,value:y})),r(E({legacy:Hk({staticFilterId:h,staticFilterValue:{caption:k,expression:D}}),next:Yk()}))}}),l=()=>{var y;let h=((y=n().automaticFacetSet)==null?void 0:y.set)??{};return Object.values(h).map(k=>g(k.response))},g=h=>{let{field:y,label:k}=h,D=h.values.filter(U=>U.state==="selected").map(U=>v(y,U));return{facetId:y,field:y,label:k,values:D}},v=(h,y)=>({value:y,deselect:()=>{r(Ia({field:h,selection:y})),r(E({legacy:Ka({facetId:h,facetValue:y.value}),next:Za()}))}});function p(){return!![...a(),...i(),...s(),...o(),...u(),...l()].length}return{...t,get state(){return{facetBreadcrumbs:a(),categoryFacetBreadcrumbs:o(),numericFacetBreadcrumbs:i(),dateFacetBreadcrumbs:s(),staticFilterBreadcrumbs:u(),automaticFacetBreadcrumbs:l(),hasBreadcrumbs:p()}},deselectAll:()=>{t.deselectAll(),r(E({legacy:sq(),next:oq()}))}}}function uq(e){return e.addReducers({configuration:ie,search:ce,facetSet:to,numericFacetSet:sr,dateFacetSet:sn,categoryFacetSet:Vs}),!0}function lq(e){return e.type==="redirect"}var dq=class{constructor(e){this.response=e}get basicExpression(){return this.response.parsedInput.basicExpression}get largeExpression(){return this.response.parsedInput.largeExpression}get redirectionUrl(){let e=this.response.preprocessingOutput.triggers.filter(lq);return e.length?e[0].content:null}},tp=S("standaloneSearchBox/register",e=>I(e,{id:T,redirectionUrl:T})),rp=S("standaloneSearchBox/reset",e=>I(e,{id:T})),np=S("standaloneSearchBox/updateAnalyticsToSearchFromLink",e=>I(e,{id:T})),ap=S("standaloneSearchBox/updateAnalyticsToOmniboxFromLink"),In=B("standaloneSearchBox/fetchRedirect",async(e,{dispatch:t,getState:r,rejectWithValue:n,extra:{apiClient:a,validatePayload:i}})=>{i(e,{id:new x({emptyAllowed:!1})});let s=await pq(r()),o=await a.plan(s);if($e(o))return n(o.error);let{redirectionUrl:c}=new dq(o.success);return c&&t(fq(c)),c||""}),fq=e=>R("analytics/standaloneSearchBox/redirect",t=>t.makeTriggerRedirect({redirectedTo:e})),pq=async e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,timezone:e.configuration.search.timezone,q:e.query.q,...e.context&&{context:e.context.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub},...e.configuration.analytics.enabled&&{visitorId:await it(e.configuration.analytics)},...e.configuration.analytics.enabled&&await da(e.configuration.analytics),...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}}),gq=W(bh(),e=>e.addCase(tp,(t,r)=>{let{id:n,redirectionUrl:a}=r.payload;n in t||(t[n]=Pc(a))}).addCase(rp,(t,r)=>{let{id:n}=r.payload,a=t[n];if(a){t[n]=Pc(a.defaultRedirectionUrl);return}}).addCase(In.pending,(t,r)=>{let n=t[r.meta.arg.id];n&&(n.isLoading=!0)}).addCase(In.fulfilled,(t,r)=>{let n=r.payload,a=t[r.meta.arg.id];a&&(a.redirectTo=n||a.defaultRedirectionUrl,a.isLoading=!1)}).addCase(In.rejected,(t,r)=>{let n=t[r.meta.arg.id];n&&(n.isLoading=!1)}).addCase(np,(t,r)=>{let n=t[r.payload.id];n&&(n.analytics.cause="searchFromLink")}).addCase(ap,(t,r)=>{let n=t[r.payload.id];n&&(n.analytics.cause="omniboxFromLink",n.analytics.metadata=r.payload.metadata)}));function Pc(e){return{defaultRedirectionUrl:e,redirectTo:"",isLoading:!1,analytics:{cause:"",metadata:null}}}var hq=new oe({...Nf,redirectionUrl:new x({required:!0,emptyAllowed:!1})});function wO(e,t){yq(e);let{dispatch:r}=e,n=()=>e.state,a=t.options.id||Gn("standalone_search_box"),i={id:a,highlightOptions:{...t.options.highlightOptions},...zf,...t.options};_e(e,hq,i,"buildStandaloneSearchBox");let s=xk(e,{options:i});return r(tp({id:a,redirectionUrl:i.redirectionUrl})),{...s,updateText(o){s.updateText(o),r(np({id:a}))},selectSuggestion(o){let c=Qf(n(),{id:a,suggestion:o});r(Br({id:a,expression:o})),r(ap({id:a,metadata:c})),this.submit()},afterRedirection(){r(rp({id:a}))},submit(){r(mt({q:this.state.value,enableQuerySyntax:i.enableQuerySyntax})),r(In({id:a}))},get state(){let o=n().standaloneSearchBoxSet[a];return{...s.state,isLoading:o.isLoading,redirectTo:o.redirectTo,analytics:o.analytics}}}}function yq(e){return e.addReducers({standaloneSearchBoxSet:gq,configuration:ie,query:un,querySuggest:uo}),!0}function mq(e,t){return e.q!==t.q?co():e.sortCriteria!==t.sortCriteria?Hf():e.firstResult!==t.firstResult?Pf():e.numberOfResults!==t.numberOfResults?Mf():je(e.f,t.f)?mr(e.f,t.f):je(e.fExcluded,t.fExcluded)?mr(e.fExcluded,t.fExcluded,!0):je(e.cf,t.cf)?mr(e.cf,t.cf):je(e.af,t.af)?mr(e.af,t.af):je(e.nf,t.nf)?Uc(e.nf,t.nf):je(e.df,t.df)?Uc(e.df,t.df):jn()}function mr(e={},t={},r=!1){let n=Object.keys(e),a=Object.keys(t),i=n.filter(l=>!a.includes(l));if(i.length){let l=i[0];switch(!0){case e[l].length>1:return vt(l);case r:return Qn({facetId:l,facetValue:e[l][0]});default:return Er({facetId:l,facetValue:e[l][0]})}}let s=a.filter(l=>!n.includes(l));if(s.length){let l=s[0];return r?Rr({facetId:l,facetValue:t[l][0]}):nt({facetId:l,facetValue:t[l][0]})}let o=a.find(l=>t[l].filter(g=>e[l].includes(g)));if(!o)return jn();let c=e[o],u=t[o],d=u.filter(l=>!c.includes(l));if(d.length)return r?Rr({facetId:o,facetValue:d[0]}):nt({facetId:o,facetValue:d[0]});let f=c.filter(l=>!u.includes(l));return f.length?r?Qn({facetId:o,facetValue:f[0]}):Er({facetId:o,facetValue:f[0]}):jn()}function Uc(e={},t={}){return mr(Qt(e),Qt(t))}function vq(e,t){return e.q!==t.q?jf():e.sortCriteria!==t.sortCriteria?Yf():je(e.f,t.f)?Lt(e.f,t.f):je(e.fExcluded,t.fExcluded)?Lt(e.fExcluded,t.fExcluded,!0):je(e.cf,t.cf)?Lt(e.cf,t.cf):je(e.af,t.af)?Lt(e.af,t.af):je(e.nf,t.nf)?Lt(Qt(e.nf),Qt(t.nf)):je(e.df,t.df)?Lt(Qt(e.df),Qt(t.df)):Vn()}function je(e={},t={}){return JSON.stringify(e)!==JSON.stringify(t)}function Lt(e={},t={},r=!1){let n=Object.keys(e),a=Object.keys(t),i=n.filter(u=>!a.includes(u));if(i.length){let u=i[0];return e[u].length>1?St():Dr()}if(a.filter(u=>!n.includes(u)).length)return r?zn():at();let s=a.find(u=>t[u].filter(d=>e[u].includes(d)));if(!s)return Vn();let o=e[s],c=t[s];return c.filter(u=>!o.includes(u)).length?r?zn():at():o.filter(u=>!c.includes(u)).length?Dr():Vn()}function Qt(e={}){let t={};return Object.keys(e).forEach(r=>t[r]=e[r].map(n=>`${n.start}..${n.end}`)),t}function Sq(e){var t,r,n;return{q:Ge().q,enableQuerySyntax:Ge().enableQuerySyntax,aq:((t=e.advancedSearchQueries)==null?void 0:t.defaultFilters.aq)??At().defaultFilters.aq,cq:((r=e.advancedSearchQueries)==null?void 0:r.defaultFilters.cq)??At().defaultFilters.cq,firstResult:Ot().firstResult,numberOfResults:((n=e.pagination)==null?void 0:n.defaultNumberOfResults)??Ot().defaultNumberOfResults,sortCriteria:Xt(),f:{},fExcluded:{},cf:{},nf:{},df:{},debug:Jn(),sf:{},tab:"",af:{}}}var wq=new oe({parameters:new P({options:{required:!0},values:Il})});function bq(e,t){let{dispatch:r}=e,n=ne(e);return Mt(e,wq,t.initialState,"buildSearchParameterManager"),r(Ce(t.initialState.parameters)),{...n,synchronize(a){let i=Pi(e,a);r(Ce(i))},get state(){return{parameters:ip(e)}}}}function Pi(e,t){return{...Sq(e.state),...t}}function Cq(e,t){return qq(e,t)}function ip(e){let t=e.state;return{...Iq(t),...kq(t),...xq(t),...jc(t,sp,"f"),...jc(t,Aq,"fExcluded"),...Oq(t),...Fq(t),...Rq(t),...Eq(t)}}function Iq(e){if(e.query===void 0)return{};let t=e.query.q;return t!==Ge().q?{q:t}:{}}function kq(e){let t=Object.values(e.tabSet??{}).find(r=>r.isActive);return t?{tab:t.id}:{}}function qq(e,t){let r=e.state.tabSet,n=t.tab;if(!r||!Object.entries(r).length||!n)return!0;let a=n in r;return a||e.logger.warn(`The tab search parameter "${n}" is invalid. Ignoring change.`),a}function xq(e){if(e.sortCriteria===void 0)return{};let t=e.sortCriteria;return t!==Xt()?{sortCriteria:t}:{}}function jc(e,t,r){if(e.facetSet===void 0)return{};let n=Object.entries(e.facetSet).filter(([a])=>{var i,s;return((s=(i=e.facetOptions)==null?void 0:i.facets[a])==null?void 0:s.enabled)??!0}).map(([a,{request:i}])=>{let s=t(i.currentValues);return s.length?{[a]:s}:{}}).reduce((a,i)=>({...a,...i}),{});return Object.keys(n).length?{[r]:n}:{}}function sp(e){return e.filter(t=>t.state==="selected").map(t=>t.value)}function Aq(e){return e.filter(t=>t.state==="excluded").map(t=>t.value)}function Oq(e){if(e.categoryFacetSet===void 0)return{};let t=Object.entries(e.categoryFacetSet).filter(([r])=>{var n,a;return((a=(n=e.facetOptions)==null?void 0:n.facets[r])==null?void 0:a.enabled)??!0}).map(([r,n])=>{let a=ht(n.request.currentValues).map(i=>i.value);return a.length?{[r]:a}:{}}).reduce((r,n)=>({...r,...n}),{});return Object.keys(t).length?{cf:t}:{}}function Fq(e){if(e.numericFacetSet===void 0)return{};let t=Object.entries(e.numericFacetSet).filter(([r])=>{var n,a;return((a=(n=e.facetOptions)==null?void 0:n.facets[r])==null?void 0:a.enabled)??!0}).map(([r,{request:n}])=>{let a=op(n.currentValues);return a.length?{[r]:a}:{}}).reduce((r,n)=>({...r,...n}),{});return Object.keys(t).length?{nf:t}:{}}function Rq(e){if(e.dateFacetSet===void 0)return{};let t=Object.entries(e.dateFacetSet).filter(([r])=>{var n,a;return((a=(n=e.facetOptions)==null?void 0:n.facets[r])==null?void 0:a.enabled)??!0}).map(([r,{request:n}])=>{let a=op(n.currentValues);return a.length?{[r]:a}:{}}).reduce((r,n)=>({...r,...n}),{});return Object.keys(t).length?{df:t}:{}}function op(e){return e.filter(t=>t.state==="selected")}function Eq(e){var n;let t=(n=e.automaticFacetSet)==null?void 0:n.set;if(t===void 0)return{};let r=Object.entries(t).map(([a,{response:i}])=>{let s=sp(i.values);return s.length?{[a]:s}:{}}).reduce((a,i)=>({...a,...i}),{});return Object.keys(r).length?{af:r}:{}}function Dq(e,t){let{dispatch:r}=e,n=bq(e,t);return{...n,synchronize(a){let i=Vc(e),s=Pi(e,i),o=Pi(e,a);so(s,o)||Cq(e,o)&&(n.synchronize(a),r(E({legacy:mq(s,o),next:vq(s,o)})))},get state(){return{parameters:Vc(e)}}}}function Vc(e){let t=e.state;return{...ip(e),...Tq(t),...Mq(t),...Pq(t),...Uq(t),...jq(t),...Lq(t),...Vq(t)}}function Tq(e){if(e.query===void 0)return{};let t=e.query.enableQuerySyntax;return t!==void 0&&t!==Ge().enableQuerySyntax?{enableQuerySyntax:t}:{}}function Mq(e){if(e.advancedSearchQueries===void 0)return{};let{aq:t,defaultFilters:r}=e.advancedSearchQueries;return t!==r.aq?{aq:t}:{}}function Pq(e){if(e.advancedSearchQueries===void 0)return{};let{cq:t,defaultFilters:r}=e.advancedSearchQueries;return t!==r.cq?{cq:t}:{}}function Uq(e){if(e.pagination===void 0)return{};let t=e.pagination.firstResult;return t!==Ot().firstResult?{firstResult:t}:{}}function jq(e){if(e.pagination===void 0)return{};let{numberOfResults:t,defaultNumberOfResults:r}=e.pagination;return t!==r?{numberOfResults:t}:{}}function Vq(e){if(e.staticFilterSet===void 0)return{};let t=Object.entries(e.staticFilterSet).map(([r,n])=>{let a=_q(n.values);return a.length?{[r]:a}:{}}).reduce((r,n)=>({...r,...n}),{});return Object.keys(t).length?{sf:t}:{}}function _q(e){return e.filter(t=>t.state==="selected").map(t=>t.caption)}function Lq(e){if(e.debug===void 0)return{};let t=e.debug;return t!==Jn()?{debug:t}:{}}var cp="..",Ui="...",$q=/^(f|fExcluded|cf|nf|df|sf|af)-(.+)$/,Qq={f:!0,fExcluded:!0,cf:!0,sf:!0,af:!0,nf:!0,df:!0},xa="&",Pr="=";function up(){return{serialize:Bq(Hq),deserialize:Zq}}function ln(e){return e in Qq}function zq(e){return e in{q:!0,aq:!0,cq:!0,enableQuerySyntax:!0,firstResult:!0,numberOfResults:!0,sortCriteria:!0,debug:!0,tab:!0}}function Nq(e){let t=e in{nf:!0,df:!0};return ln(e)&&t}function lp(e){return zq(e)||ln(e)}var Bq=e=>t=>Object.entries(t).map(e).filter(r=>r).join(xa);function Hq(e){let[t,r]=e;return lp(t)?ln(t)&&!Nq(t)?Wq(r)?Jq(t,r):"":t==="nf"||t==="df"?Gq(r)?Kq(t,r):"":Yq(t,r):""}function Yq(e,t){return`${e}${Pr}${encodeURIComponent(t)}`}function Wq(e){return ji(e)?dp(e,t=>typeof t=="string"):!1}function Gq(e){return ji(e)?dp(e,t=>ji(t)&&"start"in t&&"end"in t):!1}function ji(e){return!!(e&&typeof e=="object")}function dp(e,t){return Object.entries(e).filter(r=>{let n=r[1];return!Array.isArray(n)||!n.every(t)}).length===0}function Jq(e,t){return Object.entries(t).map(([r,n])=>`${e}-${r}${Pr}${n.map(a=>encodeURIComponent(a)).join(",")}`).join(xa)}function Kq(e,t){return Object.entries(t).map(([r,n])=>{let a=n.map(({start:i,end:s,endInclusive:o})=>`${i}${o?Ui:cp}${s}`).join(",");return`${e}-${r}${Pr}${a}`}).join(xa)}function Zq(e){return e.split(xa).map(t=>Xq(t)).map(ex).filter(ax).map(t=>ix(t)).reduce((t,r)=>{let[n,a]=r;if(ln(n)){let i={...t[n],...a};return{...t,[n]:i}}return{...t,[n]:a}},{})}function Xq(e){let[t,...r]=e.split(Pr),n=r.join(Pr);return[t,n]}function ex(e){let[t,r]=e,n=$q.exec(t);if(!n)return e;let a=n[1],i=n[2],s=r.split(","),o=tx(a,s),c={[i]:o};return[a,JSON.stringify(c)]}function tx(e,t){return e==="nf"?rx(t):e==="df"?nx(t):t}function rx(e){return e.map(t=>{let{startAsString:r,endAsString:n,isEndInclusive:a}=fp(t);return{start:parseFloat(r),end:parseFloat(n),endInclusive:a}}).filter(({start:t,end:r})=>Number.isFinite(t)&&Number.isFinite(r)).map(({start:t,end:r,endInclusive:n})=>IC({start:t,end:r,state:"selected",endInclusive:n}))}function _c(e){try{return JS(e)?(Vl(e,ws),!0):Jt(e)?(_n(e),!0):!1}catch{return!1}}function nx(e){return e.map(t=>{let{isEndInclusive:r,startAsString:n,endAsString:a}=fp(t);return{start:n,end:a,endInclusive:r}}).filter(({start:t,end:r})=>_c(t)&&_c(r)).map(({start:t,end:r,endInclusive:n})=>$d({start:t,end:r,state:"selected",endInclusive:n}))}function ax(e){let t=lp(e[0]),r=e.length===2;return t&&r}function ix(e,t=!0){let[r,n]=e;return r==="enableQuerySyntax"?[r,n==="true"]:r==="debug"?[r,n==="true"]:r==="firstResult"?[r,parseInt(n)]:r==="numberOfResults"?[r,parseInt(n)]:ln(r)?[r,sx(n)]:[r,t?decodeURIComponent(n):n]}function sx(e){let t=JSON.parse(e),r={};return Object.entries(t).forEach(n=>{let[a,i]=n;r[a]=i.map(s=>ea(s)?decodeURIComponent(s):s)}),r}function fp(e){let t=e.indexOf(Ui)!==-1,[r,n]=e.split(t?Ui:cp);return{isEndInclusive:t,startAsString:r,endAsString:n}}var ox=new oe({fragment:new x});function bO(e,t){let r;function n(){r=e.state.search.requestId}function a(){return r!==e.state.search.requestId}ux(e),Mt(e,ox,t.initialState,"buildUrlManager");let i=ne(e),s=t.initialState.fragment;n();let o=Dq(e,{initialState:{parameters:Yn(s)}});return{...i,subscribe(c){let u=()=>{let d=this.state.fragment;!cx(s,d)&&a()&&(s=d,c()),n()};return u(),e.subscribe(u)},get state(){return{fragment:up().serialize(o.state.parameters)}},synchronize(c){s=c;let u=Yn(c);o.synchronize(u)}}}function cx(e,t){if(e===t)return!0;let r=Yn(e),n=Yn(t);return so(r,n)}function Yn(e){return up().deserialize(e)}function ux(e){return e.addReducers({configuration:ie}),!0}function CO(e){return oo(e)}async function pp(e,t){var o;let{search:r,accessToken:n,organizationId:a,analytics:i}=e.configuration,s=((o=e.query)==null?void 0:o.q)||"";return{url:r.apiBaseUrl,accessToken:n,organizationId:a,enableNavigation:!1,...i.enabled&&{visitorId:await it(e.configuration.analytics)},q:s,...t,requestedOutputSize:t.requestedOutputSize||0,...r.authenticationProviders.length&&{authentication:r.authenticationProviders.join(",")}}}var Vi=B("resultPreview/fetchResultContent",async(e,{extra:t,getState:r,rejectWithValue:n})=>{let a=r(),i=await pp(a,e),s=await t.apiClient.html(i);return $e(s)?n(s.error):{content:s.success,uniqueId:e.uniqueId}}),gp=S("resultPreview/next"),hp=S("resultPreview/previous"),yp=S("resultPreview/prepare",e=>I(e,{results:new re({required:!0})})),Lc=2048,mp=B("resultPreview/updateContentURL",async(e,{getState:t,extra:r})=>{let n=t(),a=Qy(await e.buildResultPreviewRequest(n,{uniqueId:e.uniqueId,requestedOutputSize:e.requestedOutputSize}),e.path);return(a==null?void 0:a.length)>Lc&&r.logger.error(`The content URL was truncated as it exceeds the maximum allowed length of ${Lc} characters.`),{contentURL:a}}),lx=e=>R({prefix:"analytics/resultPreview/open",__legacy__getBuilder:(t,r)=>{Lr(e);let n=Qe(e,r),a=ze(e);return t.makeDocumentQuickview(n,a)},analyticsType:"itemClick",analyticsPayloadBuilder:t=>{var a;let r=Qe(e,t),n=ze(e);return{searchUid:((a=t.search)==null?void 0:a.response.searchUid)??"",position:r.documentPosition,actionCause:"preview",itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}}),si=e=>{let{content:t,isLoading:r,uniqueId:n,contentURL:a}=yu();e.content=t,e.isLoading=r,e.uniqueId=n,e.contentURL=a},oi=e=>e.filter(t=>t.hasHtmlVersion).map(t=>t.uniqueId),dx=W(yu(),e=>{e.addCase(Vi.pending,t=>{t.isLoading=!0}).addCase(Vi.fulfilled,(t,r)=>{let{content:n,uniqueId:a}=r.payload;t.position=t.resultsWithPreview.indexOf(a),t.content=n,t.uniqueId=a,t.isLoading=!1}).addCase(E.fulfilled,(t,r)=>{si(t),t.resultsWithPreview=oi(r.payload.response.results)}).addCase(pa.fulfilled,(t,r)=>{si(t),t.resultsWithPreview=t.resultsWithPreview.concat(oi(r.payload.response.results))}).addCase(zt.fulfilled,si).addCase(yp,(t,r)=>{t.resultsWithPreview=oi(r.payload.results)}).addCase(gp,t=>{if(t.isLoading)return;let r=t.position+1;r>t.resultsWithPreview.length-1&&(r=0),t.position=r}).addCase(hp,t=>{if(t.isLoading)return;let r=t.position-1;r<0&&(r=t.resultsWithPreview.length-1),t.position=r}).addCase(mp.fulfilled,(t,r)=>{t.contentURL=r.payload.contentURL})});function fx(e,t,r,n,a){px(e);let{dispatch:i}=e,s=()=>e.state,o=ne(e),{result:c,maximumPreviewSize:u}=t.options,d=()=>{let{resultsWithPreview:l,position:g}=s().resultPreview;return l[g]},f=l=>{i(mp({uniqueId:l,requestedOutputSize:u,buildResultPreviewRequest:r,path:n})),t.options.onlyContentURL||i(Vi({uniqueId:l,requestedOutputSize:u})),a&&a()};return{...o,fetchResultContent(){f(c.uniqueId)},next(){i(gp()),f(d())},previous(){i(hp()),f(d())},get state(){let l=s(),g=c.hasHtmlVersion,v=l.resultPreview,p=c.uniqueId===v.uniqueId?v.content:"",h=v.isLoading,y=v.contentURL,k=d();return{content:p,resultHasPreview:g,isLoading:h,contentURL:y,currentResultUniqueId:k}}}}function px(e){return e.addReducers({configuration:ie,resultPreview:dx}),!0}function IO(e,t){gx(e);let{dispatch:r}=e,n=()=>e.state,a=()=>n().search.results,i=fx(e,t,pp,"/html",()=>{e.dispatch(lx(t.options.result))});return r(yp({results:a()})),{...i,get state(){return{...i.state,currentResult:a().findIndex(s=>s.uniqueId===i.state.currentResultUniqueId)+1,totalResults:a().length}}}}function gx(e){return e.addReducers({search:ce}),!0}var hx=e=>R("analytics/folding/showMore",(t,r)=>(Lr(e),t.makeShowMoreFoldedResults(Qe(e,r),ze(e)))),yx=()=>R("analytics/folding/showLess",e=>e.makeShowLessFoldedResults()),mx={logShowMoreFoldedResults:hx,logShowLessFoldedResults:yx};function vx(e,t){return e.raw[t.collection]}function _i(e,t){return e.raw[t.parent]}function Ir(e,t){let r=e.raw[t.child];return Jc(r)?r[0]:r}function Sx(e,t){return(e||t)!==void 0&&e===t}function vp(e,t,r,n=[]){let a=Ir(e,r);return a?n.indexOf(a)!==-1?[]:t.filter(i=>{let s=Ir(i,r)===Ir(e,r);return _i(i,r)===a&&!s}).map(i=>({result:i,children:vp(i,t,r,[...n,a])})):[]}function wx(e,t){return e.find(r=>{let n=_i(r,t)===void 0,a=Sx(_i(r,t),Ir(r,t));return n||a})}function Sp(e){return e.parentResult?Sp(e.parentResult):e}function bx(e,t,r){let n=hl(e),a=r??wx(n,t)??Sp(e);return{result:a,children:vp(a,n,t),moreResultsAvailable:!0,isLoadingMoreResults:!1}}function mn(e,t,r){let n={};return e.forEach(a=>{let i=vx(a,t);i&&(!Ir(a,t)&&!a.parentResult||(n[i]=bx(a,t,r)))}),n}function $c(e,t){if(!e.collections[t])throw new Error(`Missing collection ${t} from ${Object.keys(e.collections)}: Folding most probably in an invalid state...`);return e.collections[t]}var Cx=W(cu(),e=>e.addCase(E.fulfilled,(t,{payload:r})=>{t.collections=t.enabled?mn(r.response.results,t.fields):{}}).addCase(zt.fulfilled,(t,{payload:r})=>{t.collections=t.enabled?mn(r.response.results,t.fields):{}}).addCase(pa.fulfilled,(t,{payload:r})=>{t.collections=t.enabled?{...t.collections,...mn(r.response.results,t.fields)}:{}}).addCase(Rs,(t,{payload:r})=>t.enabled?t:{enabled:!0,collections:{},fields:{collection:r.collectionField??t.fields.collection,parent:r.parentField??t.fields.parent,child:r.childField??t.fields.child},filterFieldRange:r.numberOfFoldedResults??t.filterFieldRange}).addCase(Cn.pending,(t,{meta:r})=>{let n=r.arg;$c(t,n).isLoadingMoreResults=!0}).addCase(Cn.rejected,(t,{meta:r})=>{let n=r.arg;$c(t,n).isLoadingMoreResults=!1}).addCase(Cn.fulfilled,(t,{payload:{collectionId:r,results:n,rootResult:a}})=>{let i=mn(n,t.fields,a);if(!i||!i[r])throw new Error(`Unable to create collection ${r} from received results: ${JSON.stringify(n)}. Folding most probably in an invalid state... `);t.collections[r]=i[r],t.collections[r].moreResultsAvailable=!1})),Ix=new oe(pd);function kx(e,t,r){var o;qx(e);let n=Uf(e,t),{dispatch:a}=e,i=()=>e.state,s=(o=t.options)!=null&&o.folding?_e(e,Ix,t.options.folding,"buildFoldedResultList"):{};return a(Rs({...s})),{...n,loadCollection:c=>{a(t.loadCollectionActionCreator(c.result.raw[e.state.folding.fields.collection])),a(r.logShowMoreFoldedResults(c.result))},logShowMoreFoldedResults:c=>{a(r.logShowMoreFoldedResults(c))},logShowLessFoldedResults:()=>{a(r.logShowLessFoldedResults())},findResultById(c){return Li(this.state.results,u=>u.result.uniqueId===c.result.uniqueId)},findResultByCollection(c){return Li(this.state.results,u=>u.result.raw.foldingcollection===c.result.raw.foldingcollection)},get state(){let c=i();return{...n.state,results:n.state.results.map(u=>{let d=u.raw[c.folding.fields.collection];return!d||!c.folding.collections[d]?{result:u,moreResultsAvailable:!1,isLoadingMoreResults:!1,children:[]}:c.folding.collections[d]})}}}}function qx(e){return e.addReducers({search:ce,configuration:id,folding:Cx,query:un}),!0}function Li(e,t){for(let r=0;r<e.length;r++){let n=e[r];if(t(n))return n;if(n.children.length){let a=Li(n.children,t);if(a)return a}}return null}function kO(e,t={}){let r=kx(e,{...t,loadCollectionActionCreator:Cn,fetchMoreResultsActionCreator:pa},mx);return{...r,get state(){return r.state}}}function xx(e){return e.query="",e.queryModification={originalQuery:"",newQuery:"",queryToIgnore:e.queryModification.queryToIgnore},e}function Ax(e,t){let r=[],n=[],a=[],i=[];return t.forEach(s=>{switch(s.type){case"redirect":r.push(s.content);break;case"query":n.push(s.content);break;case"execute":a.push({functionName:s.content.name,params:s.content.params});break;case"notify":i.push(s.content);break}}),e.redirectTo=r[0]??"",e.query=e.queryModification.newQuery,e.executions=a,e.notifications=i,e}function Ox(e,t){return e.queryModification={...t,queryToIgnore:""},e}function Fx(e,t){return e.queryModification.queryToIgnore=t,e}var wp=W(Ch(),e=>e.addCase(E.pending,xx).addCase(E.fulfilled,(t,r)=>Ax(t,r.payload.response.triggers)).addCase(qs,(t,r)=>Ox(t,r.payload)).addCase(fa,(t,r)=>Fx(t,r.payload)));function qO(e){Rx(e);let t=ne(e),{dispatch:r}=e,n=()=>e.state,a=()=>n().triggers.queryModification.newQuery,i=()=>n().triggers.queryModification.originalQuery;return{...t,get state(){return{newQuery:a(),originalQuery:i(),wasQueryModified:a()!==""}},undo(){r(fa(a())),r(mt({q:i()})),r(E({legacy:Cw({undoneQuery:a()}),next:kw()}))}}}function Rx(e){return e.addReducers({triggers:wp,query:un}),!0}function xO(e){Ex(e);let t=ne(e),{dispatch:r}=e,n=()=>e.state,a=n().triggers.notifications;return{...t,subscribe(i){let s=()=>{let o=!Af(a,this.state.notifications);a=this.state.notifications,o&&(i(),r(Iw()))};return s(),e.subscribe(s)},get state(){return{notifications:n().triggers.notifications}}}}function Ex(e){return e.addReducers({triggers:wp}),!0}var fo=()=>new P({values:{questionAnswerId:T},options:{required:!0}}),bp=()=>new P({values:{linkText:Se,linkURL:Se},options:{required:!0}});function Aa(e){return I(e,fo())}function yt(e,t){var n,a;let r=t??((a=(n=e.search)==null?void 0:n.questionAnswer)==null?void 0:a.documentId);return r&&e.search&&jw(e,r.contentIdKey,r.contentIdValue)}function Et(e,t){var n,a,i,s;let r=((n=e.questionAnswering)==null?void 0:n.relatedQuestions.findIndex(o=>o.questionAnswerId===t))??-1;return r===-1?null:((s=(i=(a=e.search)==null?void 0:a.questionAnswer)==null?void 0:i.relatedQuestions)==null?void 0:s[r])??null}var Dx=()=>R({prefix:"analytics/smartSnippet/expand",__legacy__getBuilder:e=>e.makeExpandSmartSnippet(),analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>{var t;return{action:"expand",answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:"SmartSnippet"}}}}),Tx=()=>R({prefix:"analytics/smartSnippet/collapse",__legacy__getBuilder:e=>e.makeCollapseSmartSnippet(),analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>{var t;return{action:"collapse",answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:"SmartSnippet"}}}}),Mx=()=>R({prefix:"analytics/smartSnippet/like",__legacy__getBuilder:e=>e.makeLikeSmartSnippet(),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>{var t;return{answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:"SmartSnippet"},feedback:{liked:!0}}}}),Px=()=>R({prefix:"analytics/smartSnippet/dislike",__legacy__getBuilder:e=>e.makeDislikeSmartSnippet(),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>{var t;return{answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:"SmartSnippet"},feedback:{liked:!1}}}}),Ux=()=>R({prefix:"analytics/smartSnippet/source/open",__legacy__getBuilder:(e,t)=>{let r=yt(t);return e.makeOpenSmartSnippetSource(Qe(r,t),ze(r))},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:e=>{var n;let t=yt(e),r=ze(t);return{answer:{responseId:((n=e.search)==null?void 0:n.response.searchUid)||"",type:"SmartSnippet"},citation:{id:r.contentIDValue,type:"Source"}}}}),Cp=e=>R({prefix:"analytics/smartSnippet/source/open",__legacy__getBuilder:(t,r)=>{I(e,bp());let n=yt(r);return n?t.makeOpenSmartSnippetInlineLink(Qe(n,r),{...ze(n),...e}):null},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:t=>{var a;let r=yt(t),n=ze(r);return{answer:{responseId:((a=t.search)==null?void 0:a.response.searchUid)||"",type:"SmartSnippet"},citation:{id:n.contentIDValue,type:"InlineLink"}}}}),jx=()=>R("analytics/smartSnippet/feedbackModal/open",e=>e.makeOpenSmartSnippetFeedbackModal()),Vx=()=>R("analytics/smartSnippet/feedbackModal/close",e=>e.makeCloseSmartSnippetFeedbackModal()),_x=e=>R({prefix:"analytics/smartSnippet/sendFeedback",__legacy__getBuilder:t=>t.makeSmartSnippetFeedbackReason(e),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>{var r;return{answer:{responseId:((r=t.search)==null?void 0:r.response.searchUid)||"",type:"SmartSnippet"},feedback:{liked:!1,reason:e}}}}),Lx=e=>R({prefix:"analytics/smartSnippet/sendFeedback",__legacy__getBuilder:t=>t.makeSmartSnippetFeedbackReason("other",e),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>{var r;return{answer:{responseId:((r=t.search)==null?void 0:r.response.searchUid)||"",type:"SmartSnippet"},feedback:{liked:!1,reason:"other",details:e}}}}),$x=e=>R({prefix:"analytics/smartSnippetSuggestion/expand",__legacy__getBuilder:(t,r)=>{Aa(e);let n=Et(r,e.questionAnswerId);return n?t.makeExpandSmartSnippetSuggestion({question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId}):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:t=>{var r;return{action:"expand",answer:{responseId:((r=t.search)==null?void 0:r.response.searchUid)||"",type:"SmartSnippetSuggestion"}}}}),Qx=e=>R({prefix:"analytics/smartSnippetSuggestion/collapse",__legacy__getBuilder:(t,r)=>{Aa(e);let n=Et(r,e.questionAnswerId);return n?t.makeCollapseSmartSnippetSuggestion({question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId}):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:t=>{var r;return{action:"collapse",answer:{responseId:((r=t.search)==null?void 0:r.response.searchUid)||"",type:"SmartSnippetSuggestion"}}}}),Ip=e=>R({prefix:"analytics/smartSnippetSuggestion/source/open",__legacy__getBuilder:(t,r)=>{I(e,fo());let n=Et(r,e.questionAnswerId);if(!n)return null;let a=yt(r,n.documentId);return a?t.makeOpenSmartSnippetSuggestionSource(Qe(a,r),{question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId}):null},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:t=>{var n;let r=Et(t,e.questionAnswerId);return{answer:{responseId:((n=t.search)==null?void 0:n.response.searchUid)||"",type:"SmartSnippetSuggestion"},citation:{id:(r==null?void 0:r.documentId.contentIdValue)||"",type:"Source"}}}}),zx=(e,t)=>R({prefix:"analytics/smartSnippetSuggestion/source/open",__legacy__getBuilder:(r,n)=>{I(e,fo()),I(t,bp());let a=Et(n,e.questionAnswerId);if(!a)return null;let i=yt(n,a.documentId);return i?r.makeOpenSmartSnippetSuggestionInlineLink(Qe(i,n),{question:a.question,answerSnippet:a.answerSnippet,documentId:a.documentId,linkText:t.linkText,linkURL:t.linkURL}):null},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:r=>{var a;let n=Et(r,e.questionAnswerId);return{answer:{responseId:((a=r.search)==null?void 0:a.response.searchUid)||"",type:"SmartSnippetSuggestion"},citation:{id:(n==null?void 0:n.documentId.contentIdValue)||"",type:"InlineLink"}}}}),kp={logExpandSmartSnippet:Dx,logCollapseSmartSnippet:Tx,logLikeSmartSnippet:Mx,logDislikeSmartSnippet:Px,logOpenSmartSnippetSource:Ux,logOpenSmartSnippetInlineLink:Cp,logOpenSmartSnippetFeedbackModal:jx,logCloseSmartSnippetFeedbackModal:Vx,logSmartSnippetFeedback:_x,logSmartSnippetDetailedFeedback:Lx,logExpandSmartSnippetSuggestion:$x,logCollapseSmartSnippetSuggestion:Qx,logOpenSmartSnippetSuggestionSource:Ip},qp=S("smartSnippet/expand"),xp=S("smartSnippet/collapse"),Ap=S("smartSnippet/like"),Op=S("smartSnippet/dislike"),Fp=S("smartSnippet/feedbackModal/open"),kn=S("smartSnippet/feedbackModal/close"),Rp=S("smartSnippet/related/expand",e=>Aa(e)),Ep=S("smartSnippet/related/collapse",e=>Aa(e)),Qc=(e,t)=>e.findIndex(r=>r.questionAnswerId===t.questionAnswerId);function Dp({question:e,answerSnippet:t,documentId:{contentIdKey:r,contentIdValue:n}}){return Yi({question:e,answerSnippet:t,contentIdKey:r,contentIdValue:n})}function Nx(e,t){let r=Dp(e);return t&&r===t.questionAnswerId?t:{contentIdKey:e.documentId.contentIdKey,contentIdValue:e.documentId.contentIdValue,expanded:!1,questionAnswerId:r}}var Oa=W(wo(),e=>e.addCase(qp,t=>{t.expanded=!0}).addCase(xp,t=>{t.expanded=!1}).addCase(Ap,t=>{t.liked=!0,t.disliked=!1,t.feedbackModalOpen=!1}).addCase(Op,t=>{t.liked=!1,t.disliked=!0}).addCase(Fp,t=>{t.feedbackModalOpen=!0}).addCase(kn,t=>{t.feedbackModalOpen=!1}).addCase(E.fulfilled,(t,r)=>{let n=r.payload.response.questionAnswer.relatedQuestions.map((i,s)=>Nx(i,t.relatedQuestions[s])),a=Dp(r.payload.response.questionAnswer);return t.questionAnswerId===a?{...t,relatedQuestions:n}:{...wo(),relatedQuestions:n,questionAnswerId:a}}).addCase(Rp,(t,r)=>{let n=Qc(t.relatedQuestions,r.payload);n!==-1&&(t.relatedQuestions[n].expanded=!0)}).addCase(Ep,(t,r)=>{let n=Qc(t.relatedQuestions,r.payload);n!==-1&&(t.relatedQuestions[n].expanded=!1)}));function Bx(e,t,r){var c;Hx(e);let n=ne(e),a=()=>e.state,i=()=>yt(a()),s=null,o=cr(e,{options:{selectionDelay:(c=r==null?void 0:r.options)==null?void 0:c.selectionDelay}},()=>{let u=i();if(!u){s=null;return}let{searchResponseId:d}=a().search;s!==d&&(s=d,e.dispatch(t.logOpenSmartSnippetSource()),e.dispatch(cn(u)))});return{...n,get state(){let u=a();return{question:u.search.questionAnswer.question,answer:u.search.questionAnswer.answerSnippet,documentId:u.search.questionAnswer.documentId,expanded:u.questionAnswering.expanded,answerFound:u.search.questionAnswer.answerSnippet!=="",liked:u.questionAnswering.liked,disliked:u.questionAnswering.disliked,feedbackModalOpen:u.questionAnswering.feedbackModalOpen,source:i()}},expand(){e.dispatch(t.logExpandSmartSnippet()),e.dispatch(qp())},collapse(){e.dispatch(t.logCollapseSmartSnippet()),e.dispatch(xp())},like(){e.dispatch(t.logLikeSmartSnippet()),e.dispatch(Ap())},dislike(){e.dispatch(t.logDislikeSmartSnippet()),e.dispatch(Op())},openFeedbackModal(){e.dispatch(t.logOpenSmartSnippetFeedbackModal()),e.dispatch(Fp())},closeFeedbackModal(){e.dispatch(t.logCloseSmartSnippetFeedbackModal()),e.dispatch(kn())},sendFeedback(u){e.dispatch(t.logSmartSnippetFeedback(u)),e.dispatch(kn())},sendDetailedFeedback(u){e.dispatch(t.logSmartSnippetDetailedFeedback(u)),e.dispatch(kn())},selectSource(){o.select()},beginDelayedSelectSource(){o.beginDelayedSelect()},cancelPendingSelectSource(){o.cancelPendingSelect()}}}function Hx(e){return e.addReducers({search:ce,questionAnswering:Oa}),!0}function Tp(e,t){Yx(e);let r=()=>e.state,n=new Set,a=d=>n.has(d)?!0:(n.add(d),!1),i=null,s=d=>{i!==d&&(i=d,c={},n.clear())},o=(d,f,l)=>{var g;return cr(e,{options:{selectionDelay:(g=t==null?void 0:t.options)==null?void 0:g.selectionDelay}},()=>{a(f)||e.dispatch(l?zx({questionAnswerId:l},d):Cp(d))})},c={},u=(d,f)=>{let{searchResponseId:l}=r().search;s(l);let g=Yi({...d,questionAnswerId:f});return g in c||(c[g]=o(d,g,f)),c[g]};return{selectInlineLink(d,f){var l;(l=u(d,f))==null||l.select()},beginDelayedSelectInlineLink(d,f){var l;(l=u(d,f))==null||l.beginDelayedSelect()},cancelPendingSelectInlineLink(d,f){var l;(l=u(d,f))==null||l.cancelPendingSelect()}}}function Yx(e){return e.addReducers({search:ce,questionAnswering:Oa}),!0}function AO(e,t){var a;let r=Bx(e,kp,t),n=Tp(e,{options:{selectionDelay:(a=t==null?void 0:t.options)==null?void 0:a.selectionDelay}});return{...r,get state(){return r.state},selectInlineLink(i){n.selectInlineLink(i)},beginDelayedSelectInlineLink(i){n.beginDelayedSelectInlineLink(i)},cancelPendingSelectInlineLink(i){n.cancelPendingSelectInlineLink(i)}}}function Wx(e,t){Gx(e);let r=ne(e),n=()=>e.state,a=i=>{let{contentIdKey:s,contentIdValue:o}=i;return e.state.search.results.find(c=>rr(c,s)===o)};return{...r,get state(){let i=n();return{questions:i.search.questionAnswer.relatedQuestions.map((s,o)=>({question:s.question,answer:s.answerSnippet,documentId:s.documentId,questionAnswerId:i.questionAnswering.relatedQuestions[o].questionAnswerId,expanded:i.questionAnswering.relatedQuestions[o].expanded,source:a(s.documentId)}))}},expand(i){let s={questionAnswerId:i};e.dispatch(t.logExpandSmartSnippetSuggestion(s)),e.dispatch(Rp(s))},collapse(i){let s={questionAnswerId:i};e.dispatch(t.logCollapseSmartSnippetSuggestion(s)),e.dispatch(Ep(s))}}}function Gx(e){return e.addReducers({search:ce,questionAnswering:Oa}),!0}function Jx(e,t){Kx(e);let r=()=>e.state,n=f=>{let l=r(),g=Et(l,f);return g?yt(l,g.documentId):null},a=new Set,i=f=>a.has(f)?!0:(a.add(f),!1),s=null,o=f=>{s!==f&&(s=f,u={},a.clear())},c=(f,l)=>{var g;return cr(e,{options:{selectionDelay:(g=t==null?void 0:t.options)==null?void 0:g.selectionDelay}},()=>{i(l)||(e.dispatch(Ip({questionAnswerId:l})),e.dispatch(cn(f)))})},u={},d=f=>{let{searchResponseId:l}=r().search;o(l);let g=n(f);return g?(f in u||(u[f]=c(g,f)),u[f]):null};return{selectSource(f){var l;(l=d(f))==null||l.select()},beginDelayedSelectSource(f){var l;(l=d(f))==null||l.beginDelayedSelect()},cancelPendingSelectSource(f){var l;(l=d(f))==null||l.cancelPendingSelect()}}}function Kx(e){return e.addReducers({search:ce,questionAnswering:Oa}),!0}function OO(e,t){var i,s;let r=Wx(e,kp),n=Tp(e,{options:{selectionDelay:(i=t==null?void 0:t.options)==null?void 0:i.selectionDelay}}),a=Jx(e,{options:{selectionDelay:(s=t==null?void 0:t.options)==null?void 0:s.selectionDelay}});return{...r,get state(){return r.state},selectSource(o){a.selectSource(o)},beginDelayedSelectSource(o){a.beginDelayedSelectSource(o)},cancelPendingSelectSource(o){a.cancelPendingSelectSource(o)},selectInlineLink(o,c){n.selectInlineLink(c,o)},beginDelayedSelectInlineLink(o,c){n.beginDelayedSelectInlineLink(c,o)},cancelPendingSelectInlineLink(o,c){n.cancelPendingSelectInlineLink(c,o)}}}var Zx={queries:new re({required:!0,each:new x({emptyAllowed:!1})}),maxLength:new Q({required:!0,min:1,default:10})},Mp=S("recentQueries/registerRecentQueries",e=>I(e,Zx)),Pp=S("recentQueries/clearRecentQueries"),Xx=()=>R("analytics/recentQueries/clear",e=>e.makeClearRecentQueries()),eA=()=>R("analytics/recentQueries/click",e=>e.makeRecentQueryClick()),tA=()=>({actionCause:"recentQueriesClick"}),rA=W(Sh(),e=>{e.addCase(Mp,nA).addCase(Pp,aA).addCase(E.fulfilled,(t,r)=>{let n=r.payload.queryExecuted.trim(),a=r.payload.response.results;!n.length||!a.length||iA(n,t)})});function nA(e,t){e.queries=t.payload.queries.slice(0,t.payload.maxLength),e.maxLength=t.payload.maxLength}function aA(e){e.queries=[]}function iA(e,t){t.queries=t.queries.filter(n=>n!==e);let r=t.queries.slice(0,t.maxLength-1);t.queries=[e,...r]}var sA={queries:[]},oA={maxLength:10,clearFilters:!0},cA=new oe({queries:new re({required:!0})}),uA=new oe({maxLength:new Q({required:!0,min:1}),clearFilters:new K});function lA(e,t){_e(e,uA,t==null?void 0:t.options,"buildRecentQueriesList"),Mt(e,cA,t==null?void 0:t.initialState,"buildRecentQueriesList")}function FO(e,t){dA(e);let r=ne(e),{dispatch:n}=e,a=()=>e.state,i={...oA,...t==null?void 0:t.options},s={...sA,...t==null?void 0:t.initialState};lA(e,{options:i,initialState:s});let o={queries:s.queries,maxLength:i.maxLength};return n(Mp(o)),{...r,get state(){let c=a();return{...c.recentQueries,analyticsEnabled:c.configuration.analytics.enabled}},clear(){n(Xx()),n(Pp())},executeRecentQuery(c){var f;let u=new Q({required:!0,min:0,max:this.state.queries.length}).validate(c);if(u)throw new Error(u);let d={q:this.state.queries[c],clearFilters:i.clearFilters};ts((f=e.state.query)==null?void 0:f.enableQuerySyntax)&&(d.enableQuerySyntax=e.state.query.enableQuerySyntax),n(ed(d)),n(E({legacy:eA(),next:tA()}))}}}function dA(e){return e.addReducers({search:ce,recentQueries:rA}),!0}W(wh(),e=>{e.addCase(ok,(t,r)=>{t.results=r.payload.results.slice(0,r.payload.maxLength),t.maxLength=r.payload.maxLength}).addCase(ck,t=>{t.results=[]}).addCase(cn,(t,r)=>{let n=r.payload;t.results=t.results.filter(i=>i.uniqueId!==n.uniqueId);let a=t.results.slice(0,t.maxLength-1);t.results=[n,...a]})});function RO(e,t){fA(e);let r=l=>{var g;return((g=e.state.facetOptions.facets[l])==null?void 0:g.enabled)??!1},n=l=>{var g,v,p,h,y,k,D,U,_,H,L,N;return((p=(v=(g=e.state.facetSet)==null?void 0:g[l])==null?void 0:v.request)==null?void 0:p.currentValues)??((k=(y=(h=e.state.categoryFacetSet)==null?void 0:h[l])==null?void 0:y.request)==null?void 0:k.currentValues)??((_=(U=(D=e.state.numericFacetSet)==null?void 0:D[l])==null?void 0:U.request)==null?void 0:_.currentValues)??((N=(L=(H=e.state.dateFacetSet)==null?void 0:H[l])==null?void 0:L.request)==null?void 0:N.currentValues)??null},a=l=>l in e.state.facetOptions.facets,i=()=>Yi({isFacetRegistered:a(t.facetId),parentFacets:t.conditions.map(({parentFacetId:l})=>a(l)?{enabled:r(l),values:n(l)}:null)}),s=()=>{let l=i();return l===d?!1:(d=l,!0)},o=()=>t.conditions.some(l=>{if(!r(l.parentFacetId))return!1;let g=n(l.parentFacetId);return g===null?!1:l.condition(g)}),c=()=>{e.state.facetSet&&Object.entries(e.state.facetSet).forEach(([l,g])=>g.request.freezeCurrentValues&&e.dispatch(Nn({facetId:l,freezeCurrentValues:!1})))},u=()=>{if(!a(t.facetId))return;let l=r(t.facetId),g=o();l!==g&&(e.dispatch(g?Ut(t.facetId):He(t.facetId)),c())};if(!t.conditions.length)return{stopWatching(){}};let d=i(),f=e.subscribe(()=>{s()&&u()});return u(),{stopWatching(){f()}}}function fA(e){return e.addReducers({facetOptions:wt}),!0}var pA=W(Ji(),e=>{e.addCase(E.fulfilled,(t,r)=>{var n,a;t.set={},(a=(n=r.payload.response.generateAutomaticFacets)==null?void 0:n.facets)==null||a.forEach(i=>{t.set[i.field]={response:i}})}).addCase(Of,(t,r)=>{r.payload.desiredCount&&(t.desiredCount=r.payload.desiredCount),r.payload.numberOfValues&&(t.numberOfValues=r.payload.numberOfValues)}).addCase(Ia,(t,r)=>{var c;let{field:n,selection:a}=r.payload,i=(c=t.set[n])==null?void 0:c.response;if(!i)return;let s=i.values.find(u=>u.value===a.value);if(!s)return;let o=s.state==="selected";s.state=o?"idle":"selected"}).addCase(Ff,(t,r)=>{var i;let n=r.payload,a=(i=t.set[n])==null?void 0:i.response;if(a)for(let s of a.values)s.state="idle"}).addCase(Ce,(t,r)=>{var i,s;let n=r.payload.af??{},a=Object.keys(t.set);for(let o in n)if(!t.set[o]){let c=gA(o),u=n[o].map(d=>hA(d));c.values.push(...u),t.set[o]={response:c}}for(let o of a)if(!(o in n)){let c=(i=t.set[o])==null?void 0:i.response;for(let u of c.values)u.state="idle"}for(let o in n){let c=(s=t.set[o])==null?void 0:s.response;if(c){let u=c.values;for(let d of u)n[o].includes(d.value)?d.state==="idle"&&(d.state="selected"):d.state="idle"}}}).addCase(me.fulfilled,(t,r)=>{if(r.payload&&Object.keys(r.payload.automaticFacetSet.set).length!==0)return r.payload.automaticFacetSet}).addCase(Be,t=>{Object.values(t.set).forEach(({response:r})=>{r.values.forEach(n=>n.state="idle")})})});function gA(e){return{field:e,values:[],moreValuesAvailable:!1,label:"",indexScore:0}}function hA(e){return{value:e,state:"selected",numberOfResults:0}}function yA(e,t){let{dispatch:r}=e,n=ne(e),{field:a}=t;return{...n,toggleSelect(i){r(Ia({field:a,selection:i})),r(E({legacy:Kd(a,i),next:Zd(i)}))},deselectAll(){r(Ff(a)),r(E({legacy:vt(a),next:St()}))},get state(){var s,o;let i=(o=(s=e.state.automaticFacetSet)==null?void 0:s.set[a])==null?void 0:o.response;return i?{field:i.field,label:i.label,values:i.values}:{field:"",values:[],label:""}}}}function mA(e){return{desiredCount:e.desiredCount,numberOfValues:e.numberOfValues}}function EO(e,t){vA(e);let{dispatch:r}=e,n=mA(t.options);return r(Of(n)),{...ne(e),get state(){var a;return{automaticFacets:((a=e.state.search.response.generateAutomaticFacets)==null?void 0:a.facets.map(i=>yA(e,{field:i.field})))??[]}}}}function vA(e){return e.addReducers({automaticFacetSet:pA,configuration:ie,search:ce}),!0}function Up(e,t){var r,n;return(n=(r=e.generatedAnswer)==null?void 0:r.citations)==null?void 0:n.find(a=>a.id===t)}function Ue(e){var t,r,n;return(n=(r=(t=e.search)==null?void 0:t.response)==null?void 0:r.extendedResults)==null?void 0:n.generativeQuestionAnsweringId}var Ye="RGA",SA=()=>R("analytics/generatedAnswer/retry",e=>e.makeRetryGeneratedAnswer()),wA=e=>R("analytics/generatedAnswer/rephrase",(t,r)=>{let n=Ue(r);return n?t.makeRephraseGeneratedAnswer({generativeQuestionAnsweringId:n,rephraseFormat:e.answerStyle}):null}),bA=e=>R({prefix:"analytics/generatedAnswer/openAnswerSource",__legacy__getBuilder:(t,r)=>{let n=Ue(r),a=Up(r,e);return!n||!a?null:t.makeOpenGeneratedAnswerSource({generativeQuestionAnsweringId:n,permanentId:a.permanentid,citationId:a.id})},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:t=>{var r;return{answer:{responseId:((r=t.search)==null?void 0:r.response.searchUid)||"",type:Ye},citation:{id:e,type:"Source"}}}}),CA=(e,t)=>R({prefix:"analytics/generatedAnswer/hoverCitation",__legacy__getBuilder:(r,n)=>{let a=Ue(n),i=Up(n,e);return!a||!i?null:r.makeGeneratedAnswerSourceHover({generativeQuestionAnsweringId:a,permanentId:i.permanentid,citationId:i.id,citationHoverTimeMs:t})},analyticsType:"Qna.CitationHover",analyticsPayloadBuilder:r=>{var n;return{answer:{responseId:((n=r.search)==null?void 0:n.response.searchUid)||"",type:Ye},citation:{id:e,type:"Source"},citationHoverTimeInMs:t}}}),IA=()=>R({prefix:"analytics/generatedAnswer/like",__legacy__getBuilder:(e,t)=>{let r=Ue(t);return r?e.makeLikeGeneratedAnswer({generativeQuestionAnsweringId:r}):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>{var t;return{answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:Ye},feedback:{liked:!0}}}}),kA=()=>R({prefix:"analytics/generatedAnswer/dislike",__legacy__getBuilder:(e,t)=>{let r=Ue(t);return r?e.makeDislikeGeneratedAnswer({generativeQuestionAnsweringId:r}):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>{var t;return{answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:Ye},feedback:{liked:!1}}}}),qA=e=>R({prefix:"analytics/generatedAnswer/sendFeedback",__legacy__getBuilder:(t,r)=>{let n=Ue(r);return n?t.makeGeneratedAnswerFeedbackSubmit({generativeQuestionAnsweringId:n,reason:e}):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>{var r;return{answer:{responseId:((r=t.search)==null?void 0:r.response.searchUid)||"",type:Ye},feedback:{liked:!1,reason:e}}}}),xA=e=>R({prefix:"analytics/generatedAnswer/sendFeedback",__legacy__getBuilder:(t,r)=>{let n=Ue(r);return n?t.makeGeneratedAnswerFeedbackSubmit({generativeQuestionAnsweringId:n,reason:"other",details:e}):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>{var r;return{answer:{responseId:((r=t.search)==null?void 0:r.response.searchUid)||"",type:Ye},feedback:{liked:!1,reason:"other",details:e}}}}),jp=e=>R("analytics/generatedAnswer/streamEnd",(t,r)=>{var i,s;let n=Ue(r),a=e?!((i=r.generatedAnswer)!=null&&i.answer)||!((s=r.generatedAnswer)!=null&&s.answer.length):void 0;return n?t.makeGeneratedAnswerStreamEnd({generativeQuestionAnsweringId:n,answerGenerated:e,answerTextIsEmpty:a}):null}),AA=()=>R({prefix:"analytics/generatedAnswer/show",__legacy__getBuilder:(e,t)=>{let r=Ue(t);return r?e.makeGeneratedAnswerShowAnswers({generativeQuestionAnsweringId:r}):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>{var t;return{action:"show",answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:Ye}}}}),OA=()=>R({prefix:"analytics/generatedAnswer/hide",__legacy__getBuilder:(e,t)=>{let r=Ue(t);return r?e.makeGeneratedAnswerHideAnswers({generativeQuestionAnsweringId:r}):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>{var t;return{action:"hide",answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:Ye}}}}),FA=()=>R({prefix:"analytics/generatedAnswer/expand",__legacy__getBuilder:(e,t)=>{let r=Ue(t);return r?e.makeGeneratedAnswerExpand({generativeQuestionAnsweringId:r}):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>{var t;return{action:"expand",answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:Ye}}}}),RA=()=>R({prefix:"analytics/generatedAnswer/collapse",__legacy__getBuilder:(e,t)=>{let r=Ue(t);return r?e.makeGeneratedAnswerCollapse({generativeQuestionAnsweringId:r}):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>{var t;return{action:"collapse",answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:Ye}}}}),EA=()=>R({prefix:"analytics/generatedAnswer/copy",__legacy__getBuilder:(e,t)=>{let r=Ue(t);return r?e.makeGeneratedAnswerCopyToClipboard({generativeQuestionAnsweringId:r}):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>{var t;return{action:"copyToClipboard",answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:Ye}}}}),qn={logCopyGeneratedAnswer:EA,logGeneratedAnswerHideAnswers:OA,logGeneratedAnswerShowAnswers:AA,logGeneratedAnswerStreamEnd:jp,logGeneratedAnswerDetailedFeedback:xA,logGeneratedAnswerFeedback:qA,logDislikeGeneratedAnswer:kA,logLikeGeneratedAnswer:IA,logHoverCitation:CA,logOpenGeneratedAnswerSource:bA,logRetryGeneratedAnswer:SA,logRephraseGeneratedAnswer:wA,logGeneratedAnswerExpand:FA,logGeneratedAnswerCollapse:RA},DA=async e=>{var t;return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.platformUrl,streamId:(t=e.search.extendedResults)==null?void 0:t.generativeQuestionAnsweringId}},TA=["default","bullet","step","concise"],MA=["text/plain","text/markdown"],vr=new x({required:!0}),Vp=new x,Fa=new K({required:!0}),PA={id:vr,title:vr,uri:vr,permanentid:vr,clickUri:Vp},_p=new x({required:!0,constrainTo:MA}),xn=S("generatedAnswer/setIsVisible",e=>I(e,Fa)),Lp=S("generatedAnswer/updateMessage",e=>I(e,{textDelta:vr})),$p=S("generatedAnswer/updateCitations",e=>I(e,{citations:new re({required:!0,each:new P({values:PA})})})),Qp=S("generatedAnswer/updateError",e=>I(e,{message:Vp,code:new Q({min:0})})),po=S("generatedAnswer/resetAnswer"),zp=S("generatedAnswer/like"),Np=S("generatedAnswer/dislike"),Bp=S("generatedAnswer/feedbackModal/open"),$i=S("generatedAnswer/expand"),Hp=S("generatedAnswer/collapse"),Yp=S("generatedAnswer/setId",e=>I(e,{id:new x({required:!0})})),Wp=S("generatedAnswer/feedbackModal/close"),Qi=S("generatedAnswer/sendFeedback"),An=S("generatedAnswer/setIsLoading",e=>I(e,Fa)),zi=S("generatedAnswer/setIsStreaming",e=>I(e,Fa)),Gp=S("generatedAnswer/setAnswerContentFormat",e=>I(e,_p)),Ni=S("generatedAnswer/updateResponseFormat",e=>I(e,{answerStyle:new x({required:!0,constrainTo:TA}),contentFormat:new re({each:_p,default:["text/plain"]})})),Jp=S("generatedAnswer/registerFieldsToIncludeInCitations",e=>I(e,Vu)),Kp=S("generatedAnswer/setIsAnswerGenerated",e=>I(e,Fa)),UA=B("generatedAnswer/streamAnswer",async(e,t)=>{var d;let r=t.getState(),{dispatch:n,extra:a}=t,{setAbortControllerRef:i}=e,s=await DA(r),o=(f,l)=>{switch(f){case"genqa.headerMessageType":{let g=JSON.parse(l);n(Gp(g.contentFormat));break}case"genqa.messageType":n(Lp(JSON.parse(l)));break;case"genqa.citationsType":n($p(JSON.parse(l)));break;case"genqa.endOfStreamType":{let g=JSON.parse(l).answerGenerated;n(zi(!1)),n(Kp(g)),n(jp(g));break}default:r.debug&&a.logger.warn(`Unknown payloadType: "${f}"`)}};n(An(!0));let c=f=>f.streamId===t.getState().search.extendedResults.generativeQuestionAnsweringId,u=(d=a.streamingClient)==null?void 0:d.streamGeneratedAnswer(s,{write:f=>{c(s)&&(n(An(!1)),f.payload&&f.payloadType&&o(f.payloadType,f.payload))},abort:f=>{c(s)&&n(Qp(f))},close:()=>{c(s)&&n(zi(!1))},resetAnswer:()=>{c(s)&&n(po())}});u?i(u):n(An(!1))}),jA=W(So(),e=>e.addCase(xn,(t,{payload:r})=>{t.isVisible=r}).addCase(Yp,(t,{payload:r})=>{t.id=r.id}).addCase(Lp,(t,{payload:r})=>{t.isLoading=!1,t.isStreaming=!0,t.answer||(t.answer=""),t.answer+=r.textDelta,delete t.error}).addCase($p,(t,{payload:r})=>{t.isLoading=!1,t.isStreaming=!0,t.citations=t.citations.concat(r.citations),delete t.error}).addCase(Qp,(t,{payload:r})=>{t.isLoading=!1,t.isStreaming=!1,t.error={...r,isRetryable:r.code===Pu},t.citations=[],delete t.answer}).addCase(zp,t=>{t.liked=!0,t.disliked=!1}).addCase(Np,t=>{t.liked=!1,t.disliked=!0}).addCase(Bp,t=>{t.feedbackModalOpen=!0}).addCase(Wp,t=>{t.feedbackModalOpen=!1}).addCase(Qi,t=>{t.feedbackSubmitted=!0}).addCase(po,t=>({...So(),responseFormat:t.responseFormat,fieldsToIncludeInCitations:t.fieldsToIncludeInCitations,isVisible:t.isVisible,id:t.id})).addCase(An,(t,{payload:r})=>{t.isLoading=r}).addCase(zi,(t,{payload:r})=>{t.isStreaming=r}).addCase(Gp,(t,{payload:r})=>{t.answerContentFormat=r}).addCase(Ni,(t,{payload:r})=>{t.responseFormat=r}).addCase(Jp,(t,r)=>{t.fieldsToIncludeInCitations=[...new Set(t.fieldsToIncludeInCitations.concat(r.payload))]}).addCase(Kp,(t,{payload:r})=>{t.isAnswerGenerated=r}).addCase($i,t=>{t.expanded=!0}).addCase(Hp,t=>{t.expanded=!1})),De={engines:{},setAbortControllerRef:(e,t)=>{De.engines[t].abortController=e},getIsStreamInProgress:e=>{var t;return!De.engines[e].abortController||(t=De.engines[e].abortController)!=null&&t.signal.aborted?(De.engines[e].abortController=void 0,!1):!0},subscribeToSearchRequests:e=>{let t=()=>{var s;let r=e.state,n=r.search.requestId,a=r.search.extendedResults.generativeQuestionAnsweringId,i=r.generatedAnswer.id;De.engines[i].lastRequestId!==n&&(De.engines[i].lastRequestId=n,(s=De.engines[i].abortController)==null||s.abort(),e.dispatch(po())),!De.getIsStreamInProgress(i)&&a&&a!==De.engines[i].lastStreamId&&(De.engines[i].lastStreamId=a,e.dispatch(UA({setAbortControllerRef:o=>De.setAbortControllerRef(o,i)})))};return e.subscribe(t)}};function VA(e,t,r={}){var u,d,f;_A(e);let{dispatch:n}=e,a=ne(e),i=()=>e.state;if(!e.state.generatedAnswer.id){let l=Gn("genQA-",12);n(Yp({id:l})),De.engines[l]={abortController:void 0,lastRequestId:"",lastStreamId:""}}let s=(u=r.initialState)==null?void 0:u.isVisible;s!==void 0&&n(xn(s));let o=(d=r.initialState)==null?void 0:d.responseFormat;o&&n(Ni(o));let c=r.fieldsToIncludeInCitations;return c&&n(Jp(c)),(f=r.initialState)!=null&&f.expanded&&n($i()),De.subscribeToSearchRequests(e),{...a,get state(){return i().generatedAnswer},like(){this.state.liked||(n(zp()),n(t.logLikeGeneratedAnswer()))},dislike(){this.state.disliked||(n(Np()),n(t.logDislikeGeneratedAnswer()))},openFeedbackModal(){n(Bp())},closeFeedbackModal(){n(Wp())},sendFeedback(l){n(t.logGeneratedAnswerFeedback(l)),n(Qi())},sendDetailedFeedback(l){n(t.logGeneratedAnswerDetailedFeedback(l)),n(Qi())},logCitationClick(l){n(t.logOpenGeneratedAnswerSource(l))},logCitationHover(l,g){n(t.logHoverCitation(l,g))},rephrase(l){n(Ni(l))},show(){this.state.isVisible||(n(xn(!0)),n(t.logGeneratedAnswerShowAnswers()))},hide(){this.state.isVisible&&(n(xn(!1)),n(t.logGeneratedAnswerHideAnswers()))},expand(){this.state.expanded||(n($i()),n(t.logGeneratedAnswerExpand()))},collapse(){this.state.expanded&&(n(Hp()),n(t.logGeneratedAnswerCollapse()))},logCopyToClipboard(){n(t.logCopyGeneratedAnswer())},retry(){}}}function _A(e){return e.addReducers({generatedAnswer:jA}),!0}function DO(e,t={}){let{dispatch:r}=e,n=VA(e,qn,t);return{...n,get state(){return n.state},retry(){r(E({legacy:qn.logRetryGeneratedAnswer()}))},rephrase(a){n.rephrase(a),r(E({legacy:qn.logRephraseGeneratedAnswer(a)}))}}}function LA(e,t,r){let n=!1,a=()=>{n||(n=!0,e.dispatch(t.logOpenGeneratedAnswerSource(r.options.citation.id)))};return cr(e,r,()=>{a()})}function TO(e,t){return LA(e,qn,t)}var dt=()=>new x({required:!1,emptyAllowed:!0}),$A=S("advancedSearchQueries/update",e=>I(e,{aq:dt(),cq:dt(),lq:dt(),dq:dt()})),QA=S("advancedSearchQueries/register",e=>I(e,{aq:dt(),cq:dt(),lq:dt(),dq:dt()}));W(At(),e=>{e.addCase($A,(t,r)=>{let{aq:n,cq:a,lq:i,dq:s}=r.payload;ve(n)||(t.aq=n,t.aqWasSet=!0),ve(a)||(t.cq=a,t.cqWasSet=!0),ve(i)||(t.lq=i,t.lqWasSet=!0),ve(s)||(t.dq=s,t.dqWasSet=!0)}).addCase(QA,(t,r)=>{let{aq:n,cq:a,lq:i,dq:s}=r.payload;ve(n)||(t.defaultFilters.aq=n,t.aqWasSet||(t.aq=n)),ve(a)||(t.defaultFilters.cq=a,t.cqWasSet||(t.cq=a)),ve(i)||(t.defaultFilters.lq=i,t.lqWasSet||(t.lq=i)),ve(s)||(t.defaultFilters.dq=s,t.dqWasSet||(t.dq=s))}).addCase(me.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.advancedSearchQueries)??t}).addCase(Ce,(t,r)=>{let{aq:n,cq:a}=r.payload;ve(n)||(t.aq=n,t.aqWasSet=!0),ve(a)||(t.cq=a,t.cqWasSet=!0)})});function MO(e){return e.addReducers({configuration:ie,pipeline:Al,searchHub:Fl}),{updateSearchConfiguration:er}}function PO(e){return e.addReducers({dateFacetSet:sn}),{deselectAllDateFacetValues:zd,registerDateFacet:Xr,toggleSelectDateFacetValue:en,toggleExcludeDateFacetValue:tn,updateDateFacetSortCriterion:Qd,updateDateFacetValues:Tr}}function UO(e){return e.addReducers({fields:Es}),{registerFieldsToInclude:ga,enableFetchAllFields:ld,disableFetchAllFields:dd,fetchFieldsDescription:fd}}function jO(e){return e.addReducers({numericFacetSet:sr}),{deselectAllNumericFacetValues:Bd,registerNumericFacet:rn,toggleSelectNumericFacetValue:nn,toggleExcludeNumericFacetValue:an,updateNumericFacetSortCriterion:Nd,updateNumericFacetValues:Mr}}function VO(e){return e.addReducers({query:un}),{updateQuery:mt}}function _O(e){return e.addReducers({querySuggest:uo,querySet:Lf}),{clearQuerySuggest:Sr,fetchQuerySuggestions:wr,registerQuerySuggest:Qs,selectQuerySuggestion:Br}}var zA=S("excerptLength/set",e=>I(e,new Q({min:0,required:!0})));W(Xg(),e=>{e.addCase(zA,(t,r)=>{t.length=r.payload})});var NA=new oe({content:new he({required:!0}),conditions:new he({required:!0}),priority:new Q({required:!1,default:0,min:0}),fields:new re({required:!1,each:T})});function BA(){let e=[],t=r=>{let n=NA.validate(r);if(!r.conditions.every(a=>a instanceof Function))throw new Xn("Each template condition should be a function that takes a Result or Product as an argument and returns a boolean");return n};return{registerTemplates(...r){r.forEach(n=>{let a={...t(n),fields:n.fields||[]};e.push(a)}),e.sort((n,a)=>a.priority-n.priority)},selectTemplate(r){let n=e.find(a=>a.conditions.every(i=>i(r)));return n?n.content:null}}}function LO(e){HA(e);let{registerTemplates:t,selectTemplate:r}=BA();return{registerTemplates:(...n)=>{t(...n);let a=[];n.forEach(i=>{i.fields&&a.push(...i.fields)}),e.dispatch(ga(a))},selectTemplate:r}}function HA(e){return e.addReducers({fields:Es}),!0}var YA=B("analytics/addPageViewEntry",async(e,{getState:t})=>{t().configuration.analytics.enabled&&Pt.addElement({name:"PageView",value:e,time:JSON.stringify(new Date)})});function $O(e){return e.addReducers({}),{addPageViewEntryInActionsHistory:YA}}function WA(e){let{by:t,order:r}=e;switch(t){case"relevancy":return pu();case"qre":return gh();case"nosort":return hh();case"date":if(!r)throw new Error('An order (i.e., ascending or descending) should be specified for a sort criterion sorted by "date"');return fh(r);default:if(!r)throw new Error(`An order (i.e., ascending or descending) should be specified for a sort criterion sorted by a field, such as "${t}"`);return ph(t,r)}}function GA(e){return e===void 0||e==="ascending"||e==="descending"}function QO(e){let t=e.split(","),r=new Error(`Wrong criterion expression format for "${e}"`);if(!t.length)throw r;return t.map(n=>{let a=n.trim().split(" "),i=a[0].toLowerCase(),s=a[1]&&a[1].toLowerCase();if(a.length>2||i==="")throw r;if(!GA(s))throw new Error(`Wrong criterion sort order "${s}" in expression "${e}". Order should either be "ascending" or "descending"`);return WA({by:i,order:s})})}qg();export{XA as $,yO as A,QO as B,cO as C,_O as D,FO as E,xk as F,wO as G,ls as H,rO as I,ws as J,kO as K,hO as L,ZA as M,MO as N,jO as O,SO as P,AO as Q,uO as R,vO as S,tO as T,dO as U,VO as V,fO as W,gO as X,JA as Y,UO as Z,bO as _,DO as a,EO as b,$d as c,lO as d,OO as e,aO as f,IC as g,$O as h,oO as i,LO as j,KA as k,RO as l,sO as m,nO as n,PO as o,CO as p,Yg as q,eO as r,iO as s,qO as t,Ih as u,TO as v,mO as w,pO as x,xO as y,IO as z};
