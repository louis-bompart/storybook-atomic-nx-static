/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fo=Object.create,Tt=Object.defineProperty,po=Object.getOwnPropertyDescriptor,go=Object.getOwnPropertyNames,mo=Object.getPrototypeOf,yo=Object.prototype.hasOwnProperty,vo=(e,t,r)=>t in e?Tt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,wo=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),ee=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),So=(e,t)=>{for(var r in t)Tt(e,r,{get:t[r],enumerable:!0})},bo=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of go(t))!yo.call(e,i)&&i!==r&&Tt(e,i,{get:()=>t[i],enumerable:!(n=po(t,i))||n.enumerable});return e},be=(e,t,r)=>(r=e!=null?fo(mo(e)):{},bo(!e||!e.__esModule?Tt(r,"default",{value:e,enumerable:!0}):r,e)),Zn=(e,t,r)=>vo(e,t+"",r),ko=ee((e,t)=>{function r(a){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");if(a=`${a}`,a=a.replace(/[ \t\n\f\r]/g,""),a.length%4===0&&(a=a.replace(/==?$/,"")),a.length%4===1||/[^+/0-9A-Za-z]/.test(a))return null;let o="",s=0,u=0;for(let c=0;c<a.length;c++)s<<=6,s|=i(a[c]),u+=6,u===24&&(o+=String.fromCharCode((s&16711680)>>16),o+=String.fromCharCode((s&65280)>>8),o+=String.fromCharCode(s&255),s=u=0);return u===12?(s>>=4,o+=String.fromCharCode(s)):u===18&&(s>>=2,o+=String.fromCharCode((s&65280)>>8),o+=String.fromCharCode(s&255)),o}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function i(a){let o=n.indexOf(a);return o<0?void 0:o}t.exports=r}),Co=ee((e,t)=>{function r(a){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");let o;for(a=`${a}`,o=0;o<a.length;o++)if(a.charCodeAt(o)>255)return null;let s="";for(o=0;o<a.length;o+=3){let u=[void 0,void 0,void 0,void 0];u[0]=a.charCodeAt(o)>>2,u[1]=(a.charCodeAt(o)&3)<<4,a.length>o+1&&(u[1]|=a.charCodeAt(o+1)>>4,u[2]=(a.charCodeAt(o+1)&15)<<2),a.length>o+2&&(u[2]|=a.charCodeAt(o+2)>>6,u[3]=a.charCodeAt(o+2)&63);for(let c=0;c<u.length;c++)typeof u[c]>"u"?s+="=":s+=i(u[c])}return s}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function i(a){if(a>=0&&a<64)return n[a]}t.exports=r}),Io=ee((e,t)=>{var r=ko(),n=Co();t.exports={atob:r,btoa:n}}),Oo=ee((e,t)=>{t.exports=fetch}),qo=ee(e=>{var t=e&&e.__assign||function(){return t=Object.assign||function(i){for(var a,o=1,s=arguments.length;o<s;o++){a=arguments[o];for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&(i[u]=a[u])}return i},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var r={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};function n(i){var a=t(t({},r),i);return a.numOfAttempts<1&&(a.numOfAttempts=1),a}e.getSanitizedOptions=n}),Ao=ee(e=>{Object.defineProperty(e,"__esModule",{value:!0});function t(r){var n=Math.random()*r;return Math.round(n)}e.fullJitter=t}),Eo=ee(e=>{Object.defineProperty(e,"__esModule",{value:!0});function t(r){return r}e.noJitter=t}),Do=ee(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Ao(),r=Eo();function n(i){switch(i.jitter){case"full":return t.fullJitter;case"none":default:return r.noJitter}}e.JitterFactory=n}),Xn=ee(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Do(),r=function(){function n(i){this.options=i,this.attempt=0}return n.prototype.apply=function(){var i=this;return new Promise(function(a){return setTimeout(a,i.jitteredDelay)})},n.prototype.setAttemptNumber=function(i){this.attempt=i},Object.defineProperty(n.prototype,"jitteredDelay",{get:function(){var i=t.JitterFactory(this.options);return i(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"delay",{get:function(){var i=this.options.startingDelay,a=this.options.timeMultiple,o=this.numOfDelayedAttempts,s=i*Math.pow(a,o);return Math.min(s,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),n}();e.Delay=r}),Ro=ee(e=>{var t=e&&e.__extends||function(){var o=function(s,u){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var f in d)d.hasOwnProperty(f)&&(c[f]=d[f])},o(s,u)};return function(s,u){o(s,u);function c(){this.constructor=s}s.prototype=u===null?Object.create(u):(c.prototype=u.prototype,new c)}}(),r=e&&e.__awaiter||function(o,s,u,c){function d(f){return f instanceof u?f:new u(function(p){p(f)})}return new(u||(u=Promise))(function(f,p){function w(g){try{l(c.next(g))}catch(S){p(S)}}function C(g){try{l(c.throw(g))}catch(S){p(S)}}function l(g){g.done?f(g.value):d(g.value).then(w,C)}l((c=c.apply(o,s||[])).next())})},n=e&&e.__generator||function(o,s){var u={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},c,d,f,p;return p={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function w(l){return function(g){return C([l,g])}}function C(l){if(c)throw new TypeError("Generator is already executing.");for(;u;)try{if(c=1,d&&(f=l[0]&2?d.return:l[0]?d.throw||((f=d.return)&&f.call(d),0):d.next)&&!(f=f.call(d,l[1])).done)return f;switch(d=0,f&&(l=[l[0]&2,f.value]),l[0]){case 0:case 1:f=l;break;case 4:return u.label++,{value:l[1],done:!1};case 5:u.label++,d=l[1],l=[0];continue;case 7:l=u.ops.pop(),u.trys.pop();continue;default:if(f=u.trys,!(f=f.length>0&&f[f.length-1])&&(l[0]===6||l[0]===2)){u=0;continue}if(l[0]===3&&(!f||l[1]>f[0]&&l[1]<f[3])){u.label=l[1];break}if(l[0]===6&&u.label<f[1]){u.label=f[1],f=l;break}if(f&&u.label<f[2]){u.label=f[2],u.ops.push(l);break}f[2]&&u.ops.pop(),u.trys.pop();continue}l=s.call(o,u)}catch(g){l=[6,g],d=0}finally{c=f=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var i=Xn(),a=function(o){t(s,o);function s(){return o!==null&&o.apply(this,arguments)||this}return s.prototype.apply=function(){return r(this,void 0,void 0,function(){return n(this,function(u){return[2,this.isFirstAttempt?!0:o.prototype.apply.call(this)]})})},Object.defineProperty(s.prototype,"isFirstAttempt",{get:function(){return this.attempt===0},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),s}(i.Delay);e.SkipFirstDelay=a}),xo=ee(e=>{var t=e&&e.__extends||function(){var i=function(a,o){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,u){s.__proto__=u}||function(s,u){for(var c in u)u.hasOwnProperty(c)&&(s[c]=u[c])},i(a,o)};return function(a,o){i(a,o);function s(){this.constructor=a}a.prototype=o===null?Object.create(o):(s.prototype=o.prototype,new s)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=Xn(),n=function(i){t(a,i);function a(){return i!==null&&i.apply(this,arguments)||this}return a}(r.Delay);e.AlwaysDelay=n}),Uo=ee(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Ro(),r=xo();function n(a,o){var s=i(a);return s.setAttemptNumber(o),s}e.DelayFactory=n;function i(a){return a.delayFirstAttempt?new r.AlwaysDelay(a):new t.SkipFirstDelay(a)}}),Fo=ee(e=>{var t=e&&e.__awaiter||function(s,u,c,d){function f(p){return p instanceof c?p:new c(function(w){w(p)})}return new(c||(c=Promise))(function(p,w){function C(S){try{g(d.next(S))}catch(q){w(q)}}function l(S){try{g(d.throw(S))}catch(q){w(q)}}function g(S){S.done?p(S.value):f(S.value).then(C,l)}g((d=d.apply(s,u||[])).next())})},r=e&&e.__generator||function(s,u){var c={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},d,f,p,w;return w={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function C(g){return function(S){return l([g,S])}}function l(g){if(d)throw new TypeError("Generator is already executing.");for(;c;)try{if(d=1,f&&(p=g[0]&2?f.return:g[0]?f.throw||((p=f.return)&&p.call(f),0):f.next)&&!(p=p.call(f,g[1])).done)return p;switch(f=0,p&&(g=[g[0]&2,p.value]),g[0]){case 0:case 1:p=g;break;case 4:return c.label++,{value:g[1],done:!1};case 5:c.label++,f=g[1],g=[0];continue;case 7:g=c.ops.pop(),c.trys.pop();continue;default:if(p=c.trys,!(p=p.length>0&&p[p.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!p||g[1]>p[0]&&g[1]<p[3])){c.label=g[1];break}if(g[0]===6&&c.label<p[1]){c.label=p[1],p=g;break}if(p&&c.label<p[2]){c.label=p[2],c.ops.push(g);break}p[2]&&c.ops.pop(),c.trys.pop();continue}g=u.call(s,c)}catch(S){g=[6,S],f=0}finally{d=p=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var n=qo(),i=Uo();function a(s,u){return u===void 0&&(u={}),t(this,void 0,void 0,function(){var c,d;return r(this,function(f){switch(f.label){case 0:return c=n.getSanitizedOptions(u),d=new o(s,c),[4,d.execute()];case 1:return[2,f.sent()]}})})}e.backOff=a;var o=function(){function s(u,c){this.request=u,this.options=c,this.attemptNumber=0}return s.prototype.execute=function(){return t(this,void 0,void 0,function(){var u,c;return r(this,function(d){switch(d.label){case 0:if(this.attemptLimitReached)return[3,7];d.label=1;case 1:return d.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return d.sent(),[4,this.request()];case 3:return[2,d.sent()];case 4:return u=d.sent(),this.attemptNumber++,[4,this.options.retry(u,this.attemptNumber)];case 5:if(c=d.sent(),!c||this.attemptLimitReached)throw u;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}})})},Object.defineProperty(s.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),s.prototype.applyDelay=function(){return t(this,void 0,void 0,function(){var u;return r(this,function(c){switch(c.label){case 0:return u=i.DelayFactory(this.options,this.attemptNumber),[4,u.apply()];case 1:return c.sent(),[2]}})})},s}()}),Mo=ee((e,t)=>{var r=typeof self<"u"?self:typeof window<"u"?window:void 0;if(!r)throw new Error("Unable to find global scope. Are you sure this is running in the browser?");if(!r.AbortController)throw new Error('Could not find "AbortController" in the global scope. You need to polyfill it first');t.exports.AbortController=r.AbortController}),To=ee((e,t)=>{var r=/(^|; )Coveo-Pendragon=([^;]*)/;t.exports=()=>{var n;return((n=r.exec(document.cookie))==null?void 0:n.pop())||null}}),Ar=ee((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs=n()})(e,function(){var r=1e3,n=6e4,i=36e5,a="millisecond",o="second",s="minute",u="hour",c="day",d="week",f="month",p="quarter",w="year",C="date",l="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,S=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,q={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(x){var A=["th","st","nd","rd"],I=x%100;return"["+x+(A[(I-20)%10]||A[I]||A[0])+"]"}},M=function(x,A,I){var h=String(x);return!h||h.length>=A?x:""+Array(A+1-h.length).join(I)+x},z={s:M,z:function(x){var A=-x.utcOffset(),I=Math.abs(A),h=Math.floor(I/60),y=I%60;return(A<=0?"+":"-")+M(h,2,"0")+":"+M(y,2,"0")},m:function x(A,I){if(A.date()<I.date())return-x(I,A);var h=12*(I.year()-A.year())+(I.month()-A.month()),y=A.clone().add(h,f),b=I-y<0,O=A.clone().add(h+(b?-1:1),f);return+(-(h+(I-y)/(b?y-O:O-y))||0)},a:function(x){return x<0?Math.ceil(x)||0:Math.floor(x)},p:function(x){return{M:f,y:w,w:d,d:c,D:C,h:u,m:s,s:o,ms:a,Q:p}[x]||String(x||"").toLowerCase().replace(/s$/,"")},u:function(x){return x===void 0}},_="en",W={};W[_]=q;var P="$isDayjsObject",G=function(x){return x instanceof ie||!(!x||!x[P])},J=function x(A,I,h){var y;if(!A)return _;if(typeof A=="string"){var b=A.toLowerCase();W[b]&&(y=b),I&&(W[b]=I,y=b);var O=A.split("-");if(!y&&O.length>1)return x(O[0])}else{var D=A.name;W[D]=A,y=D}return!h&&y&&(_=y),y||!h&&_},$=function(x,A){if(G(x))return x.clone();var I=typeof A=="object"?A:{};return I.date=x,I.args=arguments,new ie(I)},F=z;F.l=J,F.i=G,F.w=function(x,A){return $(x,{locale:A.$L,utc:A.$u,x:A.$x,$offset:A.$offset})};var ie=function(){function x(I){this.$L=J(I.locale,null,!0),this.parse(I),this.$x=this.$x||I.x||{},this[P]=!0}var A=x.prototype;return A.parse=function(I){this.$d=function(h){var y=h.date,b=h.utc;if(y===null)return new Date(NaN);if(F.u(y))return new Date;if(y instanceof Date)return new Date(y);if(typeof y=="string"&&!/Z$/i.test(y)){var O=y.match(g);if(O){var D=O[2]-1||0,j=(O[7]||"0").substring(0,3);return b?new Date(Date.UTC(O[1],D,O[3]||1,O[4]||0,O[5]||0,O[6]||0,j)):new Date(O[1],D,O[3]||1,O[4]||0,O[5]||0,O[6]||0,j)}}return new Date(y)}(I),this.init()},A.init=function(){var I=this.$d;this.$y=I.getFullYear(),this.$M=I.getMonth(),this.$D=I.getDate(),this.$W=I.getDay(),this.$H=I.getHours(),this.$m=I.getMinutes(),this.$s=I.getSeconds(),this.$ms=I.getMilliseconds()},A.$utils=function(){return F},A.isValid=function(){return this.$d.toString()!==l},A.isSame=function(I,h){var y=$(I);return this.startOf(h)<=y&&y<=this.endOf(h)},A.isAfter=function(I,h){return $(I)<this.startOf(h)},A.isBefore=function(I,h){return this.endOf(h)<$(I)},A.$g=function(I,h,y){return F.u(I)?this[h]:this.set(y,I)},A.unix=function(){return Math.floor(this.valueOf()/1e3)},A.valueOf=function(){return this.$d.getTime()},A.startOf=function(I,h){var y=this,b=!!F.u(h)||h,O=F.p(I),D=function(ye,re){var pe=F.w(y.$u?Date.UTC(y.$y,re,ye):new Date(y.$y,re,ye),y);return b?pe:pe.endOf(c)},j=function(ye,re){return F.w(y.toDate()[ye].apply(y.toDate("s"),(b?[0,0,0,0]:[23,59,59,999]).slice(re)),y)},N=this.$W,V=this.$M,B=this.$D,R="set"+(this.$u?"UTC":"");switch(O){case w:return b?D(1,0):D(31,11);case f:return b?D(1,V):D(0,V+1);case d:var Z=this.$locale().weekStart||0,de=(N<Z?N+7:N)-Z;return D(b?B-de:B+(6-de),V);case c:case C:return j(R+"Hours",0);case u:return j(R+"Minutes",1);case s:return j(R+"Seconds",2);case o:return j(R+"Milliseconds",3);default:return this.clone()}},A.endOf=function(I){return this.startOf(I,!1)},A.$set=function(I,h){var y,b=F.p(I),O="set"+(this.$u?"UTC":""),D=(y={},y[c]=O+"Date",y[C]=O+"Date",y[f]=O+"Month",y[w]=O+"FullYear",y[u]=O+"Hours",y[s]=O+"Minutes",y[o]=O+"Seconds",y[a]=O+"Milliseconds",y)[b],j=b===c?this.$D+(h-this.$W):h;if(b===f||b===w){var N=this.clone().set(C,1);N.$d[D](j),N.init(),this.$d=N.set(C,Math.min(this.$D,N.daysInMonth())).$d}else D&&this.$d[D](j);return this.init(),this},A.set=function(I,h){return this.clone().$set(I,h)},A.get=function(I){return this[F.p(I)]()},A.add=function(I,h){var y,b=this;I=Number(I);var O=F.p(h),D=function(V){var B=$(b);return F.w(B.date(B.date()+Math.round(V*I)),b)};if(O===f)return this.set(f,this.$M+I);if(O===w)return this.set(w,this.$y+I);if(O===c)return D(1);if(O===d)return D(7);var j=(y={},y[s]=n,y[u]=i,y[o]=r,y)[O]||1,N=this.$d.getTime()+I*j;return F.w(N,this)},A.subtract=function(I,h){return this.add(-1*I,h)},A.format=function(I){var h=this,y=this.$locale();if(!this.isValid())return y.invalidDate||l;var b=I||"YYYY-MM-DDTHH:mm:ssZ",O=F.z(this),D=this.$H,j=this.$m,N=this.$M,V=y.weekdays,B=y.months,R=y.meridiem,Z=function(re,pe,X,ge){return re&&(re[pe]||re(h,b))||X[pe].slice(0,ge)},de=function(re){return F.s(D%12||12,re,"0")},ye=R||function(re,pe,X){var ge=re<12?"AM":"PM";return X?ge.toLowerCase():ge};return b.replace(S,function(re,pe){return pe||function(X){switch(X){case"YY":return String(h.$y).slice(-2);case"YYYY":return F.s(h.$y,4,"0");case"M":return N+1;case"MM":return F.s(N+1,2,"0");case"MMM":return Z(y.monthsShort,N,B,3);case"MMMM":return Z(B,N);case"D":return h.$D;case"DD":return F.s(h.$D,2,"0");case"d":return String(h.$W);case"dd":return Z(y.weekdaysMin,h.$W,V,2);case"ddd":return Z(y.weekdaysShort,h.$W,V,3);case"dddd":return V[h.$W];case"H":return String(D);case"HH":return F.s(D,2,"0");case"h":return de(1);case"hh":return de(2);case"a":return ye(D,j,!0);case"A":return ye(D,j,!1);case"m":return String(j);case"mm":return F.s(j,2,"0");case"s":return String(h.$s);case"ss":return F.s(h.$s,2,"0");case"SSS":return F.s(h.$ms,3,"0");case"Z":return O}return null}(re)||O.replace(":","")})},A.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},A.diff=function(I,h,y){var b,O=this,D=F.p(h),j=$(I),N=(j.utcOffset()-this.utcOffset())*n,V=this-j,B=function(){return F.m(O,j)};switch(D){case w:b=B()/12;break;case f:b=B();break;case p:b=B()/3;break;case d:b=(V-N)/6048e5;break;case c:b=(V-N)/864e5;break;case u:b=V/i;break;case s:b=V/n;break;case o:b=V/r;break;default:b=V}return y?b:F.a(b)},A.daysInMonth=function(){return this.endOf(f).$D},A.$locale=function(){return W[this.$L]},A.locale=function(I,h){if(!I)return this.$L;var y=this.clone(),b=J(I,h,!0);return b&&(y.$L=b),y},A.clone=function(){return F.w(this.$d,this)},A.toDate=function(){return new Date(this.valueOf())},A.toJSON=function(){return this.isValid()?this.toISOString():null},A.toISOString=function(){return this.$d.toISOString()},A.toString=function(){return this.$d.toUTCString()},x}(),me=ie.prototype;return $.prototype=me,[["$ms",a],["$s",o],["$m",s],["$H",u],["$W",c],["$M",f],["$y",w],["$D",C]].forEach(function(x){me[x[1]]=function(A){return this.$g(A,x[0],x[1])}}),$.extend=function(x,A){return x.$i||(x(A,ie,$),x.$i=!0),$},$.locale=J,$.isDayjs=G,$.unix=function(x){return $(1e3*x)},$.en=W[_],$.Ls=W,$.p={},$})}),_o=ee((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_timezone=n()})(e,function(){var r={year:0,month:1,day:2,hour:3,minute:4,second:5},n={};return function(i,a,o){var s,u=function(p,w,C){C===void 0&&(C={});var l=new Date(p),g=function(S,q){q===void 0&&(q={});var M=q.timeZoneName||"short",z=S+"|"+M,_=n[z];return _||(_=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:S,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:M}),n[z]=_),_}(w,C);return g.formatToParts(l)},c=function(p,w){for(var C=u(p,w),l=[],g=0;g<C.length;g+=1){var S=C[g],q=S.type,M=S.value,z=r[q];z>=0&&(l[z]=parseInt(M,10))}var _=l[3],W=_===24?0:_,P=l[0]+"-"+l[1]+"-"+l[2]+" "+W+":"+l[4]+":"+l[5]+":000",G=+p;return(o.utc(P).valueOf()-(G-=G%1e3))/6e4},d=a.prototype;d.tz=function(p,w){p===void 0&&(p=s);var C=this.utcOffset(),l=this.toDate(),g=l.toLocaleString("en-US",{timeZone:p}),S=Math.round((l-new Date(g))/1e3/60),q=o(g,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(l.getTimezoneOffset()/15)-S,!0);if(w){var M=q.utcOffset();q=q.add(C-M,"minute")}return q.$x.$timezone=p,q},d.offsetName=function(p){var w=this.$x.$timezone||o.tz.guess(),C=u(this.valueOf(),w,{timeZoneName:p}).find(function(l){return l.type.toLowerCase()==="timezonename"});return C&&C.value};var f=d.startOf;d.startOf=function(p,w){if(!this.$x||!this.$x.$timezone)return f.call(this,p,w);var C=o(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return f.call(C,p,w).tz(this.$x.$timezone,!0)},o.tz=function(p,w,C){var l=C&&w,g=C||w||s,S=c(+o(),g);if(typeof p!="string")return o(p).tz(g);var q=function(W,P,G){var J=W-60*P*1e3,$=c(J,G);if(P===$)return[J,P];var F=c(J-=60*($-P)*1e3,G);return $===F?[J,$]:[W-60*Math.min($,F)*1e3,Math.max($,F)]}(o.utc(p,l).valueOf(),S,g),M=q[0],z=q[1],_=o(M).utcOffset(z);return _.$x.$timezone=g,_},o.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},o.tz.setDefault=function(p){s=p}}})}),jo=ee((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_utc=n()})(e,function(){var r="minute",n=/[+-]\d\d(?::?\d\d)?/g,i=/([+-]|\d\d)/g;return function(a,o,s){var u=o.prototype;s.utc=function(l){var g={date:l,utc:!0,args:arguments};return new o(g)},u.utc=function(l){var g=s(this.toDate(),{locale:this.$L,utc:!0});return l?g.add(this.utcOffset(),r):g},u.local=function(){return s(this.toDate(),{locale:this.$L,utc:!1})};var c=u.parse;u.parse=function(l){l.utc&&(this.$u=!0),this.$utils().u(l.$offset)||(this.$offset=l.$offset),c.call(this,l)};var d=u.init;u.init=function(){if(this.$u){var l=this.$d;this.$y=l.getUTCFullYear(),this.$M=l.getUTCMonth(),this.$D=l.getUTCDate(),this.$W=l.getUTCDay(),this.$H=l.getUTCHours(),this.$m=l.getUTCMinutes(),this.$s=l.getUTCSeconds(),this.$ms=l.getUTCMilliseconds()}else d.call(this)};var f=u.utcOffset;u.utcOffset=function(l,g){var S=this.$utils().u;if(S(l))return this.$u?0:S(this.$offset)?f.call(this):this.$offset;if(typeof l=="string"&&(l=function(_){_===void 0&&(_="");var W=_.match(n);if(!W)return null;var P=(""+W[0]).match(i)||["-",0,0],G=P[0],J=60*+P[1]+ +P[2];return J===0?0:G==="+"?J:-J}(l),l===null))return this;var q=Math.abs(l)<=16?60*l:l,M=this;if(g)return M.$offset=q,M.$u=l===0,M;if(l!==0){var z=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(M=this.local().add(q+z,r)).$offset=q,M.$x.$localOffset=z}else M=this.utc();return M};var p=u.format;u.format=function(l){var g=l||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return p.call(this,g)},u.valueOf=function(){var l=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*l},u.isUTC=function(){return!!this.$u},u.toISOString=function(){return this.toDate().toISOString()},u.toString=function(){return this.toDate().toUTCString()};var w=u.toDate;u.toDate=function(l){return l==="s"&&this.$offset?s(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():w.call(this)};var C=u.diff;u.diff=function(l,g,S){if(l&&this.$u===l.$u)return C.call(this,l,g,S);var q=this.local(),M=s(l).local();return C.call(q,M,g,S)}}})}),Po=ee((e,t)=>{function r(i){try{return JSON.stringify(i)}catch{return'"[Circular]"'}}t.exports=n;function n(i,a,o){var s=o&&o.stringify||r,u=1;if(typeof i=="object"&&i!==null){var c=a.length+u;if(c===1)return i;var d=new Array(c);d[0]=s(i);for(var f=1;f<c;f++)d[f]=s(a[f]);return d.join(" ")}if(typeof i!="string")return i;var p=a.length;if(p===0)return i;for(var w="",C=1-u,l=-1,g=i&&i.length||0,S=0;S<g;){if(i.charCodeAt(S)===37&&S+1<g){switch(l=l>-1?l:0,i.charCodeAt(S+1)){case 100:case 102:if(C>=p||a[C]==null)break;l<S&&(w+=i.slice(l,S)),w+=Number(a[C]),l=S+2,S++;break;case 105:if(C>=p||a[C]==null)break;l<S&&(w+=i.slice(l,S)),w+=Math.floor(Number(a[C])),l=S+2,S++;break;case 79:case 111:case 106:if(C>=p||a[C]===void 0)break;l<S&&(w+=i.slice(l,S));var q=typeof a[C];if(q==="string"){w+="'"+a[C]+"'",l=S+2,S++;break}if(q==="function"){w+=a[C].name||"<anonymous>",l=S+2,S++;break}w+=s(a[C]),l=S+2,S++;break;case 115:if(C>=p)break;l<S&&(w+=i.slice(l,S)),w+=String(a[C]),l=S+2,S++;break;case 37:l<S&&(w+=i.slice(l,S)),w+="%",l=S+2,S++,C--;break}++C}++S}return l===-1?i:(l<g&&(w+=i.slice(l)),w)}}),$o=ee((e,t)=>{var r=Po();t.exports=p;var n=I().console||{},i={mapHttpRequest:J,mapHttpResponse:J,wrapRequestSerializer:$,wrapResponseSerializer:$,wrapErrorSerializer:$,req:J,res:J,err:P,errWithCause:P};function a(h,y){return h==="silent"?1/0:y.levels.values[h]}var o=Symbol("pino.logFuncs"),s=Symbol("pino.hierarchy"),u={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function c(h,y){let b={logger:y,parent:h[s]};y[s]=b}function d(h,y,b){let O={};y.forEach(D=>{O[D]=b[D]?b[D]:n[D]||n[u[D]||"log"]||F}),h[o]=O}function f(h,y){return Array.isArray(h)?h.filter(function(b){return b!=="!stdSerializers.err"}):h===!0?Object.keys(y):!1}function p(h){h=h||{},h.browser=h.browser||{};let y=h.browser.transmit;if(y&&typeof y.send!="function")throw Error("pino: transmit option must have a send function");let b=h.browser.write||n;h.browser.write&&(h.browser.asObject=!0);let O=h.serializers||{},D=f(h.browser.serialize,O),j=h.browser.serialize;Array.isArray(h.browser.serialize)&&h.browser.serialize.indexOf("!stdSerializers.err")>-1&&(j=!1);let N=Object.keys(h.customLevels||{}),V=["error","fatal","warn","info","debug","trace"].concat(N);typeof b=="function"&&V.forEach(function(X){b[X]=b}),(h.enabled===!1||h.browser.disabled)&&(h.level="silent");let B=h.level||"info",R=Object.create(b);R.log||(R.log=F),d(R,V,b),c({},R),Object.defineProperty(R,"levelVal",{get:de}),Object.defineProperty(R,"level",{get:ye,set:re});let Z={transmit:y,serialize:D,asObject:h.browser.asObject,formatters:h.browser.formatters,levels:V,timestamp:G(h)};R.levels=w(h),R.level=B,R.setMaxListeners=R.getMaxListeners=R.emit=R.addListener=R.on=R.prependListener=R.once=R.prependOnceListener=R.removeListener=R.removeAllListeners=R.listeners=R.listenerCount=R.eventNames=R.write=R.flush=F,R.serializers=O,R._serialize=D,R._stdErrSerialize=j,R.child=pe,y&&(R._logEvent=W());function de(){return a(this.level,this)}function ye(){return this._level}function re(X){if(X!=="silent"&&!this.levels.values[X])throw Error("unknown level "+X);this._level=X,g(this,Z,R,"error"),g(this,Z,R,"fatal"),g(this,Z,R,"warn"),g(this,Z,R,"info"),g(this,Z,R,"debug"),g(this,Z,R,"trace"),N.forEach(ge=>{g(this,Z,R,ge)})}function pe(X,ge){if(!X)throw new Error("missing bindings for child Pino");ge=ge||{},D&&X.serializers&&(ge.serializers=X.serializers);let Be=ge.serializers;if(D&&Be){var Re=Object.assign({},O,Be),cn=h.browser.serialize===!0?Object.keys(Re):D;delete X.serializers,z([X],cn,Re,this._stdErrSerialize)}function ln(dn){this._childLevel=(dn._childLevel|0)+1,this.bindings=X,Re&&(this.serializers=Re,this._serialize=cn),y&&(this._logEvent=W([].concat(dn._logEvent.bindings,X)))}ln.prototype=this;let Bt=new ln(this);return c(this,Bt),Bt.level=this.level,Bt}return R}function w(h){let y=h.customLevels||{},b=Object.assign({},p.levels.values,y),O=Object.assign({},p.levels.labels,C(y));return{values:b,labels:O}}function C(h){let y={};return Object.keys(h).forEach(function(b){y[h[b]]=b}),y}p.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},p.stdSerializers=i,p.stdTimeFunctions=Object.assign({},{nullTime:ie,epochTime:me,unixTime:x,isoTime:A});function l(h){let y=[];h.bindings&&y.push(h.bindings);let b=h[s];for(;b.parent;)b=b.parent,b.logger.bindings&&y.push(b.logger.bindings);return y.reverse()}function g(h,y,b,O){if(Object.defineProperty(h,O,{value:a(h.level,b)>a(O,b)?F:b[o][O],writable:!0,enumerable:!0,configurable:!0}),!y.transmit&&h[O]===F)return;h[O]=q(h,y,b,O);let D=l(h);D.length!==0&&(h[O]=S(D,h[O]))}function S(h,y){return function(){return y.apply(this,[...h,...arguments])}}function q(h,y,b,O){return function(D){return function(){let j=y.timestamp(),N=new Array(arguments.length),V=Object.getPrototypeOf&&Object.getPrototypeOf(this)===n?n:this;for(var B=0;B<N.length;B++)N[B]=arguments[B];if(y.serialize&&!y.asObject&&z(N,this._serialize,this.serializers,this._stdErrSerialize),y.asObject||y.formatters?D.call(V,M(this,O,N,j,y.formatters)):D.apply(V,N),y.transmit){let R=y.transmit.level||h._level,Z=b.levels.values[R],de=b.levels.values[O];if(de<Z)return;_(this,{ts:j,methodLevel:O,methodValue:de,transmitLevel:R,transmitValue:b.levels.values[y.transmit.level||h._level],send:y.transmit.send,val:a(h._level,b)},N)}}}(h[o][O])}function M(h,y,b,O,D={}){let{level:j=()=>h.levels.values[y],log:N=de=>de}=D;h._serialize&&z(b,h._serialize,h.serializers,h._stdErrSerialize);let V=b.slice(),B=V[0],R={};O&&(R.time=O),R.level=j(y,h.levels.values[y]);let Z=(h._childLevel|0)+1;if(Z<1&&(Z=1),B!==null&&typeof B=="object"){for(;Z--&&typeof V[0]=="object";)Object.assign(R,V.shift());B=V.length?r(V.shift(),V):void 0}else typeof B=="string"&&(B=r(V.shift(),V));return B!==void 0&&(R.msg=B),N(R)}function z(h,y,b,O){for(let D in h)if(O&&h[D]instanceof Error)h[D]=p.stdSerializers.err(h[D]);else if(typeof h[D]=="object"&&!Array.isArray(h[D]))for(let j in h[D])y&&y.indexOf(j)>-1&&j in b&&(h[D][j]=b[j](h[D][j]))}function _(h,y,b){let O=y.send,D=y.ts,j=y.methodLevel,N=y.methodValue,V=y.val,B=h._logEvent.bindings;z(b,h._serialize||Object.keys(h.serializers),h.serializers,h._stdErrSerialize===void 0?!0:h._stdErrSerialize),h._logEvent.ts=D,h._logEvent.messages=b.filter(function(R){return B.indexOf(R)===-1}),h._logEvent.level.label=j,h._logEvent.level.value=N,O(j,h._logEvent,V),h._logEvent=W(B)}function W(h){return{ts:0,messages:[],bindings:h||[],level:{label:"",value:0}}}function P(h){let y={type:h.constructor.name,msg:h.message,stack:h.stack};for(let b in h)y[b]===void 0&&(y[b]=h[b]);return y}function G(h){return typeof h.timestamp=="function"?h.timestamp:h.timestamp===!1?ie:me}function J(){return{}}function $(h){return h}function F(){}function ie(){return!1}function me(){return Date.now()}function x(){return Math.round(Date.now()/1e3)}function A(){return new Date(Date.now()).toISOString()}function I(){function h(y){return typeof y<"u"&&y}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return h(self)||h(window)||h(this)||{}}}t.exports.default=p,t.exports.pino=p}),Lo=ee((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_customParseFormat=n()})(e,function(){var r={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},n=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,i=/\d\d/,a=/\d\d?/,o=/\d*[^-_:/,()\s\d]+/,s={},u=function(l){return(l=+l)+(l>68?1900:2e3)},c=function(l){return function(g){this[l]=+g}},d=[/[+-]\d\d:?(\d\d)?|Z/,function(l){(this.zone||(this.zone={})).offset=function(g){if(!g||g==="Z")return 0;var S=g.match(/([+-]|\d\d)/g),q=60*S[1]+(+S[2]||0);return q===0?0:S[0]==="+"?-q:q}(l)}],f=function(l){var g=s[l];return g&&(g.indexOf?g:g.s.concat(g.f))},p=function(l,g){var S,q=s.meridiem;if(q){for(var M=1;M<=24;M+=1)if(l.indexOf(q(M,0,g))>-1){S=M>12;break}}else S=l===(g?"pm":"PM");return S},w={A:[o,function(l){this.afternoon=p(l,!1)}],a:[o,function(l){this.afternoon=p(l,!0)}],S:[/\d/,function(l){this.milliseconds=100*+l}],SS:[i,function(l){this.milliseconds=10*+l}],SSS:[/\d{3}/,function(l){this.milliseconds=+l}],s:[a,c("seconds")],ss:[a,c("seconds")],m:[a,c("minutes")],mm:[a,c("minutes")],H:[a,c("hours")],h:[a,c("hours")],HH:[a,c("hours")],hh:[a,c("hours")],D:[a,c("day")],DD:[i,c("day")],Do:[o,function(l){var g=s.ordinal,S=l.match(/\d+/);if(this.day=S[0],g)for(var q=1;q<=31;q+=1)g(q).replace(/\[|\]/g,"")===l&&(this.day=q)}],M:[a,c("month")],MM:[i,c("month")],MMM:[o,function(l){var g=f("months"),S=(f("monthsShort")||g.map(function(q){return q.slice(0,3)})).indexOf(l)+1;if(S<1)throw new Error;this.month=S%12||S}],MMMM:[o,function(l){var g=f("months").indexOf(l)+1;if(g<1)throw new Error;this.month=g%12||g}],Y:[/[+-]?\d+/,c("year")],YY:[i,function(l){this.year=u(l)}],YYYY:[/\d{4}/,c("year")],Z:d,ZZ:d};function C(l){var g,S;g=l,S=s&&s.formats;for(var q=(l=g.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(J,$,F){var ie=F&&F.toUpperCase();return $||S[F]||r[F]||S[ie].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(me,x,A){return x||A.slice(1)})})).match(n),M=q.length,z=0;z<M;z+=1){var _=q[z],W=w[_],P=W&&W[0],G=W&&W[1];q[z]=G?{regex:P,parser:G}:_.replace(/^\[|\]$/g,"")}return function(J){for(var $={},F=0,ie=0;F<M;F+=1){var me=q[F];if(typeof me=="string")ie+=me.length;else{var x=me.regex,A=me.parser,I=J.slice(ie),h=x.exec(I)[0];A.call($,h),J=J.replace(h,"")}}return function(y){var b=y.afternoon;if(b!==void 0){var O=y.hours;b?O<12&&(y.hours+=12):O===12&&(y.hours=0),delete y.afternoon}}($),$}}return function(l,g,S){S.p.customParseFormat=!0,l&&l.parseTwoDigitYear&&(u=l.parseTwoDigitYear);var q=g.prototype,M=q.parse;q.parse=function(z){var _=z.date,W=z.utc,P=z.args;this.$u=W;var G=P[1];if(typeof G=="string"){var J=P[2]===!0,$=P[3]===!0,F=J||$,ie=P[2];$&&(ie=P[2]),s=this.$locale(),!J&&ie&&(s=S.Ls[ie]),this.$d=function(I,h,y){try{if(["x","X"].indexOf(h)>-1)return new Date((h==="X"?1e3:1)*I);var b=C(h)(I),O=b.year,D=b.month,j=b.day,N=b.hours,V=b.minutes,B=b.seconds,R=b.milliseconds,Z=b.zone,de=new Date,ye=j||(O||D?1:de.getDate()),re=O||de.getFullYear(),pe=0;O&&!D||(pe=D>0?D-1:de.getMonth());var X=N||0,ge=V||0,Be=B||0,Re=R||0;return Z?new Date(Date.UTC(re,pe,ye,X,ge,Be,Re+60*Z.offset*1e3)):y?new Date(Date.UTC(re,pe,ye,X,ge,Be,Re)):new Date(re,pe,ye,X,ge,Be,Re)}catch{return new Date("")}}(_,G,W),this.init(),ie&&ie!==!0&&(this.$L=this.locale(ie).$L),F&&_!=this.format(G)&&(this.$d=new Date("")),s={}}else if(G instanceof Array)for(var me=G.length,x=1;x<=me;x+=1){P[1]=G[x-1];var A=S.apply(this,P);if(A.isValid()){this.$d=A.$d,this.$L=A.$L,this.init();break}x===me&&(this.$d=new Date(""))}else M.call(this,z)}}})}),Qo=ee((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_quarterOfYear=n()})(e,function(){var r="month",n="quarter";return function(i,a){var o=a.prototype;o.quarter=function(c){return this.$utils().u(c)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(c-1))};var s=o.add;o.add=function(c,d){return c=Number(c),this.$utils().p(d)===n?this.add(3*c,r):s.bind(this)(c,d)};var u=o.startOf;o.startOf=function(c,d){var f=this.$utils(),p=!!f.u(d)||d;if(f.p(c)===n){var w=this.quarter()-1;return p?this.month(3*w).startOf(r).startOf("day"):this.month(3*w+2).endOf(r).endOf("day")}return u.bind(this)(c,d)}}})}),rt=()=>global.crypto,Vo=()=>{typeof window<"u"||(rt()||(global.crypto=wo("crypto")),!rt().getRandomValues&&rt().webcrypto&&(global.crypto.getRandomValues=rt().webcrypto.getRandomValues.bind(rt().webcrypto)))},zo={};So(zo,{escape:()=>We,getHighlightedSuggestion:()=>es,highlightString:()=>Xo});function No(e,t){let r=`
  The following properties are invalid:

    ${e.join(`
	`)}
  
  ${t}
  `;return new ei(r)}var ei=class extends Error{constructor(e){super(e),this.name="SchemaValidationError"}},Ze=class{constructor(e){this.definition=e}validate(e={},t=""){let r={...this.default,...e},n=[];for(let i in this.definition){let a=this.definition[i].validate(r[i]);a&&n.push(`${i}: ${a}`)}if(n.length)throw No(n,t);return r}get default(){let e={};for(let t in this.definition){let r=this.definition[t].default;r!==void 0&&(e[t]=r)}return e}},ce=class{constructor(e={}){this.baseConfig=e}validate(e){return this.baseConfig.required&&H(e)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return this.baseConfig.required===!0}};function oe(e){return e===void 0}function Ho(e){return e===null}function H(e){return oe(e)||Ho(e)}var Y=class{constructor(e={}){this.config=e,this.value=new ce(e)}validate(e){return this.value.validate(e)||(Yo(e)?e<this.config.min?`minimum value of ${this.config.min} not respected.`:e>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}};function Yo(e){return oe(e)||ti(e)}function ti(e){return typeof e=="number"&&!isNaN(e)}var K=class{constructor(e={}){this.value=new ce(e)}validate(e){return this.value.validate(e)||(Bo(e)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}};function Bo(e){return oe(e)||ri(e)}function ri(e){return typeof e=="boolean"}var Wo=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i,U=class{constructor(e={}){this.config={emptyAllowed:!0,url:!1,...e},this.value=new ce(this.config)}validate(e){let{emptyAllowed:t,url:r,regex:n,constrainTo:i}=this.config;return this.value.validate(e)||(oe(e)?null:Er(e)?!t&&!e.length?"value is an empty string.":r&&!Wo.test(e)?"value is not a valid URL.":n&&!n.test(e)?`value did not match provided regex ${n}`:i&&!i.includes(e)?`value should be one of: ${i.join(", ")}.`:null:"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}};function Er(e){return Object.prototype.toString.call(e)==="[object String]"}var Q=class{constructor(e={}){this.config={options:{required:!1},values:{},...e}}validate(e){if(oe(e))return this.config.options.required?"value is required and is currently undefined":null;if(!ni(e))return"value is not an object";for(let[r,n]of Object.entries(this.config.values))if(n.required&&H(e[r]))return`value does not contain ${r}`;let t="";for(let[r,n]of Object.entries(this.config.values)){let i=e[r],a=n.validate(i);a!==null&&(t+=" "+a)}return t===""?null:t}get default(){}get required(){return!!this.config.options.required}};function ni(e){return e!==void 0&&typeof e=="object"}var le=class{constructor(e={}){this.config=e,this.value=new ce(this.config)}validate(e){if(!H(e)&&!Array.isArray(e))return"value is not an array";let t=this.value.validate(e);if(t!==null)return t;if(H(e))return null;if(this.config.max!==void 0&&e.length>this.config.max)return`value contains more than ${this.config.max}`;if(this.config.min!==void 0&&e.length<this.config.min)return`value contains less than ${this.config.min}`;if(this.config.each!==void 0){let r="";return e.forEach(n=>{this.config.each.required&&H(n)&&(r=`value is null or undefined: ${e.join(",")}`);let i=this.validatePrimitiveValue(n,this.config.each);i!==null&&(r+=" "+i)}),r===""?null:r}return null}validatePrimitiveValue(e,t){return ri(e)||Er(e)||ti(e)||ni(e)?t.validate(e):"value is not a primitive value"}get default(){}get required(){return this.value.required}};function Go(e){return Array.isArray(e)}var Ot=class{constructor(e){this.config=e,this.value=new ce(e)}validate(e){let t=this.value.validate(e);return t!==null?t:oe(e)||Object.values(this.config.enum).find(r=>r===e)?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}};be(Io());function Wt(e){return e.trim()===""}function Jo(e,t){return[...e.reduce((r,n)=>{let i=t(n);return r.has(i)||r.set(i,n),r},new Map).values()]}var Ko=new Set(["1",1,"yes",!0]);function ii(){if(typeof navigator>"u"||typeof window>"u")return!1;let e=navigator,t=window;return[e.globalPrivacyControl,e.doNotTrack,e.msDoNotTrack,t.doNotTrack].some(r=>Ko.has(r))}function Zo(e){let t={};for(let[r,n]of e)t[r]=n;return t}function Dr(e){if(typeof e!="object"||!e)return e;try{return JSON.parse(JSON.stringify(e))}catch{return e}}function Xo(e){if(Wt(e.openingDelimiter)||Wt(e.closingDelimiter))throw Error("delimiters should be a non-empty string");if(H(e.content)||Wt(e.content))return e.content;if(e.highlights.length===0)return We(e.content);let t=e.content.length,r="",n=0;for(let i=0;i<e.highlights.length;i++){let a=e.highlights[i],o=a.offset,s=o+a.length;if(s>t)break;r+=We(e.content.slice(n,o)),r+=e.openingDelimiter,r+=We(e.content.slice(o,s)),r+=e.closingDelimiter,n=s}return n!==t&&(r+=We(e.content.slice(n))),r}function es(e,t){return e=We(e),e.replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,(r,n,i,a)=>n?Gt(n,t.notMatchDelimiters):i?Gt(i,t.exactMatchDelimiters):a?Gt(a,t.correctionDelimiters):r)}function Gt(e,t){return t?t.open+e+t.close:e}function We(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r="(?:"+Object.keys(t).join("|")+")",n=RegExp(r),i=RegExp(r,"g");return n.test(e)?e.replace(i,a=>t[a]):e}var ai=e=>e;function ur(){return{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}}function Ge(){return{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:ur(),pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],searchResponseId:"",requestId:"",questionAnswer:ur(),extendedResults:{}}}function $e(e){let{url:t,accessToken:r,organizationId:n,authentication:i,...a}=e;return a}var Le=e=>{let{response:t}=e;return t.body?ts(e):rs(t)},ts=e=>is(e)?as(e):ns(e)?e.body:{message:"unknown",statusCode:0,type:"unknown"},rs=e=>{let t=JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)));return{...t,message:`Client side error: ${t.message||""}`,statusCode:400,type:"ClientError"}};function ns(e){return e.body.statusCode!==void 0}function is(e){return e.body.exception!==void 0}var as=e=>({message:e.body.exception.code,statusCode:e.response.status,type:e.body.exception.code}),os=be(Oo()),ss=be(Fo()),oi=class extends Error{constructor(){super(),this.name="ExpiredToken",this.message="The token being used to perform the request is expired."}},cr=class extends Error{constructor(e,t){super(),this.name="Disconnected",this.message=`Client could not connect to the following URL: ${e}`,this.statusCode=t??0}};function us(e){let t=[];for(let r in e){let n=encodeURIComponent(r),i=encodeURIComponent(e[r]);t.push(`${n}=${i}`)}return t.join("&")}function cs(e){return typeof e!="object"||!e?!1:Object.values(e).every(ls)}function ls(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function hn(e){return e===429}var xe=class si{static async call(t){let r=fs(t),{logger:n}=t,i=await si.preprocessRequest(r,t);n.info(i,"Platform request");let{url:a,...o}=i,s=async()=>{let u=await(0,os.default)(a,o);if(hn(u.status))throw u;return u};try{let u=await(0,ss.backOff)(s,{retry:c=>{let d=c&&hn(c.status);return d&&n.info("Platform retrying request"),d}});if(u.status===419)throw n.info("Platform renewing token"),new oi;if(u.status===404)throw new cr(a,u.status);return n.info({response:u,requestInfo:i},"Platform response"),u}catch(u){return u.message==="Failed to fetch"?new cr(a):u}}static async preprocessRequest(t,r){let{origin:n,preprocessRequest:i,logger:a,requestMetadata:o}=r,{signal:s,...u}=t,c=Dr(u);try{let d=await i(t,n,o);return{...t,...d}}catch(d){a.error(d,"Platform request preprocessing failed. Returning default request options.")}return c}};function ui(e,t){return`https://${e}.cloud.coveo.com`}function ds(e,t="prod"){let r=t==="prod"?"":t,n=`https://${e}.org${r}.coveo.com`,i=`https://${e}.analytics.org${r}.coveo.com`,a=`${n}/rest/search/v2`,o=`https://${e}.admin.org${r}.coveo.com`;return{platform:n,analytics:i,search:a,admin:o}}function fn(e){return ui("platform")}function hs(e){return ui("analytics")}function fs(e){let{url:t,method:r,requestParams:n,contentType:i,accessToken:a,signal:o}=e,s=e.method==="POST"||e.method==="PUT",u=ps(n,i);return{url:t,method:r,headers:{"Content-Type":i,Authorization:`Bearer ${a}`,...e.headers},...s&&{body:u},signal:o}}function ps(e,t){return t==="application/x-www-form-urlencoded"?cs(e)?us(e):"":JSON.stringify(e)}function gs(){if(typeof window>"u"){let{AbortController:e}=Mo();return new e}return typeof AbortController>"u"?null:new AbortController}var nt=class{constructor(){this.currentAbortController=null}async enqueue(e,t){let r=this.currentAbortController,n=this.currentAbortController=gs();r&&(t.warnOnAbort&&t.logger.warn("Cancelling current pending search query"),r.abort());try{return await e((n==null?void 0:n.signal)??null)}finally{this.currentAbortController===n&&(this.currentAbortController=null)}}},ms=class{constructor(e){this._params={},this._basePath=e}addParam(e,t){this._params={...this.params,[e]:t}}get basePath(){return this._basePath}get params(){return this._params}get hasParams(){return Object.entries(this._params).length}get href(){return this.hasParams?`${this.basePath}?${Object.entries(this.params).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&")}`:this.basePath}},ys=e=>/^https:\/\/platform(dev|stg|hipaa)?(-)?(eu|au)?\.cloud\.coveo\.com/.test(e),vs=(e,t)=>{let r=ci(e);return r&&r.organizationId===t?r:null},ci=e=>{let t=e.match(/^https:\/\/(?<organizationId>\w+)\.org(?<environment>dev|stg|hipaa)?\.coveo\.com/);return t!=null&&t.groups?t.groups:null};function ws(e){return((e.headers.get("content-type")||"").split(";").find(t=>t.indexOf("charset=")!==-1)||"").split("=")[1]||"UTF-8"}var Ue=(e,t,r,n)=>{let i=new ms(`${e.url}${n}`);return i.addParam("organizationId",e.organizationId),e.authentication&&i.addParam("authentication",e.authentication),{accessToken:e.accessToken,method:t,contentType:r,url:i.href,origin:"searchApiFetch"}},Ss=async(e,t)=>{let r=await xe.call({...Ue(e,"POST","application/x-www-form-urlencoded","/html"),requestParams:$e(e),requestMetadata:{method:"html"},...t});if(r instanceof Error)throw r;let n=ws(r),i=await r.arrayBuffer(),a=new TextDecoder(n).decode(i);return bs(a)?{success:a}:{error:Le({response:r,body:a})}};function bs(e){return typeof e=="string"}function ks(e){return{statusCode:e.statusCode,type:e.name,message:e.message}}function Cs(e){return{statusCode:e.code,type:e.name,message:e.message,ignored:!0}}function Jt(e,t){if(t&&e.name==="AbortError")return{error:Cs(e)};if(e instanceof cr)return{error:ks(e)};throw e}var Is=class{constructor(e){this.options=e,this.apiCallsQueues={unknown:new nt,mainSearch:new nt,facetValues:new nt,foldingCollection:new nt,instantResults:new nt}}async plan(e){let t=await xe.call({...Ue(e,"POST","application/json","/plan"),requestParams:$e(e),requestMetadata:{method:"plan"},...this.options});if(t instanceof Error)return Jt(t);let r=await t.json();return As(r)?{success:r}:{error:Le({response:t,body:r})}}async querySuggest(e){let t=await xe.call({...Ue(e,"POST","application/json","/querySuggest"),requestMetadata:{method:"querySuggest"},requestParams:$e(e),...this.options});if(t instanceof Error)return Jt(t);let r=await t.json(),n={response:t,body:r};return qs(r)?{success:(await this.options.postprocessQuerySuggestResponseMiddleware(n)).body}:{error:Le(n)}}async search(e,t){let r=(t==null?void 0:t.origin)??"unknown",n=await this.apiCallsQueues[r].enqueue(o=>xe.call({...Ue(e,"POST","application/json",""),requestParams:$e(e),requestMetadata:{method:"search",origin:t==null?void 0:t.origin},...this.options,signal:o??void 0}),{logger:this.options.logger,warnOnAbort:!(t!=null&&t.disableAbortWarning)});if(n instanceof Error)return Jt(n,t==null?void 0:t.disableAbortWarning);let i=await n.json(),a={response:n,body:i};return Kt(i)?(a.body=Os(i),{success:(await this.options.postprocessSearchResponseMiddleware(a)).body}):{error:Le(a)}}async facetSearch(e){let t=await xe.call({...Ue(e,"POST","application/json","/facet"),requestParams:$e(e),requestMetadata:{method:"facetSearch"},...this.options});if(t instanceof Error)throw t;let r=await t.json(),n={response:t,body:r};return(await this.options.postprocessFacetSearchResponseMiddleware(n)).body}async recommendations(e){let t=await xe.call({...Ue(e,"POST","application/json",""),requestParams:$e(e),requestMetadata:{method:"recommendations"},...this.options});if(t instanceof Error)throw t;let r=await t.json();return Kt(r)?{success:r}:{error:Le({response:t,body:r})}}async html(e){return Ss(e,{...this.options})}async productRecommendations(e){let t=await xe.call({...Ue(e,"POST","application/json",""),requestParams:$e(e),requestMetadata:{method:"productRecommendations"},...this.options});if(t instanceof Error)throw t;let r=await t.json();return Kt(r)?{success:r}:{error:Le({response:t,body:r})}}async fieldDescriptions(e){let t=await xe.call({...Ue(e,"GET","application/json","/fields"),requestParams:{},requestMetadata:{method:"fieldDescriptions"},...this.options});if(t instanceof Error)throw t;let r=await t.json();return Es(r)?{success:r}:{error:Le({response:t,body:r})}}},li=e=>e.success!==void 0,Ee=e=>e.error!==void 0;function Kt(e){return e.results!==void 0}function Os(e){let t=ur();return H(e.questionAnswer)?(e.questionAnswer=t,e):(e.questionAnswer={...t,...e.questionAnswer},e)}function qs(e){return e.completions!==void 0}function As(e){return e.preprocessingOutput!==void 0}function Es(e){return e.fields!==void 0}var Ds=e=>e,Rs=e=>e,xs=e=>e;function ue(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Us=typeof Symbol=="function"&&Symbol.observable||"@@observable",pn=Us,Zt=()=>Math.random().toString(36).substring(7).split("").join("."),Fs={INIT:`@@redux/INIT${Zt()}`,REPLACE:`@@redux/REPLACE${Zt()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Zt()}`},qt=Fs;function Rr(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function di(e,t,r){if(typeof e!="function")throw new Error(ue(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(ue(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(ue(1));return r(di)(e,t)}let n=e,i=t,a=new Map,o=a,s=0,u=!1;function c(){o===a&&(o=new Map,a.forEach((l,g)=>{o.set(g,l)}))}function d(){if(u)throw new Error(ue(3));return i}function f(l){if(typeof l!="function")throw new Error(ue(4));if(u)throw new Error(ue(5));let g=!0;c();let S=s++;return o.set(S,l),function(){if(g){if(u)throw new Error(ue(6));g=!1,c(),o.delete(S),a=null}}}function p(l){if(!Rr(l))throw new Error(ue(7));if(typeof l.type>"u")throw new Error(ue(8));if(typeof l.type!="string")throw new Error(ue(17));if(u)throw new Error(ue(9));try{u=!0,i=n(i,l)}finally{u=!1}return(a=o).forEach(g=>{g()}),l}function w(l){if(typeof l!="function")throw new Error(ue(10));n=l,p({type:qt.REPLACE})}function C(){let l=f;return{subscribe(g){if(typeof g!="object"||g===null)throw new Error(ue(11));function S(){let q=g;q.next&&q.next(d())}return S(),{unsubscribe:l(S)}},[pn](){return this}}}return p({type:qt.INIT}),{dispatch:p,subscribe:f,getState:d,replaceReducer:w,[pn]:C}}function Ms(e){Object.keys(e).forEach(t=>{let r=e[t];if(typeof r(void 0,{type:qt.INIT})>"u")throw new Error(ue(12));if(typeof r(void 0,{type:qt.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(ue(13))})}function hi(e){let t=Object.keys(e),r={};for(let a=0;a<t.length;a++){let o=t[a];typeof e[o]=="function"&&(r[o]=e[o])}let n=Object.keys(r),i;try{Ms(r)}catch(a){i=a}return function(a={},o){if(i)throw i;let s=!1,u={};for(let c=0;c<n.length;c++){let d=n[c],f=r[d],p=a[d],w=f(p,o);if(typeof w>"u")throw new Error(ue(14));u[d]=w,s=s||w!==p}return s=s||n.length!==Object.keys(a).length,s?u:a}}function At(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function Ts(...e){return t=>(r,n)=>{let i=t(r,n),a=()=>{throw new Error(ue(15))},o={getState:i.getState,dispatch:(u,...c)=>a(u,...c)},s=e.map(u=>u(o));return a=At(...s)(i.dispatch),{...i,dispatch:a}}}function _s(e){return Rr(e)&&"type"in e&&typeof e.type=="string"}var fi=Symbol.for("immer-nothing"),gn=Symbol.for("immer-draftable"),ve=Symbol.for("immer-state");function ke(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Je=Object.getPrototypeOf;function _e(e){return!!e&&!!e[ve]}function De(e){var t;return e?pi(e)||Array.isArray(e)||!!e[gn]||!!((t=e.constructor)!=null&&t[gn])||jt(e)||Pt(e):!1}var js=Object.prototype.constructor.toString();function pi(e){if(!e||typeof e!="object")return!1;let t=Je(e);if(t===null)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===js}function ct(e,t){_t(e)===0?Object.entries(e).forEach(([r,n])=>{t(r,n,e)}):e.forEach((r,n)=>t(n,r,e))}function _t(e){let t=e[ve];return t?t.type_:Array.isArray(e)?1:jt(e)?2:Pt(e)?3:0}function lr(e,t){return _t(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function gi(e,t,r){let n=_t(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Ps(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function jt(e){return e instanceof Map}function Pt(e){return e instanceof Set}function Qe(e){return e.copy_||e.base_}function dr(e,t){if(jt(e))return new Map(e);if(Pt(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&pi(e))return Je(e)?{...e}:Object.assign(Object.create(null),e);let r=Object.getOwnPropertyDescriptors(e);delete r[ve];let n=Reflect.ownKeys(r);for(let i=0;i<n.length;i++){let a=n[i],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(Je(e),r)}function xr(e,t=!1){return $t(e)||_e(e)||!De(e)||(_t(e)>1&&(e.set=e.add=e.clear=e.delete=$s),Object.freeze(e),t&&ct(e,(r,n)=>xr(n,!0))),e}function $s(){ke(2)}function $t(e){return Object.isFrozen(e)}var Ls={};function Ne(e){let t=Ls[e];return t||ke(0,e),t}var lt;function mi(){return lt}function Qs(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function mn(e,t){t&&(Ne("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function hr(e){fr(e),e.drafts_.forEach(Vs),e.drafts_=null}function fr(e){e===lt&&(lt=e.parent_)}function yn(e){return lt=Qs(lt,e)}function Vs(e){let t=e[ve];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function vn(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[ve].modified_&&(hr(t),ke(4)),De(e)&&(e=Et(t,e),t.parent_||Dt(t,e)),t.patches_&&Ne("Patches").generateReplacementPatches_(r[ve].base_,e,t.patches_,t.inversePatches_)):e=Et(t,r,[]),hr(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==fi?e:void 0}function Et(e,t,r){if($t(t))return t;let n=t[ve];if(!n)return ct(t,(i,a)=>wn(e,n,t,i,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Dt(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let i=n.copy_,a=i,o=!1;n.type_===3&&(a=new Set(i),i.clear(),o=!0),ct(a,(s,u)=>wn(e,n,i,s,u,r,o)),Dt(e,i,!1),r&&e.patches_&&Ne("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function wn(e,t,r,n,i,a,o){if(_e(i)){let s=a&&t&&t.type_!==3&&!lr(t.assigned_,n)?a.concat(n):void 0,u=Et(e,i,s);if(gi(r,n,u),_e(u))e.canAutoFreeze_=!1;else return}else o&&r.add(i);if(De(i)&&!$t(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Et(e,i),(!t||!t.scope_.parent_)&&Dt(e,i)}}function Dt(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&xr(t,r)}function zs(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:mi(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},i=n,a=Ur;r&&(i=[n],a=dt);let{revoke:o,proxy:s}=Proxy.revocable(i,a);return n.draft_=s,n.revoke_=o,s}var Ur={get(e,t){if(t===ve)return e;let r=Qe(e);if(!lr(r,t))return Ns(e,r,t);let n=r[t];return e.finalized_||!De(n)?n:n===Xt(e.base_,t)?(er(e),e.copy_[t]=gr(n,e)):n},has(e,t){return t in Qe(e)},ownKeys(e){return Reflect.ownKeys(Qe(e))},set(e,t,r){let n=yi(Qe(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let i=Xt(Qe(e),t),a=i==null?void 0:i[ve];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Ps(r,i)&&(r!==void 0||lr(e.base_,t)))return!0;er(e),pr(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Xt(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,er(e),pr(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=Qe(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){ke(11)},getPrototypeOf(e){return Je(e.base_)},setPrototypeOf(){ke(12)}},dt={};ct(Ur,(e,t)=>{dt[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});dt.deleteProperty=function(e,t){return dt.set.call(this,e,t,void 0)};dt.set=function(e,t,r){return Ur.set.call(this,e[0],t,r,e[0])};function Xt(e,t){let r=e[ve];return(r?Qe(r):e)[t]}function Ns(e,t,r){var i;let n=yi(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function yi(e,t){if(!(t in e))return;let r=Je(e);for(;r;){let n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Je(r)}}function pr(e){e.modified_||(e.modified_=!0,e.parent_&&pr(e.parent_))}function er(e){e.copy_||(e.copy_=dr(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Hs=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){let a=r;r=t;let o=this;return function(s=a,...u){return o.produce(s,c=>r.call(this,c,...u))}}typeof r!="function"&&ke(6),n!==void 0&&typeof n!="function"&&ke(7);let i;if(De(t)){let a=yn(this),o=gr(t,void 0),s=!0;try{i=r(o),s=!1}finally{s?hr(a):fr(a)}return mn(a,n),vn(i,a)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===fi&&(i=void 0),this.autoFreeze_&&xr(i,!0),n){let a=[],o=[];Ne("Patches").generateReplacementPatches_(t,i,a,o),n(a,o)}return i}else ke(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(a,...o)=>this.produceWithPatches(a,s=>t(s,...o));let n,i;return[this.produce(t,r,(a,o)=>{n=a,i=o}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){De(e)||ke(8),_e(e)&&(e=vi(e));let t=yn(this),r=gr(e,void 0);return r[ve].isManual_=!0,fr(t),r}finishDraft(e,t){let r=e&&e[ve];(!r||!r.isManual_)&&ke(9);let{scope_:n}=r;return mn(n,t),vn(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));let n=Ne("Patches").applyPatches_;return _e(e)?n(e,t):this.produce(e,i=>n(i,t))}};function gr(e,t){let r=jt(e)?Ne("MapSet").proxyMap_(e,t):Pt(e)?Ne("MapSet").proxySet_(e,t):zs(e,t);return(t?t.scope_:mi()).drafts_.push(r),r}function vi(e){return _e(e)||ke(10,e),wi(e)}function wi(e){if(!De(e)||$t(e))return e;let t=e[ve],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=dr(e,t.scope_.immer_.useStrictShallowCopy_)}else r=dr(e,!0);return ct(r,(n,i)=>{gi(r,n,wi(i))}),t&&(t.finalized_=!1),r}var we=new Hs,Si=we.produce;we.produceWithPatches.bind(we);we.setAutoFreeze.bind(we);we.setUseStrictShallowCopy.bind(we);we.applyPatches.bind(we);we.createDraft.bind(we);we.finishDraft.bind(we);function Ys(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Bs(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Ws(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){let r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var Sn=e=>Array.isArray(e)?e:[e];function Gs(e){let t=Array.isArray(e[0])?e[0]:e;return Ws(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Js(e,t){let r=[],{length:n}=e;for(let i=0;i<n;i++)r.push(e[i].apply(null,t));return r}var Ks=class{constructor(e){this.value=e}deref(){return this.value}},Zs=typeof WeakRef<"u"?WeakRef:Ks,Xs=0,bn=1;function vt(){return{s:Xs,v:void 0,o:null,p:null}}function Fr(e,t={}){let r=vt(),{resultEqualityCheck:n}=t,i,a=0;function o(){var f;let s=r,{length:u}=arguments;for(let p=0,w=u;p<w;p++){let C=arguments[p];if(typeof C=="function"||typeof C=="object"&&C!==null){let l=s.o;l===null&&(s.o=l=new WeakMap);let g=l.get(C);g===void 0?(s=vt(),l.set(C,s)):s=g}else{let l=s.p;l===null&&(s.p=l=new Map);let g=l.get(C);g===void 0?(s=vt(),l.set(C,s)):s=g}}let c=s,d;if(s.s===bn?d=s.v:(d=e.apply(null,arguments),a++),c.s=bn,n){let p=((f=i==null?void 0:i.deref)==null?void 0:f.call(i))??i;p!=null&&n(p,d)&&(d=p,a!==0&&a--),i=typeof d=="object"&&d!==null||typeof d=="function"?new Zs(d):d}return c.v=d,d}return o.clearCache=()=>{r=vt(),o.resetResultsCount()},o.resultsCount=()=>a,o.resetResultsCount=()=>{a=0},o}function bi(e,...t){let r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...i)=>{let a=0,o=0,s,u={},c=i.pop();typeof c=="object"&&(u=c,c=i.pop()),Ys(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);let d={...r,...u},{memoize:f,memoizeOptions:p=[],argsMemoize:w=Fr,argsMemoizeOptions:C=[],devModeChecks:l={}}=d,g=Sn(p),S=Sn(C),q=Gs(i),M=f(function(){return a++,c.apply(null,arguments)},...g),z=w(function(){o++;let _=Js(q,arguments);return s=M.apply(null,_),s},...S);return Object.assign(z,{resultFunc:c,memoizedResultFunc:M,dependencies:q,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>s,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:f,argsMemoize:w})};return Object.assign(n,{withTypes:()=>n}),n}var Mr=bi(Fr),eu=Object.assign((e,t=Mr)=>{Bs(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((a,o,s)=>(a[r[s]]=o,a),{}))},{withTypes:()=>eu});function ki(e){return({dispatch:t,getState:r})=>n=>i=>typeof i=="function"?i(t,r,e):n(i)}var tu=ki(),ru=ki,nu=(...e)=>{let t=bi(...e),r=Object.assign((...n)=>{let i=t(...n),a=(o,...s)=>i(_e(o)?vi(o):o,...s);return Object.assign(a,i),a},{withTypes:()=>r});return r};nu(Fr);var iu=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?At:At.apply(null,arguments)},au=e=>e&&typeof e.match=="function";function k(e,t){function r(...n){if(t){let i=t(...n);if(!i)throw new Error(je(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>_s(n)&&n.type===e,r}var Ci=class at extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,at.prototype)}static get[Symbol.species](){return at}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new at(...t[0].concat(this)):new at(...t.concat(this))}};function kn(e){return De(e)?Si(e,()=>{}):e}function ou(e){return typeof e=="boolean"}var su=()=>function(e){let{thunk:t=!0,immutableCheck:r=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=e??{},a=new Ci;return t&&(ou(t)?a.push(tu):a.push(ru(t.extraArgument))),a},uu="RTK_autoBatch",Ii=e=>t=>{setTimeout(t,e)},cu=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Ii(10),lu=(e={type:"raf"})=>t=>(...r)=>{let n=t(...r),i=!0,a=!1,o=!1,s=new Set,u=e.type==="tick"?queueMicrotask:e.type==="raf"?cu:e.type==="callback"?e.queueNotification:Ii(e.timeout),c=()=>{o=!1,a&&(a=!1,s.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){let f=()=>i&&d(),p=n.subscribe(f);return s.add(d),()=>{p(),s.delete(d)}},dispatch(d){var f;try{return i=!((f=d==null?void 0:d.meta)!=null&&f[uu]),a=!i,a&&(o||(o=!0,u(c))),n.dispatch(d)}finally{i=!0}}})},du=e=>function(t){let{autoBatch:r=!0}=t??{},n=new Ci(e);return r&&n.push(lu(typeof r=="object"?r:void 0)),n},Cn=!0;function hu(e){let t=su(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:o=void 0}=e||{},s;if(typeof r=="function")s=r;else if(Rr(r))s=hi(r);else throw new Error(je(1));let u;typeof n=="function"?u=n(t):u=t();let c=At;i&&(c=iu({trace:!Cn,...typeof i=="object"&&i}));let d=Ts(...u),f=du(d),p=typeof o=="function"?o(f):f(),w=c(...p);return di(s,a,w)}function fu(e){let t={},r=[],n,i={addCase(a,o){let s=typeof a=="string"?a:a.type;if(!s)throw new Error(je(28));if(s in t)throw new Error(je(29));return t[s]=o,i},addMatcher(a,o){return r.push({matcher:a,reducer:o}),i},addDefaultCase(a){return n=a,i}};return e(i),[t,r,n]}function pu(e){return typeof e=="function"}function Ie(e,t){let[r,n,i]=fu(t),a;if(pu(e))a=()=>kn(e());else{let s=kn(e);a=()=>s}function o(s=a(),u){let c=[r[u.type],...n.filter(({matcher:d})=>d(u)).map(({reducer:d})=>d)];return c.filter(d=>!!d).length===0&&(c=[i]),c.reduce((d,f)=>{if(f)if(_e(d)){let p=f(d,u);return p===void 0?d:p}else{if(De(d))return Si(d,p=>f(p,u));{let p=f(d,u);if(p===void 0){if(d===null)return d;throw new Error(je(9))}return p}}return d},s)}return o.getInitialState=a,o}var gu="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Oi=(e=21)=>{let t="",r=e;for(;r--;)t+=gu[Math.random()*64|0];return t},mu=(e,t)=>au(e)?e.match(t):e(t);function yu(...e){return t=>e.some(r=>mu(r,t))}var vu=["name","message","stack","code"],tr=class{constructor(e,t){Zn(this,"_type"),this.payload=e,this.meta=t}},In=class{constructor(e,t){Zn(this,"_type"),this.payload=e,this.meta=t}},wu=e=>{if(typeof e=="object"&&e!==null){let t={};for(let r of vu)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},ne=(()=>{function e(t,r,n){let i=k(t+"/fulfilled",(u,c,d,f)=>({payload:u,meta:{...f||{},arg:d,requestId:c,requestStatus:"fulfilled"}})),a=k(t+"/pending",(u,c,d)=>({payload:void 0,meta:{...d||{},arg:c,requestId:u,requestStatus:"pending"}})),o=k(t+"/rejected",(u,c,d,f,p)=>({payload:f,error:(n&&n.serializeError||wu)(u||"Rejected"),meta:{...p||{},arg:d,requestId:c,rejectedWithValue:!!f,requestStatus:"rejected",aborted:(u==null?void 0:u.name)==="AbortError",condition:(u==null?void 0:u.name)==="ConditionError"}}));function s(u){return(c,d,f)=>{let p=n!=null&&n.idGenerator?n.idGenerator(u):Oi(),w=new AbortController,C,l;function g(q){l=q,w.abort()}let S=async function(){var M,z;let q;try{let _=(M=n==null?void 0:n.condition)==null?void 0:M.call(n,u,{getState:d,extra:f});if(bu(_)&&(_=await _),_===!1||w.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};let W=new Promise((P,G)=>{C=()=>{G({name:"AbortError",message:l||"Aborted"})},w.signal.addEventListener("abort",C)});c(a(p,u,(z=n==null?void 0:n.getPendingMeta)==null?void 0:z.call(n,{requestId:p,arg:u},{getState:d,extra:f}))),q=await Promise.race([W,Promise.resolve(r(u,{dispatch:c,getState:d,extra:f,requestId:p,signal:w.signal,abort:g,rejectWithValue:(P,G)=>new tr(P,G),fulfillWithValue:(P,G)=>new In(P,G)})).then(P=>{if(P instanceof tr)throw P;return P instanceof In?i(P.payload,p,u,P.meta):i(P,p,u)})])}catch(_){q=_ instanceof tr?o(null,p,u,_.payload,_.meta):o(_,p,u)}finally{C&&w.signal.removeEventListener("abort",C)}return n&&!n.dispatchConditionRejection&&o.match(q)&&q.meta.condition||c(q),q}();return Object.assign(S,{abort:g,requestId:p,arg:u,unwrap(){return S.then(Su)}})}}return Object.assign(s,{pending:a,rejected:o,fulfilled:i,settled:yu(o,i),typePrefix:t})}return e.withTypes=()=>e,e})();function Su(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function bu(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var ku=(e,t)=>{if(typeof e!="function")throw new Error(je(32))},Tr="listenerMiddleware",Cu=e=>{let{type:t,actionCreator:r,matcher:n,predicate:i,effect:a}=e;if(t)i=k(t).match;else if(r)t=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(je(21));return ku(a),{predicate:i,type:t,effect:a}},Iu=Object.assign(e=>{let{type:t,predicate:r,effect:n}=Cu(e);return{id:Oi(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(je(22))}}},{withTypes:()=>Iu}),Ou=Object.assign(k(`${Tr}/add`),{withTypes:()=>Ou});k(`${Tr}/removeAll`);var qu=Object.assign(k(`${Tr}/remove`),{withTypes:()=>qu});function je(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var T=new U({required:!0,emptyAllowed:!1}),ae=new U({required:!1,emptyAllowed:!1}),Ce=new U({required:!0,emptyAllowed:!0});new U({required:!1,emptyAllowed:!0});var Au=new le({each:T,required:!0}),Eu=new U({required:!1,emptyAllowed:!1,regex:/^\d+\.\d+\.\d+$/}),Xe=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),He=(e,t)=>{if("required"in t)return{payload:new Ze({value:t}).validate({value:e}).value};let r=new Q({options:{required:!0},values:t}).validate(e);if(r)throw new ei(r);return{payload:e}},E=(e,t)=>{try{return He(e,t)}catch(r){return{payload:e,error:Xe(r)}}},Du=(e,t,r,n)=>{let i=`Check the options of ${n}`;return Ru(e,t,r,i,"Controller initialization error")},Ru=(e,t,r,n,i)=>{try{return t.validate(r,n)}catch(a){throw e.logger.error(a,i),a}},_r="2.63.3",xu=["@coveo/atomic","@coveo/quantic"],rr=()=>ae,qi=()=>T,Lt=k("configuration/updateBasicConfiguration",e=>E(e,{accessToken:ae,organizationId:ae,platformUrl:ae})),ft=k("configuration/updateSearchConfiguration",e=>E(e,{apiBaseUrl:ae,pipeline:new U({required:!1,emptyAllowed:!0}),searchHub:ae,timezone:ae,locale:ae,authenticationProviders:new le({required:!1,each:T})})),Uu={enabled:new K({default:!0}),originContext:rr(),originLevel2:rr(),originLevel3:rr(),apiBaseUrl:ae,nextApiBaseUrl:ae,runtimeEnvironment:new ce,anonymous:new K({default:!1}),deviceId:ae,userDisplayName:ae,documentLocation:ae,trackingId:ae,analyticsMode:new U({constrainTo:["legacy","next"],required:!1,default:"legacy"}),source:new Q({options:{required:!1},values:xu.reduce((e,t)=>(e[t]=Eu,e),{})})},jr=k("configuration/updateAnalyticsConfiguration",e=>(ii()&&(e.enabled=!1),E(e,Uu))),Pr=k("configuration/analytics/disable"),$r=k("configuration/analytics/enable"),Ai=k("configuration/analytics/originlevel2",e=>E(e,{originLevel2:qi()})),Ei=k("configuration/analytics/originlevel3",e=>E(e,{originLevel3:qi()})),Fu={q:new U,enableQuerySyntax:new K,aq:new U,cq:new U,firstResult:new Y({min:0}),numberOfResults:new Y({min:0}),sortCriteria:new U,f:new Q,fExcluded:new Q,cf:new Q,nf:new Q,df:new Q,debug:new K,sf:new Q,tab:new U,af:new Q},Qt=k("searchParameters/restore",e=>E(e,Fu)),Mu=k("debug/enable"),Tu=k("debug/disable"),Di=()=>!1,_u=Ie(Di(),e=>{e.addCase(Mu,()=>!0).addCase(Tu,()=>!1).addCase(Qt,(t,r)=>r.payload.debug??t)}),Ri=k("pipeline/set",e=>E(e,new U({required:!0,emptyAllowed:!0}))),ju=k("history/undo"),Pu=k("history/redo"),Fe=k("history/snapshot");ne("history/back",async(e,{dispatch:t})=>{t(ju()),await t(Pe())});ne("history/forward",async(e,{dispatch:t})=>{t(Pu()),await t(Pe())});var Pe=ne("history/change",async(e,{getState:t})=>t().history.present),Lr=()=>"",xi=Ie(Lr(),e=>{e.addCase(Ri,(t,r)=>r.payload).addCase(Pe.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.pipeline)??t}).addCase(ft,(t,r)=>r.payload.pipeline||t)});function qe(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function m(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function u(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?a(d.value):i(d.value).then(s,u)}c((n=n.apply(e,[])).next())})}var L;(function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect"})(L||(L={}));function On(){return typeof window<"u"}function Qr(){return typeof navigator<"u"}function mr(){return typeof document<"u"}function yr(){try{return typeof localStorage<"u"}catch{return!1}}function $u(){try{return typeof sessionStorage<"u"}catch{return!1}}function Ui(){return Qr()&&navigator.cookieEnabled}var Lu=[L.click,L.custom,L.search,L.view],Qu=(e,t)=>Lu.indexOf(e)!==-1?Object.assign({language:mr()?document.documentElement.lang:"unknown",userAgent:Qr()?navigator.userAgent:"unknown"},t):t,nr=class Fi{static set(t,r,n){var i,a,o,s;n&&(a=new Date,a.setTime(a.getTime()+n)),s=window.location.hostname,s.indexOf(".")===-1?qn(t,r,a):(o=s.split("."),i=o[o.length-2]+"."+o[o.length-1],qn(t,r,a,i))}static get(t){for(var r=t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){var a=n[i];if(a=a.replace(/^\s+/,""),a.lastIndexOf(r,0)===0)return a.substring(r.length,a.length)}return null}static erase(t){Fi.set(t,"",-1)}};function qn(e,t,r,n){document.cookie=`${e}=${t}`+(r?`;expires=${r.toUTCString()}`:"")+(n?`;domain=${n}`:"")+";path=/;SameSite=Lax"}function Vu(){return yr()?localStorage:Ui()?new Vr:$u()?sessionStorage:new Vt}var Vr=class bt{getItem(t){return nr.get(`${bt.prefix}${t}`)}removeItem(t){nr.erase(`${bt.prefix}${t}`)}setItem(t,r,n){nr.set(`${bt.prefix}${t}`,r,n)}};Vr.prefix="coveo_";var zu=class{constructor(){this.cookieStorage=new Vr}getItem(e){return localStorage.getItem(e)||this.cookieStorage.getItem(e)}removeItem(e){this.cookieStorage.removeItem(e),localStorage.removeItem(e)}setItem(e,t){localStorage.setItem(e,t),this.cookieStorage.setItem(e,t,31556926e3)}},Vt=class{getItem(e){return null}removeItem(e){}setItem(e,t){}},ot="__coveo.analytics.history",Mi=20,Ti=1e3*60,_i=75,Rt=class{constructor(e){this.store=e||Vu()}addElement(e){e.internalTime=new Date().getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=this.getHistoryWithInternalTime();t!=null?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}addElementAsync(e){return m(this,void 0,void 0,function*(){e.internalTime=new Date().getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=yield this.getHistoryWithInternalTimeAsync();t!=null?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])})}getHistory(){let e=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(e))}getHistoryAsync(){return m(this,void 0,void 0,function*(){let e=yield this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(e))})}getHistoryWithInternalTime(){try{let e=this.store.getItem(ot);return e&&typeof e=="string"?JSON.parse(e):[]}catch{return[]}}getHistoryWithInternalTimeAsync(){return m(this,void 0,void 0,function*(){try{let e=yield this.store.getItem(ot);return e?JSON.parse(e):[]}catch{return[]}})}setHistory(e){try{this.store.setItem(ot,JSON.stringify(e.slice(0,Mi)))}catch{}}clear(){try{this.store.removeItem(ot)}catch{}}getMostRecentElement(){let e=this.getHistoryWithInternalTime();return Array.isArray(e)?e.sort((t,r)=>(r.internalTime||0)-(t.internalTime||0))[0]:null}cropQueryElement(e){return e.name&&e.value&&e.name.toLowerCase()==="query"&&(e.value=e.value.slice(0,_i)),e}isValidEntry(e){let t=this.getMostRecentElement();return t&&t.value==e.value?(e.internalTime||0)-(t.internalTime||0)>Ti:!0}stripInternalTime(e){return Array.isArray(e)?e.map(t=>{let{name:r,time:n,value:i}=t;return{name:r,time:n,value:i}}):[]}stripEmptyQuery(e){let{name:t,time:r,value:n}=e;return t&&typeof n=="string"&&t.toLowerCase()==="query"&&n.trim()===""?{name:t,time:r}:e}stripEmptyQueries(e){return e.map(t=>this.stripEmptyQuery(t))}},Nu=Object.freeze({__proto__:null,HistoryStore:Rt,MAX_NUMBER_OF_HISTORY_ELEMENTS:Mi,MAX_VALUE_SIZE:_i,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:Ti,STORE_KEY:ot,default:Rt}),Hu=(e,t)=>m(void 0,void 0,void 0,function*(){return e===L.view?(yield Yu(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t}),Yu=e=>m(void 0,void 0,void 0,function*(){let t=new Rt,r={name:"PageView",value:e,time:new Date().toISOString()};yield t.addElementAsync(r)}),wt,Bu=new Uint8Array(16);function Wu(){if(!wt&&(wt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!wt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return wt(Bu)}var Gu=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function xt(e){return typeof e=="string"&&Gu.test(e)}var se=[];for(let e=0;e<256;++e)se.push((e+256).toString(16).slice(1));function ji(e,t=0){return(se[e[t+0]]+se[e[t+1]]+se[e[t+2]]+se[e[t+3]]+"-"+se[e[t+4]]+se[e[t+5]]+"-"+se[e[t+6]]+se[e[t+7]]+"-"+se[e[t+8]]+se[e[t+9]]+"-"+se[e[t+10]]+se[e[t+11]]+se[e[t+12]]+se[e[t+13]]+se[e[t+14]]+se[e[t+15]]).toLowerCase()}function Ju(e){if(!xt(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}function Ku(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var Zu="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Xu="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function ec(e,t,r){function n(i,a,o,s){var u;if(typeof i=="string"&&(i=Ku(i)),typeof a=="string"&&(a=Ju(a)),((u=a)===null||u===void 0?void 0:u.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+i.length);if(c.set(a),c.set(i,a.length),c=r(c),c[6]=c[6]&15|t,c[8]=c[8]&63|128,o){s=s||0;for(let d=0;d<16;++d)o[s+d]=c[d];return o}return ji(c)}try{n.name=e}catch{}return n.DNS=Zu,n.URL=Xu,n}var tc=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),An={randomUUID:tc};function ir(e,t,r){if(An.randomUUID&&!t&&!e)return An.randomUUID();e=e||{};let n=e.random||(e.rng||Wu)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,ji(n)}function rc(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function ar(e,t){return e<<t|e>>>32-t}function nc(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){let o=unescape(encodeURIComponent(e));e=[];for(let s=0;s<o.length;++s)e.push(o.charCodeAt(s))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=e.length/4+2,i=Math.ceil(n/16),a=new Array(i);for(let o=0;o<i;++o){let s=new Uint32Array(16);for(let u=0;u<16;++u)s[u]=e[o*64+u*4]<<24|e[o*64+u*4+1]<<16|e[o*64+u*4+2]<<8|e[o*64+u*4+3];a[o]=s}a[i-1][14]=(e.length-1)*8/Math.pow(2,32),a[i-1][14]=Math.floor(a[i-1][14]),a[i-1][15]=(e.length-1)*8&4294967295;for(let o=0;o<i;++o){let s=new Uint32Array(80);for(let w=0;w<16;++w)s[w]=a[o][w];for(let w=16;w<80;++w)s[w]=ar(s[w-3]^s[w-8]^s[w-14]^s[w-16],1);let u=r[0],c=r[1],d=r[2],f=r[3],p=r[4];for(let w=0;w<80;++w){let C=Math.floor(w/20),l=ar(u,5)+rc(C,c,d,f)+p+t[C]+s[w]>>>0;p=f,f=d,d=ar(c,30)>>>0,c=u,u=l}r[0]=r[0]+u>>>0,r[1]=r[1]+c>>>0,r[2]=r[2]+d>>>0,r[3]=r[3]+f>>>0,r[4]=r[4]+p>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var ic=ec("v5",80,nc),En=ic,Pi="2.30.2",ac={pageview:"pageview",event:"event"},Ut=class vr{constructor(t,r){if(!xt(t))throw Error("Not a valid uuid");this.clientId=t,this.creationDate=Math.floor(r/1e3)}toString(){return this.clientId.replace(/-/g,"")+"."+this.creationDate.toString()}get expired(){let t=Math.floor(Date.now()/1e3)-this.creationDate;return t<0||t>vr.expirationTime}validate(t,r){return!this.expired&&this.matchReferrer(t,r)}matchReferrer(t,r){try{let n=new URL(t);return r.some(i=>new RegExp(i.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(n.host))}catch{return!1}}static fromString(t){let r=t.split(".");if(r.length!==2)return null;let[n,i]=r;if(n.length!==32||isNaN(parseInt(i)))return null;let a=n.substring(0,8)+"-"+n.substring(8,12)+"-"+n.substring(12,16)+"-"+n.substring(16,20)+"-"+n.substring(20,32);return xt(a)?new vr(a,Number.parseInt(i)*1e3):null}};Ut.cvo_cid="cvo_cid";Ut.expirationTime=120;var Oe=Object.keys;function St(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}var Dn={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},oc=Oe(Dn).map(e=>Dn[e]),sc=[...oc].join("|"),uc=new RegExp(`^(${sc}$)`),cc={svcAction:"svc_action",svcActionData:"svc_action_data"},lc=e=>uc.test(e),dc=[lc],Rn={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},xn={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr",group:"group"},fe={action:"pa",list:"pal",listSource:"pls"},Ft={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},hc=["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit"],wr={id:"quoteId",affiliation:"quoteAffiliation"},Sr={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},fc={add:fe,bookmark_add:fe,bookmark_remove:fe,click:fe,checkout:fe,checkout_option:fe,detail:fe,impression:fe,remove:fe,refund:Object.assign(Object.assign({},fe),Ft),purchase:Object.assign(Object.assign({},fe),Ft),quickview:fe,quote:Object.assign(Object.assign({},fe),wr),review:Object.assign(Object.assign({},fe),Sr)},pc=Oe(Rn).map(e=>Rn[e]),gc=Oe(xn).map(e=>xn[e]),mc=Oe(fe).map(e=>fe[e]),yc=Oe(Ft).map(e=>Ft[e]),vc=Oe(Sr).map(e=>Sr[e]),wc=Oe(wr).map(e=>wr[e]),Sc=[...pc,"custom"].join("|"),bc=[...gc,"custom"].join("|"),$i="(pr[0-9]+)",Li="(il[0-9]+pi[0-9]+)",kc=new RegExp(`^${$i}(${Sc})$`),Cc=new RegExp(`^(${Li}(${bc}))|(il[0-9]+nm)$`),Ic=new RegExp(`^(${mc.join("|")})$`),Oc=new RegExp(`^(${yc.join("|")})$`),qc=new RegExp(`^${$i}custom$`),Ac=new RegExp(`^${Li}custom$`),Ec=new RegExp(`^(${[...hc,...vc,...wc].join("|")})$`),Dc=e=>kc.test(e),Rc=e=>Cc.test(e),xc=e=>Ic.test(e),Uc=e=>Oc.test(e),Fc=e=>Ec.test(e),Mc=[Rc,Dc,xc,Uc,Fc],Tc=[qc,Ac],_c={anonymizeIp:"aip"},jc={eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"},Pc={hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"},$c=["contentId","contentIdKey","contentType","searchHub","tab","searchUid","permanentId","contentLocale","trackingId"],Lc=Object.assign(Object.assign(Object.assign(Object.assign({},_c),jc),Pc),$c.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:t}),{})),br=Object.assign(Object.assign({},Lc),cc),Qc=e=>{let t=!!e.action&&fc[e.action]||{};return Oe(e).reduce((r,n)=>{let i=t[n]||br[n]||n;return Object.assign(Object.assign({},r),{[i]:e[n]})},{})},Vc=Oe(br).map(e=>br[e]),zc=e=>Vc.indexOf(e)!==-1,Nc=e=>e==="custom",Hc=e=>[...Mc,...dc,zc,Nc].some(t=>t(e)),Yc=e=>Oe(e).reduce((t,r)=>{let n=Bc(r);return n?Object.assign(Object.assign({},t),Wc(n,e[r])):Object.assign(Object.assign({},t),{[r]:e[r]})},{}),Bc=e=>{let t;return[...Tc].every(r=>{var n;return t=(n=r.exec(e))===null||n===void 0?void 0:n[1],!t}),t},Wc=(e,t)=>Oe(t).reduce((r,n)=>Object.assign(Object.assign({},r),{[`${e}${n}`]:t[n]}),{}),Gc=class{constructor(e){this.opts=e}sendEvent(e,t){return m(this,void 0,void 0,function*(){if(!this.isAvailable())throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');let{baseUrl:r,preprocessRequest:n}=this.opts,i=yield this.getQueryParamsForEventType(e),{url:a,payload:o}=yield this.preProcessRequestAsPotentialJSONString(`${r}/analytics/${e}?${i}`,t,n),s=this.encodeForEventType(e,o),u=new Blob([s],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(a,u)})}isAvailable(){return"sendBeacon"in navigator}deleteHttpCookieVisitorId(){return Promise.resolve()}preProcessRequestAsPotentialJSONString(e,t,r){return m(this,void 0,void 0,function*(){let n=e,i=t;if(r){let a=yield r({url:e,body:JSON.stringify(t)},"analyticsBeacon"),{url:o,body:s}=a;n=o||e;try{i=JSON.parse(s)}catch(u){console.error("Unable to process the request body as a JSON string",u)}}return{payload:i,url:n}})}encodeForEventType(e,t){return this.isEventTypeLegacy(e)?this.encodeEventToJson(e,t):this.encodeEventToJson(e,t,this.opts.token)}getQueryParamsForEventType(e){return m(this,void 0,void 0,function*(){let{token:t,visitorIdProvider:r}=this.opts,n=yield r.getCurrentVisitorId();return[t&&this.isEventTypeLegacy(e)?`access_token=${t}`:"",n?`visitorId=${n}`:"","discardVisitInfo=true"].filter(i=>!!i).join("&")})}isEventTypeLegacy(e){return[L.click,L.custom,L.search,L.view].indexOf(e)!==-1}encodeEventToJson(e,t,r){let n=`${e}Event=${encodeURIComponent(JSON.stringify(t))}`;return r&&(n=`access_token=${encodeURIComponent(r)}&${n}`),n}},Jc=class{sendEvent(e,t){return m(this,void 0,void 0,function*(){return Promise.resolve()})}deleteHttpCookieVisitorId(){return m(this,void 0,void 0,function*(){return Promise.resolve()})}},Un=window.fetch,Qi=class{constructor(e){this.opts=e}sendEvent(e,t){return m(this,void 0,void 0,function*(){let{baseUrl:r,visitorIdProvider:n,preprocessRequest:i}=this.opts,a=this.shouldAppendVisitorId(e)?yield this.getVisitorIdParam():"",o={url:`${r}/analytics/${e}${a}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(t)},s=Object.assign(Object.assign({},o),i?yield i(o,"analyticsFetch"):{}),{url:u}=s,c=qe(s,["url"]),d;try{d=yield Un(u,c)}catch(f){console.error("An error has occured when sending the event.",f);return}if(d.ok){let f=yield d.json();return f.visitorId&&n.setCurrentVisitorId(f.visitorId),f}else{try{d.json()}catch{}throw console.error(`An error has occured when sending the "${e}" event.`,d,t),new Error(`An error has occurred when sending the "${e}" event. Check the console logs for more details.`)}})}deleteHttpCookieVisitorId(){return m(this,void 0,void 0,function*(){let{baseUrl:e}=this.opts,t=`${e}/analytics/visit`;yield Un(t,{headers:this.getHeaders(),method:"DELETE"})})}shouldAppendVisitorId(e){return[L.click,L.custom,L.search,L.view].indexOf(e)!==-1}getVisitorIdParam(){return m(this,void 0,void 0,function*(){let{visitorIdProvider:e}=this.opts,t=yield e.getCurrentVisitorId();return t?`?visitor=${t}`:""})}getHeaders(){let{token:e}=this.opts;return Object.assign(Object.assign({},e?{Authorization:`Bearer ${e}`}:{}),{"Content-Type":"application/json"})}},Kc=class{constructor(e,t){yr()&&Ui()?this.storage=new zu:yr()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new Vt),this.client=new Qi(e),this.beaconClient=new Gc(e),window.addEventListener("beforeunload",()=>{let r=t();for(let{eventType:n,payload:i}of r)this.beaconClient.sendEvent(n,i)})}getClientDependingOnEventType(e){return e==="click"&&this.beaconClient.isAvailable()?this.beaconClient:this.client}},Zc=class{constructor(e,t){this.storage=t||new Vt,this.client=new Qi(e)}getClientDependingOnEventType(e){return this.client}},Vi=class{constructor(){this.storage=new Vt,this.client=new Jc}getClientDependingOnEventType(e){return this.client}},Xc="xx",el=e=>(e==null?void 0:e.startsWith(Xc))||!1,tl=`
        We've detected you're using React Native but have not provided the corresponding runtime, 
        for an optimal experience please use the "coveo.analytics/react-native" subpackage.
        Follow the Readme on how to set it up: https://github.com/coveo/coveo.analytics.js#using-react-native
    `;function rl(){return typeof navigator<"u"&&navigator.product=="ReactNative"}var nl=["1",1,"yes",!0];function kr(){return Qr()&&[navigator.globalPrivacyControl,navigator.doNotTrack,navigator.msDoNotTrack,window.doNotTrack].some(e=>nl.indexOf(e)!==-1)}var zi="v15",Ni={default:"https://analytics.cloud.coveo.com/rest/ua",production:"https://analytics.cloud.coveo.com/rest/ua",hipaa:"https://analyticshipaa.cloud.coveo.com/rest/ua"};function il(e=Ni.default,t=zi,r=!1){if(e=e.replace(/\/$/,""),r)return`${e}/${t}`;let n=e.endsWith("/rest")||e.endsWith("/rest/ua");return`${e}${n?"":"/rest"}/${t}`}var al="38824e1f-37f5-42d3-8372-a4b8fa9df946",kt=class{get defaultOptions(){return{endpoint:Ni.default,isCustomEndpoint:!1,token:"",version:zi,beforeSendHooks:[],afterSendHooks:[]}}get version(){return Pi}constructor(e){if(this.acceptedLinkReferrers=[],!e)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[Hu,Qu].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};let t={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};kr()?this.runtime=new Vi:this.runtime=this.options.runtimeEnvironment||this.initRuntime(t),this.addEventTypeMapping(L.view,{newEventType:L.view,addClientIdParameter:!0}),this.addEventTypeMapping(L.click,{newEventType:L.click,addClientIdParameter:!0}),this.addEventTypeMapping(L.custom,{newEventType:L.custom,addClientIdParameter:!0}),this.addEventTypeMapping(L.search,{newEventType:L.search,addClientIdParameter:!0})}initRuntime(e){return On()&&mr()?new Kc(e,()=>{let t=[...this.bufferedRequests];return this.bufferedRequests=[],t}):(rl()&&console.warn(tl),new Zc(e))}get storage(){return this.runtime.storage}determineVisitorId(){return m(this,void 0,void 0,function*(){try{return On()&&this.extractClientIdFromLink(window.location.href)||(yield this.storage.getItem("visitorId"))||ir()}catch(e){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",e),ir()}})}getCurrentVisitorId(){return m(this,void 0,void 0,function*(){if(!this.visitorId){let e=yield this.determineVisitorId();yield this.setCurrentVisitorId(e)}return this.visitorId})}setCurrentVisitorId(e){return m(this,void 0,void 0,function*(){this.visitorId=e,yield this.storage.setItem("visitorId",e)})}setClientId(e,t){return m(this,void 0,void 0,function*(){if(xt(e))this.setCurrentVisitorId(e.toLowerCase());else{if(!t)throw Error("Cannot generate uuid client id without a specific namespace string.");this.setCurrentVisitorId(En(e,En(t,al)))}})}getParameters(e,...t){return m(this,void 0,void 0,function*(){return yield this.resolveParameters(e,...t)})}getPayload(e,...t){return m(this,void 0,void 0,function*(){let r=yield this.resolveParameters(e,...t);return yield this.resolvePayloadForParameters(e,r)})}get currentVisitorId(){return typeof(this.visitorId||this.storage.getItem("visitorId"))!="string"&&this.setCurrentVisitorId(ir()),this.visitorId}set currentVisitorId(e){this.visitorId=e,this.storage.setItem("visitorId",e)}extractClientIdFromLink(e){if(kr())return null;try{let t=new URL(e).searchParams.get(Ut.cvo_cid);if(t==null)return null;let r=Ut.fromString(t);return!r||!mr()||!r.validate(document.referrer,this.acceptedLinkReferrers)?null:r.clientId}catch{}return null}resolveParameters(e,...t){return m(this,void 0,void 0,function*(){let{variableLengthArgumentsNames:r=[],addVisitorIdParameter:n=!1,usesMeasurementProtocol:i=!1,addClientIdParameter:a=!1}=this.eventTypeMapping[e]||{};return yield[o=>r.length>0?this.parseVariableArgumentsPayload(r,o):o[0],o=>m(this,void 0,void 0,function*(){return Object.assign(Object.assign({},o),{visitorId:n?yield this.getCurrentVisitorId():""})}),o=>m(this,void 0,void 0,function*(){return a?Object.assign(Object.assign({},o),{clientId:yield this.getCurrentVisitorId()}):o}),o=>i?this.ensureAnonymousUserWhenUsingApiKey(o):o,o=>this.beforeSendHooks.reduce((s,u)=>m(this,void 0,void 0,function*(){let c=yield s;return yield u(e,c)}),o)].reduce((o,s)=>m(this,void 0,void 0,function*(){let u=yield o;return yield s(u)}),Promise.resolve(t))})}resolvePayloadForParameters(e,t){return m(this,void 0,void 0,function*(){let{usesMeasurementProtocol:r=!1}=this.eventTypeMapping[e]||{};return yield[n=>this.setTrackingIdIfTrackingIdNotPresent(n),n=>this.removeEmptyPayloadValues(n,e),n=>this.validateParams(n,e),n=>r?Qc(n):n,n=>r?this.removeUnknownParameters(n):n,n=>r?this.processCustomParameters(n):this.mapCustomParametersToCustomData(n)].reduce((n,i)=>m(this,void 0,void 0,function*(){let a=yield n;return yield i(a)}),Promise.resolve(t))})}makeEvent(e,...t){return m(this,void 0,void 0,function*(){let{newEventType:r=e}=this.eventTypeMapping[e]||{},n=yield this.resolveParameters(e,...t),i=yield this.resolvePayloadForParameters(e,n);return{eventType:r,payload:i,log:a=>m(this,void 0,void 0,function*(){return this.bufferedRequests.push({eventType:r,payload:Object.assign(Object.assign({},i),a)}),yield Promise.all(this.afterSendHooks.map(o=>o(e,Object.assign(Object.assign({},n),a)))),yield this.deferExecution(),yield this.sendFromBuffer()})}})}sendEvent(e,...t){return m(this,void 0,void 0,function*(){return(yield this.makeEvent(e,...t)).log({})})}deferExecution(){return new Promise(e=>setTimeout(e,0))}sendFromBuffer(){return m(this,void 0,void 0,function*(){let e=this.bufferedRequests.shift();if(e){let{eventType:t,payload:r}=e;return this.runtime.getClientDependingOnEventType(t).sendEvent(t,r)}})}clear(){this.storage.removeItem("visitorId"),new Rt().clear()}deleteHttpOnlyVisitorId(){this.runtime.client.deleteHttpCookieVisitorId()}makeSearchEvent(e){return m(this,void 0,void 0,function*(){return this.makeEvent(L.search,e)})}sendSearchEvent(e){var{searchQueryUid:t}=e,r=qe(e,["searchQueryUid"]);return m(this,void 0,void 0,function*(){return(yield this.makeSearchEvent(r)).log({searchQueryUid:t})})}makeClickEvent(e){return m(this,void 0,void 0,function*(){return this.makeEvent(L.click,e)})}sendClickEvent(e){var{searchQueryUid:t}=e,r=qe(e,["searchQueryUid"]);return m(this,void 0,void 0,function*(){return(yield this.makeClickEvent(r)).log({searchQueryUid:t})})}makeCustomEvent(e){return m(this,void 0,void 0,function*(){return this.makeEvent(L.custom,e)})}sendCustomEvent(e){var{lastSearchQueryUid:t}=e,r=qe(e,["lastSearchQueryUid"]);return m(this,void 0,void 0,function*(){return(yield this.makeCustomEvent(r)).log({lastSearchQueryUid:t})})}makeViewEvent(e){return m(this,void 0,void 0,function*(){return this.makeEvent(L.view,e)})}sendViewEvent(e){return m(this,void 0,void 0,function*(){return(yield this.makeViewEvent(e)).log({})})}getVisit(){return m(this,void 0,void 0,function*(){let e=yield(yield fetch(`${this.baseUrl}/analytics/visit`)).json();return this.visitorId=e.visitorId,e})}getHealth(){return m(this,void 0,void 0,function*(){return yield(yield fetch(`${this.baseUrl}/analytics/monitoring/health`)).json()})}registerBeforeSendEventHook(e){this.beforeSendHooks.push(e)}registerAfterSendEventHook(e){this.afterSendHooks.push(e)}addEventTypeMapping(e,t){this.eventTypeMapping[e]=t}setAcceptedLinkReferrers(e){if(Array.isArray(e)&&e.every(t=>typeof t=="string"))this.acceptedLinkReferrers=e;else throw Error("Parameter should be an array of domain strings")}parseVariableArgumentsPayload(e,t){let r={};for(let n=0,i=t.length;n<i;n++){let a=t[n];if(typeof a=="string")r[e[n]]=a;else if(typeof a=="object")return Object.assign(Object.assign({},r),a)}return r}isKeyAllowedEmpty(e,t){return({[L.search]:["queryText"]}[e]||[]).indexOf(t)!==-1}removeEmptyPayloadValues(e,t){let r=n=>typeof n<"u"&&n!==null&&n!=="";return Object.keys(e).filter(n=>this.isKeyAllowedEmpty(t,n)||r(e[n])).reduce((n,i)=>Object.assign(Object.assign({},n),{[i]:e[i]}),{})}removeUnknownParameters(e){return Object.keys(e).filter(t=>{if(Hc(t))return!0;console.log(t,"is not processed by coveoua")}).reduce((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]}),{})}processCustomParameters(e){let{custom:t}=e,r=qe(e,["custom"]),n={};t&&St(t)&&(n=this.lowercaseKeys(t));let i=Yc(r);return Object.assign(Object.assign({},n),i)}mapCustomParametersToCustomData(e){let{custom:t}=e,r=qe(e,["custom"]);if(t&&St(t)){let n=this.lowercaseKeys(t);return Object.assign(Object.assign({},r),{customData:Object.assign(Object.assign({},n),e.customData)})}else return e}lowercaseKeys(e){let t=Object.keys(e),r={};return t.forEach(n=>{r[n.toLowerCase()]=e[n]}),r}validateParams(e,t){let{anonymizeIp:r}=e,n=qe(e,["anonymizeIp"]);return r!==void 0&&["0","false","undefined","null","{}","[]",""].indexOf(`${r}`.toLowerCase())==-1&&(n.anonymizeIp=1),(t==L.view||t==L.click||t==L.search||t==L.custom)&&(n.originLevel3=this.limit(n.originLevel3,128)),t==L.view&&(n.location=this.limit(n.location,128)),(t=="pageview"||t=="event")&&(n.referrer=this.limit(n.referrer,2048),n.location=this.limit(n.location,2048),n.page=this.limit(n.page,2048)),n}ensureAnonymousUserWhenUsingApiKey(e){let{userId:t}=e,r=qe(e,["userId"]);return el(this.options.token)&&!t?(r.userId="anonymous",r):e}setTrackingIdIfTrackingIdNotPresent(e){let{trackingId:t}=e,r=qe(e,["trackingId"]);return t?e:(r.hasOwnProperty("custom")&&St(r.custom)&&(r.custom.hasOwnProperty("context_website")||r.custom.hasOwnProperty("siteName"))&&(r.trackingId=r.custom.context_website||r.custom.siteName),r.hasOwnProperty("customData")&&St(r.customData)&&(r.customData.hasOwnProperty("context_website")||r.customData.hasOwnProperty("siteName"))&&(r.trackingId=r.customData.context_website||r.customData.siteName),r)}limit(e,t){return typeof e!="string"?e:e.substring(0,t)}get baseUrl(){return il(this.options.endpoint,this.options.version,this.options.isCustomEndpoint)}},Ae;(function(e){e.contextChanged="contextChanged",e.expandToFullUI="expandToFullUI",e.openUserActions="openUserActions",e.showPrecedingSessions="showPrecedingSessions",e.showFollowingSessions="showFollowingSessions",e.clickViewedDocument="clickViewedDocument",e.clickPageView="clickPageView",e.createArticle="createArticle"})(Ae||(Ae={}));var v;(function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.undoTriggerQuery="undoQuery",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.staticFilterClearAll="staticFilterClearAll",e.staticFilterSelect="staticFilterSelect",e.staticFilterDeselect="staticFilterDeselect",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",e.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",e.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",e.openSmartSnippetSource="openSmartSnippetSource",e.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",e.openSmartSnippetInlineLink="openSmartSnippetInlineLink",e.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",e.recentQueryClick="recentQueriesClick",e.clearRecentQueries="clearRecentQueries",e.recentResultClick="recentResultClick",e.clearRecentResults="clearRecentResults",e.noResultsBack="noResultsBack",e.showMoreFoldedResults="showMoreFoldedResults",e.showLessFoldedResults="showLessFoldedResults",e.copyToClipboard="copyToClipboard",e.caseSendEmail="Case.SendEmail",e.feedItemTextPost="FeedItem.TextPost",e.caseAttach="caseAttach",e.caseDetach="caseDetach",e.retryGeneratedAnswer="retryGeneratedAnswer",e.likeGeneratedAnswer="likeGeneratedAnswer",e.dislikeGeneratedAnswer="dislikeGeneratedAnswer",e.openGeneratedAnswerSource="openGeneratedAnswerSource",e.generatedAnswerStreamEnd="generatedAnswerStreamEnd",e.generatedAnswerSourceHover="generatedAnswerSourceHover",e.generatedAnswerCopyToClipboard="generatedAnswerCopyToClipboard",e.generatedAnswerHideAnswers="generatedAnswerHideAnswers",e.generatedAnswerShowAnswers="generatedAnswerShowAnswers",e.generatedAnswerExpand="generatedAnswerExpand",e.generatedAnswerCollapse="generatedAnswerCollapse",e.generatedAnswerFeedbackSubmit="generatedAnswerFeedbackSubmit",e.rephraseGeneratedAnswer="rephraseGeneratedAnswer"})(v||(v={}));var Fn={[v.triggerNotify]:"queryPipelineTriggers",[v.triggerExecute]:"queryPipelineTriggers",[v.triggerQuery]:"queryPipelineTriggers",[v.triggerRedirect]:"queryPipelineTriggers",[v.queryError]:"errors",[v.queryErrorBack]:"errors",[v.queryErrorClear]:"errors",[v.queryErrorRetry]:"errors",[v.pagerNext]:"getMoreResults",[v.pagerPrevious]:"getMoreResults",[v.pagerNumber]:"getMoreResults",[v.pagerResize]:"getMoreResults",[v.pagerScrolling]:"getMoreResults",[v.facetSearch]:"facet",[v.facetShowLess]:"facet",[v.facetShowMore]:"facet",[v.recommendation]:"recommendation",[v.likeSmartSnippet]:"smartSnippet",[v.dislikeSmartSnippet]:"smartSnippet",[v.expandSmartSnippet]:"smartSnippet",[v.collapseSmartSnippet]:"smartSnippet",[v.openSmartSnippetFeedbackModal]:"smartSnippet",[v.closeSmartSnippetFeedbackModal]:"smartSnippet",[v.sendSmartSnippetReason]:"smartSnippet",[v.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[v.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions",[v.showMoreSmartSnippetSuggestion]:"smartSnippetSuggestions",[v.showLessSmartSnippetSuggestion]:"smartSnippetSuggestions",[v.clearRecentQueries]:"recentQueries",[v.recentResultClick]:"recentlyClickedDocuments",[v.clearRecentResults]:"recentlyClickedDocuments",[v.showLessFoldedResults]:"folding",[v.caseDetach]:"case",[v.likeGeneratedAnswer]:"generatedAnswer",[v.dislikeGeneratedAnswer]:"generatedAnswer",[v.openGeneratedAnswerSource]:"generatedAnswer",[v.generatedAnswerStreamEnd]:"generatedAnswer",[v.generatedAnswerSourceHover]:"generatedAnswer",[v.generatedAnswerCopyToClipboard]:"generatedAnswer",[v.generatedAnswerHideAnswers]:"generatedAnswer",[v.generatedAnswerShowAnswers]:"generatedAnswer",[v.generatedAnswerExpand]:"generatedAnswer",[v.generatedAnswerCollapse]:"generatedAnswer",[v.generatedAnswerFeedbackSubmit]:"generatedAnswer",[Ae.expandToFullUI]:"interface",[Ae.openUserActions]:"User Actions",[Ae.showPrecedingSessions]:"User Actions",[Ae.showFollowingSessions]:"User Actions",[Ae.clickViewedDocument]:"User Actions",[Ae.clickPageView]:"User Actions",[Ae.createArticle]:"createArticle"},Mn=class{constructor(){this.runtime=new Vi,this.currentVisitorId=""}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}makeEvent(e){return Promise.resolve({eventType:e,payload:null,log:()=>Promise.resolve()})}sendEvent(){return Promise.resolve()}makeSearchEvent(){return this.makeEvent(L.search)}sendSearchEvent(){return Promise.resolve()}makeClickEvent(){return this.makeEvent(L.click)}sendClickEvent(){return Promise.resolve()}makeCustomEvent(){return this.makeEvent(L.custom)}sendCustomEvent(){return Promise.resolve()}makeViewEvent(){return this.makeEvent(L.view)}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}get version(){return Pi}};function ol(e){let t="";return e.filter(r=>{let n=r!==t;return t=r,n})}function sl(e){return e.map(t=>t.replace(/;/g,""))}function Hi(e){let t=e.join(";");return t.length<=256?t:Hi(e.slice(1))}var Tn=e=>{let t=sl(e),r=ol(t);return Hi(r)};function _n(e){let t=typeof e.partialQueries=="string"?e.partialQueries:Tn(e.partialQueries),r=typeof e.suggestions=="string"?e.suggestions:Tn(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}var Yi=class{constructor(e,t){this.opts=e,this.provider=t;let r=e.enableAnalytics===!1||kr();this.coveoAnalyticsClient=r?new Mn:new kt(e)}disable(){this.coveoAnalyticsClient=new Mn}enable(){this.coveoAnalyticsClient=new kt(this.opts)}makeInterfaceLoad(){return this.makeSearchEvent(v.interfaceLoad)}logInterfaceLoad(){return m(this,void 0,void 0,function*(){return(yield this.makeInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationInterfaceLoad(){return this.makeSearchEvent(v.recommendationInterfaceLoad)}logRecommendationInterfaceLoad(){return m(this,void 0,void 0,function*(){return(yield this.makeRecommendationInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendation(){return this.makeCustomEvent(v.recommendation)}logRecommendation(){return m(this,void 0,void 0,function*(){return(yield this.makeRecommendation()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationOpen(e,t){return this.makeClickEvent(v.recommendationOpen,e,t)}logRecommendationOpen(e,t){return m(this,void 0,void 0,function*(){return(yield this.makeRecommendationOpen(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterClearAll(e){return this.makeSearchEvent(v.staticFilterClearAll,e)}logStaticFilterClearAll(e){return m(this,void 0,void 0,function*(){return(yield this.makeStaticFilterClearAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterSelect(e){return this.makeSearchEvent(v.staticFilterSelect,e)}logStaticFilterSelect(e){return m(this,void 0,void 0,function*(){return(yield this.makeStaticFilterSelect(e)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterDeselect(e){return this.makeSearchEvent(v.staticFilterDeselect,e)}logStaticFilterDeselect(e){return m(this,void 0,void 0,function*(){return(yield this.makeStaticFilterDeselect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFetchMoreResults(){return this.makeCustomEvent(v.pagerScrolling,{type:"getMoreResults"})}logFetchMoreResults(){return m(this,void 0,void 0,function*(){return(yield this.makeFetchMoreResults()).log({searchUID:this.provider.getSearchUID()})})}makeInterfaceChange(e){return this.makeSearchEvent(v.interfaceChange,e)}logInterfaceChange(e){return m(this,void 0,void 0,function*(){return(yield this.makeInterfaceChange(e)).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanAutomatic(){return this.makeSearchEvent(v.didyoumeanAutomatic)}logDidYouMeanAutomatic(){return m(this,void 0,void 0,function*(){return(yield this.makeDidYouMeanAutomatic()).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanClick(){return this.makeSearchEvent(v.didyoumeanClick)}logDidYouMeanClick(){return m(this,void 0,void 0,function*(){return(yield this.makeDidYouMeanClick()).log({searchUID:this.provider.getSearchUID()})})}makeResultsSort(e){return this.makeSearchEvent(v.resultsSort,e)}logResultsSort(e){return m(this,void 0,void 0,function*(){return(yield this.makeResultsSort(e)).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxSubmit(){return this.makeSearchEvent(v.searchboxSubmit)}logSearchboxSubmit(){return m(this,void 0,void 0,function*(){return(yield this.makeSearchboxSubmit()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxClear(){return this.makeSearchEvent(v.searchboxClear)}logSearchboxClear(){return m(this,void 0,void 0,function*(){return(yield this.makeSearchboxClear()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxAsYouType(){return this.makeSearchEvent(v.searchboxAsYouType)}logSearchboxAsYouType(){return m(this,void 0,void 0,function*(){return(yield this.makeSearchboxAsYouType()).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbFacet(e){return this.makeSearchEvent(v.breadcrumbFacet,e)}logBreadcrumbFacet(e){return m(this,void 0,void 0,function*(){return(yield this.makeBreadcrumbFacet(e)).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbResetAll(){return this.makeSearchEvent(v.breadcrumbResetAll)}logBreadcrumbResetAll(){return m(this,void 0,void 0,function*(){return(yield this.makeBreadcrumbResetAll()).log({searchUID:this.provider.getSearchUID()})})}makeDocumentQuickview(e,t){return this.makeClickEvent(v.documentQuickview,e,t)}logDocumentQuickview(e,t){return m(this,void 0,void 0,function*(){return(yield this.makeDocumentQuickview(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeDocumentOpen(e,t){return this.makeClickEvent(v.documentOpen,e,t)}logDocumentOpen(e,t){return m(this,void 0,void 0,function*(){return(yield this.makeDocumentOpen(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxAnalytics(e){return this.makeSearchEvent(v.omniboxAnalytics,_n(e))}logOmniboxAnalytics(e){return m(this,void 0,void 0,function*(){return(yield this.makeOmniboxAnalytics(e)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxFromLink(e){return this.makeSearchEvent(v.omniboxFromLink,_n(e))}logOmniboxFromLink(e){return m(this,void 0,void 0,function*(){return(yield this.makeOmniboxFromLink(e)).log({searchUID:this.provider.getSearchUID()})})}makeSearchFromLink(){return this.makeSearchEvent(v.searchFromLink)}logSearchFromLink(){return m(this,void 0,void 0,function*(){return(yield this.makeSearchFromLink()).log({searchUID:this.provider.getSearchUID()})})}makeTriggerNotify(e){return this.makeCustomEvent(v.triggerNotify,e)}logTriggerNotify(e){return m(this,void 0,void 0,function*(){return(yield this.makeTriggerNotify(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerExecute(e){return this.makeCustomEvent(v.triggerExecute,e)}logTriggerExecute(e){return m(this,void 0,void 0,function*(){return(yield this.makeTriggerExecute(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerQuery(){return this.makeCustomEvent(v.triggerQuery,{query:this.provider.getSearchEventRequestPayload().queryText},"queryPipelineTriggers")}logTriggerQuery(){return m(this,void 0,void 0,function*(){return(yield this.makeTriggerQuery()).log({searchUID:this.provider.getSearchUID()})})}makeUndoTriggerQuery(e){return this.makeSearchEvent(v.undoTriggerQuery,e)}logUndoTriggerQuery(e){return m(this,void 0,void 0,function*(){return(yield this.makeUndoTriggerQuery(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerRedirect(e){return this.makeCustomEvent(v.triggerRedirect,Object.assign(Object.assign({},e),{query:this.provider.getSearchEventRequestPayload().queryText}))}logTriggerRedirect(e){return m(this,void 0,void 0,function*(){return(yield this.makeTriggerRedirect(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerResize(e){return this.makeCustomEvent(v.pagerResize,e)}logPagerResize(e){return m(this,void 0,void 0,function*(){return(yield this.makePagerResize(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerNumber(e){return this.makeCustomEvent(v.pagerNumber,e)}logPagerNumber(e){return m(this,void 0,void 0,function*(){return(yield this.makePagerNumber(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerNext(e){return this.makeCustomEvent(v.pagerNext,e)}logPagerNext(e){return m(this,void 0,void 0,function*(){return(yield this.makePagerNext(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerPrevious(e){return this.makeCustomEvent(v.pagerPrevious,e)}logPagerPrevious(e){return m(this,void 0,void 0,function*(){return(yield this.makePagerPrevious(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerScrolling(){return this.makeCustomEvent(v.pagerScrolling)}logPagerScrolling(){return m(this,void 0,void 0,function*(){return(yield this.makePagerScrolling()).log({searchUID:this.provider.getSearchUID()})})}makeFacetClearAll(e){return this.makeSearchEvent(v.facetClearAll,e)}logFacetClearAll(e){return m(this,void 0,void 0,function*(){return(yield this.makeFacetClearAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSearch(e){return this.makeSearchEvent(v.facetSearch,e)}logFacetSearch(e){return m(this,void 0,void 0,function*(){return(yield this.makeFacetSearch(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelect(e){return this.makeSearchEvent(v.facetSelect,e)}logFacetSelect(e){return m(this,void 0,void 0,function*(){return(yield this.makeFacetSelect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetDeselect(e){return this.makeSearchEvent(v.facetDeselect,e)}logFacetDeselect(e){return m(this,void 0,void 0,function*(){return(yield this.makeFacetDeselect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetExclude(e){return this.makeSearchEvent(v.facetExclude,e)}logFacetExclude(e){return m(this,void 0,void 0,function*(){return(yield this.makeFacetExclude(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUnexclude(e){return this.makeSearchEvent(v.facetUnexclude,e)}logFacetUnexclude(e){return m(this,void 0,void 0,function*(){return(yield this.makeFacetUnexclude(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelectAll(e){return this.makeSearchEvent(v.facetSelectAll,e)}logFacetSelectAll(e){return m(this,void 0,void 0,function*(){return(yield this.makeFacetSelectAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUpdateSort(e){return this.makeSearchEvent(v.facetUpdateSort,e)}logFacetUpdateSort(e){return m(this,void 0,void 0,function*(){return(yield this.makeFacetUpdateSort(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowMore(e){return this.makeCustomEvent(v.facetShowMore,e)}logFacetShowMore(e){return m(this,void 0,void 0,function*(){return(yield this.makeFacetShowMore(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowLess(e){return this.makeCustomEvent(v.facetShowLess,e)}logFacetShowLess(e){return m(this,void 0,void 0,function*(){return(yield this.makeFacetShowLess(e)).log({searchUID:this.provider.getSearchUID()})})}makeQueryError(e){return this.makeCustomEvent(v.queryError,e)}logQueryError(e){return m(this,void 0,void 0,function*(){return(yield this.makeQueryError(e)).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorBack(){return m(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(v.queryErrorBack);return{description:e.description,log:()=>m(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(v.queryErrorBack)})}})}logQueryErrorBack(){return m(this,void 0,void 0,function*(){return(yield this.makeQueryErrorBack()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorRetry(){return m(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(v.queryErrorRetry);return{description:e.description,log:()=>m(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(v.queryErrorRetry)})}})}logQueryErrorRetry(){return m(this,void 0,void 0,function*(){return(yield this.makeQueryErrorRetry()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorClear(){return m(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(v.queryErrorClear);return{description:e.description,log:()=>m(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(v.queryErrorClear)})}})}logQueryErrorClear(){return m(this,void 0,void 0,function*(){return(yield this.makeQueryErrorClear()).log({searchUID:this.provider.getSearchUID()})})}makeLikeSmartSnippet(){return this.makeCustomEvent(v.likeSmartSnippet)}logLikeSmartSnippet(){return m(this,void 0,void 0,function*(){return(yield this.makeLikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeDislikeSmartSnippet(){return this.makeCustomEvent(v.dislikeSmartSnippet)}logDislikeSmartSnippet(){return m(this,void 0,void 0,function*(){return(yield this.makeDislikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippet(){return this.makeCustomEvent(v.expandSmartSnippet)}logExpandSmartSnippet(){return m(this,void 0,void 0,function*(){return(yield this.makeExpandSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippet(){return this.makeCustomEvent(v.collapseSmartSnippet)}logCollapseSmartSnippet(){return m(this,void 0,void 0,function*(){return(yield this.makeCollapseSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetFeedbackModal(){return this.makeCustomEvent(v.openSmartSnippetFeedbackModal)}logOpenSmartSnippetFeedbackModal(){return m(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeCloseSmartSnippetFeedbackModal(){return this.makeCustomEvent(v.closeSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return m(this,void 0,void 0,function*(){return(yield this.makeCloseSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeSmartSnippetFeedbackReason(e,t){return this.makeCustomEvent(v.sendSmartSnippetReason,{reason:e,details:t})}logSmartSnippetFeedbackReason(e,t){return m(this,void 0,void 0,function*(){return(yield this.makeSmartSnippetFeedbackReason(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippetSuggestion(e){return this.makeCustomEvent(v.expandSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logExpandSmartSnippetSuggestion(e){return m(this,void 0,void 0,function*(){return(yield this.makeExpandSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippetSuggestion(e){return this.makeCustomEvent(v.collapseSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logCollapseSmartSnippetSuggestion(e){return m(this,void 0,void 0,function*(){return(yield this.makeCollapseSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreSmartSnippetSuggestion(e){return this.makeCustomEvent(v.showMoreSmartSnippetSuggestion,e)}logShowMoreSmartSnippetSuggestion(e){return m(this,void 0,void 0,function*(){return(yield this.makeShowMoreSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessSmartSnippetSuggestion(e){return this.makeCustomEvent(v.showLessSmartSnippetSuggestion,e)}logShowLessSmartSnippetSuggestion(e){return m(this,void 0,void 0,function*(){return(yield this.makeShowLessSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSource(e,t){return this.makeClickEvent(v.openSmartSnippetSource,e,t)}logOpenSmartSnippetSource(e,t){return m(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSource(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionSource(e,t){return this.makeClickEvent(v.openSmartSnippetSuggestionSource,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}makeCopyToClipboard(e,t){return this.makeClickEvent(v.copyToClipboard,e,t)}logCopyToClipboard(e,t){return m(this,void 0,void 0,function*(){return(yield this.makeCopyToClipboard(e,t)).log({searchUID:this.provider.getSearchUID()})})}logOpenSmartSnippetSuggestionSource(e,t){return m(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSuggestionSource(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetInlineLink(e,t){return this.makeClickEvent(v.openSmartSnippetInlineLink,e,{contentIDKey:t.contentIDKey,contentIDValue:t.contentIDValue},t)}logOpenSmartSnippetInlineLink(e,t){return m(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionInlineLink(e,t){return this.makeClickEvent(v.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}logOpenSmartSnippetSuggestionInlineLink(e,t){return m(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSuggestionInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeRecentQueryClick(){return this.makeSearchEvent(v.recentQueryClick)}logRecentQueryClick(){return m(this,void 0,void 0,function*(){return(yield this.makeRecentQueryClick()).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentQueries(){return this.makeCustomEvent(v.clearRecentQueries)}logClearRecentQueries(){return m(this,void 0,void 0,function*(){return(yield this.makeClearRecentQueries()).log({searchUID:this.provider.getSearchUID()})})}makeRecentResultClick(e,t){return this.makeCustomEvent(v.recentResultClick,{info:e,identifier:t})}logRecentResultClick(e,t){return m(this,void 0,void 0,function*(){return(yield this.makeRecentResultClick(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentResults(){return this.makeCustomEvent(v.clearRecentResults)}logClearRecentResults(){return m(this,void 0,void 0,function*(){return(yield this.makeClearRecentResults()).log({searchUID:this.provider.getSearchUID()})})}makeNoResultsBack(){return this.makeSearchEvent(v.noResultsBack)}logNoResultsBack(){return m(this,void 0,void 0,function*(){return(yield this.makeNoResultsBack()).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreFoldedResults(e,t){return this.makeClickEvent(v.showMoreFoldedResults,e,t)}logShowMoreFoldedResults(e,t){return m(this,void 0,void 0,function*(){return(yield this.makeShowMoreFoldedResults(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessFoldedResults(){return this.makeCustomEvent(v.showLessFoldedResults)}logShowLessFoldedResults(){return m(this,void 0,void 0,function*(){return(yield this.makeShowLessFoldedResults()).log({searchUID:this.provider.getSearchUID()})})}makeEventDescription(e,t){var r;return{actionCause:t,customData:(r=e.payload)===null||r===void 0?void 0:r.customData}}makeCustomEvent(e,t,r=Fn[e]){return m(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),i=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:r,eventValue:e}),a=yield this.coveoAnalyticsClient.makeCustomEvent(i);return{description:this.makeEventDescription(a,e),log:({searchUID:o})=>a.log({lastSearchQueryUid:o})}})}logCustomEvent(e,t,r=Fn[e]){return m(this,void 0,void 0,function*(){return(yield this.makeCustomEvent(e,t,r)).log({searchUID:this.provider.getSearchUID()})})}makeCustomEventWithType(e,t,r){return m(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),i=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:t,eventValue:e}),a=yield this.coveoAnalyticsClient.makeCustomEvent(i);return{description:this.makeEventDescription(a,e),log:({searchUID:o})=>a.log({lastSearchQueryUid:o})}})}logCustomEventWithType(e,t,r){return m(this,void 0,void 0,function*(){return(yield this.makeCustomEventWithType(e,t,r)).log({searchUID:this.provider.getSearchUID()})})}logSearchEvent(e,t){return m(this,void 0,void 0,function*(){return(yield this.makeSearchEvent(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeSearchEvent(e,t){return m(this,void 0,void 0,function*(){let r=yield this.getBaseSearchEventRequest(e,t),n=yield this.coveoAnalyticsClient.makeSearchEvent(r);return{description:this.makeEventDescription(n,e),log:({searchUID:i})=>n.log({searchQueryUid:i})}})}makeClickEvent(e,t,r,n){return m(this,void 0,void 0,function*(){let i=Object.assign(Object.assign(Object.assign({},t),yield this.getBaseEventRequest(Object.assign(Object.assign({},r),n))),{queryPipeline:this.provider.getPipeline(),actionCause:e}),a=yield this.coveoAnalyticsClient.makeClickEvent(i);return{description:this.makeEventDescription(a,e),log:({searchUID:o})=>a.log({searchQueryUid:o})}})}logClickEvent(e,t,r,n){return m(this,void 0,void 0,function*(){return(yield this.makeClickEvent(e,t,r,n)).log({searchUID:this.provider.getSearchUID()})})}getBaseSearchEventRequest(e,t){var r,n;return m(this,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},t),(n=(r=this.provider).getGeneratedAnswerMetadata)===null||n===void 0?void 0:n.call(r)))),this.provider.getSearchEventRequestPayload()),{queryPipeline:this.provider.getPipeline(),actionCause:e})})}getBaseEventRequest(e){return m(this,void 0,void 0,function*(){let t=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign(Object.assign({},this.getOrigins()),this.getSplitTestRun()),{customData:t,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})})}getOrigins(){var e,t;return{originContext:(t=(e=this.provider).getOriginContext)===null||t===void 0?void 0:t.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof kt?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getSplitTestRun(){let e=this.provider.getSplitTestRunName?this.provider.getSplitTestRunName():"",t=this.provider.getSplitTestRunVersion?this.provider.getSplitTestRunVersion():"";return Object.assign(Object.assign({},e&&{splitTestRunName:e}),t&&{splitTestRunVersion:t})}makeLikeGeneratedAnswer(e){return this.makeCustomEvent(v.likeGeneratedAnswer,e)}logLikeGeneratedAnswer(e){return m(this,void 0,void 0,function*(){return(yield this.makeLikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeDislikeGeneratedAnswer(e){return this.makeCustomEvent(v.dislikeGeneratedAnswer,e)}logDislikeGeneratedAnswer(e){return m(this,void 0,void 0,function*(){return(yield this.makeDislikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeOpenGeneratedAnswerSource(e){return this.makeCustomEvent(v.openGeneratedAnswerSource,e)}logOpenGeneratedAnswerSource(e){return m(this,void 0,void 0,function*(){return(yield this.makeOpenGeneratedAnswerSource(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerSourceHover(e){return this.makeCustomEvent(v.generatedAnswerSourceHover,e)}logGeneratedAnswerSourceHover(e){return m(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerSourceHover(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCopyToClipboard(e){return this.makeCustomEvent(v.generatedAnswerCopyToClipboard,e)}logGeneratedAnswerCopyToClipboard(e){return m(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerCopyToClipboard(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerHideAnswers(e){return this.makeCustomEvent(v.generatedAnswerHideAnswers,e)}logGeneratedAnswerHideAnswers(e){return m(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerHideAnswers(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerShowAnswers(e){return this.makeCustomEvent(v.generatedAnswerShowAnswers,e)}logGeneratedAnswerShowAnswers(e){return m(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerShowAnswers(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerExpand(e){return this.makeCustomEvent(v.generatedAnswerExpand,e)}logGeneratedAnswerExpand(e){return m(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerExpand(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCollapse(e){return this.makeCustomEvent(v.generatedAnswerCollapse,e)}logGeneratedAnswerCollapse(e){return m(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerCollapse(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerFeedbackSubmit(e){return this.makeCustomEvent(v.generatedAnswerFeedbackSubmit,e)}logGeneratedAnswerFeedbackSubmit(e){return m(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerFeedbackSubmit(e)).log({searchUID:this.provider.getSearchUID()})})}makeRephraseGeneratedAnswer(e){return this.makeSearchEvent(v.rephraseGeneratedAnswer,e)}logRephraseGeneratedAnswer(e){return m(this,void 0,void 0,function*(){return(yield this.makeRephraseGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeRetryGeneratedAnswer(){return this.makeSearchEvent(v.retryGeneratedAnswer)}logRetryGeneratedAnswer(){return m(this,void 0,void 0,function*(){return(yield this.makeRetryGeneratedAnswer()).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerStreamEnd(e){return this.makeCustomEvent(v.generatedAnswerStreamEnd,e)}logGeneratedAnswerStreamEnd(e){return m(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerStreamEnd(e)).log({searchUID:this.provider.getSearchUID()})})}},jn=Object.assign({},ac);Object.keys(jn).map(e=>jn[e]);var Pn;(function(e){e.click="click",e.flowStart="flowStart"})(Pn||(Pn={}));var $n;(function(e){e.enterInterface="ticket_create_start",e.fieldUpdate="ticket_field_update",e.fieldSuggestionClick="ticket_classification_click",e.suggestionClick="suggestion_click",e.suggestionRate="suggestion_rate",e.nextCaseStep="ticket_next_stage",e.caseCancelled="ticket_cancel",e.caseSolved="ticket_cancel",e.caseCreated="ticket_create"})($n||($n={}));var Ln;(function(e){e.quit="Quit",e.solved="Solved"})(Ln||(Ln={}));var pt=e=>new kt(e).getCurrentVisitorId(),et=new Nu.HistoryStore,Bi=(e,t)=>typeof t=="function"?(...r)=>{let n=Dr(r[0]);try{return t.apply(t,r)}catch(i){return e.error(i,"Error in analytics preprocessRequest. Returning original request."),n}}:void 0,Wi=(e,t)=>(...r)=>{let n=Dr(r[1]);try{return t.apply(t,r)}catch(i){return e.error(i,"Error in analytics hook. Returning original request."),n}},Gi=Mr(e=>e.source,e=>[`@coveo/headless@${_r}`].concat(Object.entries(e).map(([t,r])=>`${t}@${r}`)));function Ji(){return{desiredCount:5,numberOfValues:8,set:{}}}function ul(e){let{activeValue:t,ancestryMap:r}=cl(e);return t?ll(t,r):[]}function cl(e){let t=[...e],r=new Map;for(;t.length>0;){let n=t.shift();if(n.state==="selected")return{activeValue:n,ancestryMap:r};if(r)for(let i of n.children)r.set(i,n);t.unshift(...n.children)}return{}}function ll(e,t){let r=[];if(!e)return[];let n=e;do r.unshift(n),n=t.get(n);while(n);return r}var dl=(e,t)=>{var r;return(r=e.categoryFacetSet[t])==null?void 0:r.request},Ki=(e,t)=>{let r=dl(e,t);return ul((r==null?void 0:r.currentValues)??[])};function Zi(){return{}}function Xi(){return{}}function ea(){return{}}function ta(){return{}}function hl(e){return{facetSet:e.facetSet??ta(),categoryFacetSet:e.categoryFacetSet??Zi(),dateFacetSet:e.dateFacetSet??Xi(),numericFacetSet:e.numericFacetSet??ea(),automaticFacetSet:e.automaticFacetSet??Ji()}}var fl=e=>{let t=[];return ml(e).forEach((r,n)=>{let i=Il(e,r.facetId),a=kl(r,n+1);if(gl(r)){if(!Ki(e,r.facetId).length)return;t.push({...a,...Sl(e,r.facetId),facetType:i,state:"selected"});return}r.currentValues.forEach((o,s)=>{if(o.state==="idle")return;let u=Qn(o,s+1,i),c=pl(r)?Vn(o):vl(o);t.push({...a,...u,...c})})}),yl(e).forEach((r,n)=>{let i=bl(r,n+1);r.values.forEach((a,o)=>{if(a.state==="idle")return;let s=Qn(a,o+1,"specific"),u=Vn(a);t.push({...i,...s,...u})})}),t},pl=e=>e.type==="specific",gl=e=>e.type==="hierarchical",ml=e=>[...Object.values(e.facetSet),...Object.values(e.categoryFacetSet),...Object.values(e.dateFacetSet),...Object.values(e.numericFacetSet)].map(t=>t.request),yl=e=>[...Object.values(e.automaticFacetSet.set)].map(t=>t.response),Qn=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),vl=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),Vn=e=>({displayValue:e.value,value:e.value}),wl=(e,t)=>Ki(e,t).map(r=>r.value).join(";"),Sl=(e,t)=>{let r=wl(e,t);return{value:r,valuePosition:1,displayValue:r}},bl=(e,t)=>({title:ra(e.field,e.field),field:e.field,id:e.field,facetPosition:t}),kl=(e,t)=>({title:ra(e.field,e.facetId),field:e.field,id:e.facetId,facetPosition:t}),ra=(e,t)=>`${e}_${t}`,Cl=(e,t)=>{var r,n,i,a,o;return((r=e.facetSet[t])==null?void 0:r.request)||((n=e.categoryFacetSet[t])==null?void 0:n.request)||((i=e.dateFacetSet[t])==null?void 0:i.request)||((a=e.numericFacetSet[t])==null?void 0:a.request)||((o=e.automaticFacetSet.set[t])==null?void 0:o.response)},Il=(e,t)=>{let r=Cl(e,t);return r?r.type:"specific"},tt=()=>({q:"",enableQuerySyntax:!1}),na=(e=>(e.Ascending="ascending",e.Descending="descending",e))(na||{}),ia=(e=>(e.Relevancy="relevancy",e.QRE="qre",e.Date="date",e.Field="field",e.NoSort="nosort",e))(ia||{}),aa=e=>{if(Go(e))return e.map(t=>aa(t)).join(",");switch(e.by){case"relevancy":case"qre":case"nosort":return e.by;case"date":return`date ${e.order}`;case"field":return`@${e.field} ${e.order}`;default:return""}},Ol=()=>({by:"relevancy"});new Q({values:{by:new Ot({enum:ia,required:!0}),order:new Ot({enum:na}),field:new U}});function oa(){return aa(Ol())}var zr=()=>"default",ql=e=>{let t=e.configuration.search.locale.split("-")[0];return!t||t.length!==2?"en":t},Nr=class{constructor(e){this.getState=e,this.state=e()}getLanguage(){return ql(this.state)}getBaseMetadata(){let{context:e,configuration:t}=this.state,r=(e==null?void 0:e.contextValues)||{},n={};for(let[i,a]of Object.entries(r)){let o=`context_${i}`;n[o]=a}return t.analytics.analyticsMode==="legacy"&&(n.coveoHeadlessVersion=_r),n}getOriginContext(){return this.state.configuration.analytics.originContext}getOriginLevel1(){return this.state.searchHub||zr()}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3}getIsAnonymous(){return this.state.configuration.analytics.anonymous}},sa=class Cr extends Nr{constructor(){super(...arguments),this.getFacetRequest=t=>{var r,n,i,a,o,s,u,c,d,f;return((n=(r=this.state.facetSet)==null?void 0:r[t])==null?void 0:n.request)||((a=(i=this.state.categoryFacetSet)==null?void 0:i[t])==null?void 0:a.request)||((s=(o=this.state.dateFacetSet)==null?void 0:o[t])==null?void 0:s.request)||((c=(u=this.state.numericFacetSet)==null?void 0:u[t])==null?void 0:c.request)||((f=(d=this.state.automaticFacetSet)==null?void 0:d.set[t])==null?void 0:f.response)}}getFacetState(){return fl(hl(this.getState()))}getPipeline(){var t;return this.state.pipeline||((t=this.state.search)==null?void 0:t.response.pipeline)||Cr.fallbackPipelineName}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.resultURIs,numberOfResults:this.numberOfResults}}getSearchUID(){var r,n;let t=this.getState();return((r=t.search)==null?void 0:r.searchResponseId)||((n=t.search)==null?void 0:n.response.searchUid)||Ge().response.searchUid}getSplitTestRunName(){var t;return(t=this.state.search)==null?void 0:t.response.splitTestRun}getSplitTestRunVersion(){var n;let t=!!this.getSplitTestRunName(),r=((n=this.state.search)==null?void 0:n.response.pipeline)||this.state.pipeline||Cr.fallbackPipelineName;return t?r:void 0}getBaseMetadata(){var i,a,o;let t=this.getState(),r=super.getBaseMetadata(),n=(o=(a=(i=t.search)==null?void 0:i.response)==null?void 0:a.extendedResults)==null?void 0:o.generativeQuestionAnsweringId;return n&&(r.generativeQuestionAnsweringId=n),r}getFacetMetadata(t,r){var i;let n=((i=this.getFacetRequest(t))==null?void 0:i.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:n,facetValue:r,facetTitle:`${n}_${t}`}}getFacetClearAllMetadata(t){var n;let r=((n=this.getFacetRequest(t))==null?void 0:n.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:r,facetTitle:`${r}_${t}`}}getFacetUpdateSortMetadata(t,r){var i;let n=((i=this.getFacetRequest(t))==null?void 0:i.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:n,criteria:r,facetTitle:`${n}_${t}`}}getRangeBreadcrumbFacetMetadata(t,r){var i;let n=((i=this.getFacetRequest(t))==null?void 0:i.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:n,facetRangeEnd:r.end,facetRangeEndInclusive:r.endInclusive,facetRangeStart:r.start,facetTitle:`${n}_${t}`}}getResultSortMetadata(){return{...this.getBaseMetadata(),resultsSortBy:this.state.sortCriteria??oa()}}getStaticFilterToggleMetadata(t,r){return{...this.getBaseMetadata(),staticFilterId:t,staticFilterValue:r}}getStaticFilterClearAllMetadata(t){return{...this.getBaseMetadata(),staticFilterId:t}}getUndoTriggerQueryMetadata(t){return{...this.getBaseMetadata(),undoneQuery:t}}getCategoryBreadcrumbFacetMetadata(t,r){var i;let n=((i=this.getFacetRequest(t))==null?void 0:i.field)??"";return{...this.getBaseMetadata(),categoryFacetId:t,categoryFacetField:n,categoryFacetPath:r,categoryFacetTitle:`${n}_${t}`}}getOmniboxAnalyticsMetadata(t,r){let n=this.state.querySuggest&&this.state.querySuggest[t],i=n.completions.map(u=>u.expression),a=n.partialQueries.length-1,o=n.partialQueries[a]||"",s=n.responseId;return{...this.getBaseMetadata(),suggestionRanking:i.indexOf(r),partialQuery:o,partialQueries:n.partialQueries.length>0?n.partialQueries:"",suggestions:i.length>0?i:"",querySuggestResponseId:s}}getInterfaceChangeMetadata(){return{...this.getBaseMetadata(),interfaceChangeTo:this.state.configuration.analytics.originLevel2}}getOmniboxFromLinkMetadata(t){return{...this.getBaseMetadata(),...t}}getGeneratedAnswerMetadata(){var n;let t=this.getState(),r={};return((n=t.generatedAnswer)==null?void 0:n.isVisible)!==void 0&&(r.showGeneratedAnswer=t.generatedAnswer.isVisible),r}get resultURIs(){var t;return(t=this.results)==null?void 0:t.map(r=>({documentUri:r.uri,documentUriHash:r.raw.urihash}))}get results(){var t;return(t=this.state.search)==null?void 0:t.response.results}get queryText(){var t;return((t=this.state.query)==null?void 0:t.q)||tt().q}get responseTime(){var t;return((t=this.state.search)==null?void 0:t.duration)||Ge().duration}get numberOfResults(){var t;return((t=this.state.search)==null?void 0:t.response.totalCountFiltered)||Ge().response.totalCountFiltered}};sa.fallbackPipelineName="default";var zt=sa,Al=({logger:e,getState:t,analyticsClientMiddleware:r=(a,o)=>o,preprocessRequest:n,provider:i=new zt(t)})=>{let a=t(),o=a.configuration.accessToken,s=a.configuration.analytics.apiBaseUrl,u=a.configuration.analytics.runtimeEnvironment,c=a.configuration.analytics.enabled,d=new Yi({token:o,endpoint:s,runtimeEnvironment:u,preprocessRequest:Bi(e,n),beforeSendHooks:[Wi(e,r),(f,p)=>(e.info({...p,type:f,endpoint:s,token:o},"Analytics request"),p)]},i);return c||d.disable(),d},zn=()=>{let e=et.getHistory().reverse().find(t=>t.name==="PageView"&&t.value);return e?e.value:""},Hr=async(e,t)=>{let r=e.analyticsMode==="next";return{analytics:{clientId:await pt(e),clientTimestamp:new Date().toISOString(),documentReferrer:e.originLevel3,originContext:e.originContext,...t&&{actionCause:t.actionCause,customData:t.customData},...t&&!r&&{customData:t.customData},...e.userDisplayName&&{userDisplayName:e.userDisplayName},...e.documentLocation&&{documentLocation:e.documentLocation},...e.deviceId&&{deviceId:e.deviceId},...zn()&&{pageId:zn()},...r&&e.trackingId&&{trackingId:e.trackingId},capture:r,...r&&{source:Gi(e)}}}},Ct=()=>({duration:0,error:null,isLoading:!1,id:"Recommendation",recommendations:[],searchUid:"",splitTestRun:"",pipeline:""}),ua=class extends Nr{getPipeline(){var e;return this.state.pipeline||((e=this.state.recommendation)==null?void 0:e.pipeline)||"default"}getSearchEventRequestPayload(){return{queryText:tt().q,responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){var e;return((e=this.getState().recommendation)==null?void 0:e.searchUid)||Ct().searchUid}getSplitTestRunName(){var e;return(e=this.state.recommendation)==null?void 0:e.splitTestRun}getSplitTestRunVersion(){var r;let e=!!this.getSplitTestRunName(),t=((r=this.state.recommendation)==null?void 0:r.pipeline)||this.state.pipeline||"default";return e?t:void 0}get responseTime(){var e;return((e=this.state.recommendation)==null?void 0:e.duration)||Ct().duration}mapResultsToAnalyticsDocument(){var e;return(e=this.state.recommendation)==null?void 0:e.recommendations.map(t=>({documentUri:t.uri,documentUriHash:t.raw.urihash}))}get numberOfResults(){var e;return((e=this.state.recommendation)==null?void 0:e.recommendations.length)||Ct().recommendations.length}};function El({config:e,environment:t,event:r,listenerManager:n}){let{url:i,token:a,mode:o}=e;o!=="disabled"&&(n.call(r),t.send(i,a,r))}var Dl=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Rl(e){return typeof e=="string"&&Dl.test(e)}function xl(e){let t="visitorId";return{getClientId:()=>{let r=e.get(),n=r.storage,i=n.getItem(t),a=i&&Rl(i)?i:r.generateUUID();return n.setItem(t,a),a},clear:()=>{e.get().storage.removeItem(t)}}}var ca="0.7.7";function Ul(e){let{trackingId:t}=e;return{trackingId:t}}function Fl(e){return(e.source||[]).concat([`relay@${ca}`])}function la(e,t,r,n){let{getReferrer:i,getLocation:a,getUserAgent:o}=r,s=Ul(t),u=n.getClientId();return Object.freeze({type:e,config:s,ts:Date.now(),source:Fl(t),clientId:u,userAgent:o(),referrer:i(),location:a()})}function Ml(e,t,r,n,i){return{...t,meta:la(e,r,n,i)}}var Tl="*";function _l(){let e=[];function t({type:u,callback:c}){return e.findIndex(d=>d.type===u&&d.callback===c)}function r(u,c){return u.type==="*"||c===u.type}function n(u){return t(u)<0&&e.push(u),()=>s(u.type,u.callback)}function i(u){e.forEach(c=>{if(r(c,u.meta.type))try{c.callback(u)}catch(d){console.error(d)}})}function a(u){if(u===Tl)e.length=0;else for(let c=e.length-1;c>=0;c--)e[c].type===u&&e.splice(c,1)}function o(u){let c=t(u);c>=0&&e.splice(c,1)}function s(u,c){c?o({type:u,callback:c}):a(u)}return{add:n,call:i,remove:s}}function Nn({url:e,token:t,trackingId:r,...n}){return Object.freeze({url:e,token:t,trackingId:r,...!!n.mode&&{mode:n.mode},...!!n.source&&{source:n.source}})}function jl(e){let t=Nn(e);return{get:()=>t,update:r=>{t=Nn({...t,...r})}}}function Pl(){let e=typeof window<"u";return{sendMessage(t){e&&window.postMessage(t,"*")}}}var or=$l();function $l(){let e="coveo_",t=r=>{let n=r.split(".").slice(-2);return n.length==2?n.join("."):""};return{getItem(r){let n=`${e}${r}=`,i=document.cookie.split(";");for(let a of i){let o=a.replace(/^\s+/,"");if(o.lastIndexOf(n,0)===0)return o.substring(n.length,o.length)}return null},setItem(r,n,i){let a=t(window.location.hostname),o=`;expires=${new Date(new Date().getTime()+i).toUTCString()}`,s=a?`;domain=${a}`:"";document.cookie=`${e}${r}=${n}${o}${s};path=/;SameSite=Lax`},removeItem(r){this.setItem(r,"",-1)}}}function Ll(){return{getItem(e){return or.getItem(e)||localStorage.getItem(e)},removeItem(e){or.removeItem(e),localStorage.removeItem(e)},setItem(e,t){localStorage.setItem(e,t),or.setItem(e,t,31556952e3)}}}function Ql(){let e=document.referrer;return e===""?null:e}function Vl(){return{runtime:"browser",send:(e,t,r)=>{let n=navigator.sendBeacon(`${e}?access_token=${t}`,new Blob([JSON.stringify([r])],{type:"application/json"}));if(Pl().sendMessage({kind:"EVENT_PROTOCOL",event:r,url:e,token:t}),!n)throw new Error("Failed to send the event(s) because the payload size exceeded the maximum allowed size (32 KB). Please contact support if the problem persists.")},getReferrer:()=>Ql(),getLocation:()=>window.location.href,getUserAgent:()=>navigator.userAgent,generateUUID:()=>crypto.randomUUID(),storage:Ll()}}function zl(){return{getItem(){return null},removeItem(){},setItem(){}}}function Nl(){return{runtime:"null",send:()=>{},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>"",storage:zl()}}function Hl(e){return e.get().mode!=="disabled"&&Yl()?Vl():Nl()}function Yl(){try{return typeof window=="object"}catch{return!1}}function Bl(e){return{get:()=>Object.freeze(Hl(e))}}function Wl(e){let t=jl(e),r=_l(),n=Bl(t),i=xl(n);return{emit:(a,o)=>{let s=t.get(),u=n.get(),c=Ml(a,o,s,u,i);return El({config:s,environment:u,event:c,listenerManager:r})},getMeta:a=>la(a,t.get(),n.get(),i),on:(a,o)=>r.add({type:a,callback:o}),off:(a,o)=>r.remove(a,o),updateConfig:a=>t.update(a),version:ca,clearStorage:()=>{i.clear()}}}var Ir=Mr(e=>e.configuration.accessToken,e=>e.configuration.analytics,e=>Gi(e.configuration.analytics),(e,{trackingId:t,nextApiBaseUrl:r,enabled:n},i)=>Wl({mode:n?"emit":"disabled",url:r,token:e,trackingId:t,source:i})),Gl=()=>({url:"",clientId:"",additionalFields:[],advancedParameters:{debug:!1},products:[],facets:{results:[]},error:null,isLoading:!1,responseId:""}),Yr=class extends Nr{constructor(){super(...arguments),this.initialState=Gl()}getPipeline(){return""}getSearchEventRequestPayload(){return{queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){var e;return((e=this.getState().productListing)==null?void 0:e.responseId)||this.initialState.responseId}mapResultsToAnalyticsDocument(){var e;return(e=this.state.productListing)==null?void 0:e.products.map(t=>({documentUri:t.documentUri,documentUriHash:t.documentUriHash,permanentid:t.permanentid}))}get numberOfResults(){return this.state.productListing.products.length}},Jl=({logger:e,getState:t,analyticsClientMiddleware:r=(a,o)=>o,preprocessRequest:n,provider:i=new Yr(t)})=>{let a=t(),o=a.configuration.accessToken,s=a.configuration.analytics.apiBaseUrl,u=a.configuration.analytics.runtimeEnvironment,c=a.configuration.analytics.enabled,d=new Yi({token:o,endpoint:s,runtimeEnvironment:u,preprocessRequest:Bi(e,n),beforeSendHooks:[Wi(e,r),(f,p)=>(e.info({...p,type:f,endpoint:s,token:o},"Analytics request"),p)]},i);return c||d.disable(),d};function Kl(e){let t=da(e),r=[e,...t].filter(n=>n.parentResult).map(n=>n.parentResult);return Jo([e,...t,...r],n=>n.uniqueId)}function da(e){return e.childResults?e.childResults.flatMap(t=>[t,...da(t)]):[]}function Zl(e,t){return{...new zt(t).getBaseMetadata(),actionCause:e,type:e}}function Xl(e){return Object.assign(e,{instantlyCallable:!0})}function ed(e,t){let r=i=>Xl(ne(e,i)),n=r(async(i,{getState:a,extra:o})=>{let{analyticsClientMiddleware:s,preprocessRequest:u,logger:c}=o;return await(await t({getState:a,analyticsClientMiddleware:s,preprocessRequest:u,logger:c})).log({state:a(),extra:o})});return Object.assign(n,{prepare:async({getState:i,analyticsClientMiddleware:a,preprocessRequest:o,logger:s})=>{let{description:u,log:c}=await t({getState:i,analyticsClientMiddleware:a,preprocessRequest:o,logger:s});return{description:u,action:r(async(d,{getState:f,extra:p})=>await c({state:f(),extra:p}))}}}),n}var ha=(e,t,r)=>{function n(...i){let a=i.length===1?{...i[0],__legacy__getBuilder:t(i[0].__legacy__getBuilder),analyticsConfigurator:e,providerClass:r}:{prefix:i[0],__legacy__getBuilder:t(i[1]),__legacy__provider:i[2],analyticsConfigurator:e,providerClass:r};return nd(a)}return n},td=e=>e.configuration.analytics.analyticsMode==="legacy",rd=e=>e.configuration.analytics.analyticsMode==="next",nd=({prefix:e,__legacy__getBuilder:t,__legacy__provider:r,analyticsPayloadBuilder:n,analyticsType:i,analyticsConfigurator:a,providerClass:o})=>(r??(r=s=>new o(s)),ed(e,async({getState:s,analyticsClientMiddleware:u,preprocessRequest:c,logger:d})=>{let f=[],p={log:async({state:S})=>{for(let q of f)await q(S)}},w=s(),C=a({getState:s,logger:d,analyticsClientMiddleware:u,preprocessRequest:c,provider:r(s)}),l=await t(C,s());p.description=l==null?void 0:l.description,f.push(async S=>{td(S)&&await id(l,r,S,d,C.coveoAnalyticsClient)});let{emit:g}=Ir(w);return f.push(async S=>{if(rd(S)&&i&&n){let q=n(S);await pd(g,i,q)}}),p}));async function id(e,t,r,n,i){t(()=>r);let a=await(e==null?void 0:e.log({searchUID:t(()=>r).getSearchUID()}));n.info({client:i,response:a},"Analytics response")}var Ye=ha(Al,e=>e,zt),ad=ha(Jl,e=>e,Yr),od=(e,t)=>{var a;let r=o=>{var s;return o+(((s=t.pagination)==null?void 0:s.firstResult)??0)},n=-1,i=(a=t.search)==null?void 0:a.results;return n=ma(e,i),n<0&&(n=fd(e,i)),n<0&&(n=0),fa(e,r(n),t)},sd=(e,t)=>{var n;let r=((n=t.recommendation)==null?void 0:n.recommendations.findIndex(({uniqueId:i})=>e.uniqueId===i))||0;return fa(e,r,t)};function fa(e,t,r){let n=e.raw.collection;return{collectionName:typeof n=="string"?n:"default",documentAuthor:ld(e),documentPosition:t+1,documentTitle:e.title,documentUri:e.uri,documentUriHash:e.raw.urihash,documentUrl:e.clickUri,rankingModifier:e.rankingModifier||"",sourceName:dd(e),queryPipeline:r.pipeline||Lr()}}var Hn=e=>(e.raw.permanentid||console.warn("Missing field permanentid on result. This might cause many issues with your Coveo deployment. See https://docs.coveo.com/en/1913 and https://docs.coveo.com/en/1640 for more information.",e),{contentIDKey:"permanentid",contentIDValue:e.raw.permanentid||""}),pa={urihash:new U,sourcetype:new U,permanentid:new U},ga={uniqueId:T,raw:new Q({values:pa}),title:T,uri:T,clickUri:T,rankingModifier:new U({required:!1,emptyAllowed:!0})};function ud(e){return Object.assign({},...Object.keys(pa).map(t=>({[t]:e[t]})))}function cd(e){return Object.assign({},...Object.keys(ga).map(t=>({[t]:e[t]})),{raw:ud(e.raw)})}function ld(e){let t=e.raw.author;return H(t)?"unknown":Array.isArray(t)?t.join(";"):`${t}`}function dd(e){let t=e.raw.source;return H(t)?"unknown":t}var hd=e=>new Ze(ga).validate(cd(e));function fd(e,t){for(let[r,n]of t.entries()){let i=Kl(n);if(ma(e,i)!==-1)return r}return-1}function ma(e,t=[]){return t.findIndex(({uniqueId:r})=>r===e.uniqueId)}async function pd(e,t,r){await e(t,r)}var gd=()=>Ye("analytics/recommendation/update",e=>e.makeRecommendationInterfaceLoad(),e=>new ua(e)),md=()=>({actionCause:"recommendationInterfaceLoad"}),yd=e=>Ye({prefix:"analytics/recommendation/open",__legacy__getBuilder:(t,r)=>(hd(e),t.makeRecommendationOpen(sd(e,r),Hn(e))),__legacy__provider:t=>new ua(t),analyticsType:"itemClick",analyticsPayloadBuilder:t=>{var i;let r=od(e,t),n=Hn(e);return{searchUid:((i=t.search)==null?void 0:i.response.searchUid)??"",position:r.documentPosition,itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}}),Br=k("recommendation/set",e=>E(e,{id:T})),st=ne("recommendation/get",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let i=t(),a=new Date().getTime(),o=await vd(i),s=await n.recommendations(o),u=new Date().getTime()-a;return Ee(s)?r(s.error):{recommendations:s.success.results,analyticsAction:gd(),duration:u,searchUid:s.success.searchUid,splitTestRun:s.success.splitTestRun,pipeline:s.success.pipeline}}),vd=async e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,recommendation:e.recommendation.id,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,locale:e.configuration.search.locale,actionsHistory:e.configuration.analytics.enabled?et.getHistory():[],...e.advancedSearchQueries&&{aq:e.advancedSearchQueries.aq,cq:e.advancedSearchQueries.cq},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub},...e.context&&{context:e.context.contextValues},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.fields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.configuration.analytics.enabled&&{visitorId:await pt(e.configuration.analytics)},...e.configuration.analytics.enabled&&await wd(e,md()),...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")},...e.pagination&&{numberOfResults:e.pagination.numberOfResults}}),wd=async(e,t)=>{let r=e.configuration.analytics.analyticsMode==="legacy"?void 0:{actionCause:t.actionCause,type:t.actionCause};return await Hr(e.configuration.analytics,r)},Wr=Ie(Ct(),e=>{e.addCase(Br,(t,r)=>{t.id=r.payload.id}).addCase(st.rejected,(t,r)=>{t.error=r.payload?r.payload:null,t.isLoading=!1}).addCase(st.fulfilled,(t,r)=>{t.error=null,t.recommendations=r.payload.recommendations,t.duration=r.payload.duration,t.isLoading=!1,t.searchUid=r.payload.searchUid,t.splitTestRun=r.payload.splitTestRun,t.pipeline=r.payload.pipeline}).addCase(st.pending,t=>{t.isLoading=!0})}),ya=k("searchHub/set",e=>E(e,new U({required:!0,emptyAllowed:!0}))),va=Ie(zr(),e=>{e.addCase(ya,(t,r)=>r.payload).addCase(Pe.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.searchHub)??t}).addCase(ft,(t,r)=>r.payload.searchHub||t)}),Sd=Ie(_r,e=>e);function bd(){return typeof window<"u"&&typeof document<"u"}function kd(e){var r;let t=(r=e.payload)==null?void 0:r.analyticsAction;return wa(e)&&!H(t)}function wa(e){return"type"in e}var Cd=e=>t=>r=>{let n;kd(r)&&(n=r.payload.analyticsAction,delete r.payload.analyticsAction);let i=t(r);return wa(r)&&(r.type==="search/executeSearch/fullfilled"&&n===void 0&&console.error("No analytics action associated with search:",r),r.type==="recommendation/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with recommendation:",r),r.type==="productRecommendations/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with product recommendation:",r)),n!==void 0&&e.dispatch(n),i},Id=be(To());k("tab/register",e=>{let t=new Q({values:{id:T,expression:Ce}});return E(e,t)});var Sa=k("tab/updateActiveTab",e=>E(e,T)),Gr=be(Ar()),Od=be(_o()),qd=be(jo());Gr.default.extend(qd.default);Gr.default.extend(Od.default);var ba="/rest/search/v2",ka="/rest/ua",Ad=()=>({organizationId:"",accessToken:"",platformUrl:fn(),search:{apiBaseUrl:`${fn()}${ba}`,locale:"en-US",timezone:Gr.default.tz.guess(),authenticationProviders:[]},analytics:{enabled:!0,apiBaseUrl:`${hs()}${ka}`,nextApiBaseUrl:"",originContext:"Search",originLevel2:"default",originLevel3:"default",anonymous:!1,deviceId:"",userDisplayName:"",documentLocation:"",trackingId:"",analyticsMode:"legacy",source:{}}});function Ed(e,t){if(ys(e))return e.replace(/^(https:\/\/)platform/,"$1analytics")+ka;let r=vs(e,t);return r?ds(t,r.environment).analytics:e}var Dd=Ie(Ad(),e=>e.addCase(Lt,(t,r)=>{r.payload.accessToken&&(t.accessToken=r.payload.accessToken),r.payload.organizationId&&(t.organizationId=r.payload.organizationId),r.payload.platformUrl&&(t.platformUrl=r.payload.platformUrl,t.search.apiBaseUrl=`${r.payload.platformUrl}${ba}`,t.analytics.apiBaseUrl=Ed(r.payload.platformUrl,t.organizationId))}).addCase(ft,(t,r)=>{r.payload.apiBaseUrl&&(t.search.apiBaseUrl=r.payload.apiBaseUrl),r.payload.locale&&(t.search.locale=r.payload.locale),r.payload.timezone&&(t.search.timezone=r.payload.timezone),r.payload.authenticationProviders&&(t.search.authenticationProviders=r.payload.authenticationProviders)}).addCase(jr,(t,r)=>{H(r.payload.enabled)||(t.analytics.enabled=r.payload.enabled),H(r.payload.originContext)||(t.analytics.originContext=r.payload.originContext),H(r.payload.originLevel2)||(t.analytics.originLevel2=r.payload.originLevel2),H(r.payload.originLevel3)||(t.analytics.originLevel3=r.payload.originLevel3),H(r.payload.apiBaseUrl)||(t.analytics.apiBaseUrl=r.payload.apiBaseUrl),H(r.payload.nextApiBaseUrl)||(t.analytics.nextApiBaseUrl=r.payload.nextApiBaseUrl),H(r.payload.trackingId)||(t.analytics.trackingId=r.payload.trackingId),H(r.payload.analyticsMode)||(t.analytics.analyticsMode=r.payload.analyticsMode),H(r.payload.source)||(t.analytics.source=r.payload.source);let n=(0,Id.default)();n&&(t.analytics.analyticsMode="next",t.analytics.trackingId=n),H(r.payload.runtimeEnvironment)||(t.analytics.runtimeEnvironment=r.payload.runtimeEnvironment),H(r.payload.anonymous)||(t.analytics.anonymous=r.payload.anonymous),H(r.payload.deviceId)||(t.analytics.deviceId=r.payload.deviceId),H(r.payload.userDisplayName)||(t.analytics.userDisplayName=r.payload.userDisplayName),H(r.payload.documentLocation)||(t.analytics.documentLocation=r.payload.documentLocation)}).addCase(Pr,t=>{t.analytics.enabled=!1}).addCase($r,t=>{t.analytics.enabled=!0}).addCase(Ai,(t,r)=>{t.analytics.originLevel2=r.payload.originLevel2}).addCase(Ei,(t,r)=>{t.analytics.originLevel3=r.payload.originLevel3}).addCase(Sa,(t,r)=>{t.analytics.originLevel2=r.payload}).addCase(Qt,(t,r)=>{t.analytics.originLevel2=r.payload.tab||t.analytics.originLevel2})),gt=Dd;function Rd(e){return e.instantlyCallable}var xd=()=>e=>t=>e(Rd(t)?t():t),Ud=e=>()=>t=>r=>{var a;let n=r;if(!n.error)return t(r);let i=n.error;if((a=n.payload)!=null&&a.ignored||e.error(i.stack||i.message||i.name||"Error",`Action dispatch error ${n.type}`,r),n.error.name!=="SchemaValidationError")return t(r)},Fd=e=>t=>r=>n=>(e.debug({action:n,nextState:t.getState()},`Action dispatched: ${n.type}`),r(n)),Md=()=>({referrer:document.referrer,userAgent:navigator.userAgent,location:window.location.href}),Td=()=>({referrer:"default",userAgent:"Node.js",location:"default"});function _d(e,t){let r={...e},n,i=a=>(o,s)=>{let u=a(o,s);return n?n(u,s):u};return{get combinedReducer(){let a=Zo(Object.entries(t).filter(([o])=>!(o in r)).map(([o,s])=>[o,()=>s]));return i(hi({...a,...r}))},containsAll(a){return Object.keys(a).every(o=>o in r)},add(a){Object.keys(a).filter(o=>!(o in r)).forEach(o=>r[o]=a[o])},addCrossReducer(a){n=a}}}function Ca(e,t,r){var n,i,a;t===void 0&&(t=50),r===void 0&&(r={});var o=(n=r.isImmediate)!=null&&n,s=(i=r.callback)!=null&&i,u=r.maxWait,c=Date.now(),d=[];function f(){if(u!==void 0){var w=Date.now()-c;if(w+t>=u)return u-w}return t}var p=function(){var w=[].slice.call(arguments),C=this;return new Promise(function(l,g){var S=o&&a===void 0;if(a!==void 0&&clearTimeout(a),a=setTimeout(function(){if(a=void 0,c=Date.now(),!o){var M=e.apply(C,w);s&&s(M),d.forEach(function(z){return(0,z.resolve)(M)}),d=[]}},f()),S){var q=e.apply(C,w);return s&&s(q),l(q)}d.push({resolve:l,reject:g})})};return p.cancel=function(w){a!==void 0&&clearTimeout(a),d.forEach(function(C){return(0,C.reject)(w)}),d=[]},p}function jd(e,t){let r=0,n=Ca(()=>r=0,500);return i=>a=>async o=>{if(typeof o!="function")return a(o);let s=await a(o);if(!Pd(s))return s;if(typeof t!="function")return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),s;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),s;r++,n();let u=await $d(t);i.dispatch(Lt({accessToken:u})),i.dispatch(o)}}function Pd(e){var t;return((t=e==null?void 0:e.error)==null?void 0:t.name)===new oi().name}async function $d(e){try{return await e()}catch{return""}}function Ld({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:n,name:i}){return hu({reducer:e,preloadedState:t,devTools:{stateSanitizer:a=>a.history?{...a,history:"<<OMIT>>"}:a,name:i,shouldHotReload:!1},middleware:a=>a({thunk:{extraArgument:n}}).prepend(...r).concat(Fd(n.logger))})}var Qd={configuration:gt,version:Sd};function Vd(e,t){var o;let r=((o=e.organizationEndpoints)==null?void 0:o.analytics)||void 0,{analyticsClientMiddleware:n,...i}=e.analytics??{},a={...i,nextApiBaseUrl:`${r}/rest/organizations/${e.organizationId}/events/v1`,apiBaseUrl:r};if(ii())return t.info("Analytics disabled since doNotTrack is active."),{...a,enabled:!1};if(a.analyticsMode==="next"&&!i.trackingId)throw new Jd('analytics.trackingId is required when analytics.analyticsMode="next"');return a}function zd(e,t){var u;let r=Nd(e,t),{accessToken:n,organizationId:i}=e.configuration,{organizationEndpoints:a}=e.configuration,o=(a==null?void 0:a.platform)||e.configuration.platformUrl;Wd(e.configuration)&&r.logger.warn(`The \`platformUrl\` (${e.configuration.platformUrl}) option will be deprecated in the next major version. Consider using the \`organizationEndpoints\` option instead. See [Organization endpoints](https://docs.coveo.com/en/mcc80216).`),Bd(e.configuration)?r.logger.warn("The `organizationEndpoints` options was not explicitly set in the Headless engine configuration. Coveo recommends setting this option, as it has resiliency benefits and simplifies the overall configuration for multi-region deployments. See [Organization endpoints](https://docs.coveo.com/en/mcc80216)."):Gd(e.configuration)&&r.logger.warn(`There is a mismatch between the \`organizationId\` option (${e.configuration.organizationId}) and the organization configured in the \`organizationEndpoints\` option (${(u=e.configuration.organizationEndpoints)==null?void 0:u.platform}). This could lead to issues that are complex to troubleshoot. Please make sure both values match.`),r.dispatch(Lt({accessToken:n,organizationId:i,platformUrl:o}));let s=Vd(e.configuration,r.logger);return s&&r.dispatch(jr(s)),r}function Nd(e,t){let{reducers:r}=e,n=_d({...Qd,...r},e.preloadedState??{});e.crossReducer&&n.addCrossReducer(e.crossReducer);let i=t.logger,a=e.navigatorContextProvider??bd()?Md:Td,o={...t,get relay(){return Ir(u.state)},get navigatorContext(){return a()}},s=Hd(e,o,n),u={addReducers(c){n.containsAll(c)||(n.add(c),s.replaceReducer(n.combinedReducer))},dispatch:s.dispatch,subscribe:s.subscribe,enableAnalytics(){s.dispatch($r())},disableAnalytics(){s.dispatch(Pr())},get state(){return s.getState()},get relay(){return Ir(this.state)},get navigatorContext(){return a()},logger:i,store:s};return u}function Hd(e,t,r){let{preloadedState:n,configuration:i}=e,a=i.name||"coveo-headless",o=Yd(e,t.logger);return Ld({preloadedState:n,reducer:r.combinedReducer,middlewares:o,thunkExtraArguments:t,name:a})}function Yd(e,t){let{renewAccessToken:r}=e.configuration,n=jd(t,r);return[xd,n,Ud(t),Cd].concat(e.middlewares||[])}function Bd(e){return oe(e.organizationEndpoints)}function Wd(e){var t;return!H(e.platformUrl)||H((t=e.organizationEndpoints)==null?void 0:t.platform)}function Gd(e){let{platform:t}=e.organizationEndpoints;if(oe(t))return!1;let r=ci(t);return r&&r.organizationId!==e.organizationId}var Jd=class extends Error{constructor(e){super(e),this.name="InvalidEngineConfiguration"}},Kd=be($o());function Zd(e){return(0,Kd.default)({name:"@coveo/headless",level:(e==null?void 0:e.level)||"warn",formatters:{log:e==null?void 0:e.logFormatter}})}function Xd(e,t){let r=eh(e),n=He,i=th(e);return{analyticsClientMiddleware:r,validatePayload:n,preprocessRequest:i,logger:t}}function eh(e){let{analytics:t}=e,r=(n,i)=>i;return(t==null?void 0:t.analyticsClientMiddleware)||r}function th(e){return e.preprocessRequest||ai}var rh={organizationId:T,accessToken:T,platformUrl:new U({required:!1,emptyAllowed:!1}),name:new U({required:!1,emptyAllowed:!1}),analytics:new Q({options:{required:!1},values:{enabled:new K({required:!1}),originContext:new U({required:!1}),originLevel2:new U({required:!1}),originLevel3:new U({required:!1}),analyticsMode:new U({constrainTo:["legacy","next"],required:!1})}})},nh=new Ze({...rh,pipeline:new U({required:!1,emptyAllowed:!0}),searchHub:ae,locale:ae,timezone:ae}),ih={debug:_u,pipeline:xi,searchHub:va,recommendation:Wr};function sp(e){let t=Zd(e.loggerOptions);ah(e.configuration,t);let r=oh(e.configuration,t),n={...Xd(e.configuration,t),apiClient:r},i={...e,reducers:ih},a=zd(i,n),{pipeline:o,searchHub:s,timezone:u,locale:c}=e.configuration;return a.dispatch(ft({timezone:u,locale:c})),H(o)||a.dispatch(Ri(o)),H(s)||a.dispatch(ya(s)),{...a,get state(){return a.state}}}function ah(e,t){try{nh.validate(e)}catch(r){throw t.error(r,"Recommendation engine configuration error"),r}}function oh(e,t){return new Is({logger:t,preprocessRequest:e.preprocessRequest||ai,postprocessSearchResponseMiddleware:Ds,postprocessFacetSearchResponseMiddleware:Rs,postprocessQuerySuggestResponseMiddleware:xs})}function up(e){return e.addReducers({configuration:gt}),{disableAnalytics:Pr,enableAnalytics:$r,setOriginLevel2:Ai,setOriginLevel3:Ei,updateAnalyticsConfiguration:jr,updateBasicConfiguration:Lt}}function cp(e){return e.addReducers({configuration:gt,pipeline:xi,searchHub:va}),{updateSearchConfiguration:ft}}var Me=()=>new U({required:!1,emptyAllowed:!0}),sh=k("advancedSearchQueries/update",e=>E(e,{aq:Me(),cq:Me(),lq:Me(),dq:Me()})),uh=k("advancedSearchQueries/register",e=>E(e,{aq:Me(),cq:Me(),lq:Me(),dq:Me()})),ut=()=>({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,lq:"",lqWasSet:!1,dq:"",dqWasSet:!1,defaultFilters:{cq:"",aq:"",lq:"",dq:""}});Ie(ut(),e=>{e.addCase(sh,(t,r)=>{let{aq:n,cq:i,lq:a,dq:o}=r.payload;oe(n)||(t.aq=n,t.aqWasSet=!0),oe(i)||(t.cq=i,t.cqWasSet=!0),oe(a)||(t.lq=a,t.lqWasSet=!0),oe(o)||(t.dq=o,t.dqWasSet=!0)}).addCase(uh,(t,r)=>{let{aq:n,cq:i,lq:a,dq:o}=r.payload;oe(n)||(t.defaultFilters.aq=n,t.aqWasSet||(t.aq=n)),oe(i)||(t.defaultFilters.cq=i,t.cqWasSet||(t.cq=i)),oe(a)||(t.defaultFilters.lq=a,t.lqWasSet||(t.lq=a)),oe(o)||(t.defaultFilters.dq=o,t.dqWasSet||(t.dq=o))}).addCase(Pe.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.advancedSearchQueries)??t}).addCase(Qt,(t,r)=>{let{aq:n,cq:i}=r.payload;oe(n)||(t.aq=n,t.aqWasSet=!0),oe(i)||(t.cq=i,t.cqWasSet=!0)})});var ch=new le({each:T,required:!0}),Ia=(e,t)=>(E(e,T),Er(t)?E(t,T):E(t,ch),{payload:{contextKey:e,contextValue:t}}),lh=k("context/set",e=>{for(let[t,r]of Object.entries(e))Ia(t,r);return{payload:e}}),dh=k("context/add",e=>Ia(e.contextKey,e.contextValue)),hh=k("context/remove",e=>E(e,T));function Oa(){return{contextValues:{}}}Ie(Oa(),e=>{e.addCase(lh,(t,r)=>{t.contextValues=r.payload}).addCase(dh,(t,r)=>{t.contextValues[r.payload.contextKey]=r.payload.contextValue}).addCase(hh,(t,r)=>{delete t.contextValues[r.payload]}).addCase(Pe.fulfilled,(t,r)=>{r.payload&&(t.contextValues=r.payload.context.contextValues)})});var fh=k("dictionaryFieldContext/set",e=>{let t=new Q({options:{required:!0}}),r=E(e,t).error;if(r)return{payload:e,error:r};let n=Object.values(e),i=new le({each:Ce}),a=E(n,i).error;return a?{payload:e,error:a}:{payload:e}}),ph=k("dictionaryFieldContext/add",e=>{let t=new Q({options:{required:!0},values:{field:Ce,key:Ce}});return E(e,t)}),gh=k("dictionaryFieldContext/remove",e=>E(e,Ce));function qa(){return{contextValues:{}}}Ie(qa(),e=>{e.addCase(fh,(t,r)=>{t.contextValues=r.payload}).addCase(ph,(t,r)=>{let{field:n,key:i}=r.payload;t.contextValues[n]=i}).addCase(gh,(t,r)=>{delete t.contextValues[r.payload]}).addCase(Pe.fulfilled,(t,r)=>{r.payload&&(t.contextValues=r.payload.dictionaryFieldContext.contextValues)})});var Jr=async(e,t)=>{var r,n,i,a;return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await pt(e.configuration.analytics),actionsHistory:et.getHistory()},...((r=e.advancedSearchQueries)==null?void 0:r.aq)&&{aq:e.advancedSearchQueries.aq},...((n=e.advancedSearchQueries)==null?void 0:n.cq)&&{cq:e.advancedSearchQueries.cq},...((i=e.advancedSearchQueries)==null?void 0:i.lq)&&{lq:e.advancedSearchQueries.lq},...((a=e.advancedSearchQueries)==null?void 0:a.dq)&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await Hr(e.configuration.analytics,t),...e.excerptLength&&!H(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}}},Kr=async(e,t)=>{var r,n,i,a;return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await pt(e.configuration.analytics),actionsHistory:et.getHistory()},...((r=e.advancedSearchQueries)==null?void 0:r.aq)&&{aq:e.advancedSearchQueries.aq},...((n=e.advancedSearchQueries)==null?void 0:n.cq)&&{cq:e.advancedSearchQueries.cq},...((i=e.advancedSearchQueries)==null?void 0:i.lq)&&{lq:e.advancedSearchQueries.lq},...((a=e.advancedSearchQueries)==null?void 0:a.dq)&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await Hr(e.configuration.analytics,t),...e.excerptLength&&!H(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}}},mh={collectionField:new U({emptyAllowed:!1,required:!1}),parentField:new U({emptyAllowed:!1,required:!1}),childField:new U({emptyAllowed:!1,required:!1}),numberOfFoldedResults:new Y({min:0,required:!1})},yh=k("folding/register",e=>E(e,mh));ne("folding/loadCollection",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let i=t(),a=i.configuration.analytics.analyticsMode==="legacy"?await Jr(i):await Kr(i),o=await n.search({...a,q:vh(i),enableQuerySyntax:!0,cq:`@${i.folding.fields.collection}="${e}"`,filterField:i.folding.fields.collection,childField:i.folding.fields.parent,parentField:i.folding.fields.child,filterFieldRange:100},{origin:"foldingCollection"});return Ee(o)?r(o.error):{collectionId:e,results:o.success.results,rootResult:i.folding.collections[e].result}});function vh(e){return e.query.q===""?"":e.query.enableQuerySyntax?`${e.query.q} OR @uri`:`( <@- ${e.query.q} -@> ) OR @uri`}var wh=()=>({enabled:!1,fields:{collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"},filterFieldRange:2,collections:{}}),Aa=k("fields/registerFieldsToInclude",e=>E(e,Au)),Ea=k("fields/fetchall/enable"),Da=k("fields/fetchall/disable"),Ra=ne("fields/fetchDescription",async(e,{extra:t,getState:r,rejectWithValue:n})=>{let i=r(),{accessToken:a,organizationId:o}=i.configuration,{apiBaseUrl:s}=i.configuration.search,u=await t.apiClient.fieldDescriptions({accessToken:a,organizationId:o,url:s});return Ee(u)?n(u.error):u.success.fields}),xa=["author","language","urihash","objecttype","collection","source","permanentid"],Sh=[...xa,"date","filetype","parents"],lp=[...Sh,"ec_price","ec_name","ec_description","ec_brand","ec_category","ec_item_group_id","ec_shortdesc","ec_thumbnails","ec_images","ec_promo_price","ec_in_stock","ec_rating"],bh=()=>({fieldsToInclude:xa,fetchAllFields:!1,fieldsDescription:[]}),kh=Ie(bh(),e=>e.addCase(Aa,(t,r)=>{t.fieldsToInclude=[...new Set(t.fieldsToInclude.concat(r.payload))]}).addCase(Ea,t=>{t.fetchAllFields=!0}).addCase(Da,t=>{t.fetchAllFields=!1}).addCase(Ra.fulfilled,(t,{payload:r})=>{t.fieldsDescription=r}).addCase(yh,(t,{payload:r})=>{let n=wh().fields;t.fieldsToInclude.push(r.collectionField??n.collection,r.parentField??n.parent,r.childField??n.child)}));function dp(e){return e.addReducers({fields:kh}),{registerFieldsToInclude:Aa,enableFetchAllFields:Ea,disableFetchAllFields:Da,fetchFieldsDescription:Ra}}function hp(e){return e.addReducers({recommendation:Wr}),{getRecommendations:st,setRecommendationId:Br}}var Zr=k("breadcrumb/deselectAll"),Ua=k("breadcrumb/deselectAllNonBreadcrumbs"),Xr={value:T,numberOfResults:new Y({min:0}),state:T},te=T,Ch=new Y({min:1,default:8,required:!1}),Ih=new Y({min:1,max:20,default:5,required:!1}),Oh={desiredCount:Ih,numberOfValues:Ch};k("automaticFacet/setOptions",e=>E(e,Oh));k("automaticFacet/deselectAll",e=>E(e,te));var qh=T,Ah=k("automaticFacet/toggleSelectValue",e=>E(e,{field:qh,selection:new Q({values:Xr})})),Eh={state:new ce({required:!0}),numberOfResults:new Y({required:!0,min:0}),value:new U({required:!0,emptyAllowed:!0}),path:new le({required:!0,each:T}),moreValuesAvailable:new K({required:!1})};function Fa(e){e.children.forEach(t=>{Fa(t)}),He({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},Eh)}var Ke={facetId:te,field:T,delimitingCharacter:new U({required:!1,emptyAllowed:!0}),filterFacetCount:new K({required:!1}),injectionDepth:new Y({required:!1,min:0}),numberOfValues:new Y({required:!1,min:1}),sortCriteria:new ce({required:!1}),basePath:new le({required:!1,each:T}),filterByBasePath:new K({required:!1})};k("categoryFacet/register",e=>E(e,Ke));var Dh=k("categoryFacet/toggleSelectValue",e=>{try{return He(e.facetId,T),Fa(e.selection),{payload:e,error:null}}catch(t){return{payload:e,error:Xe(t)}}}),Rh=k("categoryFacet/deselectAll",e=>E(e,Ke.facetId));k("categoryFacet/updateNumberOfValues",e=>E(e,{facetId:Ke.facetId,numberOfValues:Ke.numberOfValues}));k("categoryFacet/updateSortCriterion",e=>E(e,{facetId:Ke.facetId,criterion:new ce}));k("categoryFacet/updateBasePath",e=>E(e,{facetId:Ke.facetId,basePath:new le({each:T})}));var en={facetId:te,captions:new Q({options:{required:!1}}),numberOfValues:new Y({required:!1,min:1}),query:new U({required:!1,emptyAllowed:!0})},xh={path:new le({required:!0,each:T}),displayValue:Ce,rawValue:Ce,count:new Y({required:!0,min:0})},Uh=k("categoryFacet/selectSearchResult",e=>E(e,{facetId:te,value:new Q({values:xh})}));k("categoryFacetSearch/register",e=>E(e,en));var Ma={facetId:te,value:new Q({values:{displayValue:Ce,rawValue:Ce,count:new Y({required:!0,min:0})}})};k("facetSearch/register",e=>E(e,en));k("facetSearch/update",e=>E(e,en));var Fh=k("facetSearch/toggleSelectValue",e=>E(e,Ma)),Mh=k("facetSearch/toggleExcludeValue",e=>E(e,Ma)),Or=be(Ar()),Th=be(Lo());Or.default.extend(Th.default);var Ta="YYYY/MM/DD@HH:mm:ss",_h="1401-01-01";function Mt(e,t){let r=(0,Or.default)(e,t);return!r.isValid()&&!t?(0,Or.default)(e,Ta):r}function _a(e){return e.format(Ta)}function jh(e,t){let r=Mt(e,t);if(!r.isValid()){let n=". Please provide a date format string in the configuration options. See https://day.js.org/docs/en/parse/string-format for more information.",i=` with the format "${t}"`;throw new Error(`Could not parse the provided date "${e}"${t?i:n}`)}ja(r)}function ja(e){if(e.isBefore(_h))throw new Error(`Date is before year 1401, which is unsupported by the API: ${e}`)}var It=be(Ar()),Ph=be(Qo());It.default.extend(Ph.default);var Pa=["past","now","next"],$a=["minute","hour","day","week","month","quarter","year"],$h=e=>{let t=e==="now";return{amount:new Y({required:!t,min:1}),unit:new U({required:!t,constrainTo:$a}),period:new U({required:!0,constrainTo:Pa})}};function Yn(e){if(typeof e=="string"&&!ht(e))throw new Error(`The value "${e}" is not respecting the relative date format "period-amount-unit"`);let t=typeof e=="string"?Va(e):e;new Ze($h(t.period)).validate(t);let r=La(t),n=JSON.stringify(t);if(!r.isValid())throw new Error(`Date is invalid: ${n}`);ja(r)}function Lh(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":case"next":return`${t}-${r}-${n}`;case"now":return t}}function La(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":return(0,It.default)().subtract(r,n);case"next":return(0,It.default)().add(r,n);case"now":return(0,It.default)()}}function qr(e){return _a(La(Va(e)))}function Qa(e){return e.toLocaleLowerCase().split("-")}function ht(e){let[t,r,n]=Qa(e);if(t==="now")return!0;if(!Pa.includes(t)||!$a.includes(n))return!1;let i=parseInt(r);return!(isNaN(i)||i<=0)}function Qh(e){return!!e&&typeof e=="object"&&"period"in e}function Va(e){let[t,r,n]=Qa(e);return t==="now"?{period:"now"}:{period:t,amount:r?parseInt(r):void 0,unit:n||void 0}}function Vh(e){let t=Bn(e.start,e),r=Bn(e.end,e),n=e.endInclusive??!1,i=e.state??"idle";return{start:t,end:r,endInclusive:n,state:i}}function Bn(e,t){let{dateFormat:r}=t;return Qh(e)?(Yn(e),Lh(e)):typeof e=="string"&&ht(e)?(Yn(e),e):(jh(e,r),_a(Mt(e,r)))}new U({regex:/^[a-zA-Z0-9-_]+$/});new U({required:!0});new le({each:new U});new U;var zh=new Y({min:1}),Nh=new Q,Hh=new U,Yh={captions:Nh,numberOfValues:zh,query:Hh};new Q({values:Yh});var Bh=new Q({options:{required:!1},values:{type:new U({constrainTo:["simple"],emptyAllowed:!1,required:!0}),values:new le({required:!0,max:25,each:new U({emptyAllowed:!1,required:!0})})}}),Wh=new le({min:1,max:25,required:!1,each:new U({emptyAllowed:!1,required:!0})}),Gh={facetId:te,field:new U({required:!0,emptyAllowed:!0}),filterFacetCount:new K({required:!1}),injectionDepth:new Y({required:!1,min:0}),numberOfValues:new Y({required:!1,min:1}),sortCriteria:new ce({required:!1}),resultsMustMatch:new ce({required:!1}),allowedValues:Bh,customSort:Wh};k("facet/register",e=>E(e,Gh));var Jh=k("facet/toggleSelectValue",e=>E(e,{facetId:te,selection:new Q({values:Xr})})),Kh=k("facet/toggleExcludeValue",e=>E(e,{facetId:te,selection:new Q({values:Xr})})),Zh=k("facet/deselectAll",e=>E(e,te));k("facet/updateSortCriterion",e=>E(e,{facetId:te,criterion:new ce({required:!0})}));k("facet/updateNumberOfValues",e=>E(e,{facetId:te,numberOfValues:new Y({required:!0,min:1})}));k("facet/updateIsFieldExpanded",e=>E(e,{facetId:te,isFieldExpanded:new K({required:!0})}));k("facet/updateFreezeCurrentValues",e=>E(e,{facetId:te,freezeCurrentValues:new K({required:!0})}));k("rangeFacet/updateSortCriterion",e=>E(e,{facetId:te,criterion:new ce({required:!0})}));var tn={state:T,start:new Y({required:!0}),end:new Y({required:!0}),endInclusive:new K({required:!0}),numberOfResults:new Y({required:!0,min:0})},rn={start:T,end:T,endInclusive:new K({required:!0}),state:T,numberOfResults:new Y({required:!0,min:0})},Xh={start:T,end:T,endInclusive:new K({required:!0}),state:T},ef={facetId:te,field:T,currentValues:new le({required:!1,each:new Q({values:Xh})}),generateAutomaticRanges:new K({required:!0}),filterFacetCount:new K({required:!1}),injectionDepth:new Y({required:!1,min:0}),numberOfValues:new Y({required:!1,min:1}),sortCriteria:new ce({required:!1}),rangeAlgorithm:new ce({required:!1})};function Wn(e){return ht(e)?qr(e):e}function za(e){e.currentValues&&e.currentValues.forEach(t=>{let{start:r,end:n}=Vh(t);if(Mt(Wn(r)).isAfter(Mt(Wn(n))))throw new Error(`The start value is greater than the end value for the date range ${t.start} to ${t.end}`)})}k("dateFacet/register",e=>{try{return He(e,ef),za(e),{payload:e,error:null}}catch(t){return{payload:e,error:Xe(t)}}});var tf=k("dateFacet/toggleSelectValue",e=>E(e,{facetId:te,selection:new Q({values:rn})})),rf=k("dateFacet/toggleExcludeValue",e=>E(e,{facetId:te,selection:new Q({values:rn})})),nf=k("dateFacet/updateFacetValues",e=>{try{return He(e,{facetId:te,values:new le({each:new Q({values:rn})})}),za({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:Xe(t)}}}),af={state:T,start:new Y({required:!0}),end:new Y({required:!0}),endInclusive:new K({required:!0})},of={facetId:te,field:T,currentValues:new le({required:!1,each:new Q({values:af})}),generateAutomaticRanges:new K({required:!0}),filterFacetCount:new K({required:!1}),injectionDepth:new Y({required:!1,min:0}),numberOfValues:new Y({required:!1,min:1}),sortCriteria:new ce({required:!1}),rangeAlgorithm:new ce({required:!1})};function Na(e){e.currentValues&&e.currentValues.forEach(({start:t,end:r})=>{if(t>r)throw new Error(`The start value is greater than the end value for the numeric range ${t} to ${r}`)})}k("numericFacet/register",e=>{try{return E(e,of),Na(e),{payload:e,error:null}}catch(t){return{payload:e,error:Xe(t)}}});var sf=k("numericFacet/toggleSelectValue",e=>E(e,{facetId:te,selection:new Q({values:tn})})),uf=k("numericFacet/toggleExcludeValue",e=>E(e,{facetId:te,selection:new Q({values:tn})})),cf=k("numericFacet/updateFacetValues",e=>{try{return He(e,{facetId:te,values:new le({each:new Q({values:tn})})}),Na({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:Xe(t)}}}),lf=e=>e.error!==void 0;function Ha(e,t){let r={};e.forEach(a=>r[a.facetId]=a);let n=[];t.forEach(a=>{a in r&&(n.push(r[a]),delete r[a])});let i=Object.values(r);return[...n,...i]}function Ve(e){return Object.values(e).map(t=>t.request)}var Gn=()=>Ye("search/logFetchMoreResults",e=>e.makeFetchMoreResults()),ze=e=>Ye("search/queryError",(t,r)=>{var n,i,a,o;return t.makeQueryError({query:((n=r.query)==null?void 0:n.q)||tt().q,aq:((i=r.advancedSearchQueries)==null?void 0:i.aq)||ut().aq,cq:((a=r.advancedSearchQueries)==null?void 0:a.cq)||ut().cq,dq:((o=r.advancedSearchQueries)==null?void 0:o.dq)||ut().dq,errorType:e.type,errorMessage:e.message})}),Ya=(e=>(e.Relevance="relevance",e.Fields="fields",e))(Ya||{}),Ba=(e=>(e.Ascending="asc",e.Descending="desc",e))(Ba||{});new Q({options:{required:!1},values:{by:new Ot({enum:Ya,required:!0}),fields:new le({each:new Q({values:{name:new U,direction:new Ot({enum:Ba})}})})}});var df=()=>ad("analytics/productListing/load",e=>e.makeInterfaceLoad(),e=>new Yr(e));k("productlisting/setUrl",e=>E(e,{url:new U({required:!0,url:!0})}));k("productlisting/setAdditionalFields",e=>E(e,{additionalFields:new le({required:!0,each:new U({required:!0,emptyAllowed:!1})})}));var hf=ne("productlisting/fetch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:i})=>{let a=t(),{apiClient:o}=i,s=await o.getProducts(await ff(a));return lf(s)?(r(ze(s.error)),n(s.error)):{response:s.success,analyticsAction:df()}}),ff=async e=>{var n,i,a;let t=gf(e),r=await pt(e.configuration.analytics);return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,platformUrl:e.configuration.platformUrl,url:(n=e.productListing)==null?void 0:n.url,...e.configuration.analytics.enabled&&r?{clientId:r}:{},...(i=e.productListing.additionalFields)!=null&&i.length?{additionalFields:e.productListing.additionalFields}:{},...e.productListing.advancedParameters&&pf(e.productListing.advancedParameters)?{advancedParameters:e.productListing.advancedParameters||{}}:{},...t.length&&{facets:{requests:t}},...e.pagination&&{pagination:{numberOfValues:e.pagination.numberOfResults,page:Math.ceil(e.pagination.firstResult/(e.pagination.numberOfResults||1))+1}},...(((a=e.sort)==null?void 0:a.by)||"relevance")!=="relevance"&&{sort:e.sort},...e.context&&{userContext:e.context.contextValues}}};function pf(e){return e.debug}function gf(e){return Ha(mf(e),e.facetOrder??[])}function mf(e){return[...Ve(e.facetSet??{}),...Ve(e.numericFacetSet??{}),...Ve(e.dateFacetSet??{}),...Ve(e.categoryFacetSet??{})]}var Wa=k("facet/updateFacetAutoSelection",e=>E(e,{allow:new K({required:!0})})),yf=class extends zt{constructor(e){super(e),this.getState=e}get activeInstantResultQuery(){let e=this.getState().instantResults;for(let t in e)for(let r in e[t].cache)if(e[t].cache[r].isActive)return e[t].q;return null}get activeInstantResultCache(){let e=this.getState().instantResults;for(let t in e)for(let r in e[t].cache)if(e[t].cache[r].isActive)return e[t].cache[r];return null}get results(){var e;return(e=this.activeInstantResultCache)==null?void 0:e.results}get queryText(){return this.activeInstantResultQuery??tt().q}get responseTime(){var e;return((e=this.activeInstantResultCache)==null?void 0:e.duration)??Ge().duration}get numberOfResults(){var e;return((e=this.activeInstantResultCache)==null?void 0:e.totalCountFiltered)??Ge().response.totalCountFiltered}getSearchUID(){var e;return((e=this.activeInstantResultCache)==null?void 0:e.searchUid)||super.getSearchUID()}},vf=()=>Ye("analytics/instantResult/searchboxAsYouType",e=>e.makeSearchboxAsYouType(),e=>new yf(e)),wf=()=>({actionCause:"searchboxAsYouType"}),nn={id:T},Sf={...nn,q:Ce};k("instantResults/register",e=>E(e,nn));var Ga=k("instantResults/updateQuery",e=>E(e,Sf));k("instantResults/clearExpired",e=>E(e,nn));var Nt=new Y({required:!0,min:0}),Ja=k("pagination/registerNumberOfResults",e=>E(e,Nt)),Ka=k("pagination/updateNumberOfResults",e=>E(e,Nt)),Za=k("pagination/registerPage",e=>E(e,Nt)),Ht=k("pagination/updatePage",e=>E(e,Nt)),Xa=k("pagination/nextPage"),eo=k("pagination/previousPage"),Yt=k("query/updateQuery",e=>E(e,{q:new U,enableQuerySyntax:new K}));function bf(e){return e.type==="dateRange"}function to(e){return`start${e}`}function ro(e){return`end${e}`}var kf=()=>({dateFacetValueMap:{}});function Cf(e,t,r){let n=e.start,i=e.end;return ht(n)&&(n=qr(n),r.dateFacetValueMap[t][to(n)]=e.start),ht(i)&&(i=qr(i),r.dateFacetValueMap[t][ro(i)]=e.end),{...e,start:n,end:i}}function If(e,t){if(bf(e)){let{facetId:r,currentValues:n}=e;return t.dateFacetValueMap[r]={},{...e,currentValues:n.map(i=>Cf(i,r,t))}}return e}function an(e){var r;let t=kf();return{request:{...e,facets:(r=e.facets)==null?void 0:r.map(n=>If(n,t))},mappings:t}}function Of(e,t,r){return{...e,start:r.dateFacetValueMap[t][to(e.start)]||e.start,end:r.dateFacetValueMap[t][ro(e.end)]||e.end}}function qf(e,t){return e.facetId in t.dateFacetValueMap}function Af(e,t){return qf(e,t)?{...e,values:e.values.map(r=>Of(r,e.facetId,t))}:e}function no(e,t){var r;return"success"in e?{success:{...e.success,facets:(r=e.success.facets)==null?void 0:r.map(n=>Af(n,t))}}:e}var Se=async(e,t)=>{var s;let r=Mf(e),n=Ef(e),i=Df(e),a=e.configuration.analytics.analyticsMode==="legacy"?await Jr(e,t):await Kr(e,t),o=()=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0;return an({...a,...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="next",options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="legacy"},...r&&{cq:r},...n.length&&{facets:n},...e.pagination&&{numberOfResults:o(),firstResult:e.pagination.firstResult},...e.facetOptions&&{facetOptions:{freezeFacetOrder:e.facetOptions.freezeFacetOrder}},...((s=e.folding)==null?void 0:s.enabled)&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.automaticFacetSet&&{generateAutomaticFacets:{desiredCount:e.automaticFacetSet.desiredCount,numberOfValues:e.automaticFacetSet.numberOfValues,currentFacets:i}},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})};function Ef(e){return Ha(xf(e),e.facetOrder??[])}function Df(e){var r;let t=(r=e.automaticFacetSet)==null?void 0:r.set;return t?Object.values(t).map(n=>n.response).map(Rf).filter(n=>n.currentValues.length>0):void 0}function Rf(e){let{field:t,label:r,values:n}=e,i=n.filter(a=>a.state==="selected");return{field:t,label:r,currentValues:i}}function xf(e){return Uf(e).filter(({facetId:t})=>{var r,n;return((n=(r=e.facetOptions)==null?void 0:r.facets[t])==null?void 0:n.enabled)??!0})}function Uf(e){return[...Ff(e.facetSet??{}),...Jn(e.numericFacetSet??{}),...Jn(e.dateFacetSet??{}),...Ve(e.categoryFacetSet??{})]}function Ff(e){return Ve(e).map(t=>t.sortCriteria==="alphanumericDescending"?{...t,sortCriteria:{type:"alphanumeric",order:"descending"}}:t)}function Jn(e){return Ve(e).map(t=>{let r=t.currentValues.some(({state:n})=>n!=="idle");return t.generateAutomaticRanges&&!r?{...t,currentValues:[]}:t})}function Mf(e){var i,a;let t=((i=e.advancedSearchQueries)==null?void 0:i.cq.trim())||"",r=((a=Object.values(e.tabSet||{}).find(o=>o.isActive))==null?void 0:a.expression.trim())||"",n=Tf(e);return[t,r,...n].filter(o=>!!o).join(" AND ")}function Tf(e){return Object.values(e.staticFilterSet||{}).map(t=>{let r=t.values.filter(i=>i.state==="selected"&&!!i.expression.trim()),n=r.map(i=>i.expression).join(" OR ");return r.length>1?`(${n})`:n})}k("didYouMean/enable");k("didYouMean/disable");k("didYouMean/automaticCorrections/disable");k("didYouMean/automaticCorrections/enable");var io=k("didYouMean/correction",e=>E(e,T));k("didYouMean/automaticCorrections/mode",e=>E(e,new U({constrainTo:["next","legacy"],emptyAllowed:!1,required:!0})));var Kn=()=>Ye("analytics/didyoumean/automatic",e=>e.makeDidYouMeanAutomatic()),_f=()=>({actionCause:"didyoumeanAutomatic"});function jf(){return{freezeFacetOrder:!1,facets:{}}}function Pf(){return[]}function on(){return{firstResult:0,defaultNumberOfResults:10,numberOfResults:10,totalCountFiltered:0}}function $f(){return{}}function Lf(){return{}}function Qf(){return{}}function Te(e){return{context:e.context||Oa(),dictionaryFieldContext:e.dictionaryFieldContext||qa(),facetSet:e.facetSet||ta(),numericFacetSet:e.numericFacetSet||ea(),dateFacetSet:e.dateFacetSet||Xi(),categoryFacetSet:e.categoryFacetSet||Zi(),automaticFacetSet:e.automaticFacetSet??Ji(),pagination:e.pagination||on(),query:e.query||tt(),tabSet:e.tabSet||Qf(),advancedSearchQueries:e.advancedSearchQueries||ut(),staticFilterSet:e.staticFilterSet||Lf(),querySet:e.querySet||$f(),sortCriteria:e.sortCriteria||oa(),pipeline:e.pipeline||Lr(),searchHub:e.searchHub||zr(),facetOptions:e.facetOptions||jf(),facetOrder:e.facetOrder??Pf(),debug:e.debug??Di()}}new Q({values:{undoneQuery:Ce},options:{required:!0}});var Vf=()=>Ye("analytics/trigger/query",(e,t)=>{var r;return(r=t.triggers)!=null&&r.queryModification.newQuery?e.makeTriggerQuery():null}),ao=k("trigger/query/ignore",e=>E(e,new U({emptyAllowed:!0,required:!0}))),oo=k("trigger/query/modification",e=>E(e,new Q({values:{originalQuery:ae,modification:ae}}))),mt=class{constructor(e,t=r=>{this.dispatch(Yt({q:r}))}){this.config=e,this.onUpdateQueryForCorrection=t}async fetchFromAPI({mappings:e,request:t},r){var s;let n=new Date().getTime(),i=no(await this.extra.apiClient.search(t,r),e),a=new Date().getTime()-n,o=((s=this.getState().query)==null?void 0:s.q)||"";return{response:i,duration:a,queryExecuted:o,requestExecuted:t}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return Ee(e.response)?(this.dispatch(ze(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:i}=t.didYouMean,{results:a,queryCorrections:o,queryCorrection:s}=r;if(!n||!i)return null;let u=a.length===0&&o&&o.length!==0,c=!H(s)&&!H(s.correctedQuery);if(!u&&!c)return null;let d=u?await this.processLegacyDidYouMeanAutoCorrection(e):this.processModernDidYouMeanAutoCorrection(e);return this.dispatch(Fe(Te(this.getState()))),d}async processLegacyDidYouMeanAutoCorrection(e){let t=this.getCurrentQuery(),r=this.getSuccessResponse(e);if(!r.queryCorrections)return null;let{correctedQuery:n}=r.queryCorrections[0],i=await this.automaticallyRetryQueryWithCorrection(n);return Ee(i.response)?(this.dispatch(ze(i.response.error)),this.rejectWithValue(i.response.error)):(this.logOriginalAnalyticsQueryBeforeAutoCorrection(e),this.dispatch(Fe(Te(this.getState()))),{...i,response:{...i.response.success,queryCorrections:r.queryCorrections},automaticallyCorrected:!0,originalQuery:t,analyticsAction:Kn()})}processModernDidYouMeanAutoCorrection(e){let t=this.getSuccessResponse(e),{correctedQuery:r,originalQuery:n}=t.queryCorrection;return this.onUpdateQueryForCorrection(r),{...e,response:{...t},queryExecuted:r,automaticallyCorrected:!0,originalQuery:n,analyticsAction:Kn()}}logOriginalAnalyticsQueryBeforeAutoCorrection(e){let t=this.getState(),r=this.getSuccessResponse(e);this.analyticsAction&&this.analyticsAction()(this.dispatch,()=>this.getStateAfterResponse(e.queryExecuted,e.duration,t,r),this.extra)}async processQueryTriggersOrContinue(e){var a,o;let t=this.getSuccessResponse(e);if(!t)return null;let r=((a=t.triggers.find(s=>s.type==="query"))==null?void 0:a.content)||"";if(!r)return null;if(((o=this.getState().triggers)==null?void 0:o.queryModification.queryToIgnore)===r)return this.dispatch(ao("")),null;this.analyticsAction&&await this.dispatch(this.analyticsAction);let n=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(r);return Ee(i.response)?(this.dispatch(ze(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(Fe(Te(this.getState()))),{...i,response:{...i.response.success},automaticallyCorrected:!1,originalQuery:n,analyticsAction:Vf()})}getStateAfterResponse(e,t,r,n){var i;return{...r,query:{q:e,enableQuerySyntax:((i=r.query)==null?void 0:i.enableQuerySyntax)??tt().enableQuerySyntax},search:{...Ge(),duration:t,response:n,results:n.results}}}processSuccessResponse(e){return this.dispatch(Fe(Te(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(e){return li(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let t=await this.fetchFromAPI(await Se(this.getState()),{origin:"mainSearch"});return this.dispatch(io(e)),t}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(oo({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await Se(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){var t;let e=this.getState();return((t=e.query)==null?void 0:t.q)!==void 0?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get analyticsAction(){return this.config.analyticsAction}get rejectWithValue(){return this.config.rejectWithValue}};ne("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;E(e,{q:new U,enableQuerySyntax:new K,clearFilters:new K}),e.clearFilters&&(r(Zr()),r(Ua())),r(Wa({allow:!0})),r(Yt({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(Ht(1))});ne("search/executeSearch",async(e,t)=>{let r=t.getState();return await sn(r,t,e)});ne("search/fetchPage",async(e,t)=>{let r=t.getState();return await co(r,t,e)});ne("search/fetchMoreResults",async(e,t)=>{let r=t.getState();return await lo(t,r)});ne("search/fetchFacetValues",async(e,t)=>{let r=t.getState();return await Yf(t,e,r)});ne("search/fetchInstantResults",async(e,t)=>uo(e,t));var zf=async(e,t)=>{var n,i;let r=await Se(e,t);return r.request={...r.request,firstResult:(((n=e.pagination)==null?void 0:n.firstResult)??0)+(((i=e.search)==null?void 0:i.results.length)??0)},r},Nf=async(e,t,r)=>{let n=await Jr(e);return an({...n,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},Hf=async(e,t)=>{let r=await Se(e,t);return r.request.numberOfResults=0,r},so=e=>{var t;e.configuration.analytics.enabled&&et.addElement({name:"Query",...((t=e.query)==null?void 0:t.q)&&{value:e.query.q},time:JSON.stringify(new Date)})};async function uo(e,t){E(e,{id:T,q:T,maxResultsPerQuery:new Y({required:!0,min:1}),cacheTimeout:new Y});let{q:r,maxResultsPerQuery:n}=e,i=t.getState(),a=new mt({...t,analyticsAction:vf()},c=>{t.dispatch(Ga({q:c,id:e.id}))}),o=await Nf(i,r,n),s=await a.fetchFromAPI(o,{origin:"instantResults",disableAbortWarning:!0}),u=await a.process(s);return"response"in u?{results:u.response.results,searchUid:u.response.searchUid,analyticsAction:u.analyticsAction,totalCountFiltered:u.response.totalCountFiltered,duration:u.duration}:u}async function co(e,t,r){so(e);let{analyticsClientMiddleware:n,preprocessRequest:i,logger:a}=t.extra,{description:o}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:i,logger:a}),s=new mt({...t,analyticsAction:r}),u=await Se(e,o),c=await s.fetchFromAPI(u,{origin:"mainSearch"});return await s.process(c)}async function lo(e,t){let{analyticsClientMiddleware:r,preprocessRequest:n,logger:i}=e.extra,{description:a}=await Gn().prepare({getState:()=>e.getState(),analyticsClientMiddleware:r,preprocessRequest:n,logger:i}),o=new mt({...e,analyticsAction:Gn()}),s=await zf(t,a),u=await o.fetchFromAPI(s,{origin:"mainSearch"});return await o.process(u)}async function Yf(e,t,r){let{analyticsClientMiddleware:n,preprocessRequest:i,logger:a}=e.extra,{description:o}=await t.prepare({getState:()=>e.getState(),analyticsClientMiddleware:n,preprocessRequest:i,logger:a}),s=new mt({...e,analyticsAction:t}),u=await Hf(r,o),c=await s.fetchFromAPI(u,{origin:"facetValues"});return await s.process(c)}async function sn(e,t,r){so(e);let{analyticsClientMiddleware:n,preprocessRequest:i,logger:a}=t.extra,{description:o}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:i,logger:a}),s=await Se(e,o),u=new mt({...t,analyticsAction:r}),c=await u.fetchFromAPI(s,{origin:"mainSearch"});return await u.process(c)}var yt=class{constructor(e,t=r=>{this.dispatch(Yt({q:r}))}){this.config=e,this.onUpdateQueryForCorrection=t}async fetchFromAPI({mappings:e,request:t},r){var s;let n=new Date().getTime(),i=no(await this.extra.apiClient.search(t,r),e),a=new Date().getTime()-n,o=((s=this.getState().query)==null?void 0:s.q)||"";return{response:i,duration:a,queryExecuted:o,requestExecuted:t}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return Ee(e.response)?(this.dispatch(ze(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:i}=t.didYouMean,{results:a,queryCorrections:o,queryCorrection:s}=r;if(!n||!i)return null;let u=a.length===0&&o&&o.length!==0,c=!H(s)&&!H(s.correctedQuery);if(!u&&!c)return null;let d=u?await this.processLegacyDidYouMeanAutoCorrection(e):this.processModernDidYouMeanAutoCorrection(e);return this.dispatch(Fe(Te(this.getState()))),d}async processLegacyDidYouMeanAutoCorrection(e){let t=this.getCurrentQuery(),r=this.getSuccessResponse(e);if(!r.queryCorrections)return null;let{correctedQuery:n}=r.queryCorrections[0],i=await this.automaticallyRetryQueryWithCorrection(n);return Ee(i.response)?(this.dispatch(ze(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(Fe(Te(this.getState()))),{...i,response:{...i.response.success,queryCorrections:r.queryCorrections},automaticallyCorrected:!0,originalQuery:t})}processModernDidYouMeanAutoCorrection(e){let t=this.getSuccessResponse(e),{correctedQuery:r,originalQuery:n}=t.queryCorrection;return this.onUpdateQueryForCorrection(r),{...e,response:{...t},queryExecuted:r,automaticallyCorrected:!0,originalQuery:n}}async processQueryTriggersOrContinue(e){var a,o;let t=this.getSuccessResponse(e);if(!t)return null;let r=((a=t.triggers.find(s=>s.type==="query"))==null?void 0:a.content)||"";if(!r)return null;if(((o=this.getState().triggers)==null?void 0:o.queryModification.queryToIgnore)===r)return this.dispatch(ao("")),null;let n=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(r);return Ee(i.response)?(this.dispatch(ze(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(Fe(Te(this.getState()))),{...i,response:{...i.response.success},automaticallyCorrected:!1,originalQuery:n})}processSuccessResponse(e){return this.dispatch(Fe(Te(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery()}}getSuccessResponse(e){return li(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let t=this.getState(),{actionCause:r}=_f(),n=await this.fetchFromAPI(await Se(t,{actionCause:r}),{origin:"mainSearch"});return this.dispatch(io(e)),n}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(oo({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await Se(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){var t;let e=this.getState();return((t=e.query)==null?void 0:t.q)!==void 0?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}};ne("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;E(e,{q:new U,enableQuerySyntax:new K,clearFilters:new K}),e.clearFilters&&(r(Zr()),r(Ua())),r(Wa({allow:!0})),r(Yt({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(Ht(1))});var Bf=ne("search/executeSearch",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return sn(r,t,e.legacy);ho(r);let n=un(e.next),i=await Se(r,n),a=new yt({...t,analyticsAction:n}),o=await a.fetchFromAPI(i,{origin:"mainSearch"});return await a.process(o)});ne("search/fetchPage",async(e,t)=>{let r=t.getState();if(ho(r),r.configuration.analytics.analyticsMode==="legacy"||!e.next)return co(r,t,e.legacy);let n=new yt({...t,analyticsAction:e.next}),i=await Se(r,e.next),a=await n.fetchFromAPI(i,{origin:"mainSearch"});return await n.process(a)});ne("search/fetchMoreResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return lo(t,r);let n=Zl("pagerScrolling",t.getState),i=new yt({...t,analyticsAction:n}),a=await Wf(r,n),o=await i.fetchFromAPI(a,{origin:"mainSearch"});return await i.process(o)});ne("search/fetchFacetValues",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return sn(r,t,e.legacy);let n=un(e.next),i=new yt({...t,analyticsAction:n}),a=await Jf(r,n),o=await i.fetchFromAPI(a,{origin:"facetValues"});return await i.process(o)});ne("search/fetchInstantResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return uo(e,t);E(e,{id:T,q:T,maxResultsPerQuery:new Y({required:!0,min:1}),cacheTimeout:new Y});let{q:n,maxResultsPerQuery:i}=e,a=un(wf()),o=await Gf(r,n,i,a),s=new yt({...t,analyticsAction:a},d=>{t.dispatch(Ga({q:d,id:e.id}))}),u=await s.fetchFromAPI(o,{origin:"instantResults",disableAbortWarning:!0}),c=await s.process(u);return"response"in c?{results:c.response.results,searchUid:c.response.searchUid,totalCountFiltered:c.response.totalCountFiltered,duration:c.duration}:c});var Wf=async(e,t)=>{var n,i;let r=await Se(e,t);return r.request={...r.request,firstResult:(((n=e.pagination)==null?void 0:n.firstResult)??0)+(((i=e.search)==null?void 0:i.results.length)??0)},r},Gf=async(e,t,r,n)=>{let i=await Kr(e,n);return an({...i,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},Jf=async(e,t)=>{let r=await Se(e,t);return r.request.numberOfResults=0,r},ho=e=>{var t;e.configuration.analytics.enabled&&et.addElement({name:"Query",...((t=e.query)==null?void 0:t.q)&&{value:e.query.q},time:JSON.stringify(new Date)})},un=e=>({actionCause:e.actionCause,type:e.actionCause}),Kf=Ie(on(),e=>{e.addCase(Ja,(t,r)=>{let n=sr(t),i=r.payload;t.defaultNumberOfResults=t.numberOfResults=i,t.firstResult=it(n,i)}).addCase(Ka,(t,r)=>{t.numberOfResults=r.payload,t.firstResult=0}).addCase(Sa,t=>{t.firstResult=0}).addCase(Za,(t,r)=>{let n=r.payload;t.firstResult=it(n,t.numberOfResults)}).addCase(Ht,(t,r)=>{let n=r.payload;t.firstResult=it(n,t.numberOfResults)}).addCase(eo,t=>{let r=sr(t),n=Math.max(r-1,1);t.firstResult=it(n,t.numberOfResults)}).addCase(Xa,t=>{let r=sr(t),n=Zf(t),i=Math.min(r+1,n);t.firstResult=it(i,t.numberOfResults)}).addCase(Pe.fulfilled,(t,r)=>{r.payload&&(t.numberOfResults=r.payload.pagination.numberOfResults,t.firstResult=r.payload.pagination.firstResult)}).addCase(Qt,(t,r)=>{t.firstResult=r.payload.firstResult??t.firstResult,t.numberOfResults=r.payload.numberOfResults??t.defaultNumberOfResults}).addCase(Bf.fulfilled,(t,r)=>{let{response:n}=r.payload;t.totalCountFiltered=n.totalCountFiltered}).addCase(hf.fulfilled,(t,r)=>{let{response:n}=r.payload;t.totalCountFiltered=n.pagination.totalCount}).addCase(Zh,t=>{he(t)}).addCase(rf,t=>{he(t)}).addCase(Kh,t=>{he(t)}).addCase(uf,t=>{he(t)}).addCase(Mh,t=>{he(t)}).addCase(Jh,t=>{he(t)}).addCase(Rh,t=>{he(t)}).addCase(Dh,t=>{he(t)}).addCase(Uh,t=>{he(t)}).addCase(tf,t=>{he(t)}).addCase(sf,t=>{he(t)}).addCase(Zr,t=>{he(t)}).addCase(nf,t=>{he(t)}).addCase(cf,t=>{he(t)}).addCase(Fh,t=>{he(t)}).addCase(Ah,t=>{he(t)})});function he(e){e.firstResult=on().firstResult}function sr(e){let{firstResult:t,numberOfResults:r}=e;return Xf(t,r)}function Zf(e){let{totalCountFiltered:t,numberOfResults:r}=e;return ep(t,r)}function it(e,t){return(e-1)*t}function Xf(e,t){return Math.round(e/t)+1}function ep(e,t){let r=Math.min(e,5e3);return Math.ceil(r/t)}function tp(e){return e.addReducers({pagination:Kf}),{nextPage:Xa,previousPage:eo,registerNumberOfResults:Ja,registerPage:Za,updateNumberOfResults:Ka,updatePage:Ht}}function rp(e){let t,r=new Map,n=()=>r.size===0,i=a=>{try{let o=JSON.stringify(a),s=t!==o;return t=o,s}catch(o){return console.warn('Could not detect if state has changed, check the controller "get state method"',o),!0}};return{subscribe(a){a();let o=Symbol(),s;return n()&&(t=JSON.stringify(this.state),s=e.subscribe(()=>{i(this.state)&&r.forEach(u=>u())})),r.set(o,a),()=>{r.delete(o),n()&&s&&s()}},get state(){return{}}}}var np=new Ze({id:new U({emptyAllowed:!0,required:!1,default:""}),numberOfRecommendations:new Y({min:0})});function fp(e,t={}){ip(e);let r=rp(e),{dispatch:n}=e,i=()=>e.state,a=Du(e,np,t.options,"buildRecommendationList");return a.id!==""&&n(Br({id:a.id})),a.numberOfRecommendations&&n(tp(e).updateNumberOfResults(a.numberOfRecommendations)),{...r,refresh(){n(st())},get state(){let o=i();return{recommendations:o.recommendation.recommendations,error:o.recommendation.error,isLoading:o.recommendation.isLoading,searchResponseId:o.recommendation.searchUid}}}}function ip(e){return e.addReducers({recommendation:Wr,configuration:gt}),!0}function ap(e,t,r){op(e);let n=1e3,i={selectionDelay:n,debounceWait:n,...t.options},a;return{select:Ca(r,i.debounceWait,{isImmediate:!0}),beginDelayedSelect(){a=setTimeout(r,i.selectionDelay)},cancelPendingSelect(){a&&clearTimeout(a)}}}function op(e){return e.addReducers({configuration:gt}),!0}function pp(e,t){let r=!1,n=()=>{r||(r=!0,e.dispatch(yd(t.options.result)))};return ap(e,t,()=>{n()})}new Ze({values:new Q({options:{required:!1}})});Vo();export{up as C,sp as O,ds as U,pp as a,lp as b,dp as i,cp as j,hp as o,fp as t};
