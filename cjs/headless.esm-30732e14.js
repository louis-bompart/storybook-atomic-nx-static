'use strict';

/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var bl=Object.create;var jr=Object.defineProperty;var xl=Object.getOwnPropertyDescriptor;var wl=Object.getOwnPropertyNames;var Pl=Object.getPrototypeOf,El=Object.prototype.hasOwnProperty;var Fl=(e,t,r)=>t in e?jr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Il=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var K=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),kl=(e,t)=>{for(var r in t)jr(e,r,{get:t[r],enumerable:!0});},Ol=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of wl(t))!El.call(e,o)&&o!==r&&jr(e,o,{get:()=>t[o],enumerable:!(n=xl(t,o))||n.enumerable});return e};var Ae=(e,t,r)=>(r=e!=null?bl(Pl(e)):{},Ol(t||!e||!e.__esModule?jr(r,"default",{value:e,enumerable:!0}):r,e));var Br=(e,t,r)=>Fl(e,typeof t!="symbol"?t+"":t,r);var ma=K((cy,pa)=>{function Vl(e){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");if(e=`${e}`,e=e.replace(/[ \t\n\f\r]/g,""),e.length%4===0&&(e=e.replace(/==?$/,"")),e.length%4===1||/[^+/0-9A-Za-z]/.test(e))return null;let t="",r=0,n=0;for(let o=0;o<e.length;o++)r<<=6,r|=Ll(e[o]),n+=6,n===24&&(t+=String.fromCharCode((r&16711680)>>16),t+=String.fromCharCode((r&65280)>>8),t+=String.fromCharCode(r&255),r=n=0);return n===12?(r>>=4,t+=String.fromCharCode(r)):n===18&&(r>>=2,t+=String.fromCharCode((r&65280)>>8),t+=String.fromCharCode(r&255)),t}var _l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Ll(e){let t=_l.indexOf(e);return t<0?void 0:t}pa.exports=Vl;});var ga=K((uy,fa)=>{function Ul(e){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");let t;for(e=`${e}`,t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return null;let r="";for(t=0;t<e.length;t+=3){let n=[void 0,void 0,void 0,void 0];n[0]=e.charCodeAt(t)>>2,n[1]=(e.charCodeAt(t)&3)<<4,e.length>t+1&&(n[1]|=e.charCodeAt(t+1)>>4,n[2]=(e.charCodeAt(t+1)&15)<<2),e.length>t+2&&(n[2]|=e.charCodeAt(t+2)>>6,n[3]=e.charCodeAt(t+2)&63);for(let o=0;o<n.length;o++)typeof n[o]>"u"?r+="=":r+=Bl(n[o]);}return r}var jl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Bl(e){if(e>=0&&e<64)return jl[e]}fa.exports=Ul;});var ya=K((ly,ha)=>{var $l=ma(),Ql=ga();ha.exports={atob:$l,btoa:Ql};});var ba=K((yy,Ra)=>{Ra.exports=fetch;});var xa=K(mr=>{var Yr=mr&&mr.__assign||function(){return Yr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);}return e},Yr.apply(this,arguments)};Object.defineProperty(mr,"__esModule",{value:!0});var ed={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return !0},startingDelay:100,timeMultiple:2};function td(e){var t=Yr(Yr({},ed),e);return t.numOfAttempts<1&&(t.numOfAttempts=1),t}mr.getSanitizedOptions=td;});var wa=K(Oo=>{Object.defineProperty(Oo,"__esModule",{value:!0});function rd(e){var t=Math.random()*e;return Math.round(t)}Oo.fullJitter=rd;});var Pa=K(To=>{Object.defineProperty(To,"__esModule",{value:!0});function nd(e){return e}To.noJitter=nd;});var Ea=K(Do=>{Object.defineProperty(Do,"__esModule",{value:!0});var od=wa(),id=Pa();function ad(e){switch(e.jitter){case"full":return od.fullJitter;case"none":default:return id.noJitter}}Do.JitterFactory=ad;});var No=K(qo=>{Object.defineProperty(qo,"__esModule",{value:!0});var sd=Ea(),cd=function(){function e(t){this.options=t,this.attempt=0;}return e.prototype.apply=function(){var t=this;return new Promise(function(r){return setTimeout(r,t.jitteredDelay)})},e.prototype.setAttemptNumber=function(t){this.attempt=t;},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){var t=sd.JitterFactory(this.options);return t(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var t=this.options.startingDelay,r=this.options.timeMultiple,n=this.numOfDelayedAttempts,o=t*Math.pow(r,n);return Math.min(o,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}();qo.Delay=cd;});var Fa=K(He=>{var ud=He&&He.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o;}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i]);},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t;}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n);}}(),ld=He&&He.__awaiter||function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i);})}return new(r||(r=Promise))(function(i,a){function s(l){try{c(n.next(l));}catch(p){a(p);}}function u(l){try{c(n.throw(l));}catch(p){a(p);}}function c(l){l.done?i(l.value):o(l.value).then(s,u);}c((n=n.apply(e,t||[])).next());})},dd=He&&He.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(l){return u([c,l])}}function u(c){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=c[0]&2?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,o=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(c[0]===6&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r);}catch(l){c=[6,l],o=0;}finally{n=i=0;}if(c[0]&5)throw c[1];return {value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(He,"__esModule",{value:!0});var pd=No(),md=function(e){ud(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.apply=function(){return ld(this,void 0,void 0,function(){return dd(this,function(r){return [2,this.isFirstAttempt?!0:e.prototype.apply.call(this)]})})},Object.defineProperty(t.prototype,"isFirstAttempt",{get:function(){return this.attempt===0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),t}(pd.Delay);He.SkipFirstDelay=md;});var Ia=K(fr=>{var fd=fr&&fr.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o;}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i]);},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t;}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n);}}();Object.defineProperty(fr,"__esModule",{value:!0});var gd=No(),hd=function(e){fd(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(gd.Delay);fr.AlwaysDelay=hd;});var ka=K(Mo=>{Object.defineProperty(Mo,"__esModule",{value:!0});var yd=Fa(),Sd=Ia();function vd(e,t){var r=Cd(e);return r.setAttemptNumber(t),r}Mo.DelayFactory=vd;function Cd(e){return e.delayFirstAttempt?new Sd.AlwaysDelay(e):new yd.SkipFirstDelay(e)}});var Oa=K(vt=>{var Vo=vt&&vt.__awaiter||function(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i);})}return new(r||(r=Promise))(function(i,a){function s(l){try{c(n.next(l));}catch(p){a(p);}}function u(l){try{c(n.throw(l));}catch(p){a(p);}}function c(l){l.done?i(l.value):o(l.value).then(s,u);}c((n=n.apply(e,t||[])).next());})},_o=vt&&vt.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(l){return u([c,l])}}function u(c){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=c[0]&2?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,o=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(c[0]===6&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r);}catch(l){c=[6,l],o=0;}finally{n=i=0;}if(c[0]&5)throw c[1];return {value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(vt,"__esModule",{value:!0});var Ad=xa(),Rd=ka();function bd(e,t){return t===void 0&&(t={}),Vo(this,void 0,void 0,function(){var r,n;return _o(this,function(o){switch(o.label){case 0:return r=Ad.getSanitizedOptions(t),n=new xd(e,r),[4,n.execute()];case 1:return [2,o.sent()]}})})}vt.backOff=bd;var xd=function(){function e(t,r){this.request=t,this.options=r,this.attemptNumber=0;}return e.prototype.execute=function(){return Vo(this,void 0,void 0,function(){var t,r;return _o(this,function(n){switch(n.label){case 0:if(this.attemptLimitReached)return [3,7];n.label=1;case 1:return n.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return n.sent(),[4,this.request()];case 3:return [2,n.sent()];case 4:return t=n.sent(),this.attemptNumber++,[4,this.options.retry(t,this.attemptNumber)];case 5:if(r=n.sent(),!r||this.attemptLimitReached)throw t;return [3,6];case 6:return [3,0];case 7:throw new Error("Something went wrong.")}})})},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return Vo(this,void 0,void 0,function(){var t;return _o(this,function(r){switch(r.label){case 0:return t=Rd.DelayFactory(this.options,this.attemptNumber),[4,t.apply()];case 1:return r.sent(),[2]}})})},e}();});var Ua=K((Dy,La)=>{var Uo=typeof self<"u"?self:typeof window<"u"?window:void 0;if(!Uo)throw new Error("Unable to find global scope. Are you sure this is running in the browser?");if(!Uo.AbortController)throw new Error('Could not find "AbortController" in the global scope. You need to polyfill it first');La.exports.AbortController=Uo.AbortController;});var Oc=K((OR,kc)=>{var Qf=/(^|; )Coveo-Pendragon=([^;]*)/;kc.exports=()=>Qf.exec(document.cookie)?.pop()||null;});var jn=K((ki,Oi)=>{(function(e,t){typeof ki=="object"&&typeof Oi<"u"?Oi.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs=t();})(ki,function(){var e=1e3,t=6e4,r=36e5,n="millisecond",o="second",i="minute",a="hour",s="day",u="week",c="month",l="quarter",p="year",h="date",d="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,C={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(O){var x=["th","st","nd","rd"],R=O%100;return "["+O+(x[(R-20)%10]||x[R]||x[0])+"]"}},P=function(O,x,R){var E=String(O);return !E||E.length>=x?O:""+Array(x+1-E.length).join(R)+O},k={s:P,z:function(O){var x=-O.utcOffset(),R=Math.abs(x),E=Math.floor(R/60),b=R%60;return (x<=0?"+":"-")+P(E,2,"0")+":"+P(b,2,"0")},m:function O(x,R){if(x.date()<R.date())return -O(R,x);var E=12*(R.year()-x.year())+(R.month()-x.month()),b=x.clone().add(E,c),T=R-b<0,q=x.clone().add(E+(T?-1:1),c);return +(-(E+(R-b)/(T?b-q:q-b))||0)},a:function(O){return O<0?Math.ceil(O)||0:Math.floor(O)},p:function(O){return {M:c,y:p,w:u,d:s,D:h,h:a,m:i,s:o,ms:n,Q:l}[O]||String(O||"").toLowerCase().replace(/s$/,"")},u:function(O){return O===void 0}},L="en",V={};V[L]=C;var $="$isDayjsObject",U=function(O){return O instanceof ne||!(!O||!O[$])},H=function O(x,R,E){var b;if(!x)return L;if(typeof x=="string"){var T=x.toLowerCase();V[T]&&(b=T),R&&(V[T]=R,b=T);var q=x.split("-");if(!b&&q.length>1)return O(q[0])}else {var Q=x.name;V[Q]=x,b=Q;}return !E&&b&&(L=b),b||!E&&L},j=function(O,x){if(U(O))return O.clone();var R=typeof x=="object"?x:{};return R.date=O,R.args=arguments,new ne(R)},N=k;N.l=H,N.i=U,N.w=function(O,x){return j(O,{locale:x.$L,utc:x.$u,x:x.$x,$offset:x.$offset})};var ne=function(){function O(R){this.$L=H(R.locale,null,!0),this.parse(R),this.$x=this.$x||R.x||{},this[$]=!0;}var x=O.prototype;return x.parse=function(R){this.$d=function(E){var b=E.date,T=E.utc;if(b===null)return new Date(NaN);if(N.u(b))return new Date;if(b instanceof Date)return new Date(b);if(typeof b=="string"&&!/Z$/i.test(b)){var q=b.match(y);if(q){var Q=q[2]-1||0,G=(q[7]||"0").substring(0,3);return T?new Date(Date.UTC(q[1],Q,q[3]||1,q[4]||0,q[5]||0,q[6]||0,G)):new Date(q[1],Q,q[3]||1,q[4]||0,q[5]||0,q[6]||0,G)}}return new Date(b)}(R),this.init();},x.init=function(){var R=this.$d;this.$y=R.getFullYear(),this.$M=R.getMonth(),this.$D=R.getDate(),this.$W=R.getDay(),this.$H=R.getHours(),this.$m=R.getMinutes(),this.$s=R.getSeconds(),this.$ms=R.getMilliseconds();},x.$utils=function(){return N},x.isValid=function(){return this.$d.toString()!==d},x.isSame=function(R,E){var b=j(R);return this.startOf(E)<=b&&b<=this.endOf(E)},x.isAfter=function(R,E){return j(R)<this.startOf(E)},x.isBefore=function(R,E){return this.endOf(E)<j(R)},x.$g=function(R,E,b){return N.u(R)?this[E]:this.set(b,R)},x.unix=function(){return Math.floor(this.valueOf()/1e3)},x.valueOf=function(){return this.$d.getTime()},x.startOf=function(R,E){var b=this,T=!!N.u(E)||E,q=N.p(R),Q=function(Pe,re){var ge=N.w(b.$u?Date.UTC(b.$y,re,Pe):new Date(b.$y,re,Pe),b);return T?ge:ge.endOf(s)},G=function(Pe,re){return N.w(b.toDate()[Pe].apply(b.toDate("s"),(T?[0,0,0,0]:[23,59,59,999]).slice(re)),b)},Z=this.$W,te=this.$M,de=this.$D,tt="set"+(this.$u?"UTC":"");switch(q){case p:return T?Q(1,0):Q(31,11);case c:return T?Q(1,te):Q(0,te+1);case u:var Oe=this.$locale().weekStart||0,Be=(Z<Oe?Z+7:Z)-Oe;return Q(T?de-Be:de+(6-Be),te);case s:case h:return G(tt+"Hours",0);case a:return G(tt+"Minutes",1);case i:return G(tt+"Seconds",2);case o:return G(tt+"Milliseconds",3);default:return this.clone()}},x.endOf=function(R){return this.startOf(R,!1)},x.$set=function(R,E){var b,T=N.p(R),q="set"+(this.$u?"UTC":""),Q=(b={},b[s]=q+"Date",b[h]=q+"Date",b[c]=q+"Month",b[p]=q+"FullYear",b[a]=q+"Hours",b[i]=q+"Minutes",b[o]=q+"Seconds",b[n]=q+"Milliseconds",b)[T],G=T===s?this.$D+(E-this.$W):E;if(T===c||T===p){var Z=this.clone().set(h,1);Z.$d[Q](G),Z.init(),this.$d=Z.set(h,Math.min(this.$D,Z.daysInMonth())).$d;}else Q&&this.$d[Q](G);return this.init(),this},x.set=function(R,E){return this.clone().$set(R,E)},x.get=function(R){return this[N.p(R)]()},x.add=function(R,E){var b,T=this;R=Number(R);var q=N.p(E),Q=function(te){var de=j(T);return N.w(de.date(de.date()+Math.round(te*R)),T)};if(q===c)return this.set(c,this.$M+R);if(q===p)return this.set(p,this.$y+R);if(q===s)return Q(1);if(q===u)return Q(7);var G=(b={},b[i]=t,b[a]=r,b[o]=e,b)[q]||1,Z=this.$d.getTime()+R*G;return N.w(Z,this)},x.subtract=function(R,E){return this.add(-1*R,E)},x.format=function(R){var E=this,b=this.$locale();if(!this.isValid())return b.invalidDate||d;var T=R||"YYYY-MM-DDTHH:mm:ssZ",q=N.z(this),Q=this.$H,G=this.$m,Z=this.$M,te=b.weekdays,de=b.months,tt=b.meridiem,Oe=function(re,ge,$e,rt){return re&&(re[ge]||re(E,T))||$e[ge].slice(0,rt)},Be=function(re){return N.s(Q%12||12,re,"0")},Pe=tt||function(re,ge,$e){var rt=re<12?"AM":"PM";return $e?rt.toLowerCase():rt};return T.replace(v,function(re,ge){return ge||function($e){switch($e){case"YY":return String(E.$y).slice(-2);case"YYYY":return N.s(E.$y,4,"0");case"M":return Z+1;case"MM":return N.s(Z+1,2,"0");case"MMM":return Oe(b.monthsShort,Z,de,3);case"MMMM":return Oe(de,Z);case"D":return E.$D;case"DD":return N.s(E.$D,2,"0");case"d":return String(E.$W);case"dd":return Oe(b.weekdaysMin,E.$W,te,2);case"ddd":return Oe(b.weekdaysShort,E.$W,te,3);case"dddd":return te[E.$W];case"H":return String(Q);case"HH":return N.s(Q,2,"0");case"h":return Be(1);case"hh":return Be(2);case"a":return Pe(Q,G,!0);case"A":return Pe(Q,G,!1);case"m":return String(G);case"mm":return N.s(G,2,"0");case"s":return String(E.$s);case"ss":return N.s(E.$s,2,"0");case"SSS":return N.s(E.$ms,3,"0");case"Z":return q}return null}(re)||q.replace(":","")})},x.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},x.diff=function(R,E,b){var T,q=this,Q=N.p(E),G=j(R),Z=(G.utcOffset()-this.utcOffset())*t,te=this-G,de=function(){return N.m(q,G)};switch(Q){case p:T=de()/12;break;case c:T=de();break;case l:T=de()/3;break;case u:T=(te-Z)/6048e5;break;case s:T=(te-Z)/864e5;break;case a:T=te/r;break;case i:T=te/t;break;case o:T=te/e;break;default:T=te;}return b?T:N.a(T)},x.daysInMonth=function(){return this.endOf(c).$D},x.$locale=function(){return V[this.$L]},x.locale=function(R,E){if(!R)return this.$L;var b=this.clone(),T=H(R,E,!0);return T&&(b.$L=T),b},x.clone=function(){return N.w(this.$d,this)},x.toDate=function(){return new Date(this.valueOf())},x.toJSON=function(){return this.isValid()?this.toISOString():null},x.toISOString=function(){return this.$d.toISOString()},x.toString=function(){return this.$d.toUTCString()},O}(),we=ne.prototype;return j.prototype=we,[["$ms",n],["$s",o],["$m",i],["$H",a],["$W",s],["$M",c],["$y",p],["$D",h]].forEach(function(O){we[O[1]]=function(x){return this.$g(x,O[0],O[1])};}),j.extend=function(O,x){return O.$i||(O(x,ne,j),O.$i=!0),j},j.locale=H,j.isDayjs=U,j.unix=function(O){return j(1e3*O)},j.en=V[L],j.Ls=V,j.p={},j});});var Tc=K((Ti,Di)=>{(function(e,t){typeof Ti=="object"&&typeof Di<"u"?Di.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_timezone=t();})(Ti,function(){var e={year:0,month:1,day:2,hour:3,minute:4,second:5},t={};return function(r,n,o){var i,a=function(l,p,h){h===void 0&&(h={});var d=new Date(l),y=function(v,C){C===void 0&&(C={});var P=C.timeZoneName||"short",k=v+"|"+P,L=t[k];return L||(L=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:v,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:P}),t[k]=L),L}(p,h);return y.formatToParts(d)},s=function(l,p){for(var h=a(l,p),d=[],y=0;y<h.length;y+=1){var v=h[y],C=v.type,P=v.value,k=e[C];k>=0&&(d[k]=parseInt(P,10));}var L=d[3],V=L===24?0:L,$=d[0]+"-"+d[1]+"-"+d[2]+" "+V+":"+d[4]+":"+d[5]+":000",U=+l;return (o.utc($).valueOf()-(U-=U%1e3))/6e4},u=n.prototype;u.tz=function(l,p){l===void 0&&(l=i);var h=this.utcOffset(),d=this.toDate(),y=d.toLocaleString("en-US",{timeZone:l}),v=Math.round((d-new Date(y))/1e3/60),C=o(y,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(d.getTimezoneOffset()/15)-v,!0);if(p){var P=C.utcOffset();C=C.add(h-P,"minute");}return C.$x.$timezone=l,C},u.offsetName=function(l){var p=this.$x.$timezone||o.tz.guess(),h=a(this.valueOf(),p,{timeZoneName:l}).find(function(d){return d.type.toLowerCase()==="timezonename"});return h&&h.value};var c=u.startOf;u.startOf=function(l,p){if(!this.$x||!this.$x.$timezone)return c.call(this,l,p);var h=o(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return c.call(h,l,p).tz(this.$x.$timezone,!0)},o.tz=function(l,p,h){var d=h&&p,y=h||p||i,v=s(+o(),y);if(typeof l!="string")return o(l).tz(y);var C=function(V,$,U){var H=V-60*$*1e3,j=s(H,U);if($===j)return [H,$];var N=s(H-=60*(j-$)*1e3,U);return j===N?[H,j]:[V-60*Math.min(j,N)*1e3,Math.max(j,N)]}(o.utc(l,d).valueOf(),v,y),P=C[0],k=C[1],L=o(P).utcOffset(k);return L.$x.$timezone=y,L},o.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},o.tz.setDefault=function(l){i=l;};}});});var Dc=K((qi,Ni)=>{(function(e,t){typeof qi=="object"&&typeof Ni<"u"?Ni.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_utc=t();})(qi,function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(n,o,i){var a=o.prototype;i.utc=function(d){var y={date:d,utc:!0,args:arguments};return new o(y)},a.utc=function(d){var y=i(this.toDate(),{locale:this.$L,utc:!0});return d?y.add(this.utcOffset(),e):y},a.local=function(){return i(this.toDate(),{locale:this.$L,utc:!1})};var s=a.parse;a.parse=function(d){d.utc&&(this.$u=!0),this.$utils().u(d.$offset)||(this.$offset=d.$offset),s.call(this,d);};var u=a.init;a.init=function(){if(this.$u){var d=this.$d;this.$y=d.getUTCFullYear(),this.$M=d.getUTCMonth(),this.$D=d.getUTCDate(),this.$W=d.getUTCDay(),this.$H=d.getUTCHours(),this.$m=d.getUTCMinutes(),this.$s=d.getUTCSeconds(),this.$ms=d.getUTCMilliseconds();}else u.call(this);};var c=a.utcOffset;a.utcOffset=function(d,y){var v=this.$utils().u;if(v(d))return this.$u?0:v(this.$offset)?c.call(this):this.$offset;if(typeof d=="string"&&(d=function(L){L===void 0&&(L="");var V=L.match(t);if(!V)return null;var $=(""+V[0]).match(r)||["-",0,0],U=$[0],H=60*+$[1]+ +$[2];return H===0?0:U==="+"?H:-H}(d),d===null))return this;var C=Math.abs(d)<=16?60*d:d,P=this;if(y)return P.$offset=C,P.$u=d===0,P;if(d!==0){var k=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(P=this.local().add(C+k,e)).$offset=C,P.$x.$localOffset=k;}else P=this.utc();return P};var l=a.format;a.format=function(d){var y=d||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,y)},a.valueOf=function(){var d=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*d},a.isUTC=function(){return !!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var p=a.toDate;a.toDate=function(d){return d==="s"&&this.$offset?i(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():p.call(this)};var h=a.diff;a.diff=function(d,y,v){if(d&&this.$u===d.$u)return h.call(this,d,y,v);var C=this.local(),P=i(d).local();return h.call(C,P,y,v)};}});});var Gc=K((Ub,Yc)=>{function ng(e){try{return JSON.stringify(e)}catch{return '"[Circular]"'}}Yc.exports=og;function og(e,t,r){var n=r&&r.stringify||ng,o=1;if(typeof e=="object"&&e!==null){var i=t.length+o;if(i===1)return e;var a=new Array(i);a[0]=n(e);for(var s=1;s<i;s++)a[s]=n(t[s]);return a.join(" ")}if(typeof e!="string")return e;var u=t.length;if(u===0)return e;for(var c="",l=1-o,p=-1,h=e&&e.length||0,d=0;d<h;){if(e.charCodeAt(d)===37&&d+1<h){switch(p=p>-1?p:0,e.charCodeAt(d+1)){case 100:case 102:if(l>=u||t[l]==null)break;p<d&&(c+=e.slice(p,d)),c+=Number(t[l]),p=d+2,d++;break;case 105:if(l>=u||t[l]==null)break;p<d&&(c+=e.slice(p,d)),c+=Math.floor(Number(t[l])),p=d+2,d++;break;case 79:case 111:case 106:if(l>=u||t[l]===void 0)break;p<d&&(c+=e.slice(p,d));var y=typeof t[l];if(y==="string"){c+="'"+t[l]+"'",p=d+2,d++;break}if(y==="function"){c+=t[l].name||"<anonymous>",p=d+2,d++;break}c+=n(t[l]),p=d+2,d++;break;case 115:if(l>=u)break;p<d&&(c+=e.slice(p,d)),c+=String(t[l]),p=d+2,d++;break;case 37:p<d&&(c+=e.slice(p,d)),c+="%",p=d+2,d++,l--;break}++l;}++d;}return p===-1?e:(p<h&&(c+=e.slice(p)),c)}});var tu=K((jb,Wn)=>{var Kc=Gc();Wn.exports=Ze;var Tr=vg().console||{},ig={mapHttpRequest:Qn,mapHttpResponse:Qn,wrapRequestSerializer:Li,wrapResponseSerializer:Li,wrapErrorSerializer:Li,req:Qn,res:Qn,err:Xc,errWithCause:Xc};function zn(e,t){return e==="silent"?1/0:t.levels.values[e]}var Bi=Symbol("pino.logFuncs"),Ui=Symbol("pino.hierarchy"),ag={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function Jc(e,t){let r={logger:t,parent:e[Ui]};t[Ui]=r;}function sg(e,t,r){let n={};t.forEach(o=>{n[o]=r[o]?r[o]:Tr[o]||Tr[ag[o]||"log"]||Dr;}),e[Bi]=n;}function cg(e,t){return Array.isArray(e)?e.filter(function(n){return n!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function Ze(e){e=e||{},e.browser=e.browser||{};let t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");let r=e.browser.write||Tr;e.browser.write&&(e.browser.asObject=!0);let n=e.serializers||{},o=cg(e.browser.serialize,n),i=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);let a=Object.keys(e.customLevels||{}),s=["error","fatal","warn","info","debug","trace"].concat(a);typeof r=="function"&&s.forEach(function(v){r[v]=r;}),(e.enabled===!1||e.browser.disabled)&&(e.level="silent");let u=e.level||"info",c=Object.create(r);c.log||(c.log=Dr),sg(c,s,r),Jc({},c),Object.defineProperty(c,"levelVal",{get:p}),Object.defineProperty(c,"level",{get:h,set:d});let l={transmit:t,serialize:o,asObject:e.browser.asObject,formatters:e.browser.formatters,levels:s,timestamp:hg(e)};c.levels=ug(e),c.level=u,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=Dr,c.serializers=n,c._serialize=o,c._stdErrSerialize=i,c.child=y,t&&(c._logEvent=ji());function p(){return zn(this.level,this)}function h(){return this._level}function d(v){if(v!=="silent"&&!this.levels.values[v])throw Error("unknown level "+v);this._level=v,wt(this,l,c,"error"),wt(this,l,c,"fatal"),wt(this,l,c,"warn"),wt(this,l,c,"info"),wt(this,l,c,"debug"),wt(this,l,c,"trace"),a.forEach(C=>{wt(this,l,c,C);});}function y(v,C){if(!v)throw new Error("missing bindings for child Pino");C=C||{},o&&v.serializers&&(C.serializers=v.serializers);let P=C.serializers;if(o&&P){var k=Object.assign({},n,P),L=e.browser.serialize===!0?Object.keys(k):o;delete v.serializers,Hn([v],L,k,this._stdErrSerialize);}function V(U){this._childLevel=(U._childLevel|0)+1,this.bindings=v,k&&(this.serializers=k,this._serialize=L),t&&(this._logEvent=ji([].concat(U._logEvent.bindings,v)));}V.prototype=this;let $=new V(this);return Jc(this,$),$.level=this.level,$}return c}function ug(e){let t=e.customLevels||{},r=Object.assign({},Ze.levels.values,t),n=Object.assign({},Ze.levels.labels,lg(t));return {values:r,labels:n}}function lg(e){let t={};return Object.keys(e).forEach(function(r){t[e[r]]=r;}),t}Ze.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Ze.stdSerializers=ig;Ze.stdTimeFunctions=Object.assign({},{nullTime:Zc,epochTime:eu,unixTime:yg,isoTime:Sg});function dg(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[Ui];for(;r.parent;)r=r.parent,r.logger.bindings&&t.push(r.logger.bindings);return t.reverse()}function wt(e,t,r,n){if(Object.defineProperty(e,n,{value:zn(e.level,r)>zn(n,r)?Dr:r[Bi][n],writable:!0,enumerable:!0,configurable:!0}),!t.transmit&&e[n]===Dr)return;e[n]=mg(e,t,r,n);let o=dg(e);o.length!==0&&(e[n]=pg(o,e[n]));}function pg(e,t){return function(){return t.apply(this,[...e,...arguments])}}function mg(e,t,r,n){return function(o){return function(){let a=t.timestamp(),s=new Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Tr?Tr:this;for(var c=0;c<s.length;c++)s[c]=arguments[c];if(t.serialize&&!t.asObject&&Hn(s,this._serialize,this.serializers,this._stdErrSerialize),t.asObject||t.formatters?o.call(u,fg(this,n,s,a,t.formatters)):o.apply(u,s),t.transmit){let l=t.transmit.level||e._level,p=r.levels.values[l],h=r.levels.values[n];if(h<p)return;gg(this,{ts:a,methodLevel:n,methodValue:h,transmitLevel:l,transmitValue:r.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:zn(e._level,r)},s);}}}(e[Bi][n])}function fg(e,t,r,n,o={}){let{level:i=()=>e.levels.values[t],log:a=h=>h}=o;e._serialize&&Hn(r,e._serialize,e.serializers,e._stdErrSerialize);let s=r.slice(),u=s[0],c={};n&&(c.time=n),c.level=i(t,e.levels.values[t]);let l=(e._childLevel|0)+1;if(l<1&&(l=1),u!==null&&typeof u=="object"){for(;l--&&typeof s[0]=="object";)Object.assign(c,s.shift());u=s.length?Kc(s.shift(),s):void 0;}else typeof u=="string"&&(u=Kc(s.shift(),s));return u!==void 0&&(c.msg=u),a(c)}function Hn(e,t,r,n){for(let o in e)if(n&&e[o]instanceof Error)e[o]=Ze.stdSerializers.err(e[o]);else if(typeof e[o]=="object"&&!Array.isArray(e[o]))for(let i in e[o])t&&t.indexOf(i)>-1&&i in r&&(e[o][i]=r[i](e[o][i]));}function gg(e,t,r){let n=t.send,o=t.ts,i=t.methodLevel,a=t.methodValue,s=t.val,u=e._logEvent.bindings;Hn(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=o,e._logEvent.messages=r.filter(function(c){return u.indexOf(c)===-1}),e._logEvent.level.label=i,e._logEvent.level.value=a,n(i,e._logEvent,s),e._logEvent=ji(u);}function ji(e){return {ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function Xc(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)t[r]===void 0&&(t[r]=e[r]);return t}function hg(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?Zc:eu}function Qn(){return {}}function Li(e){return e}function Dr(){}function Zc(){return !1}function eu(){return Date.now()}function yg(){return Math.round(Date.now()/1e3)}function Sg(){return new Date(Date.now()).toISOString()}function vg(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}Wn.exports.default=Ze;Wn.exports.pino=Ze;});var Ru=K((zi,Hi)=>{(function(e,t){typeof zi=="object"&&typeof Hi<"u"?Hi.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_customParseFormat=t();})(zi,function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,n=/\d\d?/,o=/\d*[^-_:/,()\s\d]+/,i={},a=function(d){return (d=+d)+(d>68?1900:2e3)},s=function(d){return function(y){this[d]=+y;}},u=[/[+-]\d\d:?(\d\d)?|Z/,function(d){(this.zone||(this.zone={})).offset=function(y){if(!y||y==="Z")return 0;var v=y.match(/([+-]|\d\d)/g),C=60*v[1]+(+v[2]||0);return C===0?0:v[0]==="+"?-C:C}(d);}],c=function(d){var y=i[d];return y&&(y.indexOf?y:y.s.concat(y.f))},l=function(d,y){var v,C=i.meridiem;if(C){for(var P=1;P<=24;P+=1)if(d.indexOf(C(P,0,y))>-1){v=P>12;break}}else v=d===(y?"pm":"PM");return v},p={A:[o,function(d){this.afternoon=l(d,!1);}],a:[o,function(d){this.afternoon=l(d,!0);}],S:[/\d/,function(d){this.milliseconds=100*+d;}],SS:[r,function(d){this.milliseconds=10*+d;}],SSS:[/\d{3}/,function(d){this.milliseconds=+d;}],s:[n,s("seconds")],ss:[n,s("seconds")],m:[n,s("minutes")],mm:[n,s("minutes")],H:[n,s("hours")],h:[n,s("hours")],HH:[n,s("hours")],hh:[n,s("hours")],D:[n,s("day")],DD:[r,s("day")],Do:[o,function(d){var y=i.ordinal,v=d.match(/\d+/);if(this.day=v[0],y)for(var C=1;C<=31;C+=1)y(C).replace(/\[|\]/g,"")===d&&(this.day=C);}],M:[n,s("month")],MM:[r,s("month")],MMM:[o,function(d){var y=c("months"),v=(c("monthsShort")||y.map(function(C){return C.slice(0,3)})).indexOf(d)+1;if(v<1)throw new Error;this.month=v%12||v;}],MMMM:[o,function(d){var y=c("months").indexOf(d)+1;if(y<1)throw new Error;this.month=y%12||y;}],Y:[/[+-]?\d+/,s("year")],YY:[r,function(d){this.year=a(d);}],YYYY:[/\d{4}/,s("year")],Z:u,ZZ:u};function h(d){var y,v;y=d,v=i&&i.formats;for(var C=(d=y.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(H,j,N){var ne=N&&N.toUpperCase();return j||v[N]||e[N]||v[ne].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(we,O,x){return O||x.slice(1)})})).match(t),P=C.length,k=0;k<P;k+=1){var L=C[k],V=p[L],$=V&&V[0],U=V&&V[1];C[k]=U?{regex:$,parser:U}:L.replace(/^\[|\]$/g,"");}return function(H){for(var j={},N=0,ne=0;N<P;N+=1){var we=C[N];if(typeof we=="string")ne+=we.length;else {var O=we.regex,x=we.parser,R=H.slice(ne),E=O.exec(R)[0];x.call(j,E),H=H.replace(E,"");}}return function(b){var T=b.afternoon;if(T!==void 0){var q=b.hours;T?q<12&&(b.hours+=12):q===12&&(b.hours=0),delete b.afternoon;}}(j),j}}return function(d,y,v){v.p.customParseFormat=!0,d&&d.parseTwoDigitYear&&(a=d.parseTwoDigitYear);var C=y.prototype,P=C.parse;C.parse=function(k){var L=k.date,V=k.utc,$=k.args;this.$u=V;var U=$[1];if(typeof U=="string"){var H=$[2]===!0,j=$[3]===!0,N=H||j,ne=$[2];j&&(ne=$[2]),i=this.$locale(),!H&&ne&&(i=v.Ls[ne]),this.$d=function(R,E,b){try{if(["x","X"].indexOf(E)>-1)return new Date((E==="X"?1e3:1)*R);var T=h(E)(R),q=T.year,Q=T.month,G=T.day,Z=T.hours,te=T.minutes,de=T.seconds,tt=T.milliseconds,Oe=T.zone,Be=new Date,Pe=G||(q||Q?1:Be.getDate()),re=q||Be.getFullYear(),ge=0;q&&!Q||(ge=Q>0?Q-1:Be.getMonth());var $e=Z||0,rt=te||0,Fo=de||0,Io=tt||0;return Oe?new Date(Date.UTC(re,ge,Pe,$e,rt,Fo,Io+60*Oe.offset*1e3)):b?new Date(Date.UTC(re,ge,Pe,$e,rt,Fo,Io)):new Date(re,ge,Pe,$e,rt,Fo,Io)}catch{return new Date("")}}(L,U,V),this.init(),ne&&ne!==!0&&(this.$L=this.locale(ne).$L),N&&L!=this.format(U)&&(this.$d=new Date("")),i={};}else if(U instanceof Array)for(var we=U.length,O=1;O<=we;O+=1){$[1]=U[O-1];var x=v.apply(this,$);if(x.isValid()){this.$d=x.$d,this.$L=x.$L,this.init();break}O===we&&(this.$d=new Date(""));}else P.call(this,k);};}});});var Pu=K((Yi,Gi)=>{(function(e,t){typeof Yi=="object"&&typeof Gi<"u"?Gi.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_quarterOfYear=t();})(Yi,function(){var e="month",t="quarter";return function(r,n){var o=n.prototype;o.quarter=function(s){return this.$utils().u(s)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(s-1))};var i=o.add;o.add=function(s,u){return s=Number(s),this.$utils().p(u)===t?this.add(3*s,e):i.bind(this)(s,u)};var a=o.startOf;o.startOf=function(s,u){var c=this.$utils(),l=!!c.u(u)||u;if(c.p(s)===t){var p=this.quarter()-1;return l?this.month(3*p).startOf(e).startOf("day"):this.month(3*p+2).endOf(e).endOf("day")}return a.bind(this)(s,u)};}});});var lr=()=>global.crypto,sa=()=>{typeof window<"u"||(lr()||(global.crypto=Il("crypto")),!lr().getRandomValues&&lr().webcrypto&&(global.crypto.getRandomValues=lr().webcrypto.getRandomValues.bind(lr().webcrypto)));};var Aa={};kl(Aa,{escape:()=>Ot,getHighlightedSuggestion:()=>Yl,highlightString:()=>Wl});function Tl(e,t){let r=`
  The following properties are invalid:

    ${e.join(`
	`)}
  
  ${t}
  `;return new dr(r)}var dr=class extends Error{constructor(e){super(e),this.name="SchemaValidationError";}},le=class{constructor(e){this.definition=e;}validate(e={},t=""){let r={...this.default,...e},n=[];for(let o in this.definition){let i=this.definition[o].validate(r[o]);i&&n.push(`${o}: ${i}`);}if(n.length)throw Tl(n,t);return r}get default(){let e={};for(let t in this.definition){let r=this.definition[t].default;r!==void 0&&(e[t]=r);}return e}},Y=class{constructor(e={}){this.baseConfig=e;}validate(e){return this.baseConfig.required&&D(e)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return this.baseConfig.required===!0}};function ee(e){return e===void 0}function Dl(e){return e===null}function D(e){return ee(e)||Dl(e)}var I=class{constructor(e={}){this.config=e,this.value=new Y(e);}validate(e){let t=this.value.validate(e);return t||(ql(e)?e<this.config.min?`minimum value of ${this.config.min} not respected.`:e>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}};function ql(e){return ee(e)||ca(e)}function ca(e){return typeof e=="number"&&!isNaN(e)}var M=class{constructor(e={}){this.value=new Y(e);}validate(e){let t=this.value.validate(e);return t||(Nl(e)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}};function Nl(e){return ee(e)||ua(e)}function ua(e){return typeof e=="boolean"}var Ml=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i,A=class{constructor(e={}){this.config={emptyAllowed:!0,url:!1,...e},this.value=new Y(this.config);}validate(e){let{emptyAllowed:t,url:r,regex:n,constrainTo:o}=this.config,i=this.value.validate(e);return i||(ee(e)?null:$r(e)?!t&&!e.length?"value is an empty string.":r&&!Ml.test(e)?"value is not a valid URL.":n&&!n.test(e)?`value did not match provided regex ${n}`:o&&!o.includes(e)?`value should be one of: ${o.join(", ")}.`:null:"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}};function $r(e){return Object.prototype.toString.call(e)==="[object String]"}var F=class{constructor(e={}){this.config={options:{required:!1},values:{},...e};}validate(e){if(ee(e))return this.config.options.required?"value is required and is currently undefined":null;if(!la(e))return "value is not an object";for(let[r,n]of Object.entries(this.config.values))if(n.required&&D(e[r]))return `value does not contain ${r}`;let t="";for(let[r,n]of Object.entries(this.config.values)){let o=e[r],i=n.validate(o);i!==null&&(t+=" "+i);}return t===""?null:t}get default(){}get required(){return !!this.config.options.required}};function la(e){return e!==void 0&&typeof e=="object"}var z=class{constructor(e={}){this.config=e,this.value=new Y(this.config);}validate(e){if(!D(e)&&!Array.isArray(e))return "value is not an array";let t=this.value.validate(e);if(t!==null)return t;if(D(e))return null;if(this.config.max!==void 0&&e.length>this.config.max)return `value contains more than ${this.config.max}`;if(this.config.min!==void 0&&e.length<this.config.min)return `value contains less than ${this.config.min}`;if(this.config.each!==void 0){let r="";return e.forEach(n=>{this.config.each.required&&D(n)&&(r=`value is null or undefined: ${e.join(",")}`);let o=this.validatePrimitiveValue(n,this.config.each);o!==null&&(r+=" "+o);}),r===""?null:r}return null}validatePrimitiveValue(e,t){return ua(e)||$r(e)||ca(e)||la(e)?t.validate(e):"value is not a primitive value"}get default(){}get required(){return this.value.required}};function da(e){return Array.isArray(e)}var kt=class{constructor(e){this.config=e,this.value=new Y(e);}validate(e){let t=this.value.validate(e);return t!==null?t:ee(e)||Object.values(this.config.enum).find(n=>n===e)?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}};Ae(ya());function Qr(e){return e.trim()===""}function va(e,t){return [...e.reduce((r,n)=>{let o=t(n);return r.has(o)||r.set(o,n),r},new Map).values()]}var Hl=new Set(["1",1,"yes",!0]);function zr(){if(typeof navigator>"u"||typeof window>"u")return !1;let e=navigator,t=window;return [e.globalPrivacyControl,e.doNotTrack,e.msDoNotTrack,t.doNotTrack].some(r=>Hl.has(r))}function Ca(e){let t={};for(let[r,n]of e)t[r]=n;return t}function pr(e){if(typeof e!="object"||!e)return e;try{return JSON.parse(JSON.stringify(e))}catch{return e}}function Wl(e){if(Qr(e.openingDelimiter)||Qr(e.closingDelimiter))throw Error("delimiters should be a non-empty string");if(D(e.content)||Qr(e.content))return e.content;if(e.highlights.length===0)return Ot(e.content);let t=e.content.length,r="",n=0;for(let o=0;o<e.highlights.length;o++){let i=e.highlights[o],a=i.offset,s=a+i.length;if(s>t)break;r+=Ot(e.content.slice(n,a)),r+=e.openingDelimiter,r+=Ot(e.content.slice(a,s)),r+=e.closingDelimiter,n=s;}return n!==t&&(r+=Ot(e.content.slice(n))),r}function Yl(e,t){return e=Ot(e),e.replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,(r,n,o,i)=>n?ko(n,t.notMatchDelimiters):o?ko(o,t.exactMatchDelimiters):i?ko(i,t.correctionDelimiters):r)}function ko(e,t){return t?t.open+e+t.close:e}function Ot(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r="(?:"+Object.keys(t).join("|")+")",n=RegExp(r),o=RegExp(r,"g");return n.test(e)?e.replace(o,i=>t[i]):e}var Hr=e=>e;function Wr(){return {answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}}function Te(){return {response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:Wr(),pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],searchResponseId:"",requestId:"",questionAnswer:Wr(),extendedResults:{}}}function Qe(e){let{url:t,accessToken:r,organizationId:n,authentication:o,...i}=e;return i}var ze=e=>{let{response:t}=e;return t.body?Gl(e):Kl(t)},Gl=e=>Xl(e)?Zl(e):Jl(e)?e.body:{message:"unknown",statusCode:0,type:"unknown"},Kl=e=>{let t=JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)));return {...t,message:`Client side error: ${t.message||""}`,statusCode:400,type:"ClientError"}};function Jl(e){return e.body.statusCode!==void 0}function Xl(e){return e.body.exception!==void 0}var Zl=e=>({message:e.body.exception.code,statusCode:e.response.status,type:e.body.exception.code});var Na=Ae(ba()),Ma=Ae(Oa());var Tt=class extends Error{constructor(){super(),this.name="ExpiredToken",this.message="The token being used to perform the request is expired.";}},Ct=class extends Error{constructor(t,r){super(),this.name="Disconnected",this.message=`Client could not connect to the following URL: ${t}`,this.statusCode=r??0;}};function Ta(e){let t=[];for(let r in e){let n=encodeURIComponent(r),o=encodeURIComponent(e[r]);t.push(`${n}=${o}`);}return t.join("&")}function Da(e){return typeof e!="object"||!e?!1:Object.values(e).every(wd)}function wd(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function qa(e){return e===429}var he=class e{static async call(t){let r=Pd(t),{logger:n}=t,o=await e.preprocessRequest(r,t);n.info(o,"Platform request");let{url:i,...a}=o,s=async()=>{let u=await(0, Na.default)(i,a);if(qa(u.status))throw u;return u};try{let u=await(0, Ma.backOff)(s,{retry:c=>{let l=c&&qa(c.status);return l&&n.info("Platform retrying request"),l}});if(u.status===419)throw n.info("Platform renewing token"),new Tt;if(u.status===404)throw new Ct(i,u.status);return n.info({response:u,requestInfo:o},"Platform response"),u}catch(u){return u.message==="Failed to fetch"?new Ct(i):u}}static async preprocessRequest(t,r){let{origin:n,preprocessRequest:o,logger:i,requestMetadata:a}=r,{signal:s,...u}=t,c=pr(u);try{let l=await o(t,n,a);return {...t,...l}}catch(l){i.error(l,"Platform request preprocessing failed. Returning default request options.");}return c}};function Va(e,t){let r=!t||!t.environment||t.environment==="prod"?"":t.environment,n=!t||!t.region||t.region==="us"?"":`-${t.region}`;return `https://${e}${r}${n}.cloud.coveo.com`}function gr(e,t="prod"){let r=t==="prod"?"":t,n=`https://${e}.org${r}.coveo.com`,o=`https://${e}.analytics.org${r}.coveo.com`,i=`${n}/rest/search/v2`,a=`https://${e}.admin.org${r}.coveo.com`;return {platform:n,analytics:o,search:i,admin:a}}function Lo(e){return e?.multiRegionSubDomain?`https://${e.multiRegionSubDomain}.org.coveo.com`:Va("platform",e)}function _a(e){return Va("analytics",e)}function Pd(e){let{url:t,method:r,requestParams:n,contentType:o,accessToken:i,signal:a}=e,s=e.method==="POST"||e.method==="PUT",u=Ed(n,o);return {url:t,method:r,headers:{"Content-Type":o,Authorization:`Bearer ${i}`,...e.headers},...s&&{body:u},signal:a}}function Ed(e,t){return t==="application/x-www-form-urlencoded"?Da(e)?Ta(e):"":JSON.stringify(e)}function ja(){if(typeof window>"u"){let{AbortController:e}=Ua();return new e}return typeof AbortController>"u"?null:new AbortController}var nt=class{constructor(){this.currentAbortController=null;}async enqueue(t,r){let n=this.currentAbortController,o=this.currentAbortController=ja();n&&(r.warnOnAbort&&r.logger.warn("Cancelling current pending search query"),n.abort());try{return await t(o?.signal??null)}finally{this.currentAbortController===o&&(this.currentAbortController=null);}}};var hr=class{constructor(t){this._params={};this._basePath=t;}addParam(t,r){this._params={...this.params,[t]:r};}get basePath(){return this._basePath}get params(){return this._params}get hasParams(){return Object.entries(this._params).length}get href(){return this.hasParams?`${this.basePath}?${Object.entries(this.params).map(([t,r])=>`${t}=${encodeURIComponent(r)}`).join("&")}`:this.basePath}},Ba=e=>/^https:\/\/platform(dev|stg|hipaa)?(-)?(eu|au)?\.cloud\.coveo\.com/.test(e),$a=(e,t)=>{let r=jo(e);return r&&r.organizationId===t?r:null},jo=e=>{let t=e.match(/^https:\/\/(?<organizationId>\w+)\.org(?<environment>dev|stg|hipaa)?\.coveo\.com/);return t?.groups?t.groups:null};function Qa(e){return ((e.headers.get("content-type")||"").split(";").find(n=>n.indexOf("charset=")!==-1)||"").split("=")[1]||"UTF-8"}var qe=(e,t,r,n)=>{let o=new hr(`${e.url}${n}`);return o.addParam("organizationId",e.organizationId),e.authentication&&o.addParam("authentication",e.authentication),{accessToken:e.accessToken,method:t,contentType:r,url:o.href,origin:"searchApiFetch"}};var za=async(e,t)=>{let r=await he.call({...qe(e,"POST","application/x-www-form-urlencoded","/html"),requestParams:Qe(e),requestMetadata:{method:"html"},...t});if(r instanceof Error)throw r;let n=Qa(r),o=await r.arrayBuffer(),a=new TextDecoder(n).decode(o);return Fd(a)?{success:a}:{error:ze({response:r,body:a})}};function Fd(e){return typeof e=="string"}function Id(e){return {statusCode:e.statusCode,type:e.name,message:e.message}}function kd(e){return {statusCode:e.code,type:e.name,message:e.message,ignored:!0}}function yr(e,t){if(t&&e.name==="AbortError")return {error:kd(e)};if(e instanceof Ct)return {error:Id(e)};throw e}var Gr=class{constructor(t){this.options=t;this.apiCallsQueues={unknown:new nt,mainSearch:new nt,facetValues:new nt,foldingCollection:new nt,instantResults:new nt};}async plan(t){let r=await he.call({...qe(t,"POST","application/json","/plan"),requestParams:Qe(t),requestMetadata:{method:"plan"},...this.options});if(r instanceof Error)return yr(r);let n=await r.json();return Dd(n)?{success:n}:{error:ze({response:r,body:n})}}async querySuggest(t){let r=await he.call({...qe(t,"POST","application/json","/querySuggest"),requestMetadata:{method:"querySuggest"},requestParams:Qe(t),...this.options});if(r instanceof Error)return yr(r);let n=await r.json(),o={response:r,body:n};return Td(n)?{success:(await this.options.postprocessQuerySuggestResponseMiddleware(o)).body}:{error:ze(o)}}async search(t,r){let n=r?.origin??"unknown",o=await this.apiCallsQueues[n].enqueue(s=>he.call({...qe(t,"POST","application/json",""),requestParams:Qe(t),requestMetadata:{method:"search",origin:r?.origin},...this.options,signal:s??void 0}),{logger:this.options.logger,warnOnAbort:!r?.disableAbortWarning});if(o instanceof Error)return yr(o,r?.disableAbortWarning);let i=await o.json(),a={response:o,body:i};return Bo(i)?(a.body=Od(i),{success:(await this.options.postprocessSearchResponseMiddleware(a)).body}):{error:ze(a)}}async facetSearch(t){let r=await he.call({...qe(t,"POST","application/json","/facet"),requestParams:Qe(t),requestMetadata:{method:"facetSearch"},...this.options});if(r instanceof Error)throw r;let n=await r.json(),o={response:r,body:n};return (await this.options.postprocessFacetSearchResponseMiddleware(o)).body}async recommendations(t){let r=await he.call({...qe(t,"POST","application/json",""),requestParams:Qe(t),requestMetadata:{method:"recommendations"},...this.options});if(r instanceof Error)throw r;let n=await r.json();return Bo(n)?{success:n}:{error:ze({response:r,body:n})}}async html(t){return za(t,{...this.options})}async productRecommendations(t){let r=await he.call({...qe(t,"POST","application/json",""),requestParams:Qe(t),requestMetadata:{method:"productRecommendations"},...this.options});if(r instanceof Error)throw r;let n=await r.json();return Bo(n)?{success:n}:{error:ze({response:r,body:n})}}async fieldDescriptions(t){let r=await he.call({...qe(t,"GET","application/json","/fields"),requestParams:{},requestMetadata:{method:"fieldDescriptions"},...this.options});if(r instanceof Error)throw r;let n=await r.json();return qd(n)?{success:n}:{error:ze({response:r,body:n})}}},Kr=e=>e.success!==void 0,pe=e=>e.error!==void 0;function Bo(e){return e.results!==void 0}function Od(e){let t=Wr();return D(e.questionAnswer)?(e.questionAnswer=t,e):(e.questionAnswer={...t,...e.questionAnswer},e)}function Td(e){return e.completions!==void 0}function Dd(e){return e.preprocessingOutput!==void 0}function qd(e){return e.fields!==void 0}var Ha=e=>e,Wa=e=>e,Ya=e=>e;function oe(e){return `Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Nd=typeof Symbol=="function"&&Symbol.observable||"@@observable",Ga=Nd,$o=()=>Math.random().toString(36).substring(7).split("").join("."),Md={INIT:`@@redux/INIT${$o()}`,REPLACE:`@@redux/REPLACE${$o()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${$o()}`},Jr=Md;function Xr(e){if(typeof e!="object"||e===null)return !1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Qo(e,t,r){if(typeof e!="function")throw new Error(oe(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(oe(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(oe(1));return r(Qo)(e,t)}let n=e,o=t,i=new Map,a=i,s=0,u=!1;function c(){a===i&&(a=new Map,i.forEach((C,P)=>{a.set(P,C);}));}function l(){if(u)throw new Error(oe(3));return o}function p(C){if(typeof C!="function")throw new Error(oe(4));if(u)throw new Error(oe(5));let P=!0;c();let k=s++;return a.set(k,C),function(){if(P){if(u)throw new Error(oe(6));P=!1,c(),a.delete(k),i=null;}}}function h(C){if(!Xr(C))throw new Error(oe(7));if(typeof C.type>"u")throw new Error(oe(8));if(typeof C.type!="string")throw new Error(oe(17));if(u)throw new Error(oe(9));try{u=!0,o=n(o,C);}finally{u=!1;}return (i=a).forEach(k=>{k();}),C}function d(C){if(typeof C!="function")throw new Error(oe(10));n=C,h({type:Jr.REPLACE});}function y(){let C=p;return {subscribe(P){if(typeof P!="object"||P===null)throw new Error(oe(11));function k(){let V=P;V.next&&V.next(l());}return k(),{unsubscribe:C(k)}},[Ga](){return this}}}return h({type:Jr.INIT}),{dispatch:h,subscribe:p,getState:l,replaceReducer:d,[Ga]:y}}function Vd(e){Object.keys(e).forEach(t=>{let r=e[t];if(typeof r(void 0,{type:Jr.INIT})>"u")throw new Error(oe(12));if(typeof r(void 0,{type:Jr.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(oe(13))});}function Zr(e){let t=Object.keys(e),r={};for(let a=0;a<t.length;a++){let s=t[a];typeof e[s]=="function"&&(r[s]=e[s]);}let n=Object.keys(r),i;try{Vd(r);}catch(a){i=a;}return function(s={},u){if(i)throw i;let c=!1,l={};for(let p=0;p<n.length;p++){let h=n[p],d=r[h],y=s[h],v=d(y,u);if(typeof v>"u"){throw new Error(oe(14))}l[h]=v,c=c||v!==y;}return c=c||n.length!==Object.keys(s).length,c?l:s}}function Dt(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function Ka(...e){return t=>(r,n)=>{let o=t(r,n),i=()=>{throw new Error(oe(15))},a={getState:o.getState,dispatch:(u,...c)=>i(u,...c)},s=e.map(u=>u(a));return i=Dt(...s)(o.dispatch),{...o,dispatch:i}}}function Ja(e){return Xr(e)&&"type"in e&&typeof e.type=="string"}var ns=Symbol.for("immer-nothing"),Xa=Symbol.for("immer-draftable"),ye=Symbol.for("immer-state");function Ee(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var qt=Object.getPrototypeOf;function Ne(e){return !!e&&!!e[ye]}function Fe(e){return e?os(e)||Array.isArray(e)||!!e[Xa]||!!e.constructor?.[Xa]||nn(e)||on(e):!1}var _d=Object.prototype.constructor.toString();function os(e){if(!e||typeof e!="object")return !1;let t=qt(e);if(t===null)return !0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===_d}function Sr(e,t){rn(e)===0?Object.entries(e).forEach(([r,n])=>{t(r,n,e);}):e.forEach((r,n)=>t(n,r,e));}function rn(e){let t=e[ye];return t?t.type_:Array.isArray(e)?1:nn(e)?2:on(e)?3:0}function Wo(e,t){return rn(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function is(e,t,r){let n=rn(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r;}function Ld(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function nn(e){return e instanceof Map}function on(e){return e instanceof Set}function At(e){return e.copy_||e.base_}function Yo(e,t){if(nn(e))return new Map(e);if(on(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&os(e))return qt(e)?{...e}:Object.assign(Object.create(null),e);let r=Object.getOwnPropertyDescriptors(e);delete r[ye];let n=Reflect.ownKeys(r);for(let o=0;o<n.length;o++){let i=n[o],a=r[i];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]});}return Object.create(qt(e),r)}function Zo(e,t=!1){return an(e)||Ne(e)||!Fe(e)||(rn(e)>1&&(e.set=e.add=e.clear=e.delete=Ud),Object.freeze(e),t&&Sr(e,(r,n)=>Zo(n,!0))),e}function Ud(){Ee(2);}function an(e){return Object.isFrozen(e)}var jd={};function Rt(e){let t=jd[e];return t||Ee(0,e),t}var vr;function as(){return vr}function Bd(e,t){return {drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Za(e,t){t&&(Rt("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t);}function Go(e){Ko(e),e.drafts_.forEach($d),e.drafts_=null;}function Ko(e){e===vr&&(vr=e.parent_);}function es(e){return vr=Bd(vr,e)}function $d(e){let t=e[ye];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0;}function ts(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[ye].modified_&&(Go(t),Ee(4)),Fe(e)&&(e=en(t,e),t.parent_||tn(t,e)),t.patches_&&Rt("Patches").generateReplacementPatches_(r[ye].base_,e,t.patches_,t.inversePatches_)):e=en(t,r,[]),Go(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==ns?e:void 0}function en(e,t,r){if(an(t))return t;let n=t[ye];if(!n)return Sr(t,(o,i)=>rs(e,n,t,o,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return tn(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let o=n.copy_,i=o,a=!1;n.type_===3&&(i=new Set(o),o.clear(),a=!0),Sr(i,(s,u)=>rs(e,n,o,s,u,r,a)),tn(e,o,!1),r&&e.patches_&&Rt("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_);}return n.copy_}function rs(e,t,r,n,o,i,a){if(Ne(o)){let s=i&&t&&t.type_!==3&&!Wo(t.assigned_,n)?i.concat(n):void 0,u=en(e,o,s);if(is(r,n,u),Ne(u))e.canAutoFreeze_=!1;else return}else a&&r.add(o);if(Fe(o)&&!an(o)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;en(e,o),(!t||!t.scope_.parent_)&&tn(e,o);}}function tn(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Zo(t,r);}function Qd(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:as(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},o=n,i=ei;r&&(o=[n],i=Cr);let{revoke:a,proxy:s}=Proxy.revocable(o,i);return n.draft_=s,n.revoke_=a,s}var ei={get(e,t){if(t===ye)return e;let r=At(e);if(!Wo(r,t))return zd(e,r,t);let n=r[t];return e.finalized_||!Fe(n)?n:n===zo(e.base_,t)?(Ho(e),e.copy_[t]=Xo(n,e)):n},has(e,t){return t in At(e)},ownKeys(e){return Reflect.ownKeys(At(e))},set(e,t,r){let n=ss(At(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let o=zo(At(e),t),i=o?.[ye];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Ld(r,o)&&(r!==void 0||Wo(e.base_,t)))return !0;Ho(e),Jo(e);}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return zo(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Ho(e),Jo(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=At(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Ee(11);},getPrototypeOf(e){return qt(e.base_)},setPrototypeOf(){Ee(12);}},Cr={};Sr(ei,(e,t)=>{Cr[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)};});Cr.deleteProperty=function(e,t){return Cr.set.call(this,e,t,void 0)};Cr.set=function(e,t,r){return ei.set.call(this,e[0],t,r,e[0])};function zo(e,t){let r=e[ye];return (r?At(r):e)[t]}function zd(e,t,r){let n=ss(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function ss(e,t){if(!(t in e))return;let r=qt(e);for(;r;){let n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=qt(r);}}function Jo(e){e.modified_||(e.modified_=!0,e.parent_&&Jo(e.parent_));}function Ho(e){e.copy_||(e.copy_=Yo(e.base_,e.scope_.immer_.useStrictShallowCopy_));}var Hd=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){let i=r;r=t;let a=this;return function(u=i,...c){return a.produce(u,l=>r.call(this,l,...c))}}typeof r!="function"&&Ee(6),n!==void 0&&typeof n!="function"&&Ee(7);let o;if(Fe(t)){let i=es(this),a=Xo(t,void 0),s=!0;try{o=r(a),s=!1;}finally{s?Go(i):Ko(i);}return Za(i,n),ts(o,i)}else if(!t||typeof t!="object"){if(o=r(t),o===void 0&&(o=t),o===ns&&(o=void 0),this.autoFreeze_&&Zo(o,!0),n){let i=[],a=[];Rt("Patches").generateReplacementPatches_(t,o,i,a),n(i,a);}return o}else Ee(1,t);},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return (a,...s)=>this.produceWithPatches(a,u=>t(u,...s));let n,o;return [this.produce(t,r,(a,s)=>{n=a,o=s;}),n,o]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy);}createDraft(e){Fe(e)||Ee(8),Ne(e)&&(e=ti(e));let t=es(this),r=Xo(e,void 0);return r[ye].isManual_=!0,Ko(t),r}finishDraft(e,t){let r=e&&e[ye];(!r||!r.isManual_)&&Ee(9);let{scope_:n}=r;return Za(n,t),ts(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e;}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e;}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let o=t[r];if(o.path.length===0&&o.op==="replace"){e=o.value;break}}r>-1&&(t=t.slice(r+1));let n=Rt("Patches").applyPatches_;return Ne(e)?n(e,t):this.produce(e,o=>n(o,t))}};function Xo(e,t){let r=nn(e)?Rt("MapSet").proxyMap_(e,t):on(e)?Rt("MapSet").proxySet_(e,t):Qd(e,t);return (t?t.scope_:as()).drafts_.push(r),r}function ti(e){return Ne(e)||Ee(10,e),cs(e)}function cs(e){if(!Fe(e)||an(e))return e;let t=e[ye],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Yo(e,t.scope_.immer_.useStrictShallowCopy_);}else r=Yo(e,!0);return Sr(r,(n,o)=>{is(r,n,cs(o));}),t&&(t.finalized_=!1),r}var Se=new Hd,sn=Se.produce;Se.produceWithPatches.bind(Se);Se.setAutoFreeze.bind(Se);Se.setUseStrictShallowCopy.bind(Se);Se.applyPatches.bind(Se);Se.createDraft.bind(Se);Se.finishDraft.bind(Se);function Wd(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Yd(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Gd(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){let r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var us=e=>Array.isArray(e)?e:[e];function Kd(e){let t=Array.isArray(e[0])?e[0]:e;return Gd(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Jd(e,t){let r=[],{length:n}=e;for(let o=0;o<n;o++)r.push(e[o].apply(null,t));return r}var Xd=class{constructor(e){this.value=e;}deref(){return this.value}},Zd=typeof WeakRef<"u"?WeakRef:Xd,ep=0,ls=1;function cn(){return {s:ep,v:void 0,o:null,p:null}}function Ar(e,t={}){let r=cn(),{resultEqualityCheck:n}=t,o,i=0;function a(){let s=r,{length:u}=arguments;for(let p=0,h=u;p<h;p++){let d=arguments[p];if(typeof d=="function"||typeof d=="object"&&d!==null){let y=s.o;y===null&&(s.o=y=new WeakMap);let v=y.get(d);v===void 0?(s=cn(),y.set(d,s)):s=v;}else {let y=s.p;y===null&&(s.p=y=new Map);let v=y.get(d);v===void 0?(s=cn(),y.set(d,s)):s=v;}}let c=s,l;if(s.s===ls?l=s.v:(l=e.apply(null,arguments),i++),c.s=ls,n){let p=o?.deref?.()??o;p!=null&&n(p,l)&&(l=p,i!==0&&i--),o=typeof l=="object"&&l!==null||typeof l=="function"?new Zd(l):l;}return c.v=l,l}return a.clearCache=()=>{r=cn(),a.resetResultsCount();},a.resultsCount=()=>i,a.resetResultsCount=()=>{i=0;},a}function un(e,...t){let r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...o)=>{let i=0,a=0,s,u={},c=o.pop();typeof c=="object"&&(u=c,c=o.pop()),Wd(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);let l={...r,...u},{memoize:p,memoizeOptions:h=[],argsMemoize:d=Ar,argsMemoizeOptions:y=[],devModeChecks:v={}}=l,C=us(h),P=us(y),k=Kd(o),L=p(function(){return i++,c.apply(null,arguments)},...C),$=d(function(){a++;let H=Jd(k,arguments);return s=L.apply(null,H),s},...P);return Object.assign($,{resultFunc:c,memoizedResultFunc:L,dependencies:k,dependencyRecomputations:()=>a,resetDependencyRecomputations:()=>{a=0;},lastResult:()=>s,recomputations:()=>i,resetRecomputations:()=>{i=0;},memoize:p,argsMemoize:d})};return Object.assign(n,{withTypes:()=>n}),n}var Nt=un(Ar),tp=Object.assign((e,t=Nt)=>{Yd(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((a,s,u)=>(a[r[u]]=s,a),{}))},{withTypes:()=>tp});function ds(e){return ({dispatch:r,getState:n})=>o=>i=>typeof i=="function"?i(r,n,e):o(i)}var ps=ds(),ms=ds;var rp=(...e)=>{let t=un(...e),r=Object.assign((...n)=>{let o=t(...n),i=(a,...s)=>o(Ne(a)?ti(a):a,...s);return Object.assign(i,o),i},{withTypes:()=>r});return r};rp(Ar);var np=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Dt:Dt.apply(null,arguments)},op=e=>e&&typeof e.match=="function";function g(e,t){function r(...n){if(t){let o=t(...n);if(!o)throw new Error(me(0));return {type:e,payload:o.payload,..."meta"in o&&{meta:o.meta},..."error"in o&&{error:o.error}}}return {type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>Ja(n)&&n.type===e,r}var hs=class Rr extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Rr.prototype);}static get[Symbol.species](){return Rr}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Rr(...t[0].concat(this)):new Rr(...t.concat(this))}};function fs(e){return Fe(e)?sn(e,()=>{}):e}function ip(e){return typeof e=="boolean"}var ap=()=>function(t){let{thunk:r=!0,immutableCheck:n=!0,serializableCheck:o=!0,actionCreatorCheck:i=!0}=t??{},a=new hs;return r&&(ip(r)?a.push(ps):a.push(ms(r.extraArgument))),a},sp="RTK_autoBatch";var ys=e=>t=>{setTimeout(t,e);},cp=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:ys(10),up=(e={type:"raf"})=>t=>(...r)=>{let n=t(...r),o=!0,i=!1,a=!1,s=new Set,u=e.type==="tick"?queueMicrotask:e.type==="raf"?cp:e.type==="callback"?e.queueNotification:ys(e.timeout),c=()=>{a=!1,i&&(i=!1,s.forEach(l=>l()));};return Object.assign({},n,{subscribe(l){let p=()=>o&&l(),h=n.subscribe(p);return s.add(l),()=>{h(),s.delete(l);}},dispatch(l){try{return o=!l?.meta?.[sp],i=!o,i&&(a||(a=!0,u(c))),n.dispatch(l)}finally{o=!0;}}})},lp=e=>function(r){let{autoBatch:n=!0}=r??{},o=new hs(e);return n&&o.push(up(typeof n=="object"?n:void 0)),o},ot=!0;function Ss(e){let t=ap(),{reducer:r=void 0,middleware:n,devTools:o=!0,preloadedState:i=void 0,enhancers:a=void 0}=e||{},s;if(typeof r=="function")s=r;else if(Xr(r))s=Zr(r);else throw new Error(me(1));let u;if(typeof n=="function"){if(u=n(t),!ot);}else u=t();let c=Dt;o&&(c=np({trace:!ot,...typeof o=="object"&&o}));let l=Ka(...u),p=lp(l);let h=typeof a=="function"?a(p):p();let d=c(...h);return Qo(s,i,d)}function dp(e){let t={},r=[],n,o={addCase(i,a){let s=typeof i=="string"?i:i.type;if(!s)throw new Error(me(28));if(s in t)throw new Error(me(29));return t[s]=a,o},addMatcher(i,a){return r.push({matcher:i,reducer:a}),o},addDefaultCase(i){return n=i,o}};return e(o),[t,r,n]}function pp(e){return typeof e=="function"}function J(e,t){let[r,n,o]=dp(t),i;if(pp(e))i=()=>fs(e());else {let s=fs(e);i=()=>s;}function a(s=i(),u){let c=[r[u.type],...n.filter(({matcher:l})=>l(u)).map(({reducer:l})=>l)];return c.filter(l=>!!l).length===0&&(c=[o]),c.reduce((l,p)=>{if(p)if(Ne(l)){let d=p(l,u);return d===void 0?l:d}else {if(Fe(l))return sn(l,h=>p(h,u));{let h=p(l,u);if(h===void 0){if(l===null)return l;throw new Error(me(9))}return h}}return l},s)}return a.getInitialState=i,a}var mp="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",vs=(e=21)=>{let t="",r=e;for(;r--;)t+=mp[Math.random()*64|0];return t},fp=(e,t)=>op(e)?e.match(t):e(t);function gp(...e){return t=>e.some(r=>fp(r,t))}var hp=["name","message","stack","code"],ri=class{constructor(e,t){Br(this,"_type");this.payload=e,this.meta=t;}},gs=class{constructor(e,t){Br(this,"_type");this.payload=e,this.meta=t;}},yp=e=>{if(typeof e=="object"&&e!==null){let t={};for(let r of hp)typeof e[r]=="string"&&(t[r]=e[r]);return t}return {message:String(e)}},W=(()=>{function e(t,r,n){let o=g(t+"/fulfilled",(u,c,l,p)=>({payload:u,meta:{...p||{},arg:l,requestId:c,requestStatus:"fulfilled"}})),i=g(t+"/pending",(u,c,l)=>({payload:void 0,meta:{...l||{},arg:c,requestId:u,requestStatus:"pending"}})),a=g(t+"/rejected",(u,c,l,p,h)=>({payload:p,error:(n&&n.serializeError||yp)(u||"Rejected"),meta:{...h||{},arg:l,requestId:c,rejectedWithValue:!!p,requestStatus:"rejected",aborted:u?.name==="AbortError",condition:u?.name==="ConditionError"}}));function s(u){return (c,l,p)=>{let h=n?.idGenerator?n.idGenerator(u):vs(),d=new AbortController,y,v;function C(k){v=k,d.abort();}let P=async function(){let k;try{let V=n?.condition?.(u,{getState:l,extra:p});if(vp(V)&&(V=await V),V===!1||d.signal.aborted)throw {name:"ConditionError",message:"Aborted due to condition callback returning false."};let $=new Promise((U,H)=>{y=()=>{H({name:"AbortError",message:v||"Aborted"});},d.signal.addEventListener("abort",y);});c(i(h,u,n?.getPendingMeta?.({requestId:h,arg:u},{getState:l,extra:p}))),k=await Promise.race([$,Promise.resolve(r(u,{dispatch:c,getState:l,extra:p,requestId:h,signal:d.signal,abort:C,rejectWithValue:(U,H)=>new ri(U,H),fulfillWithValue:(U,H)=>new gs(U,H)})).then(U=>{if(U instanceof ri)throw U;return U instanceof gs?o(U.payload,h,u,U.meta):o(U,h,u)})]);}catch(V){k=V instanceof ri?a(null,h,u,V.payload,V.meta):a(V,h,u);}finally{y&&d.signal.removeEventListener("abort",y);}return n&&!n.dispatchConditionRejection&&a.match(k)&&k.meta.condition||c(k),k}();return Object.assign(P,{abort:C,requestId:h,arg:u,unwrap(){return P.then(Sp)}})}}return Object.assign(s,{pending:i,rejected:a,fulfilled:o,settled:gp(a,o),typePrefix:t})}return e.withTypes=()=>e,e})();function Sp(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function vp(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var Ap=(e,t)=>{if(typeof e!="function")throw new Error(me(32))};var ni="listenerMiddleware";var Rp=e=>{let{type:t,actionCreator:r,matcher:n,predicate:o,effect:i}=e;if(t)o=g(t).match;else if(r)t=r.type,o=r.match;else if(n)o=n;else if(!o)throw new Error(me(21));return Ap(i),{predicate:o,type:t,effect:i}},bp=Object.assign(e=>{let{type:t,predicate:r,effect:n}=Rp(e);return {id:vs(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(me(22))}}},{withTypes:()=>bp});var xp=Object.assign(g(`${ni}/add`),{withTypes:()=>xp});g(`${ni}/removeAll`);var wp=Object.assign(g(`${ni}/remove`),{withTypes:()=>wp});function me(e){return `Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var w=new A({required:!0,emptyAllowed:!1}),X=new A({required:!1,emptyAllowed:!1}),ie=new A({required:!0,emptyAllowed:!0});new A({required:!1,emptyAllowed:!0});var bs=new z({each:w,required:!0}),xs=new A({required:!1,emptyAllowed:!1,regex:/^\d+\.\d+\.\d+$/}),We=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),Re=(e,t)=>{if("required"in t)return {payload:new le({value:t}).validate({value:e}).value};let o=new F({options:{required:!0},values:t}).validate(e);if(o)throw new dr(o);return {payload:e}},S=(e,t)=>{try{return Re(e,t)}catch(r){return {payload:e,error:We(r)}}},Ps=(e,t,r,n)=>{let o=`Check the options of ${n}`;return Es(e,t,r,o,"Controller initialization error")},Es=(e,t,r,n,o)=>{try{return t.validate(r,n)}catch(i){throw e.logger.error(i,o),i}};var Mt="2.63.3",Fs=["@coveo/atomic","@coveo/quantic"];var oi=()=>X,Is=()=>w,it=g("configuration/updateBasicConfiguration",e=>S(e,{accessToken:X,organizationId:X,platformUrl:X})),Me=g("configuration/updateSearchConfiguration",e=>S(e,{apiBaseUrl:X,pipeline:new A({required:!1,emptyAllowed:!0}),searchHub:X,timezone:X,locale:X,authenticationProviders:new z({required:!1,each:w})})),Pp={enabled:new M({default:!0}),originContext:oi(),originLevel2:oi(),originLevel3:oi(),apiBaseUrl:X,nextApiBaseUrl:X,runtimeEnvironment:new Y,anonymous:new M({default:!1}),deviceId:X,userDisplayName:X,documentLocation:X,trackingId:X,analyticsMode:new A({constrainTo:["legacy","next"],required:!1,default:"legacy"}),source:new F({options:{required:!1},values:Fs.reduce((e,t)=>(e[t]=xs,e),{})})},Vt=g("configuration/updateAnalyticsConfiguration",e=>(zr()&&(e.enabled=!1),S(e,Pp))),_t=g("configuration/analytics/disable"),Lt=g("configuration/analytics/enable"),ln=g("configuration/analytics/originlevel2",e=>S(e,{originLevel2:Is()})),dn=g("configuration/analytics/originlevel3",e=>S(e,{originLevel3:Is()}));var ks={q:new A,enableQuerySyntax:new M,aq:new A,cq:new A,firstResult:new I({min:0}),numberOfResults:new I({min:0}),sortCriteria:new A,f:new F,fExcluded:new F,cf:new F,nf:new F,df:new F,debug:new M,sf:new F,tab:new A,af:new F};var at=g("searchParameters/restore",e=>S(e,ks));var pn=g("debug/enable"),mn=g("debug/disable");var fn=()=>!1;var gn=J(fn(),e=>{e.addCase(pn,()=>!0).addCase(mn,()=>!1).addCase(at,(t,r)=>r.payload.debug??t);});var Ut=g("pipeline/set",e=>S(e,new A({required:!0,emptyAllowed:!0})));var Ep=g("history/undo"),Fp=g("history/redo"),Ve=g("history/snapshot");W("history/back",async(e,{dispatch:t})=>{t(Ep()),await t(fe());});W("history/forward",async(e,{dispatch:t})=>{t(Fp()),await t(fe());});var fe=W("history/change",async(e,{getState:t})=>t().history.present);var jt=()=>"";var Bt=J(jt(),e=>{e.addCase(Ut,(t,r)=>r.payload).addCase(fe.fulfilled,(t,r)=>r.payload?.pipeline??t).addCase(Me,(t,r)=>r.payload.pipeline||t);});function Ye(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function m(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i);})}return new(r||(r=Promise))(function(i,a){function s(l){try{c(n.next(l));}catch(p){a(p);}}function u(l){try{c(n.throw(l));}catch(p){a(p);}}function c(l){l.done?i(l.value):o(l.value).then(s,u);}c((n=n.apply(e,t||[])).next());})}var _;(function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect";})(_||(_={}));function Os(){return typeof window<"u"}function Si(){return typeof navigator<"u"}function $t(){return typeof document<"u"}function ai(){try{return typeof localStorage<"u"}catch{return !1}}function Ip(){try{return typeof sessionStorage<"u"}catch{return !1}}function $s(){return Si()&&navigator.cookieEnabled}var kp=[_.click,_.custom,_.search,_.view],Op=(e,t)=>kp.indexOf(e)!==-1?Object.assign({language:$t()?document.documentElement.lang:"unknown",userAgent:Si()?navigator.userAgent:"unknown"},t):t,wr=class e{static set(t,r,n){var o,i,a,s;n&&(i=new Date,i.setTime(i.getTime()+n)),s=window.location.hostname,s.indexOf(".")===-1?Ts(t,r,i):(a=s.split("."),o=a[a.length-2]+"."+a[a.length-1],Ts(t,r,i,o));}static get(t){for(var r=t+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){var i=n[o];if(i=i.replace(/^\s+/,""),i.lastIndexOf(r,0)===0)return i.substring(r.length,i.length)}return null}static erase(t){e.set(t,"",-1);}};function Ts(e,t,r,n){document.cookie=`${e}=${t}`+(r?`;expires=${r.toUTCString()}`:"")+(n?`;domain=${n}`:"")+";path=/;SameSite=Lax";}function Tp(){return ai()?localStorage:$s()?new Pr:Ip()?sessionStorage:new zt}var Pr=class e{getItem(t){return wr.get(`${e.prefix}${t}`)}removeItem(t){wr.erase(`${e.prefix}${t}`);}setItem(t,r,n){wr.set(`${e.prefix}${t}`,r,n);}};Pr.prefix="coveo_";var si=class{constructor(){this.cookieStorage=new Pr;}getItem(t){return localStorage.getItem(t)||this.cookieStorage.getItem(t)}removeItem(t){this.cookieStorage.removeItem(t),localStorage.removeItem(t);}setItem(t,r){localStorage.setItem(t,r),this.cookieStorage.setItem(t,r,31556926e3);}},zt=class{getItem(t){return null}removeItem(t){}setItem(t,r){}},br="__coveo.analytics.history",Qs=20,zs=1e3*60,Hs=75,Ht=class{constructor(t){this.store=t||Tp();}addElement(t){t.internalTime=new Date().getTime(),t=this.cropQueryElement(this.stripEmptyQuery(t));let r=this.getHistoryWithInternalTime();r!=null?this.isValidEntry(t)&&this.setHistory([t].concat(r)):this.setHistory([t]);}addElementAsync(t){return m(this,void 0,void 0,function*(){t.internalTime=new Date().getTime(),t=this.cropQueryElement(this.stripEmptyQuery(t));let r=yield this.getHistoryWithInternalTimeAsync();r!=null?this.isValidEntry(t)&&this.setHistory([t].concat(r)):this.setHistory([t]);})}getHistory(){let t=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(t))}getHistoryAsync(){return m(this,void 0,void 0,function*(){let t=yield this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(t))})}getHistoryWithInternalTime(){try{let t=this.store.getItem(br);return t&&typeof t=="string"?JSON.parse(t):[]}catch{return []}}getHistoryWithInternalTimeAsync(){return m(this,void 0,void 0,function*(){try{let t=yield this.store.getItem(br);return t?JSON.parse(t):[]}catch{return []}})}setHistory(t){try{this.store.setItem(br,JSON.stringify(t.slice(0,Qs)));}catch{}}clear(){try{this.store.removeItem(br);}catch{}}getMostRecentElement(){let t=this.getHistoryWithInternalTime();return Array.isArray(t)?t.sort((n,o)=>(o.internalTime||0)-(n.internalTime||0))[0]:null}cropQueryElement(t){return t.name&&t.value&&t.name.toLowerCase()==="query"&&(t.value=t.value.slice(0,Hs)),t}isValidEntry(t){let r=this.getMostRecentElement();return r&&r.value==t.value?(t.internalTime||0)-(r.internalTime||0)>zs:!0}stripInternalTime(t){return Array.isArray(t)?t.map(r=>{let{name:n,time:o,value:i}=r;return {name:n,time:o,value:i}}):[]}stripEmptyQuery(t){let{name:r,time:n,value:o}=t;return r&&typeof o=="string"&&r.toLowerCase()==="query"&&o.trim()===""?{name:r,time:n}:t}stripEmptyQueries(t){return t.map(r=>this.stripEmptyQuery(r))}},Ws=Object.freeze({__proto__:null,HistoryStore:Ht,MAX_NUMBER_OF_HISTORY_ELEMENTS:Qs,MAX_VALUE_SIZE:Hs,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:zs,STORE_KEY:br,default:Ht}),Dp=(e,t)=>m(void 0,void 0,void 0,function*(){return e===_.view?(yield qp(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t}),qp=e=>m(void 0,void 0,void 0,function*(){let t=new Ht,r={name:"PageView",value:e,time:new Date().toISOString()};yield t.addElementAsync(r);}),hn,Np=new Uint8Array(16);function Mp(){if(!hn&&(hn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!hn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return hn(Np)}var Vp=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Sn(e){return typeof e=="string"&&Vp.test(e)}var ae=[];for(let e=0;e<256;++e)ae.push((e+256).toString(16).slice(1));function Ys(e,t=0){return (ae[e[t+0]]+ae[e[t+1]]+ae[e[t+2]]+ae[e[t+3]]+"-"+ae[e[t+4]]+ae[e[t+5]]+"-"+ae[e[t+6]]+ae[e[t+7]]+"-"+ae[e[t+8]]+ae[e[t+9]]+"-"+ae[e[t+10]]+ae[e[t+11]]+ae[e[t+12]]+ae[e[t+13]]+ae[e[t+14]]+ae[e[t+15]]).toLowerCase()}function _p(e){if(!Sn(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}function Lp(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var Up="6ba7b810-9dad-11d1-80b4-00c04fd430c8",jp="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Bp(e,t,r){function n(o,i,a,s){var u;if(typeof o=="string"&&(o=Lp(o)),typeof i=="string"&&(i=_p(i)),((u=i)===null||u===void 0?void 0:u.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+o.length);if(c.set(i),c.set(o,i.length),c=r(c),c[6]=c[6]&15|t,c[8]=c[8]&63|128,a){s=s||0;for(let l=0;l<16;++l)a[s+l]=c[l];return a}return Ys(c)}try{n.name=e;}catch{}return n.DNS=Up,n.URL=jp,n}var $p=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ds={randomUUID:$p};function bt(e,t,r){if(Ds.randomUUID&&!t&&!e)return Ds.randomUUID();e=e||{};let n=e.random||(e.rng||Mp)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(let o=0;o<16;++o)t[r+o]=n[o];return t}return Ys(n)}function Qp(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function ii(e,t){return e<<t|e>>>32-t}function zp(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){let a=unescape(encodeURIComponent(e));e=[];for(let s=0;s<a.length;++s)e.push(a.charCodeAt(s));}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=e.length/4+2,o=Math.ceil(n/16),i=new Array(o);for(let a=0;a<o;++a){let s=new Uint32Array(16);for(let u=0;u<16;++u)s[u]=e[a*64+u*4]<<24|e[a*64+u*4+1]<<16|e[a*64+u*4+2]<<8|e[a*64+u*4+3];i[a]=s;}i[o-1][14]=(e.length-1)*8/Math.pow(2,32),i[o-1][14]=Math.floor(i[o-1][14]),i[o-1][15]=(e.length-1)*8&4294967295;for(let a=0;a<o;++a){let s=new Uint32Array(80);for(let d=0;d<16;++d)s[d]=i[a][d];for(let d=16;d<80;++d)s[d]=ii(s[d-3]^s[d-8]^s[d-14]^s[d-16],1);let u=r[0],c=r[1],l=r[2],p=r[3],h=r[4];for(let d=0;d<80;++d){let y=Math.floor(d/20),v=ii(u,5)+Qp(y,c,l,p)+h+t[y]+s[d]>>>0;h=p,p=l,l=ii(c,30)>>>0,c=u,u=v;}r[0]=r[0]+u>>>0,r[1]=r[1]+c>>>0,r[2]=r[2]+l>>>0,r[3]=r[3]+p>>>0,r[4]=r[4]+h>>>0;}return [r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var Hp=Bp("v5",80,zp),qs=Hp,Gs="2.30.2",xr={pageview:"pageview",event:"event"},st=class e{constructor(t,r){if(!Sn(t))throw Error("Not a valid uuid");this.clientId=t,this.creationDate=Math.floor(r/1e3);}toString(){return this.clientId.replace(/-/g,"")+"."+this.creationDate.toString()}get expired(){let t=Math.floor(Date.now()/1e3)-this.creationDate;return t<0||t>e.expirationTime}validate(t,r){return !this.expired&&this.matchReferrer(t,r)}matchReferrer(t,r){try{let n=new URL(t);return r.some(o=>new RegExp(o.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(n.host))}catch{return !1}}static fromString(t){let r=t.split(".");if(r.length!==2)return null;let[n,o]=r;if(n.length!==32||isNaN(parseInt(o)))return null;let i=n.substring(0,8)+"-"+n.substring(8,12)+"-"+n.substring(12,16)+"-"+n.substring(16,20)+"-"+n.substring(20,32);return Sn(i)?new e(i,Number.parseInt(o)*1e3):null}};st.cvo_cid="cvo_cid";st.expirationTime=120;var be=Object.keys;function yn(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}var li={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},Wp=be(li).map(e=>li[e]),Yp=[...Wp].join("|"),Gp=new RegExp(`^(${Yp}$)`),Kp={svcAction:"svc_action",svcActionData:"svc_action_data"},Xp=e=>Gp.test(e),Zp=[Xp],Ms={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},Vs={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr",group:"group"},se={action:"pa",list:"pal",listSource:"pls"},Cn={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},em=["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit"],di={id:"quoteId",affiliation:"quoteAffiliation"},pi={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},tm={add:se,bookmark_add:se,bookmark_remove:se,click:se,checkout:se,checkout_option:se,detail:se,impression:se,remove:se,refund:Object.assign(Object.assign({},se),Cn),purchase:Object.assign(Object.assign({},se),Cn),quickview:se,quote:Object.assign(Object.assign({},se),di),review:Object.assign(Object.assign({},se),pi)},rm=be(Ms).map(e=>Ms[e]),nm=be(Vs).map(e=>Vs[e]),om=be(se).map(e=>se[e]),im=be(Cn).map(e=>Cn[e]),am=be(pi).map(e=>pi[e]),sm=be(di).map(e=>di[e]),cm=[...rm,"custom"].join("|"),um=[...nm,"custom"].join("|"),Ks="(pr[0-9]+)",Js="(il[0-9]+pi[0-9]+)",lm=new RegExp(`^${Ks}(${cm})$`),dm=new RegExp(`^(${Js}(${um}))|(il[0-9]+nm)$`),pm=new RegExp(`^(${om.join("|")})$`),mm=new RegExp(`^(${im.join("|")})$`),fm=new RegExp(`^${Ks}custom$`),gm=new RegExp(`^${Js}custom$`),hm=new RegExp(`^(${[...em,...am,...sm].join("|")})$`),ym=e=>lm.test(e),Sm=e=>dm.test(e),vm=e=>pm.test(e),Cm=e=>mm.test(e),Am=e=>hm.test(e),Rm=[Sm,ym,vm,Cm,Am],bm=[fm,gm],xm={anonymizeIp:"aip"},wm={eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"},Pm={hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"},Em=["contentId","contentIdKey","contentType","searchHub","tab","searchUid","permanentId","contentLocale","trackingId"],Fm=Object.assign(Object.assign(Object.assign(Object.assign({},xm),wm),Pm),Em.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:t}),{})),mi=Object.assign(Object.assign({},Fm),Kp),Im=e=>{let t=!!e.action&&tm[e.action]||{};return be(e).reduce((r,n)=>{let o=t[n]||mi[n]||n;return Object.assign(Object.assign({},r),{[o]:e[n]})},{})},km=be(mi).map(e=>mi[e]),Om=e=>km.indexOf(e)!==-1,Tm=e=>e==="custom",Dm=e=>[...Rm,...Zp,Om,Tm].some(t=>t(e)),qm=e=>be(e).reduce((t,r)=>{let n=Nm(r);return n?Object.assign(Object.assign({},t),Mm(n,e[r])):Object.assign(Object.assign({},t),{[r]:e[r]})},{}),Nm=e=>{let t;return [...bm].every(r=>{var n;return t=(n=r.exec(e))===null||n===void 0?void 0:n[1],!t}),t},Mm=(e,t)=>be(t).reduce((r,n)=>Object.assign(Object.assign({},r),{[`${e}${n}`]:t[n]}),{}),fi=class{constructor(t){this.opts=t;}sendEvent(t,r){return m(this,void 0,void 0,function*(){if(!this.isAvailable())throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');let{baseUrl:n,preprocessRequest:o}=this.opts,i=yield this.getQueryParamsForEventType(t),{url:a,payload:s}=yield this.preProcessRequestAsPotentialJSONString(`${n}/analytics/${t}?${i}`,r,o),u=this.encodeForEventType(t,s),c=new Blob([u],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(a,c);})}isAvailable(){return "sendBeacon"in navigator}deleteHttpCookieVisitorId(){return Promise.resolve()}preProcessRequestAsPotentialJSONString(t,r,n){return m(this,void 0,void 0,function*(){let o=t,i=r;if(n){let a=yield n({url:t,body:JSON.stringify(r)},"analyticsBeacon"),{url:s,body:u}=a;o=s||t;try{i=JSON.parse(u);}catch(c){console.error("Unable to process the request body as a JSON string",c);}}return {payload:i,url:o}})}encodeForEventType(t,r){return this.isEventTypeLegacy(t)?this.encodeEventToJson(t,r):this.encodeEventToJson(t,r,this.opts.token)}getQueryParamsForEventType(t){return m(this,void 0,void 0,function*(){let{token:r,visitorIdProvider:n}=this.opts,o=yield n.getCurrentVisitorId();return [r&&this.isEventTypeLegacy(t)?`access_token=${r}`:"",o?`visitorId=${o}`:"","discardVisitInfo=true"].filter(i=>!!i).join("&")})}isEventTypeLegacy(t){return [_.click,_.custom,_.search,_.view].indexOf(t)!==-1}encodeEventToJson(t,r,n){let o=`${t}Event=${encodeURIComponent(JSON.stringify(r))}`;return n&&(o=`access_token=${encodeURIComponent(n)}&${o}`),o}},gi=class{sendEvent(t,r){return m(this,void 0,void 0,function*(){return Promise.resolve()})}deleteHttpCookieVisitorId(){return m(this,void 0,void 0,function*(){return Promise.resolve()})}},_s=window.fetch,An=class{constructor(t){this.opts=t;}sendEvent(t,r){return m(this,void 0,void 0,function*(){let{baseUrl:n,visitorIdProvider:o,preprocessRequest:i}=this.opts,a=this.shouldAppendVisitorId(t)?yield this.getVisitorIdParam():"",s={url:`${n}/analytics/${t}${a}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(r)},u=Object.assign(Object.assign({},s),i?yield i(s,"analyticsFetch"):{}),{url:c}=u,l=Ye(u,["url"]),p;try{p=yield _s(c,l);}catch(h){console.error("An error has occured when sending the event.",h);return}if(p.ok){let h=yield p.json();return h.visitorId&&o.setCurrentVisitorId(h.visitorId),h}else {try{p.json();}catch{}throw console.error(`An error has occured when sending the "${t}" event.`,p,r),new Error(`An error has occurred when sending the "${t}" event. Check the console logs for more details.`)}})}deleteHttpCookieVisitorId(){return m(this,void 0,void 0,function*(){let{baseUrl:t}=this.opts,r=`${t}/analytics/visit`;yield _s(r,{headers:this.getHeaders(),method:"DELETE"});})}shouldAppendVisitorId(t){return [_.click,_.custom,_.search,_.view].indexOf(t)!==-1}getVisitorIdParam(){return m(this,void 0,void 0,function*(){let{visitorIdProvider:t}=this.opts,r=yield t.getCurrentVisitorId();return r?`?visitor=${r}`:""})}getHeaders(){let{token:t}=this.opts;return Object.assign(Object.assign({},t?{Authorization:`Bearer ${t}`}:{}),{"Content-Type":"application/json"})}},hi=class{constructor(t,r){ai()&&$s()?this.storage=new si:ai()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new zt),this.client=new An(t),this.beaconClient=new fi(t),window.addEventListener("beforeunload",()=>{let n=r();for(let{eventType:o,payload:i}of n)this.beaconClient.sendEvent(o,i);});}getClientDependingOnEventType(t){return t==="click"&&this.beaconClient.isAvailable()?this.beaconClient:this.client}},yi=class{constructor(t,r){this.storage=r||new zt,this.client=new An(t);}getClientDependingOnEventType(t){return this.client}},Rn=class{constructor(){this.storage=new zt,this.client=new gi;}getClientDependingOnEventType(t){return this.client}},Vm="xx",_m=e=>e?.startsWith(Vm)||!1,Lm=`
        We've detected you're using React Native but have not provided the corresponding runtime, 
        for an optimal experience please use the "coveo.analytics/react-native" subpackage.
        Follow the Readme on how to set it up: https://github.com/coveo/coveo.analytics.js#using-react-native
    `;function Um(){return typeof navigator<"u"&&navigator.product=="ReactNative"}var jm=["1",1,"yes",!0];function bn(){return Si()&&[navigator.globalPrivacyControl,navigator.doNotTrack,navigator.msDoNotTrack,window.doNotTrack].some(e=>jm.indexOf(e)!==-1)}var Xs="v15",Zs={default:"https://analytics.cloud.coveo.com/rest/ua",production:"https://analytics.cloud.coveo.com/rest/ua",hipaa:"https://analyticshipaa.cloud.coveo.com/rest/ua"};function Bm(e=Zs.default,t=Xs,r=!1){if(e=e.replace(/\/$/,""),r)return `${e}/${t}`;let n=e.endsWith("/rest")||e.endsWith("/rest/ua");return `${e}${n?"":"/rest"}/${t}`}var $m="38824e1f-37f5-42d3-8372-a4b8fa9df946",Ke=class{get defaultOptions(){return {endpoint:Zs.default,isCustomEndpoint:!1,token:"",version:Xs,beforeSendHooks:[],afterSendHooks:[]}}get version(){return Gs}constructor(t){if(this.acceptedLinkReferrers=[],!t)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),t),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[Dp,Op].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};let r={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};bn()?this.runtime=new Rn:this.runtime=this.options.runtimeEnvironment||this.initRuntime(r),this.addEventTypeMapping(_.view,{newEventType:_.view,addClientIdParameter:!0}),this.addEventTypeMapping(_.click,{newEventType:_.click,addClientIdParameter:!0}),this.addEventTypeMapping(_.custom,{newEventType:_.custom,addClientIdParameter:!0}),this.addEventTypeMapping(_.search,{newEventType:_.search,addClientIdParameter:!0});}initRuntime(t){return Os()&&$t()?new hi(t,()=>{let r=[...this.bufferedRequests];return this.bufferedRequests=[],r}):(Um()&&console.warn(Lm),new yi(t))}get storage(){return this.runtime.storage}determineVisitorId(){return m(this,void 0,void 0,function*(){try{return Os()&&this.extractClientIdFromLink(window.location.href)||(yield this.storage.getItem("visitorId"))||bt()}catch(t){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",t),bt()}})}getCurrentVisitorId(){return m(this,void 0,void 0,function*(){if(!this.visitorId){let t=yield this.determineVisitorId();yield this.setCurrentVisitorId(t);}return this.visitorId})}setCurrentVisitorId(t){return m(this,void 0,void 0,function*(){this.visitorId=t,yield this.storage.setItem("visitorId",t);})}setClientId(t,r){return m(this,void 0,void 0,function*(){if(Sn(t))this.setCurrentVisitorId(t.toLowerCase());else {if(!r)throw Error("Cannot generate uuid client id without a specific namespace string.");this.setCurrentVisitorId(qs(t,qs(r,$m)));}})}getParameters(t,...r){return m(this,void 0,void 0,function*(){return yield this.resolveParameters(t,...r)})}getPayload(t,...r){return m(this,void 0,void 0,function*(){let n=yield this.resolveParameters(t,...r);return yield this.resolvePayloadForParameters(t,n)})}get currentVisitorId(){return typeof(this.visitorId||this.storage.getItem("visitorId"))!="string"&&this.setCurrentVisitorId(bt()),this.visitorId}set currentVisitorId(t){this.visitorId=t,this.storage.setItem("visitorId",t);}extractClientIdFromLink(t){if(bn())return null;try{let r=new URL(t).searchParams.get(st.cvo_cid);if(r==null)return null;let n=st.fromString(r);return !n||!$t()||!n.validate(document.referrer,this.acceptedLinkReferrers)?null:n.clientId}catch{}return null}resolveParameters(t,...r){return m(this,void 0,void 0,function*(){let{variableLengthArgumentsNames:n=[],addVisitorIdParameter:o=!1,usesMeasurementProtocol:i=!1,addClientIdParameter:a=!1}=this.eventTypeMapping[t]||{};return yield [d=>n.length>0?this.parseVariableArgumentsPayload(n,d):d[0],d=>m(this,void 0,void 0,function*(){return Object.assign(Object.assign({},d),{visitorId:o?yield this.getCurrentVisitorId():""})}),d=>m(this,void 0,void 0,function*(){return a?Object.assign(Object.assign({},d),{clientId:yield this.getCurrentVisitorId()}):d}),d=>i?this.ensureAnonymousUserWhenUsingApiKey(d):d,d=>this.beforeSendHooks.reduce((y,v)=>m(this,void 0,void 0,function*(){let C=yield y;return yield v(t,C)}),d)].reduce((d,y)=>m(this,void 0,void 0,function*(){let v=yield d;return yield y(v)}),Promise.resolve(r))})}resolvePayloadForParameters(t,r){return m(this,void 0,void 0,function*(){let{usesMeasurementProtocol:n=!1}=this.eventTypeMapping[t]||{};return yield [p=>this.setTrackingIdIfTrackingIdNotPresent(p),p=>this.removeEmptyPayloadValues(p,t),p=>this.validateParams(p,t),p=>n?Im(p):p,p=>n?this.removeUnknownParameters(p):p,p=>n?this.processCustomParameters(p):this.mapCustomParametersToCustomData(p)].reduce((p,h)=>m(this,void 0,void 0,function*(){let d=yield p;return yield h(d)}),Promise.resolve(r))})}makeEvent(t,...r){return m(this,void 0,void 0,function*(){let{newEventType:n=t}=this.eventTypeMapping[t]||{},o=yield this.resolveParameters(t,...r),i=yield this.resolvePayloadForParameters(t,o);return {eventType:n,payload:i,log:a=>m(this,void 0,void 0,function*(){return this.bufferedRequests.push({eventType:n,payload:Object.assign(Object.assign({},i),a)}),yield Promise.all(this.afterSendHooks.map(s=>s(t,Object.assign(Object.assign({},o),a)))),yield this.deferExecution(),yield this.sendFromBuffer()})}})}sendEvent(t,...r){return m(this,void 0,void 0,function*(){return (yield this.makeEvent(t,...r)).log({})})}deferExecution(){return new Promise(t=>setTimeout(t,0))}sendFromBuffer(){return m(this,void 0,void 0,function*(){let t=this.bufferedRequests.shift();if(t){let{eventType:r,payload:n}=t;return this.runtime.getClientDependingOnEventType(r).sendEvent(r,n)}})}clear(){this.storage.removeItem("visitorId"),new Ht().clear();}deleteHttpOnlyVisitorId(){this.runtime.client.deleteHttpCookieVisitorId();}makeSearchEvent(t){return m(this,void 0,void 0,function*(){return this.makeEvent(_.search,t)})}sendSearchEvent(t){var{searchQueryUid:r}=t,n=Ye(t,["searchQueryUid"]);return m(this,void 0,void 0,function*(){return (yield this.makeSearchEvent(n)).log({searchQueryUid:r})})}makeClickEvent(t){return m(this,void 0,void 0,function*(){return this.makeEvent(_.click,t)})}sendClickEvent(t){var{searchQueryUid:r}=t,n=Ye(t,["searchQueryUid"]);return m(this,void 0,void 0,function*(){return (yield this.makeClickEvent(n)).log({searchQueryUid:r})})}makeCustomEvent(t){return m(this,void 0,void 0,function*(){return this.makeEvent(_.custom,t)})}sendCustomEvent(t){var{lastSearchQueryUid:r}=t,n=Ye(t,["lastSearchQueryUid"]);return m(this,void 0,void 0,function*(){return (yield this.makeCustomEvent(n)).log({lastSearchQueryUid:r})})}makeViewEvent(t){return m(this,void 0,void 0,function*(){return this.makeEvent(_.view,t)})}sendViewEvent(t){return m(this,void 0,void 0,function*(){return (yield this.makeViewEvent(t)).log({})})}getVisit(){return m(this,void 0,void 0,function*(){let r=yield (yield fetch(`${this.baseUrl}/analytics/visit`)).json();return this.visitorId=r.visitorId,r})}getHealth(){return m(this,void 0,void 0,function*(){return yield (yield fetch(`${this.baseUrl}/analytics/monitoring/health`)).json()})}registerBeforeSendEventHook(t){this.beforeSendHooks.push(t);}registerAfterSendEventHook(t){this.afterSendHooks.push(t);}addEventTypeMapping(t,r){this.eventTypeMapping[t]=r;}setAcceptedLinkReferrers(t){if(Array.isArray(t)&&t.every(r=>typeof r=="string"))this.acceptedLinkReferrers=t;else throw Error("Parameter should be an array of domain strings")}parseVariableArgumentsPayload(t,r){let n={};for(let o=0,i=r.length;o<i;o++){let a=r[o];if(typeof a=="string")n[t[o]]=a;else if(typeof a=="object")return Object.assign(Object.assign({},n),a)}return n}isKeyAllowedEmpty(t,r){return ({[_.search]:["queryText"]}[t]||[]).indexOf(r)!==-1}removeEmptyPayloadValues(t,r){let n=o=>typeof o<"u"&&o!==null&&o!=="";return Object.keys(t).filter(o=>this.isKeyAllowedEmpty(r,o)||n(t[o])).reduce((o,i)=>Object.assign(Object.assign({},o),{[i]:t[i]}),{})}removeUnknownParameters(t){return Object.keys(t).filter(n=>{if(Dm(n))return !0;console.log(n,"is not processed by coveoua");}).reduce((n,o)=>Object.assign(Object.assign({},n),{[o]:t[o]}),{})}processCustomParameters(t){let{custom:r}=t,n=Ye(t,["custom"]),o={};r&&yn(r)&&(o=this.lowercaseKeys(r));let i=qm(n);return Object.assign(Object.assign({},o),i)}mapCustomParametersToCustomData(t){let{custom:r}=t,n=Ye(t,["custom"]);if(r&&yn(r)){let o=this.lowercaseKeys(r);return Object.assign(Object.assign({},n),{customData:Object.assign(Object.assign({},o),t.customData)})}else return t}lowercaseKeys(t){let r=Object.keys(t),n={};return r.forEach(o=>{n[o.toLowerCase()]=t[o];}),n}validateParams(t,r){let{anonymizeIp:n}=t,o=Ye(t,["anonymizeIp"]);return n!==void 0&&["0","false","undefined","null","{}","[]",""].indexOf(`${n}`.toLowerCase())==-1&&(o.anonymizeIp=1),(r==_.view||r==_.click||r==_.search||r==_.custom)&&(o.originLevel3=this.limit(o.originLevel3,128)),r==_.view&&(o.location=this.limit(o.location,128)),(r=="pageview"||r=="event")&&(o.referrer=this.limit(o.referrer,2048),o.location=this.limit(o.location,2048),o.page=this.limit(o.page,2048)),o}ensureAnonymousUserWhenUsingApiKey(t){let{userId:r}=t,n=Ye(t,["userId"]);return _m(this.options.token)&&!r?(n.userId="anonymous",n):t}setTrackingIdIfTrackingIdNotPresent(t){let{trackingId:r}=t,n=Ye(t,["trackingId"]);return r?t:(n.hasOwnProperty("custom")&&yn(n.custom)&&(n.custom.hasOwnProperty("context_website")||n.custom.hasOwnProperty("siteName"))&&(n.trackingId=n.custom.context_website||n.custom.siteName),n.hasOwnProperty("customData")&&yn(n.customData)&&(n.customData.hasOwnProperty("context_website")||n.customData.hasOwnProperty("siteName"))&&(n.trackingId=n.customData.context_website||n.customData.siteName),n)}limit(t,r){return typeof t!="string"?t:t.substring(0,r)}get baseUrl(){return Bm(this.options.endpoint,this.options.version,this.options.isCustomEndpoint)}},Ge;(function(e){e.contextChanged="contextChanged",e.expandToFullUI="expandToFullUI",e.openUserActions="openUserActions",e.showPrecedingSessions="showPrecedingSessions",e.showFollowingSessions="showFollowingSessions",e.clickViewedDocument="clickViewedDocument",e.clickPageView="clickPageView",e.createArticle="createArticle";})(Ge||(Ge={}));var f;(function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.undoTriggerQuery="undoQuery",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.staticFilterClearAll="staticFilterClearAll",e.staticFilterSelect="staticFilterSelect",e.staticFilterDeselect="staticFilterDeselect",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",e.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",e.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",e.openSmartSnippetSource="openSmartSnippetSource",e.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",e.openSmartSnippetInlineLink="openSmartSnippetInlineLink",e.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",e.recentQueryClick="recentQueriesClick",e.clearRecentQueries="clearRecentQueries",e.recentResultClick="recentResultClick",e.clearRecentResults="clearRecentResults",e.noResultsBack="noResultsBack",e.showMoreFoldedResults="showMoreFoldedResults",e.showLessFoldedResults="showLessFoldedResults",e.copyToClipboard="copyToClipboard",e.caseSendEmail="Case.SendEmail",e.feedItemTextPost="FeedItem.TextPost",e.caseAttach="caseAttach",e.caseDetach="caseDetach",e.retryGeneratedAnswer="retryGeneratedAnswer",e.likeGeneratedAnswer="likeGeneratedAnswer",e.dislikeGeneratedAnswer="dislikeGeneratedAnswer",e.openGeneratedAnswerSource="openGeneratedAnswerSource",e.generatedAnswerStreamEnd="generatedAnswerStreamEnd",e.generatedAnswerSourceHover="generatedAnswerSourceHover",e.generatedAnswerCopyToClipboard="generatedAnswerCopyToClipboard",e.generatedAnswerHideAnswers="generatedAnswerHideAnswers",e.generatedAnswerShowAnswers="generatedAnswerShowAnswers",e.generatedAnswerExpand="generatedAnswerExpand",e.generatedAnswerCollapse="generatedAnswerCollapse",e.generatedAnswerFeedbackSubmit="generatedAnswerFeedbackSubmit",e.rephraseGeneratedAnswer="rephraseGeneratedAnswer";})(f||(f={}));var Ls={[f.triggerNotify]:"queryPipelineTriggers",[f.triggerExecute]:"queryPipelineTriggers",[f.triggerQuery]:"queryPipelineTriggers",[f.triggerRedirect]:"queryPipelineTriggers",[f.queryError]:"errors",[f.queryErrorBack]:"errors",[f.queryErrorClear]:"errors",[f.queryErrorRetry]:"errors",[f.pagerNext]:"getMoreResults",[f.pagerPrevious]:"getMoreResults",[f.pagerNumber]:"getMoreResults",[f.pagerResize]:"getMoreResults",[f.pagerScrolling]:"getMoreResults",[f.facetSearch]:"facet",[f.facetShowLess]:"facet",[f.facetShowMore]:"facet",[f.recommendation]:"recommendation",[f.likeSmartSnippet]:"smartSnippet",[f.dislikeSmartSnippet]:"smartSnippet",[f.expandSmartSnippet]:"smartSnippet",[f.collapseSmartSnippet]:"smartSnippet",[f.openSmartSnippetFeedbackModal]:"smartSnippet",[f.closeSmartSnippetFeedbackModal]:"smartSnippet",[f.sendSmartSnippetReason]:"smartSnippet",[f.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[f.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions",[f.showMoreSmartSnippetSuggestion]:"smartSnippetSuggestions",[f.showLessSmartSnippetSuggestion]:"smartSnippetSuggestions",[f.clearRecentQueries]:"recentQueries",[f.recentResultClick]:"recentlyClickedDocuments",[f.clearRecentResults]:"recentlyClickedDocuments",[f.showLessFoldedResults]:"folding",[f.caseDetach]:"case",[f.likeGeneratedAnswer]:"generatedAnswer",[f.dislikeGeneratedAnswer]:"generatedAnswer",[f.openGeneratedAnswerSource]:"generatedAnswer",[f.generatedAnswerStreamEnd]:"generatedAnswer",[f.generatedAnswerSourceHover]:"generatedAnswer",[f.generatedAnswerCopyToClipboard]:"generatedAnswer",[f.generatedAnswerHideAnswers]:"generatedAnswer",[f.generatedAnswerShowAnswers]:"generatedAnswer",[f.generatedAnswerExpand]:"generatedAnswer",[f.generatedAnswerCollapse]:"generatedAnswer",[f.generatedAnswerFeedbackSubmit]:"generatedAnswer",[Ge.expandToFullUI]:"interface",[Ge.openUserActions]:"User Actions",[Ge.showPrecedingSessions]:"User Actions",[Ge.showFollowingSessions]:"User Actions",[Ge.clickViewedDocument]:"User Actions",[Ge.clickPageView]:"User Actions",[Ge.createArticle]:"createArticle"},Wt=class{constructor(){this.runtime=new Rn,this.currentVisitorId="";}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}makeEvent(t){return Promise.resolve({eventType:t,payload:null,log:()=>Promise.resolve()})}sendEvent(){return Promise.resolve()}makeSearchEvent(){return this.makeEvent(_.search)}sendSearchEvent(){return Promise.resolve()}makeClickEvent(){return this.makeEvent(_.click)}sendClickEvent(){return Promise.resolve()}makeCustomEvent(){return this.makeEvent(_.custom)}sendCustomEvent(){return Promise.resolve()}makeViewEvent(){return this.makeEvent(_.view)}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}get version(){return Gs}};function Qm(e){let t="";return e.filter(r=>{let n=r!==t;return t=r,n})}function zm(e){return e.map(t=>t.replace(/;/g,""))}function ec(e){let r=e.join(";");return r.length<=256?r:ec(e.slice(1))}var Us=e=>{let t=zm(e),r=Qm(t);return ec(r)};function js(e){let t=typeof e.partialQueries=="string"?e.partialQueries:Us(e.partialQueries),r=typeof e.suggestions=="string"?e.suggestions:Us(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}var ct=class{constructor(t,r){this.opts=t,this.provider=r;let n=t.enableAnalytics===!1||bn();this.coveoAnalyticsClient=n?new Wt:new Ke(t);}disable(){this.coveoAnalyticsClient=new Wt;}enable(){this.coveoAnalyticsClient=new Ke(this.opts);}makeInterfaceLoad(){return this.makeSearchEvent(f.interfaceLoad)}logInterfaceLoad(){return m(this,void 0,void 0,function*(){return (yield this.makeInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationInterfaceLoad(){return this.makeSearchEvent(f.recommendationInterfaceLoad)}logRecommendationInterfaceLoad(){return m(this,void 0,void 0,function*(){return (yield this.makeRecommendationInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendation(){return this.makeCustomEvent(f.recommendation)}logRecommendation(){return m(this,void 0,void 0,function*(){return (yield this.makeRecommendation()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationOpen(t,r){return this.makeClickEvent(f.recommendationOpen,t,r)}logRecommendationOpen(t,r){return m(this,void 0,void 0,function*(){return (yield this.makeRecommendationOpen(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterClearAll(t){return this.makeSearchEvent(f.staticFilterClearAll,t)}logStaticFilterClearAll(t){return m(this,void 0,void 0,function*(){return (yield this.makeStaticFilterClearAll(t)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterSelect(t){return this.makeSearchEvent(f.staticFilterSelect,t)}logStaticFilterSelect(t){return m(this,void 0,void 0,function*(){return (yield this.makeStaticFilterSelect(t)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterDeselect(t){return this.makeSearchEvent(f.staticFilterDeselect,t)}logStaticFilterDeselect(t){return m(this,void 0,void 0,function*(){return (yield this.makeStaticFilterDeselect(t)).log({searchUID:this.provider.getSearchUID()})})}makeFetchMoreResults(){return this.makeCustomEvent(f.pagerScrolling,{type:"getMoreResults"})}logFetchMoreResults(){return m(this,void 0,void 0,function*(){return (yield this.makeFetchMoreResults()).log({searchUID:this.provider.getSearchUID()})})}makeInterfaceChange(t){return this.makeSearchEvent(f.interfaceChange,t)}logInterfaceChange(t){return m(this,void 0,void 0,function*(){return (yield this.makeInterfaceChange(t)).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanAutomatic(){return this.makeSearchEvent(f.didyoumeanAutomatic)}logDidYouMeanAutomatic(){return m(this,void 0,void 0,function*(){return (yield this.makeDidYouMeanAutomatic()).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanClick(){return this.makeSearchEvent(f.didyoumeanClick)}logDidYouMeanClick(){return m(this,void 0,void 0,function*(){return (yield this.makeDidYouMeanClick()).log({searchUID:this.provider.getSearchUID()})})}makeResultsSort(t){return this.makeSearchEvent(f.resultsSort,t)}logResultsSort(t){return m(this,void 0,void 0,function*(){return (yield this.makeResultsSort(t)).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxSubmit(){return this.makeSearchEvent(f.searchboxSubmit)}logSearchboxSubmit(){return m(this,void 0,void 0,function*(){return (yield this.makeSearchboxSubmit()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxClear(){return this.makeSearchEvent(f.searchboxClear)}logSearchboxClear(){return m(this,void 0,void 0,function*(){return (yield this.makeSearchboxClear()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxAsYouType(){return this.makeSearchEvent(f.searchboxAsYouType)}logSearchboxAsYouType(){return m(this,void 0,void 0,function*(){return (yield this.makeSearchboxAsYouType()).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbFacet(t){return this.makeSearchEvent(f.breadcrumbFacet,t)}logBreadcrumbFacet(t){return m(this,void 0,void 0,function*(){return (yield this.makeBreadcrumbFacet(t)).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbResetAll(){return this.makeSearchEvent(f.breadcrumbResetAll)}logBreadcrumbResetAll(){return m(this,void 0,void 0,function*(){return (yield this.makeBreadcrumbResetAll()).log({searchUID:this.provider.getSearchUID()})})}makeDocumentQuickview(t,r){return this.makeClickEvent(f.documentQuickview,t,r)}logDocumentQuickview(t,r){return m(this,void 0,void 0,function*(){return (yield this.makeDocumentQuickview(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeDocumentOpen(t,r){return this.makeClickEvent(f.documentOpen,t,r)}logDocumentOpen(t,r){return m(this,void 0,void 0,function*(){return (yield this.makeDocumentOpen(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxAnalytics(t){return this.makeSearchEvent(f.omniboxAnalytics,js(t))}logOmniboxAnalytics(t){return m(this,void 0,void 0,function*(){return (yield this.makeOmniboxAnalytics(t)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxFromLink(t){return this.makeSearchEvent(f.omniboxFromLink,js(t))}logOmniboxFromLink(t){return m(this,void 0,void 0,function*(){return (yield this.makeOmniboxFromLink(t)).log({searchUID:this.provider.getSearchUID()})})}makeSearchFromLink(){return this.makeSearchEvent(f.searchFromLink)}logSearchFromLink(){return m(this,void 0,void 0,function*(){return (yield this.makeSearchFromLink()).log({searchUID:this.provider.getSearchUID()})})}makeTriggerNotify(t){return this.makeCustomEvent(f.triggerNotify,t)}logTriggerNotify(t){return m(this,void 0,void 0,function*(){return (yield this.makeTriggerNotify(t)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerExecute(t){return this.makeCustomEvent(f.triggerExecute,t)}logTriggerExecute(t){return m(this,void 0,void 0,function*(){return (yield this.makeTriggerExecute(t)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerQuery(){return this.makeCustomEvent(f.triggerQuery,{query:this.provider.getSearchEventRequestPayload().queryText},"queryPipelineTriggers")}logTriggerQuery(){return m(this,void 0,void 0,function*(){return (yield this.makeTriggerQuery()).log({searchUID:this.provider.getSearchUID()})})}makeUndoTriggerQuery(t){return this.makeSearchEvent(f.undoTriggerQuery,t)}logUndoTriggerQuery(t){return m(this,void 0,void 0,function*(){return (yield this.makeUndoTriggerQuery(t)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerRedirect(t){return this.makeCustomEvent(f.triggerRedirect,Object.assign(Object.assign({},t),{query:this.provider.getSearchEventRequestPayload().queryText}))}logTriggerRedirect(t){return m(this,void 0,void 0,function*(){return (yield this.makeTriggerRedirect(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerResize(t){return this.makeCustomEvent(f.pagerResize,t)}logPagerResize(t){return m(this,void 0,void 0,function*(){return (yield this.makePagerResize(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerNumber(t){return this.makeCustomEvent(f.pagerNumber,t)}logPagerNumber(t){return m(this,void 0,void 0,function*(){return (yield this.makePagerNumber(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerNext(t){return this.makeCustomEvent(f.pagerNext,t)}logPagerNext(t){return m(this,void 0,void 0,function*(){return (yield this.makePagerNext(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerPrevious(t){return this.makeCustomEvent(f.pagerPrevious,t)}logPagerPrevious(t){return m(this,void 0,void 0,function*(){return (yield this.makePagerPrevious(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerScrolling(){return this.makeCustomEvent(f.pagerScrolling)}logPagerScrolling(){return m(this,void 0,void 0,function*(){return (yield this.makePagerScrolling()).log({searchUID:this.provider.getSearchUID()})})}makeFacetClearAll(t){return this.makeSearchEvent(f.facetClearAll,t)}logFacetClearAll(t){return m(this,void 0,void 0,function*(){return (yield this.makeFacetClearAll(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSearch(t){return this.makeSearchEvent(f.facetSearch,t)}logFacetSearch(t){return m(this,void 0,void 0,function*(){return (yield this.makeFacetSearch(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelect(t){return this.makeSearchEvent(f.facetSelect,t)}logFacetSelect(t){return m(this,void 0,void 0,function*(){return (yield this.makeFacetSelect(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetDeselect(t){return this.makeSearchEvent(f.facetDeselect,t)}logFacetDeselect(t){return m(this,void 0,void 0,function*(){return (yield this.makeFacetDeselect(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetExclude(t){return this.makeSearchEvent(f.facetExclude,t)}logFacetExclude(t){return m(this,void 0,void 0,function*(){return (yield this.makeFacetExclude(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUnexclude(t){return this.makeSearchEvent(f.facetUnexclude,t)}logFacetUnexclude(t){return m(this,void 0,void 0,function*(){return (yield this.makeFacetUnexclude(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelectAll(t){return this.makeSearchEvent(f.facetSelectAll,t)}logFacetSelectAll(t){return m(this,void 0,void 0,function*(){return (yield this.makeFacetSelectAll(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUpdateSort(t){return this.makeSearchEvent(f.facetUpdateSort,t)}logFacetUpdateSort(t){return m(this,void 0,void 0,function*(){return (yield this.makeFacetUpdateSort(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowMore(t){return this.makeCustomEvent(f.facetShowMore,t)}logFacetShowMore(t){return m(this,void 0,void 0,function*(){return (yield this.makeFacetShowMore(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowLess(t){return this.makeCustomEvent(f.facetShowLess,t)}logFacetShowLess(t){return m(this,void 0,void 0,function*(){return (yield this.makeFacetShowLess(t)).log({searchUID:this.provider.getSearchUID()})})}makeQueryError(t){return this.makeCustomEvent(f.queryError,t)}logQueryError(t){return m(this,void 0,void 0,function*(){return (yield this.makeQueryError(t)).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorBack(){return m(this,void 0,void 0,function*(){let t=yield this.makeCustomEvent(f.queryErrorBack);return {description:t.description,log:()=>m(this,void 0,void 0,function*(){return yield t.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(f.queryErrorBack)})}})}logQueryErrorBack(){return m(this,void 0,void 0,function*(){return (yield this.makeQueryErrorBack()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorRetry(){return m(this,void 0,void 0,function*(){let t=yield this.makeCustomEvent(f.queryErrorRetry);return {description:t.description,log:()=>m(this,void 0,void 0,function*(){return yield t.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(f.queryErrorRetry)})}})}logQueryErrorRetry(){return m(this,void 0,void 0,function*(){return (yield this.makeQueryErrorRetry()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorClear(){return m(this,void 0,void 0,function*(){let t=yield this.makeCustomEvent(f.queryErrorClear);return {description:t.description,log:()=>m(this,void 0,void 0,function*(){return yield t.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(f.queryErrorClear)})}})}logQueryErrorClear(){return m(this,void 0,void 0,function*(){return (yield this.makeQueryErrorClear()).log({searchUID:this.provider.getSearchUID()})})}makeLikeSmartSnippet(){return this.makeCustomEvent(f.likeSmartSnippet)}logLikeSmartSnippet(){return m(this,void 0,void 0,function*(){return (yield this.makeLikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeDislikeSmartSnippet(){return this.makeCustomEvent(f.dislikeSmartSnippet)}logDislikeSmartSnippet(){return m(this,void 0,void 0,function*(){return (yield this.makeDislikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippet(){return this.makeCustomEvent(f.expandSmartSnippet)}logExpandSmartSnippet(){return m(this,void 0,void 0,function*(){return (yield this.makeExpandSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippet(){return this.makeCustomEvent(f.collapseSmartSnippet)}logCollapseSmartSnippet(){return m(this,void 0,void 0,function*(){return (yield this.makeCollapseSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetFeedbackModal(){return this.makeCustomEvent(f.openSmartSnippetFeedbackModal)}logOpenSmartSnippetFeedbackModal(){return m(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeCloseSmartSnippetFeedbackModal(){return this.makeCustomEvent(f.closeSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return m(this,void 0,void 0,function*(){return (yield this.makeCloseSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeSmartSnippetFeedbackReason(t,r){return this.makeCustomEvent(f.sendSmartSnippetReason,{reason:t,details:r})}logSmartSnippetFeedbackReason(t,r){return m(this,void 0,void 0,function*(){return (yield this.makeSmartSnippetFeedbackReason(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippetSuggestion(t){return this.makeCustomEvent(f.expandSmartSnippetSuggestion,"documentId"in t?t:{documentId:t})}logExpandSmartSnippetSuggestion(t){return m(this,void 0,void 0,function*(){return (yield this.makeExpandSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippetSuggestion(t){return this.makeCustomEvent(f.collapseSmartSnippetSuggestion,"documentId"in t?t:{documentId:t})}logCollapseSmartSnippetSuggestion(t){return m(this,void 0,void 0,function*(){return (yield this.makeCollapseSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreSmartSnippetSuggestion(t){return this.makeCustomEvent(f.showMoreSmartSnippetSuggestion,t)}logShowMoreSmartSnippetSuggestion(t){return m(this,void 0,void 0,function*(){return (yield this.makeShowMoreSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessSmartSnippetSuggestion(t){return this.makeCustomEvent(f.showLessSmartSnippetSuggestion,t)}logShowLessSmartSnippetSuggestion(t){return m(this,void 0,void 0,function*(){return (yield this.makeShowLessSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSource(t,r){return this.makeClickEvent(f.openSmartSnippetSource,t,r)}logOpenSmartSnippetSource(t,r){return m(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetSource(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionSource(t,r){return this.makeClickEvent(f.openSmartSnippetSuggestionSource,t,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},r)}makeCopyToClipboard(t,r){return this.makeClickEvent(f.copyToClipboard,t,r)}logCopyToClipboard(t,r){return m(this,void 0,void 0,function*(){return (yield this.makeCopyToClipboard(t,r)).log({searchUID:this.provider.getSearchUID()})})}logOpenSmartSnippetSuggestionSource(t,r){return m(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetSuggestionSource(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetInlineLink(t,r){return this.makeClickEvent(f.openSmartSnippetInlineLink,t,{contentIDKey:r.contentIDKey,contentIDValue:r.contentIDValue},r)}logOpenSmartSnippetInlineLink(t,r){return m(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetInlineLink(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionInlineLink(t,r){return this.makeClickEvent(f.openSmartSnippetSuggestionInlineLink,t,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},r)}logOpenSmartSnippetSuggestionInlineLink(t,r){return m(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetSuggestionInlineLink(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeRecentQueryClick(){return this.makeSearchEvent(f.recentQueryClick)}logRecentQueryClick(){return m(this,void 0,void 0,function*(){return (yield this.makeRecentQueryClick()).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentQueries(){return this.makeCustomEvent(f.clearRecentQueries)}logClearRecentQueries(){return m(this,void 0,void 0,function*(){return (yield this.makeClearRecentQueries()).log({searchUID:this.provider.getSearchUID()})})}makeRecentResultClick(t,r){return this.makeCustomEvent(f.recentResultClick,{info:t,identifier:r})}logRecentResultClick(t,r){return m(this,void 0,void 0,function*(){return (yield this.makeRecentResultClick(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentResults(){return this.makeCustomEvent(f.clearRecentResults)}logClearRecentResults(){return m(this,void 0,void 0,function*(){return (yield this.makeClearRecentResults()).log({searchUID:this.provider.getSearchUID()})})}makeNoResultsBack(){return this.makeSearchEvent(f.noResultsBack)}logNoResultsBack(){return m(this,void 0,void 0,function*(){return (yield this.makeNoResultsBack()).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreFoldedResults(t,r){return this.makeClickEvent(f.showMoreFoldedResults,t,r)}logShowMoreFoldedResults(t,r){return m(this,void 0,void 0,function*(){return (yield this.makeShowMoreFoldedResults(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessFoldedResults(){return this.makeCustomEvent(f.showLessFoldedResults)}logShowLessFoldedResults(){return m(this,void 0,void 0,function*(){return (yield this.makeShowLessFoldedResults()).log({searchUID:this.provider.getSearchUID()})})}makeEventDescription(t,r){var n;return {actionCause:r,customData:(n=t.payload)===null||n===void 0?void 0:n.customData}}makeCustomEvent(t,r,n=Ls[t]){return m(this,void 0,void 0,function*(){let o=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),i=Object.assign(Object.assign({},yield this.getBaseEventRequest(o)),{eventType:n,eventValue:t}),a=yield this.coveoAnalyticsClient.makeCustomEvent(i);return {description:this.makeEventDescription(a,t),log:({searchUID:s})=>a.log({lastSearchQueryUid:s})}})}logCustomEvent(t,r,n=Ls[t]){return m(this,void 0,void 0,function*(){return (yield this.makeCustomEvent(t,r,n)).log({searchUID:this.provider.getSearchUID()})})}makeCustomEventWithType(t,r,n){return m(this,void 0,void 0,function*(){let o=Object.assign(Object.assign({},this.provider.getBaseMetadata()),n),i=Object.assign(Object.assign({},yield this.getBaseEventRequest(o)),{eventType:r,eventValue:t}),a=yield this.coveoAnalyticsClient.makeCustomEvent(i);return {description:this.makeEventDescription(a,t),log:({searchUID:s})=>a.log({lastSearchQueryUid:s})}})}logCustomEventWithType(t,r,n){return m(this,void 0,void 0,function*(){return (yield this.makeCustomEventWithType(t,r,n)).log({searchUID:this.provider.getSearchUID()})})}logSearchEvent(t,r){return m(this,void 0,void 0,function*(){return (yield this.makeSearchEvent(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeSearchEvent(t,r){return m(this,void 0,void 0,function*(){let n=yield this.getBaseSearchEventRequest(t,r),o=yield this.coveoAnalyticsClient.makeSearchEvent(n);return {description:this.makeEventDescription(o,t),log:({searchUID:i})=>o.log({searchQueryUid:i})}})}makeClickEvent(t,r,n,o){return m(this,void 0,void 0,function*(){let i=Object.assign(Object.assign(Object.assign({},r),yield this.getBaseEventRequest(Object.assign(Object.assign({},n),o))),{queryPipeline:this.provider.getPipeline(),actionCause:t}),a=yield this.coveoAnalyticsClient.makeClickEvent(i);return {description:this.makeEventDescription(a,t),log:({searchUID:s})=>a.log({searchQueryUid:s})}})}logClickEvent(t,r,n,o){return m(this,void 0,void 0,function*(){return (yield this.makeClickEvent(t,r,n,o)).log({searchUID:this.provider.getSearchUID()})})}getBaseSearchEventRequest(t,r){var n,o;return m(this,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},r),(o=(n=this.provider).getGeneratedAnswerMetadata)===null||o===void 0?void 0:o.call(n)))),this.provider.getSearchEventRequestPayload()),{queryPipeline:this.provider.getPipeline(),actionCause:t})})}getBaseEventRequest(t){return m(this,void 0,void 0,function*(){let r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t);return Object.assign(Object.assign(Object.assign({},this.getOrigins()),this.getSplitTestRun()),{customData:r,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})})}getOrigins(){var t,r;return {originContext:(r=(t=this.provider).getOriginContext)===null||r===void 0?void 0:r.call(t),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof Ke?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getSplitTestRun(){let t=this.provider.getSplitTestRunName?this.provider.getSplitTestRunName():"",r=this.provider.getSplitTestRunVersion?this.provider.getSplitTestRunVersion():"";return Object.assign(Object.assign({},t&&{splitTestRunName:t}),r&&{splitTestRunVersion:r})}makeLikeGeneratedAnswer(t){return this.makeCustomEvent(f.likeGeneratedAnswer,t)}logLikeGeneratedAnswer(t){return m(this,void 0,void 0,function*(){return (yield this.makeLikeGeneratedAnswer(t)).log({searchUID:this.provider.getSearchUID()})})}makeDislikeGeneratedAnswer(t){return this.makeCustomEvent(f.dislikeGeneratedAnswer,t)}logDislikeGeneratedAnswer(t){return m(this,void 0,void 0,function*(){return (yield this.makeDislikeGeneratedAnswer(t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenGeneratedAnswerSource(t){return this.makeCustomEvent(f.openGeneratedAnswerSource,t)}logOpenGeneratedAnswerSource(t){return m(this,void 0,void 0,function*(){return (yield this.makeOpenGeneratedAnswerSource(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerSourceHover(t){return this.makeCustomEvent(f.generatedAnswerSourceHover,t)}logGeneratedAnswerSourceHover(t){return m(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerSourceHover(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCopyToClipboard(t){return this.makeCustomEvent(f.generatedAnswerCopyToClipboard,t)}logGeneratedAnswerCopyToClipboard(t){return m(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerCopyToClipboard(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerHideAnswers(t){return this.makeCustomEvent(f.generatedAnswerHideAnswers,t)}logGeneratedAnswerHideAnswers(t){return m(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerHideAnswers(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerShowAnswers(t){return this.makeCustomEvent(f.generatedAnswerShowAnswers,t)}logGeneratedAnswerShowAnswers(t){return m(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerShowAnswers(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerExpand(t){return this.makeCustomEvent(f.generatedAnswerExpand,t)}logGeneratedAnswerExpand(t){return m(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerExpand(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCollapse(t){return this.makeCustomEvent(f.generatedAnswerCollapse,t)}logGeneratedAnswerCollapse(t){return m(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerCollapse(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerFeedbackSubmit(t){return this.makeCustomEvent(f.generatedAnswerFeedbackSubmit,t)}logGeneratedAnswerFeedbackSubmit(t){return m(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerFeedbackSubmit(t)).log({searchUID:this.provider.getSearchUID()})})}makeRephraseGeneratedAnswer(t){return this.makeSearchEvent(f.rephraseGeneratedAnswer,t)}logRephraseGeneratedAnswer(t){return m(this,void 0,void 0,function*(){return (yield this.makeRephraseGeneratedAnswer(t)).log({searchUID:this.provider.getSearchUID()})})}makeRetryGeneratedAnswer(){return this.makeSearchEvent(f.retryGeneratedAnswer)}logRetryGeneratedAnswer(){return m(this,void 0,void 0,function*(){return (yield this.makeRetryGeneratedAnswer()).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerStreamEnd(t){return this.makeCustomEvent(f.generatedAnswerStreamEnd,t)}logGeneratedAnswerStreamEnd(t){return m(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerStreamEnd(t)).log({searchUID:this.provider.getSearchUID()})})}},xn=Object.assign({},xr);Object.keys(xn).map(e=>xn[e]);var wn;(function(e){e.click="click",e.flowStart="flowStart";})(wn||(wn={}));var Ie;(function(e){e.enterInterface="ticket_create_start",e.fieldUpdate="ticket_field_update",e.fieldSuggestionClick="ticket_classification_click",e.suggestionClick="suggestion_click",e.suggestionRate="suggestion_rate",e.nextCaseStep="ticket_next_stage",e.caseCancelled="ticket_cancel",e.caseSolved="ticket_cancel",e.caseCreated="ticket_create";})(Ie||(Ie={}));var Pn;(function(e){e.quit="Quit",e.solved="Solved";})(Pn||(Pn={}));var _e=e=>new Ke(e).getCurrentVisitorId(),xe=new Ws.HistoryStore,Je=(e,t)=>typeof t=="function"?(...r)=>{let n=pr(r[0]);try{return t.apply(t,r)}catch(o){return e.error(o,"Error in analytics preprocessRequest. Returning original request."),n}}:void 0,Xe=(e,t)=>(...r)=>{let n=pr(r[1]);try{return t.apply(t,r)}catch(o){return e.error(o,"Error in analytics hook. Returning original request."),n}};var Fn=Nt(e=>e.source,e=>[`@coveo/headless@${Mt}`].concat(Object.entries(e).map(([t,r])=>`${t}@${r}`)));function In(){return {desiredCount:5,numberOfValues:8,set:{}}}function tc(e){let{activeValue:t,ancestryMap:r}=Hm(e);return t?Wm(t,r):[]}function Hm(e){let t=[...e],r=new Map;for(;t.length>0;){let n=t.shift();if(n.state==="selected")return {activeValue:n,ancestryMap:r};if(r)for(let o of n.children)r.set(o,n);t.unshift(...n.children);}return {}}function Wm(e,t){let r=[];if(!e)return [];let n=e;do r.unshift(n),n=t.get(n);while(n);return r}var Ym=(e,t)=>e.categoryFacetSet[t]?.request;var Ai=(e,t)=>{let r=Ym(e,t);return tc(r?.currentValues??[])};function kn(){return {}}function On(){return {}}function Tn(){return {}}function Dn(){return {}}function Ri(e){return {facetSet:e.facetSet??Dn(),categoryFacetSet:e.categoryFacetSet??kn(),dateFacetSet:e.dateFacetSet??On(),numericFacetSet:e.numericFacetSet??Tn(),automaticFacetSet:e.automaticFacetSet??In()}}var bi=e=>{let t=[];return Jm(e).forEach((r,n)=>{let o=af(e,r.facetId),i=nf(r,n+1);if(Km(r)){if(!!!Ai(e,r.facetId).length)return;t.push({...i,...tf(e,r.facetId),facetType:o,state:"selected"});return}r.currentValues.forEach((a,s)=>{if(a.state==="idle")return;let u=rc(a,s+1,o),c=Gm(r)?nc(a):Zm(a);t.push({...i,...u,...c});});}),Xm(e).forEach((r,n)=>{let o=rf(r,n+1);r.values.forEach((i,a)=>{if(i.state==="idle")return;let s=rc(i,a+1,"specific"),u=nc(i);t.push({...o,...s,...u});});}),t},Gm=e=>e.type==="specific",Km=e=>e.type==="hierarchical",Jm=e=>[...Object.values(e.facetSet),...Object.values(e.categoryFacetSet),...Object.values(e.dateFacetSet),...Object.values(e.numericFacetSet)].map(t=>t.request),Xm=e=>[...Object.values(e.automaticFacetSet.set)].map(t=>t.response),rc=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),Zm=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),nc=e=>({displayValue:e.value,value:e.value}),ef=(e,t)=>Ai(e,t).map(n=>n.value).join(";"),tf=(e,t)=>{let n=ef(e,t);return {value:n,valuePosition:1,displayValue:n}},rf=(e,t)=>({title:oc(e.field,e.field),field:e.field,id:e.field,facetPosition:t}),nf=(e,t)=>({title:oc(e.field,e.facetId),field:e.field,id:e.facetId,facetPosition:t}),oc=(e,t)=>`${e}_${t}`,of=(e,t)=>e.facetSet[t]?.request||e.categoryFacetSet[t]?.request||e.dateFacetSet[t]?.request||e.numericFacetSet[t]?.request||e.automaticFacetSet.set[t]?.response,af=(e,t)=>{let r=of(e,t);return r?r.type:"specific"};var ve=()=>({q:"",enableQuerySyntax:!1});var ic=(r=>(r.Ascending="ascending",r.Descending="descending",r))(ic||{}),ac=(i=>(i.Relevancy="relevancy",i.QRE="qre",i.Date="date",i.Field="field",i.NoSort="nosort",i))(ac||{}),xi=e=>{if(da(e))return e.map(t=>xi(t)).join(",");switch(e.by){case"relevancy":case"qre":case"nosort":return e.by;case"date":return `date ${e.order}`;case"field":return `@${e.field} ${e.order}`;default:return ""}},sc=()=>({by:"relevancy"});new F({values:{by:new kt({enum:ac,required:!0}),order:new kt({enum:ic}),field:new A}});function qn(){return xi(sc())}var ut=()=>"default";var sf=e=>{let t=e.configuration.search.locale.split("-")[0];return !t||t.length!==2?"en":t},ke=class{constructor(t){this.getState=t;this.state=t();}getLanguage(){return sf(this.state)}getBaseMetadata(){let{context:t,configuration:r}=this.state,n=t?.contextValues||{},o={};for(let[i,a]of Object.entries(n)){let s=`context_${i}`;o[s]=a;}return r.analytics.analyticsMode==="legacy"&&(o.coveoHeadlessVersion=Mt),o}getOriginContext(){return this.state.configuration.analytics.originContext}getOriginLevel1(){return this.state.searchHub||ut()}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3}getIsAnonymous(){return this.state.configuration.analytics.anonymous}};var Er=class Er extends ke{constructor(){super(...arguments);this.getFacetRequest=r=>this.state.facetSet?.[r]?.request||this.state.categoryFacetSet?.[r]?.request||this.state.dateFacetSet?.[r]?.request||this.state.numericFacetSet?.[r]?.request||this.state.automaticFacetSet?.set[r]?.response;}getFacetState(){return bi(Ri(this.getState()))}getPipeline(){return this.state.pipeline||this.state.search?.response.pipeline||Er.fallbackPipelineName}getSearchEventRequestPayload(){return {queryText:this.queryText,responseTime:this.responseTime,results:this.resultURIs,numberOfResults:this.numberOfResults}}getSearchUID(){let r=this.getState();return r.search?.searchResponseId||r.search?.response.searchUid||Te().response.searchUid}getSplitTestRunName(){return this.state.search?.response.splitTestRun}getSplitTestRunVersion(){let r=!!this.getSplitTestRunName(),n=this.state.search?.response.pipeline||this.state.pipeline||Er.fallbackPipelineName;return r?n:void 0}getBaseMetadata(){let r=this.getState(),n=super.getBaseMetadata(),o=r.search?.response?.extendedResults?.generativeQuestionAnsweringId;return o&&(n.generativeQuestionAnsweringId=o),n}getFacetMetadata(r,n){let i=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),facetId:r,facetField:i,facetValue:n,facetTitle:`${i}_${r}`}}getFacetClearAllMetadata(r){let o=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),facetId:r,facetField:o,facetTitle:`${o}_${r}`}}getFacetUpdateSortMetadata(r,n){let i=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),facetId:r,facetField:i,criteria:n,facetTitle:`${i}_${r}`}}getRangeBreadcrumbFacetMetadata(r,n){let i=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),facetId:r,facetField:i,facetRangeEnd:n.end,facetRangeEndInclusive:n.endInclusive,facetRangeStart:n.start,facetTitle:`${i}_${r}`}}getResultSortMetadata(){return {...this.getBaseMetadata(),resultsSortBy:this.state.sortCriteria??qn()}}getStaticFilterToggleMetadata(r,n){return {...this.getBaseMetadata(),staticFilterId:r,staticFilterValue:n}}getStaticFilterClearAllMetadata(r){return {...this.getBaseMetadata(),staticFilterId:r}}getUndoTriggerQueryMetadata(r){return {...this.getBaseMetadata(),undoneQuery:r}}getCategoryBreadcrumbFacetMetadata(r,n){let i=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),categoryFacetId:r,categoryFacetField:i,categoryFacetPath:n,categoryFacetTitle:`${i}_${r}`}}getOmniboxAnalyticsMetadata(r,n){let o=this.state.querySuggest&&this.state.querySuggest[r],i=o.completions.map(c=>c.expression),a=o.partialQueries.length-1,s=o.partialQueries[a]||"",u=o.responseId;return {...this.getBaseMetadata(),suggestionRanking:i.indexOf(n),partialQuery:s,partialQueries:o.partialQueries.length>0?o.partialQueries:"",suggestions:i.length>0?i:"",querySuggestResponseId:u}}getInterfaceChangeMetadata(){return {...this.getBaseMetadata(),interfaceChangeTo:this.state.configuration.analytics.originLevel2}}getOmniboxFromLinkMetadata(r){return {...this.getBaseMetadata(),...r}}getGeneratedAnswerMetadata(){let r=this.getState(),n={};return r.generatedAnswer?.isVisible!==void 0&&(n.showGeneratedAnswer=r.generatedAnswer.isVisible),n}get resultURIs(){return this.results?.map(r=>({documentUri:r.uri,documentUriHash:r.raw.urihash}))}get results(){return this.state.search?.response.results}get queryText(){return this.state.query?.q||ve().q}get responseTime(){return this.state.search?.duration||Te().duration}get numberOfResults(){return this.state.search?.response.totalCountFiltered||Te().response.totalCountFiltered}};Er.fallbackPipelineName="default";var lt=Er,cc=({logger:e,getState:t,analyticsClientMiddleware:r=(i,a)=>a,preprocessRequest:n,provider:o=new lt(t)})=>{let i=t(),a=i.configuration.accessToken,s=i.configuration.analytics.apiBaseUrl,u=i.configuration.analytics.runtimeEnvironment,c=i.configuration.analytics.enabled,l=new ct({token:a,endpoint:s,runtimeEnvironment:u,preprocessRequest:Je(e,n),beforeSendHooks:[Xe(e,r),(p,h)=>(e.info({...h,type:p,endpoint:s,token:a},"Analytics request"),h)]},o);return c||l.disable(),l},wi=()=>{let t=xe.getHistory().reverse().find(r=>r.name==="PageView"&&r.value);return t?t.value:""};var Yt=async(e,t)=>{let r=e.analyticsMode==="next";return {analytics:{clientId:await _e(e),clientTimestamp:new Date().toISOString(),documentReferrer:e.originLevel3,originContext:e.originContext,...t&&{actionCause:t.actionCause,customData:t.customData},...t&&!r&&{customData:t.customData},...e.userDisplayName&&{userDisplayName:e.userDisplayName},...e.documentLocation&&{documentLocation:e.documentLocation},...e.deviceId&&{deviceId:e.deviceId},...wi()&&{pageId:wi()},...r&&e.trackingId&&{trackingId:e.trackingId},capture:r,...r&&{source:Fn(e)}}}};var Gt=()=>({duration:0,error:null,isLoading:!1,id:"Recommendation",recommendations:[],searchUid:"",splitTestRun:"",pipeline:""});var Fr=class extends ke{getPipeline(){return this.state.pipeline||this.state.recommendation?.pipeline||"default"}getSearchEventRequestPayload(){return {queryText:ve().q,responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){return this.getState().recommendation?.searchUid||Gt().searchUid}getSplitTestRunName(){return this.state.recommendation?.splitTestRun}getSplitTestRunVersion(){let t=!!this.getSplitTestRunName(),r=this.state.recommendation?.pipeline||this.state.pipeline||"default";return t?r:void 0}get responseTime(){return this.state.recommendation?.duration||Gt().duration}mapResultsToAnalyticsDocument(){return this.state.recommendation?.recommendations.map(t=>({documentUri:t.uri,documentUriHash:t.raw.urihash}))}get numberOfResults(){return this.state.recommendation?.recommendations.length||Gt().recommendations.length}};function cf({config:e,environment:t,event:r,listenerManager:n}){let{url:o,token:i,mode:a}=e;a!=="disabled"&&(n.call(r),t.send(o,i,r));}var uf=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function lf(e){return typeof e=="string"&&uf.test(e)}function df(e){let t="visitorId";return {getClientId:()=>{let r=e.get(),n=r.storage,o=n.getItem(t),i=o&&lf(o)?o:r.generateUUID();return n.setItem(t,i),i},clear:()=>{e.get().storage.removeItem(t);}}}var lc="0.7.7";function pf(e){let{trackingId:t}=e;return {trackingId:t}}function mf(e){return (e.source||[]).concat([`relay@${lc}`])}function dc(e,t,r,n){let{getReferrer:o,getLocation:i,getUserAgent:a}=r,s=pf(t),u=n.getClientId();return Object.freeze({type:e,config:s,ts:Date.now(),source:mf(t),clientId:u,userAgent:a(),referrer:o(),location:i()})}function ff(e,t,r,n,o){return {...t,meta:dc(e,r,n,o)}}var gf="*";function hf(){let e=[];function t({type:u,callback:c}){return e.findIndex(l=>l.type===u&&l.callback===c)}function r(u,c){return u.type==="*"||c===u.type}function n(u){return t(u)<0&&e.push(u),()=>s(u.type,u.callback)}function o(u){e.forEach(c=>{if(r(c,u.meta.type))try{c.callback(u);}catch(l){console.error(l);}});}function i(u){if(u===gf)e.length=0;else for(let c=e.length-1;c>=0;c--)e[c].type===u&&e.splice(c,1);}function a(u){let c=t(u);c>=0&&e.splice(c,1);}function s(u,c){c?a({type:u,callback:c}):i(u);}return {add:n,call:o,remove:s}}function uc({url:e,token:t,trackingId:r,...n}){return Object.freeze({url:e,token:t,trackingId:r,...!!n.mode&&{mode:n.mode},...!!n.source&&{source:n.source}})}function yf(e){let t=uc(e);return {get:()=>t,update:r=>{t=uc({...t,...r});}}}function Sf(){let e=typeof window<"u";return {sendMessage(t){e&&window.postMessage(t,"*");}}}var Pi=vf();function vf(){let e="coveo_",t=r=>{let n=r.split(".").slice(-2);return n.length==2?n.join("."):""};return {getItem(r){let n=`${e}${r}=`,o=document.cookie.split(";");for(let i of o){let a=i.replace(/^\s+/,"");if(a.lastIndexOf(n,0)===0)return a.substring(n.length,a.length)}return null},setItem(r,n,o){let i=t(window.location.hostname),a=`;expires=${new Date(new Date().getTime()+o).toUTCString()}`,s=i?`;domain=${i}`:"";document.cookie=`${e}${r}=${n}${a}${s};path=/;SameSite=Lax`;},removeItem(r){this.setItem(r,"",-1);}}}function Cf(){return {getItem(e){return Pi.getItem(e)||localStorage.getItem(e)},removeItem(e){Pi.removeItem(e),localStorage.removeItem(e);},setItem(e,t){localStorage.setItem(e,t),Pi.setItem(e,t,31556952e3);}}}function Af(){let e=document.referrer;return e===""?null:e}function Rf(){return {runtime:"browser",send:(e,t,r)=>{let n=navigator.sendBeacon(`${e}?access_token=${t}`,new Blob([JSON.stringify([r])],{type:"application/json"}));if(Sf().sendMessage({kind:"EVENT_PROTOCOL",event:r,url:e,token:t}),!n)throw new Error("Failed to send the event(s) because the payload size exceeded the maximum allowed size (32 KB). Please contact support if the problem persists.")},getReferrer:()=>Af(),getLocation:()=>window.location.href,getUserAgent:()=>navigator.userAgent,generateUUID:()=>crypto.randomUUID(),storage:Cf()}}function bf(){return {getItem(){return null},removeItem(){},setItem(){}}}function xf(){return {runtime:"null",send:()=>{},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>"",storage:bf()}}function wf(e){return e.get().mode!=="disabled"&&Pf()?Rf():xf()}function Pf(){try{return typeof window=="object"}catch{return !1}}function Ef(e){return {get:()=>Object.freeze(wf(e))}}function pc(e){let t=yf(e),r=hf(),n=Ef(t),o=df(n);return {emit:(i,a)=>{let s=t.get(),u=n.get(),c=ff(i,a,s,u,o);return cf({config:s,environment:u,event:c,listenerManager:r})},getMeta:i=>dc(i,t.get(),n.get(),o),on:(i,a)=>r.add({type:i,callback:a}),off:(i,a)=>r.remove(i,a),updateConfig:i=>t.update(i),version:lc,clearStorage:()=>{o.clear();}}}var Ir=Nt(e=>e.configuration.accessToken,e=>e.configuration.analytics,e=>Fn(e.configuration.analytics),(e,{trackingId:t,nextApiBaseUrl:r,enabled:n},o)=>pc({mode:n?"emit":"disabled",url:r,token:e,trackingId:t,source:o}));var Nn=()=>({url:"",clientId:"",additionalFields:[],advancedParameters:{debug:!1},products:[],facets:{results:[]},error:null,isLoading:!1,responseId:""});var xt=class extends ke{constructor(){super(...arguments);this.initialState=Nn();}getPipeline(){return ""}getSearchEventRequestPayload(){return {queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){return this.getState().productListing?.responseId||this.initialState.responseId}mapResultsToAnalyticsDocument(){return this.state.productListing?.products.map(r=>({documentUri:r.documentUri,documentUriHash:r.documentUriHash,permanentid:r.permanentid}))}get numberOfResults(){return this.state.productListing.products.length}},gc=({logger:e,getState:t,analyticsClientMiddleware:r=(i,a)=>a,preprocessRequest:n,provider:o=new xt(t)})=>{let i=t(),a=i.configuration.accessToken,s=i.configuration.analytics.apiBaseUrl,u=i.configuration.analytics.runtimeEnvironment,c=i.configuration.analytics.enabled,l=new ct({token:a,endpoint:s,runtimeEnvironment:u,preprocessRequest:Je(e,n),beforeSendHooks:[Xe(e,r),(p,h)=>(e.info({...h,type:p,endpoint:s,token:a},"Analytics request"),h)]},o);return c||l.disable(),l};function hc(e){let t=yc(e),r=[e,...t].filter(o=>o.parentResult).map(o=>o.parentResult);return va([e,...t,...r],o=>o.uniqueId)}function yc(e){return e.childResults?e.childResults.flatMap(t=>[t,...yc(t)]):[]}function Sc(e,t){return {...new lt(t).getBaseMetadata(),actionCause:e,type:e}}function Ff(e){return Object.assign(e,{instantlyCallable:!0})}function If(e,t){let r=i=>Ff(W(e,i)),n=r(async(i,{getState:a,extra:s})=>{let{analyticsClientMiddleware:u,preprocessRequest:c,logger:l}=s;return await(await t({getState:a,analyticsClientMiddleware:u,preprocessRequest:c,logger:l})).log({state:a(),extra:s})});return Object.assign(n,{prepare:async({getState:i,analyticsClientMiddleware:a,preprocessRequest:s,logger:u})=>{let{description:c,log:l}=await t({getState:i,analyticsClientMiddleware:a,preprocessRequest:s,logger:u});return {description:c,action:r(async(p,{getState:h,extra:d})=>await l({state:h(),extra:d}))}}}),n}var Mn=(e,t,r)=>{function n(...o){let i=o.length===1?{...o[0],__legacy__getBuilder:t(o[0].__legacy__getBuilder),analyticsConfigurator:e,providerClass:r}:{prefix:o[0],__legacy__getBuilder:t(o[1]),__legacy__provider:o[2],analyticsConfigurator:e,providerClass:r};return Tf(i)}return n},kf=e=>e.configuration.analytics.analyticsMode==="legacy",Of=e=>e.configuration.analytics.analyticsMode==="next",Tf=({prefix:e,__legacy__getBuilder:t,__legacy__provider:r,analyticsPayloadBuilder:n,analyticsType:o,analyticsConfigurator:i,providerClass:a})=>(r??(r=s=>new a(s)),If(e,async({getState:s,analyticsClientMiddleware:u,preprocessRequest:c,logger:l})=>{let p=[],h={log:async({state:P})=>{for(let k of p)await k(P);}},d=s(),y=i({getState:s,logger:l,analyticsClientMiddleware:u,preprocessRequest:c,provider:r(s)}),v=await t(y,s());h.description=v?.description,p.push(async P=>{kf(P)&&await Df(v,r,P,l,y.coveoAnalyticsClient);});let{emit:C}=Ir(d);return p.push(async P=>{if(Of(P)&&o&&n){let k=n(P);await Uf(C,o,k);}}),h}));async function Df(e,t,r,n,o){t(()=>r);let i=await e?.log({searchUID:t(()=>r).getSearchUID()});n.info({client:o,response:i},"Analytics response");}var Ce=Mn(cc,e=>e,lt);var vc=Mn(gc,e=>e,xt);var Ei=(e,t)=>{let r=i=>i+(t.pagination?.firstResult??0),n=-1,o=t.search?.results;return n=bc(e,o),n<0&&(n=Lf(e,o)),n<0&&(n=0),Ac(e,r(n),t)},Cc=(e,t)=>{let r=t.recommendation?.recommendations.findIndex(({uniqueId:n})=>e.uniqueId===n)||0;return Ac(e,r,t)};function Ac(e,t,r){let n=e.raw.collection;return {collectionName:typeof n=="string"?n:"default",documentAuthor:Vf(e),documentPosition:t+1,documentTitle:e.title,documentUri:e.uri,documentUriHash:e.raw.urihash,documentUrl:e.clickUri,rankingModifier:e.rankingModifier||"",sourceName:_f(e),queryPipeline:r.pipeline||jt()}}var Vn=e=>(e.raw.permanentid||console.warn("Missing field permanentid on result. This might cause many issues with your Coveo deployment. See https://docs.coveo.com/en/1913 and https://docs.coveo.com/en/1640 for more information.",e),{contentIDKey:"permanentid",contentIDValue:e.raw.permanentid||""}),Rc={urihash:new A,sourcetype:new A,permanentid:new A},Fi={uniqueId:w,raw:new F({values:Rc}),title:w,uri:w,clickUri:w,rankingModifier:new A({required:!1,emptyAllowed:!0})};function Nf(e){return Object.assign({},...Object.keys(Rc).map(t=>({[t]:e[t]})))}function Mf(e){return Object.assign({},...Object.keys(Fi).map(t=>({[t]:e[t]})),{raw:Nf(e.raw)})}function Vf(e){let t=e.raw.author;return D(t)?"unknown":Array.isArray(t)?t.join(";"):`${t}`}function _f(e){let t=e.raw.source;return D(t)?"unknown":t}var Ii=e=>new le(Fi).validate(Mf(e));function Lf(e,t){for(let[r,n]of t.entries()){let o=hc(n);if(bc(e,o)!==-1)return r}return -1}function bc(e,t=[]){return t.findIndex(({uniqueId:r})=>r===e.uniqueId)}async function Uf(e,t,r){await e(t,r);}var xc=()=>Ce("analytics/recommendation/update",e=>e.makeRecommendationInterfaceLoad(),e=>new Fr(e)),wc=()=>({actionCause:"recommendationInterfaceLoad"}),Ln=e=>Ce({prefix:"analytics/recommendation/open",__legacy__getBuilder:(t,r)=>(Ii(e),t.makeRecommendationOpen(Cc(e,r),Vn(e))),__legacy__provider:t=>new Fr(t),analyticsType:"itemClick",analyticsPayloadBuilder:t=>{let r=Ei(e,t),n=Vn(e);return {searchUid:t.search?.response.searchUid??"",position:r.documentPosition,itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}});var Kt=g("recommendation/set",e=>S(e,{id:w})),dt=W("recommendation/get",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let o=t(),i=new Date().getTime(),a=await jf(o),s=await n.recommendations(a),u=new Date().getTime()-i;return pe(s)?r(s.error):{recommendations:s.success.results,analyticsAction:xc(),duration:u,searchUid:s.success.searchUid,splitTestRun:s.success.splitTestRun,pipeline:s.success.pipeline}}),jf=async e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,recommendation:e.recommendation.id,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,locale:e.configuration.search.locale,actionsHistory:e.configuration.analytics.enabled?xe.getHistory():[],...e.advancedSearchQueries&&{aq:e.advancedSearchQueries.aq,cq:e.advancedSearchQueries.cq},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub},...e.context&&{context:e.context.contextValues},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.fields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.configuration.analytics.enabled&&{visitorId:await _e(e.configuration.analytics)},...e.configuration.analytics.enabled&&await Bf(e,wc()),...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")},...e.pagination&&{numberOfResults:e.pagination.numberOfResults}}),Bf=async(e,t)=>{let r=e.configuration.analytics.analyticsMode==="legacy"?void 0:{actionCause:t.actionCause,type:t.actionCause};return await Yt(e.configuration.analytics,r)};var Jt=J(Gt(),e=>{e.addCase(Kt,(t,r)=>{t.id=r.payload.id;}).addCase(dt.rejected,(t,r)=>{t.error=r.payload?r.payload:null,t.isLoading=!1;}).addCase(dt.fulfilled,(t,r)=>{t.error=null,t.recommendations=r.payload.recommendations,t.duration=r.payload.duration,t.isLoading=!1,t.searchUid=r.payload.searchUid,t.splitTestRun=r.payload.splitTestRun,t.pipeline=r.payload.pipeline;}).addCase(dt.pending,t=>{t.isLoading=!0;});});var Xt=g("searchHub/set",e=>S(e,new A({required:!0,emptyAllowed:!0})));var Zt=J(ut(),e=>{e.addCase(Xt,(t,r)=>r.payload).addCase(fe.fulfilled,(t,r)=>r.payload?.searchHub??t).addCase(Me,(t,r)=>r.payload.searchHub||t);});var Pc=J(Mt,e=>e);function Ec(){return typeof window<"u"&&typeof document<"u"}function $f(e){let t=e.payload?.analyticsAction;return Fc(e)&&!D(t)}function Fc(e){return "type"in e}var Ic=e=>t=>r=>{let n;$f(r)&&(n=r.payload.analyticsAction,delete r.payload.analyticsAction);let o=t(r);return Fc(r)&&(r.type==="search/executeSearch/fullfilled"&&n===void 0&&console.error("No analytics action associated with search:",r),r.type==="recommendation/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with recommendation:",r),r.type==="productRecommendations/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with product recommendation:",r)),n!==void 0&&e.dispatch(n),o};var Vc=Ae(Oc());g("tab/register",e=>{let t=new F({values:{id:w,expression:ie}});return S(e,t)});var Un=g("tab/updateActiveTab",e=>S(e,w));var Bn=Ae(jn()),qc=Ae(Tc()),Nc=Ae(Dc());Bn.default.extend(Nc.default);Bn.default.extend(qc.default);var Mi="/rest/search/v2",Vi="/rest/ua",Mc=()=>({organizationId:"",accessToken:"",platformUrl:Lo(),search:{apiBaseUrl:`${Lo()}${Mi}`,locale:"en-US",timezone:Bn.default.tz.guess(),authenticationProviders:[]},analytics:{enabled:!0,apiBaseUrl:`${_a()}${Vi}`,nextApiBaseUrl:"",originContext:"Search",originLevel2:"default",originLevel3:"default",anonymous:!1,deviceId:"",userDisplayName:"",documentLocation:"",trackingId:"",analyticsMode:"legacy",source:{}}});function zf(e,t){if(Ba(e))return e.replace(/^(https:\/\/)platform/,"$1analytics")+Vi;let n=$a(e,t);return n?gr(t,n.environment).analytics:e}var _c=J(Mc(),e=>e.addCase(it,(t,r)=>{r.payload.accessToken&&(t.accessToken=r.payload.accessToken),r.payload.organizationId&&(t.organizationId=r.payload.organizationId),r.payload.platformUrl&&(t.platformUrl=r.payload.platformUrl,t.search.apiBaseUrl=`${r.payload.platformUrl}${Mi}`,t.analytics.apiBaseUrl=zf(r.payload.platformUrl,t.organizationId));}).addCase(Me,(t,r)=>{r.payload.apiBaseUrl&&(t.search.apiBaseUrl=r.payload.apiBaseUrl),r.payload.locale&&(t.search.locale=r.payload.locale),r.payload.timezone&&(t.search.timezone=r.payload.timezone),r.payload.authenticationProviders&&(t.search.authenticationProviders=r.payload.authenticationProviders);}).addCase(Vt,(t,r)=>{D(r.payload.enabled)||(t.analytics.enabled=r.payload.enabled),D(r.payload.originContext)||(t.analytics.originContext=r.payload.originContext),D(r.payload.originLevel2)||(t.analytics.originLevel2=r.payload.originLevel2),D(r.payload.originLevel3)||(t.analytics.originLevel3=r.payload.originLevel3),D(r.payload.apiBaseUrl)||(t.analytics.apiBaseUrl=r.payload.apiBaseUrl),D(r.payload.nextApiBaseUrl)||(t.analytics.nextApiBaseUrl=r.payload.nextApiBaseUrl),D(r.payload.trackingId)||(t.analytics.trackingId=r.payload.trackingId),D(r.payload.analyticsMode)||(t.analytics.analyticsMode=r.payload.analyticsMode),D(r.payload.source)||(t.analytics.source=r.payload.source);let n=(0, Vc.default)();n&&(t.analytics.analyticsMode="next",t.analytics.trackingId=n),D(r.payload.runtimeEnvironment)||(t.analytics.runtimeEnvironment=r.payload.runtimeEnvironment),D(r.payload.anonymous)||(t.analytics.anonymous=r.payload.anonymous),D(r.payload.deviceId)||(t.analytics.deviceId=r.payload.deviceId),D(r.payload.userDisplayName)||(t.analytics.userDisplayName=r.payload.userDisplayName),D(r.payload.documentLocation)||(t.analytics.documentLocation=r.payload.documentLocation);}).addCase(_t,t=>{t.analytics.enabled=!1;}).addCase(Lt,t=>{t.analytics.enabled=!0;}).addCase(ln,(t,r)=>{t.analytics.originLevel2=r.payload.originLevel2;}).addCase(dn,(t,r)=>{t.analytics.originLevel3=r.payload.originLevel3;}).addCase(Un,(t,r)=>{t.analytics.originLevel2=r.payload;}).addCase(at,(t,r)=>{t.analytics.originLevel2=r.payload.tab||t.analytics.originLevel2;}));var Le=_c;function Hf(e){return e.instantlyCallable}var Lc=()=>e=>t=>e(Hf(t)?t():t);var Uc=e=>()=>t=>r=>{let n=r;if(!n.error)return t(r);let o=n.error;if(n.payload?.ignored||e.error(o.stack||o.message||o.name||"Error",`Action dispatch error ${n.type}`,r),n.error.name!=="SchemaValidationError")return t(r)},jc=e=>t=>r=>n=>(e.debug({action:n,nextState:t.getState()},`Action dispatched: ${n.type}`),r(n));var Bc=()=>({referrer:document.referrer,userAgent:navigator.userAgent,location:window.location.href}),$c=()=>({referrer:"default",userAgent:"Node.js",location:"default"});function Qc(e,t){let r={...e},n,o=i=>(a,s)=>{let u=i(a,s);return n?n(u,s):u};return {get combinedReducer(){let i=Ca(Object.entries(t).filter(([a])=>!(a in r)).map(([a,s])=>[a,()=>s]));return o(Zr({...i,...r}))},containsAll(i){return Object.keys(i).every(s=>s in r)},add(i){Object.keys(i).filter(a=>!(a in r)).forEach(a=>r[a]=i[a]);},addCrossReducer(i){n=i;}}}function $n(e,t,r){var n,o,i;t===void 0&&(t=50),r===void 0&&(r={});var a=(n=r.isImmediate)!=null&&n,s=(o=r.callback)!=null&&o,u=r.maxWait,c=Date.now(),l=[];function p(){if(u!==void 0){var d=Date.now()-c;if(d+t>=u)return u-d}return t}var h=function(){var d=[].slice.call(arguments),y=this;return new Promise(function(v,C){var P=a&&i===void 0;if(i!==void 0&&clearTimeout(i),i=setTimeout(function(){if(i=void 0,c=Date.now(),!a){var L=e.apply(y,d);s&&s(L),l.forEach(function(V){return (0, V.resolve)(L)}),l=[];}},p()),P){var k=e.apply(y,d);return s&&s(k),v(k)}l.push({resolve:v,reject:C});})};return h.cancel=function(d){i!==void 0&&clearTimeout(i),l.forEach(function(y){return (0, y.reject)(d)}),l=[];},h}function zc(e,t){let r=0,n=$n(()=>r=0,500);return o=>i=>async a=>{if(!(typeof a=="function"))return i(a);let u=await i(a);if(!Wf(u))return u;if(typeof t!="function")return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),u;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),u;r++,n();let c=await Yf(t);o.dispatch(it({accessToken:c})),o.dispatch(a);}}function Wf(e){return e?.error?.name===new Tt().name}async function Yf(e){try{return await e()}catch{return ""}}function Hc({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:n,name:o}){return Ss({reducer:e,preloadedState:t,devTools:{stateSanitizer:i=>i.history?{...i,history:"<<OMIT>>"}:i,name:o,shouldHotReload:!1},middleware:i=>i({thunk:{extraArgument:n}}).prepend(...r).concat(jc(n.logger))})}var Gf={configuration:Le,version:Pc};function Kf(e,t){let r=e.organizationEndpoints?.analytics||void 0,{analyticsClientMiddleware:n,...o}=e.analytics??{},i={...o,nextApiBaseUrl:`${r}/rest/organizations/${e.organizationId}/events/v1`,apiBaseUrl:r};if(zr())return t.info("Analytics disabled since doNotTrack is active."),{...i,enabled:!1};if(i.analyticsMode==="next"&&!o.trackingId)throw new _i('analytics.trackingId is required when analytics.analyticsMode="next"');return i}function Wc(e,t){let r=Jf(e,t),{accessToken:n,organizationId:o}=e.configuration,{organizationEndpoints:i}=e.configuration,a=i?.platform||e.configuration.platformUrl;tg(e.configuration)&&r.logger.warn(`The \`platformUrl\` (${e.configuration.platformUrl}) option will be deprecated in the next major version. Consider using the \`organizationEndpoints\` option instead. See [Organization endpoints](https://docs.coveo.com/en/mcc80216).`),eg(e.configuration)?r.logger.warn("The `organizationEndpoints` options was not explicitly set in the Headless engine configuration. Coveo recommends setting this option, as it has resiliency benefits and simplifies the overall configuration for multi-region deployments. See [Organization endpoints](https://docs.coveo.com/en/mcc80216)."):rg(e.configuration)&&r.logger.warn(`There is a mismatch between the \`organizationId\` option (${e.configuration.organizationId}) and the organization configured in the \`organizationEndpoints\` option (${e.configuration.organizationEndpoints?.platform}). This could lead to issues that are complex to troubleshoot. Please make sure both values match.`),r.dispatch(it({accessToken:n,organizationId:o,platformUrl:a}));let s=Kf(e.configuration,r.logger);return s&&r.dispatch(Vt(s)),r}function Jf(e,t){let{reducers:r}=e,n=Qc({...Gf,...r},e.preloadedState??{});e.crossReducer&&n.addCrossReducer(e.crossReducer);let o=t.logger,i=e.navigatorContextProvider??Ec()?Bc:$c,a={...t,get relay(){return Ir(u.state)},get navigatorContext(){return i()}},s=Xf(e,a,n),u={addReducers(c){n.containsAll(c)||(n.add(c),s.replaceReducer(n.combinedReducer));},dispatch:s.dispatch,subscribe:s.subscribe,enableAnalytics(){s.dispatch(Lt());},disableAnalytics(){s.dispatch(_t());},get state(){return s.getState()},get relay(){return Ir(this.state)},get navigatorContext(){return i()},logger:o,store:s};return u}function Xf(e,t,r){let{preloadedState:n,configuration:o}=e,i=o.name||"coveo-headless",a=Zf(e,t.logger);return Hc({preloadedState:n,reducer:r.combinedReducer,middlewares:a,thunkExtraArguments:t,name:i})}function Zf(e,t){let{renewAccessToken:r}=e.configuration,n=zc(t,r);return [Lc,n,Uc(t),Ic].concat(e.middlewares||[])}function eg(e){return ee(e.organizationEndpoints)}function tg(e){return !D(e.platformUrl)||D(e.organizationEndpoints?.platform)}function rg(e){let{platform:t}=e.organizationEndpoints;if(ee(t))return !1;let r=jo(t);return r&&r.organizationId!==e.organizationId}var _i=class extends Error{constructor(t){super(t),this.name="InvalidEngineConfiguration";}};var ru=Ae(tu());function nu(e){return (0, ru.default)({name:"@coveo/headless",level:e?.level||"warn",formatters:{log:e?.logFormatter}})}function ou(e,t){let r=Cg(e),n=Re,o=Ag(e);return {analyticsClientMiddleware:r,validatePayload:n,preprocessRequest:o,logger:t}}function Cg(e){let{analytics:t}=e,r=(n,o)=>o;return t?.analyticsClientMiddleware||r}function Ag(e){return e.preprocessRequest||Hr}var iu={organizationId:w,accessToken:w,platformUrl:new A({required:!1,emptyAllowed:!1}),name:new A({required:!1,emptyAllowed:!1}),analytics:new F({options:{required:!1},values:{enabled:new M({required:!1}),originContext:new A({required:!1}),originLevel2:new A({required:!1}),originLevel3:new A({required:!1}),analyticsMode:new A({constrainTo:["legacy","next"],required:!1})}})};var su=new le({...iu,pipeline:new A({required:!1,emptyAllowed:!0}),searchHub:X,locale:X,timezone:X});var Rg={debug:gn,pipeline:Bt,searchHub:Zt,recommendation:Jt};function bg(e){let t=nu(e.loggerOptions);xg(e.configuration,t);let r=wg(e.configuration,t),n={...ou(e.configuration,t),apiClient:r},o={...e,reducers:Rg},i=Wc(o,n),{pipeline:a,searchHub:s,timezone:u,locale:c}=e.configuration;return i.dispatch(Me({timezone:u,locale:c})),D(a)||i.dispatch(Ut(a)),D(s)||i.dispatch(Xt(s)),{...i,get state(){return i.state}}}function xg(e,t){try{su.validate(e);}catch(r){throw t.error(r,"Recommendation engine configuration error"),r}}function wg(e,t){return new Gr({logger:t,preprocessRequest:e.preprocessRequest||Hr,postprocessSearchResponseMiddleware:Ha,postprocessFacetSearchResponseMiddleware:Wa,postprocessQuerySuggestResponseMiddleware:Ya})}function Ox(e){return e.addReducers({configuration:Le}),{disableAnalytics:_t,enableAnalytics:Lt,setOriginLevel2:ln,setOriginLevel3:dn,updateAnalyticsConfiguration:Vt,updateBasicConfiguration:it}}function _x(e){return e.addReducers({configuration:Le,pipeline:Bt,searchHub:Zt}),{updateSearchConfiguration:Me}}var pt=()=>new A({required:!1,emptyAllowed:!0}),Yn=g("advancedSearchQueries/update",e=>S(e,{aq:pt(),cq:pt(),lq:pt(),dq:pt()})),Gn=g("advancedSearchQueries/register",e=>S(e,{aq:pt(),cq:pt(),lq:pt(),dq:pt()}));var mt=()=>({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,lq:"",lqWasSet:!1,dq:"",dqWasSet:!1,defaultFilters:{cq:"",aq:"",lq:"",dq:""}});J(mt(),e=>{e.addCase(Yn,(t,r)=>{let{aq:n,cq:o,lq:i,dq:a}=r.payload;ee(n)||(t.aq=n,t.aqWasSet=!0),ee(o)||(t.cq=o,t.cqWasSet=!0),ee(i)||(t.lq=i,t.lqWasSet=!0),ee(a)||(t.dq=a,t.dqWasSet=!0);}).addCase(Gn,(t,r)=>{let{aq:n,cq:o,lq:i,dq:a}=r.payload;ee(n)||(t.defaultFilters.aq=n,t.aqWasSet||(t.aq=n)),ee(o)||(t.defaultFilters.cq=o,t.cqWasSet||(t.cq=o)),ee(i)||(t.defaultFilters.lq=i,t.lqWasSet||(t.lq=i)),ee(a)||(t.defaultFilters.dq=a,t.dqWasSet||(t.dq=a));}).addCase(fe.fulfilled,(t,r)=>r.payload?.advancedSearchQueries??t).addCase(at,(t,r)=>{let{aq:n,cq:o}=r.payload;ee(n)||(t.aq=n,t.aqWasSet=!0),ee(o)||(t.cq=o,t.cqWasSet=!0);});});var Pg=new z({each:w,required:!0}),lu=(e,t)=>(S(e,w),$r(t)?S(t,w):S(t,Pg),{payload:{contextKey:e,contextValue:t}}),Pt=g("context/set",e=>{for(let[t,r]of Object.entries(e))lu(t,r);return {payload:e}}),Et=g("context/add",e=>lu(e.contextKey,e.contextValue)),Ft=g("context/remove",e=>S(e,w));function Kn(){return {contextValues:{}}}J(Kn(),e=>{e.addCase(Pt,(t,r)=>{t.contextValues=r.payload;}).addCase(Et,(t,r)=>{t.contextValues[r.payload.contextKey]=r.payload.contextValue;}).addCase(Ft,(t,r)=>{delete t.contextValues[r.payload];}).addCase(fe.fulfilled,(t,r)=>{r.payload&&(t.contextValues=r.payload.context.contextValues);});});var er=g("dictionaryFieldContext/set",e=>{let t=new F({options:{required:!0}}),r=S(e,t).error;if(r)return {payload:e,error:r};let n=Object.values(e),o=new z({each:ie}),i=S(n,o).error;return i?{payload:e,error:i}:{payload:e}}),tr=g("dictionaryFieldContext/add",e=>{let t=new F({options:{required:!0},values:{field:ie,key:ie}});return S(e,t)}),rr=g("dictionaryFieldContext/remove",e=>S(e,ie));function Xn(){return {contextValues:{}}}J(Xn(),e=>{e.addCase(er,(t,r)=>{t.contextValues=r.payload;}).addCase(tr,(t,r)=>{let{field:n,key:o}=r.payload;t.contextValues[n]=o;}).addCase(rr,(t,r)=>{delete t.contextValues[r.payload];}).addCase(fe.fulfilled,(t,r)=>{r.payload&&(t.contextValues=r.payload.dictionaryFieldContext.contextValues);});});var nr=async(e,t)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await _e(e.configuration.analytics),actionsHistory:xe.getHistory()},...e.advancedSearchQueries?.aq&&{aq:e.advancedSearchQueries.aq},...e.advancedSearchQueries?.cq&&{cq:e.advancedSearchQueries.cq},...e.advancedSearchQueries?.lq&&{lq:e.advancedSearchQueries.lq},...e.advancedSearchQueries?.dq&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await Yt(e.configuration.analytics,t),...e.excerptLength&&!D(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});var or=async(e,t)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await _e(e.configuration.analytics),actionsHistory:xe.getHistory()},...e.advancedSearchQueries?.aq&&{aq:e.advancedSearchQueries.aq},...e.advancedSearchQueries?.cq&&{cq:e.advancedSearchQueries.cq},...e.advancedSearchQueries?.lq&&{lq:e.advancedSearchQueries.lq},...e.advancedSearchQueries?.dq&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await Yt(e.configuration.analytics,t),...e.excerptLength&&!D(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});var Eg={collectionField:new A({emptyAllowed:!1,required:!1}),parentField:new A({emptyAllowed:!1,required:!1}),childField:new A({emptyAllowed:!1,required:!1}),numberOfFoldedResults:new I({min:0,required:!1})},du=g("folding/register",e=>S(e,Eg));W("folding/loadCollection",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let o=t(),i=o.configuration.analytics.analyticsMode==="legacy"?await nr(o):await or(o),a=await n.search({...i,q:Fg(o),enableQuerySyntax:!0,cq:`@${o.folding.fields.collection}="${e}"`,filterField:o.folding.fields.collection,childField:o.folding.fields.parent,parentField:o.folding.fields.child,filterFieldRange:100},{origin:"foldingCollection"});return pe(a)?r(a.error):{collectionId:e,results:a.success.results,rootResult:o.folding.collections[e].result}});function Fg(e){return e.query.q===""?"":e.query.enableQuerySyntax?`${e.query.q} OR @uri`:`( <@- ${e.query.q} -@> ) OR @uri`}var pu=()=>({enabled:!1,fields:{collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"},filterFieldRange:2,collections:{}});var ir=g("fields/registerFieldsToInclude",e=>S(e,bs)),eo=g("fields/fetchall/enable"),to=g("fields/fetchall/disable"),ro=W("fields/fetchDescription",async(e,{extra:t,getState:r,rejectWithValue:n})=>{let o=r(),{accessToken:i,organizationId:a}=o.configuration,{apiBaseUrl:s}=o.configuration.search,u=await t.apiClient.fieldDescriptions({accessToken:i,organizationId:a,url:s});return pe(u)?n(u.error):u.success.fields});var $i=["author","language","urihash","objecttype","collection","source","permanentid"],mu=[...$i,"date","filetype","parents"],Ig=[...mu,"ec_price","ec_name","ec_description","ec_brand","ec_category","ec_item_group_id","ec_shortdesc","ec_thumbnails","ec_images","ec_promo_price","ec_in_stock","ec_rating"],fu=()=>({fieldsToInclude:$i,fetchAllFields:!1,fieldsDescription:[]});var no=J(fu(),e=>e.addCase(ir,(t,r)=>{t.fieldsToInclude=[...new Set(t.fieldsToInclude.concat(r.payload))];}).addCase(eo,t=>{t.fetchAllFields=!0;}).addCase(to,t=>{t.fetchAllFields=!1;}).addCase(ro.fulfilled,(t,{payload:r})=>{t.fieldsDescription=r;}).addCase(du,(t,{payload:r})=>{let n=pu().fields;t.fieldsToInclude.push(r.collectionField??n.collection,r.parentField??n.parent,r.childField??n.child);}));function pP(e){return e.addReducers({fields:no}),{registerFieldsToInclude:ir,enableFetchAllFields:eo,disableFetchAllFields:to,fetchFieldsDescription:ro}}function OP(e){return e.addReducers({recommendation:Jt}),{getRecommendations:dt,setRecommendationId:Kt}}var ar=g("breadcrumb/deselectAll"),oo=g("breadcrumb/deselectAllNonBreadcrumbs");var qr={value:w,numberOfResults:new I({min:0}),state:w};var B=w;var Dg=new I({min:1,default:8,required:!1}),qg=new I({min:1,max:20,default:5,required:!1}),Ng={desiredCount:qg,numberOfValues:Dg};g("automaticFacet/setOptions",e=>S(e,Ng));g("automaticFacet/deselectAll",e=>S(e,B));var Mg=w,gu=g("automaticFacet/toggleSelectValue",e=>S(e,{field:Mg,selection:new F({values:qr})}));var Vg={state:new Y({required:!0}),numberOfResults:new I({required:!0,min:0}),value:new A({required:!0,emptyAllowed:!0}),path:new z({required:!0,each:w}),moreValuesAvailable:new M({required:!1})};function Qi(e){e.children.forEach(t=>{Qi(t);}),Re({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},Vg);}var sr={facetId:B,field:w,delimitingCharacter:new A({required:!1,emptyAllowed:!0}),filterFacetCount:new M({required:!1}),injectionDepth:new I({required:!1,min:0}),numberOfValues:new I({required:!1,min:1}),sortCriteria:new Y({required:!1}),basePath:new z({required:!1,each:w}),filterByBasePath:new M({required:!1})};g("categoryFacet/register",e=>S(e,sr));var hu=g("categoryFacet/toggleSelectValue",e=>{try{return Re(e.facetId,w),Qi(e.selection),{payload:e,error:null}}catch(t){return {payload:e,error:We(t)}}}),yu=g("categoryFacet/deselectAll",e=>S(e,sr.facetId));g("categoryFacet/updateNumberOfValues",e=>S(e,{facetId:sr.facetId,numberOfValues:sr.numberOfValues}));g("categoryFacet/updateSortCriterion",e=>S(e,{facetId:sr.facetId,criterion:new Y}));g("categoryFacet/updateBasePath",e=>S(e,{facetId:sr.facetId,basePath:new z({each:w})}));var Nr={facetId:B,captions:new F({options:{required:!1}}),numberOfValues:new I({required:!1,min:1}),query:new A({required:!1,emptyAllowed:!0})};var _g={path:new z({required:!0,each:w}),displayValue:ie,rawValue:ie,count:new I({required:!0,min:0})},Su=g("categoryFacet/selectSearchResult",e=>S(e,{facetId:B,value:new F({values:_g})}));g("categoryFacetSearch/register",e=>S(e,Nr));var vu={facetId:B,value:new F({values:{displayValue:ie,rawValue:ie,count:new I({required:!0,min:0})}})};g("facetSearch/register",e=>S(e,Nr));g("facetSearch/update",e=>S(e,Nr));var Cu=g("facetSearch/toggleSelectValue",e=>S(e,vu)),Au=g("facetSearch/toggleExcludeValue",e=>S(e,vu));var io=Ae(jn()),bu=Ae(Ru());io.default.extend(bu.default);var xu="YYYY/MM/DD@HH:mm:ss",Lg="1401-01-01";function cr(e,t){let r=(0, io.default)(e,t);return !r.isValid()&&!t?(0, io.default)(e,xu):r}function ao(e){return e.format(xu)}function wu(e,t){let r=cr(e,t);if(!r.isValid()){let n=". Please provide a date format string in the configuration options. See https://day.js.org/docs/en/parse/string-format for more information.",o=` with the format "${t}"`;throw new Error(`Could not parse the provided date "${e}"${t?o:n}`)}Wi(r);}function Wi(e){if(e.isBefore(Lg))throw new Error(`Date is before year 1401, which is unsupported by the API: ${e}`)}var Mr=Ae(jn()),Eu=Ae(Pu());Mr.default.extend(Eu.default);var Fu=["past","now","next"],Iu=["minute","hour","day","week","month","quarter","year"],Ug=e=>{let t=e==="now";return {amount:new I({required:!t,min:1}),unit:new A({required:!t,constrainTo:Iu}),period:new A({required:!0,constrainTo:Fu})}};function Ki(e){if(typeof e=="string"&&!ft(e))throw new Error(`The value "${e}" is not respecting the relative date format "period-amount-unit"`);let t=typeof e=="string"?qu(e):e;new le(Ug(t.period)).validate(t);let r=Ou(t),n=JSON.stringify(t);if(!r.isValid())throw new Error(`Date is invalid: ${n}`);Wi(r);}function ku(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":case"next":return `${t}-${r}-${n}`;case"now":return t}}function Ou(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":return (0, Mr.default)().subtract(r,n);case"next":return (0, Mr.default)().add(r,n);case"now":return (0, Mr.default)()}}function Vr(e){return ao(Ou(qu(e)))}function Tu(e){return e.toLocaleLowerCase().split("-")}function ft(e){let[t,r,n]=Tu(e);if(t==="now")return !0;if(!Fu.includes(t)||!Iu.includes(n))return !1;let o=parseInt(r);return !(isNaN(o)||o<=0)}function Du(e){return !!e&&typeof e=="object"&&"period"in e}function qu(e){let[t,r,n]=Tu(e);return t==="now"?{period:"now"}:{period:t,amount:r?parseInt(r):void 0,unit:n||void 0}}function Mu(e){let t=Nu(e.start,e),r=Nu(e.end,e),n=e.endInclusive??!1,o=e.state??"idle";return {start:t,end:r,endInclusive:n,state:o}}function Nu(e,t){let{dateFormat:r}=t;return Du(e)?(Ki(e),ku(e)):typeof e=="string"&&ft(e)?(Ki(e),e):(wu(e,r),ao(cr(e,r)))}new A({regex:/^[a-zA-Z0-9-_]+$/});new A({required:!0});new z({each:new A});new A;new M;new M;new I({min:0});var jg=new I({min:1});new M({required:!0});var Bg=new F,$g=new A,Qg={captions:Bg,numberOfValues:jg,query:$g};new F({values:Qg});var Vu=new F({options:{required:!1},values:{type:new A({constrainTo:["simple"],emptyAllowed:!1,required:!0}),values:new z({required:!0,max:25,each:new A({emptyAllowed:!1,required:!0})})}});new M;var _u=new z({min:1,max:25,required:!1,each:new A({emptyAllowed:!1,required:!0})});var zg={facetId:B,field:new A({required:!0,emptyAllowed:!0}),filterFacetCount:new M({required:!1}),injectionDepth:new I({required:!1,min:0}),numberOfValues:new I({required:!1,min:1}),sortCriteria:new Y({required:!1}),resultsMustMatch:new Y({required:!1}),allowedValues:Vu,customSort:_u};g("facet/register",e=>S(e,zg));var Lu=g("facet/toggleSelectValue",e=>S(e,{facetId:B,selection:new F({values:qr})})),Uu=g("facet/toggleExcludeValue",e=>S(e,{facetId:B,selection:new F({values:qr})})),so=g("facet/deselectAll",e=>S(e,B));g("facet/updateSortCriterion",e=>S(e,{facetId:B,criterion:new Y({required:!0})}));g("facet/updateNumberOfValues",e=>S(e,{facetId:B,numberOfValues:new I({required:!0,min:1})}));g("facet/updateIsFieldExpanded",e=>S(e,{facetId:B,isFieldExpanded:new M({required:!0})}));g("facet/updateFreezeCurrentValues",e=>S(e,{facetId:B,freezeCurrentValues:new M({required:!0})}));g("rangeFacet/updateSortCriterion",e=>S(e,{facetId:B,criterion:new Y({required:!0})}));var co={state:w,start:new I({required:!0}),end:new I({required:!0}),endInclusive:new M({required:!0}),numberOfResults:new I({required:!0,min:0})},uo={start:w,end:w,endInclusive:new M({required:!0}),state:w,numberOfResults:new I({required:!0,min:0})};var Hg={start:w,end:w,endInclusive:new M({required:!0}),state:w},Wg={facetId:B,field:w,currentValues:new z({required:!1,each:new F({values:Hg})}),generateAutomaticRanges:new M({required:!0}),filterFacetCount:new M({required:!1}),injectionDepth:new I({required:!1,min:0}),numberOfValues:new I({required:!1,min:1}),sortCriteria:new Y({required:!1}),rangeAlgorithm:new Y({required:!1})};function Bu(e){return ft(e)?Vr(e):e}function $u(e){e.currentValues&&e.currentValues.forEach(t=>{let{start:r,end:n}=Mu(t);if(cr(Bu(r)).isAfter(cr(Bu(n))))throw new Error(`The start value is greater than the end value for the date range ${t.start} to ${t.end}`)});}g("dateFacet/register",e=>{try{return Re(e,Wg),$u(e),{payload:e,error:null}}catch(t){return {payload:e,error:We(t)}}});var Qu=g("dateFacet/toggleSelectValue",e=>S(e,{facetId:B,selection:new F({values:uo})})),zu=g("dateFacet/toggleExcludeValue",e=>S(e,{facetId:B,selection:new F({values:uo})})),Hu=g("dateFacet/updateFacetValues",e=>{try{return Re(e,{facetId:B,values:new z({each:new F({values:uo})})}),$u({currentValues:e.values}),{payload:e,error:null}}catch(t){return {payload:e,error:We(t)}}});var Yg={state:w,start:new I({required:!0}),end:new I({required:!0}),endInclusive:new M({required:!0})},Gg={facetId:B,field:w,currentValues:new z({required:!1,each:new F({values:Yg})}),generateAutomaticRanges:new M({required:!0}),filterFacetCount:new M({required:!1}),injectionDepth:new I({required:!1,min:0}),numberOfValues:new I({required:!1,min:1}),sortCriteria:new Y({required:!1}),rangeAlgorithm:new Y({required:!1})};function Wu(e){e.currentValues&&e.currentValues.forEach(({start:t,end:r})=>{if(t>r)throw new Error(`The start value is greater than the end value for the numeric range ${t} to ${r}`)});}g("numericFacet/register",e=>{try{return S(e,Gg),Wu(e),{payload:e,error:null}}catch(t){return {payload:e,error:We(t)}}});var Yu=g("numericFacet/toggleSelectValue",e=>S(e,{facetId:B,selection:new F({values:co})})),Gu=g("numericFacet/toggleExcludeValue",e=>S(e,{facetId:B,selection:new F({values:co})})),Ku=g("numericFacet/updateFacetValues",e=>{try{return Re(e,{facetId:B,values:new z({each:new F({values:co})})}),Wu({currentValues:e.values}),{payload:e,error:null}}catch(t){return {payload:e,error:We(t)}}});var Ju=e=>e.error!==void 0;function lo(e,t){let r={};e.forEach(i=>r[i.facetId]=i);let n=[];t.forEach(i=>{i in r&&(n.push(r[i]),delete r[i]);});let o=Object.values(r);return [...n,...o]}function et(e){return Object.values(e).map(t=>t.request)}var Ji=()=>Ce("search/logFetchMoreResults",e=>e.makeFetchMoreResults()),Ue=e=>Ce("search/queryError",(t,r)=>t.makeQueryError({query:r.query?.q||ve().q,aq:r.advancedSearchQueries?.aq||mt().aq,cq:r.advancedSearchQueries?.cq||mt().cq,dq:r.advancedSearchQueries?.dq||mt().dq,errorType:e.type,errorMessage:e.message}));var Xi=(r=>(r.Relevance="relevance",r.Fields="fields",r))(Xi||{}),Xu=(r=>(r.Ascending="asc",r.Descending="desc",r))(Xu||{});new F({options:{required:!1},values:{by:new kt({enum:Xi,required:!0}),fields:new z({each:new F({values:{name:new A,direction:new kt({enum:Xu})}})})}});var Zu=()=>vc("analytics/productListing/load",e=>e.makeInterfaceLoad(),e=>new xt(e));g("productlisting/setUrl",e=>S(e,{url:new A({required:!0,url:!0})}));g("productlisting/setAdditionalFields",e=>S(e,{additionalFields:new z({required:!0,each:new A({required:!0,emptyAllowed:!1})})}));var el=W("productlisting/fetch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:o})=>{let i=t(),{apiClient:a}=o,s=await a.getProducts(await Jg(i));return Ju(s)?(r(Ue(s.error)),n(s.error)):{response:s.success,analyticsAction:Zu()}}),Jg=async e=>{let t=Zg(e),r=await _e(e.configuration.analytics);return {accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,platformUrl:e.configuration.platformUrl,url:e.productListing?.url,...e.configuration.analytics.enabled&&r?{clientId:r}:{},...e.productListing.additionalFields?.length?{additionalFields:e.productListing.additionalFields}:{},...e.productListing.advancedParameters&&Xg(e.productListing.advancedParameters)?{advancedParameters:e.productListing.advancedParameters||{}}:{},...t.length&&{facets:{requests:t}},...e.pagination&&{pagination:{numberOfValues:e.pagination.numberOfResults,page:Math.ceil(e.pagination.firstResult/(e.pagination.numberOfResults||1))+1}},...(e.sort?.by||"relevance")!=="relevance"&&{sort:e.sort},...e.context&&{userContext:e.context.contextValues}}};function Xg(e){return e.debug}function Zg(e){return lo(eh(e),e.facetOrder??[])}function eh(e){return [...et(e.facetSet??{}),...et(e.numericFacetSet??{}),...et(e.dateFacetSet??{}),...et(e.categoryFacetSet??{})]}var po=g("facet/updateFacetAutoSelection",e=>S(e,{allow:new M({required:!0})}));var mo=class extends lt{constructor(r){super(r);this.getState=r;}get activeInstantResultQuery(){let r=this.getState().instantResults;for(let n in r)for(let o in r[n].cache)if(r[n].cache[o].isActive)return r[n].q;return null}get activeInstantResultCache(){let r=this.getState().instantResults;for(let n in r)for(let o in r[n].cache)if(r[n].cache[o].isActive)return r[n].cache[o];return null}get results(){return this.activeInstantResultCache?.results}get queryText(){return this.activeInstantResultQuery??ve().q}get responseTime(){return this.activeInstantResultCache?.duration??Te().duration}get numberOfResults(){return this.activeInstantResultCache?.totalCountFiltered??Te().response.totalCountFiltered}getSearchUID(){return this.activeInstantResultCache?.searchUid||super.getSearchUID()}};var tl=()=>Ce("analytics/instantResult/searchboxAsYouType",e=>e.makeSearchboxAsYouType(),e=>new mo(e)),rl=()=>({actionCause:"searchboxAsYouType"});var Zi={id:w},th={...Zi,q:ie};g("instantResults/register",e=>S(e,Zi));var fo=g("instantResults/updateQuery",e=>S(e,th));g("instantResults/clearExpired",e=>S(e,Zi));var go=new I({required:!0,min:0}),ho=g("pagination/registerNumberOfResults",e=>S(e,go)),yo=g("pagination/updateNumberOfResults",e=>S(e,go)),So=g("pagination/registerPage",e=>S(e,go)),gt=g("pagination/updatePage",e=>S(e,go)),vo=g("pagination/nextPage"),Co=g("pagination/previousPage");var ht=g("query/updateQuery",e=>S(e,{q:new A,enableQuerySyntax:new M}));function nl(e){return e.type==="dateRange"}function ol(e){return `start${e}`}function il(e){return `end${e}`}var rh=()=>({dateFacetValueMap:{}});function nh(e,t,r){let n=e.start,o=e.end;return ft(n)&&(n=Vr(n),r.dateFacetValueMap[t][ol(n)]=e.start),ft(o)&&(o=Vr(o),r.dateFacetValueMap[t][il(o)]=e.end),{...e,start:n,end:o}}function oh(e,t){if(nl(e)){let{facetId:r,currentValues:n}=e;return t.dateFacetValueMap[r]={},{...e,currentValues:n.map(o=>nh(o,r,t))}}return e}function ur(e){let t=rh();return {request:{...e,facets:e.facets?.map(n=>oh(n,t))},mappings:t}}function ih(e,t,r){return {...e,start:r.dateFacetValueMap[t][ol(e.start)]||e.start,end:r.dateFacetValueMap[t][il(e.end)]||e.end}}function ah(e,t){return e.facetId in t.dateFacetValueMap}function sh(e,t){return ah(e,t)?{...e,values:e.values.map(r=>ih(r,e.facetId,t))}:e}function Ao(e,t){return "success"in e?{success:{...e.success,facets:e.success.facets?.map(n=>sh(n,t))}}:e}var ce=async(e,t)=>{let r=fh(e),n=ch(e),o=uh(e),i=e.configuration.analytics.analyticsMode==="legacy"?await nr(e,t):await or(e,t),a=()=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0;return ur({...i,...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="next",options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="legacy"},...r&&{cq:r},...n.length&&{facets:n},...e.pagination&&{numberOfResults:a(),firstResult:e.pagination.firstResult},...e.facetOptions&&{facetOptions:{freezeFacetOrder:e.facetOptions.freezeFacetOrder}},...e.folding?.enabled&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.automaticFacetSet&&{generateAutomaticFacets:{desiredCount:e.automaticFacetSet.desiredCount,numberOfValues:e.automaticFacetSet.numberOfValues,currentFacets:o}},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})};function ch(e){return lo(dh(e),e.facetOrder??[])}function uh(e){let t=e.automaticFacetSet?.set;return t?Object.values(t).map(r=>r.response).map(lh).filter(r=>r.currentValues.length>0):void 0}function lh(e){let{field:t,label:r,values:n}=e,o=n.filter(i=>i.state==="selected");return {field:t,label:r,currentValues:o}}function dh(e){return ph(e).filter(({facetId:t})=>e.facetOptions?.facets[t]?.enabled??!0)}function ph(e){return [...mh(e.facetSet??{}),...al(e.numericFacetSet??{}),...al(e.dateFacetSet??{}),...et(e.categoryFacetSet??{})]}function mh(e){return et(e).map(t=>t.sortCriteria==="alphanumericDescending"?{...t,sortCriteria:{type:"alphanumeric",order:"descending"}}:t)}function al(e){return et(e).map(t=>{let n=t.currentValues.some(({state:o})=>o!=="idle");return t.generateAutomaticRanges&&!n?{...t,currentValues:[]}:t})}function fh(e){let t=e.advancedSearchQueries?.cq.trim()||"",n=Object.values(e.tabSet||{}).find(i=>i.isActive)?.expression.trim()||"",o=gh(e);return [t,n,...o].filter(i=>!!i).join(" AND ")}function gh(e){return Object.values(e.staticFilterSet||{}).map(r=>{let n=r.values.filter(i=>i.state==="selected"&&!!i.expression.trim()),o=n.map(i=>i.expression).join(" OR ");return n.length>1?`(${o})`:o})}g("didYouMean/enable");g("didYouMean/disable");g("didYouMean/automaticCorrections/disable");g("didYouMean/automaticCorrections/enable");var bo=g("didYouMean/correction",e=>S(e,w));g("didYouMean/automaticCorrections/mode",e=>S(e,new A({constrainTo:["next","legacy"],emptyAllowed:!1,required:!0})));var ea=()=>Ce("analytics/didyoumean/automatic",e=>e.makeDidYouMeanAutomatic());var sl=()=>({actionCause:"didyoumeanAutomatic"});function cl(){return {freezeFacetOrder:!1,facets:{}}}function ul(){return []}function _r(){return {firstResult:0,defaultNumberOfResults:10,numberOfResults:10,totalCountFiltered:0}}function ll(){return {}}function dl(){return {}}function pl(){return {}}function je(e){return {context:e.context||Kn(),dictionaryFieldContext:e.dictionaryFieldContext||Xn(),facetSet:e.facetSet||Dn(),numericFacetSet:e.numericFacetSet||Tn(),dateFacetSet:e.dateFacetSet||On(),categoryFacetSet:e.categoryFacetSet||kn(),automaticFacetSet:e.automaticFacetSet??In(),pagination:e.pagination||_r(),query:e.query||ve(),tabSet:e.tabSet||pl(),advancedSearchQueries:e.advancedSearchQueries||mt(),staticFilterSet:e.staticFilterSet||dl(),querySet:e.querySet||ll(),sortCriteria:e.sortCriteria||qn(),pipeline:e.pipeline||jt(),searchHub:e.searchHub||ut(),facetOptions:e.facetOptions||cl(),facetOrder:e.facetOrder??ul(),debug:e.debug??fn()}}new F({values:{undoneQuery:ie},options:{required:!0}});var ml=()=>Ce("analytics/trigger/query",(e,t)=>t.triggers?.queryModification.newQuery?e.makeTriggerQuery():null);var xo=g("trigger/query/ignore",e=>S(e,new A({emptyAllowed:!0,required:!0}))),wo=g("trigger/query/modification",e=>S(e,new F({values:{originalQuery:X,modification:X}})));var yt=class{constructor(t,r=n=>{this.dispatch(ht({q:n}));}){this.config=t;this.onUpdateQueryForCorrection=r;}async fetchFromAPI({mappings:t,request:r},n){let o=new Date().getTime(),i=Ao(await this.extra.apiClient.search(r,n),t),a=new Date().getTime()-o,s=this.getState().query?.q||"";return {response:i,duration:a,queryExecuted:s,requestExecuted:r}}async process(t){return this.processQueryErrorOrContinue(t)??await this.processQueryCorrectionsOrContinue(t)??await this.processQueryTriggersOrContinue(t)??this.processSuccessResponse(t)}processQueryErrorOrContinue(t){return pe(t.response)?(this.dispatch(Ue(t.response.error)),this.rejectWithValue(t.response.error)):null}async processQueryCorrectionsOrContinue(t){let r=this.getState(),n=this.getSuccessResponse(t);if(!n||!r.didYouMean)return null;let{enableDidYouMean:o,automaticallyCorrectQuery:i}=r.didYouMean,{results:a,queryCorrections:s,queryCorrection:u}=n;if(!o||!i)return null;let c=a.length===0&&s&&s.length!==0,l=!D(u)&&!D(u.correctedQuery);if(!c&&!l)return null;let h=c?await this.processLegacyDidYouMeanAutoCorrection(t):this.processModernDidYouMeanAutoCorrection(t);return this.dispatch(Ve(je(this.getState()))),h}async processLegacyDidYouMeanAutoCorrection(t){let r=this.getCurrentQuery(),n=this.getSuccessResponse(t);if(!n.queryCorrections)return null;let{correctedQuery:o}=n.queryCorrections[0],i=await this.automaticallyRetryQueryWithCorrection(o);return pe(i.response)?(this.dispatch(Ue(i.response.error)),this.rejectWithValue(i.response.error)):(this.logOriginalAnalyticsQueryBeforeAutoCorrection(t),this.dispatch(Ve(je(this.getState()))),{...i,response:{...i.response.success,queryCorrections:n.queryCorrections},automaticallyCorrected:!0,originalQuery:r,analyticsAction:ea()})}processModernDidYouMeanAutoCorrection(t){let r=this.getSuccessResponse(t),{correctedQuery:n,originalQuery:o}=r.queryCorrection;return this.onUpdateQueryForCorrection(n),{...t,response:{...r},queryExecuted:n,automaticallyCorrected:!0,originalQuery:o,analyticsAction:ea()}}logOriginalAnalyticsQueryBeforeAutoCorrection(t){let r=this.getState(),n=this.getSuccessResponse(t);this.analyticsAction&&this.analyticsAction()(this.dispatch,()=>this.getStateAfterResponse(t.queryExecuted,t.duration,r,n),this.extra);}async processQueryTriggersOrContinue(t){let r=this.getSuccessResponse(t);if(!r)return null;let n=r.triggers.find(s=>s.type==="query")?.content||"";if(!n)return null;if(this.getState().triggers?.queryModification.queryToIgnore===n)return this.dispatch(xo("")),null;this.analyticsAction&&await this.dispatch(this.analyticsAction);let i=this.getCurrentQuery(),a=await this.automaticallyRetryQueryWithTriggerModification(n);return pe(a.response)?(this.dispatch(Ue(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(Ve(je(this.getState()))),{...a,response:{...a.response.success},automaticallyCorrected:!1,originalQuery:i,analyticsAction:ml()})}getStateAfterResponse(t,r,n,o){return {...n,query:{q:t,enableQuerySyntax:n.query?.enableQuerySyntax??ve().enableQuerySyntax},search:{...Te(),duration:r,response:o,results:o.results}}}processSuccessResponse(t){return this.dispatch(Ve(je(this.getState()))),{...t,response:this.getSuccessResponse(t),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(t){return Kr(t.response)?t.response.success:null}async automaticallyRetryQueryWithCorrection(t){this.onUpdateQueryForCorrection(t);let r=await this.fetchFromAPI(await ce(this.getState()),{origin:"mainSearch"});return this.dispatch(bo(t)),r}async automaticallyRetryQueryWithTriggerModification(t){return this.dispatch(wo({newQuery:t,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(t),await this.fetchFromAPI(await ce(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){let t=this.getState();return t.query?.q!==void 0?t.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get analyticsAction(){return this.config.analyticsAction}get rejectWithValue(){return this.config.rejectWithValue}};W("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;S(e,{q:new A,enableQuerySyntax:new M,clearFilters:new M}),e.clearFilters&&(r(ar()),r(oo())),r(po({allow:!0})),r(ht({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(gt(1));});W("search/executeSearch",async(e,t)=>{let r=t.getState();return await Po(r,t,e)});W("search/fetchPage",async(e,t)=>{let r=t.getState();return await ra(r,t,e)});W("search/fetchMoreResults",async(e,t)=>{let r=t.getState();return await na(t,r)});W("search/fetchFacetValues",async(e,t)=>{let r=t.getState();return await vh(t,e,r)});W("search/fetchInstantResults",async(e,t)=>ta(e,t));var hh=async(e,t)=>{let r=await ce(e,t);return r.request={...r.request,firstResult:(e.pagination?.firstResult??0)+(e.search?.results.length??0)},r},yh=async(e,t,r)=>{let n=await nr(e);return ur({...n,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},Sh=async(e,t)=>{let r=await ce(e,t);return r.request.numberOfResults=0,r},fl=e=>{e.configuration.analytics.enabled&&xe.addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)});};async function ta(e,t){S(e,{id:w,q:w,maxResultsPerQuery:new I({required:!0,min:1}),cacheTimeout:new I});let{q:r,maxResultsPerQuery:n}=e,o=t.getState(),i=new yt({...t,analyticsAction:tl()},c=>{t.dispatch(fo({q:c,id:e.id}));}),a=await yh(o,r,n),s=await i.fetchFromAPI(a,{origin:"instantResults",disableAbortWarning:!0}),u=await i.process(s);return "response"in u?{results:u.response.results,searchUid:u.response.searchUid,analyticsAction:u.analyticsAction,totalCountFiltered:u.response.totalCountFiltered,duration:u.duration}:u}async function ra(e,t,r){fl(e);let{analyticsClientMiddleware:n,preprocessRequest:o,logger:i}=t.extra,{description:a}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:o,logger:i}),s=new yt({...t,analyticsAction:r}),u=await ce(e,a),c=await s.fetchFromAPI(u,{origin:"mainSearch"});return await s.process(c)}async function na(e,t){let{analyticsClientMiddleware:r,preprocessRequest:n,logger:o}=e.extra,{description:i}=await Ji().prepare({getState:()=>e.getState(),analyticsClientMiddleware:r,preprocessRequest:n,logger:o}),a=new yt({...e,analyticsAction:Ji()}),s=await hh(t,i),u=await a.fetchFromAPI(s,{origin:"mainSearch"});return await a.process(u)}async function vh(e,t,r){let{analyticsClientMiddleware:n,preprocessRequest:o,logger:i}=e.extra,{description:a}=await t.prepare({getState:()=>e.getState(),analyticsClientMiddleware:n,preprocessRequest:o,logger:i}),s=new yt({...e,analyticsAction:t}),u=await Sh(r,a),c=await s.fetchFromAPI(u,{origin:"facetValues"});return await s.process(c)}async function Po(e,t,r){fl(e);let{analyticsClientMiddleware:n,preprocessRequest:o,logger:i}=t.extra,{description:a}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:o,logger:i}),s=await ce(e,a),u=new yt({...t,analyticsAction:r}),c=await u.fetchFromAPI(s,{origin:"mainSearch"});return await u.process(c)}var St=class{constructor(t,r=n=>{this.dispatch(ht({q:n}));}){this.config=t;this.onUpdateQueryForCorrection=r;}async fetchFromAPI({mappings:t,request:r},n){let o=new Date().getTime(),i=Ao(await this.extra.apiClient.search(r,n),t),a=new Date().getTime()-o,s=this.getState().query?.q||"";return {response:i,duration:a,queryExecuted:s,requestExecuted:r}}async process(t){return this.processQueryErrorOrContinue(t)??await this.processQueryCorrectionsOrContinue(t)??await this.processQueryTriggersOrContinue(t)??this.processSuccessResponse(t)}processQueryErrorOrContinue(t){return pe(t.response)?(this.dispatch(Ue(t.response.error)),this.rejectWithValue(t.response.error)):null}async processQueryCorrectionsOrContinue(t){let r=this.getState(),n=this.getSuccessResponse(t);if(!n||!r.didYouMean)return null;let{enableDidYouMean:o,automaticallyCorrectQuery:i}=r.didYouMean,{results:a,queryCorrections:s,queryCorrection:u}=n;if(!o||!i)return null;let c=a.length===0&&s&&s.length!==0,l=!D(u)&&!D(u.correctedQuery);if(!c&&!l)return null;let h=c?await this.processLegacyDidYouMeanAutoCorrection(t):this.processModernDidYouMeanAutoCorrection(t);return this.dispatch(Ve(je(this.getState()))),h}async processLegacyDidYouMeanAutoCorrection(t){let r=this.getCurrentQuery(),n=this.getSuccessResponse(t);if(!n.queryCorrections)return null;let{correctedQuery:o}=n.queryCorrections[0],i=await this.automaticallyRetryQueryWithCorrection(o);return pe(i.response)?(this.dispatch(Ue(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(Ve(je(this.getState()))),{...i,response:{...i.response.success,queryCorrections:n.queryCorrections},automaticallyCorrected:!0,originalQuery:r})}processModernDidYouMeanAutoCorrection(t){let r=this.getSuccessResponse(t),{correctedQuery:n,originalQuery:o}=r.queryCorrection;return this.onUpdateQueryForCorrection(n),{...t,response:{...r},queryExecuted:n,automaticallyCorrected:!0,originalQuery:o}}async processQueryTriggersOrContinue(t){let r=this.getSuccessResponse(t);if(!r)return null;let n=r.triggers.find(s=>s.type==="query")?.content||"";if(!n)return null;if(this.getState().triggers?.queryModification.queryToIgnore===n)return this.dispatch(xo("")),null;let i=this.getCurrentQuery(),a=await this.automaticallyRetryQueryWithTriggerModification(n);return pe(a.response)?(this.dispatch(Ue(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(Ve(je(this.getState()))),{...a,response:{...a.response.success},automaticallyCorrected:!1,originalQuery:i})}processSuccessResponse(t){return this.dispatch(Ve(je(this.getState()))),{...t,response:this.getSuccessResponse(t),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery()}}getSuccessResponse(t){return Kr(t.response)?t.response.success:null}async automaticallyRetryQueryWithCorrection(t){this.onUpdateQueryForCorrection(t);let r=this.getState(),{actionCause:n}=sl(),o=await this.fetchFromAPI(await ce(r,{actionCause:n}),{origin:"mainSearch"});return this.dispatch(bo(t)),o}async automaticallyRetryQueryWithTriggerModification(t){return this.dispatch(wo({newQuery:t,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(t),await this.fetchFromAPI(await ce(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){let t=this.getState();return t.query?.q!==void 0?t.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}};W("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;S(e,{q:new A,enableQuerySyntax:new M,clearFilters:new M}),e.clearFilters&&(r(ar()),r(oo())),r(po({allow:!0})),r(ht({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(gt(1));});var gl=W("search/executeSearch",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return Po(r,t,e.legacy);hl(r);let n=oa(e.next),o=await ce(r,n),i=new St({...t,analyticsAction:n}),a=await i.fetchFromAPI(o,{origin:"mainSearch"});return await i.process(a)});W("search/fetchPage",async(e,t)=>{let r=t.getState();if(hl(r),r.configuration.analytics.analyticsMode==="legacy"||!e.next)return ra(r,t,e.legacy);let n=new St({...t,analyticsAction:e.next}),o=await ce(r,e.next),i=await n.fetchFromAPI(o,{origin:"mainSearch"});return await n.process(i)});W("search/fetchMoreResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return na(t,r);let n=Sc("pagerScrolling",t.getState),o=new St({...t,analyticsAction:n}),i=await Ch(r,n),a=await o.fetchFromAPI(i,{origin:"mainSearch"});return await o.process(a)});W("search/fetchFacetValues",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return Po(r,t,e.legacy);let n=oa(e.next),o=new St({...t,analyticsAction:n}),i=await Rh(r,n),a=await o.fetchFromAPI(i,{origin:"facetValues"});return await o.process(a)});W("search/fetchInstantResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return ta(e,t);S(e,{id:w,q:w,maxResultsPerQuery:new I({required:!0,min:1}),cacheTimeout:new I});let{q:n,maxResultsPerQuery:o}=e,i=oa(rl()),a=await Ah(r,n,o,i),s=new St({...t,analyticsAction:i},l=>{t.dispatch(fo({q:l,id:e.id}));}),u=await s.fetchFromAPI(a,{origin:"instantResults",disableAbortWarning:!0}),c=await s.process(u);return "response"in c?{results:c.response.results,searchUid:c.response.searchUid,totalCountFiltered:c.response.totalCountFiltered,duration:c.duration}:c});var Ch=async(e,t)=>{let r=await ce(e,t);return r.request={...r.request,firstResult:(e.pagination?.firstResult??0)+(e.search?.results.length??0)},r},Ah=async(e,t,r,n)=>{let o=await or(e,n);return ur({...o,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},Rh=async(e,t)=>{let r=await ce(e,t);return r.request.numberOfResults=0,r},hl=e=>{e.configuration.analytics.enabled&&xe.addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)});},oa=e=>({actionCause:e.actionCause,type:e.actionCause});var yl=J(_r(),e=>{e.addCase(ho,(t,r)=>{let n=ia(t),o=r.payload;t.defaultNumberOfResults=t.numberOfResults=o,t.firstResult=Lr(n,o);}).addCase(yo,(t,r)=>{t.numberOfResults=r.payload,t.firstResult=0;}).addCase(Un,t=>{t.firstResult=0;}).addCase(So,(t,r)=>{let n=r.payload;t.firstResult=Lr(n,t.numberOfResults);}).addCase(gt,(t,r)=>{let n=r.payload;t.firstResult=Lr(n,t.numberOfResults);}).addCase(Co,t=>{let r=ia(t),n=Math.max(r-1,1);t.firstResult=Lr(n,t.numberOfResults);}).addCase(vo,t=>{let r=ia(t),n=xh(t),o=Math.min(r+1,n);t.firstResult=Lr(o,t.numberOfResults);}).addCase(fe.fulfilled,(t,r)=>{r.payload&&(t.numberOfResults=r.payload.pagination.numberOfResults,t.firstResult=r.payload.pagination.firstResult);}).addCase(at,(t,r)=>{t.firstResult=r.payload.firstResult??t.firstResult,t.numberOfResults=r.payload.numberOfResults??t.defaultNumberOfResults;}).addCase(gl.fulfilled,(t,r)=>{let{response:n}=r.payload;t.totalCountFiltered=n.totalCountFiltered;}).addCase(el.fulfilled,(t,r)=>{let{response:n}=r.payload;t.totalCountFiltered=n.pagination.totalCount;}).addCase(so,t=>{ue(t);}).addCase(zu,t=>{ue(t);}).addCase(Uu,t=>{ue(t);}).addCase(Gu,t=>{ue(t);}).addCase(Au,t=>{ue(t);}).addCase(Lu,t=>{ue(t);}).addCase(yu,t=>{ue(t);}).addCase(hu,t=>{ue(t);}).addCase(Su,t=>{ue(t);}).addCase(Qu,t=>{ue(t);}).addCase(Yu,t=>{ue(t);}).addCase(ar,t=>{ue(t);}).addCase(Hu,t=>{ue(t);}).addCase(Ku,t=>{ue(t);}).addCase(Cu,t=>{ue(t);}).addCase(gu,t=>{ue(t);});});function ue(e){e.firstResult=_r().firstResult;}function ia(e){let{firstResult:t,numberOfResults:r}=e;return wh(t,r)}function xh(e){let{totalCountFiltered:t,numberOfResults:r}=e;return Ph(t,r)}function Lr(e,t){return (e-1)*t}function wh(e,t){return Math.round(e/t)+1}function Ph(e,t){let r=Math.min(e,5e3);return Math.ceil(r/t)}function Sl(e){return e.addReducers({pagination:yl}),{nextPage:vo,previousPage:Co,registerNumberOfResults:ho,registerPage:So,updateNumberOfResults:yo,updatePage:gt}}function It(e){let t,r=new Map,n=()=>r.size===0,o=i=>{try{let a=JSON.stringify(i),s=t!==a;return t=a,s}catch(a){return console.warn('Could not detect if state has changed, check the controller "get state method"',a),!0}};return {subscribe(i){i();let a=Symbol(),s;return n()&&(t=JSON.stringify(this.state),s=e.subscribe(()=>{o(this.state)&&r.forEach(u=>u());})),r.set(a,i),()=>{r.delete(a),n()&&s&&s();}},get state(){return {}}}}var Eh=new le({id:new A({emptyAllowed:!0,required:!1,default:""}),numberOfRecommendations:new I({min:0})});function Fh(e,t={}){if(!Ih(e));let r=It(e),{dispatch:n}=e,o=()=>e.state,i=Ps(e,Eh,t.options,"buildRecommendationList");return i.id!==""&&n(Kt({id:i.id})),i.numberOfRecommendations&&n(Sl(e).updateNumberOfResults(i.numberOfRecommendations)),{...r,refresh(){n(dt());},get state(){let a=o();return {recommendations:a.recommendation.recommendations,error:a.recommendation.error,isLoading:a.recommendation.isLoading,searchResponseId:a.recommendation.searchUid}}}}function Ih(e){return e.addReducers({recommendation:Jt,configuration:Le}),!0}function vl(e,t,r){if(!kh(e));let n=1e3,o={selectionDelay:n,debounceWait:n,...t.options},i;return {select:$n(r,o.debounceWait,{isImmediate:!0}),beginDelayedSelect(){i=setTimeout(r,o.selectionDelay);},cancelPendingSelect(){i&&clearTimeout(i);}}}function kh(e){return e.addReducers({configuration:Le}),!0}function Oh(e,t){let r=!1,n=()=>{r||(r=!0,e.dispatch(Ln(t.options.result)));};return vl(e,t,()=>{n();})}new le({values:new F({options:{required:!1}})});new le({content:new Y({required:!0}),conditions:new Y({required:!0}),priority:new I({required:!1,default:0,min:0}),fields:new z({required:!1,each:w})});sa();/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

exports.Fh = Fh;
exports.Ig = Ig;
exports.OP = OP;
exports.Oh = Oh;
exports.Ox = Ox;
exports._x = _x;
exports.bg = bg;
exports.gr = gr;
exports.pP = pP;

//# sourceMappingURL=headless.esm-30732e14.js.map