import{N as h,g as a,O as m}from"./atomic-breadbox.new.stories-D5_t4T0B.js";import{a as p,M as f}from"./p-e12016d2-bJLTunAq.js";import{r as c}from"./p-55d2bcf3-DJQIxeeN.js";import{m as y}from"./p-107c3d7f-DmNnGT81.js";import{s as g}from"./p-f5723aee-D-iZ1npx.js";import{e as V}from"./p-f88eced6-CQRna4eO.js";import"./index-Bqoxw6Vv.js";import"./_commonjsHelpers-BosuxZz1.js";import"./iframe-0V_eukm8.js";import"../sb-preview/runtime.js";import"./p-1580513b-3LX64KEr.js";import"./p-e9c4f463-BPmi-3c5.js";import"./p-529fdce5-BbBbPjoU.js";const v=":host>ul{display:flex;list-style:none;margin:0;padding:0}:host>ul li{display:inline-block}.separator::before{display:inline;content:',\\00a0'}",b=v;var d=function(e,t,r,i){var l=arguments.length,s=l<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,r):i,n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,i);else for(var u=e.length-1;u>=0;u--)(n=e[u])&&(s=(l<3?n(s):l>3?n(t,r,s):n(t,r))||s);return l>3&&s&&Object.defineProperty(t,r,s),s};const o=class{constructor(e){h(this,e),this.maxValuesToDisplay=3,this.delimiter=null,this.sortedValues=null,this.error=void 0,this.field=void 0,this.maxValuesToDisplay=3,this.delimiter=null}initialize(){this.breadcrumbManager=p(this.bindings.engine)}get resultValues(){const e=f.getResultProperty(this.result,this.field);return e===null?null:Array.isArray(e)?e.map(t=>`${t}`.trim()):typeof e!="string"||e.trim()===""?(this.error=new Error(`Could not parse "${e}" from field "${this.field}" as a string array.`),null):this.delimiter?e.split(this.delimiter).map(t=>t.trim()):[e]}get facetSelectedValues(){return this.breadcrumbManager.state.facetBreadcrumbs.filter(e=>e.field===this.field).reduce((e,t)=>[...e,...t.values.map(({value:r})=>r.value)],[])}updateSortedValues(){const e=this.resultValues;if(e===null){this.sortedValues=null;return}const t=new Set(e),r=this.facetSelectedValues.filter(i=>t.has(i));this.sortedValues=Array.from(e.reduce((i,l)=>i.add(l),new Set(r)))}getShouldDisplayLabel(e){return this.maxValuesToDisplay>0&&e.length>this.maxValuesToDisplay}getNumberOfValuesToDisplay(e){return e.length<=this.maxValuesToDisplay?e.length:this.maxValuesToDisplay<2?this.maxValuesToDisplay:Math.min(e.length-2,this.maxValuesToDisplay)}renderValue(e){const t=c(this.field,e,this.bindings.i18n),r=g(e);return a("li",{key:e,part:"result-multi-value-text-value"},a("slot",{name:`result-multi-value-text-value-${r}`},t))}renderSeparator(e,t){return a("li",{"aria-hidden":"true",part:"result-multi-value-text-separator",key:`${e}~${t}`,class:"separator"})}renderMoreLabel(e){return a("li",{key:"more-field-values",part:"result-multi-value-text-value-more"},this.bindings.i18n.t("n-more",{value:e}))}renderListItems(e){const t=this.getNumberOfValuesToDisplay(e),r=[];for(let i=0;i<t;i++)i>0&&r.push(this.renderSeparator(e[i-1],e[i])),r.push(this.renderValue(e[i]));return this.getShouldDisplayLabel(e)&&(r.push(this.renderSeparator(e[t-1],"more-field-values")),r.push(this.renderMoreLabel(e.length-t))),r}componentWillRender(){this.updateSortedValues()}render(){if(this.sortedValues===null){this.host.remove();return}return a("ul",{part:"result-multi-value-text-list"},...this.renderListItems(this.sortedValues))}get host(){return m(this)}};d([y()],o.prototype,"bindings",void 0);d([V()],o.prototype,"result",void 0);o.style=b;export{o as atomic_result_multi_value_text};
