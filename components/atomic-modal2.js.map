{"file":"atomic-modal2.js","mappings":"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","names":[],"sources":["src/components/common/atomic-modal/atomic-modal.pcss?tag=atomic-modal&encapsulation=shadow","src/components/common/atomic-modal/atomic-modal.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\n\n[part='backdrop'] {\n  @apply pointer-events-none;\n}\n\natomic-focus-trap {\n  @apply contents;\n}\n\n[part='container'] {\n  @apply overflow-hidden;\n  grid-area: modal;\n}\n\n.animate-scaleUpModalIPX[part='container'] {\n  @apply rounded shadow;\n}\n\n:host(.open) {\n  [part='backdrop'] {\n    @apply pointer-events-auto;\n  }\n}\n\n:host(.open.dialog) {\n  [part='backdrop'] {\n    background-color: rgba(40, 40, 40, 0.8);\n  }\n}\n\n:host(.dialog) {\n  [part='backdrop'] {\n    @apply grid p-6;\n    transition: background-color 500ms ease-in-out;\n\n    grid-template-areas:\n      '. .     .'\n      '. modal .'\n      '. .     .';\n\n    grid-template-columns: 1fr min(30rem, 100%) 1fr;\n    grid-template-rows: 1fr auto 3fr;\n  }\n\n  [part='container'] {\n    @apply rounded shadow;\n  }\n\n  [part='header-wrapper'] {\n    @apply px-6 py-4;\n  }\n\n  [part='header'] {\n    @apply font-bold;\n  }\n\n  [part='body-wrapper'] {\n    @apply p-6;\n  }\n\n  [part='footer-wrapper'] {\n    @apply bg-neutral-light;\n    padding: 1rem 1.125rem;\n  }\n}\n\n:host(.fullscreen) {\n  [part='container'] {\n    @apply absolute inset-0;\n  }\n\n  [part='header-wrapper'] {\n    @apply p-6;\n  }\n\n  [part='body-wrapper'] {\n    @apply px-6 pt-8 pb-5;\n  }\n\n  [part='footer-wrapper'] {\n    @apply shadow-t-lg px-6 py-4;\n  }\n}\n","import {\n  Component,\n  h,\n  State,\n  Prop,\n  Element,\n  Watch,\n  Event,\n  EventEmitter,\n  Host,\n  Listen,\n} from '@stencil/core';\nimport {isIOS} from '../../../utils/device-utils';\nimport {listenOnce} from '../../../utils/event-utils';\nimport {\n  InitializableComponent,\n  InitializeBindings,\n} from '../../../utils/initialization-utils';\nimport {updateBreakpoints} from '../../../utils/replace-breakpoint';\nimport {once, randomID} from '../../../utils/utils';\nimport {AnyBindings} from '../interface/bindings';\n\n/**\n * When the modal is opened, the class `atomic-modal-opened` is added to the interfaceElement and the body, allowing further customization.\n *\n * @part backdrop - The transparent backdrop hiding the content behind the modal.\n * @part container - The modal's outermost container with the outline and background.\n * @part header-wrapper - The wrapper around the header.\n * @part header - The header at the top of the modal.\n * @part header-ruler - The horizontal ruler underneath the header.\n * @part body-wrapper - The wrapper around the body.\n * @part body - The body of the modal, between the header and the footer.\n * @part footer-wrapper - The wrapper with a shadow or background color around the footer.\n * @part footer - The footer at the bottom of the modal.\n * @internal\n */\n@Component({\n  tag: 'atomic-modal',\n  styleUrl: 'atomic-modal.pcss',\n  shadow: true,\n})\nexport class AtomicModal implements InitializableComponent<AnyBindings> {\n  @InitializeBindings() public bindings!: AnyBindings;\n  @Element() public host!: HTMLElement;\n\n  @State() public error!: Error;\n\n  @Prop({reflect: true, mutable: true}) fullscreen = false;\n  @Prop({mutable: true}) source?: HTMLElement;\n  /**\n   * The container to hide from the tabindex and accessibility DOM when the modal is closed.\n   */\n  @Prop({mutable: true}) container?: HTMLElement;\n  @Prop({reflect: true, mutable: true}) isOpen = false;\n  @Prop({mutable: true}) close: () => void = () => (this.isOpen = false);\n  @Prop({reflect: true}) scope?: HTMLElement;\n  /**\n   * Whether to display the open and close animations over the entire page or the atomic-modal only.\n   */\n  @Prop({reflect: true}) boundary: 'page' | 'element' = 'page';\n\n  @Event() animationEnded!: EventEmitter<never>;\n\n  private wasEverOpened = false;\n  private headerId = randomID('atomic-modal-header-');\n  private focusTrap?: HTMLAtomicFocusTrapElement;\n  private animatableContainer?: HTMLElement;\n  private currentWatchToggleOpenExecution = 0;\n\n  @Watch('isOpen')\n  async watchToggleOpen(isOpen: boolean) {\n    const watchToggleOpenExecution = ++this.currentWatchToggleOpenExecution;\n    const modalOpenedClass = 'atomic-modal-opened';\n\n    if (isOpen) {\n      this.wasEverOpened = true;\n      //TODO: remove the addition of a class to the body in atomicV3\n      document.body.classList.add(modalOpenedClass);\n      this.bindings.interfaceElement.classList.add(modalOpenedClass);\n      await this.waitForAnimationEnded();\n      if (watchToggleOpenExecution !== this.currentWatchToggleOpenExecution) {\n        return;\n      }\n      this.focusTrap!.active = true;\n    } else {\n      //TODO: remove the removal of a class to the body in atomicV3\n      document.body.classList.remove(modalOpenedClass);\n      this.bindings.interfaceElement.classList.remove(modalOpenedClass);\n      if (isIOS()) {\n        await this.waitForAnimationEnded();\n      }\n      if (watchToggleOpenExecution !== this.currentWatchToggleOpenExecution) {\n        return;\n      }\n      this.focusTrap!.active = false;\n    }\n  }\n\n  @Listen('keyup', {target: 'body'})\n  handleCloseOnEscape(e: KeyboardEvent) {\n    if (e.key?.toLowerCase() === 'escape') {\n      this.close();\n    }\n  }\n\n  private waitForAnimationEnded() {\n    // The focus trap focuses its first child when active. It cannot do that while an animation is ongoing.\n    return new Promise((resolve) =>\n      listenOnce(this.animatableContainer!, 'animationend', resolve)\n    );\n  }\n\n  private getClasses() {\n    const classes: string[] = [];\n    if (this.isOpen) {\n      classes.push('open');\n    }\n    if (this.fullscreen) {\n      classes.push('fullscreen');\n    } else {\n      classes.push('dialog');\n    }\n    return classes;\n  }\n\n  @Listen('touchmove', {passive: false})\n  onWindowTouchMove(e: Event) {\n    this.isOpen && e.preventDefault();\n  }\n\n  public componentDidLoad() {\n    this.watchToggleOpen(this.isOpen);\n  }\n\n  private updateBreakpoints = once(() => updateBreakpoints(this.host));\n\n  public render() {\n    this.updateBreakpoints();\n\n    const Content = () => (\n      <article\n        part=\"container\"\n        class={`flex flex-col justify-between bg-background text-on-background\n          ${this.isOpen ? 'animate-scaleUpModal' : 'animate-slideDownModal'}\n          ${this.wasEverOpened ? '' : 'invisible'}`}\n        onAnimationEnd={() => this.animationEnded.emit()}\n        ref={(ref) => (this.animatableContainer = ref)}\n      >\n        <header part=\"header-wrapper\" class=\"flex flex-col items-center\">\n          <div\n            part=\"header\"\n            class=\"flex justify-between text-xl w-full max-w-lg\"\n            id={this.headerId}\n          >\n            <slot name=\"header\"></slot>\n          </div>\n        </header>\n        <hr part=\"header-ruler\" class=\"border-neutral\"></hr>\n        <div\n          part=\"body-wrapper\"\n          class=\"overflow-auto grow flex flex-col items-center w-full\"\n        >\n          <div\n            part=\"body\"\n            class=\"w-full max-w-lg\"\n            ref={(element) =>\n              element?.addEventListener(\n                'touchmove',\n                (e) => this.isOpen && e.stopPropagation(),\n                {passive: false}\n              )\n            }\n          >\n            <slot name=\"body\"></slot>\n          </div>\n        </div>\n        <footer\n          part=\"footer-wrapper\"\n          class=\"border-neutral border-t bg-background z-10 flex flex-col items-center w-full\"\n        >\n          <div part=\"footer\" class=\"w-full max-w-lg\">\n            <slot name=\"footer\"></slot>\n          </div>\n        </footer>\n      </article>\n    );\n\n    return (\n      <Host class={this.getClasses().join(' ')}>\n        <div\n          part=\"backdrop\"\n          class={`\n            ${this.boundary === 'page' ? 'fixed' : 'absolute'}\n            left-0 top-0 right-0 bottom-0 z-[9999]\n          `}\n          onClick={(e) => e.target === e.currentTarget && this.close()}\n        >\n          <atomic-focus-trap\n            role=\"dialog\"\n            aria-modal={this.isOpen.toString()}\n            aria-labelledby={this.headerId}\n            source={this.source}\n            container={this.container ?? this.host}\n            ref={(ref) => (this.focusTrap = ref)}\n            scope={this.scope}\n          >\n            <Content />\n          </atomic-focus-trap>\n        </div>\n      </Host>\n    );\n  }\n}\n"],"version":3}