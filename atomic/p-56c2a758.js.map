{"version":3,"names":["SmartSnippetFeedbackModalCommon","constructor","props","this","updateBreakpoints","once","getHost","sendFeedback","getCurrentAnswer","getSmartSnippet","sendDetailedFeedback","getDetailsInputRef","value","getFeedbackSent","emit","setIsOpen","close","closeFeedbackModal","renderHeader","h","slot","getBindings","i18n","t","renderOptions","options","id","localeKey","correspondingAnswer","part","class","map","key","type","name","checked","onChange","e","_a","currentTarget","setCurrentAnswer","required","htmlFor","renderDetails","ref","detailsInput","setDetailsInputRef","rows","renderBody","formId","onSubmit","preventDefault","renderFooter","Button","style","onClick","form","render","fullscreen","source","getSource","container","isOpen","getIsOpen","exportparts"],"sources":["src/components/common/smart-snippets/atomic-smart-snippet-feedback-modal/smart-snippet-feedback-modal-common.tsx"],"sourcesContent":["import {SmartSnippet, SmartSnippetFeedback} from '@coveo/headless';\r\nimport {EventEmitter, h} from '@stencil/core';\r\nimport {updateBreakpoints} from '../../../../utils/replace-breakpoint';\r\nimport {once} from '../../../../utils/utils';\r\nimport {Button} from '../../button';\r\nimport {AnyBindings} from '../../interface/bindings';\r\n\r\ninterface SmartSnippetFeedbackModalProps {\r\n  formId: string;\r\n  getHost: () => HTMLElement;\r\n  getBindings: () => AnyBindings;\r\n  getCurrentAnswer: () => SmartSnippetFeedback | 'other' | undefined;\r\n  getSmartSnippet: () => SmartSnippet;\r\n  getDetailsInputRef: () => HTMLTextAreaElement | undefined;\r\n  getFeedbackSent: () => EventEmitter;\r\n  getSource: () => HTMLElement | undefined;\r\n  getIsOpen: () => boolean;\r\n  setIsOpen: (isOpen: boolean) => void;\r\n  setCurrentAnswer: (answer: SmartSnippetFeedback | 'other') => void;\r\n  setDetailsInputRef: (ref?: HTMLTextAreaElement) => void;\r\n}\r\n\r\nexport class SmartSnippetFeedbackModalCommon {\r\n  constructor(private props: SmartSnippetFeedbackModalProps) {}\r\n\r\n  public sendFeedback() {\r\n    if (this.props.getCurrentAnswer() === 'other') {\r\n      this.props\r\n        .getSmartSnippet()\r\n        .sendDetailedFeedback(this.props.getDetailsInputRef()!.value);\r\n    } else {\r\n      this.props\r\n        .getSmartSnippet()\r\n        .sendFeedback(this.props.getCurrentAnswer() as SmartSnippetFeedback);\r\n    }\r\n    this.props.getFeedbackSent().emit();\r\n    this.props.setIsOpen(false);\r\n  }\r\n\r\n  public close() {\r\n    this.props.setIsOpen(false);\r\n    this.props.getSmartSnippet().closeFeedbackModal();\r\n  }\r\n\r\n  private renderHeader() {\r\n    return (\r\n      <h1 slot=\"header\">\r\n        {this.props.getBindings().i18n.t('smart-snippet-feedback-explain-why')}\r\n      </h1>\r\n    );\r\n  }\r\n\r\n  private renderOptions() {\r\n    const options: {\r\n      id: string;\r\n      localeKey: string;\r\n      correspondingAnswer: SmartSnippetFeedback | 'other';\r\n    }[] = [\r\n      {\r\n        id: 'does-not-answer',\r\n        localeKey: 'smart-snippet-feedback-reason-does-not-answer',\r\n        correspondingAnswer: 'does_not_answer',\r\n      },\r\n      {\r\n        id: 'partially-answers',\r\n        localeKey: 'smart-snippet-feedback-reason-partially-answers',\r\n        correspondingAnswer: 'partially_answers',\r\n      },\r\n      {\r\n        id: 'was-not-a-question',\r\n        localeKey: 'smart-snippet-feedback-reason-was-not-a-question',\r\n        correspondingAnswer: 'was_not_a_question',\r\n      },\r\n      {\r\n        id: 'other',\r\n        localeKey: 'smart-snippet-feedback-reason-other',\r\n        correspondingAnswer: 'other',\r\n      },\r\n    ];\r\n\r\n    return (\r\n      <fieldset>\r\n        <legend\r\n          part=\"reason-title\"\r\n          class=\"font-bold text-on-background text-lg\"\r\n        >\r\n          {this.props\r\n            .getBindings()\r\n            .i18n.t('smart-snippet-feedback-select-reason')}\r\n        </legend>\r\n        {options.map(({id, localeKey, correspondingAnswer}) => (\r\n          <div class=\"flex items-center\" key={id} part=\"reason\">\r\n            <input\r\n              part=\"reason-radio\"\r\n              type=\"radio\"\r\n              name=\"answer\"\r\n              id={id}\r\n              checked={this.props.getCurrentAnswer() === correspondingAnswer}\r\n              onChange={(e) =>\r\n                (e.currentTarget as HTMLInputElement | null)?.checked &&\r\n                this.props.setCurrentAnswer(correspondingAnswer)\r\n              }\r\n              class=\"mr-2 w-4 h-4\"\r\n              required\r\n            />\r\n            <label part=\"reason-label\" htmlFor={id}>\r\n              {this.props.getBindings().i18n.t(localeKey)}\r\n            </label>\r\n          </div>\r\n        ))}\r\n      </fieldset>\r\n    );\r\n  }\r\n\r\n  private renderDetails() {\r\n    if (this.props.getCurrentAnswer() !== 'other') {\r\n      return;\r\n    }\r\n\r\n    return (\r\n      <fieldset>\r\n        <legend\r\n          part=\"details-title\"\r\n          class=\"font-bold text-on-background text-lg\"\r\n        >\r\n          {this.props.getBindings().i18n.t('details')}\r\n        </legend>\r\n        <textarea\r\n          part=\"details-input\"\r\n          name=\"answer-details\"\r\n          ref={(detailsInput) => this.props.setDetailsInputRef(detailsInput)}\r\n          class=\"mt-2 p-2 w-full text-base leading-5 border border-neutral resize-none rounded\"\r\n          rows={4}\r\n          required\r\n        ></textarea>\r\n      </fieldset>\r\n    );\r\n  }\r\n\r\n  private renderBody() {\r\n    return (\r\n      <form\r\n        part=\"form\"\r\n        id={this.props.formId}\r\n        slot=\"body\"\r\n        onSubmit={(e) => {\r\n          e.preventDefault();\r\n          this.sendFeedback();\r\n        }}\r\n        class=\"flex flex-col gap-8\"\r\n      >\r\n        {this.renderOptions()}\r\n        {this.renderDetails()}\r\n      </form>\r\n    );\r\n  }\r\n\r\n  private renderFooter() {\r\n    return (\r\n      <div part=\"buttons\" slot=\"footer\" class=\"flex justify-end gap-2\">\r\n        <Button\r\n          part=\"cancel-button\"\r\n          style=\"outline-neutral\"\r\n          class=\"text-primary\"\r\n          onClick={() => this.close()}\r\n        >\r\n          {this.props.getBindings().i18n.t('cancel')}\r\n        </Button>\r\n        <Button\r\n          part=\"submit-button\"\r\n          style=\"primary\"\r\n          type=\"submit\"\r\n          form={this.props.formId}\r\n        >\r\n          {this.props.getBindings().i18n.t('feedback-send')}\r\n        </Button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private updateBreakpoints = once(() =>\r\n    updateBreakpoints(this.props.getHost())\r\n  );\r\n\r\n  public render() {\r\n    this.updateBreakpoints();\r\n\r\n    return (\r\n      <atomic-modal\r\n        fullscreen={false}\r\n        source={this.props.getSource()}\r\n        container={this.props.getHost()}\r\n        isOpen={this.props.getIsOpen()}\r\n        close={() => this.close()}\r\n        exportparts=\"backdrop,container,header,header-wrapper,header-ruler,body,body-wrapper,footer,footer-wrapper,footer-wrapper\"\r\n      >\r\n        {this.renderHeader()}\r\n        {this.renderBody()}\r\n        {this.renderFooter()}\r\n      </atomic-modal>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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"}