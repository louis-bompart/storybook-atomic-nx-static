{"version":3,"names":["DEFAULT_MOBILE_BREAKPOINT","replaceMediaQuery","style","mobileBreakpoint","replace","RegExp","replaceStyleSheet","element","stylesheets","_a","shadowRoot","adoptedStyleSheets","length","stylesheet","Object","values","cssRules","map","rule","cssText","join","_b","replaceSync","call","replateStyleContent","breakpoint","styleTag","querySelector","textContent","layouts","updateBreakpoints","layout","closest"],"sources":["src/utils/replace-breakpoint.ts"],"sourcesContent":["import {closest} from './utils';\r\n\r\nexport const DEFAULT_MOBILE_BREAKPOINT = '1024px';\r\n\r\nfunction replaceMediaQuery(style: string, mobileBreakpoint: string) {\r\n  return style.replace(\r\n    new RegExp(`\\\\(min-width: ${DEFAULT_MOBILE_BREAKPOINT}\\\\)`, 'g'),\r\n    `(min-width: ${mobileBreakpoint})`\r\n  );\r\n}\r\n\r\nfunction replaceStyleSheet(element: HTMLElement, mobileBreakpoint: string) {\r\n  // Not adopted by all browsers, not part of Typescript yet\r\n  // https://caniuse.com/mdn-api_document_adoptedstylesheets\r\n  // https://github.com/microsoft/TypeScript/issues/30022\r\n  const stylesheets = element.shadowRoot?.adoptedStyleSheets;\r\n  if (!stylesheets || !stylesheets.length) {\r\n    return;\r\n  }\r\n\r\n  const stylesheet = stylesheets[0];\r\n  const style = Object.values(stylesheet.cssRules)\r\n    .map((rule) => rule.cssText)\r\n    .join('');\r\n  stylesheet.replaceSync?.(replaceMediaQuery(style, mobileBreakpoint));\r\n}\r\n\r\nfunction replateStyleContent(element: HTMLElement, breakpoint: string) {\r\n  const styleTag = element.shadowRoot?.querySelector('style');\r\n  if (!styleTag) {\r\n    return;\r\n  }\r\n\r\n  styleTag.textContent = replaceMediaQuery(styleTag.textContent!, breakpoint);\r\n}\r\n\r\nconst layouts = ['atomic-search-layout', 'atomic-insight-layout'];\r\ntype LayoutElement = HTMLElement & {mobileBreakpoint: string};\r\nexport function updateBreakpoints(element: HTMLElement) {\r\n  const layout: LayoutElement | null = closest(element, layouts.join(', '));\r\n\r\n  if (!layout?.mobileBreakpoint) {\r\n    return;\r\n  }\r\n\r\n  if (layout.mobileBreakpoint === DEFAULT_MOBILE_BREAKPOINT) {\r\n    return;\r\n  }\r\n\r\n  replaceStyleSheet(element, layout.mobileBreakpoint);\r\n  replateStyleContent(element, layout.mobileBreakpoint);\r\n}\r\n"],"mappings":"0CAEaA,EAA4B,SAEzC,SAASC,EAAkBC,EAAeC,GACxC,OAAOD,EAAME,QACX,IAAIC,OAAO,iBAAiBL,OAAgC,KAC5D,eAAeG,KAEnB,CAEA,SAASG,EAAkBC,EAAsBJ,G,QAI/C,MAAMK,GAAcC,EAAAF,EAAQG,cAAU,MAAAD,SAAA,SAAAA,EAAEE,mBACxC,IAAKH,IAAgBA,EAAYI,OAAQ,CACvC,M,CAGF,MAAMC,EAAaL,EAAY,GAC/B,MAAMN,EAAQY,OAAOC,OAAOF,EAAWG,UACpCC,KAAKC,GAASA,EAAKC,UACnBC,KAAK,KACRC,EAAAR,EAAWS,eAAW,MAAAD,SAAA,SAAAA,EAAAE,KAAAV,EAAGZ,EAAkBC,EAAOC,GACpD,CAEA,SAASqB,EAAoBjB,EAAsBkB,G,MACjD,MAAMC,GAAWjB,EAAAF,EAAQG,cAAU,MAAAD,SAAA,SAAAA,EAAEkB,cAAc,SACnD,IAAKD,EAAU,CACb,M,CAGFA,EAASE,YAAc3B,EAAkByB,EAASE,YAAcH,EAClE,CAEA,MAAMI,EAAU,CAAC,uBAAwB,yB,SAEzBC,EAAkBvB,GAChC,MAAMwB,EAA+BC,EAAQzB,EAASsB,EAAQT,KAAK,OAEnE,KAAKW,IAAM,MAANA,SAAM,SAANA,EAAQ5B,kBAAkB,CAC7B,M,CAGF,GAAI4B,EAAO5B,mBAAqBH,EAA2B,CACzD,M,CAGFM,EAAkBC,EAASwB,EAAO5B,kBAClCqB,EAAoBjB,EAASwB,EAAO5B,iBACtC,Q"}