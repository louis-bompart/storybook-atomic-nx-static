{"file":"tab-bar.tab-popover.entry.js","mappings":"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","names":[],"sources":["src/components/common/tabs/tab-bar.pcss?tag=tab-bar&encapsulation=shadow","src/components/common/tabs/tab-bar.tsx","src/components/common/tabs/tab-popover.pcss?tag=tab-popover&encapsulation=shadow","src/components/common/tabs/tab-popover.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\r\n\r\n:host {\r\n  white-space: nowrap;\r\n  width: 100%;\r\n  overflow-x: visible;\r\n  display: flex;\r\n  position: relative;\r\n}\r\n","import {h, Component, Element, Host, Listen, State} from '@stencil/core';\r\nimport {Button} from '../button';\r\nimport {TabCommonElement} from './tab-common';\r\n\r\n/**\r\n * @internal\r\n */\r\n@Component({\r\n  tag: 'tab-bar',\r\n  shadow: true,\r\n  styleUrl: 'tab-bar.pcss',\r\n})\r\nexport class TabBar {\r\n  @Element() private host!: HTMLElement;\r\n\r\n  @State()\r\n  private popoverTabs: (typeof Button)[] = [];\r\n\r\n  private resizeObserver: ResizeObserver | undefined;\r\n\r\n  private get tabsFromSlot(): TabCommonElement[] {\r\n    const isTab = (tagName: string) => /atomic-.+-tab$/i.test(tagName);\r\n    return Array.from(this.host.querySelectorAll<TabCommonElement>('*')).filter(\r\n      (element) => isTab(element.tagName)\r\n    );\r\n  }\r\n\r\n  private get selectedTab() {\r\n    return this.tabsFromSlot.find((tab) => tab.active);\r\n  }\r\n\r\n  private get slotContentWidth() {\r\n    return this.tabsFromSlot.reduce(\r\n      (total, el) =>\r\n        total +\r\n        parseFloat(window.getComputedStyle(el).getPropertyValue('width')),\r\n      0\r\n    );\r\n  }\r\n\r\n  private get containerWidth() {\r\n    return parseFloat(\r\n      window.getComputedStyle(this.host).getPropertyValue('width')\r\n    );\r\n  }\r\n\r\n  private get isOverflow() {\r\n    return this.slotContentWidth > this.containerWidth;\r\n  }\r\n\r\n  private get tabPopover() {\r\n    return this.host.shadowRoot?.querySelector('tab-popover');\r\n  }\r\n\r\n  private get popoverWidth() {\r\n    return this.tabPopover ? this.getElementWidth(this.tabPopover) : 0;\r\n  }\r\n\r\n  private get overflowingTabs() {\r\n    const containerRelativeRightPosition =\r\n      this.host.getBoundingClientRect().right;\r\n    const selectedTabRelativeRightPosition =\r\n      this.selectedTab?.getBoundingClientRect().right;\r\n\r\n    return this.tabsFromSlot.filter((element) => {\r\n      const isBeforeSelectedTab = selectedTabRelativeRightPosition\r\n        ? selectedTabRelativeRightPosition >\r\n          element.getBoundingClientRect().right\r\n        : false;\r\n\r\n      const minimumWidthNeeded = isBeforeSelectedTab\r\n        ? this.popoverWidth + this.getElementWidth(this.selectedTab)\r\n        : this.popoverWidth;\r\n\r\n      const rightPositionLimit = !this.isOverflow\r\n        ? containerRelativeRightPosition\r\n        : containerRelativeRightPosition - minimumWidthNeeded;\r\n\r\n      return (\r\n        element.getBoundingClientRect().right > rightPositionLimit &&\r\n        !element.active\r\n      );\r\n    });\r\n  }\r\n\r\n  private get displayedTabs() {\r\n    return this.tabsFromSlot.filter((el) => !this.overflowingTabs.includes(el));\r\n  }\r\n\r\n  private get lastDisplayedTab() {\r\n    const displayedTabs = this.displayedTabs;\r\n    return displayedTabs[displayedTabs.length - 1];\r\n  }\r\n\r\n  private get lastDisplayedTabRightPosition() {\r\n    return (\r\n      this.lastDisplayedTab.getBoundingClientRect().right -\r\n      this.host.getBoundingClientRect().left\r\n    );\r\n  }\r\n\r\n  private updatePopoverPosition() {\r\n    this.tabPopover?.style.setProperty(\r\n      'left',\r\n      `${this.displayedTabs.length ? this.lastDisplayedTabRightPosition : 0}px`\r\n    );\r\n  }\r\n\r\n  private getElementWidth = (element?: Element) => {\r\n    return element\r\n      ? parseFloat(window.getComputedStyle(element).getPropertyValue('width'))\r\n      : 0;\r\n  };\r\n\r\n  private hideElement = (el: HTMLElement) => {\r\n    el.style.visibility = 'hidden';\r\n    el.ariaHidden = 'true';\r\n  };\r\n\r\n  private showElement = (el: HTMLElement) => {\r\n    el.style.visibility = 'visible';\r\n    el.ariaHidden = 'false';\r\n  };\r\n\r\n  private updateTabVisibility = (\r\n    tabs: TabCommonElement[],\r\n    isVisible: boolean\r\n  ) => {\r\n    const tabCount = this.tabsFromSlot.length;\r\n\r\n    tabs.forEach((tab, index) => {\r\n      tab.style.setProperty(\r\n        'order',\r\n        String(isVisible ? index + 1 : tabCount - tabs.length + index + 1)\r\n      );\r\n      if (isVisible) {\r\n        this.showElement(tab);\r\n      } else {\r\n        this.hideElement(tab);\r\n      }\r\n    });\r\n  };\r\n\r\n  private updatePopoverTabs = () => {\r\n    this.popoverTabs = this.overflowingTabs.map((tab) => (\r\n      <Button\r\n        part=\"popover-tab\"\r\n        style=\"text-transparent\"\r\n        class=\"font-semibold px-4 py-2 rounded truncate\"\r\n        ariaLabel={tab.label}\r\n        onClick={() => {\r\n          tab.select();\r\n          this.tabPopover?.togglePopover();\r\n        }}\r\n      >\r\n        {tab.label}\r\n      </Button>\r\n    ));\r\n  };\r\n\r\n  private updateTabsDisplay = () => {\r\n    this.updateTabVisibility(this.overflowingTabs, false);\r\n    this.updateTabVisibility(this.displayedTabs, true);\r\n    this.updatePopoverPosition();\r\n    this.tabPopover?.setButtonVisibility(!!this.overflowingTabs.length);\r\n  };\r\n\r\n  @Listen('atomic/tabRendered')\r\n  public resolveResult(event: CustomEvent<{}>) {\r\n    event.stopPropagation();\r\n    this.updatePopoverTabs();\r\n  }\r\n\r\n  public componentDidLoad() {\r\n    this.resizeObserver = new ResizeObserver(this.render);\r\n    this.resizeObserver.observe(this.host);\r\n  }\r\n\r\n  public disconnectedCallback() {\r\n    this.resizeObserver?.disconnect();\r\n  }\r\n\r\n  public render = () => {\r\n    this.updateTabsDisplay();\r\n    return (\r\n      <Host>\r\n        <slot></slot>\r\n        <tab-popover>{this.popoverTabs}</tab-popover>\r\n      </Host>\r\n    );\r\n  };\r\n}\r\n","@import '../../../global/global.pcss';\r\n\r\n:host {\r\n  position: absolute;\r\n}\r\n\r\n:host(.visibility-hidden) {\r\n  visibility: hidden;\r\n}\r\n\r\n[part='overflow-tabs'] {\r\n  flex-direction: column;\r\n  max-width: 150px;\r\n\r\n  button {\r\n    text-align: start;\r\n  }\r\n}\r\n","import {\r\n  createPopperLite as createPopper,\r\n  preventOverflow,\r\n  Instance as PopperInstance,\r\n} from '@popperjs/core';\r\nimport {\r\n  Component,\r\n  h,\r\n  Listen,\r\n  State,\r\n  Element,\r\n  Host,\r\n  Method,\r\n} from '@stencil/core';\r\nimport ArrowBottomIcon from '../../../images/arrow-bottom-rounded.svg';\r\nimport {\r\n  InitializableComponent,\r\n  InitializeBindings,\r\n} from '../../../utils/initialization-utils';\r\nimport {Bindings} from '../../search/atomic-search-interface/atomic-search-interface';\r\nimport {Button} from '../button';\r\n\r\n/**\r\n * @internal\r\n */\r\n@Component({\r\n  tag: 'tab-popover',\r\n  shadow: true,\r\n  styleUrl: 'tab-popover.pcss',\r\n})\r\nexport class TabPopover implements InitializableComponent {\r\n  @Element() private host!: HTMLElement;\r\n\r\n  @InitializeBindings() public bindings!: Bindings;\r\n\r\n  @State()\r\n  public show = false;\r\n\r\n  @State()\r\n  public error!: Error;\r\n\r\n  @State()\r\n  private isOpen = false;\r\n\r\n  private buttonRef!: HTMLElement;\r\n  private popupRef!: HTMLElement;\r\n  private popperInstance?: PopperInstance;\r\n  public popoverId = 'tab-popover';\r\n\r\n  public initialize() {}\r\n\r\n  private initializePopover() {\r\n    this.popupRef.classList.add('popover-nested');\r\n  }\r\n\r\n  @Listen('keydown')\r\n  public handleKeyDown(e: KeyboardEvent) {\r\n    if (e.key === 'Escape' && this.isOpen) {\r\n      this.togglePopover();\r\n    }\r\n  }\r\n\r\n  get slotElements() {\r\n    return this.host.children;\r\n  }\r\n\r\n  get hasTabs() {\r\n    return !!this.popupRef.children.length;\r\n  }\r\n\r\n  @Method()\r\n  public async togglePopover() {\r\n    this.isOpen = !this.isOpen;\r\n  }\r\n\r\n  @Method()\r\n  public async setButtonVisibility(isVisible: boolean) {\r\n    this.show = isVisible;\r\n  }\r\n\r\n  private renderDropdownButton() {\r\n    const label = this.bindings?.i18n.t('more');\r\n    const ariaLabel = this.bindings?.i18n.t('tab-popover', {label});\r\n    const buttonClasses = ['relative', 'pb-1', 'mt-1', 'mr-6', 'font-semibold'];\r\n\r\n    return (\r\n      <Button\r\n        ref={(el) => (this.buttonRef = el!)}\r\n        style=\"text-transparent\"\r\n        onClick={() => this.togglePopover()}\r\n        part=\"popover-button\"\r\n        ariaExpanded={`${this.isOpen}`}\r\n        ariaLabel={ariaLabel}\r\n        ariaControls={this.popoverId}\r\n        class={`${buttonClasses.join(' ')}`}\r\n      >\r\n        <span\r\n          title={label}\r\n          part=\"value-label\"\r\n          class={\r\n            'truncate mr-1.5 group-hover:text-primary-light group-focus:text-primary'\r\n          }\r\n        >\r\n          {label}\r\n        </span>\r\n        <atomic-icon\r\n          part=\"arrow-icon\"\r\n          class={`w-2 ml-auto group-hover:text-primary-light group-focus:text-primary ${\r\n            this.isOpen ? 'rotate-180' : ''\r\n          }`}\r\n          icon={ArrowBottomIcon}\r\n        ></atomic-icon>\r\n      </Button>\r\n    );\r\n  }\r\n\r\n  private renderBackdrop() {\r\n    return (\r\n      <div\r\n        part=\"backdrop\"\r\n        class=\"fixed left-0 top-0 right-0 bottom-0 z-[9998] bg-transparent cursor-pointer\"\r\n        onClick={() => this.togglePopover()}\r\n      ></div>\r\n    );\r\n  }\r\n\r\n  private renderPopover() {\r\n    return (\r\n      <div class={`relative ${this.isOpen ? 'z-[9999]' : ''}`}>\r\n        {this.renderDropdownButton()}\r\n        <div\r\n          id={this.popoverId}\r\n          ref={(el) => (this.popupRef = el!)}\r\n          part=\"overflow-tabs\"\r\n          class={`absolute py-2 bg-background border-neutral border rounded-lg shadow-lg ${\r\n            this.isOpen ? 'flex' : 'hidden'\r\n          }`}\r\n        >\r\n          <slot></slot>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  public componentDidRender() {\r\n    if (this.popperInstance || !this.buttonRef || !this.popupRef) {\r\n      return;\r\n    }\r\n\r\n    this.popperInstance = createPopper(this.buttonRef, this.popupRef, {\r\n      placement: 'bottom-end',\r\n      modifiers: [preventOverflow],\r\n    });\r\n    this.initializePopover();\r\n  }\r\n\r\n  public componentDidUpdate() {\r\n    this.popperInstance?.forceUpdate();\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <Host\r\n        class={this.show ? '' : 'visibility-hidden'}\r\n        aria-hidden={!this.show}\r\n      >\r\n        <atomic-focus-trap\r\n          source={this.buttonRef}\r\n          container={this.popupRef}\r\n          active={this.isOpen}\r\n          shouldHideSelf={false}\r\n          scope={this.bindings?.interfaceElement}\r\n        >\r\n          {this.renderPopover()}\r\n        </atomic-focus-trap>\r\n        {this.isOpen && this.renderBackdrop()}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"version":3}