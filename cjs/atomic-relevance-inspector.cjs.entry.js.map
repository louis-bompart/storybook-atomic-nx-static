{"file":"atomic-relevance-inspector.entry.cjs.js","mappings":";;;;;;;;;;;AAAA,MAAM,2BAA2B,GAAG,u+tCAAu+tC,CAAC;AAC5guC,uCAAe,2BAA2B;;MCY7B,wBAAwB;;;;QAMZ,SAAI,GAAG,KAAK,CAAC;;oBAAN,KAAK;;IAK5B,MAAM;QACX,QACEA,2EACE,WAAW,EAAC,QAAQ,EACpB,MAAM,EAAE,IAAI,CAAC,IAAI,EACjB,KAAK,EAAE;;gBACL,MAAA,IAAI,CAAC,uBAAuB,0CAAE,IAAI,EAAE,CAAC;aACtC,IAEDA,gEAAG,IAAI,EAAC,QAAQ,mCAAiC,EACjDA,gEAAG,IAAI,EAAC,MAAM,6EAEV,EACJA,kEAAK,IAAI,EAAC,QAAQ,EAAC,KAAK,EAAC,sCAAsC,IAC7DA,QAACC,aAAM,qDACL,KAAK,EAAC,iBAAiB,EACvB,KAAK,EAAC,UAAU,EAChB,OAAO,EAAE,gBAAM,OAAA,MAAA,IAAI,CAAC,uBAAuB,0CAAE,IAAI,EAAE,CAAA,EAAA,aAG5C,EACTD,gEACE,KAAK,EAAC,iBAAiB,EACvB,MAAM,EAAC,QAAQ,EACf,IAAI,EAAE,IAAI,CAAC,SAAS,EACpB,OAAO,EAAE,gBAAM,OAAA,MAAA,IAAI,CAAC,uBAAuB,0CAAE,IAAI,EAAE,CAAA,EAAA,WAGjD,CACA,CACO,EACf;KACH;IAEO,iCAAiC;;QACvC,MAAM,EAAC,WAAW,EAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,aAAa,CAAC;QAC/D,MAAM,WAAW,GAAG,MAAM,CAAC;QAE3B,MAAM,gBAAgB,GAAG,WAAW,CAAC,KAAK,CACxC,0CAA0C,CAC3C,CAAC;QAEF,IAAI,gBAAgB,EAAE;YACpB,QACE,MAAC,MAAA,gBAAgB,CAAC,MAAM,0CAAE,GAA2B,mCAAI,WAAW,EACpE;SACH;QAED,MAAM,yBAAyB,GAAG,WAAW,CAAC,KAAK,CACjD,gDAAgD,CACjD,CAAC;QAEF,IAAI,yBAAyB,EAAE;YAC7B,QACE,MAAC,MAAA,yBAAyB,CAAC,MAAM,0CAAE,GAA2B,mCAC9D,WAAW,EACX;SACH;QAED,OAAO,WAAW,CAAC;KACpB;IAED,IAAY,SAAS;QACnB,MAAM,EAAC,cAAc,EAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,aAAa,CAAC;QAElE,MAAM,EAAC,KAAK,EAAC,GAAGE,eAAwB,CACtC,cAAc,EACd,IAAI,CAAC,iCAAiC,EAAyB,CAChE,CAAC;QACF,MAAM,EAAC,gBAAgB,EAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC;QAC7D,OAAO,GAAG,KAAK,YAAY,cAAc,8BAA8B,gBAAgB,EAAE,CAAC;KAC3F;;;;;;","names":["h","Button","getOrganizationEndpoints"],"sources":["src/components/search/atomic-relevance-inspector/atomic-relevance-inspector.pcss?tag=atomic-relevance-inspector&encapsulation=shadow","src/components/search/atomic-relevance-inspector/atomic-relevance-inspector.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\r\n","import {PlatformEnvironment, getOrganizationEndpoints} from '@coveo/headless';\r\nimport {Component, h, Prop, Event, EventEmitter} from '@stencil/core';\r\nimport {Button} from '../../common/button';\r\nimport {Bindings} from '../atomic-search-interface/atomic-search-interface';\r\n\r\n/**\r\n * The `atomic-relevance-inspector` component is used internally to offer insight on search page relevance, as well as information to help troubleshoot issues during development.\r\n */\r\n@Component({\r\n  tag: 'atomic-relevance-inspector',\r\n  styleUrl: 'atomic-relevance-inspector.pcss',\r\n  shadow: true,\r\n})\r\nexport class AtomicRelevanceInspector {\r\n  /**\r\n   * The Atomic interface bindings, namely the headless search engine and i18n instances.\r\n   */\r\n  @Prop() bindings!: Bindings;\r\n\r\n  @Prop({reflect: true}) open = false;\r\n\r\n  @Event({eventName: 'atomic/relevanceInspector/close'})\r\n  closeRelevanceInspector: EventEmitter<null> | undefined;\r\n\r\n  public render() {\r\n    return (\r\n      <atomic-modal\r\n        exportparts=\"footer\"\r\n        isOpen={this.open}\r\n        close={() => {\r\n          this.closeRelevanceInspector?.emit();\r\n        }}\r\n      >\r\n        <p slot=\"header\">Open the relevance inspector</p>\r\n        <p slot=\"body\">\r\n          The Relevance Inspector will open in the Coveo Administration Console.\r\n        </p>\r\n        <div slot=\"footer\" class=\"w-full flex justify-end items-center\">\r\n          <Button\r\n            style=\"outline-primary\"\r\n            class=\"p-2 mr-2\"\r\n            onClick={() => this.closeRelevanceInspector?.emit()}\r\n          >\r\n            Ignore\r\n          </Button>\r\n          <a\r\n            class=\"btn-primary p-2\"\r\n            target=\"_blank\"\r\n            href={this.adminHref}\r\n            onClick={() => this.closeRelevanceInspector?.emit()}\r\n          >\r\n            Open\r\n          </a>\r\n        </div>\r\n      </atomic-modal>\r\n    );\r\n  }\r\n\r\n  private extractEnvironmentFromPlatformURL(): PlatformEnvironment {\r\n    const {platformUrl} = this.bindings.engine.state.configuration;\r\n    const fallbackEnv = 'prod';\r\n\r\n    const platformUrlMatch = platformUrl.match(\r\n      /^https:\\/\\/platform(?<env>dev|stg|hipaa)/\r\n    );\r\n\r\n    if (platformUrlMatch) {\r\n      return (\r\n        (platformUrlMatch.groups?.env as PlatformEnvironment) ?? fallbackEnv\r\n      );\r\n    }\r\n\r\n    const organizationEndpointMatch = platformUrl.match(\r\n      /^https:\\/\\/[a-z0-9]+\\.org(?<env>dev|stg|hipaa)/\r\n    );\r\n\r\n    if (organizationEndpointMatch) {\r\n      return (\r\n        (organizationEndpointMatch.groups?.env as PlatformEnvironment) ??\r\n        fallbackEnv\r\n      );\r\n    }\r\n\r\n    return fallbackEnv;\r\n  }\r\n\r\n  private get adminHref() {\r\n    const {organizationId} = this.bindings.engine.state.configuration;\r\n\r\n    const {admin} = getOrganizationEndpoints(\r\n      organizationId,\r\n      this.extractEnvironmentFromPlatformURL() as PlatformEnvironment\r\n    );\r\n    const {searchResponseId} = this.bindings.engine.state.search;\r\n    return `${admin}/admin/#/${organizationId}/search/relevanceInspector/${searchResponseId}`;\r\n  }\r\n}\r\n"],"version":3}