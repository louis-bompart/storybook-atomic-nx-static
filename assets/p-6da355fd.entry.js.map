{"version":3,"names":["atomicRelevanceInspectorCss","AtomicRelevanceInspectorStyle0","AtomicRelevanceInspector","this","open","render","h","key","exportparts","isOpen","close","_a","closeRelevanceInspector","emit","slot","class","Button","style","onClick","target","href","adminHref","extractEnvironmentFromPlatformURL","platformUrl","bindings","engine","state","configuration","fallbackEnv","platformUrlMatch","match","_b","groups","env","organizationEndpointMatch","_d","_c","organizationId","admin","getOrganizationEndpoints","searchResponseId","search"],"sources":["src/components/search/atomic-relevance-inspector/atomic-relevance-inspector.pcss?tag=atomic-relevance-inspector&encapsulation=shadow","src/components/search/atomic-relevance-inspector/atomic-relevance-inspector.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\r\n","import {PlatformEnvironment, getOrganizationEndpoints} from '@coveo/headless';\r\nimport {Component, h, Prop, Event, EventEmitter} from '@stencil/core';\r\nimport {Button} from '../../common/button';\r\nimport {Bindings} from '../atomic-search-interface/atomic-search-interface';\r\n\r\n/**\r\n * The `atomic-relevance-inspector` component is used internally to offer insight on search page relevance, as well as information to help troubleshoot issues during development.\r\n */\r\n@Component({\r\n  tag: 'atomic-relevance-inspector',\r\n  styleUrl: 'atomic-relevance-inspector.pcss',\r\n  shadow: true,\r\n})\r\nexport class AtomicRelevanceInspector {\r\n  /**\r\n   * The Atomic interface bindings, namely the headless search engine and i18n instances.\r\n   */\r\n  @Prop() bindings!: Bindings;\r\n\r\n  @Prop({reflect: true}) open = false;\r\n\r\n  @Event({eventName: 'atomic/relevanceInspector/close'})\r\n  closeRelevanceInspector: EventEmitter<null> | undefined;\r\n\r\n  public render() {\r\n    return (\r\n      <atomic-modal\r\n        exportparts=\"footer\"\r\n        isOpen={this.open}\r\n        close={() => {\r\n          this.closeRelevanceInspector?.emit();\r\n        }}\r\n      >\r\n        <p slot=\"header\">Open the relevance inspector</p>\r\n        <p slot=\"body\">\r\n          The Relevance Inspector will open in the Coveo Administration Console.\r\n        </p>\r\n        <div slot=\"footer\" class=\"w-full flex justify-end items-center\">\r\n          <Button\r\n            style=\"outline-primary\"\r\n            class=\"p-2 mr-2\"\r\n            onClick={() => this.closeRelevanceInspector?.emit()}\r\n          >\r\n            Ignore\r\n          </Button>\r\n          <a\r\n            class=\"btn-primary p-2\"\r\n            target=\"_blank\"\r\n            href={this.adminHref}\r\n            onClick={() => this.closeRelevanceInspector?.emit()}\r\n          >\r\n            Open\r\n          </a>\r\n        </div>\r\n      </atomic-modal>\r\n    );\r\n  }\r\n\r\n  private extractEnvironmentFromPlatformURL(): PlatformEnvironment {\r\n    const {platformUrl} = this.bindings.engine.state.configuration;\r\n    const fallbackEnv = 'prod';\r\n\r\n    const platformUrlMatch = platformUrl.match(\r\n      /^https:\\/\\/platform(?<env>dev|stg|hipaa)/\r\n    );\r\n\r\n    if (platformUrlMatch) {\r\n      return (\r\n        (platformUrlMatch.groups?.env as PlatformEnvironment) ?? fallbackEnv\r\n      );\r\n    }\r\n\r\n    const organizationEndpointMatch = platformUrl.match(\r\n      /^https:\\/\\/[a-z0-9]+\\.org(?<env>dev|stg|hipaa)/\r\n    );\r\n\r\n    if (organizationEndpointMatch) {\r\n      return (\r\n        (organizationEndpointMatch.groups?.env as PlatformEnvironment) ??\r\n        fallbackEnv\r\n      );\r\n    }\r\n\r\n    return fallbackEnv;\r\n  }\r\n\r\n  private get adminHref() {\r\n    const {organizationId} = this.bindings.engine.state.configuration;\r\n\r\n    const {admin} = getOrganizationEndpoints(\r\n      organizationId,\r\n      this.extractEnvironmentFromPlatformURL() as PlatformEnvironment\r\n    );\r\n    const {searchResponseId} = this.bindings.engine.state.search;\r\n    return `${admin}/admin/#/${organizationId}/search/relevanceInspector/${searchResponseId}`;\r\n  }\r\n}\r\n"],"mappings":"6LAAA,MAAMA,EAA8B,w+tCACpC,MAAAC,EAAeD,E,MCYFE,EAAwB,M,kGAMZC,KAAAC,KAAO,M,kCAAA,K,CAKvB,MAAAC,GACL,OACEC,EAAA,gBAAAC,IAAA,2CACEC,YAAY,SACZC,OAAQN,KAAKC,KACbM,MAAO,K,OACLC,EAAAR,KAAKS,2BAAuB,MAAAD,SAAA,SAAAA,EAAEE,MAAM,GAGtCP,EAAA,KAAAC,IAAA,2CAAGO,KAAK,UAAQ,gCAChBR,EAAA,KAAAC,IAAA,2CAAGO,KAAK,QAAM,0EAGdR,EAAA,OAAAC,IAAA,2CAAKO,KAAK,SAASC,MAAM,wCACvBT,EAACU,EAAM,CAAAT,IAAA,2CACLU,MAAM,kBACNF,MAAM,WACNG,QAAS,SAAAP,EAAM,OAAAA,EAAAR,KAAKS,2BAAuB,MAAAD,SAAA,SAAAA,EAAEE,MAAM,aAIrDP,EAAA,KAAAC,IAAA,2CACEQ,MAAM,kBACNI,OAAO,SACPC,KAAMjB,KAAKkB,UACXH,QAAS,SAAAP,EAAM,OAAAA,EAAAR,KAAKS,2BAAuB,MAAAD,SAAA,SAAAA,EAAEE,MAAM,Y,CASrD,iCAAAS,G,YACN,MAAMC,YAACA,GAAepB,KAAKqB,SAASC,OAAOC,MAAMC,cACjD,MAAMC,EAAc,OAEpB,MAAMC,EAAmBN,EAAYO,MACnC,4CAGF,GAAID,EAAkB,CACpB,OACEE,GAACpB,EAAAkB,EAAiBG,UAAM,MAAArB,SAAA,SAAAA,EAAEsB,OAA2B,MAAAF,SAAA,EAAAA,EAAIH,C,CAI7D,MAAMM,EAA4BX,EAAYO,MAC5C,kDAGF,GAAII,EAA2B,CAC7B,OACEC,GAACC,EAAAF,EAA0BF,UAAM,MAAAI,SAAA,SAAAA,EAAEH,OAA2B,MAAAE,SAAA,EAAAA,EAC9DP,C,CAIJ,OAAOA,C,CAGT,aAAYP,GACV,MAAMgB,eAACA,GAAkBlC,KAAKqB,SAASC,OAAOC,MAAMC,cAEpD,MAAMW,MAACA,GAASC,EACdF,EACAlC,KAAKmB,qCAEP,MAAMkB,iBAACA,GAAoBrC,KAAKqB,SAASC,OAAOC,MAAMe,OACtD,MAAO,GAAGH,aAAiBD,+BAA4CG,G"}