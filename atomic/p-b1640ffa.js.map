{"version":3,"names":["SmartSnippetFeedbackModalCommon","constructor","props","this","updateBreakpoints","once","getHost","sendFeedback","getCurrentAnswer","getSmartSnippet","sendDetailedFeedback","getDetailsInputRef","value","getFeedbackSent","emit","setIsOpen","close","closeFeedbackModal","renderHeader","h","slot","getBindings","i18n","t","renderOptions","options","id","localeKey","correspondingAnswer","part","class","map","key","type","name","checked","onChange","e","_a","currentTarget","setCurrentAnswer","required","htmlFor","renderDetails","ref","detailsInput","setDetailsInputRef","rows","renderBody","formId","onSubmit","preventDefault","renderFooter","Button","style","onClick","form","render","fullscreen","source","getSource","container","isOpen","getIsOpen","exportparts"],"sources":["src/components/common/smart-snippets/atomic-smart-snippet-feedback-modal/smart-snippet-feedback-modal-common.tsx"],"sourcesContent":["import {SmartSnippet, SmartSnippetFeedback} from '@coveo/headless';\nimport {EventEmitter, h} from '@stencil/core';\nimport {updateBreakpoints} from '../../../../utils/replace-breakpoint';\nimport {once} from '../../../../utils/utils';\nimport {Button} from '../../button';\nimport {AnyBindings} from '../../interface/bindings';\n\ninterface SmartSnippetFeedbackModalProps {\n  formId: string;\n  getHost: () => HTMLElement;\n  getBindings: () => AnyBindings;\n  getCurrentAnswer: () => SmartSnippetFeedback | 'other' | undefined;\n  getSmartSnippet: () => SmartSnippet;\n  getDetailsInputRef: () => HTMLTextAreaElement | undefined;\n  getFeedbackSent: () => EventEmitter;\n  getSource: () => HTMLElement | undefined;\n  getIsOpen: () => boolean;\n  setIsOpen: (isOpen: boolean) => void;\n  setCurrentAnswer: (answer: SmartSnippetFeedback | 'other') => void;\n  setDetailsInputRef: (ref?: HTMLTextAreaElement) => void;\n}\n\nexport class SmartSnippetFeedbackModalCommon {\n  constructor(private props: SmartSnippetFeedbackModalProps) {}\n\n  public sendFeedback() {\n    if (this.props.getCurrentAnswer() === 'other') {\n      this.props\n        .getSmartSnippet()\n        .sendDetailedFeedback(this.props.getDetailsInputRef()!.value);\n    } else {\n      this.props\n        .getSmartSnippet()\n        .sendFeedback(this.props.getCurrentAnswer() as SmartSnippetFeedback);\n    }\n    this.props.getFeedbackSent().emit();\n    this.props.setIsOpen(false);\n  }\n\n  public close() {\n    this.props.setIsOpen(false);\n    this.props.getSmartSnippet().closeFeedbackModal();\n  }\n\n  private renderHeader() {\n    return (\n      <h1 slot=\"header\">\n        {this.props.getBindings().i18n.t('smart-snippet-feedback-explain-why')}\n      </h1>\n    );\n  }\n\n  private renderOptions() {\n    const options: {\n      id: string;\n      localeKey: string;\n      correspondingAnswer: SmartSnippetFeedback | 'other';\n    }[] = [\n      {\n        id: 'does-not-answer',\n        localeKey: 'smart-snippet-feedback-reason-does-not-answer',\n        correspondingAnswer: 'does_not_answer',\n      },\n      {\n        id: 'partially-answers',\n        localeKey: 'smart-snippet-feedback-reason-partially-answers',\n        correspondingAnswer: 'partially_answers',\n      },\n      {\n        id: 'was-not-a-question',\n        localeKey: 'smart-snippet-feedback-reason-was-not-a-question',\n        correspondingAnswer: 'was_not_a_question',\n      },\n      {\n        id: 'other',\n        localeKey: 'smart-snippet-feedback-reason-other',\n        correspondingAnswer: 'other',\n      },\n    ];\n\n    return (\n      <fieldset>\n        <legend\n          part=\"reason-title\"\n          class=\"font-bold text-on-background text-lg\"\n        >\n          {this.props\n            .getBindings()\n            .i18n.t('smart-snippet-feedback-select-reason')}\n        </legend>\n        {options.map(({id, localeKey, correspondingAnswer}) => (\n          <div class=\"flex items-center\" key={id} part=\"reason\">\n            <input\n              part=\"reason-radio\"\n              type=\"radio\"\n              name=\"answer\"\n              id={id}\n              checked={this.props.getCurrentAnswer() === correspondingAnswer}\n              onChange={(e) =>\n                (e.currentTarget as HTMLInputElement | null)?.checked &&\n                this.props.setCurrentAnswer(correspondingAnswer)\n              }\n              class=\"mr-2 w-4 h-4\"\n              required\n            />\n            <label part=\"reason-label\" htmlFor={id}>\n              {this.props.getBindings().i18n.t(localeKey)}\n            </label>\n          </div>\n        ))}\n      </fieldset>\n    );\n  }\n\n  private renderDetails() {\n    if (this.props.getCurrentAnswer() !== 'other') {\n      return;\n    }\n\n    return (\n      <fieldset>\n        <legend\n          part=\"details-title\"\n          class=\"font-bold text-on-background text-lg\"\n        >\n          {this.props.getBindings().i18n.t('details')}\n        </legend>\n        <textarea\n          part=\"details-input\"\n          name=\"answer-details\"\n          ref={(detailsInput) => this.props.setDetailsInputRef(detailsInput)}\n          class=\"mt-2 p-2 w-full text-base leading-5 border border-neutral resize-none rounded\"\n          rows={4}\n          required\n        ></textarea>\n      </fieldset>\n    );\n  }\n\n  private renderBody() {\n    return (\n      <form\n        part=\"form\"\n        id={this.props.formId}\n        slot=\"body\"\n        onSubmit={(e) => {\n          e.preventDefault();\n          this.sendFeedback();\n        }}\n        class=\"flex flex-col gap-8\"\n      >\n        {this.renderOptions()}\n        {this.renderDetails()}\n      </form>\n    );\n  }\n\n  private renderFooter() {\n    return (\n      <div part=\"buttons\" slot=\"footer\" class=\"flex justify-end gap-2\">\n        <Button\n          part=\"cancel-button\"\n          style=\"outline-neutral\"\n          class=\"text-primary\"\n          onClick={() => this.close()}\n        >\n          {this.props.getBindings().i18n.t('cancel')}\n        </Button>\n        <Button\n          part=\"submit-button\"\n          style=\"primary\"\n          type=\"submit\"\n          form={this.props.formId}\n        >\n          {this.props.getBindings().i18n.t('feedback-send')}\n        </Button>\n      </div>\n    );\n  }\n\n  private updateBreakpoints = once(() =>\n    updateBreakpoints(this.props.getHost())\n  );\n\n  public render() {\n    this.updateBreakpoints();\n\n    return (\n      <atomic-modal\n        fullscreen={false}\n        source={this.props.getSource()}\n        container={this.props.getHost()}\n        isOpen={this.props.getIsOpen()}\n        close={() => this.close()}\n        exportparts=\"backdrop,container,header,header-wrapper,header-ruler,body,body-wrapper,footer,footer-wrapper,footer-wrapper\"\n      >\n        {this.renderHeader()}\n        {this.renderBody()}\n        {this.renderFooter()}\n      </atomic-modal>\n    );\n  }\n}\n"],"mappings":"sJAsBaA,EACX,WAAAC,CAAoBC,GAAAC,KAAAD,QA6JZC,KAAAC,kBAAoBC,GAAK,IAC/BD,EAAkBD,KAAKD,MAAMI,Y,CA5JxB,YAAAC,GACL,GAAIJ,KAAKD,MAAMM,qBAAuB,QAAS,CAC7CL,KAAKD,MACFO,kBACAC,qBAAqBP,KAAKD,MAAMS,qBAAsBC,M,KACpD,CACLT,KAAKD,MACFO,kBACAF,aAAaJ,KAAKD,MAAMM,mB,CAE7BL,KAAKD,MAAMW,kBAAkBC,OAC7BX,KAAKD,MAAMa,UAAU,M,CAGhB,KAAAC,GACLb,KAAKD,MAAMa,UAAU,OACrBZ,KAAKD,MAAMO,kBAAkBQ,oB,CAGvB,YAAAC,GACN,OACEC,EAAA,MAAIC,KAAK,UACNjB,KAAKD,MAAMmB,cAAcC,KAAKC,EAAE,sC,CAK/B,aAAAC,GACN,MAAMC,EAIA,CACJ,CACEC,GAAI,kBACJC,UAAW,gDACXC,oBAAqB,mBAEvB,CACEF,GAAI,oBACJC,UAAW,kDACXC,oBAAqB,qBAEvB,CACEF,GAAI,qBACJC,UAAW,mDACXC,oBAAqB,sBAEvB,CACEF,GAAI,QACJC,UAAW,sCACXC,oBAAqB,UAIzB,OACET,EAAA,gBACEA,EAAA,UACEU,KAAK,eACLC,MAAM,wCAEL3B,KAAKD,MACHmB,cACAC,KAAKC,EAAE,yCAEXE,EAAQM,KAAI,EAAEL,KAAIC,YAAWC,yBAC5BT,EAAA,OAAKW,MAAM,oBAAoBE,IAAKN,EAAIG,KAAK,UAC3CV,EAAA,SACEU,KAAK,eACLI,KAAK,QACLC,KAAK,SACLR,GAAIA,EACJS,QAAShC,KAAKD,MAAMM,qBAAuBoB,EAC3CQ,SAAWC,I,MACT,QAAAC,EAACD,EAAEE,iBAAyC,MAAAD,SAAA,SAAAA,EAAEH,UAC9ChC,KAAKD,MAAMsC,iBAAiBZ,EAAoB,EAElDE,MAAM,eACNW,SAAQ,OAEVtB,EAAA,SAAOU,KAAK,eAAea,QAAShB,GACjCvB,KAAKD,MAAMmB,cAAcC,KAAKC,EAAEI,O,CAQrC,aAAAgB,GACN,GAAIxC,KAAKD,MAAMM,qBAAuB,QAAS,CAC7C,M,CAGF,OACEW,EAAA,gBACEA,EAAA,UACEU,KAAK,gBACLC,MAAM,wCAEL3B,KAAKD,MAAMmB,cAAcC,KAAKC,EAAE,YAEnCJ,EAAA,YACEU,KAAK,gBACLK,KAAK,iBACLU,IAAMC,GAAiB1C,KAAKD,MAAM4C,mBAAmBD,GACrDf,MAAM,gFACNiB,KAAM,EACNN,SAAQ,O,CAMR,UAAAO,GACN,OACE7B,EAAA,QACEU,KAAK,OACLH,GAAIvB,KAAKD,MAAM+C,OACf7B,KAAK,OACL8B,SAAWb,IACTA,EAAEc,iBACFhD,KAAKI,cAAc,EAErBuB,MAAM,uBAEL3B,KAAKqB,gBACLrB,KAAKwC,gB,CAKJ,YAAAS,GACN,OACEjC,EAAA,OAAKU,KAAK,UAAUT,KAAK,SAASU,MAAM,0BACtCX,EAACkC,EAAM,CACLxB,KAAK,gBACLyB,MAAM,kBACNxB,MAAM,eACNyB,QAAS,IAAMpD,KAAKa,SAEnBb,KAAKD,MAAMmB,cAAcC,KAAKC,EAAE,WAEnCJ,EAACkC,EAAM,CACLxB,KAAK,gBACLyB,MAAM,UACNrB,KAAK,SACLuB,KAAMrD,KAAKD,MAAM+C,QAEhB9C,KAAKD,MAAMmB,cAAcC,KAAKC,EAAE,kB,CAUlC,MAAAkC,GACLtD,KAAKC,oBAEL,OACEe,EAAA,gBACEuC,WAAY,MACZC,OAAQxD,KAAKD,MAAM0D,YACnBC,UAAW1D,KAAKD,MAAMI,UACtBwD,OAAQ3D,KAAKD,MAAM6D,YACnB/C,MAAO,IAAMb,KAAKa,QAClBgD,YAAY,gHAEX7D,KAAKe,eACLf,KAAK6C,aACL7C,KAAKiD,e"}