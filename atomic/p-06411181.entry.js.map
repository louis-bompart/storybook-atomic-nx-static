{"version":3,"names":["toPaddingObject","padding","state","Object","assign","rects","placement","mergePaddingObject","expandToHashMap","basePlacements","arrow","_ref","_state$modifiersData$","name","options","arrowElement","elements","popperOffsets","modifiersData","basePlacement","getBasePlacement","axis","getMainAxisFromPlacement","isVertical","left","right","indexOf","len","paddingObject","arrowRect","getLayoutRect","minProp","top","maxProp","bottom","endDiff","reference","popper","startDiff","arrowOffsetParent","getOffsetParent","clientSize","clientHeight","clientWidth","centerToReference","min","max","center","offset","within","axisProp","centerOffset","effect","_ref2","_options$element","element","querySelector","contains","arrow$1","enabled","phase","fn","requires","requiresIfExists","hash","getOppositePlacement","replace","matched","start","end","getOppositeVariationPlacement","computeAutoPlacement","_options","boundary","rootBoundary","flipVariations","_options$allowedAutoP","allowedAutoPlacements","allPlacements","variation","getVariation","placements","variationPlacements","filter","allowedPlacements","length","overflows","reduce","acc","detectOverflow","keys","sort","a","b","getExpandedFallbackPlacements","auto","oppositePlacement","flip","_skip","_options$mainAxis","mainAxis","checkMainAxis","_options$altAxis","altAxis","checkAltAxis","specifiedFallbackPlacements","fallbackPlacements","altBoundary","_options$flipVariatio","preferredPlacement","isBasePlacement","concat","referenceRect","popperRect","checksMap","Map","makeFallbackChecks","firstFittingPlacement","i","_basePlacement","isStartVariation","overflow","mainVariationSide","altVariationSide","checks","push","every","check","set","numberOfChecks","_loop","_i","fittingPlacement","find","get","slice","_ret","reset","flip$1","data","getSideOffsets","rect","preventedOffsets","x","y","height","width","isAnySideFullyClipped","some","side","hide","preventOverflow","referenceOverflow","elementContext","popperAltOverflow","referenceClippingOffsets","popperEscapeOffsets","isReferenceHidden","hasPopperEscaped","attributes","hide$1","distanceAndSkiddingToXY","invertDistance","skidding","distance","_options$offset","_data$state$placement","offset$1","defaultModifiers","eventListeners","computeStyles","applyStyles","createPopper","popperGenerator","atomicCitationCss","AtomicCitationStyle0","AtomicCitation","this","isOpen","hoverAnalyticsTimeout","hoverDebounceTimeoutMs","openPopover","closePopover","clearTimeout","hoverTimeout","delayedPopoverOpen","setTimeout","sendHoverAnalytics","hoverStart","Date","getTime","difference","sendHoverEndEvent","undefined","componentDidRender","popperInstance","citationRef","popupRef","modifiers","componentDidUpdate","_a","forceUpdate","getTruncatedText","citation","text","trim","renderPopover","h","part","class","ref","el","role","uri","Heading","level","title","render","key","LinkWithItemAnalytics","href","clickUri","target","rel","className","onSelect","interactiveCitation","select","onBeginDelayedSelect","beginDelayedSelect","onCancelPendingSelect","cancelPendingSelect","stopPropagation","onMouseLeave","onMouseOver","onFocus","onBlur","index"],"sources":["../../node_modules/@popperjs/core/lib/modifiers/arrow.js","../../node_modules/@popperjs/core/lib/utils/getOppositePlacement.js","../../node_modules/@popperjs/core/lib/utils/getOppositeVariationPlacement.js","../../node_modules/@popperjs/core/lib/utils/computeAutoPlacement.js","../../node_modules/@popperjs/core/lib/modifiers/flip.js","../../node_modules/@popperjs/core/lib/modifiers/hide.js","../../node_modules/@popperjs/core/lib/modifiers/offset.js","../../node_modules/@popperjs/core/lib/popper.js","src/components/common/generated-answer/atomic-citation/atomic-citation.pcss?tag=atomic-citation","src/components/common/generated-answer/atomic-citation/atomic-citation.tsx"],"sourcesContent":["import getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getLayoutRect from \"../dom-utils/getLayoutRect.js\";\nimport contains from \"../dom-utils/contains.js\";\nimport getOffsetParent from \"../dom-utils/getOffsetParent.js\";\nimport getMainAxisFromPlacement from \"../utils/getMainAxisFromPlacement.js\";\nimport { within } from \"../utils/within.js\";\nimport mergePaddingObject from \"../utils/mergePaddingObject.js\";\nimport expandToHashMap from \"../utils/expandToHashMap.js\";\nimport { left, right, basePlacements, top, bottom } from \"../enums.js\"; // eslint-disable-next-line import/no-unused-modules\n\nvar toPaddingObject = function toPaddingObject(padding, state) {\n  padding = typeof padding === 'function' ? padding(Object.assign({}, state.rects, {\n    placement: state.placement\n  })) : padding;\n  return mergePaddingObject(typeof padding !== 'number' ? padding : expandToHashMap(padding, basePlacements));\n};\n\nfunction arrow(_ref) {\n  var _state$modifiersData$;\n\n  var state = _ref.state,\n      name = _ref.name,\n      options = _ref.options;\n  var arrowElement = state.elements.arrow;\n  var popperOffsets = state.modifiersData.popperOffsets;\n  var basePlacement = getBasePlacement(state.placement);\n  var axis = getMainAxisFromPlacement(basePlacement);\n  var isVertical = [left, right].indexOf(basePlacement) >= 0;\n  var len = isVertical ? 'height' : 'width';\n\n  if (!arrowElement || !popperOffsets) {\n    return;\n  }\n\n  var paddingObject = toPaddingObject(options.padding, state);\n  var arrowRect = getLayoutRect(arrowElement);\n  var minProp = axis === 'y' ? top : left;\n  var maxProp = axis === 'y' ? bottom : right;\n  var endDiff = state.rects.reference[len] + state.rects.reference[axis] - popperOffsets[axis] - state.rects.popper[len];\n  var startDiff = popperOffsets[axis] - state.rects.reference[axis];\n  var arrowOffsetParent = getOffsetParent(arrowElement);\n  var clientSize = arrowOffsetParent ? axis === 'y' ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;\n  var centerToReference = endDiff / 2 - startDiff / 2; // Make sure the arrow doesn't overflow the popper if the center point is\n  // outside of the popper bounds\n\n  var min = paddingObject[minProp];\n  var max = clientSize - arrowRect[len] - paddingObject[maxProp];\n  var center = clientSize / 2 - arrowRect[len] / 2 + centerToReference;\n  var offset = within(min, center, max); // Prevents breaking syntax highlighting...\n\n  var axisProp = axis;\n  state.modifiersData[name] = (_state$modifiersData$ = {}, _state$modifiersData$[axisProp] = offset, _state$modifiersData$.centerOffset = offset - center, _state$modifiersData$);\n}\n\nfunction effect(_ref2) {\n  var state = _ref2.state,\n      options = _ref2.options;\n  var _options$element = options.element,\n      arrowElement = _options$element === void 0 ? '[data-popper-arrow]' : _options$element;\n\n  if (arrowElement == null) {\n    return;\n  } // CSS selector\n\n\n  if (typeof arrowElement === 'string') {\n    arrowElement = state.elements.popper.querySelector(arrowElement);\n\n    if (!arrowElement) {\n      return;\n    }\n  }\n\n  if (!contains(state.elements.popper, arrowElement)) {\n    return;\n  }\n\n  state.elements.arrow = arrowElement;\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'arrow',\n  enabled: true,\n  phase: 'main',\n  fn: arrow,\n  effect: effect,\n  requires: ['popperOffsets'],\n  requiresIfExists: ['preventOverflow']\n};","var hash = {\n  left: 'right',\n  right: 'left',\n  bottom: 'top',\n  top: 'bottom'\n};\nexport default function getOppositePlacement(placement) {\n  return placement.replace(/left|right|bottom|top/g, function (matched) {\n    return hash[matched];\n  });\n}","var hash = {\n  start: 'end',\n  end: 'start'\n};\nexport default function getOppositeVariationPlacement(placement) {\n  return placement.replace(/start|end/g, function (matched) {\n    return hash[matched];\n  });\n}","import getVariation from \"./getVariation.js\";\nimport { variationPlacements, basePlacements, placements as allPlacements } from \"../enums.js\";\nimport detectOverflow from \"./detectOverflow.js\";\nimport getBasePlacement from \"./getBasePlacement.js\";\nexport default function computeAutoPlacement(state, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _options = options,\n      placement = _options.placement,\n      boundary = _options.boundary,\n      rootBoundary = _options.rootBoundary,\n      padding = _options.padding,\n      flipVariations = _options.flipVariations,\n      _options$allowedAutoP = _options.allowedAutoPlacements,\n      allowedAutoPlacements = _options$allowedAutoP === void 0 ? allPlacements : _options$allowedAutoP;\n  var variation = getVariation(placement);\n  var placements = variation ? flipVariations ? variationPlacements : variationPlacements.filter(function (placement) {\n    return getVariation(placement) === variation;\n  }) : basePlacements;\n  var allowedPlacements = placements.filter(function (placement) {\n    return allowedAutoPlacements.indexOf(placement) >= 0;\n  });\n\n  if (allowedPlacements.length === 0) {\n    allowedPlacements = placements;\n  } // $FlowFixMe[incompatible-type]: Flow seems to have problems with two array unions...\n\n\n  var overflows = allowedPlacements.reduce(function (acc, placement) {\n    acc[placement] = detectOverflow(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      padding: padding\n    })[getBasePlacement(placement)];\n    return acc;\n  }, {});\n  return Object.keys(overflows).sort(function (a, b) {\n    return overflows[a] - overflows[b];\n  });\n}","import getOppositePlacement from \"../utils/getOppositePlacement.js\";\nimport getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getOppositeVariationPlacement from \"../utils/getOppositeVariationPlacement.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\nimport computeAutoPlacement from \"../utils/computeAutoPlacement.js\";\nimport { bottom, top, start, right, left, auto } from \"../enums.js\";\nimport getVariation from \"../utils/getVariation.js\"; // eslint-disable-next-line import/no-unused-modules\n\nfunction getExpandedFallbackPlacements(placement) {\n  if (getBasePlacement(placement) === auto) {\n    return [];\n  }\n\n  var oppositePlacement = getOppositePlacement(placement);\n  return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];\n}\n\nfunction flip(_ref) {\n  var state = _ref.state,\n      options = _ref.options,\n      name = _ref.name;\n\n  if (state.modifiersData[name]._skip) {\n    return;\n  }\n\n  var _options$mainAxis = options.mainAxis,\n      checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis,\n      _options$altAxis = options.altAxis,\n      checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis,\n      specifiedFallbackPlacements = options.fallbackPlacements,\n      padding = options.padding,\n      boundary = options.boundary,\n      rootBoundary = options.rootBoundary,\n      altBoundary = options.altBoundary,\n      _options$flipVariatio = options.flipVariations,\n      flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio,\n      allowedAutoPlacements = options.allowedAutoPlacements;\n  var preferredPlacement = state.options.placement;\n  var basePlacement = getBasePlacement(preferredPlacement);\n  var isBasePlacement = basePlacement === preferredPlacement;\n  var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));\n  var placements = [preferredPlacement].concat(fallbackPlacements).reduce(function (acc, placement) {\n    return acc.concat(getBasePlacement(placement) === auto ? computeAutoPlacement(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      padding: padding,\n      flipVariations: flipVariations,\n      allowedAutoPlacements: allowedAutoPlacements\n    }) : placement);\n  }, []);\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var checksMap = new Map();\n  var makeFallbackChecks = true;\n  var firstFittingPlacement = placements[0];\n\n  for (var i = 0; i < placements.length; i++) {\n    var placement = placements[i];\n\n    var _basePlacement = getBasePlacement(placement);\n\n    var isStartVariation = getVariation(placement) === start;\n    var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;\n    var len = isVertical ? 'width' : 'height';\n    var overflow = detectOverflow(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      altBoundary: altBoundary,\n      padding: padding\n    });\n    var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;\n\n    if (referenceRect[len] > popperRect[len]) {\n      mainVariationSide = getOppositePlacement(mainVariationSide);\n    }\n\n    var altVariationSide = getOppositePlacement(mainVariationSide);\n    var checks = [];\n\n    if (checkMainAxis) {\n      checks.push(overflow[_basePlacement] <= 0);\n    }\n\n    if (checkAltAxis) {\n      checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);\n    }\n\n    if (checks.every(function (check) {\n      return check;\n    })) {\n      firstFittingPlacement = placement;\n      makeFallbackChecks = false;\n      break;\n    }\n\n    checksMap.set(placement, checks);\n  }\n\n  if (makeFallbackChecks) {\n    // `2` may be desired in some cases – research later\n    var numberOfChecks = flipVariations ? 3 : 1;\n\n    var _loop = function _loop(_i) {\n      var fittingPlacement = placements.find(function (placement) {\n        var checks = checksMap.get(placement);\n\n        if (checks) {\n          return checks.slice(0, _i).every(function (check) {\n            return check;\n          });\n        }\n      });\n\n      if (fittingPlacement) {\n        firstFittingPlacement = fittingPlacement;\n        return \"break\";\n      }\n    };\n\n    for (var _i = numberOfChecks; _i > 0; _i--) {\n      var _ret = _loop(_i);\n\n      if (_ret === \"break\") break;\n    }\n  }\n\n  if (state.placement !== firstFittingPlacement) {\n    state.modifiersData[name]._skip = true;\n    state.placement = firstFittingPlacement;\n    state.reset = true;\n  }\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'flip',\n  enabled: true,\n  phase: 'main',\n  fn: flip,\n  requiresIfExists: ['offset'],\n  data: {\n    _skip: false\n  }\n};","import { top, bottom, left, right } from \"../enums.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\n\nfunction getSideOffsets(overflow, rect, preventedOffsets) {\n  if (preventedOffsets === void 0) {\n    preventedOffsets = {\n      x: 0,\n      y: 0\n    };\n  }\n\n  return {\n    top: overflow.top - rect.height - preventedOffsets.y,\n    right: overflow.right - rect.width + preventedOffsets.x,\n    bottom: overflow.bottom - rect.height + preventedOffsets.y,\n    left: overflow.left - rect.width - preventedOffsets.x\n  };\n}\n\nfunction isAnySideFullyClipped(overflow) {\n  return [top, right, bottom, left].some(function (side) {\n    return overflow[side] >= 0;\n  });\n}\n\nfunction hide(_ref) {\n  var state = _ref.state,\n      name = _ref.name;\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var preventedOffsets = state.modifiersData.preventOverflow;\n  var referenceOverflow = detectOverflow(state, {\n    elementContext: 'reference'\n  });\n  var popperAltOverflow = detectOverflow(state, {\n    altBoundary: true\n  });\n  var referenceClippingOffsets = getSideOffsets(referenceOverflow, referenceRect);\n  var popperEscapeOffsets = getSideOffsets(popperAltOverflow, popperRect, preventedOffsets);\n  var isReferenceHidden = isAnySideFullyClipped(referenceClippingOffsets);\n  var hasPopperEscaped = isAnySideFullyClipped(popperEscapeOffsets);\n  state.modifiersData[name] = {\n    referenceClippingOffsets: referenceClippingOffsets,\n    popperEscapeOffsets: popperEscapeOffsets,\n    isReferenceHidden: isReferenceHidden,\n    hasPopperEscaped: hasPopperEscaped\n  };\n  state.attributes.popper = Object.assign({}, state.attributes.popper, {\n    'data-popper-reference-hidden': isReferenceHidden,\n    'data-popper-escaped': hasPopperEscaped\n  });\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'hide',\n  enabled: true,\n  phase: 'main',\n  requiresIfExists: ['preventOverflow'],\n  fn: hide\n};","import getBasePlacement from \"../utils/getBasePlacement.js\";\nimport { top, left, right, placements } from \"../enums.js\"; // eslint-disable-next-line import/no-unused-modules\n\nexport function distanceAndSkiddingToXY(placement, rects, offset) {\n  var basePlacement = getBasePlacement(placement);\n  var invertDistance = [left, top].indexOf(basePlacement) >= 0 ? -1 : 1;\n\n  var _ref = typeof offset === 'function' ? offset(Object.assign({}, rects, {\n    placement: placement\n  })) : offset,\n      skidding = _ref[0],\n      distance = _ref[1];\n\n  skidding = skidding || 0;\n  distance = (distance || 0) * invertDistance;\n  return [left, right].indexOf(basePlacement) >= 0 ? {\n    x: distance,\n    y: skidding\n  } : {\n    x: skidding,\n    y: distance\n  };\n}\n\nfunction offset(_ref2) {\n  var state = _ref2.state,\n      options = _ref2.options,\n      name = _ref2.name;\n  var _options$offset = options.offset,\n      offset = _options$offset === void 0 ? [0, 0] : _options$offset;\n  var data = placements.reduce(function (acc, placement) {\n    acc[placement] = distanceAndSkiddingToXY(placement, state.rects, offset);\n    return acc;\n  }, {});\n  var _data$state$placement = data[state.placement],\n      x = _data$state$placement.x,\n      y = _data$state$placement.y;\n\n  if (state.modifiersData.popperOffsets != null) {\n    state.modifiersData.popperOffsets.x += x;\n    state.modifiersData.popperOffsets.y += y;\n  }\n\n  state.modifiersData[name] = data;\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'offset',\n  enabled: true,\n  phase: 'main',\n  requires: ['popperOffsets'],\n  fn: offset\n};","import { popperGenerator, detectOverflow } from \"./createPopper.js\";\nimport eventListeners from \"./modifiers/eventListeners.js\";\nimport popperOffsets from \"./modifiers/popperOffsets.js\";\nimport computeStyles from \"./modifiers/computeStyles.js\";\nimport applyStyles from \"./modifiers/applyStyles.js\";\nimport offset from \"./modifiers/offset.js\";\nimport flip from \"./modifiers/flip.js\";\nimport preventOverflow from \"./modifiers/preventOverflow.js\";\nimport arrow from \"./modifiers/arrow.js\";\nimport hide from \"./modifiers/hide.js\";\nvar defaultModifiers = [eventListeners, popperOffsets, computeStyles, applyStyles, offset, flip, preventOverflow, arrow, hide];\nvar createPopper = /*#__PURE__*/popperGenerator({\n  defaultModifiers: defaultModifiers\n}); // eslint-disable-next-line import/no-unused-modules\n\nexport { createPopper, popperGenerator, defaultModifiers, detectOverflow }; // eslint-disable-next-line import/no-unused-modules\n\nexport { createPopper as createPopperLite } from \"./popper-lite.js\"; // eslint-disable-next-line import/no-unused-modules\n\nexport * from \"./modifiers/index.js\";","@import '../../../../global/global.pcss';\n@import '../../../../global/mixins.pcss';\n\n[part='citation'] {\n  --height: 2.2em;\n  --index-height: 1.1em;\n  --max-citation-width: 400px;\n\n  max-width: var(--max-citation-width);\n  height: var(--height);\n}\n\n[part='citation-index'] {\n  height: var(--index-height);\n  width: var(--index-height);\n}\n\n[part='citation-popover'] {\n  --popover-width: 350px;\n\n  width: var(--popover-width);\n\n  p {\n    @mixin set-font-size var(--atomic-text-sm);\n  }\n}\n","import {GeneratedAnswerCitation, InteractiveCitation} from '@coveo/headless';\nimport {\n  createPopper,\n  preventOverflow,\n  Instance as PopperInstance,\n} from '@popperjs/core';\nimport {Component, h, State, Prop, Element, Watch} from '@stencil/core';\nimport {Heading} from '../../heading';\nimport {LinkWithItemAnalytics} from '../../item-link/item-link';\n\n/**\n * @internal\n */\n@Component({\n  tag: 'atomic-citation',\n  styleUrl: 'atomic-citation.pcss',\n})\nexport class AtomicCitation {\n  @Element() public host!: HTMLElement;\n\n  /**\n   * The citation item information.\n   */\n  @Prop() citation!: GeneratedAnswerCitation;\n  /**\n   * The citation index.\n   */\n  @Prop() index!: number;\n  /**\n   * Callback function invoked when the user stops hovering over a citation. `citationHoverTimeMs` is the amount of time over which the citation has been hovered.\n   */\n  @Prop() sendHoverEndEvent!: (citationHoverTimeMs: number) => void;\n  /**\n   * An `InteractiveCitation` controller instance. It is used when the user interacts with the citation by selecting or hovering over it.\n   */\n  @Prop() interactiveCitation!: InteractiveCitation;\n\n  @State() public isOpen = false;\n\n  private citationRef!: HTMLElement;\n  private popupRef!: HTMLElement;\n  private popperInstance?: PopperInstance;\n  private stopPropagation?: boolean;\n\n  private hoverStart?: number;\n  private hoverAnalyticsTimeout = 1000;\n\n  private hoverTimeout?: ReturnType<typeof setTimeout>;\n  private hoverDebounceTimeoutMs = 200;\n\n  @Watch('isOpen')\n  sendHoverAnalytics() {\n    if (this.isOpen) {\n      this.hoverStart = new Date().getTime();\n      return;\n    }\n    if (!this.hoverStart) {\n      return;\n    }\n    const difference = new Date().getTime() - this.hoverStart;\n    if (difference > this.hoverAnalyticsTimeout) {\n      this.sendHoverEndEvent(difference);\n    }\n    this.hoverStart = undefined;\n  }\n\n  public componentDidRender() {\n    if (this.popperInstance || !this.citationRef || !this.popupRef) {\n      return;\n    }\n\n    this.popperInstance = createPopper(this.citationRef, this.popupRef, {\n      placement: 'top-start',\n      modifiers: [\n        {\n          name: 'offset',\n          options: {\n            offset: [0, 6],\n          },\n        },\n        preventOverflow,\n      ],\n    });\n  }\n\n  public componentDidUpdate() {\n    this.popperInstance?.forceUpdate();\n  }\n\n  private getTruncatedText() {\n    return (\n      this.citation.text &&\n      `${this.citation.text?.trim().slice(0, 200)}${\n        this.citation.text.length > 200 ? '...' : ''\n      }`\n    );\n  }\n\n  private openPopover = () => {\n    this.isOpen = true;\n  };\n\n  private closePopover = () => {\n    clearTimeout(this.hoverTimeout);\n    this.isOpen = false;\n  };\n\n  private delayedPopoverOpen = () => {\n    clearTimeout(this.hoverTimeout);\n    this.hoverTimeout = setTimeout(\n      this.openPopover,\n      this.hoverDebounceTimeoutMs\n    );\n  };\n\n  private renderPopover() {\n    return (\n      <div\n        part=\"citation-popover\"\n        class={`rounded-md border border-neutral p-4 shadow z-10 bg-background ${\n          this.isOpen ? 'desktop-only:flex' : 'hidden'\n        } flex-col gap-3 mobile-only:hidden`}\n        ref={(el) => (this.popupRef = el!)}\n        role=\"dialog\"\n      >\n        <div class=\"truncate text-neutral-dark text-sm\">\n          {this.citation.uri}\n        </div>\n        <Heading level={0} class=\"font-bold text-md\">\n          {this.citation.title}\n        </Heading>\n        <p class=\"text-on-background text-sm\">{this.getTruncatedText()}</p>\n      </div>\n    );\n  }\n\n  public render() {\n    return (\n      <div class=\"relative\">\n        <LinkWithItemAnalytics\n          href={this.citation.clickUri ?? this.citation.uri}\n          ref={(el) => (this.citationRef = el!)}\n          part=\"citation\"\n          target=\"_blank\"\n          rel=\"noopener\"\n          aria-haspopup=\"dialog\"\n          className=\"flex items-center p-1 bg-background btn-outline-primary border rounded-full border-neutral text-on-background\"\n          onSelect={() => this.interactiveCitation.select()}\n          onBeginDelayedSelect={() =>\n            this.interactiveCitation.beginDelayedSelect()\n          }\n          onCancelPendingSelect={() =>\n            this.interactiveCitation.cancelPendingSelect()\n          }\n          stopPropagation={this.stopPropagation}\n          onMouseLeave={this.closePopover}\n          onMouseOver={this.delayedPopoverOpen}\n          onFocus={this.openPopover}\n          onBlur={this.closePopover}\n        >\n          <div\n            part=\"citation-index\"\n            class=\"rounded-full font-medium flex items-center text-bg-primary shrink-0\"\n          >\n            <div class=\"mx-auto\">{this.index + 1}</div>\n          </div>\n          <span class=\"citation-title truncate mx-1\">\n            {this.citation.title}\n          </span>\n        </LinkWithItemAnalytics>\n        {this.renderPopover()}\n      </div>\n    );\n  }\n}\n"],"mappings":"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"}