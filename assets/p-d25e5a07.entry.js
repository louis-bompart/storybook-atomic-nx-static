import{r as t,h as e,g as s}from"./p-00525453.js";import{t as i,M as r}from"./p-e12016d2.js";import{e as n}from"./p-8f5830b4.js";import{I as o}from"./p-5ff0fe21.js";import{g as h,a,I as l}from"./p-0e55feeb.js";import{d as u}from"./p-2130c607.js";import"./p-a2fc549d.js";import"./p-b0ede3ce.js";import"./p-1580513b.js";import"./p-f5723aee.js";import"./p-e9c4f463.js";const c=class{constructor(e){t(this,e);this.results=[];this.display="list";this.templateHasError=false;this.maxResultsPerQuery=4;this.density="normal";this.imageSize="icon";this.error=undefined;this.templateHasError=false;this.maxResultsPerQuery=4;this.density="normal";this.imageSize="icon";this.ariaLabelGenerator=undefined}async setRenderFunction(t){this.itemRenderingFunction=t}componentWillLoad(){try{u((t=>{this.bindings=t;return this.initialize()}),this.host)}catch(t){this.error=t}}getLink(t){var e;const s=t.tagName==="ATOMIC-RESULT"?t:t===null||t===void 0?void 0:t.querySelector("atomic-result");return((e=s===null||s===void 0?void 0:s.shadowRoot)===null||e===void 0?void 0:e.querySelector("atomic-result-link a"))||null}handleLinkClick(t,e){const s=e=>t.setAttribute("target",e);const i=t.getAttribute("target");e&&s("_blank");t.click();e&&s(i||"");return true}renderItems(){if(!this.bindings.suggestedQuery()||this.bindings.store.isMobile()){return[]}const t=this.instantResults.state.results.length?this.instantResults.state.results:this.results;const s=t.map((t=>{var s;const r=h(this.bindings.i18n,((s=this.ariaLabelGenerator)===null||s===void 0?void 0:s.call(this,this.bindings,t))||t.title,t.uniqueId);return{...r,content:e("atomic-result",{key:`instant-result-${n(t.uniqueId)}`,part:"outline",result:t,interactiveResult:i(this.bindings.engine,{options:{result:t}}),display:this.display,density:this.density,imageSize:this.imageSize,content:this.itemTemplateProvider.getTemplateContent(t),stopPropagation:false,renderingFunction:this.itemRenderingFunction}),onSelect:t=>{const e=this.getLink(t.target);if(!e){return}this.handleLinkClick(e,t.ctrlKey||t.metaKey)}}}));if(s.length){const t=a(this.bindings.i18n);s.push({...t,content:e(l,{i18n:this.bindings.i18n}),onSelect:()=>{this.bindings.clearSuggestions();this.bindings.searchBoxController.updateText(this.instantResults.state.q);this.bindings.searchBoxController.submit()}})}return s}initialize(){this.instantResults=r(this.bindings.engine,{options:{maxResultsPerQuery:this.maxResultsPerQuery}});this.itemTemplateProvider=new o({includeDefaultTemplate:true,templateElements:Array.from(this.host.querySelectorAll("atomic-result-template")),getResultTemplateRegistered:()=>true,setResultTemplateRegistered:()=>{},getTemplateHasError:()=>this.templateHasError,setTemplateHasError:t=>{this.templateHasError=t},bindings:this.bindings});return{position:Array.from(this.host.parentNode.children).indexOf(this.host),panel:"right",onSuggestedQueryChange:t=>{this.instantResults.updateQuery(t);return this.onSuggestedQueryChange()},renderItems:()=>this.renderItems()}}onSuggestedQueryChange(){if(!this.bindings.getSuggestionElements().length&&!this.bindings.searchBoxController.state.value){console.warn("There doesn't seem to be any query suggestions configured. Make sure to include either an atomic-search-box-query-suggestions or atomic-search-box-recent-queries in your search box in order to see some instant results.")}return new Promise((t=>{const e=this.instantResults.subscribe((()=>{const s=this.instantResults.state;if(!s.isLoading){if(s.results.length){this.results=s.results}e();t()}}))}))}render(){if(this.error){return e("atomic-component-error",{key:"2aa28f637287f77b33d238a9b2b1ff248e06f37d",element:this.host,error:this.error})}}get host(){return s(this)}};export{c as atomic_search_box_instant_results};
//# sourceMappingURL=p-d25e5a07.entry.js.map