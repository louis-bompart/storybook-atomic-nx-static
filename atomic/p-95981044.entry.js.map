{"version":3,"names":["AtomicResultLocalizedText","this","field","render","bindings","i18n","t","localeKey","parseFieldValues","parseFieldCount","ret","Object","keys","length","entries","forEach","fieldName","i18nParameter","fieldValueRaw","ResultTemplatesHelpers","getResultProperty","result","isNullOrUndefined","fieldCount","count","_a","__decorate","InitializeBindings","ResultContext","MapProp"],"sources":["src/components/search/result-template-components/atomic-result-localized-text/atomic-result-localized-text.ts"],"sourcesContent":["import {isNullOrUndefined} from '@coveo/bueno';\r\nimport {Result, ResultTemplatesHelpers} from '@coveo/headless';\r\nimport {Component, Prop, State} from '@stencil/core';\r\nimport {\r\n  InitializableComponent,\r\n  InitializeBindings,\r\n} from '../../../../utils/initialization-utils';\r\nimport {MapProp} from '../../../../utils/props-utils';\r\nimport {Bindings} from '../../atomic-search-interface/atomic-search-interface';\r\nimport {ResultContext} from '../result-template-decorators';\r\n\r\n/**\r\n * The `atomic-result-localized-text` component renders a target i18n localized string using the values of a target field.\r\n *\r\n * Given this i18n configuration:\r\n * ```\r\n * searchInterface.i18n.addResourceBundle('en', 'translation', {\r\n *    classic_book_advert: 'Classic book from {{name}}',\r\n * });\r\n * ```\r\n *\r\n * The component could be configured in such a way to replace `{{name}}` with the `author` field value from the result item:\r\n * ```\r\n * <atomic-result-localized-text locale-key=\"classic_book_advert\" field-author=\"name\"></atomic-result-localized-text>\r\n * ```\r\n *\r\n * @MapProp name: field;attr: field;docs: The field from which to extract the target string and the variable used to map it to the target i18n parameter. For example, the following configuration extracts the value of `author` from a result, and assign it to the i18n parameter `name`: `field-author=\"name\"`;type: Record<string, string> ;default: {}\r\n */\r\n@Component({\r\n  tag: 'atomic-result-localized-text',\r\n})\r\nexport class AtomicResultLocalizedText implements InitializableComponent {\r\n  @InitializeBindings() public bindings!: Bindings;\r\n  @State() public error!: Error;\r\n\r\n  @ResultContext() private result!: Result;\r\n  /**\r\n   * The i18n translation key.\r\n   */\r\n  @Prop() localeKey!: string;\r\n  /**\r\n   * The field value to dynamically evaluate.\r\n   */\r\n  @MapProp() field: Record<string, string> = {};\r\n  /**\r\n   * The numerical field value used to determine whether to use the singular or plural value of a translation.\r\n   * */\r\n  @Prop() fieldCount?: string;\r\n\r\n  render() {\r\n    return this.bindings.i18n.t(this.localeKey, {\r\n      ...this.parseFieldValues(),\r\n      ...this.parseFieldCount(),\r\n    });\r\n  }\r\n\r\n  private parseFieldValues() {\r\n    const ret: Record<string, unknown> = {};\r\n    if (Object.keys(this.field).length === 0) {\r\n      return ret;\r\n    }\r\n    Object.entries(this.field).forEach(([fieldName, i18nParameter]) => {\r\n      const fieldValueRaw = ResultTemplatesHelpers.getResultProperty(\r\n        this.result,\r\n        fieldName\r\n      );\r\n      if (!isNullOrUndefined(fieldValueRaw)) {\r\n        ret[i18nParameter] = fieldValueRaw;\r\n      }\r\n    });\r\n\r\n    return ret;\r\n  }\r\n\r\n  private parseFieldCount() {\r\n    if (!this.fieldCount) {\r\n      return {};\r\n    }\r\n    return {\r\n      count:\r\n        (ResultTemplatesHelpers.getResultProperty(\r\n          this.result,\r\n          this.fieldCount!\r\n        ) as number) ?? 1,\r\n    };\r\n  }\r\n}\r\n"],"mappings":"yqBA+BaA,EAAyB,M,yBAYzBC,KAAAC,MAAgC,G,wEAM3C,MAAAC,GACE,OAAOF,KAAKG,SAASC,KAAKC,EAAEL,KAAKM,UAAW,IACvCN,KAAKO,sBACLP,KAAKQ,mB,CAIJ,gBAAAD,GACN,MAAME,EAA+B,GACrC,GAAIC,OAAOC,KAAKX,KAAKC,OAAOW,SAAW,EAAG,CACxC,OAAOH,C,CAETC,OAAOG,QAAQb,KAAKC,OAAOa,SAAQ,EAAEC,EAAWC,MAC9C,MAAMC,EAAgBC,EAAuBC,kBAC3CnB,KAAKoB,OACLL,GAEF,IAAKM,EAAkBJ,GAAgB,CACrCR,EAAIO,GAAiBC,C,KAIzB,OAAOR,C,CAGD,eAAAD,G,MACN,IAAKR,KAAKsB,WAAY,CACpB,MAAO,E,CAET,MAAO,CACLC,OACEC,EAACN,EAAuBC,kBACtBnB,KAAKoB,OACLpB,KAAKsB,eACK,MAAAE,SAAA,EAAAA,EAAI,E,GAnDOC,EAAA,CAA5BC,K,+BAGwBD,EAAA,CAAxBE,K,6BAQUF,EAAA,CAAVG,K"}