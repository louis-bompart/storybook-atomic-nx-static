{"version":3,"names":["atomicIpxResultLinkCss","AtomicIpxResultLinkStyle0","AtomicIPXResultLink","initialize","this","host","dispatchEvent","buildCustomEvent","stopPropagation","actionsHistoryActions","loadIPXActionsHistoryActions","bindings","engine","connectedCallback","slotName","hasDefaultSlot","getDefaultSlotFromHost","linkAttributes","getAttributesFromLinkSlot","onSelect","resultPermanentId","result","raw","permanentid","action","addPageViewEntryInActionsHistory","dispatch","interactiveResult","select","render","href","isUndefined","hrefTemplate","clickUri","buildStringTemplateFromResult","h","LinkWithItemAnalytics","key","onBeginDelayedSelect","beginDelayedSelect","onCancelPendingSelect","cancelPendingSelect","attributes","field","default","__decorate","InitializeBindings","ResultContext","InteractiveResultContext"],"sources":["src/components/ipx/atomic-ipx-result-link/atomic-ipx-result-link.pcss?tag=atomic-ipx-result-link","src/components/ipx/atomic-ipx-result-link/atomic-ipx-result-link.tsx"],"sourcesContent":["@import '../../../global/mixins.pcss';\r\n\r\natomic-ipx-result-link {\r\n  a {\r\n    @mixin link-style;\r\n  }\r\n}\r\n","import {isUndefined} from '@coveo/bueno';\r\nimport {\r\n  IPXActionsHistoryActionCreators,\r\n  InteractiveResult,\r\n  loadIPXActionsHistoryActions,\r\n} from '@coveo/headless';\r\nimport {Component, h, Prop, Element} from '@stencil/core';\r\nimport {Bindings} from '../../../components';\r\nimport {buildCustomEvent} from '../../../utils/event-utils';\r\nimport {\r\n  InitializableComponent,\r\n  InitializeBindings,\r\n} from '../../../utils/initialization-utils';\r\nimport {buildStringTemplateFromResult} from '../../../utils/result-utils';\r\nimport {getDefaultSlotFromHost} from '../../../utils/slot-utils';\r\nimport {AnyUnfoldedItem} from '../../common/interface/item';\r\nimport {getAttributesFromLinkSlot} from '../../common/item-link/attributes-slot';\r\nimport {LinkWithItemAnalytics} from '../../common/item-link/item-link';\r\nimport {\r\n  ResultContext,\r\n  InteractiveResultContext,\r\n} from '../../search/result-template-components/result-template-decorators';\r\n\r\n/**\r\n * The `atomic-ipx-result-link` component automatically transforms a search result title into a clickable link that points to the original item. It is an experimental internal component not intended for general use.\r\n * @slot default - Lets you display alternative content inside the link\r\n * @slot attributes - Lets you pass [attributes](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a#attributes) down to the link element, overriding other attributes, to be used exclusively with an \"a\" tag such as `<a slot=\"attributes\" target=\"_blank\" download></a>`.\r\n * @internal\r\n */\r\n@Component({\r\n  tag: 'atomic-ipx-result-link',\r\n  styleUrl: 'atomic-ipx-result-link.pcss',\r\n  shadow: false,\r\n})\r\nexport class AtomicIPXResultLink implements InitializableComponent {\r\n  @InitializeBindings() public bindings!: Bindings;\r\n  public error!: Error;\r\n\r\n  @ResultContext() private result!: AnyUnfoldedItem;\r\n  @InteractiveResultContext() private interactiveResult!: InteractiveResult;\r\n\r\n  @Element() private host!: HTMLElement;\r\n\r\n  /**\r\n   * Specifies a template literal from which to generate the `href` attribute value (see\r\n   * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\r\n   *\r\n   * The template literal can reference any number of result properties from the parent result. It can also reference the window object.\r\n   *\r\n   * For example, the following markup generates an `href` value such as `http://uri.com?id=itemTitle`, using the result's `clickUri` and `itemtitle` fields.\r\n   * ```html\r\n   * <atomic-ipx-result-link href-template='${clickUri}?id=${raw.itemtitle}'></atomic-ipx-result-link>\r\n   * ```\r\n   */\r\n  @Prop({reflect: true}) hrefTemplate?: string;\r\n\r\n  private hasDefaultSlot!: boolean;\r\n  private linkAttributes?: Attr[];\r\n  private stopPropagation?: boolean;\r\n  private actionsHistoryActions?: IPXActionsHistoryActionCreators;\r\n\r\n  public initialize() {\r\n    this.host.dispatchEvent(\r\n      buildCustomEvent(\r\n        'atomic/resolveStopPropagation',\r\n        (stopPropagation: boolean) => {\r\n          this.stopPropagation = stopPropagation;\r\n        }\r\n      )\r\n    );\r\n    this.actionsHistoryActions = loadIPXActionsHistoryActions(\r\n      this.bindings.engine\r\n    );\r\n  }\r\n\r\n  public connectedCallback() {\r\n    const slotName = 'attributes';\r\n    this.hasDefaultSlot = !!getDefaultSlotFromHost(this.host);\r\n    this.linkAttributes = getAttributesFromLinkSlot(this.host, slotName);\r\n  }\r\n\r\n  public async onSelect() {\r\n    const resultPermanentId = this.result.raw.permanentid;\r\n    if (resultPermanentId && this.actionsHistoryActions) {\r\n      const action =\r\n        this.actionsHistoryActions.addPageViewEntryInActionsHistory(\r\n          resultPermanentId\r\n        );\r\n      this.bindings.engine.dispatch(action);\r\n    }\r\n    this.interactiveResult.select();\r\n  }\r\n\r\n  public render() {\r\n    const href = isUndefined(this.hrefTemplate)\r\n      ? this.result.clickUri\r\n      : buildStringTemplateFromResult(\r\n          this.hrefTemplate,\r\n          this.result,\r\n          this.bindings\r\n        );\r\n\r\n    return (\r\n      <LinkWithItemAnalytics\r\n        href={href}\r\n        onSelect={() => this.onSelect()}\r\n        onBeginDelayedSelect={() => this.interactiveResult.beginDelayedSelect()}\r\n        onCancelPendingSelect={() =>\r\n          this.interactiveResult.cancelPendingSelect()\r\n        }\r\n        attributes={this.linkAttributes}\r\n        stopPropagation={this.stopPropagation}\r\n      >\r\n        {this.hasDefaultSlot ? (\r\n          <slot />\r\n        ) : (\r\n          <atomic-result-text\r\n            field=\"title\"\r\n            default=\"no-title\"\r\n          ></atomic-result-text>\r\n        )}\r\n      </LinkWithItemAnalytics>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"gcAAA,MAAMA,EAAyB,yeAC/B,MAAAC,EAAeD,E,iXCiCFE,EAAmB,M,qDA2BvB,UAAAC,GACLC,KAAKC,KAAKC,cACRC,EACE,iCACCC,IACCJ,KAAKI,gBAAkBA,CAAe,KAI5CJ,KAAKK,sBAAwBC,EAC3BN,KAAKO,SAASC,O,CAIX,iBAAAC,GACL,MAAMC,EAAW,aACjBV,KAAKW,iBAAmBC,EAAuBZ,KAAKC,MACpDD,KAAKa,eAAiBC,EAA0Bd,KAAKC,KAAMS,E,CAGtD,cAAMK,GACX,MAAMC,EAAoBhB,KAAKiB,OAAOC,IAAIC,YAC1C,GAAIH,GAAqBhB,KAAKK,sBAAuB,CACnD,MAAMe,EACJpB,KAAKK,sBAAsBgB,iCACzBL,GAEJhB,KAAKO,SAASC,OAAOc,SAASF,E,CAEhCpB,KAAKuB,kBAAkBC,Q,CAGlB,MAAAC,GACL,MAAMC,EAAOC,EAAY3B,KAAK4B,cAC1B5B,KAAKiB,OAAOY,SACZC,EACE9B,KAAK4B,aACL5B,KAAKiB,OACLjB,KAAKO,UAGX,OACEwB,EAACC,EAAqB,CAAAC,IAAA,2CACpBP,KAAMA,EACNX,SAAU,IAAMf,KAAKe,WACrBmB,qBAAsB,IAAMlC,KAAKuB,kBAAkBY,qBACnDC,sBAAuB,IACrBpC,KAAKuB,kBAAkBc,sBAEzBC,WAAYtC,KAAKa,eACjBT,gBAAiBJ,KAAKI,iBAErBJ,KAAKW,eACJoB,EAAA,aAEAA,EAAA,sBACEQ,MAAM,QACNC,QAAQ,a,6BAnFWC,EAAA,CAA5BC,K,+BAGwBD,EAAA,CAAxBE,K,6BACmCF,EAAA,CAAnCG,K"}