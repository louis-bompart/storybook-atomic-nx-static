/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ll=Object.create,ha=Object.defineProperty,dl=Object.getOwnPropertyDescriptor,fl=Object.getOwnPropertyNames,pl=Object.getPrototypeOf,hl=Object.prototype.hasOwnProperty,gl=(e,t,r)=>t in e?ha(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ml=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),se=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),yl=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of fl(t))!hl.call(e,a)&&a!==r&&ha(e,a,{get:()=>t[a],enumerable:!(n=dl(t,a))||n.enumerable});return e},Ae=(e,t,r)=>(r=e!=null?ll(pl(e)):{},yl(!e||!e.__esModule?ha(r,"default",{value:e,enumerable:!0}):r,e)),Mo=(e,t,r)=>gl(e,t+"",r),vl=se((e,t)=>{t.exports=fetch}),Sl=se(e=>{var t=e&&e.__assign||function(){return t=Object.assign||function(a){for(var i,o=1,s=arguments.length;o<s;o++){i=arguments[o];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(a[c]=i[c])}return a},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var r={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};function n(a){var i=t(t({},r),a);return i.numOfAttempts<1&&(i.numOfAttempts=1),i}e.getSanitizedOptions=n}),wl=se(e=>{Object.defineProperty(e,"__esModule",{value:!0});function t(r){var n=Math.random()*r;return Math.round(n)}e.fullJitter=t}),bl=se(e=>{Object.defineProperty(e,"__esModule",{value:!0});function t(r){return r}e.noJitter=t}),Cl=se(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=wl(),r=bl();function n(a){switch(a.jitter){case"full":return t.fullJitter;case"none":default:return r.noJitter}}e.JitterFactory=n}),Uo=se(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Cl(),r=function(){function n(a){this.options=a,this.attempt=0}return n.prototype.apply=function(){var a=this;return new Promise(function(i){return setTimeout(i,a.jitteredDelay)})},n.prototype.setAttemptNumber=function(a){this.attempt=a},Object.defineProperty(n.prototype,"jitteredDelay",{get:function(){var a=t.JitterFactory(this.options);return a(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"delay",{get:function(){var a=this.options.startingDelay,i=this.options.timeMultiple,o=this.numOfDelayedAttempts,s=a*Math.pow(i,o);return Math.min(s,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),n}();e.Delay=r}),Il=se(e=>{var t=e&&e.__extends||function(){var o=function(s,c){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,l){u.__proto__=l}||function(u,l){for(var d in l)l.hasOwnProperty(d)&&(u[d]=l[d])},o(s,c)};return function(s,c){o(s,c);function u(){this.constructor=s}s.prototype=c===null?Object.create(c):(u.prototype=c.prototype,new u)}}(),r=e&&e.__awaiter||function(o,s,c,u){function l(d){return d instanceof c?d:new c(function(p){p(d)})}return new(c||(c=Promise))(function(d,p){function g(m){try{f(u.next(m))}catch(C){p(C)}}function b(m){try{f(u.throw(m))}catch(C){p(C)}}function f(m){m.done?d(m.value):l(m.value).then(g,b)}f((u=u.apply(o,s||[])).next())})},n=e&&e.__generator||function(o,s){var c={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},u,l,d,p;return p={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function g(f){return function(m){return b([f,m])}}function b(f){if(u)throw new TypeError("Generator is already executing.");for(;c;)try{if(u=1,l&&(d=f[0]&2?l.return:f[0]?l.throw||((d=l.return)&&d.call(l),0):l.next)&&!(d=d.call(l,f[1])).done)return d;switch(l=0,d&&(f=[f[0]&2,d.value]),f[0]){case 0:case 1:d=f;break;case 4:return c.label++,{value:f[1],done:!1};case 5:c.label++,l=f[1],f=[0];continue;case 7:f=c.ops.pop(),c.trys.pop();continue;default:if(d=c.trys,!(d=d.length>0&&d[d.length-1])&&(f[0]===6||f[0]===2)){c=0;continue}if(f[0]===3&&(!d||f[1]>d[0]&&f[1]<d[3])){c.label=f[1];break}if(f[0]===6&&c.label<d[1]){c.label=d[1],d=f;break}if(d&&c.label<d[2]){c.label=d[2],c.ops.push(f);break}d[2]&&c.ops.pop(),c.trys.pop();continue}f=s.call(o,c)}catch(m){f=[6,m],l=0}finally{u=d=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var a=Uo(),i=function(o){t(s,o);function s(){return o!==null&&o.apply(this,arguments)||this}return s.prototype.apply=function(){return r(this,void 0,void 0,function(){return n(this,function(c){return[2,this.isFirstAttempt?!0:o.prototype.apply.call(this)]})})},Object.defineProperty(s.prototype,"isFirstAttempt",{get:function(){return this.attempt===0},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),s}(a.Delay);e.SkipFirstDelay=i}),ql=se(e=>{var t=e&&e.__extends||function(){var a=function(i,o){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,c){s.__proto__=c}||function(s,c){for(var u in c)c.hasOwnProperty(u)&&(s[u]=c[u])},a(i,o)};return function(i,o){a(i,o);function s(){this.constructor=i}i.prototype=o===null?Object.create(o):(s.prototype=o.prototype,new s)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=Uo(),n=function(a){t(i,a);function i(){return a!==null&&a.apply(this,arguments)||this}return i}(r.Delay);e.AlwaysDelay=n}),kl=se(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Il(),r=ql();function n(i,o){var s=a(i);return s.setAttemptNumber(o),s}e.DelayFactory=n;function a(i){return i.delayFirstAttempt?new r.AlwaysDelay(i):new t.SkipFirstDelay(i)}}),xl=se(e=>{var t=e&&e.__awaiter||function(s,c,u,l){function d(p){return p instanceof u?p:new u(function(g){g(p)})}return new(u||(u=Promise))(function(p,g){function b(C){try{m(l.next(C))}catch(k){g(k)}}function f(C){try{m(l.throw(C))}catch(k){g(k)}}function m(C){C.done?p(C.value):d(C.value).then(b,f)}m((l=l.apply(s,c||[])).next())})},r=e&&e.__generator||function(s,c){var u={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},l,d,p,g;return g={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function b(m){return function(C){return f([m,C])}}function f(m){if(l)throw new TypeError("Generator is already executing.");for(;u;)try{if(l=1,d&&(p=m[0]&2?d.return:m[0]?d.throw||((p=d.return)&&p.call(d),0):d.next)&&!(p=p.call(d,m[1])).done)return p;switch(d=0,p&&(m=[m[0]&2,p.value]),m[0]){case 0:case 1:p=m;break;case 4:return u.label++,{value:m[1],done:!1};case 5:u.label++,d=m[1],m=[0];continue;case 7:m=u.ops.pop(),u.trys.pop();continue;default:if(p=u.trys,!(p=p.length>0&&p[p.length-1])&&(m[0]===6||m[0]===2)){u=0;continue}if(m[0]===3&&(!p||m[1]>p[0]&&m[1]<p[3])){u.label=m[1];break}if(m[0]===6&&u.label<p[1]){u.label=p[1],p=m;break}if(p&&u.label<p[2]){u.label=p[2],u.ops.push(m);break}p[2]&&u.ops.pop(),u.trys.pop();continue}m=c.call(s,u)}catch(C){m=[6,C],d=0}finally{l=p=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var n=Sl(),a=kl();function i(s,c){return c===void 0&&(c={}),t(this,void 0,void 0,function(){var u,l;return r(this,function(d){switch(d.label){case 0:return u=n.getSanitizedOptions(c),l=new o(s,u),[4,l.execute()];case 1:return[2,d.sent()]}})})}e.backOff=i;var o=function(){function s(c,u){this.request=c,this.options=u,this.attemptNumber=0}return s.prototype.execute=function(){return t(this,void 0,void 0,function(){var c,u;return r(this,function(l){switch(l.label){case 0:if(this.attemptLimitReached)return[3,7];l.label=1;case 1:return l.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return l.sent(),[4,this.request()];case 3:return[2,l.sent()];case 4:return c=l.sent(),this.attemptNumber++,[4,this.options.retry(c,this.attemptNumber)];case 5:if(u=l.sent(),!u||this.attemptLimitReached)throw c;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}})})},Object.defineProperty(s.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),s.prototype.applyDelay=function(){return t(this,void 0,void 0,function(){var c;return r(this,function(u){switch(u.label){case 0:return c=a.DelayFactory(this.options,this.attemptNumber),[4,c.apply()];case 1:return u.sent(),[2]}})})},s}()}),Ol=se((e,t)=>{function r(i){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");if(i=`${i}`,i=i.replace(/[ \t\n\f\r]/g,""),i.length%4===0&&(i=i.replace(/==?$/,"")),i.length%4===1||/[^+/0-9A-Za-z]/.test(i))return null;let o="",s=0,c=0;for(let u=0;u<i.length;u++)s<<=6,s|=a(i[u]),c+=6,c===24&&(o+=String.fromCharCode((s&16711680)>>16),o+=String.fromCharCode((s&65280)>>8),o+=String.fromCharCode(s&255),s=c=0);return c===12?(s>>=4,o+=String.fromCharCode(s)):c===18&&(s>>=2,o+=String.fromCharCode((s&65280)>>8),o+=String.fromCharCode(s&255)),o}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function a(i){let o=n.indexOf(i);return o<0?void 0:o}t.exports=r}),Al=se((e,t)=>{function r(i){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");let o;for(i=`${i}`,o=0;o<i.length;o++)if(i.charCodeAt(o)>255)return null;let s="";for(o=0;o<i.length;o+=3){let c=[void 0,void 0,void 0,void 0];c[0]=i.charCodeAt(o)>>2,c[1]=(i.charCodeAt(o)&3)<<4,i.length>o+1&&(c[1]|=i.charCodeAt(o+1)>>4,c[2]=(i.charCodeAt(o+1)&15)<<2),i.length>o+2&&(c[2]|=i.charCodeAt(o+2)>>6,c[3]=i.charCodeAt(o+2)&63);for(let u=0;u<c.length;u++)typeof c[u]>"u"?s+="=":s+=a(c[u])}return s}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function a(i){if(i>=0&&i<64)return n[i]}t.exports=r}),El=se((e,t)=>{var r=Ol(),n=Al();t.exports={atob:r,btoa:n}}),ga=se((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs=n()})(e,function(){var r=1e3,n=6e4,a=36e5,i="millisecond",o="second",s="minute",c="hour",u="day",l="week",d="month",p="quarter",g="year",b="date",f="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,C=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,k={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(P){var A=["th","st","nd","rd"],x=P%100;return"["+P+(A[(x-20)%10]||A[x]||A[0])+"]"}},T=function(P,A,x){var h=String(P);return!h||h.length>=A?P:""+Array(A+1-h.length).join(x)+P},H={s:T,z:function(P){var A=-P.utcOffset(),x=Math.abs(A),h=Math.floor(x/60),v=x%60;return(A<=0?"+":"-")+T(h,2,"0")+":"+T(v,2,"0")},m:function P(A,x){if(A.date()<x.date())return-P(x,A);var h=12*(x.year()-A.year())+(x.month()-A.month()),v=A.clone().add(h,d),I=x-v<0,O=A.clone().add(h+(I?-1:1),d);return+(-(h+(x-v)/(I?v-O:O-v))||0)},a:function(P){return P<0?Math.ceil(P)||0:Math.floor(P)},p:function(P){return{M:d,y:g,w:l,d:u,D:b,h:c,m:s,s:o,ms:i,Q:p}[P]||String(P||"").toLowerCase().replace(/s$/,"")},u:function(P){return P===void 0}},$="en",X={};X[$]=k;var _="$isDayjsObject",ee=function(P){return P instanceof le||!(!P||!P[_])},ne=function P(A,x,h){var v;if(!A)return $;if(typeof A=="string"){var I=A.toLowerCase();X[I]&&(v=I),x&&(X[I]=x,v=I);var O=A.split("-");if(!v&&O.length>1)return P(O[0])}else{var R=A.name;X[R]=A,v=R}return!h&&v&&($=v),v||!h&&$},Q=function(P,A){if(ee(P))return P.clone();var x=typeof A=="object"?A:{};return x.date=P,x.args=arguments,new le(x)},U=H;U.l=ne,U.i=ee,U.w=function(P,A){return Q(P,{locale:A.$L,utc:A.$u,x:A.$x,$offset:A.$offset})};var le=function(){function P(x){this.$L=ne(x.locale,null,!0),this.parse(x),this.$x=this.$x||x.x||{},this[_]=!0}var A=P.prototype;return A.parse=function(x){this.$d=function(h){var v=h.date,I=h.utc;if(v===null)return new Date(NaN);if(U.u(v))return new Date;if(v instanceof Date)return new Date(v);if(typeof v=="string"&&!/Z$/i.test(v)){var O=v.match(m);if(O){var R=O[2]-1||0,L=(O[7]||"0").substring(0,3);return I?new Date(Date.UTC(O[1],R,O[3]||1,O[4]||0,O[5]||0,O[6]||0,L)):new Date(O[1],R,O[3]||1,O[4]||0,O[5]||0,O[6]||0,L)}}return new Date(v)}(x),this.init()},A.init=function(){var x=this.$d;this.$y=x.getFullYear(),this.$M=x.getMonth(),this.$D=x.getDate(),this.$W=x.getDay(),this.$H=x.getHours(),this.$m=x.getMinutes(),this.$s=x.getSeconds(),this.$ms=x.getMilliseconds()},A.$utils=function(){return U},A.isValid=function(){return this.$d.toString()!==f},A.isSame=function(x,h){var v=Q(x);return this.startOf(h)<=v&&v<=this.endOf(h)},A.isAfter=function(x,h){return Q(x)<this.startOf(h)},A.isBefore=function(x,h){return this.endOf(h)<Q(x)},A.$g=function(x,h,v){return U.u(x)?this[h]:this.set(v,x)},A.unix=function(){return Math.floor(this.valueOf()/1e3)},A.valueOf=function(){return this.$d.getTime()},A.startOf=function(x,h){var v=this,I=!!U.u(h)||h,O=U.p(x),R=function(Ie,ue){var ve=U.w(v.$u?Date.UTC(v.$y,ue,Ie):new Date(v.$y,ue,Ie),v);return I?ve:ve.endOf(u)},L=function(Ie,ue){return U.w(v.toDate()[Ie].apply(v.toDate("s"),(I?[0,0,0,0]:[23,59,59,999]).slice(ue)),v)},W=this.$W,Y=this.$M,K=this.$D,D="set"+(this.$u?"UTC":"");switch(O){case g:return I?R(1,0):R(31,11);case d:return I?R(1,Y):R(0,Y+1);case l:var ae=this.$locale().weekStart||0,ge=(W<ae?W+7:W)-ae;return R(I?K-ge:K+(6-ge),Y);case u:case b:return L(D+"Hours",0);case c:return L(D+"Minutes",1);case s:return L(D+"Seconds",2);case o:return L(D+"Milliseconds",3);default:return this.clone()}},A.endOf=function(x){return this.startOf(x,!1)},A.$set=function(x,h){var v,I=U.p(x),O="set"+(this.$u?"UTC":""),R=(v={},v[u]=O+"Date",v[b]=O+"Date",v[d]=O+"Month",v[g]=O+"FullYear",v[c]=O+"Hours",v[s]=O+"Minutes",v[o]=O+"Seconds",v[i]=O+"Milliseconds",v)[I],L=I===u?this.$D+(h-this.$W):h;if(I===d||I===g){var W=this.clone().set(b,1);W.$d[R](L),W.init(),this.$d=W.set(b,Math.min(this.$D,W.daysInMonth())).$d}else R&&this.$d[R](L);return this.init(),this},A.set=function(x,h){return this.clone().$set(x,h)},A.get=function(x){return this[U.p(x)]()},A.add=function(x,h){var v,I=this;x=Number(x);var O=U.p(h),R=function(Y){var K=Q(I);return U.w(K.date(K.date()+Math.round(Y*x)),I)};if(O===d)return this.set(d,this.$M+x);if(O===g)return this.set(g,this.$y+x);if(O===u)return R(1);if(O===l)return R(7);var L=(v={},v[s]=n,v[c]=a,v[o]=r,v)[O]||1,W=this.$d.getTime()+x*L;return U.w(W,this)},A.subtract=function(x,h){return this.add(-1*x,h)},A.format=function(x){var h=this,v=this.$locale();if(!this.isValid())return v.invalidDate||f;var I=x||"YYYY-MM-DDTHH:mm:ssZ",O=U.z(this),R=this.$H,L=this.$m,W=this.$M,Y=v.weekdays,K=v.months,D=v.meridiem,ae=function(ue,ve,ie,Se){return ue&&(ue[ve]||ue(h,I))||ie[ve].slice(0,Se)},ge=function(ue){return U.s(R%12||12,ue,"0")},Ie=D||function(ue,ve,ie){var Se=ue<12?"AM":"PM";return ie?Se.toLowerCase():Se};return I.replace(C,function(ue,ve){return ve||function(ie){switch(ie){case"YY":return String(h.$y).slice(-2);case"YYYY":return U.s(h.$y,4,"0");case"M":return W+1;case"MM":return U.s(W+1,2,"0");case"MMM":return ae(v.monthsShort,W,K,3);case"MMMM":return ae(K,W);case"D":return h.$D;case"DD":return U.s(h.$D,2,"0");case"d":return String(h.$W);case"dd":return ae(v.weekdaysMin,h.$W,Y,2);case"ddd":return ae(v.weekdaysShort,h.$W,Y,3);case"dddd":return Y[h.$W];case"H":return String(R);case"HH":return U.s(R,2,"0");case"h":return ge(1);case"hh":return ge(2);case"a":return Ie(R,L,!0);case"A":return Ie(R,L,!1);case"m":return String(L);case"mm":return U.s(L,2,"0");case"s":return String(h.$s);case"ss":return U.s(h.$s,2,"0");case"SSS":return U.s(h.$ms,3,"0");case"Z":return O}return null}(ue)||O.replace(":","")})},A.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},A.diff=function(x,h,v){var I,O=this,R=U.p(h),L=Q(x),W=(L.utcOffset()-this.utcOffset())*n,Y=this-L,K=function(){return U.m(O,L)};switch(R){case g:I=K()/12;break;case d:I=K();break;case p:I=K()/3;break;case l:I=(Y-W)/6048e5;break;case u:I=(Y-W)/864e5;break;case c:I=Y/a;break;case s:I=Y/n;break;case o:I=Y/r;break;default:I=Y}return v?I:U.a(I)},A.daysInMonth=function(){return this.endOf(d).$D},A.$locale=function(){return X[this.$L]},A.locale=function(x,h){if(!x)return this.$L;var v=this.clone(),I=ne(x,h,!0);return I&&(v.$L=I),v},A.clone=function(){return U.w(this.$d,this)},A.toDate=function(){return new Date(this.valueOf())},A.toJSON=function(){return this.isValid()?this.toISOString():null},A.toISOString=function(){return this.$d.toISOString()},A.toString=function(){return this.$d.toUTCString()},P}(),be=le.prototype;return Q.prototype=be,[["$ms",i],["$s",o],["$m",s],["$H",c],["$W",u],["$M",d],["$y",g],["$D",b]].forEach(function(P){be[P[1]]=function(A){return this.$g(A,P[0],P[1])}}),Q.extend=function(P,A){return P.$i||(P(A,le,Q),P.$i=!0),Q},Q.locale=ne,Q.isDayjs=ee,Q.unix=function(P){return Q(1e3*P)},Q.en=X[$],Q.Ls=X,Q.p={},Q})}),Rl=se((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_quarterOfYear=n()})(e,function(){var r="month",n="quarter";return function(a,i){var o=i.prototype;o.quarter=function(u){return this.$utils().u(u)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(u-1))};var s=o.add;o.add=function(u,l){return u=Number(u),this.$utils().p(l)===n?this.add(3*u,r):s.bind(this)(u,l)};var c=o.startOf;o.startOf=function(u,l){var d=this.$utils(),p=!!d.u(l)||l;if(d.p(u)===n){var g=this.quarter()-1;return p?this.month(3*g).startOf(r).startOf("day"):this.month(3*g+2).endOf(r).endOf("day")}return c.bind(this)(u,l)}}})}),Dl=se((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_customParseFormat=n()})(e,function(){var r={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},n=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,a=/\d\d/,i=/\d\d?/,o=/\d*[^-_:/,()\s\d]+/,s={},c=function(f){return(f=+f)+(f>68?1900:2e3)},u=function(f){return function(m){this[f]=+m}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(f){(this.zone||(this.zone={})).offset=function(m){if(!m||m==="Z")return 0;var C=m.match(/([+-]|\d\d)/g),k=60*C[1]+(+C[2]||0);return k===0?0:C[0]==="+"?-k:k}(f)}],d=function(f){var m=s[f];return m&&(m.indexOf?m:m.s.concat(m.f))},p=function(f,m){var C,k=s.meridiem;if(k){for(var T=1;T<=24;T+=1)if(f.indexOf(k(T,0,m))>-1){C=T>12;break}}else C=f===(m?"pm":"PM");return C},g={A:[o,function(f){this.afternoon=p(f,!1)}],a:[o,function(f){this.afternoon=p(f,!0)}],S:[/\d/,function(f){this.milliseconds=100*+f}],SS:[a,function(f){this.milliseconds=10*+f}],SSS:[/\d{3}/,function(f){this.milliseconds=+f}],s:[i,u("seconds")],ss:[i,u("seconds")],m:[i,u("minutes")],mm:[i,u("minutes")],H:[i,u("hours")],h:[i,u("hours")],HH:[i,u("hours")],hh:[i,u("hours")],D:[i,u("day")],DD:[a,u("day")],Do:[o,function(f){var m=s.ordinal,C=f.match(/\d+/);if(this.day=C[0],m)for(var k=1;k<=31;k+=1)m(k).replace(/\[|\]/g,"")===f&&(this.day=k)}],M:[i,u("month")],MM:[a,u("month")],MMM:[o,function(f){var m=d("months"),C=(d("monthsShort")||m.map(function(k){return k.slice(0,3)})).indexOf(f)+1;if(C<1)throw new Error;this.month=C%12||C}],MMMM:[o,function(f){var m=d("months").indexOf(f)+1;if(m<1)throw new Error;this.month=m%12||m}],Y:[/[+-]?\d+/,u("year")],YY:[a,function(f){this.year=c(f)}],YYYY:[/\d{4}/,u("year")],Z:l,ZZ:l};function b(f){var m,C;m=f,C=s&&s.formats;for(var k=(f=m.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(ne,Q,U){var le=U&&U.toUpperCase();return Q||C[U]||r[U]||C[le].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(be,P,A){return P||A.slice(1)})})).match(n),T=k.length,H=0;H<T;H+=1){var $=k[H],X=g[$],_=X&&X[0],ee=X&&X[1];k[H]=ee?{regex:_,parser:ee}:$.replace(/^\[|\]$/g,"")}return function(ne){for(var Q={},U=0,le=0;U<T;U+=1){var be=k[U];if(typeof be=="string")le+=be.length;else{var P=be.regex,A=be.parser,x=ne.slice(le),h=P.exec(x)[0];A.call(Q,h),ne=ne.replace(h,"")}}return function(v){var I=v.afternoon;if(I!==void 0){var O=v.hours;I?O<12&&(v.hours+=12):O===12&&(v.hours=0),delete v.afternoon}}(Q),Q}}return function(f,m,C){C.p.customParseFormat=!0,f&&f.parseTwoDigitYear&&(c=f.parseTwoDigitYear);var k=m.prototype,T=k.parse;k.parse=function(H){var $=H.date,X=H.utc,_=H.args;this.$u=X;var ee=_[1];if(typeof ee=="string"){var ne=_[2]===!0,Q=_[3]===!0,U=ne||Q,le=_[2];Q&&(le=_[2]),s=this.$locale(),!ne&&le&&(s=C.Ls[le]),this.$d=function(x,h,v){try{if(["x","X"].indexOf(h)>-1)return new Date((h==="X"?1e3:1)*x);var I=b(h)(x),O=I.year,R=I.month,L=I.day,W=I.hours,Y=I.minutes,K=I.seconds,D=I.milliseconds,ae=I.zone,ge=new Date,Ie=L||(O||R?1:ge.getDate()),ue=O||ge.getFullYear(),ve=0;O&&!R||(ve=R>0?R-1:ge.getMonth());var ie=W||0,Se=Y||0,mt=K||0,Qe=D||0;return ae?new Date(Date.UTC(ue,ve,Ie,ie,Se,mt,Qe+60*ae.offset*1e3)):v?new Date(Date.UTC(ue,ve,Ie,ie,Se,mt,Qe)):new Date(ue,ve,Ie,ie,Se,mt,Qe)}catch{return new Date("")}}($,ee,X),this.init(),le&&le!==!0&&(this.$L=this.locale(le).$L),U&&$!=this.format(ee)&&(this.$d=new Date("")),s={}}else if(ee instanceof Array)for(var be=ee.length,P=1;P<=be;P+=1){_[1]=ee[P-1];var A=C.apply(this,_);if(A.isValid()){this.$d=A.$d,this.$L=A.$L,this.init();break}P===be&&(this.$d=new Date(""))}else T.call(this,H)}}})}),Fl=se((e,t)=>{var r=/(^|; )Coveo-Pendragon=([^;]*)/;t.exports=()=>{var n;return((n=r.exec(document.cookie))==null?void 0:n.pop())||null}}),Pl=se((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_timezone=n()})(e,function(){var r={year:0,month:1,day:2,hour:3,minute:4,second:5},n={};return function(a,i,o){var s,c=function(p,g,b){b===void 0&&(b={});var f=new Date(p),m=function(C,k){k===void 0&&(k={});var T=k.timeZoneName||"short",H=C+"|"+T,$=n[H];return $||($=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:C,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:T}),n[H]=$),$}(g,b);return m.formatToParts(f)},u=function(p,g){for(var b=c(p,g),f=[],m=0;m<b.length;m+=1){var C=b[m],k=C.type,T=C.value,H=r[k];H>=0&&(f[H]=parseInt(T,10))}var $=f[3],X=$===24?0:$,_=f[0]+"-"+f[1]+"-"+f[2]+" "+X+":"+f[4]+":"+f[5]+":000",ee=+p;return(o.utc(_).valueOf()-(ee-=ee%1e3))/6e4},l=i.prototype;l.tz=function(p,g){p===void 0&&(p=s);var b=this.utcOffset(),f=this.toDate(),m=f.toLocaleString("en-US",{timeZone:p}),C=Math.round((f-new Date(m))/1e3/60),k=o(m,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(f.getTimezoneOffset()/15)-C,!0);if(g){var T=k.utcOffset();k=k.add(b-T,"minute")}return k.$x.$timezone=p,k},l.offsetName=function(p){var g=this.$x.$timezone||o.tz.guess(),b=c(this.valueOf(),g,{timeZoneName:p}).find(function(f){return f.type.toLowerCase()==="timezonename"});return b&&b.value};var d=l.startOf;l.startOf=function(p,g){if(!this.$x||!this.$x.$timezone)return d.call(this,p,g);var b=o(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return d.call(b,p,g).tz(this.$x.$timezone,!0)},o.tz=function(p,g,b){var f=b&&g,m=b||g||s,C=u(+o(),m);if(typeof p!="string")return o(p).tz(m);var k=function(X,_,ee){var ne=X-60*_*1e3,Q=u(ne,ee);if(_===Q)return[ne,_];var U=u(ne-=60*(Q-_)*1e3,ee);return Q===U?[ne,Q]:[X-60*Math.min(Q,U)*1e3,Math.max(Q,U)]}(o.utc(p,f).valueOf(),C,m),T=k[0],H=k[1],$=o(T).utcOffset(H);return $.$x.$timezone=m,$},o.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},o.tz.setDefault=function(p){s=p}}})}),Ml=se((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_utc=n()})(e,function(){var r="minute",n=/[+-]\d\d(?::?\d\d)?/g,a=/([+-]|\d\d)/g;return function(i,o,s){var c=o.prototype;s.utc=function(f){var m={date:f,utc:!0,args:arguments};return new o(m)},c.utc=function(f){var m=s(this.toDate(),{locale:this.$L,utc:!0});return f?m.add(this.utcOffset(),r):m},c.local=function(){return s(this.toDate(),{locale:this.$L,utc:!1})};var u=c.parse;c.parse=function(f){f.utc&&(this.$u=!0),this.$utils().u(f.$offset)||(this.$offset=f.$offset),u.call(this,f)};var l=c.init;c.init=function(){if(this.$u){var f=this.$d;this.$y=f.getUTCFullYear(),this.$M=f.getUTCMonth(),this.$D=f.getUTCDate(),this.$W=f.getUTCDay(),this.$H=f.getUTCHours(),this.$m=f.getUTCMinutes(),this.$s=f.getUTCSeconds(),this.$ms=f.getUTCMilliseconds()}else l.call(this)};var d=c.utcOffset;c.utcOffset=function(f,m){var C=this.$utils().u;if(C(f))return this.$u?0:C(this.$offset)?d.call(this):this.$offset;if(typeof f=="string"&&(f=function($){$===void 0&&($="");var X=$.match(n);if(!X)return null;var _=(""+X[0]).match(a)||["-",0,0],ee=_[0],ne=60*+_[1]+ +_[2];return ne===0?0:ee==="+"?ne:-ne}(f),f===null))return this;var k=Math.abs(f)<=16?60*f:f,T=this;if(m)return T.$offset=k,T.$u=f===0,T;if(f!==0){var H=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(T=this.local().add(k+H,r)).$offset=k,T.$x.$localOffset=H}else T=this.utc();return T};var p=c.format;c.format=function(f){var m=f||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return p.call(this,m)},c.valueOf=function(){var f=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*f},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var g=c.toDate;c.toDate=function(f){return f==="s"&&this.$offset?s(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():g.call(this)};var b=c.diff;c.diff=function(f,m,C){if(f&&this.$u===f.$u)return b.call(this,f,m,C);var k=this.local(),T=s(f).local();return b.call(k,T,m,C)}}})}),Ul=se((e,t)=>{function r(a){try{return JSON.stringify(a)}catch{return'"[Circular]"'}}t.exports=n;function n(a,i,o){var s=o&&o.stringify||r,c=1;if(typeof a=="object"&&a!==null){var u=i.length+c;if(u===1)return a;var l=new Array(u);l[0]=s(a);for(var d=1;d<u;d++)l[d]=s(i[d]);return l.join(" ")}if(typeof a!="string")return a;var p=i.length;if(p===0)return a;for(var g="",b=1-c,f=-1,m=a&&a.length||0,C=0;C<m;){if(a.charCodeAt(C)===37&&C+1<m){switch(f=f>-1?f:0,a.charCodeAt(C+1)){case 100:case 102:if(b>=p||i[b]==null)break;f<C&&(g+=a.slice(f,C)),g+=Number(i[b]),f=C+2,C++;break;case 105:if(b>=p||i[b]==null)break;f<C&&(g+=a.slice(f,C)),g+=Math.floor(Number(i[b])),f=C+2,C++;break;case 79:case 111:case 106:if(b>=p||i[b]===void 0)break;f<C&&(g+=a.slice(f,C));var k=typeof i[b];if(k==="string"){g+="'"+i[b]+"'",f=C+2,C++;break}if(k==="function"){g+=i[b].name||"<anonymous>",f=C+2,C++;break}g+=s(i[b]),f=C+2,C++;break;case 115:if(b>=p)break;f<C&&(g+=a.slice(f,C)),g+=String(i[b]),f=C+2,C++;break;case 37:f<C&&(g+=a.slice(f,C)),g+="%",f=C+2,C++,b--;break}++b}++C}return f===-1?a:(f<m&&(g+=a.slice(f)),g)}}),Tl=se((e,t)=>{var r=Ul();t.exports=p;var n=x().console||{},a={mapHttpRequest:ne,mapHttpResponse:ne,wrapRequestSerializer:Q,wrapResponseSerializer:Q,wrapErrorSerializer:Q,req:ne,res:ne,err:_,errWithCause:_};function i(h,v){return h==="silent"?1/0:v.levels.values[h]}var o=Symbol("pino.logFuncs"),s=Symbol("pino.hierarchy"),c={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function u(h,v){let I={logger:v,parent:h[s]};v[s]=I}function l(h,v,I){let O={};v.forEach(R=>{O[R]=I[R]?I[R]:n[R]||n[c[R]||"log"]||U}),h[o]=O}function d(h,v){return Array.isArray(h)?h.filter(function(I){return I!=="!stdSerializers.err"}):h===!0?Object.keys(v):!1}function p(h){h=h||{},h.browser=h.browser||{};let v=h.browser.transmit;if(v&&typeof v.send!="function")throw Error("pino: transmit option must have a send function");let I=h.browser.write||n;h.browser.write&&(h.browser.asObject=!0);let O=h.serializers||{},R=d(h.browser.serialize,O),L=h.browser.serialize;Array.isArray(h.browser.serialize)&&h.browser.serialize.indexOf("!stdSerializers.err")>-1&&(L=!1);let W=Object.keys(h.customLevels||{}),Y=["error","fatal","warn","info","debug","trace"].concat(W);typeof I=="function"&&Y.forEach(function(ie){I[ie]=I}),(h.enabled===!1||h.browser.disabled)&&(h.level="silent");let K=h.level||"info",D=Object.create(I);D.log||(D.log=U),l(D,Y,I),u({},D),Object.defineProperty(D,"levelVal",{get:ge}),Object.defineProperty(D,"level",{get:Ie,set:ue});let ae={transmit:v,serialize:R,asObject:h.browser.asObject,formatters:h.browser.formatters,levels:Y,timestamp:ee(h)};D.levels=g(h),D.level=K,D.setMaxListeners=D.getMaxListeners=D.emit=D.addListener=D.on=D.prependListener=D.once=D.prependOnceListener=D.removeListener=D.removeAllListeners=D.listeners=D.listenerCount=D.eventNames=D.write=D.flush=U,D.serializers=O,D._serialize=R,D._stdErrSerialize=L,D.child=ve,v&&(D._logEvent=X());function ge(){return i(this.level,this)}function Ie(){return this._level}function ue(ie){if(ie!=="silent"&&!this.levels.values[ie])throw Error("unknown level "+ie);this._level=ie,m(this,ae,D,"error"),m(this,ae,D,"fatal"),m(this,ae,D,"warn"),m(this,ae,D,"info"),m(this,ae,D,"debug"),m(this,ae,D,"trace"),W.forEach(Se=>{m(this,ae,D,Se)})}function ve(ie,Se){if(!ie)throw new Error("missing bindings for child Pino");Se=Se||{},R&&ie.serializers&&(Se.serializers=ie.serializers);let mt=Se.serializers;if(R&&mt){var Qe=Object.assign({},O,mt),mi=h.browser.serialize===!0?Object.keys(Qe):R;delete ie.serializers,H([ie],mi,Qe,this._stdErrSerialize)}function yi(vi){this._childLevel=(vi._childLevel|0)+1,this.bindings=ie,Qe&&(this.serializers=Qe,this._serialize=mi),v&&(this._logEvent=X([].concat(vi._logEvent.bindings,ie)))}yi.prototype=this;let fn=new yi(this);return u(this,fn),fn.level=this.level,fn}return D}function g(h){let v=h.customLevels||{},I=Object.assign({},p.levels.values,v),O=Object.assign({},p.levels.labels,b(v));return{values:I,labels:O}}function b(h){let v={};return Object.keys(h).forEach(function(I){v[h[I]]=I}),v}p.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},p.stdSerializers=a,p.stdTimeFunctions=Object.assign({},{nullTime:le,epochTime:be,unixTime:P,isoTime:A});function f(h){let v=[];h.bindings&&v.push(h.bindings);let I=h[s];for(;I.parent;)I=I.parent,I.logger.bindings&&v.push(I.logger.bindings);return v.reverse()}function m(h,v,I,O){if(Object.defineProperty(h,O,{value:i(h.level,I)>i(O,I)?U:I[o][O],writable:!0,enumerable:!0,configurable:!0}),!v.transmit&&h[O]===U)return;h[O]=k(h,v,I,O);let R=f(h);R.length!==0&&(h[O]=C(R,h[O]))}function C(h,v){return function(){return v.apply(this,[...h,...arguments])}}function k(h,v,I,O){return function(R){return function(){let L=v.timestamp(),W=new Array(arguments.length),Y=Object.getPrototypeOf&&Object.getPrototypeOf(this)===n?n:this;for(var K=0;K<W.length;K++)W[K]=arguments[K];if(v.serialize&&!v.asObject&&H(W,this._serialize,this.serializers,this._stdErrSerialize),v.asObject||v.formatters?R.call(Y,T(this,O,W,L,v.formatters)):R.apply(Y,W),v.transmit){let D=v.transmit.level||h._level,ae=I.levels.values[D],ge=I.levels.values[O];if(ge<ae)return;$(this,{ts:L,methodLevel:O,methodValue:ge,transmitLevel:D,transmitValue:I.levels.values[v.transmit.level||h._level],send:v.transmit.send,val:i(h._level,I)},W)}}}(h[o][O])}function T(h,v,I,O,R={}){let{level:L=()=>h.levels.values[v],log:W=ge=>ge}=R;h._serialize&&H(I,h._serialize,h.serializers,h._stdErrSerialize);let Y=I.slice(),K=Y[0],D={};O&&(D.time=O),D.level=L(v,h.levels.values[v]);let ae=(h._childLevel|0)+1;if(ae<1&&(ae=1),K!==null&&typeof K=="object"){for(;ae--&&typeof Y[0]=="object";)Object.assign(D,Y.shift());K=Y.length?r(Y.shift(),Y):void 0}else typeof K=="string"&&(K=r(Y.shift(),Y));return K!==void 0&&(D.msg=K),W(D)}function H(h,v,I,O){for(let R in h)if(O&&h[R]instanceof Error)h[R]=p.stdSerializers.err(h[R]);else if(typeof h[R]=="object"&&!Array.isArray(h[R]))for(let L in h[R])v&&v.indexOf(L)>-1&&L in I&&(h[R][L]=I[L](h[R][L]))}function $(h,v,I){let O=v.send,R=v.ts,L=v.methodLevel,W=v.methodValue,Y=v.val,K=h._logEvent.bindings;H(I,h._serialize||Object.keys(h.serializers),h.serializers,h._stdErrSerialize===void 0?!0:h._stdErrSerialize),h._logEvent.ts=R,h._logEvent.messages=I.filter(function(D){return K.indexOf(D)===-1}),h._logEvent.level.label=L,h._logEvent.level.value=W,O(L,h._logEvent,Y),h._logEvent=X(K)}function X(h){return{ts:0,messages:[],bindings:h||[],level:{label:"",value:0}}}function _(h){let v={type:h.constructor.name,msg:h.message,stack:h.stack};for(let I in h)v[I]===void 0&&(v[I]=h[I]);return v}function ee(h){return typeof h.timestamp=="function"?h.timestamp:h.timestamp===!1?le:be}function ne(){return{}}function Q(h){return h}function U(){}function le(){return!1}function be(){return Date.now()}function P(){return Math.round(Date.now()/1e3)}function A(){return new Date(Date.now()).toISOString()}function x(){function h(v){return typeof v<"u"&&v}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return h(self)||h(window)||h(this)||{}}}t.exports.default=p,t.exports.pino=p}),Mt=()=>global.crypto,jl=()=>{typeof window<"u"||(Mt()||(global.crypto=ml("crypto")),!Mt().getRandomValues&&Mt().webcrypto&&(global.crypto.getRandomValues=Mt().webcrypto.getRandomValues.bind(Mt().webcrypto)))},$l=Ae(vl()),Ll=Ae(xl()),To=class extends Error{constructor(){super(),this.name="ExpiredToken",this.message="The token being used to perform the request is expired."}},$n=class extends Error{constructor(e,t){super(),this.name="Disconnected",this.message=`Client could not connect to the following URL: ${e}`,this.statusCode=t??0}};Ae(El());var ma=(e,t=5)=>e+Math.random().toString(36).substring(2,2+t),Vl=new Set(["1",1,"yes",!0]);function jo(){if(typeof navigator>"u"||typeof window>"u")return!1;let e=navigator,t=window;return[e.globalPrivacyControl,e.doNotTrack,e.msDoNotTrack,t.doNotTrack].some(r=>Vl.has(r))}function _l(e){let t={};for(let[r,n]of e)t[r]=n;return t}function ya(e){if(typeof e!="object"||!e)return e;try{return JSON.parse(JSON.stringify(e))}catch{return e}}function Ql(e){let t=[];for(let r in e){let n=encodeURIComponent(r),a=encodeURIComponent(e[r]);t.push(`${n}=${a}`)}return t.join("&")}function zl(e){return typeof e!="object"||!e?!1:Object.values(e).every(Nl)}function Nl(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function Si(e){return e===429}var Bl=class $o{static async call(t){let r=Wl(t),{logger:n}=t,a=await $o.preprocessRequest(r,t);n.info(a,"Platform request");let{url:i,...o}=a,s=async()=>{let c=await(0,$l.default)(i,o);if(Si(c.status))throw c;return c};try{let c=await(0,Ll.backOff)(s,{retry:u=>{let l=u&&Si(u.status);return l&&n.info("Platform retrying request"),l}});if(c.status===419)throw n.info("Platform renewing token"),new To;if(c.status===404)throw new $n(i,c.status);return n.info({response:c,requestInfo:a},"Platform response"),c}catch(c){return c.message==="Failed to fetch"?new $n(i):c}}static async preprocessRequest(t,r){let{origin:n,preprocessRequest:a,logger:i,requestMetadata:o}=r,{signal:s,...c}=t,u=ya(c);try{let l=await a(t,n,o);return{...t,...l}}catch(l){i.error(l,"Platform request preprocessing failed. Returning default request options.")}return u}};function Lo(e,t){return`https://${e}.cloud.coveo.com`}function Yl(e,t="prod"){let r=t==="prod"?"":t,n=`https://${e}.org${r}.coveo.com`,a=`https://${e}.analytics.org${r}.coveo.com`,i=`${n}/rest/search/v2`,o=`https://${e}.admin.org${r}.coveo.com`;return{platform:n,analytics:a,search:i,admin:o}}function wi(e){return Lo("platform")}function Hl(e){return Lo("analytics")}function Wl(e){let{url:t,method:r,requestParams:n,contentType:a,accessToken:i,signal:o}=e,s=e.method==="POST"||e.method==="PUT",c=Gl(n,a);return{url:t,method:r,headers:{"Content-Type":a,Authorization:`Bearer ${i}`,...e.headers},...s&&{body:c},signal:o}}function Gl(e,t){return t==="application/x-www-form-urlencoded"?zl(e)?Ql(e):"":JSON.stringify(e)}function Jl(e){return{statusCode:e.statusCode,type:e.name,message:e.message}}function Kl(e,t){if(e instanceof $n)return{error:Jl(e)};throw e}var Ut=(e,t)=>({...va(e,t),requestParams:Zl(e)}),Zl=e=>{let{trackingId:t,clientId:r,context:n,language:a,country:i,currency:o,page:s,perPage:c,facets:u,sort:l}=e;return{trackingId:t,clientId:r,context:n,language:a,country:i,currency:o,page:s,perPage:c,facets:u,sort:l}},va=(e,t)=>{let{url:r,organizationId:n,accessToken:a}=e,i=`${r}/rest/organizations/${n}/commerce/v2/${t}`;return{accessToken:a,method:"POST",contentType:"application/json",url:i,origin:"commerceApiFetch"}},Xl=(e,t)=>({...va(e,t),requestParams:ed(e)}),ed=e=>{let{slotId:t,trackingId:r,clientId:n,context:a,language:i,country:o,currency:s,page:c}=e;return{slotId:t,trackingId:r,clientId:n,context:a,language:i,country:o,currency:s,page:c}},td=e=>({...va(e,"search/querySuggest"),requestParams:rd(e)}),rd=e=>{let{trackingId:t,query:r,clientId:n,context:a,language:i,country:o,currency:s}=e;return{trackingId:t,query:r,clientId:n,context:a,language:i,country:o,currency:s}},Me=e=>e.error!==void 0,nd=class{constructor(e){this.options=e}async getProductListing(e){return this.query({...Ut(e,"listing"),...this.options})}async getRecommendations(e){return this.query({...Xl(e,"recommendations"),...this.options})}async search(e){let t=Ut(e,"search");return this.query({...t,requestParams:{...t.requestParams,query:e==null?void 0:e.query},...this.options})}async productSuggestions(e){let t=Ut(e,"search/productSuggest");return this.query({...t,requestParams:{...t.requestParams,query:e==null?void 0:e.query},...this.options})}async querySuggest(e){let t=td(e);return this.query({...t,requestParams:{...t.requestParams,query:e==null?void 0:e.query},...this.options})}async facetSearch(e){let t=Ut(e,"facet");return this.query({...t,requestParams:{...t.requestParams,facetId:e==null?void 0:e.facetId,facetQuery:e==null?void 0:e.facetQuery,query:e==null?void 0:e.query},...this.options})}async plan(e){let t=Ut(e,"search");return this.query({...t,requestParams:{...t.requestParams,query:e==null?void 0:e.query},...this.options})}async query(e){let t=await Bl.call(e);if(t instanceof Error)return Kl(t);let r=await t.json();return t.ok?{success:r}:{error:r}}},Vo=e=>e;function pe(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var ad=typeof Symbol=="function"&&Symbol.observable||"@@observable",bi=ad,pn=()=>Math.random().toString(36).substring(7).split("").join("."),id={INIT:`@@redux/INIT${pn()}`,REPLACE:`@@redux/REPLACE${pn()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${pn()}`},Er=id;function Sa(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function _o(e,t,r){if(typeof e!="function")throw new Error(pe(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(pe(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(pe(1));return r(_o)(e,t)}let n=e,a=t,i=new Map,o=i,s=0,c=!1;function u(){o===i&&(o=new Map,i.forEach((f,m)=>{o.set(m,f)}))}function l(){if(c)throw new Error(pe(3));return a}function d(f){if(typeof f!="function")throw new Error(pe(4));if(c)throw new Error(pe(5));let m=!0;u();let C=s++;return o.set(C,f),function(){if(m){if(c)throw new Error(pe(6));m=!1,u(),o.delete(C),i=null}}}function p(f){if(!Sa(f))throw new Error(pe(7));if(typeof f.type>"u")throw new Error(pe(8));if(typeof f.type!="string")throw new Error(pe(17));if(c)throw new Error(pe(9));try{c=!0,a=n(a,f)}finally{c=!1}return(i=o).forEach(m=>{m()}),f}function g(f){if(typeof f!="function")throw new Error(pe(10));n=f,p({type:Er.REPLACE})}function b(){let f=d;return{subscribe(m){if(typeof m!="object"||m===null)throw new Error(pe(11));function C(){let k=m;k.next&&k.next(l())}return C(),{unsubscribe:f(C)}},[bi](){return this}}}return p({type:Er.INIT}),{dispatch:p,subscribe:d,getState:l,replaceReducer:g,[bi]:b}}function od(e){Object.keys(e).forEach(t=>{let r=e[t];if(typeof r(void 0,{type:Er.INIT})>"u")throw new Error(pe(12));if(typeof r(void 0,{type:Er.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(pe(13))})}function Qo(e){let t=Object.keys(e),r={};for(let i=0;i<t.length;i++){let o=t[i];typeof e[o]=="function"&&(r[o]=e[o])}let n=Object.keys(r),a;try{od(r)}catch(i){a=i}return function(i={},o){if(a)throw a;let s=!1,c={};for(let u=0;u<n.length;u++){let l=n[u],d=r[l],p=i[l],g=d(p,o);if(typeof g>"u")throw new Error(pe(14));c[l]=g,s=s||g!==p}return s=s||n.length!==Object.keys(i).length,s?c:i}}function Rr(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function sd(...e){return t=>(r,n)=>{let a=t(r,n),i=()=>{throw new Error(pe(15))},o={getState:a.getState,dispatch:(c,...u)=>i(c,...u)},s=e.map(c=>c(o));return i=Rr(...s)(a.dispatch),{...a,dispatch:i}}}function cd(e){return Sa(e)&&"type"in e&&typeof e.type=="string"}var zo=Symbol.for("immer-nothing"),Ci=Symbol.for("immer-draftable"),qe=Symbol.for("immer-state");function Ee(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Ct=Object.getPrototypeOf;function Xe(e){return!!e&&!!e[qe]}function Le(e){var t;return e?No(e)||Array.isArray(e)||!!e[Ci]||!!((t=e.constructor)!=null&&t[Ci])||Yr(e)||Hr(e):!1}var ud=Object.prototype.constructor.toString();function No(e){if(!e||typeof e!="object")return!1;let t=Ct(e);if(t===null)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===ud}function zt(e,t){Br(e)===0?Object.entries(e).forEach(([r,n])=>{t(r,n,e)}):e.forEach((r,n)=>t(n,r,e))}function Br(e){let t=e[qe];return t?t.type_:Array.isArray(e)?1:Yr(e)?2:Hr(e)?3:0}function Ln(e,t){return Br(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Bo(e,t,r){let n=Br(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function ld(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Yr(e){return e instanceof Map}function Hr(e){return e instanceof Set}function it(e){return e.copy_||e.base_}function Vn(e,t){if(Yr(e))return new Map(e);if(Hr(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&No(e))return Ct(e)?{...e}:Object.assign(Object.create(null),e);let r=Object.getOwnPropertyDescriptors(e);delete r[qe];let n=Reflect.ownKeys(r);for(let a=0;a<n.length;a++){let i=n[a],o=r[i];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Ct(e),r)}function wa(e,t=!1){return Wr(e)||Xe(e)||!Le(e)||(Br(e)>1&&(e.set=e.add=e.clear=e.delete=dd),Object.freeze(e),t&&zt(e,(r,n)=>wa(n,!0))),e}function dd(){Ee(2)}function Wr(e){return Object.isFrozen(e)}var fd={};function ct(e){let t=fd[e];return t||Ee(0,e),t}var Nt;function Yo(){return Nt}function pd(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ii(e,t){t&&(ct("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function _n(e){Qn(e),e.drafts_.forEach(hd),e.drafts_=null}function Qn(e){e===Nt&&(Nt=e.parent_)}function qi(e){return Nt=pd(Nt,e)}function hd(e){let t=e[qe];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function ki(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[qe].modified_&&(_n(t),Ee(4)),Le(e)&&(e=Dr(t,e),t.parent_||Fr(t,e)),t.patches_&&ct("Patches").generateReplacementPatches_(r[qe].base_,e,t.patches_,t.inversePatches_)):e=Dr(t,r,[]),_n(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==zo?e:void 0}function Dr(e,t,r){if(Wr(t))return t;let n=t[qe];if(!n)return zt(t,(a,i)=>xi(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Fr(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let a=n.copy_,i=a,o=!1;n.type_===3&&(i=new Set(a),a.clear(),o=!0),zt(i,(s,c)=>xi(e,n,a,s,c,r,o)),Fr(e,a,!1),r&&e.patches_&&ct("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function xi(e,t,r,n,a,i,o){if(Xe(a)){let s=i&&t&&t.type_!==3&&!Ln(t.assigned_,n)?i.concat(n):void 0,c=Dr(e,a,s);if(Bo(r,n,c),Xe(c))e.canAutoFreeze_=!1;else return}else o&&r.add(a);if(Le(a)&&!Wr(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Dr(e,a),(!t||!t.scope_.parent_)&&Fr(e,a)}}function Fr(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&wa(t,r)}function gd(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Yo(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},a=n,i=ba;r&&(a=[n],i=Bt);let{revoke:o,proxy:s}=Proxy.revocable(a,i);return n.draft_=s,n.revoke_=o,s}var ba={get(e,t){if(t===qe)return e;let r=it(e);if(!Ln(r,t))return md(e,r,t);let n=r[t];return e.finalized_||!Le(n)?n:n===hn(e.base_,t)?(gn(e),e.copy_[t]=Nn(n,e)):n},has(e,t){return t in it(e)},ownKeys(e){return Reflect.ownKeys(it(e))},set(e,t,r){let n=Ho(it(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let a=hn(it(e),t),i=a==null?void 0:a[qe];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(ld(r,a)&&(r!==void 0||Ln(e.base_,t)))return!0;gn(e),zn(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return hn(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,gn(e),zn(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=it(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Ee(11)},getPrototypeOf(e){return Ct(e.base_)},setPrototypeOf(){Ee(12)}},Bt={};zt(ba,(e,t)=>{Bt[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Bt.deleteProperty=function(e,t){return Bt.set.call(this,e,t,void 0)};Bt.set=function(e,t,r){return ba.set.call(this,e[0],t,r,e[0])};function hn(e,t){let r=e[qe];return(r?it(r):e)[t]}function md(e,t,r){var a;let n=Ho(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function Ho(e,t){if(!(t in e))return;let r=Ct(e);for(;r;){let n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Ct(r)}}function zn(e){e.modified_||(e.modified_=!0,e.parent_&&zn(e.parent_))}function gn(e){e.copy_||(e.copy_=Vn(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var yd=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){let i=r;r=t;let o=this;return function(s=i,...c){return o.produce(s,u=>r.call(this,u,...c))}}typeof r!="function"&&Ee(6),n!==void 0&&typeof n!="function"&&Ee(7);let a;if(Le(t)){let i=qi(this),o=Nn(t,void 0),s=!0;try{a=r(o),s=!1}finally{s?_n(i):Qn(i)}return Ii(i,n),ki(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===zo&&(a=void 0),this.autoFreeze_&&wa(a,!0),n){let i=[],o=[];ct("Patches").generateReplacementPatches_(t,a,i,o),n(i,o)}return a}else Ee(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...o)=>this.produceWithPatches(i,s=>t(s,...o));let n,a;return[this.produce(t,r,(i,o)=>{n=i,a=o}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Le(e)||Ee(8),Xe(e)&&(e=Wo(e));let t=qi(this),r=Nn(e,void 0);return r[qe].isManual_=!0,Qn(t),r}finishDraft(e,t){let r=e&&e[qe];(!r||!r.isManual_)&&Ee(9);let{scope_:n}=r;return Ii(n,t),ki(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));let n=ct("Patches").applyPatches_;return Xe(e)?n(e,t):this.produce(e,a=>n(a,t))}};function Nn(e,t){let r=Yr(e)?ct("MapSet").proxyMap_(e,t):Hr(e)?ct("MapSet").proxySet_(e,t):gd(e,t);return(t?t.scope_:Yo()).drafts_.push(r),r}function Wo(e){return Xe(e)||Ee(10,e),Go(e)}function Go(e){if(!Le(e)||Wr(e))return e;let t=e[qe],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Vn(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Vn(e,!0);return zt(r,(n,a)=>{Bo(r,n,Go(a))}),t&&(t.finalized_=!1),r}var ke=new yd,Jo=ke.produce;ke.produceWithPatches.bind(ke);ke.setAutoFreeze.bind(ke);ke.setUseStrictShallowCopy.bind(ke);ke.applyPatches.bind(ke);ke.createDraft.bind(ke);ke.finishDraft.bind(ke);function vd(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Sd(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function wd(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){let r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var Oi=e=>Array.isArray(e)?e:[e];function bd(e){let t=Array.isArray(e[0])?e[0]:e;return wd(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Cd(e,t){let r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var Id=class{constructor(e){this.value=e}deref(){return this.value}},qd=typeof WeakRef<"u"?WeakRef:Id,kd=0,Ai=1;function lr(){return{s:kd,v:void 0,o:null,p:null}}function Ca(e,t={}){let r=lr(),{resultEqualityCheck:n}=t,a,i=0;function o(){var d;let s=r,{length:c}=arguments;for(let p=0,g=c;p<g;p++){let b=arguments[p];if(typeof b=="function"||typeof b=="object"&&b!==null){let f=s.o;f===null&&(s.o=f=new WeakMap);let m=f.get(b);m===void 0?(s=lr(),f.set(b,s)):s=m}else{let f=s.p;f===null&&(s.p=f=new Map);let m=f.get(b);m===void 0?(s=lr(),f.set(b,s)):s=m}}let u=s,l;if(s.s===Ai?l=s.v:(l=e.apply(null,arguments),i++),u.s=Ai,n){let p=((d=a==null?void 0:a.deref)==null?void 0:d.call(a))??a;p!=null&&n(p,l)&&(l=p,i!==0&&i--),a=typeof l=="object"&&l!==null||typeof l=="function"?new qd(l):l}return u.v=l,l}return o.clearCache=()=>{r=lr(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function Ko(e,...t){let r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,o=0,s,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),vd(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);let l={...r,...c},{memoize:d,memoizeOptions:p=[],argsMemoize:g=Ca,argsMemoizeOptions:b=[],devModeChecks:f={}}=l,m=Oi(p),C=Oi(b),k=bd(a),T=d(function(){return i++,u.apply(null,arguments)},...m),H=g(function(){o++;let $=Cd(k,arguments);return s=T.apply(null,$),s},...C);return Object.assign(H,{resultFunc:u,memoizedResultFunc:T,dependencies:k,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>s,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:d,argsMemoize:g})};return Object.assign(n,{withTypes:()=>n}),n}var N=Ko(Ca),xd=Object.assign((e,t=N)=>{Sd(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e),n=r.map(a=>e[a]);return t(n,(...a)=>a.reduce((i,o,s)=>(i[r[s]]=o,i),{}))},{withTypes:()=>xd});function Zo(e){return({dispatch:t,getState:r})=>n=>a=>typeof a=="function"?a(t,r,e):n(a)}var Od=Zo(),Ad=Zo,Ed=(...e)=>{let t=Ko(...e),r=Object.assign((...n)=>{let a=t(...n),i=(o,...s)=>a(Xe(o)?Wo(o):o,...s);return Object.assign(i,a),i},{withTypes:()=>r});return r};Ed(Ca);var Rd=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Rr:Rr.apply(null,arguments)},Dd=e=>e&&typeof e.match=="function";function w(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(et(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>cd(n)&&n.type===e,r}var Xo=class Lt extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Lt.prototype)}static get[Symbol.species](){return Lt}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Lt(...t[0].concat(this)):new Lt(...t.concat(this))}};function Ei(e){return Le(e)?Jo(e,()=>{}):e}function Fd(e){return typeof e=="boolean"}var Pd=()=>function(e){let{thunk:t=!0,immutableCheck:r=!0,serializableCheck:n=!0,actionCreatorCheck:a=!0}=e??{},i=new Xo;return t&&(Fd(t)?i.push(Od):i.push(Ad(t.extraArgument))),i},Md="RTK_autoBatch",es=e=>t=>{setTimeout(t,e)},Ud=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:es(10),Td=(e={type:"raf"})=>t=>(...r)=>{let n=t(...r),a=!0,i=!1,o=!1,s=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?Ud:e.type==="callback"?e.queueNotification:es(e.timeout),u=()=>{o=!1,i&&(i=!1,s.forEach(l=>l()))};return Object.assign({},n,{subscribe(l){let d=()=>a&&l(),p=n.subscribe(d);return s.add(l),()=>{p(),s.delete(l)}},dispatch(l){var d;try{return a=!((d=l==null?void 0:l.meta)!=null&&d[Md]),i=!a,i&&(o||(o=!0,c(u))),n.dispatch(l)}finally{a=!0}}})},jd=e=>function(t){let{autoBatch:r=!0}=t??{},n=new Xo(e);return r&&n.push(Td(typeof r=="object"?r:void 0)),n},Ri=!0;function $d(e){let t=Pd(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:o=void 0}=e||{},s;if(typeof r=="function")s=r;else if(Sa(r))s=Qo(r);else throw new Error(et(1));let c;typeof n=="function"?c=n(t):c=t();let u=Rr;a&&(u=Rd({trace:!Ri,...typeof a=="object"&&a}));let l=sd(...c),d=jd(l),p=typeof o=="function"?o(d):d(),g=u(...p);return _o(s,i,g)}function Ld(e){let t={},r=[],n,a={addCase(i,o){let s=typeof i=="string"?i:i.type;if(!s)throw new Error(et(28));if(s in t)throw new Error(et(29));return t[s]=o,a},addMatcher(i,o){return r.push({matcher:i,reducer:o}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function Vd(e){return typeof e=="function"}function Z(e,t){let[r,n,a]=Ld(t),i;if(Vd(e))i=()=>Ei(e());else{let s=Ei(e);i=()=>s}function o(s=i(),c){let u=[r[c.type],...n.filter(({matcher:l})=>l(c)).map(({reducer:l})=>l)];return u.filter(l=>!!l).length===0&&(u=[a]),u.reduce((l,d)=>{if(d)if(Xe(l)){let p=d(l,c);return p===void 0?l:p}else{if(Le(l))return Jo(l,p=>d(p,c));{let p=d(l,c);if(p===void 0){if(l===null)return l;throw new Error(et(9))}return p}}return l},s)}return o.getInitialState=i,o}var _d="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",ts=(e=21)=>{let t="",r=e;for(;r--;)t+=_d[Math.random()*64|0];return t},Qd=(e,t)=>Dd(e)?e.match(t):e(t);function zd(...e){return t=>e.some(r=>Qd(r,t))}var Nd=["name","message","stack","code"],mn=class{constructor(e,t){Mo(this,"_type"),this.payload=e,this.meta=t}},Di=class{constructor(e,t){Mo(this,"_type"),this.payload=e,this.meta=t}},Bd=e=>{if(typeof e=="object"&&e!==null){let t={};for(let r of Nd)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},V=(()=>{function e(t,r,n){let a=w(t+"/fulfilled",(c,u,l,d)=>({payload:c,meta:{...d||{},arg:l,requestId:u,requestStatus:"fulfilled"}})),i=w(t+"/pending",(c,u,l)=>({payload:void 0,meta:{...l||{},arg:u,requestId:c,requestStatus:"pending"}})),o=w(t+"/rejected",(c,u,l,d,p)=>({payload:d,error:(n&&n.serializeError||Bd)(c||"Rejected"),meta:{...p||{},arg:l,requestId:u,rejectedWithValue:!!d,requestStatus:"rejected",aborted:(c==null?void 0:c.name)==="AbortError",condition:(c==null?void 0:c.name)==="ConditionError"}}));function s(c){return(u,l,d)=>{let p=n!=null&&n.idGenerator?n.idGenerator(c):ts(),g=new AbortController,b,f;function m(k){f=k,g.abort()}let C=async function(){var T,H;let k;try{let $=(T=n==null?void 0:n.condition)==null?void 0:T.call(n,c,{getState:l,extra:d});if(Hd($)&&($=await $),$===!1||g.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};let X=new Promise((_,ee)=>{b=()=>{ee({name:"AbortError",message:f||"Aborted"})},g.signal.addEventListener("abort",b)});u(i(p,c,(H=n==null?void 0:n.getPendingMeta)==null?void 0:H.call(n,{requestId:p,arg:c},{getState:l,extra:d}))),k=await Promise.race([X,Promise.resolve(r(c,{dispatch:u,getState:l,extra:d,requestId:p,signal:g.signal,abort:m,rejectWithValue:(_,ee)=>new mn(_,ee),fulfillWithValue:(_,ee)=>new Di(_,ee)})).then(_=>{if(_ instanceof mn)throw _;return _ instanceof Di?a(_.payload,p,c,_.meta):a(_,p,c)})])}catch($){k=$ instanceof mn?o(null,p,c,$.payload,$.meta):o($,p,c)}finally{b&&g.signal.removeEventListener("abort",b)}return n&&!n.dispatchConditionRejection&&o.match(k)&&k.meta.condition||u(k),k}();return Object.assign(C,{abort:m,requestId:p,arg:c,unwrap(){return C.then(Yd)}})}}return Object.assign(s,{pending:i,rejected:o,fulfilled:a,settled:zd(o,a),typePrefix:t})}return e.withTypes=()=>e,e})();function Yd(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function Hd(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var Wd=(e,t)=>{if(typeof e!="function")throw new Error(et(32))},Ia="listenerMiddleware",Gd=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=w(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(et(21));return Wd(i),{predicate:a,type:t,effect:i}},Jd=Object.assign(e=>{let{type:t,predicate:r,effect:n}=Gd(e);return{id:ts(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(et(22))}}},{withTypes:()=>Jd}),Kd=Object.assign(w(`${Ia}/add`),{withTypes:()=>Kd});w(`${Ia}/removeAll`);var Zd=Object.assign(w(`${Ia}/remove`),{withTypes:()=>Zd});function et(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}function Xd(e,t){let r=`
  The following properties are invalid:

    ${e.join(`
	`)}
  
  ${t}
  `;return new Gr(r)}var Gr=class extends Error{constructor(e){super(e),this.name="SchemaValidationError"}},he=class{constructor(e){this.definition=e}validate(e={},t=""){let r={...this.default,...e},n=[];for(let a in this.definition){let i=this.definition[a].validate(r[a]);i&&n.push(`${a}: ${i}`)}if(n.length)throw Xd(n,t);return r}get default(){let e={};for(let t in this.definition){let r=this.definition[t].default;r!==void 0&&(e[t]=r)}return e}},de=class{constructor(e={}){this.baseConfig=e}validate(e){return this.baseConfig.required&&z(e)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return this.baseConfig.required===!0}};function tt(e){return e===void 0}function ef(e){return e===null}function z(e){return tt(e)||ef(e)}var j=class{constructor(e={}){this.config=e,this.value=new de(e)}validate(e){return this.value.validate(e)||(tf(e)?e<this.config.min?`minimum value of ${this.config.min} not respected.`:e>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}};function tf(e){return tt(e)||rs(e)}function rs(e){return typeof e=="number"&&!isNaN(e)}var J=class{constructor(e={}){this.value=new de(e)}validate(e){return this.value.validate(e)||(rf(e)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}};function rf(e){return tt(e)||ns(e)}function ns(e){return typeof e=="boolean"}var nf=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i,E=class{constructor(e={}){this.config={emptyAllowed:!0,url:!1,...e},this.value=new de(this.config)}validate(e){let{emptyAllowed:t,url:r,regex:n,constrainTo:a}=this.config;return this.value.validate(e)||(tt(e)?null:as(e)?!t&&!e.length?"value is an empty string.":r&&!nf.test(e)?"value is not a valid URL.":n&&!n.test(e)?`value did not match provided regex ${n}`:a&&!a.includes(e)?`value should be one of: ${a.join(", ")}.`:null:"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}};function as(e){return Object.prototype.toString.call(e)==="[object String]"}var M=class{constructor(e={}){this.config={options:{required:!1},values:{},...e}}validate(e){if(tt(e))return this.config.options.required?"value is required and is currently undefined":null;if(!is(e))return"value is not an object";for(let[r,n]of Object.entries(this.config.values))if(n.required&&z(e[r]))return`value does not contain ${r}`;let t="";for(let[r,n]of Object.entries(this.config.values)){let a=e[r],i=n.validate(a);i!==null&&(t+=" "+i)}return t===""?null:t}get default(){}get required(){return!!this.config.options.required}};function is(e){return e!==void 0&&typeof e=="object"}var ce=class{constructor(e={}){this.config=e,this.value=new de(this.config)}validate(e){if(!z(e)&&!Array.isArray(e))return"value is not an array";let t=this.value.validate(e);if(t!==null)return t;if(z(e))return null;if(this.config.max!==void 0&&e.length>this.config.max)return`value contains more than ${this.config.max}`;if(this.config.min!==void 0&&e.length<this.config.min)return`value contains less than ${this.config.min}`;if(this.config.each!==void 0){let r="";return e.forEach(n=>{this.config.each.required&&z(n)&&(r=`value is null or undefined: ${e.join(",")}`);let a=this.validatePrimitiveValue(n,this.config.each);a!==null&&(r+=" "+a)}),r===""?null:r}return null}validatePrimitiveValue(e,t){return ns(e)||as(e)||rs(e)||is(e)?t.validate(e):"value is not a primitive value"}get default(){}get required(){return this.value.required}};function os(e){return Array.isArray(e)}var ut=class{constructor(e){this.config=e,this.value=new de(e)}validate(e){let t=this.value.validate(e);return t!==null?t:tt(e)||Object.values(this.config.enum).find(r=>r===e)?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}},F=new E({required:!0,emptyAllowed:!1}),te=new E({required:!1,emptyAllowed:!1}),Pe=new E({required:!0,emptyAllowed:!0}),ss=new E({required:!1,emptyAllowed:!0}),af=new E({required:!1,emptyAllowed:!1,regex:/^\d+\.\d+\.\d+$/}),dt=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),ft=(e,t)=>{if("required"in t)return{payload:new he({value:t}).validate({value:e}).value};let r=new M({options:{required:!0},values:t}).validate(e);if(r)throw new Gr(r);return{payload:e}},q=(e,t)=>{try{return ft(e,t)}catch(r){return{payload:e,error:dt(r)}}},Gt=(e,t,r,n)=>{let a=`Check the initialState of ${n}`;return cs(e,t,r,a,"Controller initialization error")},Jt=(e,t,r,n)=>{let a=`Check the options of ${n}`;return cs(e,t,r,a,"Controller initialization error")},cs=(e,t,r,n,a)=>{try{return t.validate(r,n)}catch(i){throw e.logger.error(i,a),i}};function qa(e){return e.currency}var of=(e,t)=>({currency:qa(t.commerceContext),products:sf(t.cart),transaction:e}),ka=N(e=>e.cart,e=>e.cartItems,(e,t)=>t.map(r=>e[r])),sf=N(ka,e=>e.map(({quantity:t,...r})=>({quantity:t,product:r}))),us={productId:F,quantity:new j({required:!0,min:0}),name:new E({required:!1}),price:new j({required:!1,min:0})},ls=new ce({each:new M({values:{...us}})}),cf={items:ls},uf=V("commerce/cart/purchase",async(e,{extra:t,getState:r})=>{let n=of(e,r()),{relay:a}=t;a.emit("ec.purchase",n)}),ds=w("commerce/cart/setItems",e=>q(e,ls)),lf=w("commerce/cart/updateItemQuantity",e=>q(e,us)),fs="coveo-headless-internal-state",G=Symbol.for(fs),df=e=>new Proxy(e,{ownKeys(t){return Reflect.ownKeys(t).filter(r=>r!==G)},get(t,r,n){return typeof r=="symbol"&&r.description===fs&&r!==G&&e.logger.warn(`You might be loading Headless twice. Please check your setup.
If you are trying to access the inner state... Don't`),Reflect.get(t,r,n)}});function we(e){let t,r=new Map,n=()=>r.size===0,a=i=>{try{let o=JSON.stringify(i),s=t!==o;return t=o,s}catch(o){return console.warn('Could not detect if state has changed, check the controller "get state method"',o),!0}};return{subscribe(i){i();let o=Symbol(),s;return n()&&(t=JSON.stringify(this.state),s=e.subscribe(()=>{a(this.state)&&r.forEach(c=>c())})),r.set(o,i),()=>{r.delete(o),n()&&s&&s()}},get state(){return{}}}}N(ka,e=>e.reduce((t,r)=>t+r.quantity,0));N(ka,e=>e.reduce((t,r)=>t+r.price*r.quantity,0));function Pr(e){return`${e.productId},${e.name},${e.price}`}var yn=()=>({cartItems:[],cart:{},purchasedItems:[],purchased:{}}),ps=e=>hs(e.cartItems,e.cart),ff=e=>hs(e.purchasedItems,e.purchased);function hs(e,t){let r=e.reduce((n,a)=>{let{productId:i,quantity:o}=t[a];return i in n||(n[i]={productId:i,quantity:0}),n[i].quantity+=o,n},{});return[...Object.values(r)]}var pf=Z(yn(),e=>{e.addCase(ds,(t,{payload:r})=>{let{cart:n,cartItems:a}=r.reduce((i,o)=>{let s=Pr(o);return{cartItems:[...i.cartItems,s],cart:{...i.cart,[s]:o},purchasedItems:[],purchased:{}}},yn());Fi(t,a,n)}).addCase(lf,(t,{payload:r})=>{let n=Pr(r);if(!(n in t.cart)){hf(r,t);return}if(r.quantity<=0){gf(r,t);return}t.cart[n]=r}).addCase(uf.fulfilled,t=>{mf(t);let{cart:r,cartItems:n}=yn();Fi(t,n,r)})});function Fi(e,t,r){e.cartItems=t,e.cart=r}function hf(e,t){if(e.quantity<=0)return;let r=Pr(e);t.cartItems=[...t.cartItems,r],t.cart[r]=e}function gf(e,t){let r=Pr(e);t.cartItems=t.cartItems.filter(n=>n!==r),delete t.cart[r]}function mf(e){for(let t of e.cartItems){if(t in e.purchased){e.purchased[t].quantity+=e.cart[t].quantity;continue}e.purchasedItems=[...e.purchasedItems,t],e.purchased[t]=e.cart[t]}}var yf=Intl.supportedValuesOf("currency"),vf=new E({required:!0,emptyAllowed:!1,constrainTo:yf}),gs={url:F,referrer:ss},ms={userId:te,email:te,userIp:te,userAgent:te};new M({options:{required:!0},values:{productId:te,sku:te,name:te,price:te,quantity:te}});var ys={language:F,country:F,currency:vf,user:new M({values:ms}),view:new M({options:{required:!0},values:gs})},Kt=w("commerce/setContext",e=>q(e,ys)),Jr=w("commerce/setUser",e=>z(e.userId)&&z(e.email)?{payload:e,error:dt(new Gr("Either userId or email is required"))}:q(e,ms)),Zt=w("commerce/setView",e=>q(e,gs)),Sf=()=>({language:"",country:"",currency:"",view:{url:""}}),xa=Z(Sf(),e=>{e.addCase(Kt,(t,{payload:r})=>r).addCase(Jr,(t,{payload:r})=>{t.user=r}).addCase(Zt,(t,{payload:r})=>{t.view=r})}),Ve=w("breadcrumb/deselectAll"),Kr=w("breadcrumb/deselectAllNonBreadcrumbs"),re=F,wf={state:new de({required:!0}),numberOfResults:new j({required:!0,min:0}),value:new E({required:!0,emptyAllowed:!0}),path:new ce({required:!0,each:F}),moreValuesAvailable:new J({required:!1})};function vs(e){e.children.forEach(t=>{vs(t)}),ft({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},wf)}var It={facetId:re,field:F,delimitingCharacter:new E({required:!1,emptyAllowed:!0}),filterFacetCount:new J({required:!1}),injectionDepth:new j({required:!1,min:0}),numberOfValues:new j({required:!1,min:1}),sortCriteria:new de({required:!1}),basePath:new ce({required:!1,each:F}),filterByBasePath:new J({required:!1})},Sr=5,bf=w("categoryFacet/register",e=>q(e,It)),Zr=w("categoryFacet/toggleSelectValue",e=>{try{return ft(e.facetId,F),vs(e.selection),{payload:e,error:null}}catch(t){return{payload:e,error:dt(t)}}}),Cf=w("categoryFacet/deselectAll",e=>q(e,It.facetId)),Bn=w("categoryFacet/updateNumberOfValues",e=>q(e,{facetId:It.facetId,numberOfValues:It.numberOfValues}));w("categoryFacet/updateSortCriterion",e=>q(e,{facetId:It.facetId,criterion:new de}));w("categoryFacet/updateBasePath",e=>q(e,{facetId:It.facetId,basePath:new ce({each:F})}));var Oa={facetId:re,captions:new M({options:{required:!1}}),numberOfValues:new j({required:!1,min:1}),query:new E({required:!1,emptyAllowed:!0})},If={path:new ce({required:!0,each:F}),displayValue:Pe,rawValue:Pe,count:new j({required:!0,min:0})},Aa=w("categoryFacet/selectSearchResult",e=>q(e,{facetId:re,value:new M({values:If})})),Ss=w("categoryFacetSearch/register",e=>q(e,Oa)),ws={facetId:re,value:new M({values:{displayValue:Pe,rawValue:Pe,count:new j({required:!0,min:0})}})},bs=w("facetSearch/register",e=>q(e,Oa)),_t=w("facetSearch/update",e=>q(e,Oa)),Yt=w("facetSearch/toggleSelectValue",e=>q(e,ws)),Ht=w("facetSearch/toggleExcludeValue",e=>q(e,ws)),Cs=new E({regex:/^[a-zA-Z0-9-_]+$/}),Is=new E({required:!0});new ce({each:new E});new E;var qs=new J,ks=new j({min:0}),Ea=new j({min:1}),xs=new J({required:!0}),qf=new M,kf=new E,xf={captions:qf,numberOfValues:Ea,query:kf};new M({values:xf});var Of=new M({options:{required:!1},values:{type:new E({constrainTo:["simple"],emptyAllowed:!1,required:!0}),values:new ce({required:!0,max:25,each:new E({emptyAllowed:!1,required:!0})})}}),Af=new ce({min:1,max:25,required:!1,each:new E({emptyAllowed:!1,required:!0})}),Ra={value:F,numberOfResults:new j({min:0}),state:F},Ef={facetId:re,field:new E({required:!0,emptyAllowed:!0}),filterFacetCount:new J({required:!1}),injectionDepth:new j({required:!1,min:0}),numberOfValues:new j({required:!1,min:1}),sortCriteria:new de({required:!1}),resultsMustMatch:new de({required:!1}),allowedValues:Of,customSort:Af},Os=w("facet/register",e=>q(e,Ef)),qt=w("facet/toggleSelectValue",e=>q(e,{facetId:re,selection:new M({values:Ra})})),kt=w("facet/toggleExcludeValue",e=>q(e,{facetId:re,selection:new M({values:Ra})})),Re=w("facet/deselectAll",e=>q(e,re)),Rf=w("facet/updateSortCriterion",e=>q(e,{facetId:re,criterion:new de({required:!0})})),Mr=w("facet/updateNumberOfValues",e=>q(e,{facetId:re,numberOfValues:new j({required:!0,min:1})})),Ur=w("facet/updateIsFieldExpanded",e=>q(e,{facetId:re,isFieldExpanded:new J({required:!0})})),Df=w("facet/updateFreezeCurrentValues",e=>q(e,{facetId:re,freezeCurrentValues:new J({required:!0})})),Xt=w("facetOptions/update",(e={freezeFacetOrder:!0})=>q(e,{freezeFacetOrder:new J({required:!1})})),Ff=w("facetOptions/facet/enable",e=>q(e,re)),Xr=w("facetOptions/facet/disable",e=>q(e,re)),Pf=w("history/undo"),Mf=w("history/redo"),He=w("history/snapshot");V("history/back",async(e,{dispatch:t})=>{t(Pf()),await t(Ue())});V("history/forward",async(e,{dispatch:t})=>{t(Mf()),await t(Ue())});var Ue=V("history/change",async(e,{getState:t})=>t().history.present);function Te(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function y(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function s(l){try{u(n.next(l))}catch(d){o(d)}}function c(l){try{u(n.throw(l))}catch(d){o(d)}}function u(l){l.done?i(l.value):a(l.value).then(s,c)}u((n=n.apply(e,[])).next())})}var B;(function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect"})(B||(B={}));function Pi(){return typeof window<"u"}function Da(){return typeof navigator<"u"}function Yn(){return typeof document<"u"}function Hn(){try{return typeof localStorage<"u"}catch{return!1}}function Uf(){try{return typeof sessionStorage<"u"}catch{return!1}}function As(){return Da()&&navigator.cookieEnabled}var Tf=[B.click,B.custom,B.search,B.view],jf=(e,t)=>Tf.indexOf(e)!==-1?Object.assign({language:Yn()?document.documentElement.lang:"unknown",userAgent:Da()?navigator.userAgent:"unknown"},t):t,vn=class Es{static set(t,r,n){var a,i,o,s;n&&(i=new Date,i.setTime(i.getTime()+n)),s=window.location.hostname,s.indexOf(".")===-1?Mi(t,r,i):(o=s.split("."),a=o[o.length-2]+"."+o[o.length-1],Mi(t,r,i,a))}static get(t){for(var r=t+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){var i=n[a];if(i=i.replace(/^\s+/,""),i.lastIndexOf(r,0)===0)return i.substring(r.length,i.length)}return null}static erase(t){Es.set(t,"",-1)}};function Mi(e,t,r,n){document.cookie=`${e}=${t}`+(r?`;expires=${r.toUTCString()}`:"")+(n?`;domain=${n}`:"")+";path=/;SameSite=Lax"}function $f(){return Hn()?localStorage:As()?new Fa:Uf()?sessionStorage:new en}var Fa=class wr{getItem(t){return vn.get(`${wr.prefix}${t}`)}removeItem(t){vn.erase(`${wr.prefix}${t}`)}setItem(t,r,n){vn.set(`${wr.prefix}${t}`,r,n)}};Fa.prefix="coveo_";var Lf=class{constructor(){this.cookieStorage=new Fa}getItem(e){return localStorage.getItem(e)||this.cookieStorage.getItem(e)}removeItem(e){this.cookieStorage.removeItem(e),localStorage.removeItem(e)}setItem(e,t){localStorage.setItem(e,t),this.cookieStorage.setItem(e,t,31556926e3)}},en=class{getItem(e){return null}removeItem(e){}setItem(e,t){}},Vt="__coveo.analytics.history",Rs=20,Ds=1e3*60,Fs=75,Tr=class{constructor(e){this.store=e||$f()}addElement(e){e.internalTime=new Date().getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=this.getHistoryWithInternalTime();t!=null?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}addElementAsync(e){return y(this,void 0,void 0,function*(){e.internalTime=new Date().getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=yield this.getHistoryWithInternalTimeAsync();t!=null?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])})}getHistory(){let e=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(e))}getHistoryAsync(){return y(this,void 0,void 0,function*(){let e=yield this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(e))})}getHistoryWithInternalTime(){try{let e=this.store.getItem(Vt);return e&&typeof e=="string"?JSON.parse(e):[]}catch{return[]}}getHistoryWithInternalTimeAsync(){return y(this,void 0,void 0,function*(){try{let e=yield this.store.getItem(Vt);return e?JSON.parse(e):[]}catch{return[]}})}setHistory(e){try{this.store.setItem(Vt,JSON.stringify(e.slice(0,Rs)))}catch{}}clear(){try{this.store.removeItem(Vt)}catch{}}getMostRecentElement(){let e=this.getHistoryWithInternalTime();return Array.isArray(e)?e.sort((t,r)=>(r.internalTime||0)-(t.internalTime||0))[0]:null}cropQueryElement(e){return e.name&&e.value&&e.name.toLowerCase()==="query"&&(e.value=e.value.slice(0,Fs)),e}isValidEntry(e){let t=this.getMostRecentElement();return t&&t.value==e.value?(e.internalTime||0)-(t.internalTime||0)>Ds:!0}stripInternalTime(e){return Array.isArray(e)?e.map(t=>{let{name:r,time:n,value:a}=t;return{name:r,time:n,value:a}}):[]}stripEmptyQuery(e){let{name:t,time:r,value:n}=e;return t&&typeof n=="string"&&t.toLowerCase()==="query"&&n.trim()===""?{name:t,time:r}:e}stripEmptyQueries(e){return e.map(t=>this.stripEmptyQuery(t))}},Vf=Object.freeze({__proto__:null,HistoryStore:Tr,MAX_NUMBER_OF_HISTORY_ELEMENTS:Rs,MAX_VALUE_SIZE:Fs,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:Ds,STORE_KEY:Vt,default:Tr}),_f=(e,t)=>y(void 0,void 0,void 0,function*(){return e===B.view?(yield Qf(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t}),Qf=e=>y(void 0,void 0,void 0,function*(){let t=new Tr,r={name:"PageView",value:e,time:new Date().toISOString()};yield t.addElementAsync(r)}),dr,zf=new Uint8Array(16);function Nf(){if(!dr&&(dr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!dr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return dr(zf)}var Bf=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function jr(e){return typeof e=="string"&&Bf.test(e)}var fe=[];for(let e=0;e<256;++e)fe.push((e+256).toString(16).slice(1));function Ps(e,t=0){return(fe[e[t+0]]+fe[e[t+1]]+fe[e[t+2]]+fe[e[t+3]]+"-"+fe[e[t+4]]+fe[e[t+5]]+"-"+fe[e[t+6]]+fe[e[t+7]]+"-"+fe[e[t+8]]+fe[e[t+9]]+"-"+fe[e[t+10]]+fe[e[t+11]]+fe[e[t+12]]+fe[e[t+13]]+fe[e[t+14]]+fe[e[t+15]]).toLowerCase()}function Yf(e){if(!jr(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}function Hf(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var Wf="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Gf="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Jf(e,t,r){function n(a,i,o,s){var c;if(typeof a=="string"&&(a=Hf(a)),typeof i=="string"&&(i=Yf(i)),((c=i)===null||c===void 0?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+a.length);if(u.set(i),u.set(a,i.length),u=r(u),u[6]=u[6]&15|t,u[8]=u[8]&63|128,o){s=s||0;for(let l=0;l<16;++l)o[s+l]=u[l];return o}return Ps(u)}try{n.name=e}catch{}return n.DNS=Wf,n.URL=Gf,n}var Kf=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ui={randomUUID:Kf};function Sn(e,t,r){if(Ui.randomUUID&&!t&&!e)return Ui.randomUUID();e=e||{};let n=e.random||(e.rng||Nf)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Ps(n)}function Zf(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function wn(e,t){return e<<t|e>>>32-t}function Xf(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){let o=unescape(encodeURIComponent(e));e=[];for(let s=0;s<o.length;++s)e.push(o.charCodeAt(s))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=e.length/4+2,a=Math.ceil(n/16),i=new Array(a);for(let o=0;o<a;++o){let s=new Uint32Array(16);for(let c=0;c<16;++c)s[c]=e[o*64+c*4]<<24|e[o*64+c*4+1]<<16|e[o*64+c*4+2]<<8|e[o*64+c*4+3];i[o]=s}i[a-1][14]=(e.length-1)*8/Math.pow(2,32),i[a-1][14]=Math.floor(i[a-1][14]),i[a-1][15]=(e.length-1)*8&4294967295;for(let o=0;o<a;++o){let s=new Uint32Array(80);for(let g=0;g<16;++g)s[g]=i[o][g];for(let g=16;g<80;++g)s[g]=wn(s[g-3]^s[g-8]^s[g-14]^s[g-16],1);let c=r[0],u=r[1],l=r[2],d=r[3],p=r[4];for(let g=0;g<80;++g){let b=Math.floor(g/20),f=wn(c,5)+Zf(b,u,l,d)+p+t[b]+s[g]>>>0;p=d,d=l,l=wn(u,30)>>>0,u=c,c=f}r[0]=r[0]+c>>>0,r[1]=r[1]+u>>>0,r[2]=r[2]+l>>>0,r[3]=r[3]+d>>>0,r[4]=r[4]+p>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var ep=Jf("v5",80,Xf),Ti=ep,Ms="2.30.2",tp={pageview:"pageview",event:"event"},$r=class Wn{constructor(t,r){if(!jr(t))throw Error("Not a valid uuid");this.clientId=t,this.creationDate=Math.floor(r/1e3)}toString(){return this.clientId.replace(/-/g,"")+"."+this.creationDate.toString()}get expired(){let t=Math.floor(Date.now()/1e3)-this.creationDate;return t<0||t>Wn.expirationTime}validate(t,r){return!this.expired&&this.matchReferrer(t,r)}matchReferrer(t,r){try{let n=new URL(t);return r.some(a=>new RegExp(a.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(n.host))}catch{return!1}}static fromString(t){let r=t.split(".");if(r.length!==2)return null;let[n,a]=r;if(n.length!==32||isNaN(parseInt(a)))return null;let i=n.substring(0,8)+"-"+n.substring(8,12)+"-"+n.substring(12,16)+"-"+n.substring(16,20)+"-"+n.substring(20,32);return jr(i)?new Wn(i,Number.parseInt(a)*1e3):null}};$r.cvo_cid="cvo_cid";$r.expirationTime=120;var Fe=Object.keys;function fr(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}var ji={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},rp=Fe(ji).map(e=>ji[e]),np=[...rp].join("|"),ap=new RegExp(`^(${np}$)`),ip={svcAction:"svc_action",svcActionData:"svc_action_data"},op=e=>ap.test(e),sp=[op],$i={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},Li={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr",group:"group"},ye={action:"pa",list:"pal",listSource:"pls"},Lr={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},cp=["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit"],Gn={id:"quoteId",affiliation:"quoteAffiliation"},Jn={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},up={add:ye,bookmark_add:ye,bookmark_remove:ye,click:ye,checkout:ye,checkout_option:ye,detail:ye,impression:ye,remove:ye,refund:Object.assign(Object.assign({},ye),Lr),purchase:Object.assign(Object.assign({},ye),Lr),quickview:ye,quote:Object.assign(Object.assign({},ye),Gn),review:Object.assign(Object.assign({},ye),Jn)},lp=Fe($i).map(e=>$i[e]),dp=Fe(Li).map(e=>Li[e]),fp=Fe(ye).map(e=>ye[e]),pp=Fe(Lr).map(e=>Lr[e]),hp=Fe(Jn).map(e=>Jn[e]),gp=Fe(Gn).map(e=>Gn[e]),mp=[...lp,"custom"].join("|"),yp=[...dp,"custom"].join("|"),Us="(pr[0-9]+)",Ts="(il[0-9]+pi[0-9]+)",vp=new RegExp(`^${Us}(${mp})$`),Sp=new RegExp(`^(${Ts}(${yp}))|(il[0-9]+nm)$`),wp=new RegExp(`^(${fp.join("|")})$`),bp=new RegExp(`^(${pp.join("|")})$`),Cp=new RegExp(`^${Us}custom$`),Ip=new RegExp(`^${Ts}custom$`),qp=new RegExp(`^(${[...cp,...hp,...gp].join("|")})$`),kp=e=>vp.test(e),xp=e=>Sp.test(e),Op=e=>wp.test(e),Ap=e=>bp.test(e),Ep=e=>qp.test(e),Rp=[xp,kp,Op,Ap,Ep],Dp=[Cp,Ip],Fp={anonymizeIp:"aip"},Pp={eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"},Mp={hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"},Up=["contentId","contentIdKey","contentType","searchHub","tab","searchUid","permanentId","contentLocale","trackingId"],Tp=Object.assign(Object.assign(Object.assign(Object.assign({},Fp),Pp),Mp),Up.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:t}),{})),Kn=Object.assign(Object.assign({},Tp),ip),jp=e=>{let t=!!e.action&&up[e.action]||{};return Fe(e).reduce((r,n)=>{let a=t[n]||Kn[n]||n;return Object.assign(Object.assign({},r),{[a]:e[n]})},{})},$p=Fe(Kn).map(e=>Kn[e]),Lp=e=>$p.indexOf(e)!==-1,Vp=e=>e==="custom",_p=e=>[...Rp,...sp,Lp,Vp].some(t=>t(e)),Qp=e=>Fe(e).reduce((t,r)=>{let n=zp(r);return n?Object.assign(Object.assign({},t),Np(n,e[r])):Object.assign(Object.assign({},t),{[r]:e[r]})},{}),zp=e=>{let t;return[...Dp].every(r=>{var n;return t=(n=r.exec(e))===null||n===void 0?void 0:n[1],!t}),t},Np=(e,t)=>Fe(t).reduce((r,n)=>Object.assign(Object.assign({},r),{[`${e}${n}`]:t[n]}),{}),Bp=class{constructor(e){this.opts=e}sendEvent(e,t){return y(this,void 0,void 0,function*(){if(!this.isAvailable())throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');let{baseUrl:r,preprocessRequest:n}=this.opts,a=yield this.getQueryParamsForEventType(e),{url:i,payload:o}=yield this.preProcessRequestAsPotentialJSONString(`${r}/analytics/${e}?${a}`,t,n),s=this.encodeForEventType(e,o),c=new Blob([s],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(i,c)})}isAvailable(){return"sendBeacon"in navigator}deleteHttpCookieVisitorId(){return Promise.resolve()}preProcessRequestAsPotentialJSONString(e,t,r){return y(this,void 0,void 0,function*(){let n=e,a=t;if(r){let i=yield r({url:e,body:JSON.stringify(t)},"analyticsBeacon"),{url:o,body:s}=i;n=o||e;try{a=JSON.parse(s)}catch(c){console.error("Unable to process the request body as a JSON string",c)}}return{payload:a,url:n}})}encodeForEventType(e,t){return this.isEventTypeLegacy(e)?this.encodeEventToJson(e,t):this.encodeEventToJson(e,t,this.opts.token)}getQueryParamsForEventType(e){return y(this,void 0,void 0,function*(){let{token:t,visitorIdProvider:r}=this.opts,n=yield r.getCurrentVisitorId();return[t&&this.isEventTypeLegacy(e)?`access_token=${t}`:"",n?`visitorId=${n}`:"","discardVisitInfo=true"].filter(a=>!!a).join("&")})}isEventTypeLegacy(e){return[B.click,B.custom,B.search,B.view].indexOf(e)!==-1}encodeEventToJson(e,t,r){let n=`${e}Event=${encodeURIComponent(JSON.stringify(t))}`;return r&&(n=`access_token=${encodeURIComponent(r)}&${n}`),n}},Yp=class{sendEvent(e,t){return y(this,void 0,void 0,function*(){return Promise.resolve()})}deleteHttpCookieVisitorId(){return y(this,void 0,void 0,function*(){return Promise.resolve()})}},Vi=window.fetch,js=class{constructor(e){this.opts=e}sendEvent(e,t){return y(this,void 0,void 0,function*(){let{baseUrl:r,visitorIdProvider:n,preprocessRequest:a}=this.opts,i=this.shouldAppendVisitorId(e)?yield this.getVisitorIdParam():"",o={url:`${r}/analytics/${e}${i}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(t)},s=Object.assign(Object.assign({},o),a?yield a(o,"analyticsFetch"):{}),{url:c}=s,u=Te(s,["url"]),l;try{l=yield Vi(c,u)}catch(d){console.error("An error has occured when sending the event.",d);return}if(l.ok){let d=yield l.json();return d.visitorId&&n.setCurrentVisitorId(d.visitorId),d}else{try{l.json()}catch{}throw console.error(`An error has occured when sending the "${e}" event.`,l,t),new Error(`An error has occurred when sending the "${e}" event. Check the console logs for more details.`)}})}deleteHttpCookieVisitorId(){return y(this,void 0,void 0,function*(){let{baseUrl:e}=this.opts,t=`${e}/analytics/visit`;yield Vi(t,{headers:this.getHeaders(),method:"DELETE"})})}shouldAppendVisitorId(e){return[B.click,B.custom,B.search,B.view].indexOf(e)!==-1}getVisitorIdParam(){return y(this,void 0,void 0,function*(){let{visitorIdProvider:e}=this.opts,t=yield e.getCurrentVisitorId();return t?`?visitor=${t}`:""})}getHeaders(){let{token:e}=this.opts;return Object.assign(Object.assign({},e?{Authorization:`Bearer ${e}`}:{}),{"Content-Type":"application/json"})}},Hp=class{constructor(e,t){Hn()&&As()?this.storage=new Lf:Hn()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new en),this.client=new js(e),this.beaconClient=new Bp(e),window.addEventListener("beforeunload",()=>{let r=t();for(let{eventType:n,payload:a}of r)this.beaconClient.sendEvent(n,a)})}getClientDependingOnEventType(e){return e==="click"&&this.beaconClient.isAvailable()?this.beaconClient:this.client}},Wp=class{constructor(e,t){this.storage=t||new en,this.client=new js(e)}getClientDependingOnEventType(e){return this.client}},$s=class{constructor(){this.storage=new en,this.client=new Yp}getClientDependingOnEventType(e){return this.client}},Gp="xx",Jp=e=>(e==null?void 0:e.startsWith(Gp))||!1,Kp=`
        We've detected you're using React Native but have not provided the corresponding runtime, 
        for an optimal experience please use the "coveo.analytics/react-native" subpackage.
        Follow the Readme on how to set it up: https://github.com/coveo/coveo.analytics.js#using-react-native
    `;function Zp(){return typeof navigator<"u"&&navigator.product=="ReactNative"}var Xp=["1",1,"yes",!0];function Zn(){return Da()&&[navigator.globalPrivacyControl,navigator.doNotTrack,navigator.msDoNotTrack,window.doNotTrack].some(e=>Xp.indexOf(e)!==-1)}var Ls="v15",Vs={default:"https://analytics.cloud.coveo.com/rest/ua",production:"https://analytics.cloud.coveo.com/rest/ua",hipaa:"https://analyticshipaa.cloud.coveo.com/rest/ua"};function eh(e=Vs.default,t=Ls,r=!1){if(e=e.replace(/\/$/,""),r)return`${e}/${t}`;let n=e.endsWith("/rest")||e.endsWith("/rest/ua");return`${e}${n?"":"/rest"}/${t}`}var th="38824e1f-37f5-42d3-8372-a4b8fa9df946",br=class{get defaultOptions(){return{endpoint:Vs.default,isCustomEndpoint:!1,token:"",version:Ls,beforeSendHooks:[],afterSendHooks:[]}}get version(){return Ms}constructor(e){if(this.acceptedLinkReferrers=[],!e)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[_f,jf].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};let t={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};Zn()?this.runtime=new $s:this.runtime=this.options.runtimeEnvironment||this.initRuntime(t),this.addEventTypeMapping(B.view,{newEventType:B.view,addClientIdParameter:!0}),this.addEventTypeMapping(B.click,{newEventType:B.click,addClientIdParameter:!0}),this.addEventTypeMapping(B.custom,{newEventType:B.custom,addClientIdParameter:!0}),this.addEventTypeMapping(B.search,{newEventType:B.search,addClientIdParameter:!0})}initRuntime(e){return Pi()&&Yn()?new Hp(e,()=>{let t=[...this.bufferedRequests];return this.bufferedRequests=[],t}):(Zp()&&console.warn(Kp),new Wp(e))}get storage(){return this.runtime.storage}determineVisitorId(){return y(this,void 0,void 0,function*(){try{return Pi()&&this.extractClientIdFromLink(window.location.href)||(yield this.storage.getItem("visitorId"))||Sn()}catch(e){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",e),Sn()}})}getCurrentVisitorId(){return y(this,void 0,void 0,function*(){if(!this.visitorId){let e=yield this.determineVisitorId();yield this.setCurrentVisitorId(e)}return this.visitorId})}setCurrentVisitorId(e){return y(this,void 0,void 0,function*(){this.visitorId=e,yield this.storage.setItem("visitorId",e)})}setClientId(e,t){return y(this,void 0,void 0,function*(){if(jr(e))this.setCurrentVisitorId(e.toLowerCase());else{if(!t)throw Error("Cannot generate uuid client id without a specific namespace string.");this.setCurrentVisitorId(Ti(e,Ti(t,th)))}})}getParameters(e,...t){return y(this,void 0,void 0,function*(){return yield this.resolveParameters(e,...t)})}getPayload(e,...t){return y(this,void 0,void 0,function*(){let r=yield this.resolveParameters(e,...t);return yield this.resolvePayloadForParameters(e,r)})}get currentVisitorId(){return typeof(this.visitorId||this.storage.getItem("visitorId"))!="string"&&this.setCurrentVisitorId(Sn()),this.visitorId}set currentVisitorId(e){this.visitorId=e,this.storage.setItem("visitorId",e)}extractClientIdFromLink(e){if(Zn())return null;try{let t=new URL(e).searchParams.get($r.cvo_cid);if(t==null)return null;let r=$r.fromString(t);return!r||!Yn()||!r.validate(document.referrer,this.acceptedLinkReferrers)?null:r.clientId}catch{}return null}resolveParameters(e,...t){return y(this,void 0,void 0,function*(){let{variableLengthArgumentsNames:r=[],addVisitorIdParameter:n=!1,usesMeasurementProtocol:a=!1,addClientIdParameter:i=!1}=this.eventTypeMapping[e]||{};return yield[o=>r.length>0?this.parseVariableArgumentsPayload(r,o):o[0],o=>y(this,void 0,void 0,function*(){return Object.assign(Object.assign({},o),{visitorId:n?yield this.getCurrentVisitorId():""})}),o=>y(this,void 0,void 0,function*(){return i?Object.assign(Object.assign({},o),{clientId:yield this.getCurrentVisitorId()}):o}),o=>a?this.ensureAnonymousUserWhenUsingApiKey(o):o,o=>this.beforeSendHooks.reduce((s,c)=>y(this,void 0,void 0,function*(){let u=yield s;return yield c(e,u)}),o)].reduce((o,s)=>y(this,void 0,void 0,function*(){let c=yield o;return yield s(c)}),Promise.resolve(t))})}resolvePayloadForParameters(e,t){return y(this,void 0,void 0,function*(){let{usesMeasurementProtocol:r=!1}=this.eventTypeMapping[e]||{};return yield[n=>this.setTrackingIdIfTrackingIdNotPresent(n),n=>this.removeEmptyPayloadValues(n,e),n=>this.validateParams(n,e),n=>r?jp(n):n,n=>r?this.removeUnknownParameters(n):n,n=>r?this.processCustomParameters(n):this.mapCustomParametersToCustomData(n)].reduce((n,a)=>y(this,void 0,void 0,function*(){let i=yield n;return yield a(i)}),Promise.resolve(t))})}makeEvent(e,...t){return y(this,void 0,void 0,function*(){let{newEventType:r=e}=this.eventTypeMapping[e]||{},n=yield this.resolveParameters(e,...t),a=yield this.resolvePayloadForParameters(e,n);return{eventType:r,payload:a,log:i=>y(this,void 0,void 0,function*(){return this.bufferedRequests.push({eventType:r,payload:Object.assign(Object.assign({},a),i)}),yield Promise.all(this.afterSendHooks.map(o=>o(e,Object.assign(Object.assign({},n),i)))),yield this.deferExecution(),yield this.sendFromBuffer()})}})}sendEvent(e,...t){return y(this,void 0,void 0,function*(){return(yield this.makeEvent(e,...t)).log({})})}deferExecution(){return new Promise(e=>setTimeout(e,0))}sendFromBuffer(){return y(this,void 0,void 0,function*(){let e=this.bufferedRequests.shift();if(e){let{eventType:t,payload:r}=e;return this.runtime.getClientDependingOnEventType(t).sendEvent(t,r)}})}clear(){this.storage.removeItem("visitorId"),new Tr().clear()}deleteHttpOnlyVisitorId(){this.runtime.client.deleteHttpCookieVisitorId()}makeSearchEvent(e){return y(this,void 0,void 0,function*(){return this.makeEvent(B.search,e)})}sendSearchEvent(e){var{searchQueryUid:t}=e,r=Te(e,["searchQueryUid"]);return y(this,void 0,void 0,function*(){return(yield this.makeSearchEvent(r)).log({searchQueryUid:t})})}makeClickEvent(e){return y(this,void 0,void 0,function*(){return this.makeEvent(B.click,e)})}sendClickEvent(e){var{searchQueryUid:t}=e,r=Te(e,["searchQueryUid"]);return y(this,void 0,void 0,function*(){return(yield this.makeClickEvent(r)).log({searchQueryUid:t})})}makeCustomEvent(e){return y(this,void 0,void 0,function*(){return this.makeEvent(B.custom,e)})}sendCustomEvent(e){var{lastSearchQueryUid:t}=e,r=Te(e,["lastSearchQueryUid"]);return y(this,void 0,void 0,function*(){return(yield this.makeCustomEvent(r)).log({lastSearchQueryUid:t})})}makeViewEvent(e){return y(this,void 0,void 0,function*(){return this.makeEvent(B.view,e)})}sendViewEvent(e){return y(this,void 0,void 0,function*(){return(yield this.makeViewEvent(e)).log({})})}getVisit(){return y(this,void 0,void 0,function*(){let e=yield(yield fetch(`${this.baseUrl}/analytics/visit`)).json();return this.visitorId=e.visitorId,e})}getHealth(){return y(this,void 0,void 0,function*(){return yield(yield fetch(`${this.baseUrl}/analytics/monitoring/health`)).json()})}registerBeforeSendEventHook(e){this.beforeSendHooks.push(e)}registerAfterSendEventHook(e){this.afterSendHooks.push(e)}addEventTypeMapping(e,t){this.eventTypeMapping[e]=t}setAcceptedLinkReferrers(e){if(Array.isArray(e)&&e.every(t=>typeof t=="string"))this.acceptedLinkReferrers=e;else throw Error("Parameter should be an array of domain strings")}parseVariableArgumentsPayload(e,t){let r={};for(let n=0,a=t.length;n<a;n++){let i=t[n];if(typeof i=="string")r[e[n]]=i;else if(typeof i=="object")return Object.assign(Object.assign({},r),i)}return r}isKeyAllowedEmpty(e,t){return({[B.search]:["queryText"]}[e]||[]).indexOf(t)!==-1}removeEmptyPayloadValues(e,t){let r=n=>typeof n<"u"&&n!==null&&n!=="";return Object.keys(e).filter(n=>this.isKeyAllowedEmpty(t,n)||r(e[n])).reduce((n,a)=>Object.assign(Object.assign({},n),{[a]:e[a]}),{})}removeUnknownParameters(e){return Object.keys(e).filter(t=>{if(_p(t))return!0;console.log(t,"is not processed by coveoua")}).reduce((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]}),{})}processCustomParameters(e){let{custom:t}=e,r=Te(e,["custom"]),n={};t&&fr(t)&&(n=this.lowercaseKeys(t));let a=Qp(r);return Object.assign(Object.assign({},n),a)}mapCustomParametersToCustomData(e){let{custom:t}=e,r=Te(e,["custom"]);if(t&&fr(t)){let n=this.lowercaseKeys(t);return Object.assign(Object.assign({},r),{customData:Object.assign(Object.assign({},n),e.customData)})}else return e}lowercaseKeys(e){let t=Object.keys(e),r={};return t.forEach(n=>{r[n.toLowerCase()]=e[n]}),r}validateParams(e,t){let{anonymizeIp:r}=e,n=Te(e,["anonymizeIp"]);return r!==void 0&&["0","false","undefined","null","{}","[]",""].indexOf(`${r}`.toLowerCase())==-1&&(n.anonymizeIp=1),(t==B.view||t==B.click||t==B.search||t==B.custom)&&(n.originLevel3=this.limit(n.originLevel3,128)),t==B.view&&(n.location=this.limit(n.location,128)),(t=="pageview"||t=="event")&&(n.referrer=this.limit(n.referrer,2048),n.location=this.limit(n.location,2048),n.page=this.limit(n.page,2048)),n}ensureAnonymousUserWhenUsingApiKey(e){let{userId:t}=e,r=Te(e,["userId"]);return Jp(this.options.token)&&!t?(r.userId="anonymous",r):e}setTrackingIdIfTrackingIdNotPresent(e){let{trackingId:t}=e,r=Te(e,["trackingId"]);return t?e:(r.hasOwnProperty("custom")&&fr(r.custom)&&(r.custom.hasOwnProperty("context_website")||r.custom.hasOwnProperty("siteName"))&&(r.trackingId=r.custom.context_website||r.custom.siteName),r.hasOwnProperty("customData")&&fr(r.customData)&&(r.customData.hasOwnProperty("context_website")||r.customData.hasOwnProperty("siteName"))&&(r.trackingId=r.customData.context_website||r.customData.siteName),r)}limit(e,t){return typeof e!="string"?e:e.substring(0,t)}get baseUrl(){return eh(this.options.endpoint,this.options.version,this.options.isCustomEndpoint)}},je;(function(e){e.contextChanged="contextChanged",e.expandToFullUI="expandToFullUI",e.openUserActions="openUserActions",e.showPrecedingSessions="showPrecedingSessions",e.showFollowingSessions="showFollowingSessions",e.clickViewedDocument="clickViewedDocument",e.clickPageView="clickPageView",e.createArticle="createArticle"})(je||(je={}));var S;(function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.undoTriggerQuery="undoQuery",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.staticFilterClearAll="staticFilterClearAll",e.staticFilterSelect="staticFilterSelect",e.staticFilterDeselect="staticFilterDeselect",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",e.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",e.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",e.openSmartSnippetSource="openSmartSnippetSource",e.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",e.openSmartSnippetInlineLink="openSmartSnippetInlineLink",e.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",e.recentQueryClick="recentQueriesClick",e.clearRecentQueries="clearRecentQueries",e.recentResultClick="recentResultClick",e.clearRecentResults="clearRecentResults",e.noResultsBack="noResultsBack",e.showMoreFoldedResults="showMoreFoldedResults",e.showLessFoldedResults="showLessFoldedResults",e.copyToClipboard="copyToClipboard",e.caseSendEmail="Case.SendEmail",e.feedItemTextPost="FeedItem.TextPost",e.caseAttach="caseAttach",e.caseDetach="caseDetach",e.retryGeneratedAnswer="retryGeneratedAnswer",e.likeGeneratedAnswer="likeGeneratedAnswer",e.dislikeGeneratedAnswer="dislikeGeneratedAnswer",e.openGeneratedAnswerSource="openGeneratedAnswerSource",e.generatedAnswerStreamEnd="generatedAnswerStreamEnd",e.generatedAnswerSourceHover="generatedAnswerSourceHover",e.generatedAnswerCopyToClipboard="generatedAnswerCopyToClipboard",e.generatedAnswerHideAnswers="generatedAnswerHideAnswers",e.generatedAnswerShowAnswers="generatedAnswerShowAnswers",e.generatedAnswerExpand="generatedAnswerExpand",e.generatedAnswerCollapse="generatedAnswerCollapse",e.generatedAnswerFeedbackSubmit="generatedAnswerFeedbackSubmit",e.rephraseGeneratedAnswer="rephraseGeneratedAnswer"})(S||(S={}));var _i={[S.triggerNotify]:"queryPipelineTriggers",[S.triggerExecute]:"queryPipelineTriggers",[S.triggerQuery]:"queryPipelineTriggers",[S.triggerRedirect]:"queryPipelineTriggers",[S.queryError]:"errors",[S.queryErrorBack]:"errors",[S.queryErrorClear]:"errors",[S.queryErrorRetry]:"errors",[S.pagerNext]:"getMoreResults",[S.pagerPrevious]:"getMoreResults",[S.pagerNumber]:"getMoreResults",[S.pagerResize]:"getMoreResults",[S.pagerScrolling]:"getMoreResults",[S.facetSearch]:"facet",[S.facetShowLess]:"facet",[S.facetShowMore]:"facet",[S.recommendation]:"recommendation",[S.likeSmartSnippet]:"smartSnippet",[S.dislikeSmartSnippet]:"smartSnippet",[S.expandSmartSnippet]:"smartSnippet",[S.collapseSmartSnippet]:"smartSnippet",[S.openSmartSnippetFeedbackModal]:"smartSnippet",[S.closeSmartSnippetFeedbackModal]:"smartSnippet",[S.sendSmartSnippetReason]:"smartSnippet",[S.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[S.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions",[S.showMoreSmartSnippetSuggestion]:"smartSnippetSuggestions",[S.showLessSmartSnippetSuggestion]:"smartSnippetSuggestions",[S.clearRecentQueries]:"recentQueries",[S.recentResultClick]:"recentlyClickedDocuments",[S.clearRecentResults]:"recentlyClickedDocuments",[S.showLessFoldedResults]:"folding",[S.caseDetach]:"case",[S.likeGeneratedAnswer]:"generatedAnswer",[S.dislikeGeneratedAnswer]:"generatedAnswer",[S.openGeneratedAnswerSource]:"generatedAnswer",[S.generatedAnswerStreamEnd]:"generatedAnswer",[S.generatedAnswerSourceHover]:"generatedAnswer",[S.generatedAnswerCopyToClipboard]:"generatedAnswer",[S.generatedAnswerHideAnswers]:"generatedAnswer",[S.generatedAnswerShowAnswers]:"generatedAnswer",[S.generatedAnswerExpand]:"generatedAnswer",[S.generatedAnswerCollapse]:"generatedAnswer",[S.generatedAnswerFeedbackSubmit]:"generatedAnswer",[je.expandToFullUI]:"interface",[je.openUserActions]:"User Actions",[je.showPrecedingSessions]:"User Actions",[je.showFollowingSessions]:"User Actions",[je.clickViewedDocument]:"User Actions",[je.clickPageView]:"User Actions",[je.createArticle]:"createArticle"},Qi=class{constructor(){this.runtime=new $s,this.currentVisitorId=""}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}makeEvent(e){return Promise.resolve({eventType:e,payload:null,log:()=>Promise.resolve()})}sendEvent(){return Promise.resolve()}makeSearchEvent(){return this.makeEvent(B.search)}sendSearchEvent(){return Promise.resolve()}makeClickEvent(){return this.makeEvent(B.click)}sendClickEvent(){return Promise.resolve()}makeCustomEvent(){return this.makeEvent(B.custom)}sendCustomEvent(){return Promise.resolve()}makeViewEvent(){return this.makeEvent(B.view)}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}get version(){return Ms}};function rh(e){let t="";return e.filter(r=>{let n=r!==t;return t=r,n})}function nh(e){return e.map(t=>t.replace(/;/g,""))}function _s(e){let t=e.join(";");return t.length<=256?t:_s(e.slice(1))}var zi=e=>{let t=nh(e),r=rh(t);return _s(r)};function Ni(e){let t=typeof e.partialQueries=="string"?e.partialQueries:zi(e.partialQueries),r=typeof e.suggestions=="string"?e.suggestions:zi(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}var Qs=class{constructor(e,t){this.opts=e,this.provider=t;let r=e.enableAnalytics===!1||Zn();this.coveoAnalyticsClient=r?new Qi:new br(e)}disable(){this.coveoAnalyticsClient=new Qi}enable(){this.coveoAnalyticsClient=new br(this.opts)}makeInterfaceLoad(){return this.makeSearchEvent(S.interfaceLoad)}logInterfaceLoad(){return y(this,void 0,void 0,function*(){return(yield this.makeInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationInterfaceLoad(){return this.makeSearchEvent(S.recommendationInterfaceLoad)}logRecommendationInterfaceLoad(){return y(this,void 0,void 0,function*(){return(yield this.makeRecommendationInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendation(){return this.makeCustomEvent(S.recommendation)}logRecommendation(){return y(this,void 0,void 0,function*(){return(yield this.makeRecommendation()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationOpen(e,t){return this.makeClickEvent(S.recommendationOpen,e,t)}logRecommendationOpen(e,t){return y(this,void 0,void 0,function*(){return(yield this.makeRecommendationOpen(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterClearAll(e){return this.makeSearchEvent(S.staticFilterClearAll,e)}logStaticFilterClearAll(e){return y(this,void 0,void 0,function*(){return(yield this.makeStaticFilterClearAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterSelect(e){return this.makeSearchEvent(S.staticFilterSelect,e)}logStaticFilterSelect(e){return y(this,void 0,void 0,function*(){return(yield this.makeStaticFilterSelect(e)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterDeselect(e){return this.makeSearchEvent(S.staticFilterDeselect,e)}logStaticFilterDeselect(e){return y(this,void 0,void 0,function*(){return(yield this.makeStaticFilterDeselect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFetchMoreResults(){return this.makeCustomEvent(S.pagerScrolling,{type:"getMoreResults"})}logFetchMoreResults(){return y(this,void 0,void 0,function*(){return(yield this.makeFetchMoreResults()).log({searchUID:this.provider.getSearchUID()})})}makeInterfaceChange(e){return this.makeSearchEvent(S.interfaceChange,e)}logInterfaceChange(e){return y(this,void 0,void 0,function*(){return(yield this.makeInterfaceChange(e)).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanAutomatic(){return this.makeSearchEvent(S.didyoumeanAutomatic)}logDidYouMeanAutomatic(){return y(this,void 0,void 0,function*(){return(yield this.makeDidYouMeanAutomatic()).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanClick(){return this.makeSearchEvent(S.didyoumeanClick)}logDidYouMeanClick(){return y(this,void 0,void 0,function*(){return(yield this.makeDidYouMeanClick()).log({searchUID:this.provider.getSearchUID()})})}makeResultsSort(e){return this.makeSearchEvent(S.resultsSort,e)}logResultsSort(e){return y(this,void 0,void 0,function*(){return(yield this.makeResultsSort(e)).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxSubmit(){return this.makeSearchEvent(S.searchboxSubmit)}logSearchboxSubmit(){return y(this,void 0,void 0,function*(){return(yield this.makeSearchboxSubmit()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxClear(){return this.makeSearchEvent(S.searchboxClear)}logSearchboxClear(){return y(this,void 0,void 0,function*(){return(yield this.makeSearchboxClear()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxAsYouType(){return this.makeSearchEvent(S.searchboxAsYouType)}logSearchboxAsYouType(){return y(this,void 0,void 0,function*(){return(yield this.makeSearchboxAsYouType()).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbFacet(e){return this.makeSearchEvent(S.breadcrumbFacet,e)}logBreadcrumbFacet(e){return y(this,void 0,void 0,function*(){return(yield this.makeBreadcrumbFacet(e)).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbResetAll(){return this.makeSearchEvent(S.breadcrumbResetAll)}logBreadcrumbResetAll(){return y(this,void 0,void 0,function*(){return(yield this.makeBreadcrumbResetAll()).log({searchUID:this.provider.getSearchUID()})})}makeDocumentQuickview(e,t){return this.makeClickEvent(S.documentQuickview,e,t)}logDocumentQuickview(e,t){return y(this,void 0,void 0,function*(){return(yield this.makeDocumentQuickview(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeDocumentOpen(e,t){return this.makeClickEvent(S.documentOpen,e,t)}logDocumentOpen(e,t){return y(this,void 0,void 0,function*(){return(yield this.makeDocumentOpen(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxAnalytics(e){return this.makeSearchEvent(S.omniboxAnalytics,Ni(e))}logOmniboxAnalytics(e){return y(this,void 0,void 0,function*(){return(yield this.makeOmniboxAnalytics(e)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxFromLink(e){return this.makeSearchEvent(S.omniboxFromLink,Ni(e))}logOmniboxFromLink(e){return y(this,void 0,void 0,function*(){return(yield this.makeOmniboxFromLink(e)).log({searchUID:this.provider.getSearchUID()})})}makeSearchFromLink(){return this.makeSearchEvent(S.searchFromLink)}logSearchFromLink(){return y(this,void 0,void 0,function*(){return(yield this.makeSearchFromLink()).log({searchUID:this.provider.getSearchUID()})})}makeTriggerNotify(e){return this.makeCustomEvent(S.triggerNotify,e)}logTriggerNotify(e){return y(this,void 0,void 0,function*(){return(yield this.makeTriggerNotify(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerExecute(e){return this.makeCustomEvent(S.triggerExecute,e)}logTriggerExecute(e){return y(this,void 0,void 0,function*(){return(yield this.makeTriggerExecute(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerQuery(){return this.makeCustomEvent(S.triggerQuery,{query:this.provider.getSearchEventRequestPayload().queryText},"queryPipelineTriggers")}logTriggerQuery(){return y(this,void 0,void 0,function*(){return(yield this.makeTriggerQuery()).log({searchUID:this.provider.getSearchUID()})})}makeUndoTriggerQuery(e){return this.makeSearchEvent(S.undoTriggerQuery,e)}logUndoTriggerQuery(e){return y(this,void 0,void 0,function*(){return(yield this.makeUndoTriggerQuery(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerRedirect(e){return this.makeCustomEvent(S.triggerRedirect,Object.assign(Object.assign({},e),{query:this.provider.getSearchEventRequestPayload().queryText}))}logTriggerRedirect(e){return y(this,void 0,void 0,function*(){return(yield this.makeTriggerRedirect(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerResize(e){return this.makeCustomEvent(S.pagerResize,e)}logPagerResize(e){return y(this,void 0,void 0,function*(){return(yield this.makePagerResize(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerNumber(e){return this.makeCustomEvent(S.pagerNumber,e)}logPagerNumber(e){return y(this,void 0,void 0,function*(){return(yield this.makePagerNumber(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerNext(e){return this.makeCustomEvent(S.pagerNext,e)}logPagerNext(e){return y(this,void 0,void 0,function*(){return(yield this.makePagerNext(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerPrevious(e){return this.makeCustomEvent(S.pagerPrevious,e)}logPagerPrevious(e){return y(this,void 0,void 0,function*(){return(yield this.makePagerPrevious(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerScrolling(){return this.makeCustomEvent(S.pagerScrolling)}logPagerScrolling(){return y(this,void 0,void 0,function*(){return(yield this.makePagerScrolling()).log({searchUID:this.provider.getSearchUID()})})}makeFacetClearAll(e){return this.makeSearchEvent(S.facetClearAll,e)}logFacetClearAll(e){return y(this,void 0,void 0,function*(){return(yield this.makeFacetClearAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSearch(e){return this.makeSearchEvent(S.facetSearch,e)}logFacetSearch(e){return y(this,void 0,void 0,function*(){return(yield this.makeFacetSearch(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelect(e){return this.makeSearchEvent(S.facetSelect,e)}logFacetSelect(e){return y(this,void 0,void 0,function*(){return(yield this.makeFacetSelect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetDeselect(e){return this.makeSearchEvent(S.facetDeselect,e)}logFacetDeselect(e){return y(this,void 0,void 0,function*(){return(yield this.makeFacetDeselect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetExclude(e){return this.makeSearchEvent(S.facetExclude,e)}logFacetExclude(e){return y(this,void 0,void 0,function*(){return(yield this.makeFacetExclude(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUnexclude(e){return this.makeSearchEvent(S.facetUnexclude,e)}logFacetUnexclude(e){return y(this,void 0,void 0,function*(){return(yield this.makeFacetUnexclude(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelectAll(e){return this.makeSearchEvent(S.facetSelectAll,e)}logFacetSelectAll(e){return y(this,void 0,void 0,function*(){return(yield this.makeFacetSelectAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUpdateSort(e){return this.makeSearchEvent(S.facetUpdateSort,e)}logFacetUpdateSort(e){return y(this,void 0,void 0,function*(){return(yield this.makeFacetUpdateSort(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowMore(e){return this.makeCustomEvent(S.facetShowMore,e)}logFacetShowMore(e){return y(this,void 0,void 0,function*(){return(yield this.makeFacetShowMore(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowLess(e){return this.makeCustomEvent(S.facetShowLess,e)}logFacetShowLess(e){return y(this,void 0,void 0,function*(){return(yield this.makeFacetShowLess(e)).log({searchUID:this.provider.getSearchUID()})})}makeQueryError(e){return this.makeCustomEvent(S.queryError,e)}logQueryError(e){return y(this,void 0,void 0,function*(){return(yield this.makeQueryError(e)).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorBack(){return y(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(S.queryErrorBack);return{description:e.description,log:()=>y(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(S.queryErrorBack)})}})}logQueryErrorBack(){return y(this,void 0,void 0,function*(){return(yield this.makeQueryErrorBack()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorRetry(){return y(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(S.queryErrorRetry);return{description:e.description,log:()=>y(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(S.queryErrorRetry)})}})}logQueryErrorRetry(){return y(this,void 0,void 0,function*(){return(yield this.makeQueryErrorRetry()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorClear(){return y(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(S.queryErrorClear);return{description:e.description,log:()=>y(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(S.queryErrorClear)})}})}logQueryErrorClear(){return y(this,void 0,void 0,function*(){return(yield this.makeQueryErrorClear()).log({searchUID:this.provider.getSearchUID()})})}makeLikeSmartSnippet(){return this.makeCustomEvent(S.likeSmartSnippet)}logLikeSmartSnippet(){return y(this,void 0,void 0,function*(){return(yield this.makeLikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeDislikeSmartSnippet(){return this.makeCustomEvent(S.dislikeSmartSnippet)}logDislikeSmartSnippet(){return y(this,void 0,void 0,function*(){return(yield this.makeDislikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippet(){return this.makeCustomEvent(S.expandSmartSnippet)}logExpandSmartSnippet(){return y(this,void 0,void 0,function*(){return(yield this.makeExpandSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippet(){return this.makeCustomEvent(S.collapseSmartSnippet)}logCollapseSmartSnippet(){return y(this,void 0,void 0,function*(){return(yield this.makeCollapseSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetFeedbackModal(){return this.makeCustomEvent(S.openSmartSnippetFeedbackModal)}logOpenSmartSnippetFeedbackModal(){return y(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeCloseSmartSnippetFeedbackModal(){return this.makeCustomEvent(S.closeSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return y(this,void 0,void 0,function*(){return(yield this.makeCloseSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeSmartSnippetFeedbackReason(e,t){return this.makeCustomEvent(S.sendSmartSnippetReason,{reason:e,details:t})}logSmartSnippetFeedbackReason(e,t){return y(this,void 0,void 0,function*(){return(yield this.makeSmartSnippetFeedbackReason(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippetSuggestion(e){return this.makeCustomEvent(S.expandSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logExpandSmartSnippetSuggestion(e){return y(this,void 0,void 0,function*(){return(yield this.makeExpandSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippetSuggestion(e){return this.makeCustomEvent(S.collapseSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logCollapseSmartSnippetSuggestion(e){return y(this,void 0,void 0,function*(){return(yield this.makeCollapseSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreSmartSnippetSuggestion(e){return this.makeCustomEvent(S.showMoreSmartSnippetSuggestion,e)}logShowMoreSmartSnippetSuggestion(e){return y(this,void 0,void 0,function*(){return(yield this.makeShowMoreSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessSmartSnippetSuggestion(e){return this.makeCustomEvent(S.showLessSmartSnippetSuggestion,e)}logShowLessSmartSnippetSuggestion(e){return y(this,void 0,void 0,function*(){return(yield this.makeShowLessSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSource(e,t){return this.makeClickEvent(S.openSmartSnippetSource,e,t)}logOpenSmartSnippetSource(e,t){return y(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSource(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionSource(e,t){return this.makeClickEvent(S.openSmartSnippetSuggestionSource,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}makeCopyToClipboard(e,t){return this.makeClickEvent(S.copyToClipboard,e,t)}logCopyToClipboard(e,t){return y(this,void 0,void 0,function*(){return(yield this.makeCopyToClipboard(e,t)).log({searchUID:this.provider.getSearchUID()})})}logOpenSmartSnippetSuggestionSource(e,t){return y(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSuggestionSource(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetInlineLink(e,t){return this.makeClickEvent(S.openSmartSnippetInlineLink,e,{contentIDKey:t.contentIDKey,contentIDValue:t.contentIDValue},t)}logOpenSmartSnippetInlineLink(e,t){return y(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionInlineLink(e,t){return this.makeClickEvent(S.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}logOpenSmartSnippetSuggestionInlineLink(e,t){return y(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSuggestionInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeRecentQueryClick(){return this.makeSearchEvent(S.recentQueryClick)}logRecentQueryClick(){return y(this,void 0,void 0,function*(){return(yield this.makeRecentQueryClick()).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentQueries(){return this.makeCustomEvent(S.clearRecentQueries)}logClearRecentQueries(){return y(this,void 0,void 0,function*(){return(yield this.makeClearRecentQueries()).log({searchUID:this.provider.getSearchUID()})})}makeRecentResultClick(e,t){return this.makeCustomEvent(S.recentResultClick,{info:e,identifier:t})}logRecentResultClick(e,t){return y(this,void 0,void 0,function*(){return(yield this.makeRecentResultClick(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentResults(){return this.makeCustomEvent(S.clearRecentResults)}logClearRecentResults(){return y(this,void 0,void 0,function*(){return(yield this.makeClearRecentResults()).log({searchUID:this.provider.getSearchUID()})})}makeNoResultsBack(){return this.makeSearchEvent(S.noResultsBack)}logNoResultsBack(){return y(this,void 0,void 0,function*(){return(yield this.makeNoResultsBack()).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreFoldedResults(e,t){return this.makeClickEvent(S.showMoreFoldedResults,e,t)}logShowMoreFoldedResults(e,t){return y(this,void 0,void 0,function*(){return(yield this.makeShowMoreFoldedResults(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessFoldedResults(){return this.makeCustomEvent(S.showLessFoldedResults)}logShowLessFoldedResults(){return y(this,void 0,void 0,function*(){return(yield this.makeShowLessFoldedResults()).log({searchUID:this.provider.getSearchUID()})})}makeEventDescription(e,t){var r;return{actionCause:t,customData:(r=e.payload)===null||r===void 0?void 0:r.customData}}makeCustomEvent(e,t,r=_i[e]){return y(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),a=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:r,eventValue:e}),i=yield this.coveoAnalyticsClient.makeCustomEvent(a);return{description:this.makeEventDescription(i,e),log:({searchUID:o})=>i.log({lastSearchQueryUid:o})}})}logCustomEvent(e,t,r=_i[e]){return y(this,void 0,void 0,function*(){return(yield this.makeCustomEvent(e,t,r)).log({searchUID:this.provider.getSearchUID()})})}makeCustomEventWithType(e,t,r){return y(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),a=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:t,eventValue:e}),i=yield this.coveoAnalyticsClient.makeCustomEvent(a);return{description:this.makeEventDescription(i,e),log:({searchUID:o})=>i.log({lastSearchQueryUid:o})}})}logCustomEventWithType(e,t,r){return y(this,void 0,void 0,function*(){return(yield this.makeCustomEventWithType(e,t,r)).log({searchUID:this.provider.getSearchUID()})})}logSearchEvent(e,t){return y(this,void 0,void 0,function*(){return(yield this.makeSearchEvent(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeSearchEvent(e,t){return y(this,void 0,void 0,function*(){let r=yield this.getBaseSearchEventRequest(e,t),n=yield this.coveoAnalyticsClient.makeSearchEvent(r);return{description:this.makeEventDescription(n,e),log:({searchUID:a})=>n.log({searchQueryUid:a})}})}makeClickEvent(e,t,r,n){return y(this,void 0,void 0,function*(){let a=Object.assign(Object.assign(Object.assign({},t),yield this.getBaseEventRequest(Object.assign(Object.assign({},r),n))),{queryPipeline:this.provider.getPipeline(),actionCause:e}),i=yield this.coveoAnalyticsClient.makeClickEvent(a);return{description:this.makeEventDescription(i,e),log:({searchUID:o})=>i.log({searchQueryUid:o})}})}logClickEvent(e,t,r,n){return y(this,void 0,void 0,function*(){return(yield this.makeClickEvent(e,t,r,n)).log({searchUID:this.provider.getSearchUID()})})}getBaseSearchEventRequest(e,t){var r,n;return y(this,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},t),(n=(r=this.provider).getGeneratedAnswerMetadata)===null||n===void 0?void 0:n.call(r)))),this.provider.getSearchEventRequestPayload()),{queryPipeline:this.provider.getPipeline(),actionCause:e})})}getBaseEventRequest(e){return y(this,void 0,void 0,function*(){let t=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign(Object.assign({},this.getOrigins()),this.getSplitTestRun()),{customData:t,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})})}getOrigins(){var e,t;return{originContext:(t=(e=this.provider).getOriginContext)===null||t===void 0?void 0:t.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof br?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getSplitTestRun(){let e=this.provider.getSplitTestRunName?this.provider.getSplitTestRunName():"",t=this.provider.getSplitTestRunVersion?this.provider.getSplitTestRunVersion():"";return Object.assign(Object.assign({},e&&{splitTestRunName:e}),t&&{splitTestRunVersion:t})}makeLikeGeneratedAnswer(e){return this.makeCustomEvent(S.likeGeneratedAnswer,e)}logLikeGeneratedAnswer(e){return y(this,void 0,void 0,function*(){return(yield this.makeLikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeDislikeGeneratedAnswer(e){return this.makeCustomEvent(S.dislikeGeneratedAnswer,e)}logDislikeGeneratedAnswer(e){return y(this,void 0,void 0,function*(){return(yield this.makeDislikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeOpenGeneratedAnswerSource(e){return this.makeCustomEvent(S.openGeneratedAnswerSource,e)}logOpenGeneratedAnswerSource(e){return y(this,void 0,void 0,function*(){return(yield this.makeOpenGeneratedAnswerSource(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerSourceHover(e){return this.makeCustomEvent(S.generatedAnswerSourceHover,e)}logGeneratedAnswerSourceHover(e){return y(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerSourceHover(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCopyToClipboard(e){return this.makeCustomEvent(S.generatedAnswerCopyToClipboard,e)}logGeneratedAnswerCopyToClipboard(e){return y(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerCopyToClipboard(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerHideAnswers(e){return this.makeCustomEvent(S.generatedAnswerHideAnswers,e)}logGeneratedAnswerHideAnswers(e){return y(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerHideAnswers(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerShowAnswers(e){return this.makeCustomEvent(S.generatedAnswerShowAnswers,e)}logGeneratedAnswerShowAnswers(e){return y(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerShowAnswers(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerExpand(e){return this.makeCustomEvent(S.generatedAnswerExpand,e)}logGeneratedAnswerExpand(e){return y(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerExpand(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCollapse(e){return this.makeCustomEvent(S.generatedAnswerCollapse,e)}logGeneratedAnswerCollapse(e){return y(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerCollapse(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerFeedbackSubmit(e){return this.makeCustomEvent(S.generatedAnswerFeedbackSubmit,e)}logGeneratedAnswerFeedbackSubmit(e){return y(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerFeedbackSubmit(e)).log({searchUID:this.provider.getSearchUID()})})}makeRephraseGeneratedAnswer(e){return this.makeSearchEvent(S.rephraseGeneratedAnswer,e)}logRephraseGeneratedAnswer(e){return y(this,void 0,void 0,function*(){return(yield this.makeRephraseGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeRetryGeneratedAnswer(){return this.makeSearchEvent(S.retryGeneratedAnswer)}logRetryGeneratedAnswer(){return y(this,void 0,void 0,function*(){return(yield this.makeRetryGeneratedAnswer()).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerStreamEnd(e){return this.makeCustomEvent(S.generatedAnswerStreamEnd,e)}logGeneratedAnswerStreamEnd(e){return y(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerStreamEnd(e)).log({searchUID:this.provider.getSearchUID()})})}},Bi=Object.assign({},tp);Object.keys(Bi).map(e=>Bi[e]);var Yi;(function(e){e.click="click",e.flowStart="flowStart"})(Yi||(Yi={}));var Hi;(function(e){e.enterInterface="ticket_create_start",e.fieldUpdate="ticket_field_update",e.fieldSuggestionClick="ticket_classification_click",e.suggestionClick="suggestion_click",e.suggestionRate="suggestion_rate",e.nextCaseStep="ticket_next_stage",e.caseCancelled="ticket_cancel",e.caseSolved="ticket_cancel",e.caseCreated="ticket_create"})(Hi||(Hi={}));var Wi;(function(e){e.quit="Quit",e.solved="Solved"})(Wi||(Wi={}));var rt=e=>new br(e).getCurrentVisitorId(),xt=new Vf.HistoryStore,zs=(e,t)=>typeof t=="function"?(...r)=>{let n=ya(r[0]);try{return t.apply(t,r)}catch(a){return e.error(a,"Error in analytics preprocessRequest. Returning original request."),n}}:void 0,Ns=(e,t)=>(...r)=>{let n=ya(r[1]);try{return t.apply(t,r)}catch(a){return e.error(a,"Error in analytics hook. Returning original request."),n}};function Bs(e,t){let r={};e.forEach(i=>r[i.facetId]=i);let n=[];t.forEach(i=>{i in r&&(n.push(r[i]),delete r[i])});let a=Object.values(r);return[...n,...a]}function ot(e){return Object.values(e).map(t=>t.request)}var Cr=()=>({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,lq:"",lqWasSet:!1,dq:"",dqWasSet:!1,defaultFilters:{cq:"",aq:"",lq:"",dq:""}});function ah({config:e,environment:t,event:r,listenerManager:n}){let{url:a,token:i,mode:o}=e;o!=="disabled"&&(n.call(r),t.send(a,i,r))}var ih=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function oh(e){return typeof e=="string"&&ih.test(e)}function sh(e){let t="visitorId";return{getClientId:()=>{let r=e.get(),n=r.storage,a=n.getItem(t),i=a&&oh(a)?a:r.generateUUID();return n.setItem(t,i),i},clear:()=>{e.get().storage.removeItem(t)}}}var Ys="0.7.7";function ch(e){let{trackingId:t}=e;return{trackingId:t}}function uh(e){return(e.source||[]).concat([`relay@${Ys}`])}function Hs(e,t,r,n){let{getReferrer:a,getLocation:i,getUserAgent:o}=r,s=ch(t),c=n.getClientId();return Object.freeze({type:e,config:s,ts:Date.now(),source:uh(t),clientId:c,userAgent:o(),referrer:a(),location:i()})}function lh(e,t,r,n,a){return{...t,meta:Hs(e,r,n,a)}}var dh="*";function fh(){let e=[];function t({type:c,callback:u}){return e.findIndex(l=>l.type===c&&l.callback===u)}function r(c,u){return c.type==="*"||u===c.type}function n(c){return t(c)<0&&e.push(c),()=>s(c.type,c.callback)}function a(c){e.forEach(u=>{if(r(u,c.meta.type))try{u.callback(c)}catch(l){console.error(l)}})}function i(c){if(c===dh)e.length=0;else for(let u=e.length-1;u>=0;u--)e[u].type===c&&e.splice(u,1)}function o(c){let u=t(c);u>=0&&e.splice(u,1)}function s(c,u){u?o({type:c,callback:u}):i(c)}return{add:n,call:a,remove:s}}function Gi({url:e,token:t,trackingId:r,...n}){return Object.freeze({url:e,token:t,trackingId:r,...!!n.mode&&{mode:n.mode},...!!n.source&&{source:n.source}})}function ph(e){let t=Gi(e);return{get:()=>t,update:r=>{t=Gi({...t,...r})}}}function hh(){let e=typeof window<"u";return{sendMessage(t){e&&window.postMessage(t,"*")}}}var bn=gh();function gh(){let e="coveo_",t=r=>{let n=r.split(".").slice(-2);return n.length==2?n.join("."):""};return{getItem(r){let n=`${e}${r}=`,a=document.cookie.split(";");for(let i of a){let o=i.replace(/^\s+/,"");if(o.lastIndexOf(n,0)===0)return o.substring(n.length,o.length)}return null},setItem(r,n,a){let i=t(window.location.hostname),o=`;expires=${new Date(new Date().getTime()+a).toUTCString()}`,s=i?`;domain=${i}`:"";document.cookie=`${e}${r}=${n}${o}${s};path=/;SameSite=Lax`},removeItem(r){this.setItem(r,"",-1)}}}function mh(){return{getItem(e){return bn.getItem(e)||localStorage.getItem(e)},removeItem(e){bn.removeItem(e),localStorage.removeItem(e)},setItem(e,t){localStorage.setItem(e,t),bn.setItem(e,t,31556952e3)}}}function yh(){let e=document.referrer;return e===""?null:e}function vh(){return{runtime:"browser",send:(e,t,r)=>{let n=navigator.sendBeacon(`${e}?access_token=${t}`,new Blob([JSON.stringify([r])],{type:"application/json"}));if(hh().sendMessage({kind:"EVENT_PROTOCOL",event:r,url:e,token:t}),!n)throw new Error("Failed to send the event(s) because the payload size exceeded the maximum allowed size (32 KB). Please contact support if the problem persists.")},getReferrer:()=>yh(),getLocation:()=>window.location.href,getUserAgent:()=>navigator.userAgent,generateUUID:()=>crypto.randomUUID(),storage:mh()}}function Sh(){return{getItem(){return null},removeItem(){},setItem(){}}}function wh(){return{runtime:"null",send:()=>{},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>"",storage:Sh()}}function bh(e){return e.get().mode!=="disabled"&&Ch()?vh():wh()}function Ch(){try{return typeof window=="object"}catch{return!1}}function Ih(e){return{get:()=>Object.freeze(bh(e))}}function qh(e){let t=ph(e),r=fh(),n=Ih(t),a=sh(n);return{emit:(i,o)=>{let s=t.get(),c=n.get(),u=lh(i,o,s,c,a);return ah({config:s,environment:c,event:u,listenerManager:r})},getMeta:i=>Hs(i,t.get(),n.get(),a),on:(i,o)=>r.add({type:i,callback:o}),off:(i,o)=>r.remove(i,o),updateConfig:i=>t.update(i),version:Ys,clearStorage:()=>{a.clear()}}}var Pa="2.63.4",kh=["@coveo/atomic","@coveo/quantic"],Ws=N(e=>e.source,e=>[`@coveo/headless@${Pa}`].concat(Object.entries(e).map(([t,r])=>`${t}@${r}`))),Xn=N(e=>e.configuration.accessToken,e=>e.configuration.analytics,e=>Ws(e.configuration.analytics),(e,{trackingId:t,nextApiBaseUrl:r,enabled:n},a)=>qh({mode:n?"emit":"disabled",url:r,token:e,trackingId:t,source:a})),Gs=()=>"default",xh=()=>({url:"",clientId:"",additionalFields:[],advancedParameters:{debug:!1},products:[],facets:{results:[]},error:null,isLoading:!1,responseId:""}),Oh=e=>{let t=e.configuration.search.locale.split("-")[0];return!t||t.length!==2?"en":t},Js=class{constructor(e){this.getState=e,this.state=e()}getLanguage(){return Oh(this.state)}getBaseMetadata(){let{context:e,configuration:t}=this.state,r=(e==null?void 0:e.contextValues)||{},n={};for(let[a,i]of Object.entries(r)){let o=`context_${a}`;n[o]=i}return t.analytics.analyticsMode==="legacy"&&(n.coveoHeadlessVersion=Pa),n}getOriginContext(){return this.state.configuration.analytics.originContext}getOriginLevel1(){return this.state.searchHub||Gs()}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3}getIsAnonymous(){return this.state.configuration.analytics.anonymous}};function Ks(){return{desiredCount:5,numberOfValues:8,set:{}}}function Zs(e){let{activeValue:t,ancestryMap:r}=Ah(e);return t?Eh(t,r):[]}function Ah(e){let t=[...e],r=new Map;for(;t.length>0;){let n=t.shift();if(n.state==="selected")return{activeValue:n,ancestryMap:r};if(r)for(let a of n.children)r.set(a,n);t.unshift(...n.children)}return{}}function Eh(e,t){let r=[];if(!e)return[];let n=e;do r.unshift(n),n=t.get(n);while(n);return r}var Rh=(e,t)=>{var r;return(r=e.categoryFacetSet[t])==null?void 0:r.request},Xs=(e,t)=>{let r=Rh(e,t);return Zs((r==null?void 0:r.currentValues)??[])};function ec(){return{}}function Dh(e){return{request:e}}function Ma(){return{}}function Fh(e){return{request:e}}function Ua(){return{}}function Ph(e){return{request:e,hasBreadcrumbs:!0}}function Ta(){return{}}function Mh(e){return{facetSet:e.facetSet??Ta(),categoryFacetSet:e.categoryFacetSet??ec(),dateFacetSet:e.dateFacetSet??Ma(),numericFacetSet:e.numericFacetSet??Ua(),automaticFacetSet:e.automaticFacetSet??Ks()}}var Uh=e=>{let t=[];return $h(e).forEach((r,n)=>{let a=Yh(e,r.facetId),i=Nh(r,n+1);if(jh(r)){if(!Xs(e,r.facetId).length)return;t.push({...i,...Qh(e,r.facetId),facetType:a,state:"selected"});return}r.currentValues.forEach((o,s)=>{if(o.state==="idle")return;let c=Ji(o,s+1,a),u=Th(r)?Ki(o):Vh(o);t.push({...i,...c,...u})})}),Lh(e).forEach((r,n)=>{let a=zh(r,n+1);r.values.forEach((i,o)=>{if(i.state==="idle")return;let s=Ji(i,o+1,"specific"),c=Ki(i);t.push({...a,...s,...c})})}),t},Th=e=>e.type==="specific",jh=e=>e.type==="hierarchical",$h=e=>[...Object.values(e.facetSet),...Object.values(e.categoryFacetSet),...Object.values(e.dateFacetSet),...Object.values(e.numericFacetSet)].map(t=>t.request),Lh=e=>[...Object.values(e.automaticFacetSet.set)].map(t=>t.response),Ji=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),Vh=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),Ki=e=>({displayValue:e.value,value:e.value}),_h=(e,t)=>Xs(e,t).map(r=>r.value).join(";"),Qh=(e,t)=>{let r=_h(e,t);return{value:r,valuePosition:1,displayValue:r}},zh=(e,t)=>({title:tc(e.field,e.field),field:e.field,id:e.field,facetPosition:t}),Nh=(e,t)=>({title:tc(e.field,e.facetId),field:e.field,id:e.facetId,facetPosition:t}),tc=(e,t)=>`${e}_${t}`,Bh=(e,t)=>{var r,n,a,i,o;return((r=e.facetSet[t])==null?void 0:r.request)||((n=e.categoryFacetSet[t])==null?void 0:n.request)||((a=e.dateFacetSet[t])==null?void 0:a.request)||((i=e.numericFacetSet[t])==null?void 0:i.request)||((o=e.automaticFacetSet.set[t])==null?void 0:o.response)},Yh=(e,t)=>{let r=Bh(e,t);return r?r.type:"specific"},Ot=()=>({q:"",enableQuerySyntax:!1});function ea(){return{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}}function Ge(){return{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:ea(),pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],searchResponseId:"",requestId:"",questionAnswer:ea(),extendedResults:{}}}var ja=class extends Js{constructor(){super(...arguments),this.initialState=xh()}getPipeline(){return""}getSearchEventRequestPayload(){return{queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){var e;return((e=this.getState().productListing)==null?void 0:e.responseId)||this.initialState.responseId}mapResultsToAnalyticsDocument(){var e;return(e=this.state.productListing)==null?void 0:e.products.map(t=>({documentUri:t.documentUri,documentUriHash:t.documentUriHash,permanentid:t.permanentid}))}get numberOfResults(){return this.state.productListing.products.length}},Hh=({logger:e,getState:t,analyticsClientMiddleware:r=(i,o)=>o,preprocessRequest:n,provider:a=new ja(t)})=>{let i=t(),o=i.configuration.accessToken,s=i.configuration.analytics.apiBaseUrl,c=i.configuration.analytics.runtimeEnvironment,u=i.configuration.analytics.enabled,l=new Qs({token:o,endpoint:s,runtimeEnvironment:c,preprocessRequest:zs(e,n),beforeSendHooks:[Ns(e,r),(d,p)=>(e.info({...p,type:d,endpoint:s,token:o},"Analytics request"),p)]},a);return u||l.disable(),l},rc=(e=>(e.Ascending="ascending",e.Descending="descending",e))(rc||{}),nc=(e=>(e.Relevancy="relevancy",e.QRE="qre",e.Date="date",e.Field="field",e.NoSort="nosort",e))(nc||{}),ac=e=>{if(os(e))return e.map(t=>ac(t)).join(",");switch(e.by){case"relevancy":case"qre":case"nosort":return e.by;case"date":return`date ${e.order}`;case"field":return`@${e.field} ${e.order}`;default:return""}},Wh=()=>({by:"relevancy"});new M({values:{by:new ut({enum:nc,required:!0}),order:new ut({enum:rc}),field:new E}});function ic(){return ac(Wh())}var oc=class ta extends Js{constructor(){super(...arguments),this.getFacetRequest=t=>{var r,n,a,i,o,s,c,u,l,d;return((n=(r=this.state.facetSet)==null?void 0:r[t])==null?void 0:n.request)||((i=(a=this.state.categoryFacetSet)==null?void 0:a[t])==null?void 0:i.request)||((s=(o=this.state.dateFacetSet)==null?void 0:o[t])==null?void 0:s.request)||((u=(c=this.state.numericFacetSet)==null?void 0:c[t])==null?void 0:u.request)||((d=(l=this.state.automaticFacetSet)==null?void 0:l.set[t])==null?void 0:d.response)}}getFacetState(){return Uh(Mh(this.getState()))}getPipeline(){var t;return this.state.pipeline||((t=this.state.search)==null?void 0:t.response.pipeline)||ta.fallbackPipelineName}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.resultURIs,numberOfResults:this.numberOfResults}}getSearchUID(){var r,n;let t=this.getState();return((r=t.search)==null?void 0:r.searchResponseId)||((n=t.search)==null?void 0:n.response.searchUid)||Ge().response.searchUid}getSplitTestRunName(){var t;return(t=this.state.search)==null?void 0:t.response.splitTestRun}getSplitTestRunVersion(){var n;let t=!!this.getSplitTestRunName(),r=((n=this.state.search)==null?void 0:n.response.pipeline)||this.state.pipeline||ta.fallbackPipelineName;return t?r:void 0}getBaseMetadata(){var a,i,o;let t=this.getState(),r=super.getBaseMetadata(),n=(o=(i=(a=t.search)==null?void 0:a.response)==null?void 0:i.extendedResults)==null?void 0:o.generativeQuestionAnsweringId;return n&&(r.generativeQuestionAnsweringId=n),r}getFacetMetadata(t,r){var a;let n=((a=this.getFacetRequest(t))==null?void 0:a.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:n,facetValue:r,facetTitle:`${n}_${t}`}}getFacetClearAllMetadata(t){var n;let r=((n=this.getFacetRequest(t))==null?void 0:n.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:r,facetTitle:`${r}_${t}`}}getFacetUpdateSortMetadata(t,r){var a;let n=((a=this.getFacetRequest(t))==null?void 0:a.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:n,criteria:r,facetTitle:`${n}_${t}`}}getRangeBreadcrumbFacetMetadata(t,r){var a;let n=((a=this.getFacetRequest(t))==null?void 0:a.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:n,facetRangeEnd:r.end,facetRangeEndInclusive:r.endInclusive,facetRangeStart:r.start,facetTitle:`${n}_${t}`}}getResultSortMetadata(){return{...this.getBaseMetadata(),resultsSortBy:this.state.sortCriteria??ic()}}getStaticFilterToggleMetadata(t,r){return{...this.getBaseMetadata(),staticFilterId:t,staticFilterValue:r}}getStaticFilterClearAllMetadata(t){return{...this.getBaseMetadata(),staticFilterId:t}}getUndoTriggerQueryMetadata(t){return{...this.getBaseMetadata(),undoneQuery:t}}getCategoryBreadcrumbFacetMetadata(t,r){var a;let n=((a=this.getFacetRequest(t))==null?void 0:a.field)??"";return{...this.getBaseMetadata(),categoryFacetId:t,categoryFacetField:n,categoryFacetPath:r,categoryFacetTitle:`${n}_${t}`}}getOmniboxAnalyticsMetadata(t,r){let n=this.state.querySuggest&&this.state.querySuggest[t],a=n.completions.map(c=>c.expression),i=n.partialQueries.length-1,o=n.partialQueries[i]||"",s=n.responseId;return{...this.getBaseMetadata(),suggestionRanking:a.indexOf(r),partialQuery:o,partialQueries:n.partialQueries.length>0?n.partialQueries:"",suggestions:a.length>0?a:"",querySuggestResponseId:s}}getInterfaceChangeMetadata(){return{...this.getBaseMetadata(),interfaceChangeTo:this.state.configuration.analytics.originLevel2}}getOmniboxFromLinkMetadata(t){return{...this.getBaseMetadata(),...t}}getGeneratedAnswerMetadata(){var n;let t=this.getState(),r={};return((n=t.generatedAnswer)==null?void 0:n.isVisible)!==void 0&&(r.showGeneratedAnswer=t.generatedAnswer.isVisible),r}get resultURIs(){var t;return(t=this.results)==null?void 0:t.map(r=>({documentUri:r.uri,documentUriHash:r.raw.urihash}))}get results(){var t;return(t=this.state.search)==null?void 0:t.response.results}get queryText(){var t;return((t=this.state.query)==null?void 0:t.q)||Ot().q}get responseTime(){var t;return((t=this.state.search)==null?void 0:t.duration)||Ge().duration}get numberOfResults(){var t;return((t=this.state.search)==null?void 0:t.response.totalCountFiltered)||Ge().response.totalCountFiltered}};oc.fallbackPipelineName="default";var tn=oc,Gh=({logger:e,getState:t,analyticsClientMiddleware:r=(i,o)=>o,preprocessRequest:n,provider:a=new tn(t)})=>{let i=t(),o=i.configuration.accessToken,s=i.configuration.analytics.apiBaseUrl,c=i.configuration.analytics.runtimeEnvironment,u=i.configuration.analytics.enabled,l=new Qs({token:o,endpoint:s,runtimeEnvironment:c,preprocessRequest:zs(e,n),beforeSendHooks:[Ns(e,r),(d,p)=>(e.info({...p,type:d,endpoint:s,token:o},"Analytics request"),p)]},a);return u||l.disable(),l},Zi=()=>{let e=xt.getHistory().reverse().find(t=>t.name==="PageView"&&t.value);return e?e.value:""},Jh=()=>"";function Kh(e,t){return{...new tn(t).getBaseMetadata(),actionCause:e,type:e}}function Zh(e){return Object.assign(e,{instantlyCallable:!0})}function Xh(e,t){let r=a=>Zh(V(e,a)),n=r(async(a,{getState:i,extra:o})=>{let{analyticsClientMiddleware:s,preprocessRequest:c,logger:u}=o;return await(await t({getState:i,analyticsClientMiddleware:s,preprocessRequest:c,logger:u})).log({state:i(),extra:o})});return Object.assign(n,{prepare:async({getState:a,analyticsClientMiddleware:i,preprocessRequest:o,logger:s})=>{let{description:c,log:u}=await t({getState:a,analyticsClientMiddleware:i,preprocessRequest:o,logger:s});return{description:c,action:r(async(l,{getState:d,extra:p})=>await u({state:d(),extra:p}))}}}),n}var sc=(e,t,r)=>{function n(...a){let i=a.length===1?{...a[0],__legacy__getBuilder:t(a[0].__legacy__getBuilder),analyticsConfigurator:e,providerClass:r}:{prefix:a[0],__legacy__getBuilder:t(a[1]),__legacy__provider:a[2],analyticsConfigurator:e,providerClass:r};return rg(i)}return n},eg=e=>e.configuration.analytics.analyticsMode==="legacy",tg=e=>e.configuration.analytics.analyticsMode==="next",rg=({prefix:e,__legacy__getBuilder:t,__legacy__provider:r,analyticsPayloadBuilder:n,analyticsType:a,analyticsConfigurator:i,providerClass:o})=>(r??(r=s=>new o(s)),Xh(e,async({getState:s,analyticsClientMiddleware:c,preprocessRequest:u,logger:l})=>{let d=[],p={log:async({state:C})=>{for(let k of d)await k(C)}},g=s(),b=i({getState:s,logger:l,analyticsClientMiddleware:c,preprocessRequest:u,provider:r(s)}),f=await t(b,s());p.description=f==null?void 0:f.description,d.push(async C=>{eg(C)&&await ng(f,r,C,l,b.coveoAnalyticsClient)});let{emit:m}=Xn(g);return d.push(async C=>{if(tg(C)&&a&&n){let k=n(C);await og(m,a,k)}}),p}));async function ng(e,t,r,n,a){t(()=>r);let i=await(e==null?void 0:e.log({searchUID:t(()=>r).getSearchUID()}));n.info({client:a,response:i},"Analytics response")}var At=sc(Gh,e=>e,tn),ag=sc(Hh,e=>e,ja),ig={urihash:new E,sourcetype:new E,permanentid:new E};new M({values:ig}),new E({required:!1,emptyAllowed:!0});async function og(e,t,r){await e(t,r)}var Xi=()=>At("search/logFetchMoreResults",e=>e.makeFetchMoreResults()),xe=e=>At("search/queryError",(t,r)=>{var n,a,i,o;return t.makeQueryError({query:((n=r.query)==null?void 0:n.q)||Ot().q,aq:((a=r.advancedSearchQueries)==null?void 0:a.aq)||Cr().aq,cq:((i=r.advancedSearchQueries)==null?void 0:i.cq)||Cr().cq,dq:((o=r.advancedSearchQueries)==null?void 0:o.dq)||Cr().dq,errorType:e.type,errorMessage:e.message})}),rn=(e=>(e.Relevance="relevance",e.Fields="fields",e))(rn||{}),$a=(e=>(e.Ascending="asc",e.Descending="desc",e))($a||{}),ra=()=>({by:"relevance"});new M({options:{required:!1},values:{by:new ut({enum:rn,required:!0}),fields:new ce({each:new M({values:{name:new E,direction:new ut({enum:$a})}})})}});var sg=()=>ag("analytics/productListing/load",e=>e.makeInterfaceLoad(),e=>new ja(e));w("productlisting/setUrl",e=>q(e,{url:new E({required:!0,url:!0})}));w("productlisting/setAdditionalFields",e=>q(e,{additionalFields:new ce({required:!0,each:new E({required:!0,emptyAllowed:!1})})}));var nn=V("productlisting/fetch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t(),{apiClient:o}=a,s=await o.getProducts(await cg(i));return Me(s)?(r(xe(s.error)),n(s.error)):{response:s.success,analyticsAction:sg()}}),cg=async e=>{var n,a,i;let t=lg(e),r=await rt(e.configuration.analytics);return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,platformUrl:e.configuration.platformUrl,url:(n=e.productListing)==null?void 0:n.url,...e.configuration.analytics.enabled&&r?{clientId:r}:{},...(a=e.productListing.additionalFields)!=null&&a.length?{additionalFields:e.productListing.additionalFields}:{},...e.productListing.advancedParameters&&ug(e.productListing.advancedParameters)?{advancedParameters:e.productListing.advancedParameters||{}}:{},...t.length&&{facets:{requests:t}},...e.pagination&&{pagination:{numberOfValues:e.pagination.numberOfResults,page:Math.ceil(e.pagination.firstResult/(e.pagination.numberOfResults||1))+1}},...(((i=e.sort)==null?void 0:i.by)||"relevance")!=="relevance"&&{sort:e.sort},...e.context&&{userContext:e.context.contextValues}}};function ug(e){return e.debug}function lg(e){return Bs(dg(e),e.facetOrder??[])}function dg(e){return[...ot(e.facetSet??{}),...ot(e.numericFacetSet??{}),...ot(e.dateFacetSet??{}),...ot(e.categoryFacetSet??{})]}var cc={q:new E,enableQuerySyntax:new J,aq:new E,cq:new E,firstResult:new j({min:0}),numberOfResults:new j({min:0}),sortCriteria:new E,f:new M,fExcluded:new M,cf:new M,nf:new M,df:new M,debug:new J,sf:new M,tab:new E,af:new M},nt=w("searchParameters/restore",e=>q(e,cc)),er=w("facet/updateFacetAutoSelection",e=>q(e,{allow:new J({required:!0})})),fg=class extends tn{constructor(e){super(e),this.getState=e}get activeInstantResultQuery(){let e=this.getState().instantResults;for(let t in e)for(let r in e[t].cache)if(e[t].cache[r].isActive)return e[t].q;return null}get activeInstantResultCache(){let e=this.getState().instantResults;for(let t in e)for(let r in e[t].cache)if(e[t].cache[r].isActive)return e[t].cache[r];return null}get results(){var e;return(e=this.activeInstantResultCache)==null?void 0:e.results}get queryText(){return this.activeInstantResultQuery??Ot().q}get responseTime(){var e;return((e=this.activeInstantResultCache)==null?void 0:e.duration)??Ge().duration}get numberOfResults(){var e;return((e=this.activeInstantResultCache)==null?void 0:e.totalCountFiltered)??Ge().response.totalCountFiltered}getSearchUID(){var e;return((e=this.activeInstantResultCache)==null?void 0:e.searchUid)||super.getSearchUID()}},pg=()=>At("analytics/instantResult/searchboxAsYouType",e=>e.makeSearchboxAsYouType(),e=>new fg(e)),hg=()=>({actionCause:"searchboxAsYouType"}),La={id:F},gg={...La,q:Pe};w("instantResults/register",e=>q(e,La));var uc=w("instantResults/updateQuery",e=>q(e,gg));w("instantResults/clearExpired",e=>q(e,La));var an=new j({required:!0,min:0}),mg=w("pagination/registerNumberOfResults",e=>q(e,an)),yg=w("pagination/updateNumberOfResults",e=>q(e,an)),vg=w("pagination/registerPage",e=>q(e,an)),tr=w("pagination/updatePage",e=>q(e,an)),Sg=w("pagination/nextPage"),wg=w("pagination/previousPage"),rr=w("query/updateQuery",e=>q(e,{q:new E,enableQuerySyntax:new J})),on=async(e,t)=>{let r=e.analyticsMode==="next",n=e.originLevel3==="default";return{analytics:{clientId:await rt(e),clientTimestamp:new Date().toISOString(),documentReferrer:r&&n?null:e.originLevel3,originContext:e.originContext,...t&&{actionCause:t.actionCause,customData:t.customData},...t&&!r&&{customData:t.customData},...e.userDisplayName&&{userDisplayName:e.userDisplayName},...e.documentLocation&&{documentLocation:e.documentLocation},...e.deviceId&&{deviceId:e.deviceId},...Zi()&&{pageId:Zi()},...r&&e.trackingId&&{trackingId:e.trackingId},capture:r,...r&&{source:Ws(e)}}}},lc=async(e,t)=>{var r,n,a,i;return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await rt(e.configuration.analytics),actionsHistory:xt.getHistory()},...((r=e.advancedSearchQueries)==null?void 0:r.aq)&&{aq:e.advancedSearchQueries.aq},...((n=e.advancedSearchQueries)==null?void 0:n.cq)&&{cq:e.advancedSearchQueries.cq},...((a=e.advancedSearchQueries)==null?void 0:a.lq)&&{lq:e.advancedSearchQueries.lq},...((i=e.advancedSearchQueries)==null?void 0:i.dq)&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await on(e.configuration.analytics,t),...e.excerptLength&&!z(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}}},dc=async(e,t)=>{var r,n,a,i;return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await rt(e.configuration.analytics),actionsHistory:xt.getHistory()},...((r=e.advancedSearchQueries)==null?void 0:r.aq)&&{aq:e.advancedSearchQueries.aq},...((n=e.advancedSearchQueries)==null?void 0:n.cq)&&{cq:e.advancedSearchQueries.cq},...((a=e.advancedSearchQueries)==null?void 0:a.lq)&&{lq:e.advancedSearchQueries.lq},...((i=e.advancedSearchQueries)==null?void 0:i.dq)&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await on(e.configuration.analytics,t),...e.excerptLength&&!z(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}}},Ir=Ae(ga()),bg=Ae(Rl()),na=Ae(ga()),Cg=Ae(Dl());na.default.extend(Cg.default);var fc="YYYY/MM/DD@HH:mm:ss",Ig="1401-01-01";function Vr(e,t){let r=(0,na.default)(e,t);return!r.isValid()&&!t?(0,na.default)(e,fc):r}function pc(e){return e.format(fc)}function qg(e,t){let r=Vr(e,t);if(!r.isValid()){let n=". Please provide a date format string in the configuration options. See https://day.js.org/docs/en/parse/string-format for more information.",a=` with the format "${t}"`;throw new Error(`Could not parse the provided date "${e}"${t?a:n}`)}hc(r)}function hc(e){if(e.isBefore(Ig))throw new Error(`Date is before year 1401, which is unsupported by the API: ${e}`)}Ir.default.extend(bg.default);var gc=["past","now","next"],mc=["minute","hour","day","week","month","quarter","year"],kg=e=>{let t=e==="now";return{amount:new j({required:!t,min:1}),unit:new E({required:!t,constrainTo:mc}),period:new E({required:!0,constrainTo:gc})}};function eo(e){if(typeof e=="string"&&!Wt(e))throw new Error(`The value "${e}" is not respecting the relative date format "period-amount-unit"`);let t=typeof e=="string"?Sc(e):e;new he(kg(t.period)).validate(t);let r=yc(t),n=JSON.stringify(t);if(!r.isValid())throw new Error(`Date is invalid: ${n}`);hc(r)}function xg(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":case"next":return`${t}-${r}-${n}`;case"now":return t}}function yc(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":return(0,Ir.default)().subtract(r,n);case"next":return(0,Ir.default)().add(r,n);case"now":return(0,Ir.default)()}}function aa(e){return pc(yc(Sc(e)))}function vc(e){return e.toLocaleLowerCase().split("-")}function Wt(e){let[t,r,n]=vc(e);if(t==="now")return!0;if(!gc.includes(t)||!mc.includes(n))return!1;let a=parseInt(r);return!(isNaN(a)||a<=0)}function Og(e){return!!e&&typeof e=="object"&&"period"in e}function Sc(e){let[t,r,n]=vc(e);return t==="now"?{period:"now"}:{period:t,amount:r?parseInt(r):void 0,unit:n||void 0}}function Ag(e){return e.type==="dateRange"}function wc(e){return`start${e}`}function bc(e){return`end${e}`}var Eg=()=>({dateFacetValueMap:{}});function Rg(e,t,r){let n=e.start,a=e.end;return Wt(n)&&(n=aa(n),r.dateFacetValueMap[t][wc(n)]=e.start),Wt(a)&&(a=aa(a),r.dateFacetValueMap[t][bc(a)]=e.end),{...e,start:n,end:a}}function Dg(e,t){if(Ag(e)){let{facetId:r,currentValues:n}=e;return t.dateFacetValueMap[r]={},{...e,currentValues:n.map(a=>Rg(a,r,t))}}return e}function Va(e){var r;let t=Eg();return{request:{...e,facets:(r=e.facets)==null?void 0:r.map(n=>Dg(n,t))},mappings:t}}function Fg(e,t,r){return{...e,start:r.dateFacetValueMap[t][wc(e.start)]||e.start,end:r.dateFacetValueMap[t][bc(e.end)]||e.end}}function Pg(e,t){return e.facetId in t.dateFacetValueMap}function Mg(e,t){return Pg(e,t)?{...e,values:e.values.map(r=>Fg(r,e.facetId,t))}:e}function Cc(e,t){var r;return"success"in e?{success:{...e.success,facets:(r=e.success.facets)==null?void 0:r.map(n=>Mg(n,t))}}:e}var Ce=async(e,t)=>{var s;let r=_g(e),n=Ug(e),a=Tg(e),i=e.configuration.analytics.analyticsMode==="legacy"?await dc(e,t):await lc(e,t),o=()=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0;return Va({...i,...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="next",options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="legacy"},...r&&{cq:r},...n.length&&{facets:n},...e.pagination&&{numberOfResults:o(),firstResult:e.pagination.firstResult},...e.facetOptions&&{facetOptions:{freezeFacetOrder:e.facetOptions.freezeFacetOrder}},...((s=e.folding)==null?void 0:s.enabled)&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.automaticFacetSet&&{generateAutomaticFacets:{desiredCount:e.automaticFacetSet.desiredCount,numberOfValues:e.automaticFacetSet.numberOfValues,currentFacets:a}},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})};function Ug(e){return Bs($g(e),e.facetOrder??[])}function Tg(e){var r;let t=(r=e.automaticFacetSet)==null?void 0:r.set;return t?Object.values(t).map(n=>n.response).map(jg).filter(n=>n.currentValues.length>0):void 0}function jg(e){let{field:t,label:r,values:n}=e,a=n.filter(i=>i.state==="selected");return{field:t,label:r,currentValues:a}}function $g(e){return Lg(e).filter(({facetId:t})=>{var r,n;return((n=(r=e.facetOptions)==null?void 0:r.facets[t])==null?void 0:n.enabled)??!0})}function Lg(e){return[...Vg(e.facetSet??{}),...to(e.numericFacetSet??{}),...to(e.dateFacetSet??{}),...ot(e.categoryFacetSet??{})]}function Vg(e){return ot(e).map(t=>t.sortCriteria==="alphanumericDescending"?{...t,sortCriteria:{type:"alphanumeric",order:"descending"}}:t)}function to(e){return ot(e).map(t=>{let r=t.currentValues.some(({state:n})=>n!=="idle");return t.generateAutomaticRanges&&!r?{...t,currentValues:[]}:t})}function _g(e){var a,i;let t=((a=e.advancedSearchQueries)==null?void 0:a.cq.trim())||"",r=((i=Object.values(e.tabSet||{}).find(o=>o.isActive))==null?void 0:i.expression.trim())||"",n=Qg(e);return[t,r,...n].filter(o=>!!o).join(" AND ")}function Qg(e){return Object.values(e.staticFilterSet||{}).map(t=>{let r=t.values.filter(a=>a.state==="selected"&&!!a.expression.trim()),n=r.map(a=>a.expression).join(" OR ");return r.length>1?`(${n})`:n})}var zg=e=>/^https:\/\/platform(dev|stg|hipaa)?(-)?(eu|au)?\.cloud\.coveo\.com/.test(e),Ng=(e,t)=>{let r=Ic(e);return r&&r.organizationId===t?r:null},Ic=e=>{let t=e.match(/^https:\/\/(?<organizationId>\w+)\.org(?<environment>dev|stg|hipaa)?\.coveo\.com/);return t!=null&&t.groups?t.groups:null},qc=e=>e.success!==void 0,Je=e=>e.error!==void 0;w("didYouMean/enable");w("didYouMean/disable");w("didYouMean/automaticCorrections/disable");w("didYouMean/automaticCorrections/enable");var _a=w("didYouMean/correction",e=>q(e,F));w("didYouMean/automaticCorrections/mode",e=>q(e,new E({constrainTo:["next","legacy"],emptyAllowed:!1,required:!0})));var ro=()=>At("analytics/didyoumean/automatic",e=>e.makeDidYouMeanAutomatic()),Bg=()=>({actionCause:"didyoumeanAutomatic"});function Yg(){return{contextValues:{}}}var Hg=()=>!1;function Wg(){return{contextValues:{}}}function Tt(){return{enabled:!0}}function kc(){return{freezeFacetOrder:!1,facets:{}}}function xc(){return[]}function Qa(){return{firstResult:0,defaultNumberOfResults:10,numberOfResults:10,totalCountFiltered:0}}function Oc(){return{}}function Gg(){return{}}function Jg(){return{}}function We(e){return{context:e.context||Yg(),dictionaryFieldContext:e.dictionaryFieldContext||Wg(),facetSet:e.facetSet||Ta(),numericFacetSet:e.numericFacetSet||Ua(),dateFacetSet:e.dateFacetSet||Ma(),categoryFacetSet:e.categoryFacetSet||ec(),automaticFacetSet:e.automaticFacetSet??Ks(),pagination:e.pagination||Qa(),query:e.query||Ot(),tabSet:e.tabSet||Jg(),advancedSearchQueries:e.advancedSearchQueries||Cr(),staticFilterSet:e.staticFilterSet||Gg(),querySet:e.querySet||Oc(),sortCriteria:e.sortCriteria||ic(),pipeline:e.pipeline||Jh(),searchHub:e.searchHub||Gs(),facetOptions:e.facetOptions||kc(),facetOrder:e.facetOrder??xc(),debug:e.debug??Hg()}}new M({values:{undoneQuery:Pe},options:{required:!0}});var Kg=()=>At("analytics/trigger/query",(e,t)=>{var r;return(r=t.triggers)!=null&&r.queryModification.newQuery?e.makeTriggerQuery():null}),Ac=w("trigger/query/ignore",e=>q(e,new E({emptyAllowed:!0,required:!0}))),Ec=w("trigger/query/modification",e=>q(e,new M({values:{originalQuery:te,modification:te}}))),nr=class{constructor(e,t=r=>{this.dispatch(rr({q:r}))}){this.config=e,this.onUpdateQueryForCorrection=t}async fetchFromAPI({mappings:e,request:t},r){var s;let n=new Date().getTime(),a=Cc(await this.extra.apiClient.search(t,r),e),i=new Date().getTime()-n,o=((s=this.getState().query)==null?void 0:s.q)||"";return{response:a,duration:i,queryExecuted:o,requestExecuted:t}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return Je(e.response)?(this.dispatch(xe(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:a}=t.didYouMean,{results:i,queryCorrections:o,queryCorrection:s}=r;if(!n||!a)return null;let c=i.length===0&&o&&o.length!==0,u=!z(s)&&!z(s.correctedQuery);if(!c&&!u)return null;let l=c?await this.processLegacyDidYouMeanAutoCorrection(e):this.processModernDidYouMeanAutoCorrection(e);return this.dispatch(He(We(this.getState()))),l}async processLegacyDidYouMeanAutoCorrection(e){let t=this.getCurrentQuery(),r=this.getSuccessResponse(e);if(!r.queryCorrections)return null;let{correctedQuery:n}=r.queryCorrections[0],a=await this.automaticallyRetryQueryWithCorrection(n);return Je(a.response)?(this.dispatch(xe(a.response.error)),this.rejectWithValue(a.response.error)):(this.logOriginalAnalyticsQueryBeforeAutoCorrection(e),this.dispatch(He(We(this.getState()))),{...a,response:{...a.response.success,queryCorrections:r.queryCorrections},automaticallyCorrected:!0,originalQuery:t,analyticsAction:ro()})}processModernDidYouMeanAutoCorrection(e){let t=this.getSuccessResponse(e),{correctedQuery:r,originalQuery:n}=t.queryCorrection;return this.onUpdateQueryForCorrection(r),{...e,response:{...t},queryExecuted:r,automaticallyCorrected:!0,originalQuery:n,analyticsAction:ro()}}logOriginalAnalyticsQueryBeforeAutoCorrection(e){let t=this.getState(),r=this.getSuccessResponse(e);this.analyticsAction&&this.analyticsAction()(this.dispatch,()=>this.getStateAfterResponse(e.queryExecuted,e.duration,t,r),this.extra)}async processQueryTriggersOrContinue(e){var i,o;let t=this.getSuccessResponse(e);if(!t)return null;let r=((i=t.triggers.find(s=>s.type==="query"))==null?void 0:i.content)||"";if(!r)return null;if(((o=this.getState().triggers)==null?void 0:o.queryModification.queryToIgnore)===r)return this.dispatch(Ac("")),null;this.analyticsAction&&await this.dispatch(this.analyticsAction);let n=this.getCurrentQuery(),a=await this.automaticallyRetryQueryWithTriggerModification(r);return Je(a.response)?(this.dispatch(xe(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(He(We(this.getState()))),{...a,response:{...a.response.success},automaticallyCorrected:!1,originalQuery:n,analyticsAction:Kg()})}getStateAfterResponse(e,t,r,n){var a;return{...r,query:{q:e,enableQuerySyntax:((a=r.query)==null?void 0:a.enableQuerySyntax)??Ot().enableQuerySyntax},search:{...Ge(),duration:t,response:n,results:n.results}}}processSuccessResponse(e){return this.dispatch(He(We(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(e){return qc(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let t=await this.fetchFromAPI(await Ce(this.getState()),{origin:"mainSearch"});return this.dispatch(_a(e)),t}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(Ec({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await Ce(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){var t;let e=this.getState();return((t=e.query)==null?void 0:t.q)!==void 0?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get analyticsAction(){return this.config.analyticsAction}get rejectWithValue(){return this.config.rejectWithValue}};V("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;q(e,{q:new E,enableQuerySyntax:new J,clearFilters:new J}),e.clearFilters&&(r(Ve()),r(Kr())),r(er({allow:!0})),r(rr({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(tr(1))});var Cn=V("search/executeSearch",async(e,t)=>{let r=t.getState();return await za(r,t,e)}),In=V("search/fetchPage",async(e,t)=>{let r=t.getState();return await Fc(r,t,e)}),qn=V("search/fetchMoreResults",async(e,t)=>{let r=t.getState();return await Pc(t,r)}),Zg=V("search/fetchFacetValues",async(e,t)=>{let r=t.getState();return await rm(t,e,r)});V("search/fetchInstantResults",async(e,t)=>Dc(e,t));var Xg=async(e,t)=>{var n,a;let r=await Ce(e,t);return r.request={...r.request,firstResult:(((n=e.pagination)==null?void 0:n.firstResult)??0)+(((a=e.search)==null?void 0:a.results.length)??0)},r},em=async(e,t,r)=>{let n=await dc(e);return Va({...n,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},tm=async(e,t)=>{let r=await Ce(e,t);return r.request.numberOfResults=0,r},Rc=e=>{var t;e.configuration.analytics.enabled&&xt.addElement({name:"Query",...((t=e.query)==null?void 0:t.q)&&{value:e.query.q},time:JSON.stringify(new Date)})};async function Dc(e,t){q(e,{id:F,q:F,maxResultsPerQuery:new j({required:!0,min:1}),cacheTimeout:new j});let{q:r,maxResultsPerQuery:n}=e,a=t.getState(),i=new nr({...t,analyticsAction:pg()},u=>{t.dispatch(uc({q:u,id:e.id}))}),o=await em(a,r,n),s=await i.fetchFromAPI(o,{origin:"instantResults",disableAbortWarning:!0}),c=await i.process(s);return"response"in c?{results:c.response.results,searchUid:c.response.searchUid,analyticsAction:c.analyticsAction,totalCountFiltered:c.response.totalCountFiltered,duration:c.duration}:c}async function Fc(e,t,r){Rc(e);let{analyticsClientMiddleware:n,preprocessRequest:a,logger:i}=t.extra,{description:o}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:i}),s=new nr({...t,analyticsAction:r}),c=await Ce(e,o),u=await s.fetchFromAPI(c,{origin:"mainSearch"});return await s.process(u)}async function Pc(e,t){let{analyticsClientMiddleware:r,preprocessRequest:n,logger:a}=e.extra,{description:i}=await Xi().prepare({getState:()=>e.getState(),analyticsClientMiddleware:r,preprocessRequest:n,logger:a}),o=new nr({...e,analyticsAction:Xi()}),s=await Xg(t,i),c=await o.fetchFromAPI(s,{origin:"mainSearch"});return await o.process(c)}async function rm(e,t,r){let{analyticsClientMiddleware:n,preprocessRequest:a,logger:i}=e.extra,{description:o}=await t.prepare({getState:()=>e.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:i}),s=new nr({...e,analyticsAction:t}),c=await tm(r,o),u=await s.fetchFromAPI(c,{origin:"facetValues"});return await s.process(u)}async function za(e,t,r){Rc(e);let{analyticsClientMiddleware:n,preprocessRequest:a,logger:i}=t.extra,{description:o}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:i}),s=await Ce(e,o),c=new nr({...t,analyticsAction:r}),u=await c.fetchFromAPI(s,{origin:"mainSearch"});return await c.process(u)}var ar=class{constructor(e,t=r=>{this.dispatch(rr({q:r}))}){this.config=e,this.onUpdateQueryForCorrection=t}async fetchFromAPI({mappings:e,request:t},r){var s;let n=new Date().getTime(),a=Cc(await this.extra.apiClient.search(t,r),e),i=new Date().getTime()-n,o=((s=this.getState().query)==null?void 0:s.q)||"";return{response:a,duration:i,queryExecuted:o,requestExecuted:t}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return Je(e.response)?(this.dispatch(xe(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:a}=t.didYouMean,{results:i,queryCorrections:o,queryCorrection:s}=r;if(!n||!a)return null;let c=i.length===0&&o&&o.length!==0,u=!z(s)&&!z(s.correctedQuery);if(!c&&!u)return null;let l=c?await this.processLegacyDidYouMeanAutoCorrection(e):this.processModernDidYouMeanAutoCorrection(e);return this.dispatch(He(We(this.getState()))),l}async processLegacyDidYouMeanAutoCorrection(e){let t=this.getCurrentQuery(),r=this.getSuccessResponse(e);if(!r.queryCorrections)return null;let{correctedQuery:n}=r.queryCorrections[0],a=await this.automaticallyRetryQueryWithCorrection(n);return Je(a.response)?(this.dispatch(xe(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(He(We(this.getState()))),{...a,response:{...a.response.success,queryCorrections:r.queryCorrections},automaticallyCorrected:!0,originalQuery:t})}processModernDidYouMeanAutoCorrection(e){let t=this.getSuccessResponse(e),{correctedQuery:r,originalQuery:n}=t.queryCorrection;return this.onUpdateQueryForCorrection(r),{...e,response:{...t},queryExecuted:r,automaticallyCorrected:!0,originalQuery:n}}async processQueryTriggersOrContinue(e){var i,o;let t=this.getSuccessResponse(e);if(!t)return null;let r=((i=t.triggers.find(s=>s.type==="query"))==null?void 0:i.content)||"";if(!r)return null;if(((o=this.getState().triggers)==null?void 0:o.queryModification.queryToIgnore)===r)return this.dispatch(Ac("")),null;let n=this.getCurrentQuery(),a=await this.automaticallyRetryQueryWithTriggerModification(r);return Je(a.response)?(this.dispatch(xe(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(He(We(this.getState()))),{...a,response:{...a.response.success},automaticallyCorrected:!1,originalQuery:n})}processSuccessResponse(e){return this.dispatch(He(We(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery()}}getSuccessResponse(e){return qc(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let t=this.getState(),{actionCause:r}=Bg(),n=await this.fetchFromAPI(await Ce(t,{actionCause:r}),{origin:"mainSearch"});return this.dispatch(_a(e)),n}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(Ec({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await Ce(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){var t;let e=this.getState();return((t=e.query)==null?void 0:t.q)!==void 0?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}};V("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;q(e,{q:new E,enableQuerySyntax:new J,clearFilters:new J}),e.clearFilters&&(r(Ve()),r(Kr())),r(er({allow:!0})),r(rr({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(tr(1))});var De=V("search/executeSearch",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return za(r,t,e.legacy);Mc(r);let n=Na(e.next),a=await Ce(r,n),i=new ar({...t,analyticsAction:n}),o=await i.fetchFromAPI(a,{origin:"mainSearch"});return await i.process(o)});V("search/fetchPage",async(e,t)=>{let r=t.getState();if(Mc(r),r.configuration.analytics.analyticsMode==="legacy"||!e.next)return Fc(r,t,e.legacy);let n=new ar({...t,analyticsAction:e.next}),a=await Ce(r,e.next),i=await n.fetchFromAPI(a,{origin:"mainSearch"});return await n.process(i)});V("search/fetchMoreResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return Pc(t,r);let n=Kh("pagerScrolling",t.getState),a=new ar({...t,analyticsAction:n}),i=await am(r,n),o=await a.fetchFromAPI(i,{origin:"mainSearch"});return await a.process(o)});var nm=V("search/fetchFacetValues",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return za(r,t,e.legacy);let n=Na(e.next),a=new ar({...t,analyticsAction:n}),i=await om(r,n),o=await a.fetchFromAPI(i,{origin:"facetValues"});return await a.process(o)});V("search/fetchInstantResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return Dc(e,t);q(e,{id:F,q:F,maxResultsPerQuery:new j({required:!0,min:1}),cacheTimeout:new j});let{q:n,maxResultsPerQuery:a}=e,i=Na(hg()),o=await im(r,n,a,i),s=new ar({...t,analyticsAction:i},l=>{t.dispatch(uc({q:l,id:e.id}))}),c=await s.fetchFromAPI(o,{origin:"instantResults",disableAbortWarning:!0}),u=await s.process(c);return"response"in u?{results:u.response.results,searchUid:u.response.searchUid,totalCountFiltered:u.response.totalCountFiltered,duration:u.duration}:u});var am=async(e,t)=>{var n,a;let r=await Ce(e,t);return r.request={...r.request,firstResult:(((n=e.pagination)==null?void 0:n.firstResult)??0)+(((a=e.search)==null?void 0:a.results.length)??0)},r},im=async(e,t,r,n)=>{let a=await lc(e,n);return Va({...a,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},om=async(e,t)=>{let r=await Ce(e,t);return r.request.numberOfResults=0,r},Mc=e=>{var t;e.configuration.analytics.enabled&&xt.addElement({name:"Query",...((t=e.query)==null?void 0:t.q)&&{value:e.query.q},time:JSON.stringify(new Date)})},Na=e=>({actionCause:e.actionCause,type:e.actionCause});function Ba(e,t){var i;let{facetId:r,criterion:n}=t,a=(i=e[r])==null?void 0:i.request;a&&(a.sortCriteria=n)}function pr(e){e&&(e.currentValues=e.currentValues.map(t=>({...t,state:"idle"})),e.preventAutoSelect=!0)}function Uc(e,t){e&&(e.numberOfValues=t)}Z(Ta(),e=>{e.addCase(Os,(t,r)=>{let{facetId:n}=r.payload;n in t||(t[n]=Ph(cm(r.payload)))}).addCase(Ue.fulfilled,(t,r)=>{if(r.payload&&Object.keys(r.payload.facetSet).length!==0)return r.payload.facetSet}).addCase(nt,(t,r)=>{let n=r.payload.f||{},a=r.payload.fExcluded||{};Object.keys(t).forEach(i=>{let{request:o}=t[i],s=n[i]||[],c=a[i]||[],u=s.length+c.length,l=o.currentValues.filter(d=>!s.includes(d.value)&&!c.includes(d.value));o.currentValues=[...s.map(no),...c.map(ao),...l.map(um)],o.preventAutoSelect=u>0,o.numberOfValues=Math.max(u,o.numberOfValues)})}).addCase(qt,(t,r)=>{var c;let{facetId:n,selection:a}=r.payload,i=(c=t[n])==null?void 0:c.request;if(!i)return;i.preventAutoSelect=!0;let o=i.currentValues.find(u=>u.value===a.value);if(!o){hr(i,a);return}let s=o.state==="selected";o.state=s?"idle":"selected",i.freezeCurrentValues=!0}).addCase(kt,(t,r)=>{var c;let{facetId:n,selection:a}=r.payload,i=(c=t[n])==null?void 0:c.request;if(!i)return;i.preventAutoSelect=!0;let o=i.currentValues.find(u=>u.value===a.value);if(!o){hr(i,a);return}let s=o.state==="excluded";o.state=s?"idle":"excluded",i.freezeCurrentValues=!0}).addCase(Df,(t,r)=>{var o;let{facetId:n,freezeCurrentValues:a}=r.payload,i=(o=t[n])==null?void 0:o.request;i&&(i.freezeCurrentValues=a)}).addCase(Re,(t,r)=>{var n;pr((n=t[r.payload])==null?void 0:n.request)}).addCase(Ve,t=>{Object.values(t).filter(r=>r.hasBreadcrumbs).forEach(({request:r})=>pr(r))}).addCase(Kr,t=>{Object.values(t).filter(r=>!r.hasBreadcrumbs).forEach(({request:r})=>pr(r))}).addCase(er,(t,r)=>Object.values(t).forEach(n=>{n.request.preventAutoSelect=!r.payload.allow})).addCase(Rf,(t,r)=>{Ba(t,r.payload)}).addCase(Mr,(t,r)=>{var i;let{facetId:n,numberOfValues:a}=r.payload;Uc((i=t[n])==null?void 0:i.request,a)}).addCase(Ur,(t,r)=>{var o;let{facetId:n,isFieldExpanded:a}=r.payload,i=(o=t[n])==null?void 0:o.request;i&&(i.isFieldExpanded=a)}).addCase(De.fulfilled,(t,r)=>{r.payload.response.facets.forEach(n=>{var a;return kn((a=t[n.facetId])==null?void 0:a.request,n)})}).addCase(nn.fulfilled,(t,r)=>{var n,a;(((a=(n=r.payload.response)==null?void 0:n.facets)==null?void 0:a.results)||[]).forEach(i=>{var o;return kn((o=t[i.facetId])==null?void 0:o.request,i)})}).addCase(nm.fulfilled,(t,r)=>{r.payload.response.facets.forEach(n=>{var a;return kn((a=t[n.facetId])==null?void 0:a.request,n)})}).addCase(Yt,(t,r)=>{var l;let{facetId:n,value:a}=r.payload,i=(l=t[n])==null?void 0:l.request;if(!i)return;let{rawValue:o}=a,{currentValues:s}=i,c=s.find(d=>d.value===o);if(c){c.state="selected";return}let u=no(o);hr(i,u),i.freezeCurrentValues=!0,i.preventAutoSelect=!0}).addCase(Ht,(t,r)=>{var l;let{facetId:n,value:a}=r.payload,i=(l=t[n])==null?void 0:l.request;if(!i)return;let{rawValue:o}=a,{currentValues:s}=i,c=s.find(d=>d.value===o);if(c){c.state="excluded";return}let u=ao(o);hr(i,u),i.freezeCurrentValues=!0,i.preventAutoSelect=!0}).addCase(Xr,(t,r)=>{if(!(r.payload in t))return;let{request:n}=t[r.payload];pr(n)})});function hr(e,t){let{currentValues:r}=e,n=r.findIndex(s=>s.state==="idle"),a=n===-1?r.length:n,i=r.slice(0,a),o=r.slice(a+1);e.currentValues=[...i,t,...o],e.numberOfValues=e.currentValues.length}function kn(e,t){e&&(e.currentValues=t.values.map(Tc),e.freezeCurrentValues=!1,e.preventAutoSelect=!1)}var sm={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"automatic",resultsMustMatch:"atLeastOneValue"};function cm(e){return{...sm,type:"specific",currentValues:[],freezeCurrentValues:!1,isFieldExpanded:!1,preventAutoSelect:!1,...e}}function Tc(e){let{value:t,state:r}=e;return{value:t,state:r}}function no(e){return{value:e,state:"selected"}}function ao(e){return{value:e,state:"excluded"}}function um(e){return{...e,state:"idle"}}function lm(e){let t=io(e.start,e),r=io(e.end,e),n=e.endInclusive??!1,a=e.state??"idle";return{start:t,end:r,endInclusive:n,state:a}}function io(e,t){let{dateFormat:r}=t;return Og(e)?(eo(e),xg(e)):typeof e=="string"&&Wt(e)?(eo(e),e):(qg(e,r),pc(Vr(e,r)))}var jc=w("rangeFacet/updateSortCriterion",e=>q(e,{facetId:re,criterion:new de({required:!0})})),ir={state:F,start:new j({required:!0}),end:new j({required:!0}),endInclusive:new J({required:!0}),numberOfResults:new j({required:!0,min:0})},or={start:F,end:F,endInclusive:new J({required:!0}),state:F,numberOfResults:new j({required:!0,min:0})},$c=e=>({facetId:re,selection:typeof e.start=="string"?new M({values:or}):new M({values:ir})}),dm={start:F,end:F,endInclusive:new J({required:!0}),state:F},fm={facetId:re,field:F,currentValues:new ce({required:!1,each:new M({values:dm})}),generateAutomaticRanges:new J({required:!0}),filterFacetCount:new J({required:!1}),injectionDepth:new j({required:!1,min:0}),numberOfValues:new j({required:!1,min:1}),sortCriteria:new de({required:!1}),rangeAlgorithm:new de({required:!1})};function oo(e){return Wt(e)?aa(e):e}function Lc(e){e.currentValues&&e.currentValues.forEach(t=>{let{start:r,end:n}=lm(t);if(Vr(oo(r)).isAfter(Vr(oo(n))))throw new Error(`The start value is greater than the end value for the date range ${t.start} to ${t.end}`)})}var Vc=w("dateFacet/register",e=>{try{return ft(e,fm),Lc(e),{payload:e,error:null}}catch(t){return{payload:e,error:dt(t)}}}),Et=w("dateFacet/toggleSelectValue",e=>q(e,{facetId:re,selection:new M({values:or})})),Rt=w("dateFacet/toggleExcludeValue",e=>q(e,{facetId:re,selection:new M({values:or})})),_c=w("dateFacet/updateFacetValues",e=>{try{return ft(e,{facetId:re,values:new ce({each:new M({values:or})})}),Lc({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:dt(t)}}}),pm=jc,hm=Re,Qc={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"ascending",rangeAlgorithm:"even",resultsMustMatch:"atLeastOneValue"};function zc(e,t){let{request:r}=t,{facetId:n}=r;if(n in e)return;let a=Wc(r);r.numberOfValues=a,e[n]=t}function Nc(e,t,r){var a;let n=(a=e[t])==null?void 0:a.request;n&&(n.currentValues=r,n.numberOfValues=Wc(n))}function Bc(e,t,r){var o;let n=(o=e[t])==null?void 0:o.request;if(!n)return;let a=Qr(n.currentValues,r);if(!a)return;let i=a.state==="selected";a.state=i?"idle":"selected",n.preventAutoSelect=!0}function Yc(e,t,r){var o;let n=(o=e[t])==null?void 0:o.request;if(!n)return;let a=Qr(n.currentValues,r);if(!a)return;let i=a.state==="excluded";a.state=i?"idle":"excluded",n.preventAutoSelect=!0}function yt(e,t){var n;let r=(n=e[t])==null?void 0:n.request;r&&r.currentValues.forEach(a=>a.state="idle")}function Hc(e,t){Object.entries(e).forEach(([r,{request:n}])=>{let a=t[r]||[];n.currentValues.forEach(s=>{let c=!!Qr(a,s);return s.state=c?"selected":"idle",s});let i=a.filter(s=>!Qr(n.currentValues,s)),o=n.currentValues;o.push(...i),n.numberOfValues=Math.max(n.numberOfValues,o.length)})}function _r(e,t,r){t.forEach(n=>{var s;let a=n.facetId,i=(s=e[a])==null?void 0:s.request;if(!i)return;let o=r(n.values);i.currentValues=o,i.preventAutoSelect=!1})}function Qr(e,t){let{start:r,end:n}=t;return e.find(a=>a.start===r&&a.end===n)}function gr(e,t){let{start:r,end:n,endInclusive:a}=t;return e.find(i=>i.start===r&&i.end===n&&i.endInclusive===a)}function Wc(e){let{generateAutomaticRanges:t,currentValues:r,numberOfValues:n}=e;return t?Math.max(n,r.length):r.length}Z(Ma(),e=>{e.addCase(Vc,(t,r)=>{let{payload:n}=r,a=gm(n);zc(t,Dh(a))}).addCase(Ue.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.dateFacetSet)??t}).addCase(nt,(t,r)=>{let n=r.payload.df||{};Hc(t,n)}).addCase(Et,(t,r)=>{let{facetId:n,selection:a}=r.payload;Bc(t,n,a)}).addCase(Rt,(t,r)=>{let{facetId:n,selection:a}=r.payload;Yc(t,n,a)}).addCase(_c,(t,r)=>{let{facetId:n,values:a}=r.payload;Nc(t,n,a)}).addCase(hm,(t,r)=>{yt(t,r.payload)}).addCase(Ve,t=>{Object.keys(t).forEach(r=>{yt(t,r)})}).addCase(pm,(t,r)=>{Ba(t,r.payload)}).addCase(De.fulfilled,(t,r)=>{let n=r.payload.response.facets;_r(t,n,ia)}).addCase(nn.fulfilled,(t,r)=>{var a,i;let n=((i=(a=r.payload.response)==null?void 0:a.facets)==null?void 0:i.results)||[];_r(t,n,ia)}).addCase(Xr,(t,r)=>{yt(t,r.payload)})});function gm(e){return{...Qc,currentValues:[],preventAutoSelect:!1,type:"dateRange",...e}}function ia(e){return e.map(t=>{let{numberOfResults:r,...n}=t;return n})}var mm={state:F,start:new j({required:!0}),end:new j({required:!0}),endInclusive:new J({required:!0})},ym={facetId:re,field:F,currentValues:new ce({required:!1,each:new M({values:mm})}),generateAutomaticRanges:new J({required:!0}),filterFacetCount:new J({required:!1}),injectionDepth:new j({required:!1,min:0}),numberOfValues:new j({required:!1,min:1}),sortCriteria:new de({required:!1}),rangeAlgorithm:new de({required:!1})};function Gc(e){e.currentValues&&e.currentValues.forEach(({start:t,end:r})=>{if(t>r)throw new Error(`The start value is greater than the end value for the numeric range ${t} to ${r}`)})}var Jc=w("numericFacet/register",e=>{try{return q(e,ym),Gc(e),{payload:e,error:null}}catch(t){return{payload:e,error:dt(t)}}}),pt=w("numericFacet/toggleSelectValue",e=>q(e,{facetId:re,selection:new M({values:ir})})),ht=w("numericFacet/toggleExcludeValue",e=>q(e,{facetId:re,selection:new M({values:ir})})),sn=w("numericFacet/updateFacetValues",e=>{try{return ft(e,{facetId:re,values:new ce({each:new M({values:ir})})}),Gc({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:dt(t)}}}),vm=jc,Sm=Re;Z(Ua(),e=>{e.addCase(Jc,(t,r)=>{let{payload:n}=r,a=wm(n);zc(t,Fh(a))}).addCase(Ue.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.numericFacetSet)??t}).addCase(nt,(t,r)=>{let n=r.payload.nf||{};Hc(t,n)}).addCase(pt,(t,r)=>{let{facetId:n,selection:a}=r.payload;Bc(t,n,a)}).addCase(ht,(t,r)=>{let{facetId:n,selection:a}=r.payload;Yc(t,n,a)}).addCase(sn,(t,r)=>{let{facetId:n,values:a}=r.payload;Nc(t,n,a)}).addCase(Sm,(t,r)=>{yt(t,r.payload)}).addCase(Ve,t=>{Object.keys(t).forEach(r=>{yt(t,r)})}).addCase(vm,(t,r)=>{Ba(t,r.payload)}).addCase(De.fulfilled,(t,r)=>{let n=r.payload.response.facets;_r(t,n,zr)}).addCase(nn.fulfilled,(t,r)=>{var a,i;let n=((i=(a=r.payload.response)==null?void 0:a.facets)==null?void 0:i.results)||[];_r(t,n,zr)}).addCase(Xr,(t,r)=>{yt(t,r.payload)})});function wm(e){return{...Qc,currentValues:[],preventAutoSelect:!1,type:"numericalRange",...e}}function zr(e){return e.map(t=>{let{numberOfResults:r,...n}=t;return n})}var bm=new M({options:{required:!1},values:{by:new ut({enum:rn,required:!0}),fields:new ce({each:new M({values:{field:new E({required:!0}),direction:new ut({enum:$a}),displayName:new E}})})}}),gt=async e=>({...await Ya(e),facets:Im(e),...e.commerceSort&&{sort:qm(e.commerceSort.appliedSort)}}),Ya=async(e,t)=>{let{view:r,user:n,...a}=e.commerceContext;return{accessToken:e.configuration.accessToken,url:e.configuration.platformUrl,organizationId:e.configuration.organizationId,trackingId:e.configuration.analytics.trackingId,...a,clientId:await rt(e.configuration.analytics),context:{user:n,view:r,cart:ps(e.cart)},...Cm(e,t)}},Cm=(e,t)=>{var n,a;let r=t?(n=e.commercePagination)==null?void 0:n.recommendations[t]:(a=e.commercePagination)==null?void 0:a.principal;return r&&{page:r.page,...r.perPage&&{perPage:r.perPage}}};function Im(e){return!e.facetOrder||!e.commerceFacetSet?[]:e.facetOrder.map(t=>e.commerceFacetSet[t].request).filter(t=>t.values.length>0)}function qm(e){return e.by==="relevance"?{sortCriteria:"relevance"}:{sortCriteria:"fields",fields:e.fields.map(({name:t,direction:r})=>({field:t,direction:r}))}}var Ha=N(e=>{var t;return((t=e.commercePagination)==null?void 0:t.principal.perPage)||0},e=>e),km=N((e,t)=>{var r,n;return((n=(r=e.commercePagination)==null?void 0:r.recommendations[t])==null?void 0:n.perPage)||0},e=>e),Wa=N(e=>{var t;return((t=e.commercePagination)==null?void 0:t.principal.totalEntries)||0},e=>e),xm=N((e,t)=>{var r,n;return((n=(r=e.commercePagination)==null?void 0:r.recommendations[t])==null?void 0:n.totalEntries)||0},e=>e),Om=N(e=>{var t;return((t=e.commercePagination)==null?void 0:t.principal.page)||0},e=>e);N((e,t)=>{var r,n;return((n=(r=e.commercePagination)==null?void 0:r.recommendations[t])==null?void 0:n.page)||0},e=>e);var Kc=N(e=>e.productListing.responseId,e=>e),Am=N(e=>e.productListing.requestId,e=>e),Ga=N(e=>{var t;return((t=e.productListing)==null?void 0:t.products.length)||0},e=>e),Em=N(e=>({total:Wa(e),current:Ga(e)}),({current:e,total:t})=>e<t),Rm=N(e=>{var t;return(t=e.productListing)==null?void 0:t.isLoading},e=>z(e)?!1:e),Dm=N(e=>{var t;return(t=e.productListing)==null?void 0:t.error},e=>e),Oe=V("commerce/productListing/fetch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t(),{apiClient:o}=a,s=await o.getProductListing(await gt(i));return Me(s)?(r(xe(s.error)),n(s.error)):{response:s.success}}),qr=V("commerce/productListing/fetchMoreProducts",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t();if(!Em(i))return null;let{apiClient:o}=a,s=Ha(i),c=Ga(i)/s,u=await o.getProductListing({...await gt(i),page:c});return Me(u)?(r(xe(u.error)),n(u.error)):{response:u.success}}),Ja=w("query/updateQuery",e=>q(e,{query:new E})),oa=N(e=>e.commerceSearch.responseId,e=>e),Fm=N(e=>e.commerceSearch.requestId,e=>e),Ka=N(e=>{var t;return((t=e.commerceSearch)==null?void 0:t.products.length)||0},e=>e),Pm=N(e=>({total:Wa(e),current:Ka(e)}),({current:e,total:t})=>e<t),Mm=N(e=>{var t;return(t=e.commerceSearch)==null?void 0:t.isLoading},e=>z(e)?!1:e),Um=N(e=>{var t;return(t=e.commerceSearch)==null?void 0:t.error},e=>e),Za=N(e=>{var t;return(t=e.commerceQuery)==null?void 0:t.query},e=>e??""),Tm=N(e=>{var t;return(t=e.commerceSearch)==null?void 0:t.queryExecuted},e=>e),Zc=(e,t)=>{var r,n;return((r=t.queryCorrection)==null?void 0:r.correctedQuery)!==void 0?(n=t.queryCorrection)==null?void 0:n.correctedQuery:Za(e)},oe=V("commerce/search/executeSearch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t(),{apiClient:o}=a,s=Za(i),c=await o.search({...await gt(i),query:s});return Me(c)?(r(xe(c.error)),n(c.error)):{response:c.success,originalQuery:s,queryExecuted:Zc(i,c.success)}}),kr=V("commerce/search/fetchMoreProducts",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t();if(!Pm(i))return null;let{apiClient:o}=a,s=Ha(i),c=Ka(i)/s,u=Za(i),l=await o.search({...await gt(i),query:u,page:c});return Me(l)?(r(xe(l.error)),n(l.error)):{response:l.success,originalQuery:u,queryExecuted:Zc(i,l.success)}}),Xc=V("commerce/search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;q(e,{query:new E,clearFilters:new J}),e.clearFilters&&(r(Ve()),r(Kr())),r(er({allow:!0})),r(Ja({query:e.query})),r(tr(1))}),xr=V("commerce/search/fetchInstantProducts",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t(),{q:o}=e,{apiClient:s}=a,c=await s.productSuggestions({...await gt(i),query:o});if(Me(c))return r(xe(c.error)),n(c.error);let u=c.success.products.slice(0,5);return{response:{...c.success,products:u}}}),jm=async(e,t,r)=>{var k,T;let n=`*${t.categoryFacetSearchSet[e].options.query}*`,a=(k=t.commerceFacetSet[e])==null?void 0:k.request,i=a&&$m(a)?a&&Lm(a):[],o=i.length?[i]:[],s=(T=t.commerceQuery)==null?void 0:T.query,{url:c,accessToken:u,organizationId:l,trackingId:d,language:p,country:g,currency:b,clientId:f,context:m,...C}=await gt(t);return{url:c,accessToken:u,organizationId:l,facetId:e,facetQuery:n,ignorePaths:o,trackingId:d,language:p,country:g,currency:b,clientId:f,context:m,...C,query:s}};function $m(e){return e.type==="hierarchical"}var Lm=e=>{let t=[],r=e.values[0];for(;r;)t.push(r.value),r=r.children[0];return t},Vm=async(e,t,r)=>{var f;let n=`*${t.facetSearchSet[e].options.query}*`,a=(f=t.commerceQuery)==null?void 0:f.query;a===void 0&&(a="");let{url:i,accessToken:o,organizationId:s,trackingId:c,language:u,country:l,currency:d,clientId:p,context:g,...b}=await gt(t);return{url:i,accessToken:o,organizationId:s,facetId:e,facetQuery:n,trackingId:c,language:u,country:l,currency:d,clientId:p,context:g,...b,query:a}},eu=e=>async(t,{getState:r,extra:{apiClient:n,validatePayload:a}})=>{let i=r();a(t,F);let o=_m(i,t)||Qm(i,t)?Vm(t,i):jm(t,i),s=await n.facetSearch(await o);return{facetId:t,response:s}},Ke=V("commerce/facetSearch/executeSearch",eu()),$e=V("commerce/facetSearch/facetFieldSuggest",eu()),_m=(e,t)=>"facetSearchSet"in e&&e.facetSearchSet[t]!==void 0&&e.commerceFacetSet[t]!==void 0,Qm=(e,t)=>"fieldSuggestionsOrder"in e?e.fieldSuggestionsOrder.some(r=>r.facetId===t&&r.type==="regular"):!1;function zm(e,t){var i;let{facetId:r,numberOfValues:n}=t,a=(i=e[r])==null?void 0:i.request.values[0];if(a){for(;a.children.length&&(a==null?void 0:a.state)!=="selected";)a=a.children[0];a.retrieveCount=n}}function Nm(){return{}}var cn=Z(Nm(),e=>{e.addCase(Oe.fulfilled,co).addCase(oe.fulfilled,co).addCase($e.fulfilled,Bm).addCase(qt,(t,r)=>{var s;let{facetId:n,selection:a}=r.payload,i=(s=t[n])==null?void 0:s.request;if(!i||!xn(i))return;i.preventAutoSelect=!0;let o=i.values.find(c=>c.value===a.value);if(!o){Ne(i,a);return}ze(o,"select")}).addCase(pt,(t,r)=>{var s;let{facetId:n,selection:a}=r.payload,i=(s=t[n])==null?void 0:s.request;if(!i||!On(i))return;i.preventAutoSelect=!0;let o=gr(i.values,a);if(!o){Ne(i,a);return}if(ze(o,"select"),i.interval==="continuous"&&o.state==="idle"){i.values=[];return}}).addCase(Et,(t,r)=>{var s;let{facetId:n,selection:a}=r.payload,i=(s=t[n])==null?void 0:s.request;if(!i||!so(i))return;i.preventAutoSelect=!0;let o=gr(i.values,a);if(!o){Ne(i,a);return}ze(o,"select")}).addCase(Zr,(t,r)=>{var d;let{facetId:n,selection:a,retrieveCount:i}=r.payload,o=(d=t[n])==null?void 0:d.request;if(!o||!sa(o))return;let{path:s}=a,c=s.slice(0,s.length-1),u=Hm(o,c,i);if(u.length){let p=u[0];p.state="selected",p.children=[];return}let l=Nr(a.value,i);l.state="selected",u.push(l),o.numberOfValues=1}).addCase(kt,(t,r)=>{var s;let{facetId:n,selection:a}=r.payload,i=(s=t[n])==null?void 0:s.request;if(!i||!xn(i))return;i.preventAutoSelect=!0;let o=i.values.find(c=>c.value===a.value);if(!o){Ne(i,a);return}ze(o,"exclude")}).addCase(ht,(t,r)=>{var s;let{facetId:n,selection:a}=r.payload,i=(s=t[n])==null?void 0:s.request;if(!i||!On(i))return;i.preventAutoSelect=!0;let o=gr(i.values,a);if(!o){Ne(i,a);return}if(ze(o,"exclude"),i.interval==="continuous"&&o.state==="idle"){i.values=[];return}}).addCase(Rt,(t,r)=>{var s;let{facetId:n,selection:a}=r.payload,i=(s=t[n])==null?void 0:s.request;if(!i||!so(i))return;i.preventAutoSelect=!0;let o=gr(i.values,a);if(!o){Ne(i,a);return}ze(o,"exclude")}).addCase(Bn,(t,r)=>{var o;let{facetId:n,numberOfValues:a}=r.payload,i=(o=t[n])==null?void 0:o.request;if(i){if(!i.values.length)return Uc(i,a);zm(t,r.payload)}}).addCase(Yt,(t,r)=>{var c;let{facetId:n,value:a}=r.payload,i=(c=t[n])==null?void 0:c.request;if(!i||!xn(i))return;let{rawValue:o}=a;i.preventAutoSelect=!0;let s=i.values.find(u=>u.value===o);if(!s){Ne(i,{state:"selected",value:o});return}ze(s,"select")}).addCase(Ht,(t,r)=>{var c;let{facetId:n,value:a}=r.payload,i=(c=t[n])==null?void 0:c.request;if(!i||i.type!=="regular"&&i.type!=="hierarchical")return;let{rawValue:o}=a;i.preventAutoSelect=!0;let s=i.values.find(u=>u.value===o);if(!s){Ne(i,{state:"excluded",value:o});return}ze(s,"exclude")}).addCase(Aa,(t,r)=>{let{facetId:n,value:a}=r.payload,i=t[n];if(!i||!sa(i==null?void 0:i.request))return;let o=[...a.path,a.rawValue];Km(i.request,o,i.request.initialNumberOfValues)}).addCase(sn,(t,r)=>{var o;let{facetId:n,values:a}=r.payload,i=(o=t[n])==null?void 0:o.request;!i||!On(i)||(i.values=zr(a),i.numberOfValues=a.length)}).addCase(Mr,(t,r)=>{var o;let{facetId:n,numberOfValues:a}=r.payload,i=(o=t[n])==null?void 0:o.request;i&&(i.numberOfValues=a)}).addCase(Ur,(t,r)=>{var o;let{facetId:n,isFieldExpanded:a}=r.payload,i=(o=t[n])==null?void 0:o.request;i&&(i.isFieldExpanded=a)}).addCase(er,(t,r)=>Object.values(t).forEach(n=>{n.request.preventAutoSelect=!r.payload.allow})).addCase(Re,(t,r)=>{var i;let n=r.payload,a=(i=t[n])==null?void 0:i.request;a&&Ym(a)}).addCase(Ve,Jm).addCase(Kt,An).addCase(Zt,An).addCase(Jr,An)});function xn(e){return e.type==="regular"}function On(e){return e.type==="numericalRange"}function so(e){return e.type==="dateRange"}function sa(e){return e.type==="hierarchical"}function co(e,t){let r=new Set(Object.keys(e)),n=t.payload.response.facets;for(let a of n)Wm(e,a,r);for(let a of r)delete e[a]}function Bm(e,t){var a;let r=t.payload.facetId,n=(a=e[r])==null?void 0:a.request;n||(e[r]={request:{}},n=e[r].request,n.initialNumberOfValues=10)}function Ym(e){e.type==="hierarchical"?(e.numberOfValues=e.initialNumberOfValues,e.values=[],e.preventAutoSelect=!0):e.values.forEach(t=>t.state="idle")}function Hm(e,t,r){let n=e.values;for(let a of t){let i=n[0];(!i||a!==i.value)&&(i=Nr(a,r),n.length=0,n.push(i)),i.state="idle",n=i.children}return n}function Nr(e,t){return{children:[],state:"idle",value:e,retrieveCount:t}}function ze(e,t){switch(e.state){case"idle":e.state=t==="exclude"?"excluded":"selected";break;case"excluded":e.state=t==="exclude"?"idle":"selected";break;case"selected":e.state=t==="exclude"?"excluded":"idle";break}}function Wm(e,t,r){var i;let n=t.facetId??t.field,a=(i=e[n])==null?void 0:i.request;a?r.delete(n):(e[n]={request:{}},a=e[n].request,a.initialNumberOfValues=t.numberOfValues),a.facetId=n,a.displayName=t.displayName,a.numberOfValues=t.numberOfValues,a.field=t.field,a.type=t.type,a.values=Gm(t)??[],a.preventAutoSelect=!1,t.type==="hierarchical"&&sa(a)?a.delimitingCharacter=t.delimitingCharacter:t.type==="numericalRange"&&(a.interval=t.interval,t.domain&&(a.domain={min:t.domain.min,max:t.domain.max,increment:t.domain.increment}))}function Gm(e){switch(e.type){case"numericalRange":return zr(e.values);case"dateRange":return ia(e.values);case"hierarchical":return e.values.every(t=>t.state==="idle"&&t.children.length===0)?[]:e.values.map(tu);case"regular":return e.values.map(Tc);default:return}}function tu(e){let t=e.children.every(a=>a.state==="idle"&&a.children.length===0)?[]:e.children.map(tu),{state:r,value:n}=e;return{children:t,state:r,value:n,retrieveCount:Sr}}function Ne(e,t){let{values:r}=e,n=r.findIndex(s=>s.state==="idle"),a=n===-1?r.length:n,i=r.slice(0,a),o=r.slice(a+1);e.values=[...i,t,...o],e.numberOfValues=e.values.length}function Jm(e){Object.values(e).forEach(t=>{t.request.values.forEach(r=>r.state="idle")})}function An(e){Object.values(e).forEach(t=>{t.request.values=[]})}function Km(e,t,r){e.values=Zm(t,r),e.numberOfValues=t.length?1:r,e.preventAutoSelect=!0}function Zm(e,t){if(!e.length)return[];let r=Nr(e[0],t),n=r;for(let a of e.splice(1)){let i=Nr(a,t);n.children.push(i),n=i}return n.state="selected",[r]}var ru={slotId:F,productId:new E({required:!1,emptyAllowed:!1})},Xm=new he(ru),nu=N((e,t)=>{var r;return e.recommendations&&((r=e.recommendations[t])==null?void 0:r.products.length)||0},e=>e),ey=N((e,t)=>({total:xm(e,t),current:nu(e,t)}),({current:e,total:t})=>e<t);N((e,t)=>{var r;return e.recommendations?(r=e.recommendations[t])==null?void 0:r.isLoading:!1},e=>z(e)?!1:e);var au=async(e,t,r)=>{let n=await Ya(t,e);return{...n,context:{...n.context,...r?{product:{productId:r}}:{},purchased:ff(t.cart)},slotId:e}},vt=V("commerce/recommendations/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let{slotId:a,productId:i}=e,o=await au(a,t(),i),s=await n.getRecommendations(o);return Me(s)?r(s.error):{response:s.success}}),Or=V("commerce/recommendations/fetchMore",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let a=e.slotId,i=t();if(ey(i,a))return null;let o=km(i,a),s=nu(i,a)/o,c={...await au(a,i),page:s},u=await n.getRecommendations(c);return Me(u)?r(u.error):{response:u.success}}),iu=w("commerce/recommendations/registerSlot",e=>q(e,ru)),un={slotId:ss},ty={...un,pageSize:new j({required:!0,min:0})},ca=w("commerce/pagination/setPageSize",e=>q(e,ty)),ry={...un,page:new j({required:!0,min:0})},ou=w("commerce/pagination/selectPage",e=>q(e,ry)),su=w("commerce/pagination/nextPage",e=>q(e,un)),cu=w("commerce/pagination/previousPage",e=>q(e,un)),uu=w("commerce/pagination/registerRecommendationsSlot",e=>q(e,{slotId:F}));function ny(){return{principal:Xa(),recommendations:{}}}function Xa(){return{page:0,totalEntries:0,totalPages:0}}var lu=Z(ny(),e=>{e.addCase(su,(t,r)=>{var a;let n=mr(t,(a=r.payload)==null?void 0:a.slotId);n&&n.page<n.totalPages-1&&++n.page}).addCase(cu,(t,r)=>{var a;let n=mr(t,(a=r.payload)==null?void 0:a.slotId);n&&n.page>0&&--n.page}).addCase(ou,(t,r)=>{let n=mr(t,r.payload.slotId);n&&r.payload.page>=0&&r.payload.page<n.totalPages&&(n.page=r.payload.page)}).addCase(ca,(t,r)=>{let n=mr(t,r.payload.slotId);n&&(n.perPage=r.payload.pageSize)}).addCase(Oe.fulfilled,(t,r)=>{t.principal=r.payload.response.pagination}).addCase(oe.fulfilled,(t,r)=>{t.principal=r.payload.response.pagination}).addCase(vt.fulfilled,(t,r)=>{t.recommendations[r.meta.arg.slotId]=r.payload.response.pagination}).addCase(uu,(t,r)=>{let n=r.payload.slotId;n in t||(t.recommendations[n]=Xa())}).addCase(Re,Be).addCase(qt,Be).addCase(kt,Be).addCase(pt,Be).addCase(ht,Be).addCase(Kt,Be).addCase(Zt,Be).addCase(Jr,Be)});function mr(e,t){return t?e.recommendations[t]:e.principal}function Be(e){e.principal.page=Xa().page}var ay=()=>({error:null,isLoading:!1,requestId:"",responseId:"",facets:[],products:[]}),ei=Z(ay(),e=>{e.addCase(Oe.rejected,(t,r)=>{uo(t,r.payload)}).addCase(qr.rejected,(t,r)=>{uo(t,r.payload)}).addCase(Oe.fulfilled,(t,r)=>{lo(t,r.payload.response),t.products=r.payload.response.products}).addCase(qr.fulfilled,(t,r)=>{r.payload&&(lo(t,r.payload.response),t.products=t.products.concat(r.payload.response.products))}).addCase(Oe.pending,(t,r)=>{fo(t,r.meta.requestId)}).addCase(qr.pending,(t,r)=>{fo(t,r.meta.requestId)})});function uo(e,t){e.error=t||null,e.isLoading=!1}function lo(e,t){e.error=null,e.facets=t.facets,e.responseId=t.responseId,e.isLoading=!1}function fo(e,t){e.isLoading=!0,e.requestId=t}var du={q:new E},fu={},ti=w("commerce/searchParameters/restore",e=>q(e,du)),iy=w("commerce/productListingParameters/restore",e=>q(e,fu)),ri=()=>({query:""}),sr=Z(ri(),e=>{e.addCase(Ja,(t,r)=>({...t,...r.payload})).addCase(ti,(t,r)=>{t.query=r.payload.q??""})}),oy=()=>({}),sy=()=>({headline:"",error:null,isLoading:!1,responseId:"",products:[]}),pu=Z(oy(),e=>{e.addCase(iu,(t,r)=>{let n=r.payload.slotId;n in t||(t[n]=cy())}).addCase(vt.rejected,(t,r)=>{po(t,r.meta.arg.slotId,r.payload)}).addCase(Or.rejected,(t,r)=>{po(t,r.meta.arg.slotId,r.payload)}).addCase(vt.fulfilled,(t,r)=>{let n=r.meta.arg.slotId,a=r.payload.response;ho(t,n,a);let i=t[n];i&&(i.products=a.products)}).addCase(Or.fulfilled,(t,r)=>{if(!r.payload)return;let n=r.meta.arg.slotId,a=r.payload.response;ho(t,n,a);let i=t[n];i&&(i.products=i.products.concat(a.products))}).addCase(vt.pending,(t,r)=>{go(t,r.meta.arg.slotId)}).addCase(Or.pending,(t,r)=>{go(t,r.meta.arg.slotId)})});function cy(e){return{...sy(),...e}}function po(e,t,r){let n=e[t];n&&(n.error=r??null,n.isLoading=!1)}function ho(e,t,r){let n=e[t];n&&(n.error=null,n.headline=r.headline,n.responseId=r.responseId,n.isLoading=!1)}function go(e,t){let r=e[t];r&&(r.isLoading=!0)}var uy=()=>({error:null,isLoading:!1,requestId:"",responseId:"",products:[],facets:[],queryExecuted:""}),cr=Z(uy(),e=>{e.addCase(oe.rejected,(t,r)=>{mo(t,r.payload)}).addCase(kr.rejected,(t,r)=>{mo(t,r.payload)}).addCase(oe.fulfilled,(t,r)=>{vo(t,r.payload.response,r.payload.queryExecuted),t.products=r.payload.response.products}).addCase(kr.fulfilled,(t,r)=>{r.payload&&(vo(t,r.payload.response,r.payload.queryExecuted),t.products=t.products.concat(r.payload.response.products))}).addCase(oe.pending,(t,r)=>{yo(t,r.meta.requestId)}).addCase(kr.pending,(t,r)=>{yo(t,r.meta.requestId)})});function mo(e,t){e.error=t||null,e.isLoading=!1}function yo(e,t){e.isLoading=!0,e.requestId=t}function vo(e,t,r){e.error=null,e.facets=t.facets,e.responseId=t.responseId,e.isLoading=!1,e.queryExecuted=r??""}var ua=w("commerce/sort/apply",e=>q(e,{by:new ut({enum:rn,required:!0})}));function yr(){return{appliedSort:ra(),availableSorts:[ra()]}}var So=e=>e.sortCriteria==="relevance"?ra():{by:"fields",fields:(e.fields||[]).map(({field:t,direction:r,displayName:n})=>({name:t,direction:r,displayName:n}))},hu=Z(yr(),e=>{e.addCase(ua,(t,r)=>{t.appliedSort=r.payload}).addCase(Oe.fulfilled,wo).addCase(oe.fulfilled,wo).addCase(Kt,yr).addCase(Zt,yr).addCase(Jr,yr)});function wo(e,t){let r=t.payload.response;e.appliedSort=So(r.sort.appliedSort),e.availableSorts=r.sort.availableSorts.map(So)}function ly(e){return e.query="",e.queryModification={originalQuery:"",newQuery:"",queryToIgnore:e.queryModification.queryToIgnore},e}function dy(e,t){let r=[],n=[],a=[],i=[];return t.forEach(o=>{switch(o.type){case"redirect":r.push(o.content);break;case"query":n.push(o.content);break;case"execute":a.push({functionName:o.content.name,params:o.content.params});break;case"notify":i.push(o.content);break}}),e.redirectTo=r[0]??"",e.query=e.queryModification.newQuery,e.executions=a,e.notifications=i,e}function fy(e,t){return e.queryModification={...t,queryToIgnore:""},e}function py(e,t){return e.queryModification.queryToIgnore=t,e}var hy=()=>({redirectTo:"",query:"",executions:[],notifications:[],queryModification:{originalQuery:"",newQuery:"",queryToIgnore:""}}),gy=w("commerce/trigger/query/ignore",e=>q(e,new E({emptyAllowed:!0,required:!0}))),my=w("commerce/trigger/query/modification",e=>q(e,new M({values:{originalQuery:te,modification:te}}))),yy=Z(hy(),e=>e.addCase(oe.pending,ly).addCase(oe.fulfilled,(t,r)=>dy(t,r.payload.response.triggers)).addCase(my,(t,r)=>fy(t,r.payload)).addCase(gy,(t,r)=>py(t,r.payload))),ni=Z(xc(),e=>{e.addCase(De.fulfilled,En).addCase(Oe.fulfilled,En).addCase(oe.fulfilled,En).addCase(Ue.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.facetOrder)??t})});function En(e,t){return t.payload.response.facets.map(r=>r.facetId)}var Dt={id:F},ai=w("querySuggest/register",e=>q(e,{...Dt,count:new j({min:0})})),vy=w("querySuggest/unregister",e=>q(e,Dt)),ur=w("querySuggest/selectSuggestion",e=>q(e,{...Dt,expression:Pe})),Qt=w("querySuggest/clear",e=>q(e,Dt)),Rn=V("querySuggest/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:a}})=>{a(e,Dt);let i=e.id,o=await Sy(i,t()),s=await n.querySuggest(o);return Je(s)?r(s.error):{id:i,q:o.q,...s.success}}),Sy=async(e,t)=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl,count:t.querySuggest[e].count,q:t.querySet[e],locale:t.configuration.search.locale,timezone:t.configuration.search.timezone,actionsHistory:t.configuration.analytics.enabled?xt.getHistory():[],...t.context&&{context:t.context.contextValues},...t.pipeline&&{pipeline:t.pipeline},...t.searchHub&&{searchHub:t.searchHub},tab:t.configuration.analytics.originLevel2,...t.configuration.analytics.enabled&&{visitorId:await rt(t.configuration.analytics),...t.configuration.analytics.enabled&&await on(t.configuration.analytics)},...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")}}),Ze=V("commerce/querySuggest/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:a}})=>{a(e,Dt);let i=t(),o=await wy(e.id,i),s=await n.querySuggest(o);return Me(s)?r(s.error):{id:e.id,query:o.query,...s.success}}),wy=async(e,t)=>{let{view:r,user:n,...a}=t.commerceContext;return{accessToken:t.configuration.accessToken,url:t.configuration.platformUrl,organizationId:t.configuration.organizationId,trackingId:t.configuration.analytics.trackingId,query:t.querySet[e],...a,clientId:await rt(t.configuration.analytics),context:{user:n,view:r,cart:ps(t.cart)}}};function ii(e,t,r){let{facetId:n}=t;if(e[n])return;let a=!1,i={...lt,...t},o=r();e[n]={options:i,isLoading:a,response:o,initialNumberOfValues:i.numberOfValues,requestId:""}}function gu(e,t){let{facetId:r,...n}=t,a=e[r];a&&(a.options={...a.options,...n})}function St(e,t,r){let n=e[t];n&&(n.requestId=r,n.isLoading=!0)}function wt(e,t){let r=e[t];r&&(r.isLoading=!1)}function mu(e,t,r){let{facetId:n,response:a}=t,i=e[n];i&&i.requestId===r&&(i.isLoading=!1,i.response=a)}function yu(e,t,r){let{facetId:n,response:a}=t,i=e[n];i&&i.requestId===r&&(i.isLoading=!1,"success"in a&&(i.response=a.success))}function vu(e,t,r,n){let{facetId:a,response:i}=t,o=e[a];if(!o)ii(e,{facetId:a},n),o=e[a];else if(o.requestId!==r)return;o.isLoading=!1,"success"in i&&(o.response=i.success)}function by(e,t,r,n){if(t.fieldSuggestionsFacets)for(let a of t.fieldSuggestionsFacets)a.facetId in e||a.type!=="regular"||(e[a.facetId]={options:{...lt,query:t.query??""},isLoading:!1,response:n(),initialNumberOfValues:lt.numberOfValues,requestId:r})}function Cy(e,t,r,n){if(t.fieldSuggestionsFacets)for(let a of t.fieldSuggestionsFacets)a.facetId in e||a.type!=="hierarchical"||(e[a.facetId]={options:{...lt,query:t.query??""},isLoading:!1,response:n(),initialNumberOfValues:lt.numberOfValues,requestId:r})}function oi(e,t,r){let{facetId:n}=t,a=e[n];a&&(a.requestId="",a.isLoading=!1,a.response=r(),a.options.numberOfValues=a.initialNumberOfValues,a.options.query=lt.query)}function st(e,t){Object.keys(e).forEach(r=>oi(e,{facetId:r},t))}var lt={captions:{},numberOfValues:10,query:""},Iy=async(e,t,r)=>{let n=t.categoryFacetSearchSet[e].options,a=t.categoryFacetSet[e].request,{captions:i,query:o,numberOfValues:s}=n,{field:c,delimitingCharacter:u,basePath:l,filterFacetCount:d}=a,p=qy(a),g=p.length?[p]:[],b=`*${o}*`;return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")},basePath:l,captions:i,numberOfValues:s,query:b,field:c,delimitingCharacter:u,ignorePaths:g,filterFacetCount:d,type:"hierarchical",...r?{}:{searchContext:(await Ce(t)).request}}},qy=e=>{let t=[],r=e.currentValues[0];for(;r;)t.push(r.value),r=r.children[0];return t},ky=async(e,t,r)=>{let{captions:n,query:a,numberOfValues:i}=t.facetSearchSet[e].options,{field:o,currentValues:s,filterFacetCount:c}=t.facetSet[e].request,u=s.filter(d=>d.state!=="idle").map(d=>d.value),l=`*${a}*`;return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders&&{authentication:t.configuration.search.authenticationProviders.join(",")},captions:n,numberOfValues:i,query:l,field:o,ignoreValues:u,filterFacetCount:c,type:"specific",...r?{}:{searchContext:(await Ce(t)).request}}},Su=e=>async(t,{getState:r,extra:{apiClient:n,validatePayload:a}})=>{let i=r(),o;a(t,F),xy(i,t)?o=await ky(t,i,e):o=await Iy(t,i,e);let s=await n.facetSearch(o);return{facetId:t,response:s}},bt=V("facetSearch/executeSearch",Su(!1));V("facetSearch/executeSearch",Su(!0));var si=w("facetSearch/clearResults",e=>q(e,{facetId:re})),xy=(e,t)=>e.facetSearchSet!==void 0&&e.facetSet!==void 0&&e.facetSet[t]!==void 0;function Oy(){return{}}var wu=Z(Oy(),e=>{e.addCase(Ss,(t,r)=>{let n=r.payload;ii(t,n,at)}).addCase(_t,(t,r)=>{gu(t,r.payload)}).addCase(Ke.pending,(t,r)=>{let n=r.meta.arg;St(t,n,r.meta.requestId)}).addCase($e.pending,(t,r)=>{let n=r.meta.arg;St(t,n,r.meta.requestId)}).addCase(bt.pending,(t,r)=>{let n=r.meta.arg;St(t,n,r.meta.requestId)}).addCase(Ke.rejected,(t,r)=>{let n=r.meta.arg;wt(t,n)}).addCase($e.rejected,(t,r)=>{let n=r.meta.arg;wt(t,n)}).addCase(bt.rejected,(t,r)=>{let n=r.meta.arg;wt(t,n)}).addCase(Ke.fulfilled,(t,r)=>{yu(t,r.payload,r.meta.requestId)}).addCase($e.fulfilled,(t,r)=>{vu(t,r.payload,r.meta.requestId,at)}).addCase(Ze.fulfilled,(t,r)=>{Cy(t,r.payload,r.meta.requestId,at)}).addCase(bt.fulfilled,(t,r)=>{mu(t,r.payload,r.meta.requestId)}).addCase(si,(t,{payload:{facetId:r}})=>{oi(t,{facetId:r},at)}).addCase(Oe.fulfilled,t=>st(t,at)).addCase(oe.fulfilled,t=>st(t,at)).addCase(De.fulfilled,t=>{st(t,at)})});function at(){return{moreValuesAvailable:!1,values:[]}}function Ay(){return{}}var bu=Z(Ay(),e=>{e.addCase(bs,(t,r)=>{let n=r.payload;ii(t,n,Ye)}).addCase(_t,(t,r)=>{gu(t,r.payload)}).addCase(Ke.pending,(t,r)=>{let n=r.meta.arg;St(t,n,r.meta.requestId)}).addCase($e.pending,(t,r)=>{let n=r.meta.arg;St(t,n,r.meta.requestId)}).addCase(bt.pending,(t,r)=>{let n=r.meta.arg;St(t,n,r.meta.requestId)}).addCase(Ke.rejected,(t,r)=>{let n=r.meta.arg;wt(t,n)}).addCase($e.rejected,(t,r)=>{let n=r.meta.arg;wt(t,n)}).addCase(bt.rejected,(t,r)=>{let n=r.meta.arg;wt(t,n)}).addCase(Ke.fulfilled,(t,r)=>{yu(t,r.payload,r.meta.requestId)}).addCase($e.fulfilled,(t,r)=>{vu(t,r.payload,r.meta.requestId,Ye)}).addCase(Ze.fulfilled,(t,r)=>{by(t,r.payload,r.meta.requestId,Ye)}).addCase(bt.fulfilled,(t,r)=>{mu(t,r.payload,r.meta.requestId)}).addCase(si,(t,{payload:r})=>{oi(t,r,Ye)}).addCase(De.fulfilled,t=>{st(t,Ye)}).addCase(Oe.fulfilled,t=>st(t,Ye)).addCase(oe.fulfilled,t=>st(t,Ye)).addCase(Zt,t=>st(t,Ye))});function Ye(){return{moreValuesAvailable:!1,values:[]}}var Dn=()=>te,Cu=()=>F,ci=w("configuration/updateBasicConfiguration",e=>q(e,{accessToken:te,organizationId:te,platformUrl:te})),Ey=w("configuration/updateSearchConfiguration",e=>q(e,{apiBaseUrl:te,pipeline:new E({required:!1,emptyAllowed:!0}),searchHub:te,timezone:te,locale:te,authenticationProviders:new ce({required:!1,each:F})})),Ry={enabled:new J({default:!0}),originContext:Dn(),originLevel2:Dn(),originLevel3:Dn(),apiBaseUrl:te,nextApiBaseUrl:te,runtimeEnvironment:new de,anonymous:new J({default:!1}),deviceId:te,userDisplayName:te,documentLocation:te,trackingId:te,analyticsMode:new E({constrainTo:["legacy","next"],required:!1,default:"legacy"}),source:new M({options:{required:!1},values:kh.reduce((e,t)=>(e[t]=af,e),{})})},Iu=w("configuration/updateAnalyticsConfiguration",e=>(jo()&&(e.enabled=!1),q(e,Ry))),qu=w("configuration/analytics/disable"),ku=w("configuration/analytics/enable"),Dy=w("configuration/analytics/originlevel2",e=>q(e,{originLevel2:Cu()})),Fy=w("configuration/analytics/originlevel3",e=>q(e,{originLevel3:Cu()})),Py=Z(Pa,e=>e);function My(){return typeof window<"u"&&typeof document<"u"}function Uy(e){var r;let t=(r=e.payload)==null?void 0:r.analyticsAction;return xu(e)&&!z(t)}function xu(e){return"type"in e}var Ty=e=>t=>r=>{let n;Uy(r)&&(n=r.payload.analyticsAction,delete r.payload.analyticsAction);let a=t(r);return xu(r)&&(r.type==="search/executeSearch/fullfilled"&&n===void 0&&console.error("No analytics action associated with search:",r),r.type==="recommendation/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with recommendation:",r),r.type==="productRecommendations/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with product recommendation:",r)),n!==void 0&&e.dispatch(n),a},jy=Ae(Fl());w("tab/register",e=>{let t=new M({values:{id:F,expression:Pe}});return q(e,t)});var Ou=w("tab/updateActiveTab",e=>q(e,F)),ui=Ae(ga()),$y=Ae(Pl()),Ly=Ae(Ml());ui.default.extend(Ly.default);ui.default.extend($y.default);var Au="/rest/search/v2",Eu="/rest/ua",Vy=()=>({organizationId:"",accessToken:"",platformUrl:wi(),search:{apiBaseUrl:`${wi()}${Au}`,locale:"en-US",timezone:ui.default.tz.guess(),authenticationProviders:[]},analytics:{enabled:!0,apiBaseUrl:`${Hl()}${Eu}`,nextApiBaseUrl:"",originContext:"Search",originLevel2:"default",originLevel3:"default",anonymous:!1,deviceId:"",userDisplayName:"",documentLocation:"",trackingId:"",analyticsMode:"legacy",source:{}}});function _y(e,t){if(zg(e))return e.replace(/^(https:\/\/)platform/,"$1analytics")+Eu;let r=Ng(e,t);return r?Yl(t,r.environment).analytics:e}var Qy=Z(Vy(),e=>e.addCase(ci,(t,r)=>{r.payload.accessToken&&(t.accessToken=r.payload.accessToken),r.payload.organizationId&&(t.organizationId=r.payload.organizationId),r.payload.platformUrl&&(t.platformUrl=r.payload.platformUrl,t.search.apiBaseUrl=`${r.payload.platformUrl}${Au}`,t.analytics.apiBaseUrl=_y(r.payload.platformUrl,t.organizationId))}).addCase(Ey,(t,r)=>{r.payload.apiBaseUrl&&(t.search.apiBaseUrl=r.payload.apiBaseUrl),r.payload.locale&&(t.search.locale=r.payload.locale),r.payload.timezone&&(t.search.timezone=r.payload.timezone),r.payload.authenticationProviders&&(t.search.authenticationProviders=r.payload.authenticationProviders)}).addCase(Iu,(t,r)=>{z(r.payload.enabled)||(t.analytics.enabled=r.payload.enabled),z(r.payload.originContext)||(t.analytics.originContext=r.payload.originContext),z(r.payload.originLevel2)||(t.analytics.originLevel2=r.payload.originLevel2),z(r.payload.originLevel3)||(t.analytics.originLevel3=r.payload.originLevel3),z(r.payload.apiBaseUrl)||(t.analytics.apiBaseUrl=r.payload.apiBaseUrl),z(r.payload.nextApiBaseUrl)||(t.analytics.nextApiBaseUrl=r.payload.nextApiBaseUrl),z(r.payload.trackingId)||(t.analytics.trackingId=r.payload.trackingId),z(r.payload.analyticsMode)||(t.analytics.analyticsMode=r.payload.analyticsMode),z(r.payload.source)||(t.analytics.source=r.payload.source);let n=(0,jy.default)();n&&(t.analytics.analyticsMode="next",t.analytics.trackingId=n),z(r.payload.runtimeEnvironment)||(t.analytics.runtimeEnvironment=r.payload.runtimeEnvironment),z(r.payload.anonymous)||(t.analytics.anonymous=r.payload.anonymous),z(r.payload.deviceId)||(t.analytics.deviceId=r.payload.deviceId),z(r.payload.userDisplayName)||(t.analytics.userDisplayName=r.payload.userDisplayName),z(r.payload.documentLocation)||(t.analytics.documentLocation=r.payload.documentLocation)}).addCase(qu,t=>{t.analytics.enabled=!1}).addCase(ku,t=>{t.analytics.enabled=!0}).addCase(Dy,(t,r)=>{t.analytics.originLevel2=r.payload.originLevel2}).addCase(Fy,(t,r)=>{t.analytics.originLevel3=r.payload.originLevel3}).addCase(Ou,(t,r)=>{t.analytics.originLevel2=r.payload}).addCase(nt,(t,r)=>{t.analytics.originLevel2=r.payload.tab||t.analytics.originLevel2})),Ft=Qy;function zy(e){return e.instantlyCallable}var Ny=()=>e=>t=>e(zy(t)?t():t),By=e=>()=>t=>r=>{var i;let n=r;if(!n.error)return t(r);let a=n.error;if((i=n.payload)!=null&&i.ignored||e.error(a.stack||a.message||a.name||"Error",`Action dispatch error ${n.type}`,r),n.error.name!=="SchemaValidationError")return t(r)},Yy=e=>t=>r=>n=>(e.debug({action:n,nextState:t.getState()},`Action dispatched: ${n.type}`),r(n)),Hy=()=>({referrer:document.referrer,userAgent:navigator.userAgent,location:window.location.href}),Wy=()=>({referrer:"default",userAgent:"Node.js",location:"default"});function Gy(e,t){let r={...e},n,a=i=>(o,s)=>{let c=i(o,s);return n?n(c,s):c};return{get combinedReducer(){let i=_l(Object.entries(t).filter(([o])=>!(o in r)).map(([o,s])=>[o,()=>s]));return a(Qo({...i,...r}))},containsAll(i){return Object.keys(i).every(o=>o in r)},add(i){Object.keys(i).filter(o=>!(o in r)).forEach(o=>r[o]=i[o])},addCrossReducer(i){n=i}}}function Ru(e,t,r){var n,a,i;t===void 0&&(t=50),r===void 0&&(r={});var o=(n=r.isImmediate)!=null&&n,s=(a=r.callback)!=null&&a,c=r.maxWait,u=Date.now(),l=[];function d(){if(c!==void 0){var g=Date.now()-u;if(g+t>=c)return c-g}return t}var p=function(){var g=[].slice.call(arguments),b=this;return new Promise(function(f,m){var C=o&&i===void 0;if(i!==void 0&&clearTimeout(i),i=setTimeout(function(){if(i=void 0,u=Date.now(),!o){var T=e.apply(b,g);s&&s(T),l.forEach(function(H){return(0,H.resolve)(T)}),l=[]}},d()),C){var k=e.apply(b,g);return s&&s(k),f(k)}l.push({resolve:f,reject:m})})};return p.cancel=function(g){i!==void 0&&clearTimeout(i),l.forEach(function(b){return(0,b.reject)(g)}),l=[]},p}function Jy(e,t){let r=0,n=Ru(()=>r=0,500);return a=>i=>async o=>{if(typeof o!="function")return i(o);let s=await i(o);if(!Ky(s))return s;if(typeof t!="function")return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),s;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),s;r++,n();let c=await Zy(t);a.dispatch(ci({accessToken:c})),a.dispatch(o)}}function Ky(e){var t;return((t=e==null?void 0:e.error)==null?void 0:t.name)===new To().name}async function Zy(e){try{return await e()}catch{return""}}function Xy({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:n,name:a}){return $d({reducer:e,preloadedState:t,devTools:{stateSanitizer:i=>i.history?{...i,history:"<<OMIT>>"}:i,name:a,shouldHotReload:!1},middleware:i=>i({thunk:{extraArgument:n}}).prepend(...r).concat(Yy(n.logger))})}var ev={configuration:Ft,version:Py};function tv(e,t){var o;let r=((o=e.organizationEndpoints)==null?void 0:o.analytics)||void 0,{analyticsClientMiddleware:n,...a}=e.analytics??{},i={...a,nextApiBaseUrl:`${r}/rest/organizations/${e.organizationId}/events/v1`,apiBaseUrl:r};if(jo())return t.info("Analytics disabled since doNotTrack is active."),{...i,enabled:!1};if(i.analyticsMode==="next"&&!a.trackingId)throw new uv('analytics.trackingId is required when analytics.analyticsMode="next"');return i}function rv(e,t){var c;let r=nv(e,t),{accessToken:n,organizationId:a}=e.configuration,{organizationEndpoints:i}=e.configuration,o=(i==null?void 0:i.platform)||e.configuration.platformUrl;sv(e.configuration)&&r.logger.warn(`The \`platformUrl\` (${e.configuration.platformUrl}) option will be deprecated in the next major version. Consider using the \`organizationEndpoints\` option instead. See [Organization endpoints](https://docs.coveo.com/en/mcc80216).`),ov(e.configuration)?r.logger.warn("The `organizationEndpoints` options was not explicitly set in the Headless engine configuration. Coveo recommends setting this option, as it has resiliency benefits and simplifies the overall configuration for multi-region deployments. See [Organization endpoints](https://docs.coveo.com/en/mcc80216)."):cv(e.configuration)&&r.logger.warn(`There is a mismatch between the \`organizationId\` option (${e.configuration.organizationId}) and the organization configured in the \`organizationEndpoints\` option (${(c=e.configuration.organizationEndpoints)==null?void 0:c.platform}). This could lead to issues that are complex to troubleshoot. Please make sure both values match.`),r.dispatch(ci({accessToken:n,organizationId:a,platformUrl:o}));let s=tv(e.configuration,r.logger);return s&&r.dispatch(Iu(s)),r}function nv(e,t){let{reducers:r}=e,n=Gy({...ev,...r},e.preloadedState??{});e.crossReducer&&n.addCrossReducer(e.crossReducer);let a=t.logger,i=e.navigatorContextProvider??My()?Hy:Wy,o={...t,get relay(){return Xn(c.state)},get navigatorContext(){return i()}},s=av(e,o,n),c={addReducers(u){n.containsAll(u)||(n.add(u),s.replaceReducer(n.combinedReducer))},dispatch:s.dispatch,subscribe:s.subscribe,enableAnalytics(){s.dispatch(ku())},disableAnalytics(){s.dispatch(qu())},get state(){return s.getState()},get relay(){return Xn(this.state)},get navigatorContext(){return i()},logger:a,store:s};return c}function av(e,t,r){let{preloadedState:n,configuration:a}=e,i=a.name||"coveo-headless",o=iv(e,t.logger);return Xy({preloadedState:n,reducer:r.combinedReducer,middlewares:o,thunkExtraArguments:t,name:i})}function iv(e,t){let{renewAccessToken:r}=e.configuration,n=Jy(t,r);return[Ny,n,By(t),Ty].concat(e.middlewares||[])}function ov(e){return tt(e.organizationEndpoints)}function sv(e){var t;return!z(e.platformUrl)||z((t=e.organizationEndpoints)==null?void 0:t.platform)}function cv(e){let{platform:t}=e.organizationEndpoints;if(tt(t))return!1;let r=Ic(t);return r&&r.organizationId!==e.organizationId}var uv=class extends Error{constructor(e){super(e),this.name="InvalidEngineConfiguration"}},lv=Ae(Tl());function dv(e){return(0,lv.default)({name:"@coveo/headless",level:(e==null?void 0:e.level)||"warn",formatters:{log:e==null?void 0:e.logFormatter}})}function fv(e,t){let r=pv(e),n=ft,a=hv(e);return{analyticsClientMiddleware:r,validatePayload:n,preprocessRequest:a,logger:t}}function pv(e){let{analytics:t}=e,r=(n,a)=>a;return(t==null?void 0:t.analyticsClientMiddleware)||r}function hv(e){return e.preprocessRequest||Vo}var gv={organizationId:F,accessToken:F,platformUrl:new E({required:!1,emptyAllowed:!1}),name:new E({required:!1,emptyAllowed:!1}),analytics:new M({options:{required:!1},values:{enabled:new J({required:!1}),originContext:new E({required:!1}),originLevel2:new E({required:!1}),originLevel3:new E({required:!1}),analyticsMode:new E({constrainTo:["legacy","next"],required:!1})}})},mv=new he({...gv,context:new M({options:{required:!0},values:ys}),cart:new M({values:cf})}),yv={productListing:ei,recommendations:pu,commerceSearch:cr,commercePagination:lu,commerceSort:hu,facetOrder:ni,facetSearchSet:bu,categoryFacetSearchSet:wu,commerceFacetSet:cn,commerceContext:xa,commerceQuery:sr,cart:pf,triggers:yy};function d0(e){let t=dv(e.loggerOptions);vv(e.configuration,t);let r=Sv(e.configuration,t),n={...fv(e.configuration,t),apiClient:r},a={...e,reducers:yv},i=rv(a,n),{state:o,...s}=i;return s.dispatch(Kt(e.configuration.context)),e.configuration.cart!==void 0&&e.configuration.cart.items!==void 0&&s.dispatch(ds(e.configuration.cart.items)),df({...s,get[G](){return i.state},get configuration(){return i.state.configuration},executeFirstSearch(){let c=oe();i.dispatch(c)},executeFirstSearchAfterStandaloneSearchBoxRedirect(){let c=oe();i.dispatch(c)}})}function vv(e,t){try{mv.validate(e)}catch(r){throw t.error("Commerce engine configuration error",r),r}}function Sv(e,t){return new nd({logger:t,preprocessRequest:e.preprocessRequest||Vo})}var Du={id:F,query:Pe},Fu=w("querySet/register",e=>q(e,Du)),la=w("querySet/update",e=>q(e,Du)),Pu=Z(Oc(),e=>{e.addCase(Fu,(t,r)=>{let{id:n,query:a}=r.payload;n in t||(t[n]=a)}).addCase(la,(t,r)=>{let{id:n,query:a}=r.payload;Fn(t,n,a)}).addCase(ur,(t,r)=>{let{id:n,expression:a}=r.payload;Fn(t,n,a)}).addCase(De.fulfilled,(t,r)=>{let{queryExecuted:n}=r.payload;Mu(t,n)}).addCase(nt,bo).addCase(ti,bo).addCase(Ue.fulfilled,(t,r)=>{if(r.payload)for(let[n,a]of Object.entries(r.payload.querySet))Fn(t,n,a)})});function bo(e,t){z(t.payload.q)||Mu(e,t.payload.q)}function Mu(e,t){Object.keys(e).forEach(r=>e[r]=t)}var Fn=(e,t,r)=>{t in e&&(e[t]=r)},wv=()=>({}),li=Z(wv(),e=>e.addCase(ai,(t,r)=>{let n=r.payload.id;n in t||(t[n]=bv(r.payload))}).addCase(vy,(t,r)=>{delete t[r.payload.id]}).addCase(Rn.pending,Co).addCase(Rn.fulfilled,(t,r)=>{let n=t[r.meta.arg.id];if(!n||r.meta.requestId!==n.currentRequestId)return;let{q:a}=r.payload;a&&n.partialQueries.push(a.replace(/;/,encodeURIComponent(";"))),n.responseId=r.payload.responseId,n.completions=r.payload.completions,n.isLoading=!1,n.error=null}).addCase(Rn.rejected,Io).addCase(Ze.pending,Co).addCase(Ze.fulfilled,(t,r)=>{let n=t[r.meta.arg.id];if(!n||r.meta.requestId!==n.currentRequestId)return;let{query:a}=r.payload;a&&n.partialQueries.push(a.replace(/;/,encodeURIComponent(";"))),n.responseId=r.payload.responseId,n.completions=r.payload.completions.map(i=>({expression:i.expression,highlighted:i.highlighted,score:0,executableConfidence:0})),n.isLoading=!1,n.error=null}).addCase(Ze.rejected,Io).addCase(Qt,(t,r)=>{let n=t[r.payload.id];n&&(n.responseId="",n.completions=[],n.partialQueries=[])}));function bv(e){return{id:"",completions:[],responseId:"",count:5,currentRequestId:"",error:null,partialQueries:[],isLoading:!1,...e}}function Co(e,t){let r=e[t.meta.arg.id];r&&(r.currentRequestId=t.meta.requestId,r.isLoading=!0)}function Io(e,t){let r=e[t.meta.arg.id];r&&(r.error=t.payload||null,r.isLoading=!1)}function f0(e){return e.addReducers({querySuggest:li,querySet:Pu}),{clearQuerySuggest:Qt,fetchQuerySuggestions:Ze,registerQuerySuggest:ai,selectQuerySuggestion:ur}}Z(kc(),e=>{e.addCase(Xt,(t,r)=>({...t,...r.payload})).addCase(De.fulfilled,t=>{t.freezeFacetOrder=!1}).addCase(De.rejected,t=>{t.freezeFacetOrder=!1}).addCase(Ue.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.facetOptions)??t}).addCase(bf,(t,r)=>{t.facets[r.payload.facetId]=Tt()}).addCase(Os,(t,r)=>{t.facets[r.payload.facetId]=Tt()}).addCase(Vc,(t,r)=>{t.facets[r.payload.facetId]=Tt()}).addCase(Jc,(t,r)=>{t.facets[r.payload.facetId]=Tt()}).addCase(Ff,(t,r)=>{t.facets[r.payload].enabled=!0}).addCase(Xr,(t,r)=>{t.facets[r.payload].enabled=!1}).addCase(nt,(t,r)=>{[...Object.keys(r.payload.f??{}),...Object.keys(r.payload.fExcluded??{}),...Object.keys(r.payload.cf??{}),...Object.keys(r.payload.nf??{}),...Object.keys(r.payload.df??{})].forEach(n=>{n in t||(t.facets[n]=Tt()),t.facets[n].enabled=!0})})});var Uu=w("rangeFacet/executeToggleSelect",e=>q(e,$c(e.selection))),Tu=w("rangeFacet/executeToggleExclude",e=>q(e,$c(e.selection))),ju={facetId:re,selection:new M({values:or})};V("dateFacet/executeToggleSelect",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,ju),t(Et(e)),t(Uu(e)),t(Xt())});V("dateFacet/executeToggleExclude",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,ju),t(Rt(e)),t(Tu(e)),t(Xt())});function Pn(e,t){let r=t.payload??null;r&&(e.response=Ge().response,e.results=[],e.questionAnswer=ea()),e.error=r,e.isLoading=!1}function da(e,t){e.error=null,e.response=t.payload.response,e.queryExecuted=t.payload.queryExecuted,e.duration=t.payload.duration,e.isLoading=!1}function Cv(e,t){da(e,t),e.results=t.payload.response.results,e.searchResponseId=t.payload.response.searchUid,e.questionAnswer=t.payload.response.questionAnswer,e.extendedResults=t.payload.response.extendedResults}function Mn(e,t){e.isLoading=!0,e.requestId=t.meta.requestId}Z(Ge(),e=>{e.addCase(Cn.rejected,(t,r)=>Pn(t,r)),e.addCase(qn.rejected,(t,r)=>Pn(t,r)),e.addCase(In.rejected,(t,r)=>Pn(t,r)),e.addCase(Cn.fulfilled,(t,r)=>{Cv(t,r)}),e.addCase(qn.fulfilled,(t,r)=>{da(t,r),t.results=[...t.results,...r.payload.response.results]}),e.addCase(In.fulfilled,(t,r)=>{da(t,r),t.results=r.payload.response.results}),e.addCase(Zg.fulfilled,(t,r)=>{t.response.facets=r.payload.response.facets,t.response.searchUid=r.payload.response.searchUid}),e.addCase(Cn.pending,Mn),e.addCase(qn.pending,Mn),e.addCase(In.pending,Mn)});var $u=["idle","selected","excluded"],Lu=["ascending","descending"],Vu=["even","equiprobable"],Iv={start:new E,end:new E,endInclusive:new J,state:new E({constrainTo:$u})};new he({facetId:Cs,field:Is,generateAutomaticRanges:xs,filterFacetCount:qs,injectionDepth:ks,numberOfValues:Ea,currentValues:new ce({each:new M({values:Iv})}),sortCriteria:new E({constrainTo:Lu}),rangeAlgorithm:new E({constrainTo:Vu})});var _u={facetId:re,selection:new M({values:ir})};V("numericFacet/executeToggleSelect",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,_u),t(pt(e)),t(Uu(e)),t(Xt())});V("numericFacet/executeToggleExclude",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,_u),t(ht(e)),t(Tu(e)),t(Xt())});var qv=["allValues","atLeastOneValue"],kv={start:new j,end:new j,endInclusive:new J,state:new E({constrainTo:$u})};new he({facetId:Cs,field:Is,generateAutomaticRanges:xs,filterFacetCount:qs,injectionDepth:ks,numberOfValues:Ea,currentValues:new ce({each:new M({values:kv})}),sortCriteria:new E({constrainTo:Lu}),resultsMustMatch:new E({constrainTo:qv}),rangeAlgorithm:new E({constrainTo:Vu})});var Qu="&",fa="=",xv=e=>t=>Object.entries(t).map(e).filter(r=>r).join(Qu);function Ov(e,t){return`${e}${fa}${encodeURIComponent(t)}`}function Av(e){let[t,...r]=e.split(fa),n=r.join(fa);return[t,n]}var Ev={serialize:Dv,deserialize:Fv},Rv={serialize:()=>"",deserialize:()=>({})};function Dv(e){return xv(Pv)(e)}function Fv(e){return e.split(Qu).map(Av).filter(Mv).map(Tv).reduce((t,r)=>{let[n,a]=r;return{...t,[n]:a}},{})}function Pv(e){let[t,r]=e;return t!=="q"?"":Ov(t,r)}function Mv(e){let t=Uv(e[0]),r=e.length===2;return t&&r}function Uv(e){return e in{q:!0}}function Tv(e){let[t,r]=e;return[t,decodeURIComponent(r)]}var di=()=>({correctedQuery:"",corrections:[],originalQuery:""}),jv=(e,t)=>{var n;let r={...di(),...t,correctedQuery:(t==null?void 0:t.correctedQuery)||((n=t==null?void 0:t.corrections[0])==null?void 0:n.correctedQuery)||""};e.queryCorrection=r,e.wasCorrectedTo=r.correctedQuery};function $v(){return{wasCorrectedTo:"",queryCorrection:di(),originalQuery:""}}var Lv=Z($v(),e=>{e.addCase(oe.pending,t=>{t.queryCorrection=di(),t.wasCorrectedTo=""}).addCase(oe.fulfilled,(t,r)=>{let{queryCorrection:n}=r.payload.response;jv(t,n),t.originalQuery=r.payload.originalQuery})}),Vv=N(e=>e.queryCorrection.correctedQuery!==""||e.wasCorrectedTo!=="",e=>e);function _v(e){Qv(e);let t=we(e),r=()=>e[G].didYouMean,n=()=>Vv(r());return{...t,get state(){let a=r();return{originalQuery:a.originalQuery,wasCorrectedTo:a.wasCorrectedTo,queryCorrection:a.queryCorrection,hasQueryCorrection:n(),wasAutomaticallyCorrected:n()}}}}function Qv(e){return e.addReducers({didYouMean:Lv}),!0}var zu="hierarchical",qo={regular:{toggleSelectActionCreator:qt,toggleExcludeActionCreator:kt},numericalRange:{toggleSelectActionCreator:pt,toggleExcludeActionCreator:ht},dateRange:{toggleSelectActionCreator:Et,toggleExcludeActionCreator:Rt},[zu]:{toggleSelectActionCreator:Zr}};function zv(e,t){Nv(e);let r=we(e),{dispatch:n}=e,a=o=>({facetId:o.facetId,facetDisplayName:o.displayName,field:o.field,type:o.type,values:o.values.filter(s=>s.state!=="idle").map(s=>({value:s,deselect:()=>{s.state==="selected"?(n(qo[o.type].toggleSelectActionCreator({facetId:o.facetId,selection:s})),n(t.fetchProductsActionCreator())):s.state==="excluded"&&o.type!==zu&&(n(qo[o.type].toggleExcludeActionCreator({facetId:o.facetId,selection:s})),n(t.fetchProductsActionCreator()))}}))}),i=N(o=>o.facetOrder,o=>{let s=o.map(c=>t.facetResponseSelector(e[G],c)).filter(c=>c!==void 0).map(a)??[];return{facetBreadcrumbs:s,hasBreadcrumbs:s.length>0}});return{...r,deselectAll:()=>{n(Ve())},get state(){return i(e[G])}}}function Nv(e){return e.addReducers({facetOrder:ni,commerceFacetSet:cn}),!0}function ln(e,t){Bv(e);let{dispatch:r}=e,n=we(e),a=t.options.facetId,i=()=>{var u;return(u=e[G].commerceFacetSet[a])==null?void 0:u.request},o=()=>t.options.facetResponseSelector(e[G],a),s=()=>t.options.isFacetLoadingResponseSelector(e[G]),c=()=>{var u,l;return((l=(u=i())==null?void 0:u.values)==null?void 0:l.filter(d=>d.state!=="idle").length)??0};return{...n,toggleSelect:u=>{r(t.options.toggleSelectActionCreator({selection:u,facetId:a})),r(t.options.fetchProductsActionCreator())},toggleExclude:u=>{if(!t.options.toggleExcludeActionCreator){e.logger.warn("No toggle exclude action creator provided; calling #toggleExclude had no effect.");return}r(t.options.toggleExcludeActionCreator({selection:u,facetId:a})),r(t.options.fetchProductsActionCreator())},toggleSingleSelect:function(u){u.state==="idle"&&r(Re(a)),this.toggleSelect(u)},toggleSingleExclude:function(u){if(!t.options.toggleExcludeActionCreator){e.logger.warn("No toggle exclude action creator provided; calling #toggleSingleExclude had no effect.");return}u.state==="idle"&&r(Re(a)),this.toggleExclude(u)},isValueSelected:u=>u.state==="selected",isValueExcluded:u=>u.state==="excluded",deselectAll(){r(Re(a)),r(t.options.fetchProductsActionCreator())},showMoreValues(){var g,b;let u=((g=i())==null?void 0:g.numberOfValues)??0,l=((b=i())==null?void 0:b.initialNumberOfValues)??0,d=l-u%l,p=u+d;r(Mr({facetId:a,numberOfValues:p})),r(Ur({facetId:a,isFieldExpanded:!0})),r(t.options.fetchProductsActionCreator())},showLessValues(){var d;let u=((d=i())==null?void 0:d.initialNumberOfValues)??0,l=Math.max(u,c());r(Mr({facetId:a,numberOfValues:l})),r(Ur({facetId:a,isFieldExpanded:!1})),r(t.options.fetchProductsActionCreator())},get state(){let u=o(),l=(u==null?void 0:u.moreValuesAvailable)??!1,d=(u==null?void 0:u.values)??[],p=d.some(g=>g.state!=="idle");return{facetId:a,type:(u==null?void 0:u.type)??"regular",field:(u==null?void 0:u.field)??"",displayName:(u==null?void 0:u.displayName)??"",values:d,isLoading:s(),canShowMoreValues:l,canShowLessValues:Yv(i()),hasActiveValues:p}}}}function Bv(e){return e.addReducers({commerceFacetSet:cn}),!0}var Yv=e=>{if(!e)return!1;let t=e.initialNumberOfValues,r=!!e.values.find(n=>n.state==="idle");return(t??0)<(e.numberOfValues??0)&&r};function Nu(e,t){let r=e.dispatch,{options:n,getFacetSearch:a,executeFacetSearchActionCreator:i,executeFieldSuggestActionCreator:o}=t,{facetId:s}=n;return{updateText(c){r(_t({facetId:s,query:c,numberOfValues:a().initialNumberOfValues}))},showMoreResults(){let{initialNumberOfValues:c,options:u}=a();r(_t({facetId:s,numberOfValues:u.numberOfValues+c})),r(t.isForFieldSuggestions?o(s):i(s))},search(){r(t.isForFieldSuggestions?o(s):i(s))},clear(){r(si({facetId:s}))},updateCaptions(c){r(_t({facetId:s,captions:c}))},get state(){let{response:c,isLoading:u,options:l}=a(),{query:d}=l,p=c.values;return{...c,values:p,isLoading:u,query:d}}}}function Hv(e,t){let{dispatch:r}=e,n={...lt,...t.options},{facetId:a}=n,i=()=>"state"in e?e.state.categoryFacetSearchSet[a]:e[G].categoryFacetSearchSet[a];r(Ss(n));let o=Nu(e,{options:n,getFacetSearch:i,isForFieldSuggestions:t.isForFieldSuggestions,executeFacetSearchActionCreator:t.executeFacetSearchActionCreator,executeFieldSuggestActionCreator:t.executeFieldSuggestActionCreator});return{...o,select(s){r(Aa({facetId:a,value:s})),t.select(s)},get state(){return o.state}}}function Wv(e,t){Gv(e);let{showMoreResults:r,updateCaptions:n,...a}=Hv(e,{...t,executeFacetSearchActionCreator:Ke,executeFieldSuggestActionCreator:$e});return a}function Gv(e){return e.addReducers({categoryFacetSearchSet:wu}),!0}function Jv(e,t){let r=ln(e,{options:{...t,toggleSelectActionCreator:Zr}}),{deselectAll:n,isValueSelected:a,subscribe:i,toggleSelect:o}=r,{dispatch:s}=e,c=()=>r.state.facetId,u=Wv(e,{options:{facetId:c(),...t.facetSearch},select:()=>{s(t.fetchProductsActionCreator())},isForFieldSuggestions:!1}),{state:l,...d}=u,p=N(g=>g.categoryFacetSearchSet[c()],g=>({isLoading:g.isLoading,moreValuesAvailable:g.response.moreValuesAvailable,query:g.options.query,values:g.response.values}));return{deselectAll:n,isValueSelected:a,subscribe:i,toggleSelect:o,showMoreValues(){let{facetId:g}=t,{activeValue:b,values:f}=this.state,m=((b==null?void 0:b.children.length)??f.length)+Sr;s(Bn({facetId:g,numberOfValues:m})),s(t.fetchProductsActionCreator())},showLessValues(){let{facetId:g}=t;s(Bn({facetId:g,numberOfValues:Sr})),s(t.fetchProductsActionCreator())},facetSearch:d,get state(){let g=Zs(r.state.values),b=g.length?g[g.length-1]:void 0,f=b?b.children.length>Sr:!1,m=(b==null?void 0:b.moreValuesAvailable)??r.state.canShowMoreValues??!1,C=!!b;return{...r.state,activeValue:b,canShowLessValues:f,canShowMoreValues:m,hasActiveValues:C,selectedValueAncestry:g,facetSearch:p(e[G])}},type:"hierarchical"}}function Kv(e,t){return{...ln(e,{options:{...t,toggleSelectActionCreator:Et,toggleExcludeActionCreator:Rt}}),type:"dateRange"}}function Zv(e,t){Xv(e);let r=we(e),n=N([i=>i.facetOrder,i=>i.commerceFacetSet],(i,o)=>i.map(s=>a(o,s))),a=N((i,o)=>({facetId:o,type:i[o].request.type}),({type:i,facetId:o})=>{switch(i){case"dateRange":return t.buildDateFacet(e,{facetId:o});case"hierarchical":return t.buildCategoryFacet(e,{facetId:o});case"numericalRange":return t.buildNumericFacet(e,{facetId:o});case"regular":return t.buildRegularFacet(e,{facetId:o})}});return{...r,get facets(){return n(e[G])},get state(){return e[G].facetOrder}}}function Xv(e){return e.addReducers({facetOrder:ni,commerceFacetSet:cn}),!0}function eS(e,t){let r=ln(e,{options:{...t,toggleSelectActionCreator:pt,toggleExcludeActionCreator:ht}}),{dispatch:n}=e,{facetId:a,fetchProductsActionCreator:i}=t;return{...r,setRanges(o){n(sn({facetId:a,values:o})),n(i())},get state(){let o=t.facetResponseSelector(e[G],a);if((o==null?void 0:o.type)==="numericalRange"&&o.domain){let{min:s,max:c}=o.domain;return{...r.state,domain:{min:s,max:c}}}return{...r.state}},type:"numericalRange"}}function tS(e,t){let{dispatch:r}=e,{options:n,select:a,exclude:i,isForFieldSuggestions:o,executeFacetSearchActionCreator:s,executeFieldSuggestActionCreator:c}=t,{facetId:u}=n,l=()=>"state"in e?e.state.facetSearchSet[u]:e[G].facetSearchSet[u];r(bs(n));let d=Nu(e,{options:n,getFacetSearch:l,isForFieldSuggestions:o,executeFacetSearchActionCreator:s,executeFieldSuggestActionCreator:c});return{...d,select(p){r(Yt({facetId:u,value:p})),a(p)},exclude(p){r(Ht({facetId:u,value:p})),i(p)},singleSelect(p){r(Re(u)),r(Yt({facetId:u,value:p})),a(p)},singleExclude(p){r(Re(u)),r(Ht({facetId:u,value:p})),i(p)},get state(){let{values:p}=d.state;return{...d.state,values:p.map(({count:g,displayValue:b,rawValue:f})=>({count:g,displayValue:b,rawValue:f}))}}}}function rS(e,t){nS(e);let{showMoreResults:r,updateCaptions:n,...a}=tS(e,{...t,executeFacetSearchActionCreator:Ke,executeFieldSuggestActionCreator:$e});return{...a}}function nS(e){return e.addReducers({facetSearchSet:bu}),!0}function aS(e,t){let r=ln(e,{options:{...t,toggleSelectActionCreator:qt,toggleExcludeActionCreator:kt}}),n=()=>r.state.facetId,{dispatch:a}=e,i=rS(e,{options:{facetId:n(),...t.facetSearch},select:()=>{a(t.fetchProductsActionCreator())},exclude:()=>{a(t.fetchProductsActionCreator())},isForFieldSuggestions:!1}),{state:o,...s}=i,c=N(u=>u.facetSearchSet[n()],u=>({facetSearch:{isLoading:u.isLoading,moreValuesAvailable:u.response.moreValuesAvailable,query:u.options.query,values:u.response.values}}));return{...r,facetSearch:s,get state(){return{...r.state,...c(e[G])}},type:"regular"}}var iS=new he({pageSize:new j({min:1,max:1e3,required:!1})});function oS(e,t){var o,s;sS(e);let r=we(e),{dispatch:n}=e;Jt(e,iS,t.options,"buildCorePagination");let a=(o=t.options)==null?void 0:o.slotId;(s=t.options)!=null&&s.pageSize&&n(ca({slotId:a,pageSize:t.options.pageSize})),a&&n(uu({slotId:a}));let i=N(c=>a?c.commercePagination.recommendations[a]:c.commercePagination.principal,({perPage:c,...u})=>({pageSize:c??0,...u}));return{...r,get state(){return i(e[G])},selectPage(c){n(ou({slotId:a,page:c})),n(t.fetchProductsActionCreator())},nextPage(){n(su({slotId:a})),n(t.fetchProductsActionCreator())},previousPage(){n(cu({slotId:a})),n(t.fetchProductsActionCreator())},setPageSize(c){n(ca({slotId:a,pageSize:c})),n(t.fetchProductsActionCreator())},fetchMoreProducts(){n(t.fetchMoreProductsActionCreator())}}}function sS(e){return e.addReducers({commercePagination:lu}),!0}V("commerce/product/view",async(e,{extra:t,getState:r})=>{let{relay:n}=t,a={currency:qa(r().commerceContext),product:e};n.emit("ec.productView",a)});var cS=V("commerce/product/click",async(e,{extra:t,getState:r})=>{let{relay:n}=t,a={currency:qa(r().commerceContext),...e};n.emit("ec.productClick",a)});function uS(e,t,r){lS(e);let n=1e3,a={selectionDelay:n,debounceWait:n,...t.options},i;return{select:Ru(r,a.debounceWait,{isImmediate:!0}),beginDelayedSelect(){i=setTimeout(r,a.selectionDelay)},cancelPendingSelect(){i&&clearTimeout(i)}}}function lS(e){return e.addReducers({configuration:Ft}),!0}function dS(e,t){let r=!1;return uS(e,t,()=>{r||(r=!0,e.dispatch(cS({product:t.options.product,position:t.options.position,responseId:t.responseIdSelector(e[G])})))})}function fS(e,t){if(!t)return;let r=new he({criterion:bm});Gt(e,r,t,"buildSort")}function pS(e,t){var i;hS(e);let{dispatch:r}=e,n=we(e);fS(e,t.initialState);let a=(i=t.initialState)==null?void 0:i.criterion;return a&&r(ua(a)),{...n,get state(){return e[G].commerceSort},sortBy(o){r(ua(o)),r(tr(0)),r(t.fetchProductsActionCreator())},isSortedBy(o){return JSON.stringify(this.state.appliedSort)===JSON.stringify(o)},isAvailable(o){return this.state.availableSorts.some(s=>JSON.stringify(s)===JSON.stringify(o))}}}function hS(e){return e.addReducers({commerceSort:hu}),!0}var gS=Object.getOwnPropertyNames,mS=Object.getOwnPropertySymbols,yS=Object.prototype.hasOwnProperty;function ko(e,t){return function(r,n,a){return e(r,n,a)&&t(r,n,a)}}function vr(e){return function(t,r,n){if(!t||!r||typeof t!="object"||typeof r!="object")return e(t,r,n);var a=n.cache,i=a.get(t),o=a.get(r);if(i&&o)return i===r&&o===t;a.set(t,r),a.set(r,t);var s=e(t,r,n);return a.delete(t),a.delete(r),s}}function xo(e){return gS(e).concat(mS(e))}var Bu=Object.hasOwn||function(e,t){return yS.call(e,t)};function Pt(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var Yu="_owner",Oo=Object.getOwnPropertyDescriptor,Ao=Object.keys;function vS(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function SS(e,t){return Pt(e.getTime(),t.getTime())}function Eo(e,t,r){if(e.size!==t.size)return!1;for(var n={},a=e.entries(),i=0,o,s;(o=a.next())&&!o.done;){for(var c=t.entries(),u=!1,l=0;(s=c.next())&&!s.done;){var d=o.value,p=d[0],g=d[1],b=s.value,f=b[0],m=b[1];!u&&!n[l]&&(u=r.equals(p,f,i,l,e,t,r)&&r.equals(g,m,p,f,e,t,r))&&(n[l]=!0),l++}if(!u)return!1;i++}return!0}function wS(e,t,r){var n=Ao(e),a=n.length;if(Ao(t).length!==a)return!1;for(var i;a-- >0;)if(i=n[a],i===Yu&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!Bu(t,i)||!r.equals(e[i],t[i],i,i,e,t,r))return!1;return!0}function jt(e,t,r){var n=xo(e),a=n.length;if(xo(t).length!==a)return!1;for(var i,o,s;a-- >0;)if(i=n[a],i===Yu&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!Bu(t,i)||!r.equals(e[i],t[i],i,i,e,t,r)||(o=Oo(e,i),s=Oo(t,i),(o||s)&&(!o||!s||o.configurable!==s.configurable||o.enumerable!==s.enumerable||o.writable!==s.writable)))return!1;return!0}function bS(e,t){return Pt(e.valueOf(),t.valueOf())}function CS(e,t){return e.source===t.source&&e.flags===t.flags}function Ro(e,t,r){if(e.size!==t.size)return!1;for(var n={},a=e.values(),i,o;(i=a.next())&&!i.done;){for(var s=t.values(),c=!1,u=0;(o=s.next())&&!o.done;)!c&&!n[u]&&(c=r.equals(i.value,o.value,i.value,o.value,e,t,r))&&(n[u]=!0),u++;if(!c)return!1}return!0}function IS(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}var qS="[object Arguments]",kS="[object Boolean]",xS="[object Date]",OS="[object Map]",AS="[object Number]",ES="[object Object]",RS="[object RegExp]",DS="[object Set]",FS="[object String]",PS=Array.isArray,Do=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Fo=Object.assign,MS=Object.prototype.toString.call.bind(Object.prototype.toString);function US(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areMapsEqual,a=e.areObjectsEqual,i=e.arePrimitiveWrappersEqual,o=e.areRegExpsEqual,s=e.areSetsEqual,c=e.areTypedArraysEqual;return function(u,l,d){if(u===l)return!0;if(u==null||l==null||typeof u!="object"||typeof l!="object")return u!==u&&l!==l;var p=u.constructor;if(p!==l.constructor)return!1;if(p===Object)return a(u,l,d);if(PS(u))return t(u,l,d);if(Do!=null&&Do(u))return c(u,l,d);if(p===Date)return r(u,l,d);if(p===RegExp)return o(u,l,d);if(p===Map)return n(u,l,d);if(p===Set)return s(u,l,d);var g=MS(u);return g===xS?r(u,l,d):g===RS?o(u,l,d):g===OS?n(u,l,d):g===DS?s(u,l,d):g===ES?typeof u.then!="function"&&typeof l.then!="function"&&a(u,l,d):g===qS?a(u,l,d):g===kS||g===AS||g===FS?i(u,l,d):!1}}function TS(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?jt:vS,areDatesEqual:SS,areMapsEqual:n?ko(Eo,jt):Eo,areObjectsEqual:n?jt:wS,arePrimitiveWrappersEqual:bS,areRegExpsEqual:CS,areSetsEqual:n?ko(Ro,jt):Ro,areTypedArraysEqual:n?jt:IS};if(r&&(a=Fo({},a,r(a))),t){var i=vr(a.areArraysEqual),o=vr(a.areMapsEqual),s=vr(a.areObjectsEqual),c=vr(a.areSetsEqual);a=Fo({},a,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:s,areSetsEqual:c})}return a}function jS(e){return function(t,r,n,a,i,o,s){return e(t,r,s)}}function $S(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(s,c){var u=n(),l=u.cache,d=l===void 0?t?new WeakMap:void 0:l,p=u.meta;return r(s,c,{cache:d,equals:a,meta:p,strict:i})};if(t)return function(s,c){return r(s,c,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var o={cache:void 0,equals:a,meta:void 0,strict:i};return function(s,c){return r(s,c,o)}}_e();_e({strict:!0});_e({circular:!0});_e({circular:!0,strict:!0});_e({createInternalComparator:function(){return Pt}});_e({strict:!0,createInternalComparator:function(){return Pt}});_e({circular:!0,createInternalComparator:function(){return Pt}});_e({circular:!0,createInternalComparator:function(){return Pt},strict:!0});function _e(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,i=e.strict,o=i===void 0?!1:i,s=TS(e),c=US(s),u=n?n(c):jS(c);return $S({circular:r,comparator:c,createState:a,equals:u,strict:o})}function LS(e,t){return e.length!==t.length?!1:e.every(r=>t.findIndex(n=>fi(r,n))!==-1)}var fi=_e({createCustomConfig:e=>({...e,areArraysEqual:LS})}),VS=new j({min:1,default:8,required:!1}),_S=new j({min:1,max:20,default:5,required:!1}),QS={desiredCount:_S,numberOfValues:VS};w("automaticFacet/setOptions",e=>q(e,QS));w("automaticFacet/deselectAll",e=>q(e,re));var zS=F,NS=w("automaticFacet/toggleSelectValue",e=>q(e,{field:zS,selection:new M({values:Ra})}));Z(Qa(),e=>{e.addCase(mg,(t,r)=>{let n=Un(t),a=r.payload;t.defaultNumberOfResults=t.numberOfResults=a,t.firstResult=$t(n,a)}).addCase(yg,(t,r)=>{t.numberOfResults=r.payload,t.firstResult=0}).addCase(Ou,t=>{t.firstResult=0}).addCase(vg,(t,r)=>{let n=r.payload;t.firstResult=$t(n,t.numberOfResults)}).addCase(tr,(t,r)=>{let n=r.payload;t.firstResult=$t(n,t.numberOfResults)}).addCase(wg,t=>{let r=Un(t),n=Math.max(r-1,1);t.firstResult=$t(n,t.numberOfResults)}).addCase(Sg,t=>{let r=Un(t),n=BS(t),a=Math.min(r+1,n);t.firstResult=$t(a,t.numberOfResults)}).addCase(Ue.fulfilled,(t,r)=>{r.payload&&(t.numberOfResults=r.payload.pagination.numberOfResults,t.firstResult=r.payload.pagination.firstResult)}).addCase(nt,(t,r)=>{t.firstResult=r.payload.firstResult??t.firstResult,t.numberOfResults=r.payload.numberOfResults??t.defaultNumberOfResults}).addCase(De.fulfilled,(t,r)=>{let{response:n}=r.payload;t.totalCountFiltered=n.totalCountFiltered}).addCase(nn.fulfilled,(t,r)=>{let{response:n}=r.payload;t.totalCountFiltered=n.pagination.totalCount}).addCase(Re,t=>{me(t)}).addCase(Rt,t=>{me(t)}).addCase(kt,t=>{me(t)}).addCase(ht,t=>{me(t)}).addCase(Ht,t=>{me(t)}).addCase(qt,t=>{me(t)}).addCase(Cf,t=>{me(t)}).addCase(Zr,t=>{me(t)}).addCase(Aa,t=>{me(t)}).addCase(Et,t=>{me(t)}).addCase(pt,t=>{me(t)}).addCase(Ve,t=>{me(t)}).addCase(_c,t=>{me(t)}).addCase(sn,t=>{me(t)}).addCase(Yt,t=>{me(t)}).addCase(NS,t=>{me(t)})});function me(e){e.firstResult=Qa().firstResult}function Un(e){let{firstResult:t,numberOfResults:r}=e;return YS(t,r)}function BS(e){let{totalCountFiltered:t,numberOfResults:r}=e;return HS(t,r)}function $t(e,t){return(e-1)*t}function YS(e,t){return Math.round(e/t)+1}function HS(e,t){let r=Math.min(e,5e3);return Math.ceil(r/t)}new he({parameters:new M({options:{required:!0},values:cc})});var WS=new he({fragment:new E});function GS(e,t){let r;function n(){r=t.requestIdSelector(e[G])}function a(){return r!==t.requestIdSelector(e[G])}Gt(e,WS,t.initialState,"buildUrlManager");let i=we(e),o=t.initialState.fragment;n();let s=t.parameterManagerBuilder(e,{initialState:{parameters:t.serializer.deserialize(o)}});return{...i,subscribe(c){let u=()=>{let l=this.state.fragment;!JS(t.serializer.deserialize,o,l)&&a()&&(o=l,c()),n()};return u(),e.subscribe(u)},get state(){return{fragment:t.serializer.serialize(s.state.parameters)}},synchronize(c){o=c;let u=t.serializer.deserialize(c);s.synchronize(u)}}}function JS(e,t,r){if(t===r)return!0;let n=e(t),a=e(r);return fi(n,a)}function KS(e,t){return{...Hu(e,t),didYouMean(){return _v(e)}}}function ZS(e,t){return Hu(e,t)}function Hu(e,t){let{fetchProductsActionCreator:r,facetResponseSelector:n,isFacetLoadingResponseSelector:a,requestIdSelector:i,parameterManagerBuilder:o,serializer:s}=t;return{...Wu(e,t),sort(c){return pS(e,{...c,fetchProductsActionCreator:r})},facetGenerator(){let c={fetchProductsActionCreator:r,facetResponseSelector:n,isFacetLoadingResponseSelector:a};return Zv(e,{buildRegularFacet:(u,l)=>aS(e,{...l,...c}),buildNumericFacet:(u,l)=>eS(e,{...l,...c}),buildDateFacet:(u,l)=>Kv(e,{...l,...c}),buildCategoryFacet:(u,l)=>Jv(e,{...l,...c})})},breadcrumbManager(){return zv(e,{facetResponseSelector:n,fetchProductsActionCreator:r})},urlManager(c){return GS(e,{...c,requestIdSelector:i,parameterManagerBuilder:o,serializer:s})}}}function Wu(e,t){let{responseIdSelector:r,fetchProductsActionCreator:n,fetchMoreProductsActionCreator:a,slotId:i}=t;return{interactiveProduct(o){return dS(e,{...o,responseIdSelector:r})},pagination(o){return oS(e,{...o,options:{...o==null?void 0:o.options,slotId:i},fetchProductsActionCreator:n,fetchMoreProductsActionCreator:a})}}}function Gu(e,t){return!!t&&t.facetId in e.commerceFacetSet}var XS=(e,t)=>{let r=e.productListing.facets.find(n=>n.facetId===t);if(Gu(e,r))return r},ew=e=>e.productListing.isLoading,tw=e=>new he({parameters:new M({options:{required:!0},values:e})});function Ju(e,t){let{dispatch:r}=e,n=we(e);return Gt(e,tw(t.parametersDefinition),t.initialState,"buildCoreParameterManager"),r(t.restoreActionCreator(t.initialState.parameters)),{...n,synchronize(a){let i=t.activeParametersSelector(e[G]),o=t.enrichParameters(e[G],i),s=t.enrichParameters(e[G],a);fi(o,s)||(r(t.restoreActionCreator(a)),r(t.fetchProductsActionCreator()))},get state(){return{parameters:t.activeParametersSelector(e[G])}}}}function rw(e,t){return Ju(e,{...t,parametersDefinition:fu,activeParametersSelector:nw,restoreActionCreator:iy,fetchProductsActionCreator:Oe,enrichParameters:()=>({})})}function nw(e){return{}}function p0(e){aw(e);let t=we(e),{dispatch:r}=e,n=()=>e[G],a=ZS(e,{responseIdSelector:Kc,fetchProductsActionCreator:Oe,fetchMoreProductsActionCreator:qr,facetResponseSelector:XS,isFacetLoadingResponseSelector:ew,requestIdSelector:Am,parameterManagerBuilder:rw,serializer:Rv});return{...t,...a,get state(){let{products:i,error:o,isLoading:s,responseId:c}=n().productListing;return{products:i,error:o,isLoading:s,responseId:c}},refresh:()=>r(Oe())}}function aw(e){return e.addReducers({productListing:ei,commerceContext:xa,configuration:Ft}),!0}function h0(e,t){iw(e),Gt(e,Xm,t.options,"buildRecommendations");let r=we(e),{dispatch:n}=e,{slotId:a,productId:i}=t.options;n(iu({slotId:a}));let o=N(c=>c.recommendations[a],c=>c),s=Wu(e,{slotId:a,responseIdSelector:c=>c.recommendations[a].responseId,fetchProductsActionCreator:()=>vt({slotId:a}),fetchMoreProductsActionCreator:()=>Or({slotId:a})});return{...r,...s,get state(){return o(e[G])},refresh:()=>n(vt({slotId:a,productId:i}))}}function iw(e){return e.addReducers({recommendations:pu}),!0}var ow=(e,t)=>{let r=e.commerceSearch.facets.find(n=>n.facetId===t);if(Gu(e,r))return r},sw=e=>e.commerceSearch.isLoading;function cw(e,t){return dw(e),Ju(e,{...t,activeParametersSelector:uw,restoreActionCreator:ti,parametersDefinition:du,fetchProductsActionCreator:oe,enrichParameters:(r,n)=>({q:ri().query,...n})})}function uw(e){return{...lw(e)}}function lw(e){if(e.commerceQuery===void 0)return{};let t=e.commerceQuery.query;return t!==ri().query?{q:t}:{}}function dw(e){return e.addReducers({commerceQuery:sr}),!0}function g0(e){fw(e);let t=we(e),{dispatch:r}=e,n=()=>e[G],a=KS(e,{responseIdSelector:oa,fetchProductsActionCreator:oe,fetchMoreProductsActionCreator:kr,facetResponseSelector:ow,isFacetLoadingResponseSelector:sw,requestIdSelector:Fm,parameterManagerBuilder:cw,serializer:Ev});return{...t,...a,get state(){return n().commerceSearch},executeFirstSearch(){oa(n())===""&&r(oe())}}}function fw(e){return e.addReducers({commerceContext:xa,configuration:Ft,commerceSearch:cr,commerceQuery:sr}),!0}Z(Ot(),e=>e.addCase(rr,(t,r)=>({...t,...r.payload})).addCase(_a,(t,r)=>{t.q=r.payload}).addCase(ur,(t,r)=>{t.q=r.payload.expression}).addCase(Ue.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.query)??t}).addCase(nt,(t,r)=>{t.q=r.payload.q??t.q,t.enableQuerySyntax=r.payload.enableQuerySyntax??t.enableQuerySyntax}));function pw(e,t){return e=hw(e),e.replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,(r,n,a,i)=>n?Tn(n,t.notMatchDelimiters):a?Tn(a,t.exactMatchDelimiters):i?Tn(i,t.correctionDelimiters):r)}function Tn(e,t){return t?t.open+e+t.close:e}function hw(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r="(?:"+Object.keys(t).join("|")+")",n=RegExp(r),a=RegExp(r,"g");return n.test(e)?e.replace(a,i=>t[i]):e}var jn={open:new E,close:new E},gw={id:F,numberOfSuggestions:new j({min:0}),enableQuerySyntax:new J,highlightOptions:new M({values:{notMatchDelimiters:new M({values:jn}),exactMatchDelimiters:new M({values:jn}),correctionDelimiters:new M({values:jn})}}),clearFilters:new J};function mw(e,t){return e?e.completions.map(r=>({highlightedValue:pw(r.highlighted,t),rawValue:r.expression})):[]}var Ku={clearFilters:!0},{id:yw,highlightOptions:vw,clearFilters:Sw}=gw,Zu={id:yw,highlightOptions:vw,clearFilters:Sw},ww=new he(Zu);function bw(e,t={}){var u,l;Cw(e);let r=we(e),{dispatch:n}=e,a=()=>e[G],i=((u=t.options)==null?void 0:u.id)||ma("search_box"),o={id:i,highlightOptions:{...(l=t.options)==null?void 0:l.highlightOptions},...Ku,...t.options};Jt(e,ww,o,"buildSearchBox"),n(Fu({id:i,query:a().commerceQuery.query??""})),n(ai({id:i}));let s=()=>a().querySet[o.id],c=async()=>{let d={query:s(),clearFilters:o.clearFilters};n(Xc(d)),n(oe())};return{...r,updateText(d){n(la({id:i,query:d})),this.showSuggestions()},clear(){n(la({id:i,query:""})),n(Qt({id:i}))},showSuggestions(){n(Ze({id:i}))},selectSuggestion(d){n(ur({id:i,expression:d})),c().then(()=>{n(Qt({id:i}))})},submit(){c(),n(Qt({id:i}))},get state(){let d=a().querySuggest[o.id],p=mw(d,o.highlightOptions),g=d?d.isLoading:!1;return{value:s(),suggestions:p,isLoading:a().commerceSearch.isLoading,isLoadingSuggestions:g}}}}function Cw(e){return e.addReducers({commerceQuery:sr,querySuggest:li,configuration:Ft,querySet:Pu,commerceSearch:cr}),!0}var Iw={queries:new ce({required:!0,each:new E({emptyAllowed:!1})}),maxLength:new j({required:!0,min:1,default:10})},pi=w("recentQueries/registerRecentQueries",e=>q(e,Iw)),hi=w("recentQueries/clearRecentQueries");function Xu(){return{queries:[],maxLength:10}}Z(Xu(),e=>{e.addCase(pi,el).addCase(hi,tl).addCase(De.fulfilled,(t,r)=>{let n=r.payload.queryExecuted.trim(),a=r.payload.response.results;!n.length||!a.length||rl(n,t)})});function el(e,t){e.queries=t.payload.queries.slice(0,t.payload.maxLength),e.maxLength=t.payload.maxLength}function tl(e){e.queries=[]}function rl(e,t){t.queries=t.queries.filter(n=>n!==e);let r=t.queries.slice(0,t.maxLength-1);t.queries=[e,...r]}var qw=Z(Xu(),e=>{e.addCase(pi,el).addCase(hi,tl).addCase(oe.fulfilled,(t,r)=>{var i;let n=((i=r.payload.queryExecuted)==null?void 0:i.trim())||"",a=r.payload.response.products;!n.length||!a.length||rl(n,t)})}),kw={queries:[]},xw={maxLength:10,clearFilters:!0},Ow=new he({queries:new ce({required:!0})}),Aw=new he({maxLength:new j({required:!0,min:1}),clearFilters:new J});function Ew(e,t){Jt(e,Aw,t==null?void 0:t.options,"buildRecentQueriesList"),Gt(e,Ow,t==null?void 0:t.initialState,"buildRecentQueriesList")}function m0(e,t){Rw(e);let r=we(e),{dispatch:n}=e,a=()=>e[G],i={...xw,...t==null?void 0:t.options},o={...kw,...t==null?void 0:t.initialState};Ew(e,{options:i,initialState:o});let s={queries:o.queries,maxLength:i.maxLength};return n(pi(s)),{...r,get state(){let c=a();return{...c.recentQueries,analyticsEnabled:c.configuration.analytics.enabled}},clear(){n(hi())},executeRecentQuery(c){let u=new j({required:!0,min:0,max:this.state.queries.length}).validate(c);if(u)throw new Error(u);let l={query:this.state.queries[c],clearFilters:i.clearFilters};n(Xc(l)),n(oe())}}}function Rw(e){return e.addReducers({search:cr,recentQueries:qw}),!0}var gi={id:F},Dw={...gi,query:Pe},nl=w("instantProducts/register",e=>q(e,gi)),al=w("instantProducts/updateQuery",e=>q(e,Dw)),il=w("instantProducts/clearExpired",e=>q(e,gi));function ol(e){return e?e.expiresAt&&Date.now()>=e.expiresAt:!1}var Fw=(e,t)=>{let{id:r}=e;if(!t[r])return t[r]={q:"",cache:{}},t},Pw=(e,t)=>{let{q:r,id:n}=e;r&&(t[n].q=r)},Mw=(e,t)=>{let{id:r}=e;Object.entries(t[r].cache).forEach(([n,a])=>{ol(a)&&delete t[r].cache[n]})},Uw=(e,t,r)=>{for(let a in t)for(let i in t[a].cache)t[a].cache[i].isActive=!1;if(!pa(e,t)){$w(e,t,r);return}let n=pa(e,t);n.isLoading=!0,n.isActive=!0,n.error=null},Tw=(e,t,r)=>{let{id:n,q:a,searchUid:i,cacheTimeout:o,totalCountFiltered:s,duration:c}=e;t[n].cache[a]={...pa(e,t),...r,isActive:!0,searchUid:i,isLoading:!1,error:null,expiresAt:o?o+Date.now():0,totalCountFiltered:s,duration:c}},jw=(e,t)=>{let{id:r,q:n,error:a}=e;t[r].cache[n].error=a||null,t[r].cache[n].isLoading=!1,t[r].cache[n].isActive=!1},pa=(e,t)=>{let{q:r,id:n}=e;return t[n].cache[r]||null},$w=(e,t,r)=>{let{q:n,id:a}=e;t[a].cache[n]={isLoading:!0,error:null,expiresAt:0,isActive:!0,searchUid:"",totalCountFiltered:0,duration:0,...r}};function Lw(){return{}}var Vw=Z(Lw(),e=>{e.addCase(nl,(t,r)=>{Fw(r.payload,t)}).addCase(al,(t,r)=>{Pw({...r.payload,q:r.payload.query},t)}).addCase(il,(t,r)=>{Mw(r.payload,t)}).addCase(xr.pending,(t,r)=>{Uw(r.meta.arg,t,{products:[]})}).addCase(xr.fulfilled,(t,r)=>{let{response:{products:n,responseId:a,pagination:{totalEntries:i}}}=r.payload;Tw({duration:0,searchUid:a,totalCountFiltered:i,...r.meta.arg},t,{products:n})}).addCase(xr.rejected,(t,r)=>{jw(r.meta.arg,t)})}),_w={searchBoxId:te,cacheTimeout:new j},Qw=new he(_w);function y0(e,t){zw(e);let r=we(e),{dispatch:n}=e,a=()=>e[G],i={searchBoxId:t.options.searchBoxId||ma("instant-products-"),cacheTimeout:t.options.cacheTimeout||6e4};Jt(e,Qw,i,"buildInstantProducts");let o=i.searchBoxId;n(nl({id:o}));let s=()=>a().instantProducts[o],c=d=>s().cache[d],u=()=>s().q,l=()=>{let d=c(u());return d?d.isLoading?[]:d.products:[]};return{...r,updateQuery(d){if(!d)return;let p=c(d);(!p||!p.isLoading&&(p.error||ol(p)))&&n(xr({id:o,q:d,cacheTimeout:i.cacheTimeout})),n(al({id:o,query:d}))},clearExpired(){n(il({id:o}))},get state(){let d=u(),p=c(d);return{query:d,isLoading:(p==null?void 0:p.isLoading)||!1,error:(p==null?void 0:p.error)||null,products:l()}}}}function zw(e){return e.addReducers({instantProducts:Vw}),!0}function sl(e){return e.type==="redirect"}var Nw=w("standaloneSearchBox/register",e=>q(e,{id:F,redirectionUrl:F})),Bw=w("standaloneSearchBox/reset",e=>q(e,{id:F})),Ar=V("commerce/standaloneSearchBox/fetchRedirect",async(e,{getState:t,rejectWithValue:r,extra:n})=>{q(e,{id:new E({emptyAllowed:!1})});let a=t(),{apiClient:i}=n,o=await Yw(a),s=await i.plan(o);if(Me(s))return r(s.error);let c=s.success.triggers.filter(sl);return c.length?c[0].content:""}),Yw=async e=>({query:e.commerceQuery.query,...await Ya(e)}),Hw=class{constructor(e){this.response=e}get basicExpression(){return this.response.parsedInput.basicExpression}get largeExpression(){return this.response.parsedInput.largeExpression}get redirectionUrl(){let e=this.response.preprocessingOutput.triggers.filter(sl);return e.length?e[0].content:null}},Ww=w("standaloneSearchBox/register",e=>q(e,{id:F,redirectionUrl:F})),Gw=w("standaloneSearchBox/reset",e=>q(e,{id:F}));w("standaloneSearchBox/updateAnalyticsToSearchFromLink",e=>q(e,{id:F}));w("standaloneSearchBox/updateAnalyticsToOmniboxFromLink");V("standaloneSearchBox/fetchRedirect",async(e,{dispatch:t,getState:r,rejectWithValue:n,extra:{apiClient:a,validatePayload:i}})=>{i(e,{id:new E({emptyAllowed:!1})});let o=await Kw(r()),s=await a.plan(o);if(Je(s))return n(s.error);let{redirectionUrl:c}=new Hw(s.success);return c&&t(Jw(c)),c||""});var Jw=e=>At("analytics/standaloneSearchBox/redirect",t=>t.makeTriggerRedirect({redirectedTo:e})),Kw=async e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,timezone:e.configuration.search.timezone,q:e.query.q,...e.context&&{context:e.context.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub},...e.configuration.analytics.enabled&&{visitorId:await rt(e.configuration.analytics)},...e.configuration.analytics.enabled&&await on(e.configuration.analytics),...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});function Zw(){return{}}var Xw=Z(Zw(),e=>e.addCase(Ww,(t,r)=>{let{id:n,redirectionUrl:a}=r.payload;n in t||(t[n]=Po(a))}).addCase(Gw,(t,r)=>{let{id:n}=r.payload,a=t[n];if(a){t[n]=Po(a.defaultRedirectionUrl);return}}).addCase(Ar.pending,(t,r)=>{let n=t[r.meta.arg.id];n&&(n.isLoading=!0)}).addCase(Ar.fulfilled,(t,r)=>{let n=r.payload,a=t[r.meta.arg.id];a&&(a.redirectTo=n||a.defaultRedirectionUrl,a.isLoading=!1)}).addCase(Ar.rejected,(t,r)=>{let n=t[r.meta.arg.id];n&&(n.isLoading=!1)}));function Po(e){return{defaultRedirectionUrl:e,redirectTo:"",isLoading:!1}}var e0=new he({...Zu,redirectionUrl:new E({required:!0,emptyAllowed:!1})});function v0(e,t){t0(e);let{dispatch:r}=e,n=()=>e[G],a=t.options.id||ma("standalone_search_box"),i={id:a,highlightOptions:{...t.options.highlightOptions},...Ku,...t.options};Jt(e,e0,i,"buildStandaloneSearchBox");let o=bw(e,{options:i});return r(Nw({id:a,redirectionUrl:i.redirectionUrl})),{...o,updateText(s){o.updateText(s)},selectSuggestion(s){r(ur({id:a,expression:s})),this.submit()},afterRedirection(){r(Bw({id:a}))},submit(){r(Ja({query:this.state.value})),r(Ar({id:a}))},get state(){let s=n().commerceStandaloneSearchBoxSet[a];return{...o.state,redirectTo:s.redirectTo}}}}function t0(e){return e.addReducers({commerceQuery:sr,commerceStandaloneSearchBoxSet:Xw,configuration:Ft,querySuggest:li}),!0}var r0=new he({content:new de({required:!0}),conditions:new de({required:!0}),priority:new j({required:!1,default:0,min:0}),fields:new ce({required:!1,each:F})});function n0(){let e=[],t=r=>{let n=r0.validate(r);if(!r.conditions.every(a=>a instanceof Function))throw new Gr("Each template condition should be a function that takes a Result or Product as an argument and returns a boolean");return n};return{registerTemplates(...r){r.forEach(n=>{let a={...t(n),fields:n.fields||[]};e.push(a)}),e.sort((n,a)=>a.priority-n.priority)},selectTemplate(r){let n=e.find(a=>a.conditions.every(i=>i(r)));return n?n.content:null}}}function S0(){return n0()}var cl=(e,t)=>{let r=we(e),{options:{selectNumProducts:n,selectResponseId:a,selectLoading:i,selectError:o}}=t,s=()=>e[G],c=()=>Om(s()),u=()=>Ha(s()),l=()=>Wa(s()),d=()=>!!a(s()),p=()=>d()&&l()>0,g=()=>p()?c()*u()+1:0,b=()=>p()?g()+(n(s())-1):0;return{...r,get state(){return{firstSearchExecuted:d(),firstProduct:g(),lastProduct:b(),totalNumberOfProducts:l(),hasProducts:p(),isLoading:i(s()),hasError:o(s())!==null}}}};function a0(e){return e.addReducers({commerceSearch:cr}),!0}var w0=e=>{a0(e);let t=cl(e,{options:{selectNumProducts:Ka,selectResponseId:oa,selectLoading:Mm,selectError:Um}});return{...t,get state(){return{...t.state,query:Tm(e[G])||""}}}};function i0(e){return e.addReducers({productListing:ei}),!0}var b0=e=>(i0(e),cl(e,{options:{selectNumProducts:Ga,selectResponseId:Kc,selectLoading:Rm,selectError:Dm}})),dn=(e,t)=>{let r=e;return z(r[t])?z(e.additionalFields[t])?null:e.additionalFields[t]:r[t]},o0=e=>t=>e.every(r=>!z(dn(t,r))),s0=e=>t=>e.every(r=>z(dn(t,r))),c0=(e,t)=>r=>{let n=ul(e,r);return t.some(a=>n.some(i=>`${i}`.toLowerCase()===a.toLowerCase()))},u0=(e,t)=>r=>{let n=ul(e,r);return t.every(a=>n.every(i=>`${i}`.toLowerCase()!==a.toLowerCase()))},ul=(e,t)=>{let r=dn(t,e);return os(r)?r:[r]},C0={getProductProperty:dn,fieldsMustBeDefined:o0,fieldsMustNotBeDefined:s0,fieldMustMatch:c0,fieldMustNotMatch:u0};function l0(){return[]}Z(l0(),e=>{e.addCase(Ze.fulfilled,(t,r)=>r.payload.fieldSuggestionsFacets??[])});jl();export{p0 as E,h0 as F,d0 as G,Yl as J,g0 as Q,y0 as U,v0 as X,f0 as l,Ja as m,S0 as n,w0 as o,C0 as p,bw as r,b0 as s,m0 as y};
