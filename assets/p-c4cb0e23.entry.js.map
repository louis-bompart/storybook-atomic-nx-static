{"version":3,"names":["ColorFacetCheckbox","props","children","id","randomID","count","numberOfResults","toLocaleString","i18n","language","ariaLabel","t","value","displayValue","partValue","_a","match","RegExp","toString","labelRef","h","key","class","role","part","isSelected","onClick","onMouseDown","e","createRipple","color","parent","ref","htmlFor","text","atomicColorFacetCss","AtomicColorFacetStyle0","AtomicColorFacet","this","resultIndexToFocusOnShowMore","label","numberOfValues","withSearch","sortCriteria","resultsMustMatch","displayValuesAs","isCollapsed","headingLevel","filterFacetCount","injectionDepth","dependsOn","allowedValues","customSort","initialize","searchStatus","buildSearchStatus","bindings","engine","facet","buildFacet","options","facetOptions","announceFacetSearchResultsWithAriaLive","msg","facetSearchAriaMessage","facetId","state","facetInfo","element","host","isHidden","store","registerFacet","initializePopover","hasValues","values","length","numberOfActiveValues","numberOfSelectedValues","initializeDependenciesManager","focusTargets","showLessFocus","FocusTargetController","showMoreFocus","headerFocus","disconnectedCallback","isConnected","dependenciesManager","stopWatching","searchStatusState","hasError","enabled","componentShouldUpdate","next","prev","propName","shouldUpdateFacetSearchComponent","facetSearch","facetState","filter","buildFacetConditionsManager","conditions","parseDependsOn","renderHeader","FacetHeader","onClearFilters","focusAfterSearch","deselectAll","onToggleCollapse","headerRef","el","setTarget","renderSearchInput","FacetSearchInput","query","onChange","clear","updateCaptions","getFieldCaptions","field","updateText","search","onClear","renderValue","facetValue","isShowLessFocusTarget","isShowMoreFocusTarget","getFieldValueCaption","isExcluded","partValueWithDisplayValue","replace","partValueWithAPIValue","searchQuery","buttonRef","FacetValueLabelHighlight","FacetValueBox","renderValuesContainer","classes","FacetValuesGroup","renderValues","map","i","toggleSelect","renderSearchResults","rawValue","select","renderMatches","FacetSearchMatches","numberOfMatches","hasMoreMatches","moreValuesAvailable","renderShowMoreLess","FacetShowMoreLess","onShowMore","showMoreValues","onShowLess","showLessValues","canShowLessValues","canShowMoreValues","undefined","render","Hidden","firstSearchExecuted","FacetPlaceholder","FacetContainer","shouldDisplaySearchResults","__decorate","InitializeBindings","BindStateToController","MapProp","ArrayProp","AriaLiveRegion"],"sources":["src/components/search/facets/color-facet-checkbox/color-facet-checkbox.tsx","src/components/search/facets/atomic-color-facet/atomic-color-facet.pcss?tag=atomic-color-facet&encapsulation=shadow","src/components/search/facets/atomic-color-facet/atomic-color-facet.tsx"],"sourcesContent":["import {FunctionalComponent, h} from '@stencil/core';\r\nimport {createRipple} from '../../../../utils/ripple';\r\nimport {randomID} from '../../../../utils/utils';\r\nimport {FacetValueProps} from '../../../common/facets/facet-common';\r\n\r\nexport const ColorFacetCheckbox: FunctionalComponent<FacetValueProps> = (\r\n  props,\r\n  children\r\n) => {\r\n  const id = randomID('facet-value-');\r\n  const count = props.numberOfResults.toLocaleString(props.i18n.language);\r\n  const ariaLabel = props.i18n.t('facet-value', {\r\n    value: props.displayValue,\r\n    count: props.numberOfResults,\r\n  });\r\n  const partValue = props.displayValue\r\n    .match(new RegExp('-?[_a-zA-Z]+[_a-zA-Z0-9-]*'))\r\n    ?.toString();\r\n  let labelRef: HTMLLabelElement;\r\n\r\n  return (\r\n    <li key={props.displayValue} class=\"relative flex items-center\">\r\n      <button\r\n        id={id}\r\n        role=\"checkbox\"\r\n        part={`value-checkbox value-${partValue}${\r\n          props.isSelected ? ' value-checkbox-checked' : ''\r\n        }`}\r\n        onClick={() => props.onClick()}\r\n        onMouseDown={(e) =>\r\n          createRipple(e, {color: 'neutral', parent: labelRef})\r\n        }\r\n        aria-checked={props.isSelected.toString()}\r\n        class={`value-checkbox ${props.isSelected ? 'ring-primary' : ''}`}\r\n        aria-label={ariaLabel}\r\n      ></button>\r\n      <label\r\n        ref={(ref) => (labelRef = ref!)}\r\n        htmlFor={id}\r\n        part=\"value-checkbox-label\"\r\n        onMouseDown={(e) => createRipple(e, {color: 'neutral'})}\r\n      >\r\n        {children}\r\n        <span part=\"value-count\" class=\"value-count\">\r\n          {props.i18n.t('between-parentheses', {\r\n            text: count,\r\n          })}\r\n        </span>\r\n      </label>\r\n    </li>\r\n  );\r\n};\r\n","@import '../../../common/facets/facet-common.pcss';\r\n@import '../../../common/facets/facet-search/facet-search.pcss';\r\n@import '../../../common/facets/facet-value-box/facet-value-box.pcss';\r\n@import '../color-facet-checkbox/color-facet-checkbox.pcss';\r\n\r\n/**\r\n * @prop --atomic-facet-color-boxes-per-row: Number of facet values for the Color Facet to display per row, when the display is 'box'\r\n * @prop --atomic-facet-color-boxes-gap: Gap value for facet values for the Color Facet , when the display is 'box'\r\n */\r\n.box-color-container {\r\n  @apply grid px-2;\r\n  grid-template-columns: repeat(var(--atomic-facet-color-boxes-per-row, 3), minmax(0, 1fr));\r\n  gap: var(--atomic-facet-color-boxes-gap, 0.5rem);\r\n}\r\n","import {\r\n  Facet,\r\n  buildFacet,\r\n  FacetState,\r\n  FacetOptions,\r\n  FacetSortCriterion,\r\n  SearchStatus,\r\n  SearchStatusState,\r\n  buildSearchStatus,\r\n  FacetValue,\r\n  buildFacetConditionsManager,\r\n  FacetConditionsManager,\r\n  FacetResultsMustMatch,\r\n  FacetValueRequest,\r\n  CategoryFacetValueRequest,\r\n} from '@coveo/headless';\r\nimport {Component, h, State, Prop, VNode, Element} from '@stencil/core';\r\nimport {\r\n  AriaLiveRegion,\r\n  FocusTargetController,\r\n} from '../../../../utils/accessibility-utils';\r\nimport {\r\n  getFieldCaptions,\r\n  getFieldValueCaption,\r\n} from '../../../../utils/field-utils';\r\nimport {\r\n  BindStateToController,\r\n  InitializableComponent,\r\n  InitializeBindings,\r\n} from '../../../../utils/initialization-utils';\r\nimport {ArrayProp, MapProp} from '../../../../utils/props-utils';\r\nimport {parseDependsOn} from '../../../common/facets/depends-on';\r\nimport {FacetInfo} from '../../../common/facets/facet-common-store';\r\nimport {FacetContainer} from '../../../common/facets/facet-container/facet-container';\r\nimport {FacetHeader} from '../../../common/facets/facet-header/facet-header';\r\nimport {FacetPlaceholder} from '../../../common/facets/facet-placeholder/facet-placeholder';\r\nimport {announceFacetSearchResultsWithAriaLive} from '../../../common/facets/facet-search/facet-search-aria-live';\r\nimport {FacetSearchInput} from '../../../common/facets/facet-search/facet-search-input';\r\nimport {FacetSearchMatches} from '../../../common/facets/facet-search/facet-search-matches';\r\nimport {\r\n  shouldUpdateFacetSearchComponent,\r\n  shouldDisplaySearchResults,\r\n} from '../../../common/facets/facet-search/facet-search-utils';\r\nimport {FacetShowMoreLess} from '../../../common/facets/facet-show-more-less/facet-show-more-less';\r\nimport {FacetValueBox} from '../../../common/facets/facet-value-box/facet-value-box';\r\nimport {FacetValueLabelHighlight} from '../../../common/facets/facet-value-label-highlight/facet-value-label-highlight';\r\nimport {FacetValuesGroup} from '../../../common/facets/facet-values-group/facet-values-group';\r\nimport {Hidden} from '../../../common/hidden';\r\nimport {Bindings} from '../../atomic-search-interface/atomic-search-interface';\r\nimport {initializePopover} from '../atomic-popover/popover-type';\r\nimport {ColorFacetCheckbox} from '../color-facet-checkbox/color-facet-checkbox';\r\n\r\n/**\r\n * A facet is a list of values for a certain field occurring in the results, ordered using a configurable criteria (e.g., number of occurrences).\r\n * An `atomic-color-facet` displays a facet of the results for the current query as colors.\r\n *\r\n * @part facet - The wrapper for the entire facet.\r\n * @part placeholder - The placeholder shown before the first search is executed.\r\n *\r\n * @part label-button - The button that displays the label and allows to expand/collapse the facet.\r\n * @part label-button-icon - The label button icon.\r\n * @part clear-button - The button that resets the actively selected facet values.\r\n * @part clear-button-icon - The clear button icon.\r\n *\r\n * @part search-wrapper - The search box wrapper.\r\n * @part search-input - The search box input.\r\n * @part search-icon - The search box submit button.\r\n * @part search-clear-button - The button to clear the search box of input.\r\n * @part more-matches - The label indicating there are more matches for the current facet search query.\r\n * @part no-matches - The label indicating there are no matches for the current facet search query.\r\n * @part matches-query - The highlighted query inside the matches labels.\r\n * @part search-highlight - The highlighted query inside the facet values.\r\n *\r\n * @part values - The facet values container.\r\n * @part value-label - The facet value label, common for all displays.\r\n * @part value-count - The facet value count, common for all displays.\r\n * @part default-color-value - The default part name used to customize color facet values. Should be defined before dynamic parts.\r\n * @part value-* - The dynamic part name used to customize a facet value. The `*` is a syntactical placeholder for a specific facet value. For example, if the component's `field` property is set to 'filetype' and your source has a `YouTubeVideo` file type, the part would be targeted like this: `atomic-color-facet::part(value-YouTubeVideo)...`.\r\n *\r\n * @part value-box - The facet value when display is 'box'.\r\n * @part value-box-selected - The selected facet value when display is 'box'.\r\n * @part value-checkbox - The facet value checkbox, available when display is 'checkbox'.\r\n * @part value-checkbox-checked - The checked facet value checkbox, available when display is 'checkbox'.\r\n * @part value-checkbox-label - The facet value checkbox clickable label, available when display is 'checkbox'.\r\n *\r\n * @part show-more - The show more results button.\r\n * @part show-less - The show less results button.\r\n * @part show-more-less-icon - The icons of the show more & show less buttons.\r\n */\r\n@Component({\r\n  tag: 'atomic-color-facet',\r\n  styleUrl: 'atomic-color-facet.pcss',\r\n  shadow: true,\r\n})\r\nexport class AtomicColorFacet implements InitializableComponent {\r\n  @InitializeBindings() public bindings!: Bindings;\r\n  public facet!: Facet;\r\n  private dependenciesManager?: FacetConditionsManager;\r\n  private resultIndexToFocusOnShowMore = 0;\r\n  public searchStatus!: SearchStatus;\r\n  @Element() private host!: HTMLElement;\r\n\r\n  @BindStateToController('facet')\r\n  @State()\r\n  public facetState!: FacetState;\r\n  @BindStateToController('searchStatus')\r\n  @State()\r\n  public searchStatusState!: SearchStatusState;\r\n  @State() public error!: Error;\r\n\r\n  /**\r\n   * Specifies a unique identifier for the facet.\r\n   */\r\n  @Prop({mutable: true, reflect: true}) public facetId?: string;\r\n  /**\r\n   * The non-localized label for the facet.\r\n   * Used in the `atomic-breadbox` component through the bindings store.\r\n   */\r\n  @Prop({reflect: true}) public label = 'no-label';\r\n  /**\r\n   * The field whose values you want to display in the facet.\r\n   */\r\n  @Prop({reflect: true}) public field!: string;\r\n  /**\r\n   * The number of values to request for this facet.\r\n   * Also determines the number of additional values to request each time more values are shown.\r\n   */\r\n  @Prop({reflect: true}) public numberOfValues = 8;\r\n  /**\r\n   * Whether this facet should contain a search box.\r\n   *\r\n   */\r\n  @Prop({reflect: true}) public withSearch = true;\r\n  /**\r\n   * The sort criterion to apply to the returned facet values.\r\n   * Possible values are 'score', 'alphanumeric', 'occurrences', and 'automatic'.\r\n   */\r\n  @Prop({reflect: true}) public sortCriteria: FacetSortCriterion = 'automatic';\r\n  /**\r\n   * Specifies how a result must match the selected facet values.\r\n   * Allowed values:\r\n   * - `atLeastOneValue`: A result will match if at least one of the corresponding facet values is selected.\r\n   * - `allValues`: A result will match if all corresponding facet values are selected.\r\n   */\r\n  @Prop({reflect: true}) public resultsMustMatch: FacetResultsMustMatch =\r\n    'atLeastOneValue';\r\n  /**\r\n   * Whether to display the facet values as checkboxes (multiple selection) or boxes (multiple selection).\r\n   * Possible values are 'checkbox', and 'box'.\r\n   */\r\n  @Prop({reflect: true}) public displayValuesAs: 'checkbox' | 'box' = 'box';\r\n  /**\r\n   * Specifies whether the facet is collapsed. When the facet is the child of an `atomic-facet-manager` component, the facet manager controls this property.\r\n   */\r\n  @Prop({reflect: true, mutable: true}) public isCollapsed = false;\r\n  /**\r\n   * The [heading level](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/Heading_Elements) to use for the heading over the facet, from 1 to 6.\r\n   */\r\n  @Prop({reflect: true}) public headingLevel = 0;\r\n  /**\r\n   * Whether to exclude the parents of folded results when estimating the result count for each facet value.\r\n   */\r\n  @Prop({reflect: true}) public filterFacetCount = true;\r\n  /**\r\n   * The maximum number of results to scan in the index to ensure that the facet lists all potential facet values.\r\n   * Note: A high injectionDepth may negatively impact the facet request performance.\r\n   * Minimum: `0`\r\n   * Default: `1000`\r\n   */\r\n  @Prop({reflect: true}) public injectionDepth = 1000;\r\n  // @Prop() public customSort?: string; TODO: KIT-753 Add customSort option for facet\r\n\r\n  /**\r\n   * The required facets and values for this facet to be displayed.\r\n   * Examples:\r\n   * ```html\r\n   * <atomic-facet facet-id=\"abc\" field=\"objecttype\" ...></atomic-facet>\r\n   *\r\n   * <!-- To show the facet when any value is selected in the facet with id \"abc\": -->\r\n   * <atomic-color-facet\r\n   *   depends-on-abc\r\n   *   ...\r\n   * ></atomic-color-facet>\r\n   *\r\n   * <!-- To show the facet when value \"doc\" is selected in the facet with id \"abc\": -->\r\n   * <atomic-color-facet\r\n   *   depends-on-abc=\"doc\"\r\n   *   ...\r\n   * ></atomic-color-facet>\r\n   * ```\r\n   */\r\n  @MapProp() @Prop() public dependsOn: Record<string, string> = {};\r\n\r\n  /**\r\n   * Specifies an explicit list of `allowedValues` in the Search API request. This list is in the form of a JSON string.\r\n   *\r\n   * If you specify a list of values for this option, the facet only uses these values (if they are available in\r\n   * the current result set).\r\n   *\r\n   * Example:\r\n   *\r\n   * The following facet only uses the `Contact`, `Account`, and `File` values of the `objecttype` field. Even if the\r\n   * current result set contains other `objecttype` values, such as `Message` or `Product`, the facet does not use\r\n   * them.\r\n   *\r\n   * ```html\r\n   * <atomic-color-facet field=\"objecttype\" allowed-values='[\"Contact\",\"Account\",\"File\"]'></atomic-color-facet>\r\n   * ```\r\n   *\r\n   * The maximum amount of allowed values is 25.\r\n   *\r\n   * The default value is `undefined`, and the facet uses all available values for its `field` in the current result set.\r\n   */\r\n  @ArrayProp()\r\n  @Prop({mutable: true})\r\n  public allowedValues: string[] | string = '[]';\r\n\r\n  /**\r\n   * Identifies the facet values that must appear at the top, in this order.\r\n   * This parameter can be used in conjunction with the `sortCriteria` parameter.\r\n   *\r\n   * Facet values not part of the `customSort` list will be sorted according to the `sortCriteria`.\r\n   *\r\n   * Example:\r\n   *\r\n   * The following facet will sort the `Contact`, `Account`, and `File` values at the top of the list for the `objecttype` field.\r\n   *\r\n   * If there are more than these 3 values available, the rest of the list will be sorted using `occurrences`.\r\n   *\r\n   * ```html\r\n   * <atomic-color-facet field=\"objecttype\" custom-sort='[\"Contact\",\"Account\",\"File\"]' sort-criteria='occurrences'></atomic-color-facet>\r\n   * ```\r\n   * The maximum amount of custom sort values is 25.\r\n   *\r\n   * The default value is `undefined`, and the facet values will be sorted using only the `sortCriteria`.\r\n   */\r\n  @ArrayProp()\r\n  @Prop({mutable: true})\r\n  public customSort: string[] | string = '[]';\r\n\r\n  private showLessFocus?: FocusTargetController;\r\n\r\n  private showMoreFocus?: FocusTargetController;\r\n\r\n  private headerFocus?: FocusTargetController;\r\n\r\n  @AriaLiveRegion('facet-search')\r\n  protected facetSearchAriaMessage!: string;\r\n\r\n  public initialize() {\r\n    this.searchStatus = buildSearchStatus(this.bindings.engine);\r\n    this.facet = buildFacet(this.bindings.engine, {options: this.facetOptions});\r\n    announceFacetSearchResultsWithAriaLive(\r\n      this.facet,\r\n      this.label,\r\n      (msg) => (this.facetSearchAriaMessage = msg),\r\n      this.bindings.i18n\r\n    );\r\n    this.facetId = this.facet.state.facetId;\r\n    const facetInfo: FacetInfo = {\r\n      label: () => this.bindings.i18n.t(this.label),\r\n      facetId: this.facetId!,\r\n      element: this.host,\r\n      isHidden: () => this.isHidden,\r\n    };\r\n    this.bindings.store.registerFacet('facets', facetInfo);\r\n    initializePopover(this.host, {\r\n      ...facetInfo,\r\n      hasValues: () => !!this.facet.state.values.length,\r\n      numberOfActiveValues: () => this.numberOfSelectedValues,\r\n    });\r\n    this.initializeDependenciesManager();\r\n  }\r\n\r\n  private get focusTargets() {\r\n    if (!this.showLessFocus) {\r\n      this.showLessFocus = new FocusTargetController(this);\r\n    }\r\n    if (!this.showMoreFocus) {\r\n      this.showMoreFocus = new FocusTargetController(this);\r\n    }\r\n    if (!this.headerFocus) {\r\n      this.headerFocus = new FocusTargetController(this);\r\n    }\r\n\r\n    return {\r\n      showLessFocus: this.showLessFocus,\r\n      showMoreFocus: this.showMoreFocus,\r\n      headerFocus: this.headerFocus,\r\n    };\r\n  }\r\n\r\n  public disconnectedCallback() {\r\n    if (this.host.isConnected) {\r\n      return;\r\n    }\r\n    this.dependenciesManager?.stopWatching();\r\n  }\r\n\r\n  private get isHidden() {\r\n    return (\r\n      this.searchStatusState.hasError ||\r\n      !this.facet.state.enabled ||\r\n      !this.facet.state.values.length\r\n    );\r\n  }\r\n\r\n  public componentShouldUpdate(\r\n    next: unknown,\r\n    prev: unknown,\r\n    propName: keyof AtomicColorFacet\r\n  ) {\r\n    if (propName === 'facetState' && prev && this.withSearch) {\r\n      return shouldUpdateFacetSearchComponent(\r\n        (next as FacetState).facetSearch,\r\n        (prev as FacetState).facetSearch\r\n      );\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  private get numberOfSelectedValues() {\r\n    return this.facetState.values.filter(({state}) => state === 'selected')\r\n      .length;\r\n  }\r\n\r\n  private initializeDependenciesManager() {\r\n    this.dependenciesManager = buildFacetConditionsManager(\r\n      this.bindings.engine,\r\n      {\r\n        facetId: this.facetId!,\r\n        conditions: parseDependsOn<\r\n          FacetValueRequest | CategoryFacetValueRequest\r\n        >(this.dependsOn),\r\n      }\r\n    );\r\n  }\r\n\r\n  private renderHeader() {\r\n    return (\r\n      <FacetHeader\r\n        i18n={this.bindings.i18n}\r\n        label={this.label}\r\n        onClearFilters={() => {\r\n          this.focusTargets.headerFocus.focusAfterSearch();\r\n          this.facet.deselectAll();\r\n        }}\r\n        numberOfActiveValues={this.numberOfSelectedValues}\r\n        isCollapsed={this.isCollapsed}\r\n        headingLevel={this.headingLevel}\r\n        onToggleCollapse={() => (this.isCollapsed = !this.isCollapsed)}\r\n        headerRef={(el) => this.focusTargets.headerFocus.setTarget(el)}\r\n      ></FacetHeader>\r\n    );\r\n  }\r\n\r\n  private renderSearchInput() {\r\n    if (!this.withSearch) {\r\n      return;\r\n    }\r\n\r\n    return (\r\n      <FacetSearchInput\r\n        i18n={this.bindings.i18n}\r\n        label={this.label}\r\n        query={this.facetState.facetSearch.query}\r\n        onChange={(value) => {\r\n          if (value === '') {\r\n            this.facet.facetSearch.clear();\r\n            return;\r\n          }\r\n          this.facet.facetSearch.updateCaptions(\r\n            getFieldCaptions(this.field, this.bindings.i18n)\r\n          );\r\n          this.facet.facetSearch.updateText(value);\r\n          this.facet.facetSearch.search();\r\n        }}\r\n        onClear={() => this.facet.facetSearch.clear()}\r\n      ></FacetSearchInput>\r\n    );\r\n  }\r\n\r\n  private renderValue(\r\n    facetValue: FacetValue,\r\n    onClick: () => void,\r\n    isShowLessFocusTarget: boolean,\r\n    isShowMoreFocusTarget: boolean\r\n  ) {\r\n    const displayValue = getFieldValueCaption(\r\n      this.facetId!,\r\n      facetValue.value,\r\n      this.bindings.i18n\r\n    );\r\n    const isSelected = facetValue.state === 'selected';\r\n    const isExcluded = facetValue.state === 'excluded';\r\n    const partValueWithDisplayValue = displayValue.replace(/[^a-z0-9]/gi, '');\r\n    const partValueWithAPIValue = facetValue.value.replace(/[^a-z0-9]/gi, '');\r\n    switch (this.displayValuesAs) {\r\n      case 'checkbox':\r\n        return (\r\n          <ColorFacetCheckbox\r\n            displayValue={displayValue}\r\n            numberOfResults={facetValue.numberOfResults}\r\n            isSelected={isSelected}\r\n            i18n={this.bindings.i18n}\r\n            onClick={onClick}\r\n            searchQuery={this.facetState.facetSearch.query}\r\n            buttonRef={(element) => {\r\n              isShowLessFocusTarget &&\r\n                this.focusTargets.showLessFocus.setTarget(element);\r\n              isShowMoreFocusTarget &&\r\n                this.focusTargets.showMoreFocus.setTarget(element);\r\n            }}\r\n          >\r\n            <FacetValueLabelHighlight\r\n              displayValue={displayValue}\r\n              isSelected={isSelected}\r\n              searchQuery={this.facetState.facetSearch.query}\r\n            ></FacetValueLabelHighlight>\r\n          </ColorFacetCheckbox>\r\n        );\r\n      case 'box':\r\n        return (\r\n          <FacetValueBox\r\n            displayValue={displayValue}\r\n            numberOfResults={facetValue.numberOfResults}\r\n            isSelected={isSelected}\r\n            i18n={this.bindings.i18n}\r\n            onClick={onClick}\r\n            searchQuery={this.facetState.facetSearch.query}\r\n            buttonRef={(element) => {\r\n              isShowLessFocusTarget &&\r\n                this.focusTargets.showLessFocus.setTarget(element);\r\n              isShowMoreFocusTarget &&\r\n                this.focusTargets.showMoreFocus.setTarget(element);\r\n            }}\r\n          >\r\n            <div\r\n              part={`value-${partValueWithDisplayValue} value-${partValueWithAPIValue} default-color-value`}\r\n              class=\"value-box-color w-full h-12 bg-neutral-dark rounded-md mb-2\"\r\n            ></div>\r\n            <FacetValueLabelHighlight\r\n              displayValue={displayValue}\r\n              isSelected={isSelected}\r\n              isExcluded={isExcluded}\r\n              searchQuery={this.facetState.facetSearch.query}\r\n            ></FacetValueLabelHighlight>\r\n          </FacetValueBox>\r\n        );\r\n    }\r\n  }\r\n\r\n  private renderValuesContainer(children: VNode[], query?: string) {\r\n    const classes = `mt-3 ${\r\n      this.displayValuesAs === 'box' ? 'box-color-container' : ''\r\n    }`;\r\n    return (\r\n      <FacetValuesGroup\r\n        i18n={this.bindings.i18n}\r\n        label={this.label}\r\n        query={query}\r\n      >\r\n        <ul class={classes} part=\"values\">\r\n          {children}\r\n        </ul>\r\n      </FacetValuesGroup>\r\n    );\r\n  }\r\n\r\n  private renderValues() {\r\n    return this.renderValuesContainer(\r\n      this.facetState.values.map((value, i) =>\r\n        this.renderValue(\r\n          value,\r\n          () => this.facet.toggleSelect(value),\r\n          i === 0,\r\n          i ===\r\n            (this.sortCriteria === 'automatic'\r\n              ? 0\r\n              : this.resultIndexToFocusOnShowMore)\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  private renderSearchResults() {\r\n    return this.renderValuesContainer(\r\n      this.facetState.facetSearch.values.map((value) =>\r\n        this.renderValue(\r\n          {\r\n            state: 'idle',\r\n            numberOfResults: value.count,\r\n            value: value.rawValue,\r\n          },\r\n          () => this.facet.facetSearch.select(value),\r\n          false,\r\n          false\r\n        )\r\n      ),\r\n      this.facetState.facetSearch.query\r\n    );\r\n  }\r\n\r\n  private renderMatches() {\r\n    return (\r\n      <FacetSearchMatches\r\n        i18n={this.bindings.i18n}\r\n        query={this.facetState.facetSearch.query}\r\n        numberOfMatches={this.facetState.facetSearch.values.length}\r\n        hasMoreMatches={this.facetState.facetSearch.moreValuesAvailable}\r\n      ></FacetSearchMatches>\r\n    );\r\n  }\r\n\r\n  private renderShowMoreLess() {\r\n    return (\r\n      <FacetShowMoreLess\r\n        label={this.label}\r\n        i18n={this.bindings.i18n}\r\n        onShowMore={() => {\r\n          this.resultIndexToFocusOnShowMore = this.facet.state.values.length;\r\n          this.focusTargets.showMoreFocus.focusAfterSearch();\r\n          this.facet.showMoreValues();\r\n        }}\r\n        onShowLess={() => {\r\n          this.focusTargets.showLessFocus.focusAfterSearch();\r\n          this.facet.showLessValues();\r\n        }}\r\n        canShowLessValues={this.facetState.canShowLessValues}\r\n        canShowMoreValues={this.facetState.canShowMoreValues}\r\n      ></FacetShowMoreLess>\r\n    );\r\n  }\r\n\r\n  private get facetOptions(): FacetOptions {\r\n    return {\r\n      facetId: this.facetId,\r\n      field: this.field,\r\n      numberOfValues: this.numberOfValues,\r\n      sortCriteria: this.sortCriteria,\r\n      resultsMustMatch: this.resultsMustMatch,\r\n      facetSearch: {numberOfValues: this.numberOfValues},\r\n      injectionDepth: this.injectionDepth,\r\n      filterFacetCount: this.filterFacetCount,\r\n      allowedValues: this.allowedValues.length\r\n        ? [...this.allowedValues]\r\n        : undefined,\r\n      customSort: this.customSort.length ? [...this.customSort] : undefined,\r\n    };\r\n  }\r\n\r\n  public render() {\r\n    if (this.searchStatusState.hasError || !this.facet.state.enabled) {\r\n      return <Hidden></Hidden>;\r\n    }\r\n\r\n    if (!this.searchStatusState.firstSearchExecuted) {\r\n      return (\r\n        <FacetPlaceholder\r\n          numberOfValues={this.numberOfValues}\r\n          isCollapsed={this.isCollapsed}\r\n        ></FacetPlaceholder>\r\n      );\r\n    }\r\n\r\n    if (!this.facetState.values.length) {\r\n      return <Hidden></Hidden>;\r\n    }\r\n\r\n    return (\r\n      <FacetContainer>\r\n        {this.renderHeader()}\r\n        {!this.isCollapsed && [\r\n          this.renderSearchInput(),\r\n          shouldDisplaySearchResults(this.facetState.facetSearch)\r\n            ? [this.renderSearchResults(), this.renderMatches()]\r\n            : [this.renderValues(), this.renderShowMoreLess()],\r\n        ]}\r\n      </FacetContainer>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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"}