{"file":"atomic-result-fields-list.entry.js","mappings":"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","names":[],"sources":["src/components/search/result-template-components/atomic-result-fields-list/atomic-result-fields-list.pcss?tag=atomic-result-fields-list","src/components/search/result-template-components/atomic-result-fields-list/atomic-result-fields-list.tsx"],"sourcesContent":["@import '../../../../global/global.pcss';\r\n\r\natomic-result-fields-list {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  width: 100%;\r\n  height: 100%;\r\n\r\n  > * {\r\n    &::after {\r\n      display: block;\r\n      content: ' ';\r\n      width: 1px;\r\n      height: 1rem;\r\n      margin: 0 1rem;\r\n      background-color: var(--atomic-neutral);\r\n      vertical-align: middle;\r\n    }\r\n\r\n    &.hide-divider::after {\r\n      visibility: hidden;\r\n    }\r\n  }\r\n}\r\n","import {Result} from '@coveo/headless';\r\nimport {Component, h, Element, Host} from '@stencil/core';\r\nimport {ResultContext} from '../result-template-decorators';\r\n\r\n/**\r\n * The `atomic-result-fields-list` component selectively renders its children to ensure they fit the parent element and adds dividers between them.\r\n */\r\n@Component({\r\n  tag: 'atomic-result-fields-list',\r\n  styleUrl: 'atomic-result-fields-list.pcss',\r\n  shadow: false,\r\n})\r\nexport class AtomicResultFieldsList {\r\n  @ResultContext()\r\n  protected result!: Result;\r\n\r\n  private resizeObserver?: ResizeObserver;\r\n\r\n  private updatingChildren = false;\r\n  private rows: number[] = [];\r\n  @Element() private host!: HTMLElement;\r\n\r\n  public connectedCallback() {\r\n    if (window.ResizeObserver) {\r\n      this.resizeObserver = new ResizeObserver(() => this.update());\r\n      this.resizeObserver.observe(this.host.parentElement!);\r\n    }\r\n  }\r\n\r\n  public disconnectedCallback() {\r\n    this.resizeObserver?.disconnect();\r\n  }\r\n\r\n  public componentDidRender() {\r\n    this.update();\r\n  }\r\n\r\n  public update() {\r\n    if (this.updatingChildren) {\r\n      return;\r\n    }\r\n    this.updatingChildren = true;\r\n    this.showDividers();\r\n    this.showChildren();\r\n    this.hideChildrenToFit();\r\n    this.hideDividersAtEndOfRows();\r\n    this.updatingChildren = false;\r\n  }\r\n\r\n  private get children() {\r\n    return Array.from(this.host.children) as HTMLElement[];\r\n  }\r\n\r\n  private get isOverflowing() {\r\n    return (\r\n      this.host.scrollWidth > this.host.clientWidth ||\r\n      this.host.scrollHeight > this.host.clientHeight\r\n    );\r\n  }\r\n\r\n  private getSortedChildrenBySize() {\r\n    return this.children.sort((a, b) => a.offsetWidth - b.offsetWidth);\r\n  }\r\n\r\n  private hide(element: HTMLElement) {\r\n    element.style.display = 'none';\r\n  }\r\n\r\n  private show(element: HTMLElement) {\r\n    element.style.display = '';\r\n  }\r\n\r\n  private isChildHidden(element: HTMLElement) {\r\n    return element.style.display === 'none';\r\n  }\r\n\r\n  private setHideDivider(element: HTMLElement, hideDivider: boolean) {\r\n    element.classList.toggle('hide-divider', hideDivider);\r\n  }\r\n\r\n  private showChildren() {\r\n    this.children.forEach((child) => this.show(child));\r\n  }\r\n\r\n  private showDividers() {\r\n    this.children.forEach((child) => this.setHideDivider(child, false));\r\n  }\r\n\r\n  private hideChildrenToFit() {\r\n    const children = this.getSortedChildrenBySize();\r\n    for (let i = children.length - 1; this.isOverflowing && i >= 0; i--) {\r\n      this.hide(children[i]);\r\n    }\r\n  }\r\n\r\n  private hideDividersAtEndOfRows() {\r\n    this.rows = [];\r\n    let previousChild: HTMLElement | null = null;\r\n    this.children\r\n      .filter((child) => !this.isChildHidden(child))\r\n      .forEach((child) => {\r\n        const row = child.offsetTop;\r\n        if (this.rows.indexOf(row) === -1) {\r\n          this.rows.push(row);\r\n          if (previousChild) {\r\n            this.setHideDivider(previousChild, true);\r\n          }\r\n        }\r\n        previousChild = child;\r\n      });\r\n    if (previousChild) {\r\n      this.setHideDivider(previousChild, true);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return <Host></Host>;\r\n  }\r\n}\r\n"],"version":3}