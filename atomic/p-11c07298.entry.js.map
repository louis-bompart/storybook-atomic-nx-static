{"version":3,"names":["atomicRefineToggleCss","AtomicRefineToggleStyle0","AtomicRefineToggle","this","collapseFacetsAfter","initialize","searchStatus","buildSearchStatus","bindings","engine","loadModal","modalRef","document","createElement","host","insertAdjacentElement","openButton","buttonRef","enableModal","isOpen","render","searchStatusState","hasError","firstSearchExecuted","h","part","class","hasResults","Button","style","onClick","text","i18n","t","ref","button","__decorate","InitializeBindings","BindStateToController"],"sources":["src/components/search/atomic-refine-toggle/atomic-refine-toggle.pcss?tag=atomic-refine-toggle&encapsulation=shadow","src/components/search/atomic-refine-toggle/atomic-refine-toggle.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\n","import {\n  buildSearchStatus,\n  SearchStatusState,\n  SearchStatus,\n} from '@coveo/headless';\nimport {Component, h, Prop, State, Element} from '@stencil/core';\nimport {\n  InitializeBindings,\n  InitializableComponent,\n  BindStateToController,\n} from '../../../utils/initialization-utils';\nimport {Button} from '../../common/button';\nimport {Bindings} from '../atomic-search-interface/atomic-search-interface';\n\n/**\n * The `atomic-refine-toggle` component displays a button that opens a modal containing the facets and the sort components.\n *\n * When this component is added to the `atomic-search-interface`, an `atomic-refine-modal` component is automatically created.\n * @part button - The refine toggle button.\n */\n@Component({\n  tag: 'atomic-refine-toggle',\n  styleUrl: 'atomic-refine-toggle.pcss',\n  shadow: true,\n})\nexport class AtomicRefineToggle implements InitializableComponent {\n  @Element() public host!: HTMLElement;\n  public searchStatus!: SearchStatus;\n  private modalRef?: HTMLAtomicRefineModalElement;\n  private buttonRef?: HTMLButtonElement;\n\n  @InitializeBindings() public bindings!: Bindings;\n  @State() public error!: Error;\n  @BindStateToController('searchStatus')\n  @State()\n  private searchStatusState!: SearchStatusState;\n\n  /**\n   * The number of expanded facets inside the refine modal.\n   * Remaining facets are automatically collapsed.\n   *\n   * Using the value `0` collapses all facets.\n   */\n  @Prop({reflect: true}) public collapseFacetsAfter = 0;\n\n  public initialize() {\n    this.searchStatus = buildSearchStatus(this.bindings.engine);\n  }\n\n  private loadModal() {\n    if (this.modalRef) {\n      return;\n    }\n\n    this.modalRef = document.createElement('atomic-refine-modal');\n    this.host.insertAdjacentElement('beforebegin', this.modalRef);\n    this.modalRef.openButton = this.buttonRef;\n    this.modalRef.collapseFacetsAfter = this.collapseFacetsAfter;\n  }\n\n  private enableModal() {\n    this.modalRef && (this.modalRef.isOpen = true);\n  }\n\n  public render() {\n    if (this.searchStatusState.hasError) {\n      return;\n    }\n\n    if (!this.searchStatusState.firstSearchExecuted) {\n      return (\n        <div\n          part=\"placeholder\"\n          aria-hidden\n          class=\"rounded w-28 h-8 my-2 bg-neutral animate-pulse\"\n        ></div>\n      );\n    }\n\n    if (!this.searchStatusState.hasResults) {\n      return;\n    }\n\n    return (\n      <Button\n        style=\"outline-primary\"\n        class=\"p-3 w-full\"\n        onClick={() => this.enableModal()}\n        text={this.bindings.i18n.t('sort-and-filter')}\n        ref={(button) => {\n          if (!button) {\n            return;\n          }\n          this.buttonRef = button;\n          this.loadModal();\n        }}\n        part=\"button\"\n      ></Button>\n    );\n  }\n}\n"],"mappings":"wRAAA,MAAMA,EAAwB,w+tCAC9B,MAAAC,EAAeD,E,iXCwBFE,EAAkB,M,yBAkBCC,KAAAC,oBAAsB,E,+EAAA,C,CAE7C,UAAAC,GACLF,KAAKG,aAAeC,EAAkBJ,KAAKK,SAASC,O,CAG9C,SAAAC,GACN,GAAIP,KAAKQ,SAAU,CACjB,M,CAGFR,KAAKQ,SAAWC,SAASC,cAAc,uBACvCV,KAAKW,KAAKC,sBAAsB,cAAeZ,KAAKQ,UACpDR,KAAKQ,SAASK,WAAab,KAAKc,UAChCd,KAAKQ,SAASP,oBAAsBD,KAAKC,mB,CAGnC,WAAAc,GACNf,KAAKQ,WAAaR,KAAKQ,SAASQ,OAAS,K,CAGpC,MAAAC,GACL,GAAIjB,KAAKkB,kBAAkBC,SAAU,CACnC,M,CAGF,IAAKnB,KAAKkB,kBAAkBE,oBAAqB,CAC/C,OACEC,EAAA,OACEC,KAAK,cAAa,mBAElBC,MAAM,kD,CAKZ,IAAKvB,KAAKkB,kBAAkBM,WAAY,CACtC,M,CAGF,OACEH,EAACI,EAAM,CACLC,MAAM,kBACNH,MAAM,aACNI,QAAS,IAAM3B,KAAKe,cACpBa,KAAM5B,KAAKK,SAASwB,KAAKC,EAAE,mBAC3BC,IAAMC,IACJ,IAAKA,EAAQ,CACX,M,CAEFhC,KAAKc,UAAYkB,EACjBhC,KAAKO,WAAW,EAElBe,KAAK,U,6BAjEkBW,EAAA,CAA5BC,K,+BAIOD,EAAA,CAFPE,EAAsB,iB"}