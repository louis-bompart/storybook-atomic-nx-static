{"file":"atomic-product-description.entry.js","mappings":";;;;;;;;;;;;;;AAAA,MAAM,2BAA2B,GAAG,u+tCAAu+tC,CAAC;AAC5guC,uCAAe,2BAA2B;;;;;;;;;;;;MCqB7B,wBAAwB;IA0BnC;;QAhBiB,eAAU,GAAG,KAAK,CAAC;QACnB,gBAAW,GAAG,KAAK,CAAC;;;;QAQtB,kBAAa,GAAmC,GAAG,CAAC;;;;QAKpD,UAAK,GAAsC,cAAc,CAAC;0BAd3C,KAAK;2BACJ,KAAK;6BAQ2B,GAAG;qBAKR,cAAc;QAGtE,IAAI,CAAC,cAAc,GAAG,IAAI,cAAc,CAAC;YACvC,IACE,IAAI,CAAC,eAAe;gBACpB,IAAI,CAAC,eAAe,CAAC,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,EACrE;gBACA,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;aACzB;iBAAM;gBACL,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;aAC1B;SACF,CAAC,CAAC;QACH,IAAI,CAAC,aAAa,EAAE,CAAC;KACtB;IAEO,aAAa;QACnB,IAAI,MAAM,CAAC;YACT,aAAa,EAAE,IAAI,WAAW,CAAC;gBAC7B,WAAW,EAAE,CAAC,MAAM,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;aAC1C,CAAC;YACF,KAAK,EAAE,IAAI,WAAW,CAAC,EAAC,WAAW,EAAE,CAAC,cAAc,EAAE,gBAAgB,CAAC,EAAC,CAAC;SAC1E,CAAC,CAAC,QAAQ,CAAC;YACV,aAAa,EAAE,IAAI,CAAC,aAAa;YACjC,KAAK,EAAE,IAAI,CAAC,KAAK;SAClB,CAAC,CAAC;KACJ;IAED,gBAAgB;QACd,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,CACnD,2BAA2B,CACV,CAAC;QACpB,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;SACnD;KACF;IAEO,cAAc;QACpB,IAAI,CAAC,UAAU,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC;KACpC;IAEO,iBAAiB;QACvB,MAAM,YAAY,GAA8C;YAC9D,IAAI,EAAE,iBAAiB;YACvB,CAAC,EAAE,cAAc;YACjB,CAAC,EAAE,cAAc;YACjB,CAAC,EAAE,cAAc;YACjB,CAAC,EAAE,cAAc;SAClB,CAAC;QACF,OAAO,YAAY,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,cAAc,CAAC;KAC3D;IAED,oBAAoB;QAClB,IAAI,CAAC,cAAc,CAAC,UAAU,EAAE,CAAC;KAClC;IAEO,wBAAwB;;QAC9B,MAAM,kBAAkB,GAAG,MAAA,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,mCAAI,EAAE,CAAC;QAE1D,IAAI,kBAAkB,KAAK,IAAI,EAAE;YAC/B,QACE,4BACE,KAAK,EAAE,4BAA4B,CAAC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,iBAAiB,EAAE,GAAG,EAAE,EAAE,EACrF,KAAK,EAAE,oBAAoB,CACzB,IAAI,CAAC,KAAK,EACV,kBAAkB,EAClB,IAAI,CAAC,QAAQ,CAAC,IAAI,CACnB,GACqB,EACxB;SACH;KACF;IAEO,oBAAoB;QAC1B,QACE,EAAC,MAAM,IACL,KAAK,EAAC,cAAc,EACpB,IAAI,EAAC,cAAc,EACnB,KAAK,EAAE,oBAAoB,IAAI,CAAC,UAAU,GAAG,QAAQ,GAAG,EAAE,EAAE,EAC5D,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,EACxC,OAAO,EAAE,MAAM,IAAI,CAAC,cAAc,EAAE,IAEpC,mBACE,IAAI,EAAE,QAAQ,EACd,KAAK,EAAC,yBAAyB,GAClB,EAAC,GAAG,EAClB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,CAC3B,EACT;KACH;IAEM,MAAM;QACX,QACE,4DAAK,KAAK,EAAC,2BAA2B,IACnC,IAAI,CAAC,wBAAwB,EAAE,EAC/B,IAAI,CAAC,WAAW;YACf,IAAI,CAAC,aAAa,KAAK,MAAM;YAC7B,IAAI,CAAC,oBAAoB,EAAE,CACzB,EACN;KACH;;;AAzH4B;IAA5B,kBAAkB,EAAE;0DAAoC;AAC/B;IAAzB,cAAc,EAAE;yDAA2B;;;;;","names":[],"sources":["src/components/commerce/product-template-components/atomic-product-description/atomic-product-description.pcss?tag=atomic-product-description","src/components/commerce/product-template-components/atomic-product-description/atomic-product-description.tsx"],"sourcesContent":["@import '../../../../global/global.pcss';\r\n","import {Schema, StringValue} from '@coveo/bueno';\r\nimport {Product} from '@coveo/headless/commerce';\r\nimport {Component, State, h, Element, Prop} from '@stencil/core';\r\nimport PlusIcon from '../../../../images/plus.svg';\r\nimport {getFieldValueCaption} from '../../../../utils/field-utils';\r\nimport {\r\n  InitializableComponent,\r\n  InitializeBindings,\r\n} from '../../../../utils/initialization-utils';\r\nimport {Button} from '../../../common/button';\r\nimport {CommerceBindings} from '../../atomic-commerce-interface/atomic-commerce-interface';\r\nimport {ProductContext} from '../product-template-decorators';\r\n\r\n/**\r\n * @internal\r\n * The `atomic-product-description` component renders the description of a product.\r\n */\r\n@Component({\r\n  tag: 'atomic-product-description',\r\n  styleUrl: 'atomic-product-description.pcss',\r\n  shadow: false,\r\n})\r\nexport class AtomicProductDescription\r\n  implements InitializableComponent<CommerceBindings>\r\n{\r\n  @InitializeBindings() public bindings!: CommerceBindings;\r\n  @ProductContext() private product!: Product;\r\n\r\n  @Element() hostElement!: HTMLElement;\r\n\r\n  public error!: Error;\r\n\r\n  @State() private isExpanded = false;\r\n  @State() private isTruncated = false;\r\n\r\n  private descriptionText!: HTMLDivElement;\r\n  private resizeObserver: ResizeObserver;\r\n\r\n  /**\r\n   * The number of lines after which the product description should be truncated. A value of \"none\" will disable truncation.\r\n   */\r\n  @Prop() public truncateAfter: 'none' | '1' | '2' | '3' | '4' = '2';\r\n\r\n  /**\r\n   * The name of the description field to use.\r\n   */\r\n  @Prop() public field: 'ec_description' | 'ec_shortdesc' = 'ec_shortdesc';\r\n\r\n  constructor() {\r\n    this.resizeObserver = new ResizeObserver(() => {\r\n      if (\r\n        this.descriptionText &&\r\n        this.descriptionText.scrollHeight > this.descriptionText.clientHeight\r\n      ) {\r\n        this.isTruncated = true;\r\n      } else {\r\n        this.isTruncated = false;\r\n      }\r\n    });\r\n    this.validateProps();\r\n  }\r\n\r\n  private validateProps() {\r\n    new Schema({\r\n      truncateAfter: new StringValue({\r\n        constrainTo: ['none', '1', '2', '3', '4'],\r\n      }),\r\n      field: new StringValue({constrainTo: ['ec_shortdesc', 'ec_description']}),\r\n    }).validate({\r\n      truncateAfter: this.truncateAfter,\r\n      field: this.field,\r\n    });\r\n  }\r\n\r\n  componentDidLoad() {\r\n    this.descriptionText = this.hostElement.querySelector(\r\n      '.product-description-text'\r\n    ) as HTMLDivElement;\r\n    if (this.descriptionText) {\r\n      this.resizeObserver.observe(this.descriptionText);\r\n    }\r\n  }\r\n\r\n  private onToggleExpand() {\r\n    this.isExpanded = !this.isExpanded;\r\n  }\r\n\r\n  private getLineClampClass() {\r\n    const lineClampMap: Record<typeof this.truncateAfter, string> = {\r\n      none: 'line-clamp-none',\r\n      1: 'line-clamp-1',\r\n      2: 'line-clamp-2',\r\n      3: 'line-clamp-3',\r\n      4: 'line-clamp-4',\r\n    };\r\n    return lineClampMap[this.truncateAfter] || 'line-clamp-2';\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    this.resizeObserver.disconnect();\r\n  }\r\n\r\n  private renderProductDescription() {\r\n    const productDescription = this.product[this.field] ?? '';\r\n\r\n    if (productDescription !== null) {\r\n      return (\r\n        <atomic-commerce-text\r\n          class={`product-description-text ${!this.isExpanded ? this.getLineClampClass() : ''}`}\r\n          value={getFieldValueCaption(\r\n            this.field,\r\n            productDescription,\r\n            this.bindings.i18n\r\n          )}\r\n        ></atomic-commerce-text>\r\n      );\r\n    }\r\n  }\r\n\r\n  private renderShowMoreButton() {\r\n    return (\r\n      <Button\r\n        style=\"text-primary\"\r\n        part=\"label-button\"\r\n        class={`my-2 p-1 text-xs ${this.isExpanded ? 'hidden' : ''}`}\r\n        title={this.bindings.i18n.t('show-more')}\r\n        onClick={() => this.onToggleExpand()}\r\n      >\r\n        <atomic-icon\r\n          icon={PlusIcon}\r\n          class=\"w-2 ml-1 align-baseline\"\r\n        ></atomic-icon>{' '}\r\n        {this.bindings.i18n.t('show-more')}\r\n      </Button>\r\n    );\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <div class=\"flex flex-col items-start\">\r\n        {this.renderProductDescription()}\r\n        {this.isTruncated &&\r\n          this.truncateAfter !== 'none' &&\r\n          this.renderShowMoreButton()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"],"version":3}