/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ig=Object.create,fn=Object.defineProperty,sg=Object.getOwnPropertyDescriptor,og=Object.getOwnPropertyNames,cg=Object.getPrototypeOf,lg=Object.prototype.hasOwnProperty,ug=(e,t,r)=>t in e?fn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,dg=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),ue=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),gg=(e,t)=>{for(var r in t)fn(e,r,{get:t[r],enumerable:!0})},pg=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of og(t))!lg.call(e,a)&&a!==r&&fn(e,a,{get:()=>t[a],enumerable:!(n=sg(t,a))||n.enumerable});return e},Qe=(e,t,r)=>(r=e!=null?ig(cg(e)):{},pg(!e||!e.__esModule?fn(r,"default",{value:e,enumerable:!0}):r,e)),jo=(e,t,r)=>ug(e,t+"",r),fg=ue((e,t)=>{function r(i){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");if(i=`${i}`,i=i.replace(/[ \t\n\f\r]/g,""),i.length%4===0&&(i=i.replace(/==?$/,"")),i.length%4===1||/[^+/0-9A-Za-z]/.test(i))return null;let s="",o=0,c=0;for(let l=0;l<i.length;l++)o<<=6,o|=a(i[l]),c+=6,c===24&&(s+=String.fromCharCode((o&16711680)>>16),s+=String.fromCharCode((o&65280)>>8),s+=String.fromCharCode(o&255),o=c=0);return c===12?(o>>=4,s+=String.fromCharCode(o)):c===18&&(o>>=2,s+=String.fromCharCode((o&65280)>>8),s+=String.fromCharCode(o&255)),s}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function a(i){let s=n.indexOf(i);return s<0?void 0:s}t.exports=r}),hg=ue((e,t)=>{function r(i){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");let s;for(i=`${i}`,s=0;s<i.length;s++)if(i.charCodeAt(s)>255)return null;let o="";for(s=0;s<i.length;s+=3){let c=[void 0,void 0,void 0,void 0];c[0]=i.charCodeAt(s)>>2,c[1]=(i.charCodeAt(s)&3)<<4,i.length>s+1&&(c[1]|=i.charCodeAt(s+1)>>4,c[2]=(i.charCodeAt(s+1)&15)<<2),i.length>s+2&&(c[2]|=i.charCodeAt(s+2)>>6,c[3]=i.charCodeAt(s+2)&63);for(let l=0;l<c.length;l++)typeof c[l]>"u"?o+="=":o+=a(c[l])}return o}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function a(i){if(i>=0&&i<64)return n[i]}t.exports=r}),yg=ue((e,t)=>{var r=fg(),n=hg();t.exports={atob:r,btoa:n}}),mg=ue((e,t)=>{var r=typeof self<"u"?self:typeof window<"u"?window:void 0;if(!r)throw new Error("Unable to find global scope. Are you sure this is running in the browser?");if(!r.AbortController)throw new Error('Could not find "AbortController" in the global scope. You need to polyfill it first');t.exports.AbortController=r.AbortController}),vg=ue((e,t)=>{t.exports=fetch}),Sg=ue(e=>{var t=e&&e.__assign||function(){return t=Object.assign||function(a){for(var i,s=1,o=arguments.length;s<o;s++){i=arguments[s];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(a[c]=i[c])}return a},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var r={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};function n(a){var i=t(t({},r),a);return i.numOfAttempts<1&&(i.numOfAttempts=1),i}e.getSanitizedOptions=n}),wg=ue(e=>{Object.defineProperty(e,"__esModule",{value:!0});function t(r){var n=Math.random()*r;return Math.round(n)}e.fullJitter=t}),bg=ue(e=>{Object.defineProperty(e,"__esModule",{value:!0});function t(r){return r}e.noJitter=t}),Cg=ue(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=wg(),r=bg();function n(a){switch(a.jitter){case"full":return t.fullJitter;case"none":default:return r.noJitter}}e.JitterFactory=n}),Po=ue(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Cg(),r=function(){function n(a){this.options=a,this.attempt=0}return n.prototype.apply=function(){var a=this;return new Promise(function(i){return setTimeout(i,a.jitteredDelay)})},n.prototype.setAttemptNumber=function(a){this.attempt=a},Object.defineProperty(n.prototype,"jitteredDelay",{get:function(){var a=t.JitterFactory(this.options);return a(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"delay",{get:function(){var a=this.options.startingDelay,i=this.options.timeMultiple,s=this.numOfDelayedAttempts,o=a*Math.pow(i,s);return Math.min(o,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),n}();e.Delay=r}),Ig=ue(e=>{var t=e&&e.__extends||function(){var s=function(o,c){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,u){l.__proto__=u}||function(l,u){for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])},s(o,c)};return function(o,c){s(o,c);function l(){this.constructor=o}o.prototype=c===null?Object.create(c):(l.prototype=c.prototype,new l)}}(),r=e&&e.__awaiter||function(s,o,c,l){function u(d){return d instanceof c?d:new c(function(g){g(d)})}return new(c||(c=Promise))(function(d,g){function f(v){try{p(l.next(v))}catch(b){g(b)}}function y(v){try{p(l.throw(v))}catch(b){g(b)}}function p(v){v.done?d(v.value):u(v.value).then(f,y)}p((l=l.apply(s,o||[])).next())})},n=e&&e.__generator||function(s,o){var c={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},l,u,d,g;return g={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function f(p){return function(v){return y([p,v])}}function y(p){if(l)throw new TypeError("Generator is already executing.");for(;c;)try{if(l=1,u&&(d=p[0]&2?u.return:p[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,p[1])).done)return d;switch(u=0,d&&(p=[p[0]&2,d.value]),p[0]){case 0:case 1:d=p;break;case 4:return c.label++,{value:p[1],done:!1};case 5:c.label++,u=p[1],p=[0];continue;case 7:p=c.ops.pop(),c.trys.pop();continue;default:if(d=c.trys,!(d=d.length>0&&d[d.length-1])&&(p[0]===6||p[0]===2)){c=0;continue}if(p[0]===3&&(!d||p[1]>d[0]&&p[1]<d[3])){c.label=p[1];break}if(p[0]===6&&c.label<d[1]){c.label=d[1],d=p;break}if(d&&c.label<d[2]){c.label=d[2],c.ops.push(p);break}d[2]&&c.ops.pop(),c.trys.pop();continue}p=o.call(s,c)}catch(v){p=[6,v],u=0}finally{l=d=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var a=Po(),i=function(s){t(o,s);function o(){return s!==null&&s.apply(this,arguments)||this}return o.prototype.apply=function(){return r(this,void 0,void 0,function(){return n(this,function(c){return[2,this.isFirstAttempt?!0:s.prototype.apply.call(this)]})})},Object.defineProperty(o.prototype,"isFirstAttempt",{get:function(){return this.attempt===0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),o}(a.Delay);e.SkipFirstDelay=i}),kg=ue(e=>{var t=e&&e.__extends||function(){var a=function(i,s){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var l in c)c.hasOwnProperty(l)&&(o[l]=c[l])},a(i,s)};return function(i,s){a(i,s);function o(){this.constructor=i}i.prototype=s===null?Object.create(s):(o.prototype=s.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=Po(),n=function(a){t(i,a);function i(){return a!==null&&a.apply(this,arguments)||this}return i}(r.Delay);e.AlwaysDelay=n}),Ag=ue(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Ig(),r=kg();function n(i,s){var o=a(i);return o.setAttemptNumber(s),o}e.DelayFactory=n;function a(i){return i.delayFirstAttempt?new r.AlwaysDelay(i):new t.SkipFirstDelay(i)}}),qg=ue(e=>{var t=e&&e.__awaiter||function(o,c,l,u){function d(g){return g instanceof l?g:new l(function(f){f(g)})}return new(l||(l=Promise))(function(g,f){function y(b){try{v(u.next(b))}catch(A){f(A)}}function p(b){try{v(u.throw(b))}catch(A){f(A)}}function v(b){b.done?g(b.value):d(b.value).then(y,p)}v((u=u.apply(o,c||[])).next())})},r=e&&e.__generator||function(o,c){var l={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},u,d,g,f;return f={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function y(v){return function(b){return p([v,b])}}function p(v){if(u)throw new TypeError("Generator is already executing.");for(;l;)try{if(u=1,d&&(g=v[0]&2?d.return:v[0]?d.throw||((g=d.return)&&g.call(d),0):d.next)&&!(g=g.call(d,v[1])).done)return g;switch(d=0,g&&(v=[v[0]&2,g.value]),v[0]){case 0:case 1:g=v;break;case 4:return l.label++,{value:v[1],done:!1};case 5:l.label++,d=v[1],v=[0];continue;case 7:v=l.ops.pop(),l.trys.pop();continue;default:if(g=l.trys,!(g=g.length>0&&g[g.length-1])&&(v[0]===6||v[0]===2)){l=0;continue}if(v[0]===3&&(!g||v[1]>g[0]&&v[1]<g[3])){l.label=v[1];break}if(v[0]===6&&l.label<g[1]){l.label=g[1],g=v;break}if(g&&l.label<g[2]){l.label=g[2],l.ops.push(v);break}g[2]&&l.ops.pop(),l.trys.pop();continue}v=c.call(o,l)}catch(b){v=[6,b],d=0}finally{u=g=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var n=Sg(),a=Ag();function i(o,c){return c===void 0&&(c={}),t(this,void 0,void 0,function(){var l,u;return r(this,function(d){switch(d.label){case 0:return l=n.getSanitizedOptions(c),u=new s(o,l),[4,u.execute()];case 1:return[2,d.sent()]}})})}e.backOff=i;var s=function(){function o(c,l){this.request=c,this.options=l,this.attemptNumber=0}return o.prototype.execute=function(){return t(this,void 0,void 0,function(){var c,l;return r(this,function(u){switch(u.label){case 0:if(this.attemptLimitReached)return[3,7];u.label=1;case 1:return u.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return u.sent(),[4,this.request()];case 3:return[2,u.sent()];case 4:return c=u.sent(),this.attemptNumber++,[4,this.options.retry(c,this.attemptNumber)];case 5:if(l=u.sent(),!l||this.attemptLimitReached)throw c;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}})})},Object.defineProperty(o.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),o.prototype.applyDelay=function(){return t(this,void 0,void 0,function(){var c;return r(this,function(l){switch(l.label){case 0:return c=a.DelayFactory(this.options,this.attemptNumber),[4,c.apply()];case 1:return l.sent(),[2]}})})},o}()}),ei=ue((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs=n()})(e,function(){var r=1e3,n=6e4,a=36e5,i="millisecond",s="second",o="minute",c="hour",l="day",u="week",d="month",g="quarter",f="year",y="date",p="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,A={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(P){var E=["th","st","nd","rd"],q=P%100;return"["+P+(E[(q-20)%10]||E[q]||E[0])+"]"}},j=function(P,E,q){var m=String(P);return!m||m.length>=E?P:""+Array(E+1-m.length).join(q)+P},N={s:j,z:function(P){var E=-P.utcOffset(),q=Math.abs(E),m=Math.floor(q/60),C=q%60;return(E<=0?"+":"-")+j(m,2,"0")+":"+j(C,2,"0")},m:function P(E,q){if(E.date()<q.date())return-P(q,E);var m=12*(q.year()-E.year())+(q.month()-E.month()),C=E.clone().add(m,d),k=q-C<0,O=E.clone().add(m+(k?-1:1),d);return+(-(m+(q-C)/(k?C-O:O-C))||0)},a:function(P){return P<0?Math.ceil(P)||0:Math.floor(P)},p:function(P){return{M:d,y:f,w:u,d:l,D:y,h:c,m:o,s,ms:i,Q:g}[P]||String(P||"").toLowerCase().replace(/s$/,"")},u:function(P){return P===void 0}},$="en",Y={};Y[$]=A;var Q="$isDayjsObject",H=function(P){return P instanceof ge||!(!P||!P[Q])},se=function P(E,q,m){var C;if(!E)return $;if(typeof E=="string"){var k=E.toLowerCase();Y[k]&&(C=k),q&&(Y[k]=q,C=k);var O=E.split("-");if(!C&&O.length>1)return P(O[0])}else{var F=E.name;Y[F]=E,C=F}return!m&&C&&($=C),C||!m&&$},W=function(P,E){if(H(P))return P.clone();var q=typeof E=="object"?E:{};return q.date=P,q.args=arguments,new ge(q)},L=N;L.l=se,L.i=H,L.w=function(P,E){return W(P,{locale:E.$L,utc:E.$u,x:E.$x,$offset:E.$offset})};var ge=function(){function P(q){this.$L=se(q.locale,null,!0),this.parse(q),this.$x=this.$x||q.x||{},this[Q]=!0}var E=P.prototype;return E.parse=function(q){this.$d=function(m){var C=m.date,k=m.utc;if(C===null)return new Date(NaN);if(L.u(C))return new Date;if(C instanceof Date)return new Date(C);if(typeof C=="string"&&!/Z$/i.test(C)){var O=C.match(v);if(O){var F=O[2]-1||0,G=(O[7]||"0").substring(0,3);return k?new Date(Date.UTC(O[1],F,O[3]||1,O[4]||0,O[5]||0,O[6]||0,G)):new Date(O[1],F,O[3]||1,O[4]||0,O[5]||0,O[6]||0,G)}}return new Date(C)}(q),this.init()},E.init=function(){var q=this.$d;this.$y=q.getFullYear(),this.$M=q.getMonth(),this.$D=q.getDate(),this.$W=q.getDay(),this.$H=q.getHours(),this.$m=q.getMinutes(),this.$s=q.getSeconds(),this.$ms=q.getMilliseconds()},E.$utils=function(){return L},E.isValid=function(){return this.$d.toString()!==p},E.isSame=function(q,m){var C=W(q);return this.startOf(m)<=C&&C<=this.endOf(m)},E.isAfter=function(q,m){return W(q)<this.startOf(m)},E.isBefore=function(q,m){return this.endOf(m)<W(q)},E.$g=function(q,m,C){return L.u(q)?this[m]:this.set(C,q)},E.unix=function(){return Math.floor(this.valueOf()/1e3)},E.valueOf=function(){return this.$d.getTime()},E.startOf=function(q,m){var C=this,k=!!L.u(m)||m,O=L.p(q),F=function(Me,de){var qe=L.w(C.$u?Date.UTC(C.$y,de,Me):new Date(C.$y,de,Me),C);return k?qe:qe.endOf(l)},G=function(Me,de){return L.w(C.toDate()[Me].apply(C.toDate("s"),(k?[0,0,0,0]:[23,59,59,999]).slice(de)),C)},ee=this.$W,X=this.$M,re=this.$D,M="set"+(this.$u?"UTC":"");switch(O){case f:return k?F(1,0):F(31,11);case d:return k?F(1,X):F(0,X+1);case u:var oe=this.$locale().weekStart||0,Ce=(ee<oe?ee+7:ee)-oe;return F(k?re-Ce:re+(6-Ce),X);case l:case y:return G(M+"Hours",0);case c:return G(M+"Minutes",1);case o:return G(M+"Seconds",2);case s:return G(M+"Milliseconds",3);default:return this.clone()}},E.endOf=function(q){return this.startOf(q,!1)},E.$set=function(q,m){var C,k=L.p(q),O="set"+(this.$u?"UTC":""),F=(C={},C[l]=O+"Date",C[y]=O+"Date",C[d]=O+"Month",C[f]=O+"FullYear",C[c]=O+"Hours",C[o]=O+"Minutes",C[s]=O+"Seconds",C[i]=O+"Milliseconds",C)[k],G=k===l?this.$D+(m-this.$W):m;if(k===d||k===f){var ee=this.clone().set(y,1);ee.$d[F](G),ee.init(),this.$d=ee.set(y,Math.min(this.$D,ee.daysInMonth())).$d}else F&&this.$d[F](G);return this.init(),this},E.set=function(q,m){return this.clone().$set(q,m)},E.get=function(q){return this[L.p(q)]()},E.add=function(q,m){var C,k=this;q=Number(q);var O=L.p(m),F=function(X){var re=W(k);return L.w(re.date(re.date()+Math.round(X*q)),k)};if(O===d)return this.set(d,this.$M+q);if(O===f)return this.set(f,this.$y+q);if(O===l)return F(1);if(O===u)return F(7);var G=(C={},C[o]=n,C[c]=a,C[s]=r,C)[O]||1,ee=this.$d.getTime()+q*G;return L.w(ee,this)},E.subtract=function(q,m){return this.add(-1*q,m)},E.format=function(q){var m=this,C=this.$locale();if(!this.isValid())return C.invalidDate||p;var k=q||"YYYY-MM-DDTHH:mm:ssZ",O=L.z(this),F=this.$H,G=this.$m,ee=this.$M,X=C.weekdays,re=C.months,M=C.meridiem,oe=function(de,qe,ce,Oe){return de&&(de[qe]||de(m,k))||ce[qe].slice(0,Oe)},Ce=function(de){return L.s(F%12||12,de,"0")},Me=M||function(de,qe,ce){var Oe=de<12?"AM":"PM";return ce?Oe.toLowerCase():Oe};return k.replace(b,function(de,qe){return qe||function(ce){switch(ce){case"YY":return String(m.$y).slice(-2);case"YYYY":return L.s(m.$y,4,"0");case"M":return ee+1;case"MM":return L.s(ee+1,2,"0");case"MMM":return oe(C.monthsShort,ee,re,3);case"MMMM":return oe(re,ee);case"D":return m.$D;case"DD":return L.s(m.$D,2,"0");case"d":return String(m.$W);case"dd":return oe(C.weekdaysMin,m.$W,X,2);case"ddd":return oe(C.weekdaysShort,m.$W,X,3);case"dddd":return X[m.$W];case"H":return String(F);case"HH":return L.s(F,2,"0");case"h":return Ce(1);case"hh":return Ce(2);case"a":return Me(F,G,!0);case"A":return Me(F,G,!1);case"m":return String(G);case"mm":return L.s(G,2,"0");case"s":return String(m.$s);case"ss":return L.s(m.$s,2,"0");case"SSS":return L.s(m.$ms,3,"0");case"Z":return O}return null}(de)||O.replace(":","")})},E.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},E.diff=function(q,m,C){var k,O=this,F=L.p(m),G=W(q),ee=(G.utcOffset()-this.utcOffset())*n,X=this-G,re=function(){return L.m(O,G)};switch(F){case f:k=re()/12;break;case d:k=re();break;case g:k=re()/3;break;case u:k=(X-ee)/6048e5;break;case l:k=(X-ee)/864e5;break;case c:k=X/a;break;case o:k=X/n;break;case s:k=X/r;break;default:k=X}return C?k:L.a(k)},E.daysInMonth=function(){return this.endOf(d).$D},E.$locale=function(){return Y[this.$L]},E.locale=function(q,m){if(!q)return this.$L;var C=this.clone(),k=se(q,m,!0);return k&&(C.$L=k),C},E.clone=function(){return L.w(this.$d,this)},E.toDate=function(){return new Date(this.valueOf())},E.toJSON=function(){return this.isValid()?this.toISOString():null},E.toISOString=function(){return this.$d.toISOString()},E.toString=function(){return this.$d.toUTCString()},P}(),Re=ge.prototype;return W.prototype=Re,[["$ms",i],["$s",s],["$m",o],["$H",c],["$W",l],["$M",d],["$y",f],["$D",y]].forEach(function(P){Re[P[1]]=function(E){return this.$g(E,P[0],P[1])}}),W.extend=function(P,E){return P.$i||(P(E,ge,W),P.$i=!0),W},W.locale=se,W.isDayjs=H,W.unix=function(P){return W(1e3*P)},W.en=Y[$],W.Ls=Y,W.p={},W})}),Og=ue((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_quarterOfYear=n()})(e,function(){var r="month",n="quarter";return function(a,i){var s=i.prototype;s.quarter=function(l){return this.$utils().u(l)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(l-1))};var o=s.add;s.add=function(l,u){return l=Number(l),this.$utils().p(u)===n?this.add(3*l,r):o.bind(this)(l,u)};var c=s.startOf;s.startOf=function(l,u){var d=this.$utils(),g=!!d.u(u)||u;if(d.p(l)===n){var f=this.quarter()-1;return g?this.month(3*f).startOf(r).startOf("day"):this.month(3*f+2).endOf(r).endOf("day")}return c.bind(this)(l,u)}}})}),xg=ue((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_customParseFormat=n()})(e,function(){var r={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},n=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,a=/\d\d/,i=/\d\d?/,s=/\d*[^-_:/,()\s\d]+/,o={},c=function(p){return(p=+p)+(p>68?1900:2e3)},l=function(p){return function(v){this[p]=+v}},u=[/[+-]\d\d:?(\d\d)?|Z/,function(p){(this.zone||(this.zone={})).offset=function(v){if(!v||v==="Z")return 0;var b=v.match(/([+-]|\d\d)/g),A=60*b[1]+(+b[2]||0);return A===0?0:b[0]==="+"?-A:A}(p)}],d=function(p){var v=o[p];return v&&(v.indexOf?v:v.s.concat(v.f))},g=function(p,v){var b,A=o.meridiem;if(A){for(var j=1;j<=24;j+=1)if(p.indexOf(A(j,0,v))>-1){b=j>12;break}}else b=p===(v?"pm":"PM");return b},f={A:[s,function(p){this.afternoon=g(p,!1)}],a:[s,function(p){this.afternoon=g(p,!0)}],S:[/\d/,function(p){this.milliseconds=100*+p}],SS:[a,function(p){this.milliseconds=10*+p}],SSS:[/\d{3}/,function(p){this.milliseconds=+p}],s:[i,l("seconds")],ss:[i,l("seconds")],m:[i,l("minutes")],mm:[i,l("minutes")],H:[i,l("hours")],h:[i,l("hours")],HH:[i,l("hours")],hh:[i,l("hours")],D:[i,l("day")],DD:[a,l("day")],Do:[s,function(p){var v=o.ordinal,b=p.match(/\d+/);if(this.day=b[0],v)for(var A=1;A<=31;A+=1)v(A).replace(/\[|\]/g,"")===p&&(this.day=A)}],M:[i,l("month")],MM:[a,l("month")],MMM:[s,function(p){var v=d("months"),b=(d("monthsShort")||v.map(function(A){return A.slice(0,3)})).indexOf(p)+1;if(b<1)throw new Error;this.month=b%12||b}],MMMM:[s,function(p){var v=d("months").indexOf(p)+1;if(v<1)throw new Error;this.month=v%12||v}],Y:[/[+-]?\d+/,l("year")],YY:[a,function(p){this.year=c(p)}],YYYY:[/\d{4}/,l("year")],Z:u,ZZ:u};function y(p){var v,b;v=p,b=o&&o.formats;for(var A=(p=v.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(se,W,L){var ge=L&&L.toUpperCase();return W||b[L]||r[L]||b[ge].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(Re,P,E){return P||E.slice(1)})})).match(n),j=A.length,N=0;N<j;N+=1){var $=A[N],Y=f[$],Q=Y&&Y[0],H=Y&&Y[1];A[N]=H?{regex:Q,parser:H}:$.replace(/^\[|\]$/g,"")}return function(se){for(var W={},L=0,ge=0;L<j;L+=1){var Re=A[L];if(typeof Re=="string")ge+=Re.length;else{var P=Re.regex,E=Re.parser,q=se.slice(ge),m=P.exec(q)[0];E.call(W,m),se=se.replace(m,"")}}return function(C){var k=C.afternoon;if(k!==void 0){var O=C.hours;k?O<12&&(C.hours+=12):O===12&&(C.hours=0),delete C.afternoon}}(W),W}}return function(p,v,b){b.p.customParseFormat=!0,p&&p.parseTwoDigitYear&&(c=p.parseTwoDigitYear);var A=v.prototype,j=A.parse;A.parse=function(N){var $=N.date,Y=N.utc,Q=N.args;this.$u=Y;var H=Q[1];if(typeof H=="string"){var se=Q[2]===!0,W=Q[3]===!0,L=se||W,ge=Q[2];W&&(ge=Q[2]),o=this.$locale(),!se&&ge&&(o=b.Ls[ge]),this.$d=function(q,m,C){try{if(["x","X"].indexOf(m)>-1)return new Date((m==="X"?1e3:1)*q);var k=y(m)(q),O=k.year,F=k.month,G=k.day,ee=k.hours,X=k.minutes,re=k.seconds,M=k.milliseconds,oe=k.zone,Ce=new Date,Me=G||(O||F?1:Ce.getDate()),de=O||Ce.getFullYear(),qe=0;O&&!F||(qe=F>0?F-1:Ce.getMonth());var ce=ee||0,Oe=X||0,xt=re||0,nt=M||0;return oe?new Date(Date.UTC(de,qe,Me,ce,Oe,xt,nt+60*oe.offset*1e3)):C?new Date(Date.UTC(de,qe,Me,ce,Oe,xt,nt)):new Date(de,qe,Me,ce,Oe,xt,nt)}catch{return new Date("")}}($,H,Y),this.init(),ge&&ge!==!0&&(this.$L=this.locale(ge).$L),L&&$!=this.format(H)&&(this.$d=new Date("")),o={}}else if(H instanceof Array)for(var Re=H.length,P=1;P<=Re;P+=1){Q[1]=H[P-1];var E=b.apply(this,Q);if(E.isValid()){this.$d=E.$d,this.$L=E.$L,this.init();break}P===Re&&(this.$d=new Date(""))}else j.call(this,N)}}})}),Eg=ue((e,t)=>{var r=/(^|; )Coveo-Pendragon=([^;]*)/;t.exports=()=>{var n;return((n=r.exec(document.cookie))==null?void 0:n.pop())||null}}),Rg=ue((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_timezone=n()})(e,function(){var r={year:0,month:1,day:2,hour:3,minute:4,second:5},n={};return function(a,i,s){var o,c=function(g,f,y){y===void 0&&(y={});var p=new Date(g),v=function(b,A){A===void 0&&(A={});var j=A.timeZoneName||"short",N=b+"|"+j,$=n[N];return $||($=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:b,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:j}),n[N]=$),$}(f,y);return v.formatToParts(p)},l=function(g,f){for(var y=c(g,f),p=[],v=0;v<y.length;v+=1){var b=y[v],A=b.type,j=b.value,N=r[A];N>=0&&(p[N]=parseInt(j,10))}var $=p[3],Y=$===24?0:$,Q=p[0]+"-"+p[1]+"-"+p[2]+" "+Y+":"+p[4]+":"+p[5]+":000",H=+g;return(s.utc(Q).valueOf()-(H-=H%1e3))/6e4},u=i.prototype;u.tz=function(g,f){g===void 0&&(g=o);var y=this.utcOffset(),p=this.toDate(),v=p.toLocaleString("en-US",{timeZone:g}),b=Math.round((p-new Date(v))/1e3/60),A=s(v,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(p.getTimezoneOffset()/15)-b,!0);if(f){var j=A.utcOffset();A=A.add(y-j,"minute")}return A.$x.$timezone=g,A},u.offsetName=function(g){var f=this.$x.$timezone||s.tz.guess(),y=c(this.valueOf(),f,{timeZoneName:g}).find(function(p){return p.type.toLowerCase()==="timezonename"});return y&&y.value};var d=u.startOf;u.startOf=function(g,f){if(!this.$x||!this.$x.$timezone)return d.call(this,g,f);var y=s(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return d.call(y,g,f).tz(this.$x.$timezone,!0)},s.tz=function(g,f,y){var p=y&&f,v=y||f||o,b=l(+s(),v);if(typeof g!="string")return s(g).tz(v);var A=function(Y,Q,H){var se=Y-60*Q*1e3,W=l(se,H);if(Q===W)return[se,Q];var L=l(se-=60*(W-Q)*1e3,H);return W===L?[se,W]:[Y-60*Math.min(W,L)*1e3,Math.max(W,L)]}(s.utc(g,p).valueOf(),b,v),j=A[0],N=A[1],$=s(j).utcOffset(N);return $.$x.$timezone=v,$},s.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},s.tz.setDefault=function(g){o=g}}})}),Fg=ue((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_utc=n()})(e,function(){var r="minute",n=/[+-]\d\d(?::?\d\d)?/g,a=/([+-]|\d\d)/g;return function(i,s,o){var c=s.prototype;o.utc=function(p){var v={date:p,utc:!0,args:arguments};return new s(v)},c.utc=function(p){var v=o(this.toDate(),{locale:this.$L,utc:!0});return p?v.add(this.utcOffset(),r):v},c.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var l=c.parse;c.parse=function(p){p.utc&&(this.$u=!0),this.$utils().u(p.$offset)||(this.$offset=p.$offset),l.call(this,p)};var u=c.init;c.init=function(){if(this.$u){var p=this.$d;this.$y=p.getUTCFullYear(),this.$M=p.getUTCMonth(),this.$D=p.getUTCDate(),this.$W=p.getUTCDay(),this.$H=p.getUTCHours(),this.$m=p.getUTCMinutes(),this.$s=p.getUTCSeconds(),this.$ms=p.getUTCMilliseconds()}else u.call(this)};var d=c.utcOffset;c.utcOffset=function(p,v){var b=this.$utils().u;if(b(p))return this.$u?0:b(this.$offset)?d.call(this):this.$offset;if(typeof p=="string"&&(p=function($){$===void 0&&($="");var Y=$.match(n);if(!Y)return null;var Q=(""+Y[0]).match(a)||["-",0,0],H=Q[0],se=60*+Q[1]+ +Q[2];return se===0?0:H==="+"?se:-se}(p),p===null))return this;var A=Math.abs(p)<=16?60*p:p,j=this;if(v)return j.$offset=A,j.$u=p===0,j;if(p!==0){var N=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(j=this.local().add(A+N,r)).$offset=A,j.$x.$localOffset=N}else j=this.utc();return j};var g=c.format;c.format=function(p){var v=p||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return g.call(this,v)},c.valueOf=function(){var p=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*p},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var f=c.toDate;c.toDate=function(p){return p==="s"&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():f.call(this)};var y=c.diff;c.diff=function(p,v,b){if(p&&this.$u===p.$u)return y.call(this,p,v,b);var A=this.local(),j=o(p).local();return y.call(A,j,v,b)}}})}),Dg=ue((e,t)=>{function r(a){try{return JSON.stringify(a)}catch{return'"[Circular]"'}}t.exports=n;function n(a,i,s){var o=s&&s.stringify||r,c=1;if(typeof a=="object"&&a!==null){var l=i.length+c;if(l===1)return a;var u=new Array(l);u[0]=o(a);for(var d=1;d<l;d++)u[d]=o(i[d]);return u.join(" ")}if(typeof a!="string")return a;var g=i.length;if(g===0)return a;for(var f="",y=1-c,p=-1,v=a&&a.length||0,b=0;b<v;){if(a.charCodeAt(b)===37&&b+1<v){switch(p=p>-1?p:0,a.charCodeAt(b+1)){case 100:case 102:if(y>=g||i[y]==null)break;p<b&&(f+=a.slice(p,b)),f+=Number(i[y]),p=b+2,b++;break;case 105:if(y>=g||i[y]==null)break;p<b&&(f+=a.slice(p,b)),f+=Math.floor(Number(i[y])),p=b+2,b++;break;case 79:case 111:case 106:if(y>=g||i[y]===void 0)break;p<b&&(f+=a.slice(p,b));var A=typeof i[y];if(A==="string"){f+="'"+i[y]+"'",p=b+2,b++;break}if(A==="function"){f+=i[y].name||"<anonymous>",p=b+2,b++;break}f+=o(i[y]),p=b+2,b++;break;case 115:if(y>=g)break;p<b&&(f+=a.slice(p,b)),f+=String(i[y]),p=b+2,b++;break;case 37:p<b&&(f+=a.slice(p,b)),f+="%",p=b+2,b++,y--;break}++y}++b}return p===-1?a:(p<v&&(f+=a.slice(p)),f)}}),Tg=ue((e,t)=>{var r=Dg();t.exports=g;var n=q().console||{},a={mapHttpRequest:se,mapHttpResponse:se,wrapRequestSerializer:W,wrapResponseSerializer:W,wrapErrorSerializer:W,req:se,res:se,err:Q,errWithCause:Q};function i(m,C){return m==="silent"?1/0:C.levels.values[m]}var s=Symbol("pino.logFuncs"),o=Symbol("pino.hierarchy"),c={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function l(m,C){let k={logger:C,parent:m[o]};C[o]=k}function u(m,C,k){let O={};C.forEach(F=>{O[F]=k[F]?k[F]:n[F]||n[c[F]||"log"]||L}),m[s]=O}function d(m,C){return Array.isArray(m)?m.filter(function(k){return k!=="!stdSerializers.err"}):m===!0?Object.keys(C):!1}function g(m){m=m||{},m.browser=m.browser||{};let C=m.browser.transmit;if(C&&typeof C.send!="function")throw Error("pino: transmit option must have a send function");let k=m.browser.write||n;m.browser.write&&(m.browser.asObject=!0);let O=m.serializers||{},F=d(m.browser.serialize,O),G=m.browser.serialize;Array.isArray(m.browser.serialize)&&m.browser.serialize.indexOf("!stdSerializers.err")>-1&&(G=!1);let ee=Object.keys(m.customLevels||{}),X=["error","fatal","warn","info","debug","trace"].concat(ee);typeof k=="function"&&X.forEach(function(ce){k[ce]=k}),(m.enabled===!1||m.browser.disabled)&&(m.level="silent");let re=m.level||"info",M=Object.create(k);M.log||(M.log=L),u(M,X,k),l({},M),Object.defineProperty(M,"levelVal",{get:Ce}),Object.defineProperty(M,"level",{get:Me,set:de});let oe={transmit:C,serialize:F,asObject:m.browser.asObject,formatters:m.browser.formatters,levels:X,timestamp:H(m)};M.levels=f(m),M.level=re,M.setMaxListeners=M.getMaxListeners=M.emit=M.addListener=M.on=M.prependListener=M.once=M.prependOnceListener=M.removeListener=M.removeAllListeners=M.listeners=M.listenerCount=M.eventNames=M.write=M.flush=L,M.serializers=O,M._serialize=F,M._stdErrSerialize=G,M.child=qe,C&&(M._logEvent=Y());function Ce(){return i(this.level,this)}function Me(){return this._level}function de(ce){if(ce!=="silent"&&!this.levels.values[ce])throw Error("unknown level "+ce);this._level=ce,v(this,oe,M,"error"),v(this,oe,M,"fatal"),v(this,oe,M,"warn"),v(this,oe,M,"info"),v(this,oe,M,"debug"),v(this,oe,M,"trace"),ee.forEach(Oe=>{v(this,oe,M,Oe)})}function qe(ce,Oe){if(!ce)throw new Error("missing bindings for child Pino");Oe=Oe||{},F&&ce.serializers&&(Oe.serializers=ce.serializers);let xt=Oe.serializers;if(F&&xt){var nt=Object.assign({},O,xt),gs=m.browser.serialize===!0?Object.keys(nt):F;delete ce.serializers,N([ce],gs,nt,this._stdErrSerialize)}function ps(fs){this._childLevel=(fs._childLevel|0)+1,this.bindings=ce,nt&&(this.serializers=nt,this._serialize=gs),C&&(this._logEvent=Y([].concat(fs._logEvent.bindings,ce)))}ps.prototype=this;let Gn=new ps(this);return l(this,Gn),Gn.level=this.level,Gn}return M}function f(m){let C=m.customLevels||{},k=Object.assign({},g.levels.values,C),O=Object.assign({},g.levels.labels,y(C));return{values:k,labels:O}}function y(m){let C={};return Object.keys(m).forEach(function(k){C[m[k]]=k}),C}g.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},g.stdSerializers=a,g.stdTimeFunctions=Object.assign({},{nullTime:ge,epochTime:Re,unixTime:P,isoTime:E});function p(m){let C=[];m.bindings&&C.push(m.bindings);let k=m[o];for(;k.parent;)k=k.parent,k.logger.bindings&&C.push(k.logger.bindings);return C.reverse()}function v(m,C,k,O){if(Object.defineProperty(m,O,{value:i(m.level,k)>i(O,k)?L:k[s][O],writable:!0,enumerable:!0,configurable:!0}),!C.transmit&&m[O]===L)return;m[O]=A(m,C,k,O);let F=p(m);F.length!==0&&(m[O]=b(F,m[O]))}function b(m,C){return function(){return C.apply(this,[...m,...arguments])}}function A(m,C,k,O){return function(F){return function(){let G=C.timestamp(),ee=new Array(arguments.length),X=Object.getPrototypeOf&&Object.getPrototypeOf(this)===n?n:this;for(var re=0;re<ee.length;re++)ee[re]=arguments[re];if(C.serialize&&!C.asObject&&N(ee,this._serialize,this.serializers,this._stdErrSerialize),C.asObject||C.formatters?F.call(X,j(this,O,ee,G,C.formatters)):F.apply(X,ee),C.transmit){let M=C.transmit.level||m._level,oe=k.levels.values[M],Ce=k.levels.values[O];if(Ce<oe)return;$(this,{ts:G,methodLevel:O,methodValue:Ce,transmitLevel:M,transmitValue:k.levels.values[C.transmit.level||m._level],send:C.transmit.send,val:i(m._level,k)},ee)}}}(m[s][O])}function j(m,C,k,O,F={}){let{level:G=()=>m.levels.values[C],log:ee=Ce=>Ce}=F;m._serialize&&N(k,m._serialize,m.serializers,m._stdErrSerialize);let X=k.slice(),re=X[0],M={};O&&(M.time=O),M.level=G(C,m.levels.values[C]);let oe=(m._childLevel|0)+1;if(oe<1&&(oe=1),re!==null&&typeof re=="object"){for(;oe--&&typeof X[0]=="object";)Object.assign(M,X.shift());re=X.length?r(X.shift(),X):void 0}else typeof re=="string"&&(re=r(X.shift(),X));return re!==void 0&&(M.msg=re),ee(M)}function N(m,C,k,O){for(let F in m)if(O&&m[F]instanceof Error)m[F]=g.stdSerializers.err(m[F]);else if(typeof m[F]=="object"&&!Array.isArray(m[F]))for(let G in m[F])C&&C.indexOf(G)>-1&&G in k&&(m[F][G]=k[G](m[F][G]))}function $(m,C,k){let O=C.send,F=C.ts,G=C.methodLevel,ee=C.methodValue,X=C.val,re=m._logEvent.bindings;N(k,m._serialize||Object.keys(m.serializers),m.serializers,m._stdErrSerialize===void 0?!0:m._stdErrSerialize),m._logEvent.ts=F,m._logEvent.messages=k.filter(function(M){return re.indexOf(M)===-1}),m._logEvent.level.label=G,m._logEvent.level.value=ee,O(G,m._logEvent,X),m._logEvent=Y(re)}function Y(m){return{ts:0,messages:[],bindings:m||[],level:{label:"",value:0}}}function Q(m){let C={type:m.constructor.name,msg:m.message,stack:m.stack};for(let k in m)C[k]===void 0&&(C[k]=m[k]);return C}function H(m){return typeof m.timestamp=="function"?m.timestamp:m.timestamp===!1?ge:Re}function se(){return{}}function W(m){return m}function L(){}function ge(){return!1}function Re(){return Date.now()}function P(){return Math.round(Date.now()/1e3)}function E(){return new Date(Date.now()).toISOString()}function q(){function m(C){return typeof C<"u"&&C}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return m(self)||m(window)||m(this)||{}}}t.exports.default=g,t.exports.pino=g}),Nt=()=>global.crypto,Mg=()=>{typeof window<"u"||(Nt()||(global.crypto=dg("crypto")),!Nt().getRandomValues&&Nt().webcrypto&&(global.crypto.getRandomValues=Nt().webcrypto.getRandomValues.bind(Nt().webcrypto)))},jg={};gg(jg,{escape:()=>Et,getHighlightedSuggestion:()=>zo,highlightString:()=>Wg});function Pg(e,t){let r=`
  The following properties are invalid:

    ${e.join(`
	`)}
  
  ${t}
  `;return new hn(r)}var hn=class extends Error{constructor(e){super(e),this.name="SchemaValidationError"}},ye=class{constructor(e){this.definition=e}validate(e={},t=""){let r={...this.default,...e},n=[];for(let a in this.definition){let i=this.definition[a].validate(r[a]);i&&n.push(`${a}: ${i}`)}if(n.length)throw Pg(n,t);return r}get default(){let e={};for(let t in this.definition){let r=this.definition[t].default;r!==void 0&&(e[t]=r)}return e}},he=class{constructor(e={}){this.baseConfig=e}validate(e){return this.baseConfig.required&&z(e)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return this.baseConfig.required===!0}};function ut(e){return e===void 0}function Ug(e){return e===null}function z(e){return ut(e)||Ug(e)}var B=class{constructor(e={}){this.config=e,this.value=new he(e)}validate(e){return this.value.validate(e)||(_g(e)?e<this.config.min?`minimum value of ${this.config.min} not respected.`:e>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}};function _g(e){return ut(e)||Uo(e)}function Uo(e){return typeof e=="number"&&!isNaN(e)}var J=class{constructor(e={}){this.value=new he(e)}validate(e){return this.value.validate(e)||(Vg(e)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}};function Vg(e){return ut(e)||_o(e)}function _o(e){return typeof e=="boolean"}var $g=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i,x=class{constructor(e={}){this.config={emptyAllowed:!0,url:!1,...e},this.value=new he(this.config)}validate(e){let{emptyAllowed:t,url:r,regex:n,constrainTo:a}=this.config;return this.value.validate(e)||(ut(e)?null:ti(e)?!t&&!e.length?"value is an empty string.":r&&!$g.test(e)?"value is not a valid URL.":n&&!n.test(e)?`value did not match provided regex ${n}`:a&&!a.includes(e)?`value should be one of: ${a.join(", ")}.`:null:"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}};function ti(e){return Object.prototype.toString.call(e)==="[object String]"}var T=class{constructor(e={}){this.config={options:{required:!1},values:{},...e}}validate(e){if(ut(e))return this.config.options.required?"value is required and is currently undefined":null;if(!Vo(e))return"value is not an object";for(let[r,n]of Object.entries(this.config.values))if(n.required&&z(e[r]))return`value does not contain ${r}`;let t="";for(let[r,n]of Object.entries(this.config.values)){let a=e[r],i=n.validate(a);i!==null&&(t+=" "+i)}return t===""?null:t}get default(){}get required(){return!!this.config.options.required}};function Vo(e){return e!==void 0&&typeof e=="object"}var ie=class{constructor(e={}){this.config=e,this.value=new he(this.config)}validate(e){if(!z(e)&&!Array.isArray(e))return"value is not an array";let t=this.value.validate(e);if(t!==null)return t;if(z(e))return null;if(this.config.max!==void 0&&e.length>this.config.max)return`value contains more than ${this.config.max}`;if(this.config.min!==void 0&&e.length<this.config.min)return`value contains less than ${this.config.min}`;if(this.config.each!==void 0){let r="";return e.forEach(n=>{this.config.each.required&&z(n)&&(r=`value is null or undefined: ${e.join(",")}`);let a=this.validatePrimitiveValue(n,this.config.each);a!==null&&(r+=" "+a)}),r===""?null:r}return null}validatePrimitiveValue(e,t){return _o(e)||ti(e)||Uo(e)||Vo(e)?t.validate(e):"value is not a primitive value"}get default(){}get required(){return this.value.required}};function $o(e){return Array.isArray(e)}var St=class{constructor(e){this.config=e,this.value=new he(e)}validate(e){let t=this.value.validate(e);return t!==null?t:ut(e)||Object.values(this.config.enum).find(r=>r===e)?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}},Lg=Qe(yg()),Lo=(e,t=5)=>e+Math.random().toString(36).substring(2,2+t);function Qg(e){return Array.isArray(e)}function Yn(e){return e.trim()===""}function zg(e,t){return[...e.reduce((r,n)=>{let a=t(n);return r.has(a)||r.set(a,n),r},new Map).values()]}function Bg(e){return(typeof btoa<"u"?btoa:Lg.btoa)(encodeURI(e))}function Ng(e,t){let{[e]:r,...n}=t;return n}function ri(e){return Bg(JSON.stringify(e))}var Hg=new Set(["1",1,"yes",!0]);function Qo(){if(typeof navigator>"u"||typeof window>"u")return!1;let e=navigator,t=window;return[e.globalPrivacyControl,e.doNotTrack,e.msDoNotTrack,t.doNotTrack].some(r=>Hg.has(r))}function Gg(e){let t={};for(let[r,n]of e)t[r]=n;return t}function Yg(e,t,r){return clearTimeout(t),setTimeout(e,r)}function ni(e){if(typeof e!="object"||!e)return e;try{return JSON.parse(JSON.stringify(e))}catch{return e}}function Wg(e){if(Yn(e.openingDelimiter)||Yn(e.closingDelimiter))throw Error("delimiters should be a non-empty string");if(z(e.content)||Yn(e.content))return e.content;if(e.highlights.length===0)return Et(e.content);let t=e.content.length,r="",n=0;for(let a=0;a<e.highlights.length;a++){let i=e.highlights[a],s=i.offset,o=s+i.length;if(o>t)break;r+=Et(e.content.slice(n,s)),r+=e.openingDelimiter,r+=Et(e.content.slice(s,o)),r+=e.closingDelimiter,n=o}return n!==t&&(r+=Et(e.content.slice(n))),r}function zo(e,t){return e=Et(e),e.replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,(r,n,a,i)=>n?Wn(n,t.notMatchDelimiters):a?Wn(a,t.exactMatchDelimiters):i?Wn(i,t.correctionDelimiters):r)}function Wn(e,t){return t?t.open+e+t.close:e}function Et(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r="(?:"+Object.keys(t).join("|")+")",n=RegExp(r),a=RegExp(r,"g");return n.test(e)?e.replace(a,i=>t[i]):e}async function Kg(e,t){let r=e.getReader(),n;for(;!(n=await r.read()).done;)t(n.value)}function Jg(e){let t,r,n,a=!1;return function(i){t===void 0?(t=i,r=0,n=-1):t=Xg(t,i);let s=t.length,o=0;for(;r<s;){a&&(t[r]===10&&(o=++r),a=!1);let c=-1;for(;r<s&&c===-1;++r)switch(t[r]){case 58:n===-1&&(n=r-o);break;case 13:a=!0;case 10:c=r;break}if(c===-1)break;e(t.subarray(o,c),n),o=r,n=-1}o===s?t=void 0:o!==0&&(t=t.subarray(o),r-=o)}}function Zg(e,t,r){let n=hs(),a=new TextDecoder;return function(i,s){if(i.length===0)r==null||r(n),n=hs();else if(s>0){let o=a.decode(i.subarray(0,s)),c=s+(i[s+1]===32?2:1),l=a.decode(i.subarray(c));switch(o){case"data":n.data=n.data?n.data+`
`+l:l;break;case"event":n.event=l;break;case"id":e(n.id=l);break;case"retry":let u=parseInt(l,10);isNaN(u)||t(n.retry=u);break}}}}function Xg(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function hs(){return{data:"",event:"",id:"",retry:void 0}}var ep=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},ka="text/event-stream",tp=1e3,ys="last-event-id";function rp(e,t){var{signal:r,headers:n,onopen:a,onmessage:i,onclose:s,onerror:o,openWhenHidden:c,fetch:l}=t,u=ep(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise((d,g)=>{let f=Object.assign({},n);f.accept||(f.accept=ka);let y;function p(){y==null||y.abort(),document.hidden||$()}!c&&void 0&&document.addEventListener("visibilitychange",p);let v=tp,b=0;function A(){void 0&&document.removeEventListener("visibilitychange",p),clearTimeout(b),y==null||y.abort()}r==null||r.addEventListener("abort",()=>{A(),d()});let j=l??j,N=a??np;async function $(){var Y;y=typeof AbortController>"u"?null:new AbortController;try{let Q=await j(e,Object.assign(Object.assign({},u),{headers:f,signal:y==null?void 0:y.signal}));await N(Q),await Kg(Q.body,Jg(Zg(H=>{H?f[ys]=H:delete f[ys]},H=>{v=H},i))),s==null||s(),A(),d()}catch(Q){if(!(y!=null&&y.signal.aborted))try{let H=(Y=o==null?void 0:o(Q))!==null&&Y!==void 0?Y:v;clearTimeout(b),b=setTimeout($,H)}catch(H){A(),g(H)}}}$()})}function np(e){let t=e.headers.get("content-type");if(!(t!=null&&t.startsWith(ka)))throw new Error(`Expected content-type to be ${ka}, Actual: ${t}`)}function ap(){if(typeof window>"u"){let{AbortController:e}=mg();return new e}return typeof AbortController>"u"?null:new AbortController}var Bo=class{constructor(e){this._params={},this._basePath=e}addParam(e,t){this._params={...this.params,[e]:t}}get basePath(){return this._basePath}get params(){return this._params}get hasParams(){return Object.entries(this._params).length}get href(){return this.hasParams?`${this.basePath}?${Object.entries(this.params).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&")}`:this.basePath}},ip=e=>/^https:\/\/platform(dev|stg|hipaa)?(-)?(eu|au)?\.cloud\.coveo\.com/.test(e),sp=(e,t)=>{let r=No(e);return r&&r.organizationId===t?r:null},No=e=>{let t=e.match(/^https:\/\/(?<organizationId>\w+)\.org(?<environment>dev|stg|hipaa)?\.coveo\.com/);return t!=null&&t.groups?t.groups:null},op=(e,t,r)=>new Bo(`${e}/rest/organizations/${t}/machinelearning/streaming/${r}`).href,ms=3,cp=5e3,lp="text/event-stream",Ho=1,up=class extends Error{},Kn=class extends Error{constructor(e){super(e.message),this.payload=e}},dp=class{constructor(){this.timeouts=new Set}add(e){this.timeouts.add(e)}remove(e){clearTimeout(e),this.timeouts.delete(e)}isActive(e){return this.timeouts.has(e)}},gp=class{constructor(e){this.logger=e.logger}streamGeneratedAnswer(e,t){let{url:r,organizationId:n,streamId:a,accessToken:i}=e,{write:s,abort:o,close:c,resetAnswer:l}=t,u=new dp;if(!a){this.logger.error("No stream ID found");return}let d=0,g,f=()=>{g&&!u.isActive(g)&&(p==null||p.abort(),l(),v())},y=()=>{u.remove(g),g=Yg(f,g,cp),u.add(g)},p=ap(),v=()=>rp(op(r,n,a),{method:"GET",fetch,headers:{Authorization:`Bearer ${i}`,accept:"*/*"},openWhenHidden:!0,signal:p==null?void 0:p.signal,async onopen(b){if(!(b.ok&&b.headers.get("content-type")===lp))throw b.status>=400&&b.status<500&&b.status!==429?new Kn({message:"Error opening stream",code:b.status}):new up},onmessage:b=>{if(p!=null&&p.signal.aborted)return;let A=JSON.parse(b.data);if(A.finishReason==="ERROR"){u.remove(g),p==null||p.abort(),o({message:A.errorMessage,code:A.statusCode});return}s(A),d=0,A.finishReason==="COMPLETED"?(u.remove(g),c()):y()},onerror:b=>{if(!(p!=null&&p.signal.aborted)){if(u.remove(g),b instanceof Kn)throw p==null||p.abort(),o(b),b;if(++d>ms){this.logger.info("Maximum retry exceeded.");let A={message:"Failed to complete stream.",code:Ho};throw p==null||p.abort(),o(A),new Kn(A)}this.logger.info(`Retrying...(${d}/${ms})`),l()}}});return v(),p}},Go=e=>e,pp=Qe(vg()),fp=Qe(qg()),Yo=class extends Error{constructor(){super(),this.name="ExpiredToken",this.message="The token being used to perform the request is expired."}},Aa=class extends Error{constructor(e,t){super(),this.name="Disconnected",this.message=`Client could not connect to the following URL: ${e}`,this.statusCode=t??0}};function hp(e){let t=[];for(let r in e){let n=encodeURIComponent(r),a=encodeURIComponent(e[r]);t.push(`${n}=${a}`)}return t.join("&")}function yp(e){return typeof e!="object"||!e?!1:Object.values(e).every(mp)}function mp(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function vs(e){return e===429}var Tr=class Wo{static async call(t){let r=wp(t),{logger:n}=t,a=await Wo.preprocessRequest(r,t);n.info(a,"Platform request");let{url:i,...s}=a,o=async()=>{let c=await(0,pp.default)(i,s);if(vs(c.status))throw c;return c};try{let c=await(0,fp.backOff)(o,{retry:l=>{let u=l&&vs(l.status);return u&&n.info("Platform retrying request"),u}});if(c.status===419)throw n.info("Platform renewing token"),new Yo;if(c.status===404)throw new Aa(i,c.status);return n.info({response:c,requestInfo:a},"Platform response"),c}catch(c){return c.message==="Failed to fetch"?new Aa(i):c}}static async preprocessRequest(t,r){let{origin:n,preprocessRequest:a,logger:i,requestMetadata:s}=r,{signal:o,...c}=t,l=ni(c);try{let u=await a(t,n,s);return{...t,...u}}catch(u){i.error(u,"Platform request preprocessing failed. Returning default request options.")}return l}};function Ko(e,t){return`https://${e}.cloud.coveo.com`}function vp(e,t="prod"){let r=t==="prod"?"":t,n=`https://${e}.org${r}.coveo.com`,a=`https://${e}.analytics.org${r}.coveo.com`,i=`${n}/rest/search/v2`,s=`https://${e}.admin.org${r}.coveo.com`;return{platform:n,analytics:a,search:i,admin:s}}function Ss(e){return Ko("platform")}function Sp(e){return Ko("analytics")}function wp(e){let{url:t,method:r,requestParams:n,contentType:a,accessToken:i,signal:s}=e,o=e.method==="POST"||e.method==="PUT",c=bp(n,a);return{url:t,method:r,headers:{"Content-Type":a,Authorization:`Bearer ${i}`,...e.headers},...o&&{body:c},signal:s}}function bp(e,t){return t==="application/x-www-form-urlencoded"?yp(e)?hp(e):"":JSON.stringify(e)}function Wr(){return{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}}function $e(){return{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:Wr(),pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],searchResponseId:"",requestId:"",questionAnswer:Wr(),extendedResults:{}}}function Cp(e){let{url:t,accessToken:r,organizationId:n,authentication:a,...i}=e;return i}var Ip=(e,t)=>{let r=new Bo(`${e.url}${t}`);return r.addParam("access_token",e.accessToken),r.addParam("organizationId",e.organizationId),r.addParam("uniqueId",e.uniqueId),e.q!==void 0&&r.addParam("q",e.q),e.enableNavigation!==void 0&&r.addParam("enableNavigation",`${e.enableNavigation}`),e.requestedOutputSize!==void 0&&r.addParam("requestedOutputSize",`${e.requestedOutputSize}`),e.visitorId!==void 0&&r.addParam("visitorId",`${e.visitorId}`),r.href};function kp(e){return{statusCode:e.statusCode,type:e.name,message:e.message}}function Mr(e,t){if(e instanceof Aa)return{error:kp(e)};throw e}var yn=e=>e.success!==void 0,pe=e=>e.error!==void 0;function Ap(e){return e.results!==void 0}function qp(e){let t=Wr();return z(e.questionAnswer)?(e.questionAnswer=t,e):(e.questionAnswer={...t,...e.questionAnswer},e)}var Op=(e,t)=>`${e.url}/rest/organizations/${e.organizationId}/insight/v1/configs/${e.insightId}${t??""}`,mn=(e,t,r,n)=>{xp(e);let a=Op(e,n);return{accessToken:e.accessToken,method:t,contentType:r,url:a,origin:"insightApiFetch"}},ai=e=>{let{insightId:t,...r}=Cp(e);return r},xp=e=>{if(!e.url)throw new Error("The 'url' attribute must contain a valid platform URL.");if(!e.organizationId)throw new Error("The 'organizationId' attribute must contain a valid organization ID.");if(!e.accessToken)throw new Error("The 'accessToken' attribute must contain a valid platform access token.");if(!e.insightId)throw new Error("The 'insightId' attribute must contain a valid Insight Panel configuration ID.")},Ep=e=>({...mn(e,"GET","application/json","/interface"),requestParams:{}}),Rp=e=>({...mn(e,"POST","application/json","/search"),requestParams:ai(e)}),Fp=e=>({...mn(e,"POST","application/json","/querysuggest"),requestParams:ai(e)}),Dp=e=>{let t=ai(e);return{...mn(e,"POST","application/json","/useractions"),requestParams:{ticketCreationDate:t.ticketCreationDate,numberSessionsBefore:t.numberSessionsBefore??50,numberSessionsAfter:t.numberSessionsAfter??50,maximumSessionInactivityMinutes:t.maximumSessionInactivityMinutes??30,excludedCustomActions:t.excludedCustomActions??[]}}},Tp=class{constructor(e){this.options=e}async getInterface(e){let t=await Tr.call({...Ep(e),...this.options});if(t instanceof Error)return Mr(t);let r=await t.json();return t.ok?{success:r}:{error:r}}async query(e,t){let r=await Tr.call({...Rp(e),requestMetadata:{method:"search",origin:t==null?void 0:t.origin},...this.options});if(r instanceof Error)return Mr(r);let n=await r.json();return Ap(n)&&(n=qp(n)),r.ok?{success:n}:{error:n}}async querySuggest(e){let t=await Tr.call({...Fp(e),...this.options});if(t instanceof Error)return Mr(t);let r=await t.json();return r.completions?{success:r}:{error:r}}async userActions(e){let t=await Tr.call({...Dp(e),...this.options});if(t instanceof Error)return Mr(t);let r=await t.json();return t.ok?{success:r}:{error:r}}},D=new x({required:!0,emptyAllowed:!1}),te=new x({required:!1,emptyAllowed:!1}),be=new x({required:!0,emptyAllowed:!0}),Mp=new x({required:!1,emptyAllowed:!0}),Jo=new ie({each:D,required:!0}),jp=new x({required:!1,emptyAllowed:!1,regex:/^\d+\.\d+\.\d+$/}),dt=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),kt=(e,t)=>{if("required"in t)return{payload:new ye({value:t}).validate({value:e}).value};let r=new T({options:{required:!0},values:t}).validate(e);if(r)throw new hn(r);return{payload:e}},I=(e,t)=>{try{return kt(e,t)}catch(r){return{payload:e,error:dt(r)}}},ii=(e,t,r,n)=>{let a=`Check the initialState of ${n}`;return Zo(e,t,r,a,"Controller initialization error")},gt=(e,t,r,n)=>{let a=`Check the options of ${n}`;return Zo(e,t,r,a,"Controller initialization error")},Zo=(e,t,r,n,a)=>{try{return t.validate(r,n)}catch(i){throw e.logger.error(i,a),i}};function ve(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Pp=typeof Symbol=="function"&&Symbol.observable||"@@observable",ws=Pp,Jn=()=>Math.random().toString(36).substring(7).split("").join("."),Up={INIT:`@@redux/INIT${Jn()}`,REPLACE:`@@redux/REPLACE${Jn()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Jn()}`},Kr=Up;function si(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Xo(e,t,r){if(typeof e!="function")throw new Error(ve(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(ve(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(ve(1));return r(Xo)(e,t)}let n=e,a=t,i=new Map,s=i,o=0,c=!1;function l(){s===i&&(s=new Map,i.forEach((p,v)=>{s.set(v,p)}))}function u(){if(c)throw new Error(ve(3));return a}function d(p){if(typeof p!="function")throw new Error(ve(4));if(c)throw new Error(ve(5));let v=!0;l();let b=o++;return s.set(b,p),function(){if(v){if(c)throw new Error(ve(6));v=!1,l(),s.delete(b),i=null}}}function g(p){if(!si(p))throw new Error(ve(7));if(typeof p.type>"u")throw new Error(ve(8));if(typeof p.type!="string")throw new Error(ve(17));if(c)throw new Error(ve(9));try{c=!0,a=n(a,p)}finally{c=!1}return(i=s).forEach(v=>{v()}),p}function f(p){if(typeof p!="function")throw new Error(ve(10));n=p,g({type:Kr.REPLACE})}function y(){let p=d;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(ve(11));function b(){let A=v;A.next&&A.next(u())}return b(),{unsubscribe:p(b)}},[ws](){return this}}}return g({type:Kr.INIT}),{dispatch:g,subscribe:d,getState:u,replaceReducer:f,[ws]:y}}function _p(e){Object.keys(e).forEach(t=>{let r=e[t];if(typeof r(void 0,{type:Kr.INIT})>"u")throw new Error(ve(12));if(typeof r(void 0,{type:Kr.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(ve(13))})}function ec(e){let t=Object.keys(e),r={};for(let i=0;i<t.length;i++){let s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}let n=Object.keys(r),a;try{_p(r)}catch(i){a=i}return function(i={},s){if(a)throw a;let o=!1,c={};for(let l=0;l<n.length;l++){let u=n[l],d=r[u],g=i[u],f=d(g,s);if(typeof f>"u")throw new Error(ve(14));c[u]=f,o=o||f!==g}return o=o||n.length!==Object.keys(i).length,o?c:i}}function Jr(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function Vp(...e){return t=>(r,n)=>{let a=t(r,n),i=()=>{throw new Error(ve(15))},s={getState:a.getState,dispatch:(c,...l)=>i(c,...l)},o=e.map(c=>c(s));return i=Jr(...o)(a.dispatch),{...a,dispatch:i}}}function $p(e){return si(e)&&"type"in e&&typeof e.type=="string"}var tc=Symbol.for("immer-nothing"),bs=Symbol.for("immer-draftable"),Pe=Symbol.for("immer-state");function ze(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Pt=Object.getPrototypeOf;function st(e){return!!e&&!!e[Pe]}function Ke(e){var t;return e?rc(e)||Array.isArray(e)||!!e[bs]||!!((t=e.constructor)!=null&&t[bs])||Sn(e)||wn(e):!1}var Lp=Object.prototype.constructor.toString();function rc(e){if(!e||typeof e!="object")return!1;let t=Pt(e);if(t===null)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Lp}function er(e,t){vn(e)===0?Object.entries(e).forEach(([r,n])=>{t(r,n,e)}):e.forEach((r,n)=>t(n,r,e))}function vn(e){let t=e[Pe];return t?t.type_:Array.isArray(e)?1:Sn(e)?2:wn(e)?3:0}function qa(e,t){return vn(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function nc(e,t,r){let n=vn(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Qp(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Sn(e){return e instanceof Map}function wn(e){return e instanceof Set}function yt(e){return e.copy_||e.base_}function Oa(e,t){if(Sn(e))return new Map(e);if(wn(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&rc(e))return Pt(e)?{...e}:Object.assign(Object.create(null),e);let r=Object.getOwnPropertyDescriptors(e);delete r[Pe];let n=Reflect.ownKeys(r);for(let a=0;a<n.length;a++){let i=n[a],s=r[i];s.writable===!1&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(r[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[i]})}return Object.create(Pt(e),r)}function oi(e,t=!1){return bn(e)||st(e)||!Ke(e)||(vn(e)>1&&(e.set=e.add=e.clear=e.delete=zp),Object.freeze(e),t&&er(e,(r,n)=>oi(n,!0))),e}function zp(){ze(2)}function bn(e){return Object.isFrozen(e)}var Bp={};function wt(e){let t=Bp[e];return t||ze(0,e),t}var tr;function ac(){return tr}function Np(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Cs(e,t){t&&(wt("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function xa(e){Ea(e),e.drafts_.forEach(Hp),e.drafts_=null}function Ea(e){e===tr&&(tr=e.parent_)}function Is(e){return tr=Np(tr,e)}function Hp(e){let t=e[Pe];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function ks(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[Pe].modified_&&(xa(t),ze(4)),Ke(e)&&(e=Zr(t,e),t.parent_||Xr(t,e)),t.patches_&&wt("Patches").generateReplacementPatches_(r[Pe].base_,e,t.patches_,t.inversePatches_)):e=Zr(t,r,[]),xa(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==tc?e:void 0}function Zr(e,t,r){if(bn(t))return t;let n=t[Pe];if(!n)return er(t,(a,i)=>As(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Xr(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let a=n.copy_,i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),er(i,(o,c)=>As(e,n,a,o,c,r,s)),Xr(e,a,!1),r&&e.patches_&&wt("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function As(e,t,r,n,a,i,s){if(st(a)){let o=i&&t&&t.type_!==3&&!qa(t.assigned_,n)?i.concat(n):void 0,c=Zr(e,a,o);if(nc(r,n,c),st(c))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(Ke(a)&&!bn(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Zr(e,a),(!t||!t.scope_.parent_)&&Xr(e,a)}}function Xr(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&oi(t,r)}function Gp(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:ac(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},a=n,i=ci;r&&(a=[n],i=rr);let{revoke:s,proxy:o}=Proxy.revocable(a,i);return n.draft_=o,n.revoke_=s,o}var ci={get(e,t){if(t===Pe)return e;let r=yt(e);if(!qa(r,t))return Yp(e,r,t);let n=r[t];return e.finalized_||!Ke(n)?n:n===Zn(e.base_,t)?(Xn(e),e.copy_[t]=Fa(n,e)):n},has(e,t){return t in yt(e)},ownKeys(e){return Reflect.ownKeys(yt(e))},set(e,t,r){let n=ic(yt(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let a=Zn(yt(e),t),i=a==null?void 0:a[Pe];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Qp(r,a)&&(r!==void 0||qa(e.base_,t)))return!0;Xn(e),Ra(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Zn(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Xn(e),Ra(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=yt(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){ze(11)},getPrototypeOf(e){return Pt(e.base_)},setPrototypeOf(){ze(12)}},rr={};er(ci,(e,t)=>{rr[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});rr.deleteProperty=function(e,t){return rr.set.call(this,e,t,void 0)};rr.set=function(e,t,r){return ci.set.call(this,e[0],t,r,e[0])};function Zn(e,t){let r=e[Pe];return(r?yt(r):e)[t]}function Yp(e,t,r){var a;let n=ic(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function ic(e,t){if(!(t in e))return;let r=Pt(e);for(;r;){let n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Pt(r)}}function Ra(e){e.modified_||(e.modified_=!0,e.parent_&&Ra(e.parent_))}function Xn(e){e.copy_||(e.copy_=Oa(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Wp=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){let i=r;r=t;let s=this;return function(o=i,...c){return s.produce(o,l=>r.call(this,l,...c))}}typeof r!="function"&&ze(6),n!==void 0&&typeof n!="function"&&ze(7);let a;if(Ke(t)){let i=Is(this),s=Fa(t,void 0),o=!0;try{a=r(s),o=!1}finally{o?xa(i):Ea(i)}return Cs(i,n),ks(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===tc&&(a=void 0),this.autoFreeze_&&oi(a,!0),n){let i=[],s=[];wt("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else ze(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...s)=>this.produceWithPatches(i,o=>t(o,...s));let n,a;return[this.produce(t,r,(i,s)=>{n=i,a=s}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ke(e)||ze(8),st(e)&&(e=sc(e));let t=Is(this),r=Fa(e,void 0);return r[Pe].isManual_=!0,Ea(t),r}finishDraft(e,t){let r=e&&e[Pe];(!r||!r.isManual_)&&ze(9);let{scope_:n}=r;return Cs(n,t),ks(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));let n=wt("Patches").applyPatches_;return st(e)?n(e,t):this.produce(e,a=>n(a,t))}};function Fa(e,t){let r=Sn(e)?wt("MapSet").proxyMap_(e,t):wn(e)?wt("MapSet").proxySet_(e,t):Gp(e,t);return(t?t.scope_:ac()).drafts_.push(r),r}function sc(e){return st(e)||ze(10,e),oc(e)}function oc(e){if(!Ke(e)||bn(e))return e;let t=e[Pe],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Oa(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Oa(e,!0);return er(r,(n,a)=>{nc(r,n,oc(a))}),t&&(t.finalized_=!1),r}var Ue=new Wp,cc=Ue.produce;Ue.produceWithPatches.bind(Ue);Ue.setAutoFreeze.bind(Ue);Ue.setUseStrictShallowCopy.bind(Ue);Ue.applyPatches.bind(Ue);Ue.createDraft.bind(Ue);Ue.finishDraft.bind(Ue);function Kp(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Jp(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Zp(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){let r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var qs=e=>Array.isArray(e)?e:[e];function Xp(e){let t=Array.isArray(e[0])?e[0]:e;return Zp(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function ef(e,t){let r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var tf=class{constructor(e){this.value=e}deref(){return this.value}},rf=typeof WeakRef<"u"?WeakRef:tf,nf=0,Os=1;function jr(){return{s:nf,v:void 0,o:null,p:null}}function li(e,t={}){let r=jr(),{resultEqualityCheck:n}=t,a,i=0;function s(){var d;let o=r,{length:c}=arguments;for(let g=0,f=c;g<f;g++){let y=arguments[g];if(typeof y=="function"||typeof y=="object"&&y!==null){let p=o.o;p===null&&(o.o=p=new WeakMap);let v=p.get(y);v===void 0?(o=jr(),p.set(y,o)):o=v}else{let p=o.p;p===null&&(o.p=p=new Map);let v=p.get(y);v===void 0?(o=jr(),p.set(y,o)):o=v}}let l=o,u;if(o.s===Os?u=o.v:(u=e.apply(null,arguments),i++),l.s=Os,n){let g=((d=a==null?void 0:a.deref)==null?void 0:d.call(a))??a;g!=null&&n(g,u)&&(u=g,i!==0&&i--),a=typeof u=="object"&&u!==null||typeof u=="function"?new rf(u):u}return l.v=u,u}return s.clearCache=()=>{r=jr(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function lc(e,...t){let r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,o,c={},l=a.pop();typeof l=="object"&&(c=l,l=a.pop()),Kp(l,`createSelector expects an output function after the inputs, but received: [${typeof l}]`);let u={...r,...c},{memoize:d,memoizeOptions:g=[],argsMemoize:f=li,argsMemoizeOptions:y=[],devModeChecks:p={}}=u,v=qs(g),b=qs(y),A=Xp(a),j=d(function(){return i++,l.apply(null,arguments)},...v),N=f(function(){s++;let $=ef(A,arguments);return o=j.apply(null,$),o},...b);return Object.assign(N,{resultFunc:l,memoizedResultFunc:j,dependencies:A,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:d,argsMemoize:f})};return Object.assign(n,{withTypes:()=>n}),n}var le=lc(li),af=Object.assign((e,t=le)=>{Jp(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e),n=r.map(a=>e[a]);return t(n,(...a)=>a.reduce((i,s,o)=>(i[r[o]]=s,i),{}))},{withTypes:()=>af});function uc(e){return({dispatch:t,getState:r})=>n=>a=>typeof a=="function"?a(t,r,e):n(a)}var sf=uc(),of=uc,cf=(...e)=>{let t=lc(...e),r=Object.assign((...n)=>{let a=t(...n),i=(s,...o)=>a(st(s)?sc(s):s,...o);return Object.assign(i,a),i},{withTypes:()=>r});return r};cf(li);var lf=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Jr:Jr.apply(null,arguments)},uf=e=>e&&typeof e.match=="function";function S(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(ot(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>$p(n)&&n.type===e,r}var dc=class Wt extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Wt.prototype)}static get[Symbol.species](){return Wt}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Wt(...t[0].concat(this)):new Wt(...t.concat(this))}};function xs(e){return Ke(e)?cc(e,()=>{}):e}function df(e){return typeof e=="boolean"}var gf=()=>function(e){let{thunk:t=!0,immutableCheck:r=!0,serializableCheck:n=!0,actionCreatorCheck:a=!0}=e??{},i=new dc;return t&&(df(t)?i.push(sf):i.push(of(t.extraArgument))),i},pf="RTK_autoBatch",gc=e=>t=>{setTimeout(t,e)},ff=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:gc(10),hf=(e={type:"raf"})=>t=>(...r)=>{let n=t(...r),a=!0,i=!1,s=!1,o=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?ff:e.type==="callback"?e.queueNotification:gc(e.timeout),l=()=>{s=!1,i&&(i=!1,o.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){let d=()=>a&&u(),g=n.subscribe(d);return o.add(u),()=>{g(),o.delete(u)}},dispatch(u){var d;try{return a=!((d=u==null?void 0:u.meta)!=null&&d[pf]),i=!a,i&&(s||(s=!0,c(l))),n.dispatch(u)}finally{a=!0}}})},yf=e=>function(t){let{autoBatch:r=!0}=t??{},n=new dc(e);return r&&n.push(hf(typeof r=="object"?r:void 0)),n},Es=!0;function mf(e){let t=gf(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{},o;if(typeof r=="function")o=r;else if(si(r))o=ec(r);else throw new Error(ot(1));let c;typeof n=="function"?c=n(t):c=t();let l=Jr;a&&(l=lf({trace:!Es,...typeof a=="object"&&a}));let u=Vp(...c),d=yf(u),g=typeof s=="function"?s(d):d(),f=l(...g);return Xo(o,i,f)}function vf(e){let t={},r=[],n,a={addCase(i,s){let o=typeof i=="string"?i:i.type;if(!o)throw new Error(ot(28));if(o in t)throw new Error(ot(29));return t[o]=s,a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function Sf(e){return typeof e=="function"}function ne(e,t){let[r,n,a]=vf(t),i;if(Sf(e))i=()=>xs(e());else{let o=xs(e);i=()=>o}function s(o=i(),c){let l=[r[c.type],...n.filter(({matcher:u})=>u(c)).map(({reducer:u})=>u)];return l.filter(u=>!!u).length===0&&(l=[a]),l.reduce((u,d)=>{if(d)if(st(u)){let g=d(u,c);return g===void 0?u:g}else{if(Ke(u))return cc(u,g=>d(g,c));{let g=d(u,c);if(g===void 0){if(u===null)return u;throw new Error(ot(9))}return g}}return u},o)}return s.getInitialState=i,s}var wf="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",pc=(e=21)=>{let t="",r=e;for(;r--;)t+=wf[Math.random()*64|0];return t},bf=(e,t)=>uf(e)?e.match(t):e(t);function Cf(...e){return t=>e.some(r=>bf(r,t))}var If=["name","message","stack","code"],ea=class{constructor(e,t){jo(this,"_type"),this.payload=e,this.meta=t}},Rs=class{constructor(e,t){jo(this,"_type"),this.payload=e,this.meta=t}},kf=e=>{if(typeof e=="object"&&e!==null){let t={};for(let r of If)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},V=(()=>{function e(t,r,n){let a=S(t+"/fulfilled",(c,l,u,d)=>({payload:c,meta:{...d||{},arg:u,requestId:l,requestStatus:"fulfilled"}})),i=S(t+"/pending",(c,l,u)=>({payload:void 0,meta:{...u||{},arg:l,requestId:c,requestStatus:"pending"}})),s=S(t+"/rejected",(c,l,u,d,g)=>({payload:d,error:(n&&n.serializeError||kf)(c||"Rejected"),meta:{...g||{},arg:u,requestId:l,rejectedWithValue:!!d,requestStatus:"rejected",aborted:(c==null?void 0:c.name)==="AbortError",condition:(c==null?void 0:c.name)==="ConditionError"}}));function o(c){return(l,u,d)=>{let g=n!=null&&n.idGenerator?n.idGenerator(c):pc(),f=new AbortController,y,p;function v(A){p=A,f.abort()}let b=async function(){var j,N;let A;try{let $=(j=n==null?void 0:n.condition)==null?void 0:j.call(n,c,{getState:u,extra:d});if(qf($)&&($=await $),$===!1||f.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};let Y=new Promise((Q,H)=>{y=()=>{H({name:"AbortError",message:p||"Aborted"})},f.signal.addEventListener("abort",y)});l(i(g,c,(N=n==null?void 0:n.getPendingMeta)==null?void 0:N.call(n,{requestId:g,arg:c},{getState:u,extra:d}))),A=await Promise.race([Y,Promise.resolve(r(c,{dispatch:l,getState:u,extra:d,requestId:g,signal:f.signal,abort:v,rejectWithValue:(Q,H)=>new ea(Q,H),fulfillWithValue:(Q,H)=>new Rs(Q,H)})).then(Q=>{if(Q instanceof ea)throw Q;return Q instanceof Rs?a(Q.payload,g,c,Q.meta):a(Q,g,c)})])}catch($){A=$ instanceof ea?s(null,g,c,$.payload,$.meta):s($,g,c)}finally{y&&f.signal.removeEventListener("abort",y)}return n&&!n.dispatchConditionRejection&&s.match(A)&&A.meta.condition||l(A),A}();return Object.assign(b,{abort:v,requestId:g,arg:c,unwrap(){return b.then(Af)}})}}return Object.assign(o,{pending:i,rejected:s,fulfilled:a,settled:Cf(s,a),typePrefix:t})}return e.withTypes=()=>e,e})();function Af(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function qf(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var Of=(e,t)=>{if(typeof e!="function")throw new Error(ot(32))},ui="listenerMiddleware",xf=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=S(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(ot(21));return Of(i),{predicate:a,type:t,effect:i}},Ef=Object.assign(e=>{let{type:t,predicate:r,effect:n}=xf(e);return{id:pc(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(ot(22))}}},{withTypes:()=>Ef}),Rf=Object.assign(S(`${ui}/add`),{withTypes:()=>Rf});S(`${ui}/removeAll`);var Ff=Object.assign(S(`${ui}/remove`),{withTypes:()=>Ff});function ot(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}function Df({config:e,environment:t,event:r,listenerManager:n}){let{url:a,token:i,mode:s}=e;s!=="disabled"&&(n.call(r),t.send(a,i,r))}var Tf=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Mf(e){return typeof e=="string"&&Tf.test(e)}function jf(e){let t="visitorId";return{getClientId:()=>{let r=e.get(),n=r.storage,a=n.getItem(t),i=a&&Mf(a)?a:r.generateUUID();return n.setItem(t,i),i},clear:()=>{e.get().storage.removeItem(t)}}}var fc="0.7.7";function Pf(e){let{trackingId:t}=e;return{trackingId:t}}function Uf(e){return(e.source||[]).concat([`relay@${fc}`])}function hc(e,t,r,n){let{getReferrer:a,getLocation:i,getUserAgent:s}=r,o=Pf(t),c=n.getClientId();return Object.freeze({type:e,config:o,ts:Date.now(),source:Uf(t),clientId:c,userAgent:s(),referrer:a(),location:i()})}function _f(e,t,r,n,a){return{...t,meta:hc(e,r,n,a)}}var Vf="*";function $f(){let e=[];function t({type:c,callback:l}){return e.findIndex(u=>u.type===c&&u.callback===l)}function r(c,l){return c.type==="*"||l===c.type}function n(c){return t(c)<0&&e.push(c),()=>o(c.type,c.callback)}function a(c){e.forEach(l=>{if(r(l,c.meta.type))try{l.callback(c)}catch(u){console.error(u)}})}function i(c){if(c===Vf)e.length=0;else for(let l=e.length-1;l>=0;l--)e[l].type===c&&e.splice(l,1)}function s(c){let l=t(c);l>=0&&e.splice(l,1)}function o(c,l){l?s({type:c,callback:l}):i(c)}return{add:n,call:a,remove:o}}function Fs({url:e,token:t,trackingId:r,...n}){return Object.freeze({url:e,token:t,trackingId:r,...!!n.mode&&{mode:n.mode},...!!n.source&&{source:n.source}})}function Lf(e){let t=Fs(e);return{get:()=>t,update:r=>{t=Fs({...t,...r})}}}function Qf(){let e=typeof window<"u";return{sendMessage(t){e&&window.postMessage(t,"*")}}}var ta=zf();function zf(){let e="coveo_",t=r=>{let n=r.split(".").slice(-2);return n.length==2?n.join("."):""};return{getItem(r){let n=`${e}${r}=`,a=document.cookie.split(";");for(let i of a){let s=i.replace(/^\s+/,"");if(s.lastIndexOf(n,0)===0)return s.substring(n.length,s.length)}return null},setItem(r,n,a){let i=t(window.location.hostname),s=`;expires=${new Date(new Date().getTime()+a).toUTCString()}`,o=i?`;domain=${i}`:"";document.cookie=`${e}${r}=${n}${s}${o};path=/;SameSite=Lax`},removeItem(r){this.setItem(r,"",-1)}}}function Bf(){return{getItem(e){return ta.getItem(e)||localStorage.getItem(e)},removeItem(e){ta.removeItem(e),localStorage.removeItem(e)},setItem(e,t){localStorage.setItem(e,t),ta.setItem(e,t,31556952e3)}}}function Nf(){let e=document.referrer;return e===""?null:e}function Hf(){return{runtime:"browser",send:(e,t,r)=>{let n=navigator.sendBeacon(`${e}?access_token=${t}`,new Blob([JSON.stringify([r])],{type:"application/json"}));if(Qf().sendMessage({kind:"EVENT_PROTOCOL",event:r,url:e,token:t}),!n)throw new Error("Failed to send the event(s) because the payload size exceeded the maximum allowed size (32 KB). Please contact support if the problem persists.")},getReferrer:()=>Nf(),getLocation:()=>window.location.href,getUserAgent:()=>navigator.userAgent,generateUUID:()=>crypto.randomUUID(),storage:Bf()}}function Gf(){return{getItem(){return null},removeItem(){},setItem(){}}}function Yf(){return{runtime:"null",send:()=>{},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>"",storage:Gf()}}function Wf(e){return e.get().mode!=="disabled"&&Kf()?Hf():Yf()}function Kf(){try{return typeof window=="object"}catch{return!1}}function Jf(e){return{get:()=>Object.freeze(Wf(e))}}function Zf(e){let t=Lf(e),r=$f(),n=Jf(t),a=jf(n);return{emit:(i,s)=>{let o=t.get(),c=n.get(),l=_f(i,s,o,c,a);return Df({config:o,environment:c,event:l,listenerManager:r})},getMeta:i=>hc(i,t.get(),n.get(),a),on:(i,s)=>r.add({type:i,callback:s}),off:(i,s)=>r.remove(i,s),updateConfig:i=>t.update(i),version:fc,clearStorage:()=>{a.clear()}}}var di="2.63.3",Xf=["@coveo/atomic","@coveo/quantic"],yc=le(e=>e.source,e=>[`@coveo/headless@${di}`].concat(Object.entries(e).map(([t,r])=>`${t}@${r}`))),Da=le(e=>e.configuration.accessToken,e=>e.configuration.analytics,e=>yc(e.configuration.analytics),(e,{trackingId:t,nextApiBaseUrl:r,enabled:n},a)=>Zf({mode:n?"emit":"disabled",url:r,token:e,trackingId:t,source:a}));function Ye(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function w(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{l(n.next(u))}catch(d){s(d)}}function c(u){try{l(n.throw(u))}catch(d){s(d)}}function l(u){u.done?i(u.value):a(u.value).then(o,c)}l((n=n.apply(e,[])).next())})}var K;(function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect"})(K||(K={}));function Ds(){return typeof window<"u"}function gi(){return typeof navigator<"u"}function Ta(){return typeof document<"u"}function Ma(){try{return typeof localStorage<"u"}catch{return!1}}function eh(){try{return typeof sessionStorage<"u"}catch{return!1}}function mc(){return gi()&&navigator.cookieEnabled}var th=[K.click,K.custom,K.search,K.view],rh=(e,t)=>th.indexOf(e)!==-1?Object.assign({language:Ta()?document.documentElement.lang:"unknown",userAgent:gi()?navigator.userAgent:"unknown"},t):t,ra=class vc{static set(t,r,n){var a,i,s,o;n&&(i=new Date,i.setTime(i.getTime()+n)),o=window.location.hostname,o.indexOf(".")===-1?Ts(t,r,i):(s=o.split("."),a=s[s.length-2]+"."+s[s.length-1],Ts(t,r,i,a))}static get(t){for(var r=t+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){var i=n[a];if(i=i.replace(/^\s+/,""),i.lastIndexOf(r,0)===0)return i.substring(r.length,i.length)}return null}static erase(t){vc.set(t,"",-1)}};function Ts(e,t,r,n){document.cookie=`${e}=${t}`+(r?`;expires=${r.toUTCString()}`:"")+(n?`;domain=${n}`:"")+";path=/;SameSite=Lax"}function nh(){return Ma()?localStorage:mc()?new pi:eh()?sessionStorage:new Cn}var pi=class Qr{getItem(t){return ra.get(`${Qr.prefix}${t}`)}removeItem(t){ra.erase(`${Qr.prefix}${t}`)}setItem(t,r,n){ra.set(`${Qr.prefix}${t}`,r,n)}};pi.prefix="coveo_";var ah=class{constructor(){this.cookieStorage=new pi}getItem(e){return localStorage.getItem(e)||this.cookieStorage.getItem(e)}removeItem(e){this.cookieStorage.removeItem(e),localStorage.removeItem(e)}setItem(e,t){localStorage.setItem(e,t),this.cookieStorage.setItem(e,t,31556926e3)}},Cn=class{getItem(e){return null}removeItem(e){}setItem(e,t){}},Kt="__coveo.analytics.history",Sc=20,wc=1e3*60,bc=75,en=class{constructor(e){this.store=e||nh()}addElement(e){e.internalTime=new Date().getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=this.getHistoryWithInternalTime();t!=null?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}addElementAsync(e){return w(this,void 0,void 0,function*(){e.internalTime=new Date().getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=yield this.getHistoryWithInternalTimeAsync();t!=null?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])})}getHistory(){let e=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(e))}getHistoryAsync(){return w(this,void 0,void 0,function*(){let e=yield this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(e))})}getHistoryWithInternalTime(){try{let e=this.store.getItem(Kt);return e&&typeof e=="string"?JSON.parse(e):[]}catch{return[]}}getHistoryWithInternalTimeAsync(){return w(this,void 0,void 0,function*(){try{let e=yield this.store.getItem(Kt);return e?JSON.parse(e):[]}catch{return[]}})}setHistory(e){try{this.store.setItem(Kt,JSON.stringify(e.slice(0,Sc)))}catch{}}clear(){try{this.store.removeItem(Kt)}catch{}}getMostRecentElement(){let e=this.getHistoryWithInternalTime();return Array.isArray(e)?e.sort((t,r)=>(r.internalTime||0)-(t.internalTime||0))[0]:null}cropQueryElement(e){return e.name&&e.value&&e.name.toLowerCase()==="query"&&(e.value=e.value.slice(0,bc)),e}isValidEntry(e){let t=this.getMostRecentElement();return t&&t.value==e.value?(e.internalTime||0)-(t.internalTime||0)>wc:!0}stripInternalTime(e){return Array.isArray(e)?e.map(t=>{let{name:r,time:n,value:a}=t;return{name:r,time:n,value:a}}):[]}stripEmptyQuery(e){let{name:t,time:r,value:n}=e;return t&&typeof n=="string"&&t.toLowerCase()==="query"&&n.trim()===""?{name:t,time:r}:e}stripEmptyQueries(e){return e.map(t=>this.stripEmptyQuery(t))}},ih=Object.freeze({__proto__:null,HistoryStore:en,MAX_NUMBER_OF_HISTORY_ELEMENTS:Sc,MAX_VALUE_SIZE:bc,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:wc,STORE_KEY:Kt,default:en}),sh=(e,t)=>w(void 0,void 0,void 0,function*(){return e===K.view?(yield oh(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t}),oh=e=>w(void 0,void 0,void 0,function*(){let t=new en,r={name:"PageView",value:e,time:new Date().toISOString()};yield t.addElementAsync(r)}),Pr,ch=new Uint8Array(16);function lh(){if(!Pr&&(Pr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Pr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Pr(ch)}var uh=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function tn(e){return typeof e=="string"&&uh.test(e)}var me=[];for(let e=0;e<256;++e)me.push((e+256).toString(16).slice(1));function Cc(e,t=0){return(me[e[t+0]]+me[e[t+1]]+me[e[t+2]]+me[e[t+3]]+"-"+me[e[t+4]]+me[e[t+5]]+"-"+me[e[t+6]]+me[e[t+7]]+"-"+me[e[t+8]]+me[e[t+9]]+"-"+me[e[t+10]]+me[e[t+11]]+me[e[t+12]]+me[e[t+13]]+me[e[t+14]]+me[e[t+15]]).toLowerCase()}function dh(e){if(!tn(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}function gh(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var ph="6ba7b810-9dad-11d1-80b4-00c04fd430c8",fh="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function hh(e,t,r){function n(a,i,s,o){var c;if(typeof a=="string"&&(a=gh(a)),typeof i=="string"&&(i=dh(i)),((c=i)===null||c===void 0?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+a.length);if(l.set(i),l.set(a,i.length),l=r(l),l[6]=l[6]&15|t,l[8]=l[8]&63|128,s){o=o||0;for(let u=0;u<16;++u)s[o+u]=l[u];return s}return Cc(l)}try{n.name=e}catch{}return n.DNS=ph,n.URL=fh,n}var yh=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ms={randomUUID:yh};function na(e,t,r){if(Ms.randomUUID&&!t&&!e)return Ms.randomUUID();e=e||{};let n=e.random||(e.rng||lh)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Cc(n)}function mh(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function aa(e,t){return e<<t|e>>>32-t}function vh(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){let s=unescape(encodeURIComponent(e));e=[];for(let o=0;o<s.length;++o)e.push(s.charCodeAt(o))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=e.length/4+2,a=Math.ceil(n/16),i=new Array(a);for(let s=0;s<a;++s){let o=new Uint32Array(16);for(let c=0;c<16;++c)o[c]=e[s*64+c*4]<<24|e[s*64+c*4+1]<<16|e[s*64+c*4+2]<<8|e[s*64+c*4+3];i[s]=o}i[a-1][14]=(e.length-1)*8/Math.pow(2,32),i[a-1][14]=Math.floor(i[a-1][14]),i[a-1][15]=(e.length-1)*8&4294967295;for(let s=0;s<a;++s){let o=new Uint32Array(80);for(let f=0;f<16;++f)o[f]=i[s][f];for(let f=16;f<80;++f)o[f]=aa(o[f-3]^o[f-8]^o[f-14]^o[f-16],1);let c=r[0],l=r[1],u=r[2],d=r[3],g=r[4];for(let f=0;f<80;++f){let y=Math.floor(f/20),p=aa(c,5)+mh(y,l,u,d)+g+t[y]+o[f]>>>0;g=d,d=u,u=aa(l,30)>>>0,l=c,c=p}r[0]=r[0]+c>>>0,r[1]=r[1]+l>>>0,r[2]=r[2]+u>>>0,r[3]=r[3]+d>>>0,r[4]=r[4]+g>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var Sh=hh("v5",80,vh),js=Sh,Ic="2.30.2",wh={pageview:"pageview",event:"event"},rn=class ja{constructor(t,r){if(!tn(t))throw Error("Not a valid uuid");this.clientId=t,this.creationDate=Math.floor(r/1e3)}toString(){return this.clientId.replace(/-/g,"")+"."+this.creationDate.toString()}get expired(){let t=Math.floor(Date.now()/1e3)-this.creationDate;return t<0||t>ja.expirationTime}validate(t,r){return!this.expired&&this.matchReferrer(t,r)}matchReferrer(t,r){try{let n=new URL(t);return r.some(a=>new RegExp(a.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(n.host))}catch{return!1}}static fromString(t){let r=t.split(".");if(r.length!==2)return null;let[n,a]=r;if(n.length!==32||isNaN(parseInt(a)))return null;let i=n.substring(0,8)+"-"+n.substring(8,12)+"-"+n.substring(12,16)+"-"+n.substring(16,20)+"-"+n.substring(20,32);return tn(i)?new ja(i,Number.parseInt(a)*1e3):null}};rn.cvo_cid="cvo_cid";rn.expirationTime=120;var Ne=Object.keys;function Ur(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}var Ps={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},bh=Ne(Ps).map(e=>Ps[e]),Ch=[...bh].join("|"),Ih=new RegExp(`^(${Ch}$)`),kh={svcAction:"svc_action",svcActionData:"svc_action_data"},Ah=e=>Ih.test(e),qh=[Ah],Us={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},_s={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr",group:"group"},ke={action:"pa",list:"pal",listSource:"pls"},nn={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},Oh=["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit"],Pa={id:"quoteId",affiliation:"quoteAffiliation"},Ua={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},xh={add:ke,bookmark_add:ke,bookmark_remove:ke,click:ke,checkout:ke,checkout_option:ke,detail:ke,impression:ke,remove:ke,refund:Object.assign(Object.assign({},ke),nn),purchase:Object.assign(Object.assign({},ke),nn),quickview:ke,quote:Object.assign(Object.assign({},ke),Pa),review:Object.assign(Object.assign({},ke),Ua)},Eh=Ne(Us).map(e=>Us[e]),Rh=Ne(_s).map(e=>_s[e]),Fh=Ne(ke).map(e=>ke[e]),Dh=Ne(nn).map(e=>nn[e]),Th=Ne(Ua).map(e=>Ua[e]),Mh=Ne(Pa).map(e=>Pa[e]),jh=[...Eh,"custom"].join("|"),Ph=[...Rh,"custom"].join("|"),kc="(pr[0-9]+)",Ac="(il[0-9]+pi[0-9]+)",Uh=new RegExp(`^${kc}(${jh})$`),_h=new RegExp(`^(${Ac}(${Ph}))|(il[0-9]+nm)$`),Vh=new RegExp(`^(${Fh.join("|")})$`),$h=new RegExp(`^(${Dh.join("|")})$`),Lh=new RegExp(`^${kc}custom$`),Qh=new RegExp(`^${Ac}custom$`),zh=new RegExp(`^(${[...Oh,...Th,...Mh].join("|")})$`),Bh=e=>Uh.test(e),Nh=e=>_h.test(e),Hh=e=>Vh.test(e),Gh=e=>$h.test(e),Yh=e=>zh.test(e),Wh=[Nh,Bh,Hh,Gh,Yh],Kh=[Lh,Qh],Jh={anonymizeIp:"aip"},Zh={eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"},Xh={hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"},ey=["contentId","contentIdKey","contentType","searchHub","tab","searchUid","permanentId","contentLocale","trackingId"],ty=Object.assign(Object.assign(Object.assign(Object.assign({},Jh),Zh),Xh),ey.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:t}),{})),_a=Object.assign(Object.assign({},ty),kh),ry=e=>{let t=!!e.action&&xh[e.action]||{};return Ne(e).reduce((r,n)=>{let a=t[n]||_a[n]||n;return Object.assign(Object.assign({},r),{[a]:e[n]})},{})},ny=Ne(_a).map(e=>_a[e]),ay=e=>ny.indexOf(e)!==-1,iy=e=>e==="custom",sy=e=>[...Wh,...qh,ay,iy].some(t=>t(e)),oy=e=>Ne(e).reduce((t,r)=>{let n=cy(r);return n?Object.assign(Object.assign({},t),ly(n,e[r])):Object.assign(Object.assign({},t),{[r]:e[r]})},{}),cy=e=>{let t;return[...Kh].every(r=>{var n;return t=(n=r.exec(e))===null||n===void 0?void 0:n[1],!t}),t},ly=(e,t)=>Ne(t).reduce((r,n)=>Object.assign(Object.assign({},r),{[`${e}${n}`]:t[n]}),{}),uy=class{constructor(e){this.opts=e}sendEvent(e,t){return w(this,void 0,void 0,function*(){if(!this.isAvailable())throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');let{baseUrl:r,preprocessRequest:n}=this.opts,a=yield this.getQueryParamsForEventType(e),{url:i,payload:s}=yield this.preProcessRequestAsPotentialJSONString(`${r}/analytics/${e}?${a}`,t,n),o=this.encodeForEventType(e,s),c=new Blob([o],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(i,c)})}isAvailable(){return"sendBeacon"in navigator}deleteHttpCookieVisitorId(){return Promise.resolve()}preProcessRequestAsPotentialJSONString(e,t,r){return w(this,void 0,void 0,function*(){let n=e,a=t;if(r){let i=yield r({url:e,body:JSON.stringify(t)},"analyticsBeacon"),{url:s,body:o}=i;n=s||e;try{a=JSON.parse(o)}catch(c){console.error("Unable to process the request body as a JSON string",c)}}return{payload:a,url:n}})}encodeForEventType(e,t){return this.isEventTypeLegacy(e)?this.encodeEventToJson(e,t):this.encodeEventToJson(e,t,this.opts.token)}getQueryParamsForEventType(e){return w(this,void 0,void 0,function*(){let{token:t,visitorIdProvider:r}=this.opts,n=yield r.getCurrentVisitorId();return[t&&this.isEventTypeLegacy(e)?`access_token=${t}`:"",n?`visitorId=${n}`:"","discardVisitInfo=true"].filter(a=>!!a).join("&")})}isEventTypeLegacy(e){return[K.click,K.custom,K.search,K.view].indexOf(e)!==-1}encodeEventToJson(e,t,r){let n=`${e}Event=${encodeURIComponent(JSON.stringify(t))}`;return r&&(n=`access_token=${encodeURIComponent(r)}&${n}`),n}},dy=class{sendEvent(e,t){return w(this,void 0,void 0,function*(){return Promise.resolve()})}deleteHttpCookieVisitorId(){return w(this,void 0,void 0,function*(){return Promise.resolve()})}},Vs=window.fetch,qc=class{constructor(e){this.opts=e}sendEvent(e,t){return w(this,void 0,void 0,function*(){let{baseUrl:r,visitorIdProvider:n,preprocessRequest:a}=this.opts,i=this.shouldAppendVisitorId(e)?yield this.getVisitorIdParam():"",s={url:`${r}/analytics/${e}${i}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(t)},o=Object.assign(Object.assign({},s),a?yield a(s,"analyticsFetch"):{}),{url:c}=o,l=Ye(o,["url"]),u;try{u=yield Vs(c,l)}catch(d){console.error("An error has occured when sending the event.",d);return}if(u.ok){let d=yield u.json();return d.visitorId&&n.setCurrentVisitorId(d.visitorId),d}else{try{u.json()}catch{}throw console.error(`An error has occured when sending the "${e}" event.`,u,t),new Error(`An error has occurred when sending the "${e}" event. Check the console logs for more details.`)}})}deleteHttpCookieVisitorId(){return w(this,void 0,void 0,function*(){let{baseUrl:e}=this.opts,t=`${e}/analytics/visit`;yield Vs(t,{headers:this.getHeaders(),method:"DELETE"})})}shouldAppendVisitorId(e){return[K.click,K.custom,K.search,K.view].indexOf(e)!==-1}getVisitorIdParam(){return w(this,void 0,void 0,function*(){let{visitorIdProvider:e}=this.opts,t=yield e.getCurrentVisitorId();return t?`?visitor=${t}`:""})}getHeaders(){let{token:e}=this.opts;return Object.assign(Object.assign({},e?{Authorization:`Bearer ${e}`}:{}),{"Content-Type":"application/json"})}},gy=class{constructor(e,t){Ma()&&mc()?this.storage=new ah:Ma()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new Cn),this.client=new qc(e),this.beaconClient=new uy(e),window.addEventListener("beforeunload",()=>{let r=t();for(let{eventType:n,payload:a}of r)this.beaconClient.sendEvent(n,a)})}getClientDependingOnEventType(e){return e==="click"&&this.beaconClient.isAvailable()?this.beaconClient:this.client}},py=class{constructor(e,t){this.storage=t||new Cn,this.client=new qc(e)}getClientDependingOnEventType(e){return this.client}},Oc=class{constructor(){this.storage=new Cn,this.client=new dy}getClientDependingOnEventType(e){return this.client}},fy="xx",hy=e=>(e==null?void 0:e.startsWith(fy))||!1,yy=`
        We've detected you're using React Native but have not provided the corresponding runtime, 
        for an optimal experience please use the "coveo.analytics/react-native" subpackage.
        Follow the Readme on how to set it up: https://github.com/coveo/coveo.analytics.js#using-react-native
    `;function my(){return typeof navigator<"u"&&navigator.product=="ReactNative"}var vy=["1",1,"yes",!0];function an(){return gi()&&[navigator.globalPrivacyControl,navigator.doNotTrack,navigator.msDoNotTrack,window.doNotTrack].some(e=>vy.indexOf(e)!==-1)}var xc="v15",Ec={default:"https://analytics.cloud.coveo.com/rest/ua",production:"https://analytics.cloud.coveo.com/rest/ua",hipaa:"https://analyticshipaa.cloud.coveo.com/rest/ua"};function Sy(e=Ec.default,t=xc,r=!1){if(e=e.replace(/\/$/,""),r)return`${e}/${t}`;let n=e.endsWith("/rest")||e.endsWith("/rest/ua");return`${e}${n?"":"/rest"}/${t}`}var wy="38824e1f-37f5-42d3-8372-a4b8fa9df946",vt=class{get defaultOptions(){return{endpoint:Ec.default,isCustomEndpoint:!1,token:"",version:xc,beforeSendHooks:[],afterSendHooks:[]}}get version(){return Ic}constructor(e){if(this.acceptedLinkReferrers=[],!e)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[sh,rh].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};let t={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};an()?this.runtime=new Oc:this.runtime=this.options.runtimeEnvironment||this.initRuntime(t),this.addEventTypeMapping(K.view,{newEventType:K.view,addClientIdParameter:!0}),this.addEventTypeMapping(K.click,{newEventType:K.click,addClientIdParameter:!0}),this.addEventTypeMapping(K.custom,{newEventType:K.custom,addClientIdParameter:!0}),this.addEventTypeMapping(K.search,{newEventType:K.search,addClientIdParameter:!0})}initRuntime(e){return Ds()&&Ta()?new gy(e,()=>{let t=[...this.bufferedRequests];return this.bufferedRequests=[],t}):(my()&&console.warn(yy),new py(e))}get storage(){return this.runtime.storage}determineVisitorId(){return w(this,void 0,void 0,function*(){try{return Ds()&&this.extractClientIdFromLink(window.location.href)||(yield this.storage.getItem("visitorId"))||na()}catch(e){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",e),na()}})}getCurrentVisitorId(){return w(this,void 0,void 0,function*(){if(!this.visitorId){let e=yield this.determineVisitorId();yield this.setCurrentVisitorId(e)}return this.visitorId})}setCurrentVisitorId(e){return w(this,void 0,void 0,function*(){this.visitorId=e,yield this.storage.setItem("visitorId",e)})}setClientId(e,t){return w(this,void 0,void 0,function*(){if(tn(e))this.setCurrentVisitorId(e.toLowerCase());else{if(!t)throw Error("Cannot generate uuid client id without a specific namespace string.");this.setCurrentVisitorId(js(e,js(t,wy)))}})}getParameters(e,...t){return w(this,void 0,void 0,function*(){return yield this.resolveParameters(e,...t)})}getPayload(e,...t){return w(this,void 0,void 0,function*(){let r=yield this.resolveParameters(e,...t);return yield this.resolvePayloadForParameters(e,r)})}get currentVisitorId(){return typeof(this.visitorId||this.storage.getItem("visitorId"))!="string"&&this.setCurrentVisitorId(na()),this.visitorId}set currentVisitorId(e){this.visitorId=e,this.storage.setItem("visitorId",e)}extractClientIdFromLink(e){if(an())return null;try{let t=new URL(e).searchParams.get(rn.cvo_cid);if(t==null)return null;let r=rn.fromString(t);return!r||!Ta()||!r.validate(document.referrer,this.acceptedLinkReferrers)?null:r.clientId}catch{}return null}resolveParameters(e,...t){return w(this,void 0,void 0,function*(){let{variableLengthArgumentsNames:r=[],addVisitorIdParameter:n=!1,usesMeasurementProtocol:a=!1,addClientIdParameter:i=!1}=this.eventTypeMapping[e]||{};return yield[s=>r.length>0?this.parseVariableArgumentsPayload(r,s):s[0],s=>w(this,void 0,void 0,function*(){return Object.assign(Object.assign({},s),{visitorId:n?yield this.getCurrentVisitorId():""})}),s=>w(this,void 0,void 0,function*(){return i?Object.assign(Object.assign({},s),{clientId:yield this.getCurrentVisitorId()}):s}),s=>a?this.ensureAnonymousUserWhenUsingApiKey(s):s,s=>this.beforeSendHooks.reduce((o,c)=>w(this,void 0,void 0,function*(){let l=yield o;return yield c(e,l)}),s)].reduce((s,o)=>w(this,void 0,void 0,function*(){let c=yield s;return yield o(c)}),Promise.resolve(t))})}resolvePayloadForParameters(e,t){return w(this,void 0,void 0,function*(){let{usesMeasurementProtocol:r=!1}=this.eventTypeMapping[e]||{};return yield[n=>this.setTrackingIdIfTrackingIdNotPresent(n),n=>this.removeEmptyPayloadValues(n,e),n=>this.validateParams(n,e),n=>r?ry(n):n,n=>r?this.removeUnknownParameters(n):n,n=>r?this.processCustomParameters(n):this.mapCustomParametersToCustomData(n)].reduce((n,a)=>w(this,void 0,void 0,function*(){let i=yield n;return yield a(i)}),Promise.resolve(t))})}makeEvent(e,...t){return w(this,void 0,void 0,function*(){let{newEventType:r=e}=this.eventTypeMapping[e]||{},n=yield this.resolveParameters(e,...t),a=yield this.resolvePayloadForParameters(e,n);return{eventType:r,payload:a,log:i=>w(this,void 0,void 0,function*(){return this.bufferedRequests.push({eventType:r,payload:Object.assign(Object.assign({},a),i)}),yield Promise.all(this.afterSendHooks.map(s=>s(e,Object.assign(Object.assign({},n),i)))),yield this.deferExecution(),yield this.sendFromBuffer()})}})}sendEvent(e,...t){return w(this,void 0,void 0,function*(){return(yield this.makeEvent(e,...t)).log({})})}deferExecution(){return new Promise(e=>setTimeout(e,0))}sendFromBuffer(){return w(this,void 0,void 0,function*(){let e=this.bufferedRequests.shift();if(e){let{eventType:t,payload:r}=e;return this.runtime.getClientDependingOnEventType(t).sendEvent(t,r)}})}clear(){this.storage.removeItem("visitorId"),new en().clear()}deleteHttpOnlyVisitorId(){this.runtime.client.deleteHttpCookieVisitorId()}makeSearchEvent(e){return w(this,void 0,void 0,function*(){return this.makeEvent(K.search,e)})}sendSearchEvent(e){var{searchQueryUid:t}=e,r=Ye(e,["searchQueryUid"]);return w(this,void 0,void 0,function*(){return(yield this.makeSearchEvent(r)).log({searchQueryUid:t})})}makeClickEvent(e){return w(this,void 0,void 0,function*(){return this.makeEvent(K.click,e)})}sendClickEvent(e){var{searchQueryUid:t}=e,r=Ye(e,["searchQueryUid"]);return w(this,void 0,void 0,function*(){return(yield this.makeClickEvent(r)).log({searchQueryUid:t})})}makeCustomEvent(e){return w(this,void 0,void 0,function*(){return this.makeEvent(K.custom,e)})}sendCustomEvent(e){var{lastSearchQueryUid:t}=e,r=Ye(e,["lastSearchQueryUid"]);return w(this,void 0,void 0,function*(){return(yield this.makeCustomEvent(r)).log({lastSearchQueryUid:t})})}makeViewEvent(e){return w(this,void 0,void 0,function*(){return this.makeEvent(K.view,e)})}sendViewEvent(e){return w(this,void 0,void 0,function*(){return(yield this.makeViewEvent(e)).log({})})}getVisit(){return w(this,void 0,void 0,function*(){let e=yield(yield fetch(`${this.baseUrl}/analytics/visit`)).json();return this.visitorId=e.visitorId,e})}getHealth(){return w(this,void 0,void 0,function*(){return yield(yield fetch(`${this.baseUrl}/analytics/monitoring/health`)).json()})}registerBeforeSendEventHook(e){this.beforeSendHooks.push(e)}registerAfterSendEventHook(e){this.afterSendHooks.push(e)}addEventTypeMapping(e,t){this.eventTypeMapping[e]=t}setAcceptedLinkReferrers(e){if(Array.isArray(e)&&e.every(t=>typeof t=="string"))this.acceptedLinkReferrers=e;else throw Error("Parameter should be an array of domain strings")}parseVariableArgumentsPayload(e,t){let r={};for(let n=0,a=t.length;n<a;n++){let i=t[n];if(typeof i=="string")r[e[n]]=i;else if(typeof i=="object")return Object.assign(Object.assign({},r),i)}return r}isKeyAllowedEmpty(e,t){return({[K.search]:["queryText"]}[e]||[]).indexOf(t)!==-1}removeEmptyPayloadValues(e,t){let r=n=>typeof n<"u"&&n!==null&&n!=="";return Object.keys(e).filter(n=>this.isKeyAllowedEmpty(t,n)||r(e[n])).reduce((n,a)=>Object.assign(Object.assign({},n),{[a]:e[a]}),{})}removeUnknownParameters(e){return Object.keys(e).filter(t=>{if(sy(t))return!0;console.log(t,"is not processed by coveoua")}).reduce((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]}),{})}processCustomParameters(e){let{custom:t}=e,r=Ye(e,["custom"]),n={};t&&Ur(t)&&(n=this.lowercaseKeys(t));let a=oy(r);return Object.assign(Object.assign({},n),a)}mapCustomParametersToCustomData(e){let{custom:t}=e,r=Ye(e,["custom"]);if(t&&Ur(t)){let n=this.lowercaseKeys(t);return Object.assign(Object.assign({},r),{customData:Object.assign(Object.assign({},n),e.customData)})}else return e}lowercaseKeys(e){let t=Object.keys(e),r={};return t.forEach(n=>{r[n.toLowerCase()]=e[n]}),r}validateParams(e,t){let{anonymizeIp:r}=e,n=Ye(e,["anonymizeIp"]);return r!==void 0&&["0","false","undefined","null","{}","[]",""].indexOf(`${r}`.toLowerCase())==-1&&(n.anonymizeIp=1),(t==K.view||t==K.click||t==K.search||t==K.custom)&&(n.originLevel3=this.limit(n.originLevel3,128)),t==K.view&&(n.location=this.limit(n.location,128)),(t=="pageview"||t=="event")&&(n.referrer=this.limit(n.referrer,2048),n.location=this.limit(n.location,2048),n.page=this.limit(n.page,2048)),n}ensureAnonymousUserWhenUsingApiKey(e){let{userId:t}=e,r=Ye(e,["userId"]);return hy(this.options.token)&&!t?(r.userId="anonymous",r):e}setTrackingIdIfTrackingIdNotPresent(e){let{trackingId:t}=e,r=Ye(e,["trackingId"]);return t?e:(r.hasOwnProperty("custom")&&Ur(r.custom)&&(r.custom.hasOwnProperty("context_website")||r.custom.hasOwnProperty("siteName"))&&(r.trackingId=r.custom.context_website||r.custom.siteName),r.hasOwnProperty("customData")&&Ur(r.customData)&&(r.customData.hasOwnProperty("context_website")||r.customData.hasOwnProperty("siteName"))&&(r.trackingId=r.customData.context_website||r.customData.siteName),r)}limit(e,t){return typeof e!="string"?e:e.substring(0,t)}get baseUrl(){return Sy(this.options.endpoint,this.options.version,this.options.isCustomEndpoint)}},Se;(function(e){e.contextChanged="contextChanged",e.expandToFullUI="expandToFullUI",e.openUserActions="openUserActions",e.showPrecedingSessions="showPrecedingSessions",e.showFollowingSessions="showFollowingSessions",e.clickViewedDocument="clickViewedDocument",e.clickPageView="clickPageView",e.createArticle="createArticle"})(Se||(Se={}));var h;(function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.undoTriggerQuery="undoQuery",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.staticFilterClearAll="staticFilterClearAll",e.staticFilterSelect="staticFilterSelect",e.staticFilterDeselect="staticFilterDeselect",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",e.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",e.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",e.openSmartSnippetSource="openSmartSnippetSource",e.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",e.openSmartSnippetInlineLink="openSmartSnippetInlineLink",e.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",e.recentQueryClick="recentQueriesClick",e.clearRecentQueries="clearRecentQueries",e.recentResultClick="recentResultClick",e.clearRecentResults="clearRecentResults",e.noResultsBack="noResultsBack",e.showMoreFoldedResults="showMoreFoldedResults",e.showLessFoldedResults="showLessFoldedResults",e.copyToClipboard="copyToClipboard",e.caseSendEmail="Case.SendEmail",e.feedItemTextPost="FeedItem.TextPost",e.caseAttach="caseAttach",e.caseDetach="caseDetach",e.retryGeneratedAnswer="retryGeneratedAnswer",e.likeGeneratedAnswer="likeGeneratedAnswer",e.dislikeGeneratedAnswer="dislikeGeneratedAnswer",e.openGeneratedAnswerSource="openGeneratedAnswerSource",e.generatedAnswerStreamEnd="generatedAnswerStreamEnd",e.generatedAnswerSourceHover="generatedAnswerSourceHover",e.generatedAnswerCopyToClipboard="generatedAnswerCopyToClipboard",e.generatedAnswerHideAnswers="generatedAnswerHideAnswers",e.generatedAnswerShowAnswers="generatedAnswerShowAnswers",e.generatedAnswerExpand="generatedAnswerExpand",e.generatedAnswerCollapse="generatedAnswerCollapse",e.generatedAnswerFeedbackSubmit="generatedAnswerFeedbackSubmit",e.rephraseGeneratedAnswer="rephraseGeneratedAnswer"})(h||(h={}));var Va={[h.triggerNotify]:"queryPipelineTriggers",[h.triggerExecute]:"queryPipelineTriggers",[h.triggerQuery]:"queryPipelineTriggers",[h.triggerRedirect]:"queryPipelineTriggers",[h.queryError]:"errors",[h.queryErrorBack]:"errors",[h.queryErrorClear]:"errors",[h.queryErrorRetry]:"errors",[h.pagerNext]:"getMoreResults",[h.pagerPrevious]:"getMoreResults",[h.pagerNumber]:"getMoreResults",[h.pagerResize]:"getMoreResults",[h.pagerScrolling]:"getMoreResults",[h.facetSearch]:"facet",[h.facetShowLess]:"facet",[h.facetShowMore]:"facet",[h.recommendation]:"recommendation",[h.likeSmartSnippet]:"smartSnippet",[h.dislikeSmartSnippet]:"smartSnippet",[h.expandSmartSnippet]:"smartSnippet",[h.collapseSmartSnippet]:"smartSnippet",[h.openSmartSnippetFeedbackModal]:"smartSnippet",[h.closeSmartSnippetFeedbackModal]:"smartSnippet",[h.sendSmartSnippetReason]:"smartSnippet",[h.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[h.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions",[h.showMoreSmartSnippetSuggestion]:"smartSnippetSuggestions",[h.showLessSmartSnippetSuggestion]:"smartSnippetSuggestions",[h.clearRecentQueries]:"recentQueries",[h.recentResultClick]:"recentlyClickedDocuments",[h.clearRecentResults]:"recentlyClickedDocuments",[h.showLessFoldedResults]:"folding",[h.caseDetach]:"case",[h.likeGeneratedAnswer]:"generatedAnswer",[h.dislikeGeneratedAnswer]:"generatedAnswer",[h.openGeneratedAnswerSource]:"generatedAnswer",[h.generatedAnswerStreamEnd]:"generatedAnswer",[h.generatedAnswerSourceHover]:"generatedAnswer",[h.generatedAnswerCopyToClipboard]:"generatedAnswer",[h.generatedAnswerHideAnswers]:"generatedAnswer",[h.generatedAnswerShowAnswers]:"generatedAnswer",[h.generatedAnswerExpand]:"generatedAnswer",[h.generatedAnswerCollapse]:"generatedAnswer",[h.generatedAnswerFeedbackSubmit]:"generatedAnswer",[Se.expandToFullUI]:"interface",[Se.openUserActions]:"User Actions",[Se.showPrecedingSessions]:"User Actions",[Se.showFollowingSessions]:"User Actions",[Se.clickViewedDocument]:"User Actions",[Se.clickPageView]:"User Actions",[Se.createArticle]:"createArticle"},sn=class{constructor(){this.runtime=new Oc,this.currentVisitorId=""}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}makeEvent(e){return Promise.resolve({eventType:e,payload:null,log:()=>Promise.resolve()})}sendEvent(){return Promise.resolve()}makeSearchEvent(){return this.makeEvent(K.search)}sendSearchEvent(){return Promise.resolve()}makeClickEvent(){return this.makeEvent(K.click)}sendClickEvent(){return Promise.resolve()}makeCustomEvent(){return this.makeEvent(K.custom)}sendCustomEvent(){return Promise.resolve()}makeViewEvent(){return this.makeEvent(K.view)}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}get version(){return Ic}};function by(e){let t="";return e.filter(r=>{let n=r!==t;return t=r,n})}function Cy(e){return e.map(t=>t.replace(/;/g,""))}function Rc(e){let t=e.join(";");return t.length<=256?t:Rc(e.slice(1))}var $s=e=>{let t=Cy(e),r=by(t);return Rc(r)};function Ls(e){let t=typeof e.partialQueries=="string"?e.partialQueries:$s(e.partialQueries),r=typeof e.suggestions=="string"?e.suggestions:$s(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}var Fc=class{constructor(e,t){this.opts=e,this.provider=t;let r=e.enableAnalytics===!1||an();this.coveoAnalyticsClient=r?new sn:new vt(e)}disable(){this.coveoAnalyticsClient=new sn}enable(){this.coveoAnalyticsClient=new vt(this.opts)}makeInterfaceLoad(){return this.makeSearchEvent(h.interfaceLoad)}logInterfaceLoad(){return w(this,void 0,void 0,function*(){return(yield this.makeInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationInterfaceLoad(){return this.makeSearchEvent(h.recommendationInterfaceLoad)}logRecommendationInterfaceLoad(){return w(this,void 0,void 0,function*(){return(yield this.makeRecommendationInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendation(){return this.makeCustomEvent(h.recommendation)}logRecommendation(){return w(this,void 0,void 0,function*(){return(yield this.makeRecommendation()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationOpen(e,t){return this.makeClickEvent(h.recommendationOpen,e,t)}logRecommendationOpen(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeRecommendationOpen(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterClearAll(e){return this.makeSearchEvent(h.staticFilterClearAll,e)}logStaticFilterClearAll(e){return w(this,void 0,void 0,function*(){return(yield this.makeStaticFilterClearAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterSelect(e){return this.makeSearchEvent(h.staticFilterSelect,e)}logStaticFilterSelect(e){return w(this,void 0,void 0,function*(){return(yield this.makeStaticFilterSelect(e)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterDeselect(e){return this.makeSearchEvent(h.staticFilterDeselect,e)}logStaticFilterDeselect(e){return w(this,void 0,void 0,function*(){return(yield this.makeStaticFilterDeselect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFetchMoreResults(){return this.makeCustomEvent(h.pagerScrolling,{type:"getMoreResults"})}logFetchMoreResults(){return w(this,void 0,void 0,function*(){return(yield this.makeFetchMoreResults()).log({searchUID:this.provider.getSearchUID()})})}makeInterfaceChange(e){return this.makeSearchEvent(h.interfaceChange,e)}logInterfaceChange(e){return w(this,void 0,void 0,function*(){return(yield this.makeInterfaceChange(e)).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanAutomatic(){return this.makeSearchEvent(h.didyoumeanAutomatic)}logDidYouMeanAutomatic(){return w(this,void 0,void 0,function*(){return(yield this.makeDidYouMeanAutomatic()).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanClick(){return this.makeSearchEvent(h.didyoumeanClick)}logDidYouMeanClick(){return w(this,void 0,void 0,function*(){return(yield this.makeDidYouMeanClick()).log({searchUID:this.provider.getSearchUID()})})}makeResultsSort(e){return this.makeSearchEvent(h.resultsSort,e)}logResultsSort(e){return w(this,void 0,void 0,function*(){return(yield this.makeResultsSort(e)).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxSubmit(){return this.makeSearchEvent(h.searchboxSubmit)}logSearchboxSubmit(){return w(this,void 0,void 0,function*(){return(yield this.makeSearchboxSubmit()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxClear(){return this.makeSearchEvent(h.searchboxClear)}logSearchboxClear(){return w(this,void 0,void 0,function*(){return(yield this.makeSearchboxClear()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxAsYouType(){return this.makeSearchEvent(h.searchboxAsYouType)}logSearchboxAsYouType(){return w(this,void 0,void 0,function*(){return(yield this.makeSearchboxAsYouType()).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbFacet(e){return this.makeSearchEvent(h.breadcrumbFacet,e)}logBreadcrumbFacet(e){return w(this,void 0,void 0,function*(){return(yield this.makeBreadcrumbFacet(e)).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbResetAll(){return this.makeSearchEvent(h.breadcrumbResetAll)}logBreadcrumbResetAll(){return w(this,void 0,void 0,function*(){return(yield this.makeBreadcrumbResetAll()).log({searchUID:this.provider.getSearchUID()})})}makeDocumentQuickview(e,t){return this.makeClickEvent(h.documentQuickview,e,t)}logDocumentQuickview(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeDocumentQuickview(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeDocumentOpen(e,t){return this.makeClickEvent(h.documentOpen,e,t)}logDocumentOpen(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeDocumentOpen(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxAnalytics(e){return this.makeSearchEvent(h.omniboxAnalytics,Ls(e))}logOmniboxAnalytics(e){return w(this,void 0,void 0,function*(){return(yield this.makeOmniboxAnalytics(e)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxFromLink(e){return this.makeSearchEvent(h.omniboxFromLink,Ls(e))}logOmniboxFromLink(e){return w(this,void 0,void 0,function*(){return(yield this.makeOmniboxFromLink(e)).log({searchUID:this.provider.getSearchUID()})})}makeSearchFromLink(){return this.makeSearchEvent(h.searchFromLink)}logSearchFromLink(){return w(this,void 0,void 0,function*(){return(yield this.makeSearchFromLink()).log({searchUID:this.provider.getSearchUID()})})}makeTriggerNotify(e){return this.makeCustomEvent(h.triggerNotify,e)}logTriggerNotify(e){return w(this,void 0,void 0,function*(){return(yield this.makeTriggerNotify(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerExecute(e){return this.makeCustomEvent(h.triggerExecute,e)}logTriggerExecute(e){return w(this,void 0,void 0,function*(){return(yield this.makeTriggerExecute(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerQuery(){return this.makeCustomEvent(h.triggerQuery,{query:this.provider.getSearchEventRequestPayload().queryText},"queryPipelineTriggers")}logTriggerQuery(){return w(this,void 0,void 0,function*(){return(yield this.makeTriggerQuery()).log({searchUID:this.provider.getSearchUID()})})}makeUndoTriggerQuery(e){return this.makeSearchEvent(h.undoTriggerQuery,e)}logUndoTriggerQuery(e){return w(this,void 0,void 0,function*(){return(yield this.makeUndoTriggerQuery(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerRedirect(e){return this.makeCustomEvent(h.triggerRedirect,Object.assign(Object.assign({},e),{query:this.provider.getSearchEventRequestPayload().queryText}))}logTriggerRedirect(e){return w(this,void 0,void 0,function*(){return(yield this.makeTriggerRedirect(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerResize(e){return this.makeCustomEvent(h.pagerResize,e)}logPagerResize(e){return w(this,void 0,void 0,function*(){return(yield this.makePagerResize(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerNumber(e){return this.makeCustomEvent(h.pagerNumber,e)}logPagerNumber(e){return w(this,void 0,void 0,function*(){return(yield this.makePagerNumber(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerNext(e){return this.makeCustomEvent(h.pagerNext,e)}logPagerNext(e){return w(this,void 0,void 0,function*(){return(yield this.makePagerNext(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerPrevious(e){return this.makeCustomEvent(h.pagerPrevious,e)}logPagerPrevious(e){return w(this,void 0,void 0,function*(){return(yield this.makePagerPrevious(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerScrolling(){return this.makeCustomEvent(h.pagerScrolling)}logPagerScrolling(){return w(this,void 0,void 0,function*(){return(yield this.makePagerScrolling()).log({searchUID:this.provider.getSearchUID()})})}makeFacetClearAll(e){return this.makeSearchEvent(h.facetClearAll,e)}logFacetClearAll(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetClearAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSearch(e){return this.makeSearchEvent(h.facetSearch,e)}logFacetSearch(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetSearch(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelect(e){return this.makeSearchEvent(h.facetSelect,e)}logFacetSelect(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetSelect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetDeselect(e){return this.makeSearchEvent(h.facetDeselect,e)}logFacetDeselect(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetDeselect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetExclude(e){return this.makeSearchEvent(h.facetExclude,e)}logFacetExclude(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetExclude(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUnexclude(e){return this.makeSearchEvent(h.facetUnexclude,e)}logFacetUnexclude(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetUnexclude(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelectAll(e){return this.makeSearchEvent(h.facetSelectAll,e)}logFacetSelectAll(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetSelectAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUpdateSort(e){return this.makeSearchEvent(h.facetUpdateSort,e)}logFacetUpdateSort(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetUpdateSort(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowMore(e){return this.makeCustomEvent(h.facetShowMore,e)}logFacetShowMore(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetShowMore(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowLess(e){return this.makeCustomEvent(h.facetShowLess,e)}logFacetShowLess(e){return w(this,void 0,void 0,function*(){return(yield this.makeFacetShowLess(e)).log({searchUID:this.provider.getSearchUID()})})}makeQueryError(e){return this.makeCustomEvent(h.queryError,e)}logQueryError(e){return w(this,void 0,void 0,function*(){return(yield this.makeQueryError(e)).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorBack(){return w(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(h.queryErrorBack);return{description:e.description,log:()=>w(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(h.queryErrorBack)})}})}logQueryErrorBack(){return w(this,void 0,void 0,function*(){return(yield this.makeQueryErrorBack()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorRetry(){return w(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(h.queryErrorRetry);return{description:e.description,log:()=>w(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(h.queryErrorRetry)})}})}logQueryErrorRetry(){return w(this,void 0,void 0,function*(){return(yield this.makeQueryErrorRetry()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorClear(){return w(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(h.queryErrorClear);return{description:e.description,log:()=>w(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(h.queryErrorClear)})}})}logQueryErrorClear(){return w(this,void 0,void 0,function*(){return(yield this.makeQueryErrorClear()).log({searchUID:this.provider.getSearchUID()})})}makeLikeSmartSnippet(){return this.makeCustomEvent(h.likeSmartSnippet)}logLikeSmartSnippet(){return w(this,void 0,void 0,function*(){return(yield this.makeLikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeDislikeSmartSnippet(){return this.makeCustomEvent(h.dislikeSmartSnippet)}logDislikeSmartSnippet(){return w(this,void 0,void 0,function*(){return(yield this.makeDislikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippet(){return this.makeCustomEvent(h.expandSmartSnippet)}logExpandSmartSnippet(){return w(this,void 0,void 0,function*(){return(yield this.makeExpandSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippet(){return this.makeCustomEvent(h.collapseSmartSnippet)}logCollapseSmartSnippet(){return w(this,void 0,void 0,function*(){return(yield this.makeCollapseSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetFeedbackModal(){return this.makeCustomEvent(h.openSmartSnippetFeedbackModal)}logOpenSmartSnippetFeedbackModal(){return w(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeCloseSmartSnippetFeedbackModal(){return this.makeCustomEvent(h.closeSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return w(this,void 0,void 0,function*(){return(yield this.makeCloseSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeSmartSnippetFeedbackReason(e,t){return this.makeCustomEvent(h.sendSmartSnippetReason,{reason:e,details:t})}logSmartSnippetFeedbackReason(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeSmartSnippetFeedbackReason(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippetSuggestion(e){return this.makeCustomEvent(h.expandSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logExpandSmartSnippetSuggestion(e){return w(this,void 0,void 0,function*(){return(yield this.makeExpandSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippetSuggestion(e){return this.makeCustomEvent(h.collapseSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logCollapseSmartSnippetSuggestion(e){return w(this,void 0,void 0,function*(){return(yield this.makeCollapseSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreSmartSnippetSuggestion(e){return this.makeCustomEvent(h.showMoreSmartSnippetSuggestion,e)}logShowMoreSmartSnippetSuggestion(e){return w(this,void 0,void 0,function*(){return(yield this.makeShowMoreSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessSmartSnippetSuggestion(e){return this.makeCustomEvent(h.showLessSmartSnippetSuggestion,e)}logShowLessSmartSnippetSuggestion(e){return w(this,void 0,void 0,function*(){return(yield this.makeShowLessSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSource(e,t){return this.makeClickEvent(h.openSmartSnippetSource,e,t)}logOpenSmartSnippetSource(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSource(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionSource(e,t){return this.makeClickEvent(h.openSmartSnippetSuggestionSource,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}makeCopyToClipboard(e,t){return this.makeClickEvent(h.copyToClipboard,e,t)}logCopyToClipboard(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeCopyToClipboard(e,t)).log({searchUID:this.provider.getSearchUID()})})}logOpenSmartSnippetSuggestionSource(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSuggestionSource(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetInlineLink(e,t){return this.makeClickEvent(h.openSmartSnippetInlineLink,e,{contentIDKey:t.contentIDKey,contentIDValue:t.contentIDValue},t)}logOpenSmartSnippetInlineLink(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionInlineLink(e,t){return this.makeClickEvent(h.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}logOpenSmartSnippetSuggestionInlineLink(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSuggestionInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeRecentQueryClick(){return this.makeSearchEvent(h.recentQueryClick)}logRecentQueryClick(){return w(this,void 0,void 0,function*(){return(yield this.makeRecentQueryClick()).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentQueries(){return this.makeCustomEvent(h.clearRecentQueries)}logClearRecentQueries(){return w(this,void 0,void 0,function*(){return(yield this.makeClearRecentQueries()).log({searchUID:this.provider.getSearchUID()})})}makeRecentResultClick(e,t){return this.makeCustomEvent(h.recentResultClick,{info:e,identifier:t})}logRecentResultClick(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeRecentResultClick(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentResults(){return this.makeCustomEvent(h.clearRecentResults)}logClearRecentResults(){return w(this,void 0,void 0,function*(){return(yield this.makeClearRecentResults()).log({searchUID:this.provider.getSearchUID()})})}makeNoResultsBack(){return this.makeSearchEvent(h.noResultsBack)}logNoResultsBack(){return w(this,void 0,void 0,function*(){return(yield this.makeNoResultsBack()).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreFoldedResults(e,t){return this.makeClickEvent(h.showMoreFoldedResults,e,t)}logShowMoreFoldedResults(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeShowMoreFoldedResults(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessFoldedResults(){return this.makeCustomEvent(h.showLessFoldedResults)}logShowLessFoldedResults(){return w(this,void 0,void 0,function*(){return(yield this.makeShowLessFoldedResults()).log({searchUID:this.provider.getSearchUID()})})}makeEventDescription(e,t){var r;return{actionCause:t,customData:(r=e.payload)===null||r===void 0?void 0:r.customData}}makeCustomEvent(e,t,r=Va[e]){return w(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),a=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:r,eventValue:e}),i=yield this.coveoAnalyticsClient.makeCustomEvent(a);return{description:this.makeEventDescription(i,e),log:({searchUID:s})=>i.log({lastSearchQueryUid:s})}})}logCustomEvent(e,t,r=Va[e]){return w(this,void 0,void 0,function*(){return(yield this.makeCustomEvent(e,t,r)).log({searchUID:this.provider.getSearchUID()})})}makeCustomEventWithType(e,t,r){return w(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),a=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:t,eventValue:e}),i=yield this.coveoAnalyticsClient.makeCustomEvent(a);return{description:this.makeEventDescription(i,e),log:({searchUID:s})=>i.log({lastSearchQueryUid:s})}})}logCustomEventWithType(e,t,r){return w(this,void 0,void 0,function*(){return(yield this.makeCustomEventWithType(e,t,r)).log({searchUID:this.provider.getSearchUID()})})}logSearchEvent(e,t){return w(this,void 0,void 0,function*(){return(yield this.makeSearchEvent(e,t)).log({searchUID:this.provider.getSearchUID()})})}makeSearchEvent(e,t){return w(this,void 0,void 0,function*(){let r=yield this.getBaseSearchEventRequest(e,t),n=yield this.coveoAnalyticsClient.makeSearchEvent(r);return{description:this.makeEventDescription(n,e),log:({searchUID:a})=>n.log({searchQueryUid:a})}})}makeClickEvent(e,t,r,n){return w(this,void 0,void 0,function*(){let a=Object.assign(Object.assign(Object.assign({},t),yield this.getBaseEventRequest(Object.assign(Object.assign({},r),n))),{queryPipeline:this.provider.getPipeline(),actionCause:e}),i=yield this.coveoAnalyticsClient.makeClickEvent(a);return{description:this.makeEventDescription(i,e),log:({searchUID:s})=>i.log({searchQueryUid:s})}})}logClickEvent(e,t,r,n){return w(this,void 0,void 0,function*(){return(yield this.makeClickEvent(e,t,r,n)).log({searchUID:this.provider.getSearchUID()})})}getBaseSearchEventRequest(e,t){var r,n;return w(this,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},t),(n=(r=this.provider).getGeneratedAnswerMetadata)===null||n===void 0?void 0:n.call(r)))),this.provider.getSearchEventRequestPayload()),{queryPipeline:this.provider.getPipeline(),actionCause:e})})}getBaseEventRequest(e){return w(this,void 0,void 0,function*(){let t=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign(Object.assign({},this.getOrigins()),this.getSplitTestRun()),{customData:t,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})})}getOrigins(){var e,t;return{originContext:(t=(e=this.provider).getOriginContext)===null||t===void 0?void 0:t.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof vt?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getSplitTestRun(){let e=this.provider.getSplitTestRunName?this.provider.getSplitTestRunName():"",t=this.provider.getSplitTestRunVersion?this.provider.getSplitTestRunVersion():"";return Object.assign(Object.assign({},e&&{splitTestRunName:e}),t&&{splitTestRunVersion:t})}makeLikeGeneratedAnswer(e){return this.makeCustomEvent(h.likeGeneratedAnswer,e)}logLikeGeneratedAnswer(e){return w(this,void 0,void 0,function*(){return(yield this.makeLikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeDislikeGeneratedAnswer(e){return this.makeCustomEvent(h.dislikeGeneratedAnswer,e)}logDislikeGeneratedAnswer(e){return w(this,void 0,void 0,function*(){return(yield this.makeDislikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeOpenGeneratedAnswerSource(e){return this.makeCustomEvent(h.openGeneratedAnswerSource,e)}logOpenGeneratedAnswerSource(e){return w(this,void 0,void 0,function*(){return(yield this.makeOpenGeneratedAnswerSource(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerSourceHover(e){return this.makeCustomEvent(h.generatedAnswerSourceHover,e)}logGeneratedAnswerSourceHover(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerSourceHover(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCopyToClipboard(e){return this.makeCustomEvent(h.generatedAnswerCopyToClipboard,e)}logGeneratedAnswerCopyToClipboard(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerCopyToClipboard(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerHideAnswers(e){return this.makeCustomEvent(h.generatedAnswerHideAnswers,e)}logGeneratedAnswerHideAnswers(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerHideAnswers(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerShowAnswers(e){return this.makeCustomEvent(h.generatedAnswerShowAnswers,e)}logGeneratedAnswerShowAnswers(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerShowAnswers(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerExpand(e){return this.makeCustomEvent(h.generatedAnswerExpand,e)}logGeneratedAnswerExpand(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerExpand(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCollapse(e){return this.makeCustomEvent(h.generatedAnswerCollapse,e)}logGeneratedAnswerCollapse(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerCollapse(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerFeedbackSubmit(e){return this.makeCustomEvent(h.generatedAnswerFeedbackSubmit,e)}logGeneratedAnswerFeedbackSubmit(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerFeedbackSubmit(e)).log({searchUID:this.provider.getSearchUID()})})}makeRephraseGeneratedAnswer(e){return this.makeSearchEvent(h.rephraseGeneratedAnswer,e)}logRephraseGeneratedAnswer(e){return w(this,void 0,void 0,function*(){return(yield this.makeRephraseGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeRetryGeneratedAnswer(){return this.makeSearchEvent(h.retryGeneratedAnswer)}logRetryGeneratedAnswer(){return w(this,void 0,void 0,function*(){return(yield this.makeRetryGeneratedAnswer()).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerStreamEnd(e){return this.makeCustomEvent(h.generatedAnswerStreamEnd,e)}logGeneratedAnswerStreamEnd(e){return w(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerStreamEnd(e)).log({searchUID:this.provider.getSearchUID()})})}},Qs=Object.assign({},wh);Object.keys(Qs).map(e=>Qs[e]);var zs;(function(e){e.click="click",e.flowStart="flowStart"})(zs||(zs={}));var Bs;(function(e){e.enterInterface="ticket_create_start",e.fieldUpdate="ticket_field_update",e.fieldSuggestionClick="ticket_classification_click",e.suggestionClick="suggestion_click",e.suggestionRate="suggestion_rate",e.nextCaseStep="ticket_next_stage",e.caseCancelled="ticket_cancel",e.caseSolved="ticket_cancel",e.caseCreated="ticket_create"})(Bs||(Bs={}));var Ns;(function(e){e.quit="Quit",e.solved="Solved"})(Ns||(Ns={}));var Iy=e=>{let t={};return e.caseContext&&Object.keys(e.caseContext).forEach(r=>{var n;let a=(n=e.caseContext)===null||n===void 0?void 0:n[r];if(a){let i=`context_${r}`;t[i]=a}}),t},R=(e,t=!0)=>{let{caseContext:r,caseId:n,caseNumber:a}=e,i=Ye(e,["caseContext","caseId","caseNumber"]),s=Iy(e);return Object.assign(Object.assign(Object.assign({CaseId:n,CaseNumber:a},i),!!s.context_Case_Subject&&{CaseSubject:s.context_Case_Subject}),t&&s)},ky=class{constructor(e,t){this.opts=e,this.provider=t;let r=e.enableAnalytics===!1||an();this.coveoAnalyticsClient=r?new sn:new vt(e)}disable(){this.coveoAnalyticsClient=new sn}enable(){this.coveoAnalyticsClient=new vt(this.opts)}logInterfaceLoad(e){if(e){let t=R(e);return this.logSearchEvent(h.interfaceLoad,t)}return this.logSearchEvent(h.interfaceLoad)}logInterfaceChange(e){let t=R(e);return this.logSearchEvent(h.interfaceChange,t)}logStaticFilterDeselect(e){let t=R(e);return this.logSearchEvent(h.staticFilterDeselect,t)}logFetchMoreResults(e){if(e){let t=R(e);return this.logCustomEvent(h.pagerScrolling,Object.assign(Object.assign({},t),{type:"getMoreResults"}))}return this.logCustomEvent(h.pagerScrolling,{type:"getMoreResults"})}logBreadcrumbFacet(e){let t=R(e);return this.logSearchEvent(h.breadcrumbFacet,t)}logBreadcrumbResetAll(e){if(e){let t=R(e);return this.logSearchEvent(h.breadcrumbResetAll,t)}return this.logSearchEvent(h.breadcrumbResetAll)}logFacetSelect(e){let t=R(e);return this.logSearchEvent(h.facetSelect,t)}logFacetExclude(e){let t=R(e);return this.logSearchEvent(h.facetExclude,t)}logFacetDeselect(e){let t=R(e);return this.logSearchEvent(h.facetDeselect,t)}logFacetUpdateSort(e){let t=R(e);return this.logSearchEvent(h.facetUpdateSort,t)}logFacetClearAll(e){let t=R(e);return this.logSearchEvent(h.facetClearAll,t)}logFacetShowMore(e){let t=R(e,!1);return this.logCustomEvent(h.facetShowMore,t)}logFacetShowLess(e){let t=R(e,!1);return this.logCustomEvent(h.facetShowLess,t)}logQueryError(e){let t=R(e,!1);return this.logCustomEvent(h.queryError,t)}logPagerNumber(e){let t=R(e,!1);return this.logCustomEvent(h.pagerNumber,t)}logPagerNext(e){let t=R(e,!1);return this.logCustomEvent(h.pagerNext,t)}logPagerPrevious(e){let t=R(e,!1);return this.logCustomEvent(h.pagerPrevious,t)}logDidYouMeanAutomatic(e){if(e){let t=R(e);return this.logSearchEvent(h.didyoumeanAutomatic,t)}return this.logSearchEvent(h.didyoumeanAutomatic)}logDidYouMeanClick(e){if(e){let t=R(e);return this.logSearchEvent(h.didyoumeanClick,t)}return this.logSearchEvent(h.didyoumeanClick)}logResultsSort(e){let t=R(e);return this.logSearchEvent(h.resultsSort,t)}logSearchboxSubmit(e){if(e){let t=R(e);return this.logSearchEvent(h.searchboxSubmit,t)}return this.logSearchEvent(h.searchboxSubmit)}logContextChanged(e){let t=R(e);return this.logSearchEvent(Se.contextChanged,t)}logExpandToFullUI(e){let t=R(e);return this.logCustomEvent(Se.expandToFullUI,t)}logOpenUserActions(e){let t=R(e,!1);return this.logCustomEvent(Se.openUserActions,t)}logShowPrecedingSessions(e){let t=R(e,!1);return this.logCustomEvent(Se.showPrecedingSessions,t)}logShowFollowingSessions(e){let t=R(e,!1);return this.logCustomEvent(Se.showFollowingSessions,t)}logViewedDocumentClick(e,t){return this.logCustomEvent(Se.clickViewedDocument,Object.assign(Object.assign({},R(t,!1)),{document:e}))}logPageViewClick(e,t){return this.logCustomEvent(Se.clickPageView,Object.assign(Object.assign({},R(t,!1)),{pageView:e}))}logCreateArticle(e,t){return this.logCustomEvent(Se.createArticle,t?Object.assign(Object.assign({},R(t,!1)),e):e)}logDocumentOpen(e,t,r){return this.logClickEvent(h.documentOpen,e,t,r?R(r,!1):void 0)}logCopyToClipboard(e,t,r){return this.logClickEvent(h.copyToClipboard,e,t,r?R(r,!1):void 0)}logCaseSendEmail(e,t,r){return this.logClickEvent(h.caseSendEmail,e,t,r?R(r,!1):void 0)}logFeedItemTextPost(e,t,r){return this.logClickEvent(h.feedItemTextPost,e,t,r?R(r,!1):void 0)}logDocumentQuickview(e,t,r){let n={documentTitle:e.documentTitle,documentURL:e.documentUrl};return this.logClickEvent(h.documentQuickview,e,t,r?Object.assign(Object.assign({},R(r,!1)),n):n)}logCaseAttach(e,t,r){let n={documentTitle:e.documentTitle,documentURL:e.documentUrl,resultUriHash:e.documentUriHash};return this.logClickEvent(h.caseAttach,e,t,r?Object.assign(Object.assign({},R(r,!1)),n):n)}logCaseDetach(e,t){return this.logCustomEvent(h.caseDetach,t?Object.assign(Object.assign({},R(t,!1)),{resultUriHash:e}):{resultUriHash:e})}logLikeSmartSnippet(e){return this.logCustomEvent(h.likeSmartSnippet,e?R(e,!1):void 0)}logDislikeSmartSnippet(e){return this.logCustomEvent(h.dislikeSmartSnippet,e?R(e,!1):void 0)}logExpandSmartSnippet(e){return this.logCustomEvent(h.expandSmartSnippet,e?R(e,!1):void 0)}logCollapseSmartSnippet(e){return this.logCustomEvent(h.collapseSmartSnippet,e?R(e,!1):void 0)}logOpenSmartSnippetFeedbackModal(e){return this.logCustomEvent(h.openSmartSnippetFeedbackModal,e?R(e,!1):void 0)}logCloseSmartSnippetFeedbackModal(e){return this.logCustomEvent(h.closeSmartSnippetFeedbackModal,e?R(e,!1):void 0)}logSmartSnippetFeedbackReason(e,t,r){return this.logCustomEvent(h.sendSmartSnippetReason,r?Object.assign(Object.assign({},R(r,!1)),{reason:e,details:t}):{reason:e,details:t})}logExpandSmartSnippetSuggestion(e,t){let r="documentId"in e?e:{documentId:e};return this.logCustomEvent(h.expandSmartSnippetSuggestion,t?Object.assign(Object.assign({},R(t,!1)),r):r)}logCollapseSmartSnippetSuggestion(e,t){let r="documentId"in e?e:{documentId:e};return this.logCustomEvent(h.collapseSmartSnippetSuggestion,t?Object.assign(Object.assign({},R(t,!1)),r):r)}logOpenSmartSnippetSource(e,t,r){return this.logClickEvent(h.openSmartSnippetSource,e,t,r?R(r,!1):void 0)}logOpenSmartSnippetSuggestionSource(e,t,r){return this.logClickEvent(h.openSmartSnippetSuggestionSource,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},r?Object.assign(Object.assign({},R(r,!1)),t):t)}logOpenSmartSnippetInlineLink(e,t,r){return this.logClickEvent(h.openSmartSnippetInlineLink,e,{contentIDKey:t.contentIDKey,contentIDValue:t.contentIDValue},r?Object.assign(Object.assign({},R(r,!1)),t):t)}logOpenSmartSnippetSuggestionInlineLink(e,t,r){return this.logClickEvent(h.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},r?Object.assign(Object.assign({},R(r,!1)),t):t)}logLikeGeneratedAnswer(e,t){return this.logCustomEvent(h.likeGeneratedAnswer,t?Object.assign(Object.assign({},R(t,!1)),e):e)}logDislikeGeneratedAnswer(e,t){return this.logCustomEvent(h.dislikeGeneratedAnswer,t?Object.assign(Object.assign({},R(t,!1)),e):e)}logOpenGeneratedAnswerSource(e,t){return this.logCustomEvent(h.openGeneratedAnswerSource,t?Object.assign(Object.assign({},R(t,!1)),e):e)}logGeneratedAnswerSourceHover(e,t){return this.logCustomEvent(h.generatedAnswerSourceHover,t?Object.assign(Object.assign({},R(t,!1)),e):e)}logGeneratedAnswerCopyToClipboard(e,t){return this.logCustomEvent(h.generatedAnswerCopyToClipboard,t?Object.assign(Object.assign({},R(t,!1)),e):e)}logGeneratedAnswerHideAnswers(e,t){return this.logCustomEvent(h.generatedAnswerHideAnswers,t?Object.assign(Object.assign({},R(t,!1)),e):e)}logGeneratedAnswerShowAnswers(e,t){return this.logCustomEvent(h.generatedAnswerShowAnswers,t?Object.assign(Object.assign({},R(t,!1)),e):e)}logGeneratedAnswerExpand(e,t){return this.logCustomEvent(h.generatedAnswerExpand,t?Object.assign(Object.assign({},R(t,!1)),e):e)}logGeneratedAnswerCollapse(e,t){return this.logCustomEvent(h.generatedAnswerCollapse,t?Object.assign(Object.assign({},R(t,!1)),e):e)}logGeneratedAnswerFeedbackSubmit(e,t){return this.logCustomEvent(h.generatedAnswerFeedbackSubmit,t?Object.assign(Object.assign({},R(t,!1)),e):e)}logRephraseGeneratedAnswer(e,t){return this.logSearchEvent(h.rephraseGeneratedAnswer,t?Object.assign(Object.assign({},R(t,!1)),e):e)}logRetryGeneratedAnswer(e){return this.logSearchEvent(h.retryGeneratedAnswer,e?Object.assign({},R(e,!1)):{})}logGeneratedAnswerStreamEnd(e,t){return this.logCustomEvent(h.generatedAnswerStreamEnd,t?Object.assign(Object.assign({},R(t,!1)),e):e)}logCustomEvent(e,t){return w(this,void 0,void 0,function*(){let r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),n=Object.assign(Object.assign({},yield this.getBaseCustomEventRequest(r)),{eventType:Va[e],eventValue:e});return this.coveoAnalyticsClient.sendCustomEvent(n)})}logSearchEvent(e,t){return w(this,void 0,void 0,function*(){return this.coveoAnalyticsClient.sendSearchEvent(yield this.getBaseSearchEventRequest(e,t))})}logClickEvent(e,t,r,n){return w(this,void 0,void 0,function*(){let a=Object.assign(Object.assign(Object.assign({},t),yield this.getBaseEventRequest(Object.assign(Object.assign({},r),n))),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e});return this.coveoAnalyticsClient.sendClickEvent(a)})}logShowMoreFoldedResults(e,t,r){return w(this,void 0,void 0,function*(){return this.logClickEvent(h.showMoreFoldedResults,e,t,r?R(r,!1):void 0)})}logShowLessFoldedResults(e){return w(this,void 0,void 0,function*(){return this.logCustomEvent(h.showLessFoldedResults,e?R(e,!1):void 0)})}getBaseCustomEventRequest(e){return w(this,void 0,void 0,function*(){return Object.assign(Object.assign({},yield this.getBaseEventRequest(e)),{lastSearchQueryUid:this.provider.getSearchUID()})})}getBaseSearchEventRequest(e,t){var r,n;return w(this,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},t),(n=(r=this.provider).getGeneratedAnswerMetadata)===null||n===void 0?void 0:n.call(r)))),this.provider.getSearchEventRequestPayload()),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e})})}getBaseEventRequest(e){return w(this,void 0,void 0,function*(){let t=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign({},this.getOrigins()),{customData:t,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})})}getOrigins(){var e,t;return{originContext:(t=(e=this.provider).getOriginContext)===null||t===void 0?void 0:t.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof vt?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}},fi=()=>"default",Je=e=>new vt(e).getCurrentVisitorId(),pt=new ih.HistoryStore,hi=(e,t)=>typeof t=="function"?(...r)=>{let n=ni(r[0]);try{return t.apply(t,r)}catch(a){return e.error(a,"Error in analytics preprocessRequest. Returning original request."),n}}:void 0,yi=(e,t)=>(...r)=>{let n=ni(r[1]);try{return t.apply(t,r)}catch(a){return e.error(a,"Error in analytics hook. Returning original request."),n}},Ay=()=>({url:"",clientId:"",additionalFields:[],advancedParameters:{debug:!1},products:[],facets:{results:[]},error:null,isLoading:!1,responseId:""}),qy=e=>{let t=e.configuration.search.locale.split("-")[0];return!t||t.length!==2?"en":t},mi=class{constructor(e){this.getState=e,this.state=e()}getLanguage(){return qy(this.state)}getBaseMetadata(){let{context:e,configuration:t}=this.state,r=(e==null?void 0:e.contextValues)||{},n={};for(let[a,i]of Object.entries(r)){let s=`context_${a}`;n[s]=i}return t.analytics.analyticsMode==="legacy"&&(n.coveoHeadlessVersion=di),n}getOriginContext(){return this.state.configuration.analytics.originContext}getOriginLevel1(){return this.state.searchHub||fi()}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3}getIsAnonymous(){return this.state.configuration.analytics.anonymous}};function Dc(){return{desiredCount:5,numberOfValues:8,set:{}}}var cr=(e,t)=>{let r=n=>n.facetId===t;if("productListing"in e&&e.productListing&&"facets"in e.productListing&&"results"in e.productListing.facets)return e.productListing.facets.results.find(r);if("search"in e&&e.search)return e.search.response.facets.find(r)},Oy=(e,t)=>{var r;return(r=e.facetSet[t])==null?void 0:r.request};function xy(e,t){return!!t&&t.facetId in e.facetSet}var Tc=(e,t)=>{let r=cr(e,t);if(xy(e,r))return r},Ey=(e,t)=>{let r=Tc(e,t);return r?r.values.filter(n=>n.state!=="idle"):[]},In=e=>"productListing"in e?e.productListing.isLoading:e.search.isLoading;function on(e){let{activeValue:t,ancestryMap:r}=Ry(e);return t?Fy(t,r):[]}function Ry(e){let t=[...e],r=new Map;for(;t.length>0;){let n=t.shift();if(n.state==="selected")return{activeValue:n,ancestryMap:r};if(r)for(let a of n.children)r.set(a,n);t.unshift(...n.children)}return{}}function Fy(e,t){let r=[];if(!e)return[];let n=e;do r.unshift(n),n=t.get(n);while(n);return r}function Dy(e,t){return!!t&&t.facetId in e.categoryFacetSet}var Ty=(e,t)=>{let r=cr(e,t);if(Dy(e,r))return r},My=(e,t)=>{var r;return(r=e.categoryFacetSet[t])==null?void 0:r.request},jy=(e,t)=>{let r=Ty(e,t);return on((r==null?void 0:r.values)??[])},Mc=(e,t)=>{let r=My(e,t);return on((r==null?void 0:r.currentValues)??[])};function vi(){return{}}function Py(e){return{request:e}}function Si(){return{}}function Uy(e){return{request:e}}function wi(){return{}}function _y(e){return{request:e,hasBreadcrumbs:!0}}function bi(){return{}}var lr=(e,t)=>{let r=Uc(t,e),n=r?r.field:"",a=Ii(n,e);return{facetId:e,facetField:n,facetTitle:a}};function Ci(e,t){let{facetId:r,facetValue:n}=e,a=lr(r,t),i=_c(t,r);return{...a,facetValue:i==="hierarchical"?Pc(t,r):n}}function Ze(e){return{facetSet:e.facetSet??bi(),categoryFacetSet:e.categoryFacetSet??vi(),dateFacetSet:e.dateFacetSet??Si(),numericFacetSet:e.numericFacetSet??wi(),automaticFacetSet:e.automaticFacetSet??Dc()}}var jc=e=>{let t=[];return Ly(e).forEach((r,n)=>{let a=_c(e,r.facetId),i=Hy(r,n+1);if($y(r)){if(!Mc(e,r.facetId).length)return;t.push({...i,...By(e,r.facetId),facetType:a,state:"selected"});return}r.currentValues.forEach((s,o)=>{if(s.state==="idle")return;let c=Hs(s,o+1,a),l=Vy(r)?Gs(s):zy(s);t.push({...i,...c,...l})})}),Qy(e).forEach((r,n)=>{let a=Ny(r,n+1);r.values.forEach((i,s)=>{if(i.state==="idle")return;let o=Hs(i,s+1,"specific"),c=Gs(i);t.push({...a,...o,...c})})}),t},Vy=e=>e.type==="specific",$y=e=>e.type==="hierarchical",Ly=e=>[...Object.values(e.facetSet),...Object.values(e.categoryFacetSet),...Object.values(e.dateFacetSet),...Object.values(e.numericFacetSet)].map(t=>t.request),Qy=e=>[...Object.values(e.automaticFacetSet.set)].map(t=>t.response),Hs=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),zy=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),Gs=e=>({displayValue:e.value,value:e.value}),Pc=(e,t)=>Mc(e,t).map(r=>r.value).join(";"),By=(e,t)=>{let r=Pc(e,t);return{value:r,valuePosition:1,displayValue:r}},Ny=(e,t)=>({title:Ii(e.field,e.field),field:e.field,id:e.field,facetPosition:t}),Hy=(e,t)=>({title:Ii(e.field,e.facetId),field:e.field,id:e.facetId,facetPosition:t}),Ii=(e,t)=>`${e}_${t}`,Uc=(e,t)=>{var r,n,a,i,s;return((r=e.facetSet[t])==null?void 0:r.request)||((n=e.categoryFacetSet[t])==null?void 0:n.request)||((a=e.dateFacetSet[t])==null?void 0:a.request)||((i=e.numericFacetSet[t])==null?void 0:i.request)||((s=e.automaticFacetSet.set[t])==null?void 0:s.response)},_c=(e,t)=>{let r=Uc(e,t);return r?r.type:"specific"},Xe=()=>({q:"",enableQuerySyntax:!1}),Vc=class extends mi{getSearchUID(){var t,r;let e=this.getState();return((t=e.search)==null?void 0:t.searchResponseId)||((r=e.search)==null?void 0:r.response.searchUid)||$e().response.searchUid}getPipeline(){var e;return this.state.pipeline||((e=this.state.search)==null?void 0:e.response.pipeline)||"default"}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getFacetState(){return jc(Ze(this.state))}getBaseMetadata(){var n,a,i;let e=this.getState(),t=super.getBaseMetadata(),r=(i=(a=(n=e.search)==null?void 0:n.response)==null?void 0:a.extendedResults)==null?void 0:i.generativeQuestionAnsweringId;return r&&(t.generativeQuestionAnsweringId=r),t}getGeneratedAnswerMetadata(){var t;let e=this.getState();return{...((t=e.generatedAnswer)==null?void 0:t.isVisible)!==void 0&&{showGeneratedAnswer:e.generatedAnswer.isVisible}}}get queryText(){var e;return((e=this.state.query)==null?void 0:e.q)||Xe().q}get responseTime(){var e;return((e=this.state.search)==null?void 0:e.duration)||$e().duration}mapResultsToAnalyticsDocument(){var e;return(e=this.state.search)==null?void 0:e.response.results.map(t=>({documentUri:t.uri,documentUriHash:t.raw.urihash}))}get numberOfResults(){var e;return((e=this.state.search)==null?void 0:e.response.results.length)||$e().response.results.length}},Gy=({logger:e,getState:t,analyticsClientMiddleware:r=(i,s)=>s,preprocessRequest:n,provider:a=new Vc(t)})=>{let i=t(),s=i.configuration.accessToken,o=i.configuration.analytics.apiBaseUrl,c=i.configuration.analytics.runtimeEnvironment,l=i.configuration.analytics.enabled,u=new ky({enableAnalytics:l,token:s,endpoint:o,runtimeEnvironment:c,preprocessRequest:hi(e,n),beforeSendHooks:[yi(e,r),(d,g)=>(e.info({...g,type:d,endpoint:o,token:s},"Analytics request"),g)]},a);return l||u.disable(),u},ki=class extends mi{constructor(){super(...arguments),this.initialState=Ay()}getPipeline(){return""}getSearchEventRequestPayload(){return{queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){var e;return((e=this.getState().productListing)==null?void 0:e.responseId)||this.initialState.responseId}mapResultsToAnalyticsDocument(){var e;return(e=this.state.productListing)==null?void 0:e.products.map(t=>({documentUri:t.documentUri,documentUriHash:t.documentUriHash,permanentid:t.permanentid}))}get numberOfResults(){return this.state.productListing.products.length}},Yy=({logger:e,getState:t,analyticsClientMiddleware:r=(i,s)=>s,preprocessRequest:n,provider:a=new ki(t)})=>{let i=t(),s=i.configuration.accessToken,o=i.configuration.analytics.apiBaseUrl,c=i.configuration.analytics.runtimeEnvironment,l=i.configuration.analytics.enabled,u=new Fc({token:s,endpoint:o,runtimeEnvironment:c,preprocessRequest:hi(e,n),beforeSendHooks:[yi(e,r),(d,g)=>(e.info({...g,type:d,endpoint:o,token:s},"Analytics request"),g)]},a);return l||u.disable(),u},$c=(e=>(e.Ascending="ascending",e.Descending="descending",e))($c||{}),Ai=(e=>(e.Relevancy="relevancy",e.QRE="qre",e.Date="date",e.Field="field",e.NoSort="nosort",e))(Ai||{}),cn=e=>{if($o(e))return e.map(t=>cn(t)).join(",");switch(e.by){case"relevancy":case"qre":case"nosort":return e.by;case"date":return`date ${e.order}`;case"field":return`@${e.field} ${e.order}`;default:return""}},Wy=()=>({by:"relevancy"});new T({values:{by:new St({enum:Ai,required:!0}),order:new St({enum:$c}),field:new x}});function qi(){return cn(Wy())}var Lc=class $a extends mi{constructor(){super(...arguments),this.getFacetRequest=t=>{var r,n,a,i,s,o,c,l,u,d;return((n=(r=this.state.facetSet)==null?void 0:r[t])==null?void 0:n.request)||((i=(a=this.state.categoryFacetSet)==null?void 0:a[t])==null?void 0:i.request)||((o=(s=this.state.dateFacetSet)==null?void 0:s[t])==null?void 0:o.request)||((l=(c=this.state.numericFacetSet)==null?void 0:c[t])==null?void 0:l.request)||((d=(u=this.state.automaticFacetSet)==null?void 0:u.set[t])==null?void 0:d.response)}}getFacetState(){return jc(Ze(this.getState()))}getPipeline(){var t;return this.state.pipeline||((t=this.state.search)==null?void 0:t.response.pipeline)||$a.fallbackPipelineName}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.resultURIs,numberOfResults:this.numberOfResults}}getSearchUID(){var r,n;let t=this.getState();return((r=t.search)==null?void 0:r.searchResponseId)||((n=t.search)==null?void 0:n.response.searchUid)||$e().response.searchUid}getSplitTestRunName(){var t;return(t=this.state.search)==null?void 0:t.response.splitTestRun}getSplitTestRunVersion(){var n;let t=!!this.getSplitTestRunName(),r=((n=this.state.search)==null?void 0:n.response.pipeline)||this.state.pipeline||$a.fallbackPipelineName;return t?r:void 0}getBaseMetadata(){var a,i,s;let t=this.getState(),r=super.getBaseMetadata(),n=(s=(i=(a=t.search)==null?void 0:a.response)==null?void 0:i.extendedResults)==null?void 0:s.generativeQuestionAnsweringId;return n&&(r.generativeQuestionAnsweringId=n),r}getFacetMetadata(t,r){var a;let n=((a=this.getFacetRequest(t))==null?void 0:a.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:n,facetValue:r,facetTitle:`${n}_${t}`}}getFacetClearAllMetadata(t){var n;let r=((n=this.getFacetRequest(t))==null?void 0:n.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:r,facetTitle:`${r}_${t}`}}getFacetUpdateSortMetadata(t,r){var a;let n=((a=this.getFacetRequest(t))==null?void 0:a.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:n,criteria:r,facetTitle:`${n}_${t}`}}getRangeBreadcrumbFacetMetadata(t,r){var a;let n=((a=this.getFacetRequest(t))==null?void 0:a.field)??"";return{...this.getBaseMetadata(),facetId:t,facetField:n,facetRangeEnd:r.end,facetRangeEndInclusive:r.endInclusive,facetRangeStart:r.start,facetTitle:`${n}_${t}`}}getResultSortMetadata(){return{...this.getBaseMetadata(),resultsSortBy:this.state.sortCriteria??qi()}}getStaticFilterToggleMetadata(t,r){return{...this.getBaseMetadata(),staticFilterId:t,staticFilterValue:r}}getStaticFilterClearAllMetadata(t){return{...this.getBaseMetadata(),staticFilterId:t}}getUndoTriggerQueryMetadata(t){return{...this.getBaseMetadata(),undoneQuery:t}}getCategoryBreadcrumbFacetMetadata(t,r){var a;let n=((a=this.getFacetRequest(t))==null?void 0:a.field)??"";return{...this.getBaseMetadata(),categoryFacetId:t,categoryFacetField:n,categoryFacetPath:r,categoryFacetTitle:`${n}_${t}`}}getOmniboxAnalyticsMetadata(t,r){let n=this.state.querySuggest&&this.state.querySuggest[t],a=n.completions.map(c=>c.expression),i=n.partialQueries.length-1,s=n.partialQueries[i]||"",o=n.responseId;return{...this.getBaseMetadata(),suggestionRanking:a.indexOf(r),partialQuery:s,partialQueries:n.partialQueries.length>0?n.partialQueries:"",suggestions:a.length>0?a:"",querySuggestResponseId:o}}getInterfaceChangeMetadata(){return{...this.getBaseMetadata(),interfaceChangeTo:this.state.configuration.analytics.originLevel2}}getOmniboxFromLinkMetadata(t){return{...this.getBaseMetadata(),...t}}getGeneratedAnswerMetadata(){var n;let t=this.getState(),r={};return((n=t.generatedAnswer)==null?void 0:n.isVisible)!==void 0&&(r.showGeneratedAnswer=t.generatedAnswer.isVisible),r}get resultURIs(){var t;return(t=this.results)==null?void 0:t.map(r=>({documentUri:r.uri,documentUriHash:r.raw.urihash}))}get results(){var t;return(t=this.state.search)==null?void 0:t.response.results}get queryText(){var t;return((t=this.state.query)==null?void 0:t.q)||Xe().q}get responseTime(){var t;return((t=this.state.search)==null?void 0:t.duration)||$e().duration}get numberOfResults(){var t;return((t=this.state.search)==null?void 0:t.response.totalCountFiltered)||$e().response.totalCountFiltered}};Lc.fallbackPipelineName="default";var kn=Lc,Ky=({logger:e,getState:t,analyticsClientMiddleware:r=(i,s)=>s,preprocessRequest:n,provider:a=new kn(t)})=>{let i=t(),s=i.configuration.accessToken,o=i.configuration.analytics.apiBaseUrl,c=i.configuration.analytics.runtimeEnvironment,l=i.configuration.analytics.enabled,u=new Fc({token:s,endpoint:o,runtimeEnvironment:c,preprocessRequest:hi(e,n),beforeSendHooks:[yi(e,r),(d,g)=>(e.info({...g,type:d,endpoint:o,token:s},"Analytics request"),g)]},a);return l||u.disable(),u},Ys=()=>{let e=pt.getHistory().reverse().find(t=>t.name==="PageView"&&t.value);return e?e.value:""};function Qc(e){let t=zc(e),r=[e,...t].filter(n=>n.parentResult).map(n=>n.parentResult);return zg([e,...t,...r],n=>n.uniqueId)}function zc(e){return e.childResults?e.childResults.flatMap(t=>[t,...zc(t)]):[]}var Bc=()=>"";function Jy(e,t){return{...new kn(t).getBaseMetadata(),actionCause:e,type:e}}function Zy(e){return Object.assign(e,{instantlyCallable:!0})}function Xy(e,t){let r=a=>Zy(V(e,a)),n=r(async(a,{getState:i,extra:s})=>{let{analyticsClientMiddleware:o,preprocessRequest:c,logger:l}=s;return await(await t({getState:i,analyticsClientMiddleware:o,preprocessRequest:c,logger:l})).log({state:i(),extra:s})});return Object.assign(n,{prepare:async({getState:a,analyticsClientMiddleware:i,preprocessRequest:s,logger:o})=>{let{description:c,log:l}=await t({getState:a,analyticsClientMiddleware:i,preprocessRequest:s,logger:o});return{description:c,action:r(async(u,{getState:d,extra:g})=>await l({state:d(),extra:g}))}}}),n}var Oi=(e,t,r)=>{function n(...a){let i=a.length===1?{...a[0],__legacy__getBuilder:t(a[0].__legacy__getBuilder),analyticsConfigurator:e,providerClass:r}:{prefix:a[0],__legacy__getBuilder:t(a[1]),__legacy__provider:a[2],analyticsConfigurator:e,providerClass:r};return rm(i)}return n},em=e=>e.configuration.analytics.analyticsMode==="legacy",tm=e=>e.configuration.analytics.analyticsMode==="next",rm=({prefix:e,__legacy__getBuilder:t,__legacy__provider:r,analyticsPayloadBuilder:n,analyticsType:a,analyticsConfigurator:i,providerClass:s})=>(r??(r=o=>new s(o)),Xy(e,async({getState:o,analyticsClientMiddleware:c,preprocessRequest:l,logger:u})=>{let d=[],g={log:async({state:b})=>{for(let A of d)await A(b)}},f=o(),y=i({getState:o,logger:u,analyticsClientMiddleware:c,preprocessRequest:l,provider:r(o)}),p=await t(y,o());g.description=p==null?void 0:p.description,d.push(async b=>{em(b)&&await nm(p,r,b,u,y.coveoAnalyticsClient)});let{emit:v}=Da(f);return d.push(async b=>{if(tm(b)&&a&&n){let A=n(b);await gm(v,a,A)}}),g}));async function nm(e,t,r,n,a){t(()=>r);let i=await(e==null?void 0:e.log({searchUID:t(()=>r).getSearchUID()}));n.info({client:a,response:i},"Analytics response")}var am=e=>t=>(r,n)=>Promise.resolve({description:{actionCause:e},log:async a=>{t(r,n)}}),et=Oi(Ky,e=>e,kn),_=e=>Oi(Gy,am(e),Vc),im=Oi(Yy,e=>e,ki),ct=(e,t)=>{var i;let r=s=>{var o;return s+(((o=t.pagination)==null?void 0:o.firstResult)??0)},n=-1,a=(i=t.search)==null?void 0:i.results;return n=Hc(e,a),n<0&&(n=dm(e,a)),n<0&&(n=0),sm(e,r(n),t)};function sm(e,t,r){let n=e.raw.collection;return{collectionName:typeof n=="string"?n:"default",documentAuthor:lm(e),documentPosition:t+1,documentTitle:e.title,documentUri:e.uri,documentUriHash:e.raw.urihash,documentUrl:e.clickUri,rankingModifier:e.rankingModifier||"",sourceName:um(e),queryPipeline:r.pipeline||Bc()}}var bt=e=>(e.raw.permanentid||console.warn("Missing field permanentid on result. This might cause many issues with your Coveo deployment. See https://docs.coveo.com/en/1913 and https://docs.coveo.com/en/1640 for more information.",e),{contentIDKey:"permanentid",contentIDValue:e.raw.permanentid||""}),Nc={urihash:new x,sourcetype:new x,permanentid:new x},xi={uniqueId:D,raw:new T({values:Nc}),title:D,uri:D,clickUri:D,rankingModifier:new x({required:!1,emptyAllowed:!0})};function om(e){return Object.assign({},...Object.keys(Nc).map(t=>({[t]:e[t]})))}function cm(e){return Object.assign({},...Object.keys(xi).map(t=>({[t]:e[t]})),{raw:om(e.raw)})}function lm(e){let t=e.raw.author;return z(t)?"unknown":Array.isArray(t)?t.join(";"):`${t}`}function um(e){let t=e.raw.source;return z(t)?"unknown":t}var Ei=e=>new ye(xi).validate(cm(e));function dm(e,t){for(let[r,n]of t.entries()){let a=Qc(n);if(Hc(e,a)!==-1)return r}return-1}function Hc(e,t=[]){return t.findIndex(({uniqueId:r})=>r===e.uniqueId)}async function gm(e,t,r){await e(t,r)}var pm=(e,t)=>{let r=bt(e),n=ct(e,t);return{uniqueFieldName:r.contentIDKey,uniqueFieldValue:r.contentIDValue,title:n.documentTitle,author:n.documentAuthor,url:n.documentUri}},fm=()=>({actionCause:"interfaceLoad"}),hm=()=>({actionCause:"interfaceChange"}),Gc=S("insightConfiguration/set",e=>I(e,{insightId:D})),ym=()=>({insightId:""}),mm=ne(ym(),e=>{e.addCase(Gc,(t,r)=>{t.insightId=r.payload.insightId})}),Yc=S("searchHub/set",e=>I(e,new x({required:!0,emptyAllowed:!0}))),ia=V("insight/interface/fetch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:{apiClient:a}})=>{let i=t(),s=await a.getInterface(vm(i));return pe(s)?n(s.error):(r(Yc(s.success.searchHub)),{response:s.success})}),vm=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.platformUrl,insightId:e.insightConfiguration.insightId}),Sm=()=>({loading:!1,config:void 0}),wm=ne(Sm(),e=>{e.addCase(ia.pending,t=>{t.loading=!0,t.error=void 0}).addCase(ia.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(ia.fulfilled,(t,r)=>{t.loading=!1,t.error=void 0;let{searchHub:n,...a}=r.payload.response;t.config=a})}),zr=Qe(ei()),bm=Qe(Og()),La=Qe(ei()),Cm=Qe(xg());La.default.extend(Cm.default);var Wc="YYYY/MM/DD@HH:mm:ss",Im="1401-01-01";function ln(e,t){let r=(0,La.default)(e,t);return!r.isValid()&&!t?(0,La.default)(e,Wc):r}function Kc(e){return e.format(Wc)}function km(e,t){let r=ln(e,t);if(!r.isValid()){let n=". Please provide a date format string in the configuration options. See https://day.js.org/docs/en/parse/string-format for more information.",a=` with the format "${t}"`;throw new Error(`Could not parse the provided date "${e}"${t?a:n}`)}Jc(r)}function Jc(e){if(e.isBefore(Im))throw new Error(`Date is before year 1401, which is unsupported by the API: ${e}`)}zr.default.extend(bm.default);var Zc=["past","now","next"],Xc=["minute","hour","day","week","month","quarter","year"],Am=e=>{let t=e==="now";return{amount:new B({required:!t,min:1}),unit:new x({required:!t,constrainTo:Xc}),period:new x({required:!0,constrainTo:Zc})}};function Qa(e){if(typeof e=="string"&&!nr(e))throw new Error(`The value "${e}" is not respecting the relative date format "period-amount-unit"`);let t=typeof e=="string"?Ri(e):e;new ye(Am(t.period)).validate(t);let r=el(t),n=JSON.stringify(t);if(!r.isValid())throw new Error(`Date is invalid: ${n}`);Jc(r)}function qm(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":case"next":return`${t}-${r}-${n}`;case"now":return t}}function el(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":return(0,zr.default)().subtract(r,n);case"next":return(0,zr.default)().add(r,n);case"now":return(0,zr.default)()}}function za(e){return Kc(el(Ri(e)))}function tl(e){return e.toLocaleLowerCase().split("-")}function nr(e){let[t,r,n]=tl(e);if(t==="now")return!0;if(!Zc.includes(t)||!Xc.includes(n))return!1;let a=parseInt(r);return!(isNaN(a)||a<=0)}function Om(e){return!!e&&typeof e=="object"&&"period"in e}function Ri(e){let[t,r,n]=tl(e);return t==="now"?{period:"now"}:{period:t,amount:r?parseInt(r):void 0,unit:n||void 0}}function ZI(e){return Qa(e),Ri(e)}function xm(e){return e.type==="dateRange"}function rl(e){return`start${e}`}function nl(e){return`end${e}`}var Em=()=>({dateFacetValueMap:{}});function Rm(e,t,r){let n=e.start,a=e.end;return nr(n)&&(n=za(n),r.dateFacetValueMap[t][rl(n)]=e.start),nr(a)&&(a=za(a),r.dateFacetValueMap[t][nl(a)]=e.end),{...e,start:n,end:a}}function Fm(e,t){if(xm(e)){let{facetId:r,currentValues:n}=e;return t.dateFacetValueMap[r]={},{...e,currentValues:n.map(a=>Rm(a,r,t))}}return e}function An(e){var r;let t=Em();return{request:{...e,facets:(r=e.facets)==null?void 0:r.map(n=>Fm(n,t))},mappings:t}}function Dm(e,t,r){return{...e,start:r.dateFacetValueMap[t][rl(e.start)]||e.start,end:r.dateFacetValueMap[t][nl(e.end)]||e.end}}function Tm(e,t){return e.facetId in t.dateFacetValueMap}function Mm(e,t){return Tm(e,t)?{...e,values:e.values.map(r=>Dm(r,e.facetId,t))}:e}function Ut(e,t){var r;return"success"in e?{success:{...e.success,facets:(r=e.success.facets)==null?void 0:r.map(n=>Mm(n,t))}}:e}var ur=async(e,t)=>{let r=e.analyticsMode==="next";return{analytics:{clientId:await Je(e),clientTimestamp:new Date().toISOString(),documentReferrer:e.originLevel3,originContext:e.originContext,...t&&{actionCause:t.actionCause,customData:t.customData},...t&&!r&&{customData:t.customData},...e.userDisplayName&&{userDisplayName:e.userDisplayName},...e.documentLocation&&{documentLocation:e.documentLocation},...e.deviceId&&{deviceId:e.deviceId},...Ys()&&{pageId:Ys()},...r&&e.trackingId&&{trackingId:e.trackingId},capture:r,...r&&{source:yc(e)}}}},jm=async(e,t)=>{var r,n;return{accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.platformUrl,count:t.querySuggest[e].count,insightId:t.insightConfiguration.insightId,q:(r=t.querySet)==null?void 0:r[e],timezone:t.configuration.search.timezone,actionsHistory:t.configuration.analytics.enabled?pt.getHistory():[],...((n=t.insightCaseContext)==null?void 0:n.caseContext)&&{context:t.insightCaseContext.caseContext},...t.configuration.analytics.enabled&&{visitorId:await Je(t.configuration.analytics),...t.configuration.analytics.enabled&&await ur(t.configuration.analytics)}}},Pm=S("didYouMean/enable"),Um=S("didYouMean/disable"),_m=S("didYouMean/automaticCorrections/disable"),Vm=S("didYouMean/automaticCorrections/enable"),Vt=S("didYouMean/correction",e=>I(e,D)),$m=S("didYouMean/automaticCorrections/mode",e=>I(e,new x({constrainTo:["next","legacy"],emptyAllowed:!1,required:!0}))),ar=()=>({correctedQuery:"",wordCorrections:[],originalQuery:""}),Lm=()=>({correctedQuery:"",corrections:[],originalQuery:""});function Qm(){return{enableDidYouMean:!1,wasCorrectedTo:"",wasAutomaticallyCorrected:!1,queryCorrection:ar(),originalQuery:"",automaticallyCorrectQuery:!0,queryCorrectionMode:"legacy"}}var zm=S("history/undo"),Bm=S("history/redo"),_e=S("history/snapshot");V("history/back",async(e,{dispatch:t})=>{t(zm()),await t(De())});V("history/forward",async(e,{dispatch:t})=>{t(Bm()),await t(De())});var De=V("history/change",async(e,{getState:t})=>t().history.present),Br=()=>({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,lq:"",lqWasSet:!1,dq:"",dqWasSet:!1,defaultFilters:{cq:"",aq:"",lq:"",dq:""}});function al(){return{contextValues:{}}}var Nm=()=>!1;function Hm(){return{contextValues:{}}}function Ht(){return{enabled:!0}}function il(){return{freezeFacetOrder:!1,facets:{}}}function Gm(){return[]}function qn(){return{firstResult:0,defaultNumberOfResults:10,numberOfResults:10,totalCountFiltered:0}}function sl(){return{}}function Ym(){return{}}function ol(){return{}}function Ve(e){return{context:e.context||al(),dictionaryFieldContext:e.dictionaryFieldContext||Hm(),facetSet:e.facetSet||bi(),numericFacetSet:e.numericFacetSet||wi(),dateFacetSet:e.dateFacetSet||Si(),categoryFacetSet:e.categoryFacetSet||vi(),automaticFacetSet:e.automaticFacetSet??Dc(),pagination:e.pagination||qn(),query:e.query||Xe(),tabSet:e.tabSet||ol(),advancedSearchQueries:e.advancedSearchQueries||Br(),staticFilterSet:e.staticFilterSet||Ym(),querySet:e.querySet||sl(),sortCriteria:e.sortCriteria||qi(),pipeline:e.pipeline||Bc(),searchHub:e.searchHub||fi(),facetOptions:e.facetOptions||il(),facetOrder:e.facetOrder??Gm(),debug:e.debug??Nm()}}var At=S("query/updateQuery",e=>I(e,{q:new x,enableQuerySyntax:new J})),Wm=()=>({caseContext:{},caseId:"",caseNumber:""}),U=e=>({caseContext:(e==null?void 0:e.caseContext)||{},caseId:e==null?void 0:e.caseId,caseNumber:e==null?void 0:e.caseNumber}),Ws=()=>_("pagerScrolling")("search/logFetchMoreResults",(e,t)=>e.logFetchMoreResults(U(t.insightCaseContext))),un=e=>_("query")("search/queryError",(t,r)=>{var n;return t.logQueryError({...U(r.insightCaseContext),query:((n=r.query)==null?void 0:n.q)||Xe().q,aq:"",cq:"",dq:"",errorType:e.type,errorMessage:e.message})}),Km=()=>_("interfaceLoad")("analytics/interface/load",(e,t)=>e.logInterfaceLoad(U(t.insightCaseContext))),Jm=()=>_("interfaceChange")("analytics/interface/change",(e,t)=>{e.logInterfaceChange({...U(t.insightCaseContext),interfaceChangeTo:t.configuration.analytics.originLevel2})});function it(e){return Object.values(e).map(t=>t.request)}var cl=async(e,t)=>{var a,i;let r=ev(e),n=Xm(e);return An({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.platformUrl,insightId:e.insightConfiguration.insightId,...e.configuration.analytics.enabled&&await ur(e.configuration.analytics,t),q:(a=e.query)==null?void 0:a.q,...n.length&&{facets:n},caseContext:(i=e.insightCaseContext)==null?void 0:i.caseContext,...r&&{cq:r},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},...e.sortCriteria&&{sortCriteria:e.sortCriteria},tab:e.configuration.analytics.originLevel2,...e.folding&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.context&&{context:e.context.contextValues},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})},ft=async(e,t)=>{let r=()=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0,n=await cl(e,t);return{...n,request:{...n.request,...e.pagination&&{firstResult:e.pagination.firstResult,numberOfResults:r()}}}},Zm=async(e,t)=>{var n;let r=await cl(e);return{...r,request:{...r.request,filterFieldRange:100,cq:`@${(n=e==null?void 0:e.folding)==null?void 0:n.fields.collection}="${t}"`}}},ll=async(e,t)=>{var n,a;let r=await ft(e,t);return r.request={...r.request,firstResult:(((n=e.pagination)==null?void 0:n.firstResult)??0)+(((a=e.pagination)==null?void 0:a.numberOfResults)??0)},r},ul=async(e,t)=>{let r=await ft(e,t);return r.request={...r.request,numberOfResults:0},r};function Xm(e){return it({...e.facetSet,...e.numericFacetSet,...e.dateFacetSet,...e.categoryFacetSet})}function ev(e){var t;return((t=Object.values(e.tabSet||{}).find(r=>r.isActive))==null?void 0:t.expression.trim())||""}var On=class{constructor(e){this.config=e}async fetchFromAPI({request:e,mappings:t},r){var o;let n=new Date().getTime(),a=Ut(await this.extra.apiClient.query(e,r),t),i=new Date().getTime()-n,s=((o=this.getState().query)==null?void 0:o.q)||"";return{response:a,duration:i,queryExecuted:s,requestExecuted:e}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return pe(e.response)?(this.dispatch(un(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){if(!this.shouldReExecuteTheQueryWithCorrections(e)||pe(e.response))return null;let{correctedQuery:t}=e.response.success.queryCorrections?e.response.success.queryCorrections[0]:ar(),r=this.getCurrentQuery(),n=await this.automaticallyRetryQueryWithCorrection(t);return pe(n.response)?(this.dispatch(un(n.response.error)),this.rejectWithValue(n.response.error)):(this.dispatch(_e(Ve(this.getState()))),{...n,response:{...n.response.success,queryCorrections:e.response.success.queryCorrections},automaticallyCorrected:!0,originalQuery:r})}shouldReExecuteTheQueryWithCorrections(e){var n;let t=this.getState(),r=this.getSuccessResponse(e);return!!(((n=t.didYouMean)==null?void 0:n.enableDidYouMean)===!0&&(r==null?void 0:r.results.length)===0&&(r!=null&&r.queryCorrections)&&(r==null?void 0:r.queryCorrections.length)!==0)}async automaticallyRetryQueryWithCorrection(e){this.dispatch(At({q:e}));let t=this.getState(),r=await this.fetchFromAPI(await ft(t));return this.dispatch(Vt(e)),r}processSuccessResponse(e){return this.dispatch(_e(Ve(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery()}}getSuccessResponse(e){return yn(e.response)?e.response.success:null}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}getCurrentQuery(){var t;let e=this.getState();return((t=e.query)==null?void 0:t.q)!==void 0?e.query.q:""}},tv=()=>_("didyoumeanAutomatic")("analytics/didyoumean/automatic",(e,t)=>e.logDidYouMeanAutomatic(U(t.insightCaseContext))),xn=class{constructor(e){this.config=e}async fetchFromAPI({request:e,mappings:t},r){var o;let n=new Date().getTime(),a=Ut(await this.extra.apiClient.query(e,r),t),i=new Date().getTime()-n,s=((o=this.getState().query)==null?void 0:o.q)||"";return{response:a,duration:i,queryExecuted:s,requestExecuted:e}}async process(e,t){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e,t)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return pe(e.response)?(this.dispatch(un(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e,t){if(!this.shouldReExecuteTheQueryWithCorrections(e)||pe(e.response))return null;let{correctedQuery:r}=e.response.success.queryCorrections?e.response.success.queryCorrections[0]:ar(),n=this.getCurrentQuery(),a=await this.automaticallyRetryQueryWithCorrection(r);return pe(a.response)?(this.dispatch(un(a.response.error)),this.rejectWithValue(a.response.error)):(this.logOriginalAnalyticsQueryBeforeAutoCorrection(e,t),this.dispatch(_e(Ve(this.getState()))),{...a,response:{...a.response.success,queryCorrections:e.response.success.queryCorrections},automaticallyCorrected:!0,originalQuery:n,analyticsAction:tv()})}shouldReExecuteTheQueryWithCorrections(e){var n;let t=this.getState(),r=this.getSuccessResponse(e);return!!(((n=t.didYouMean)==null?void 0:n.enableDidYouMean)===!0&&(r==null?void 0:r.results.length)===0&&(r!=null&&r.queryCorrections)&&(r==null?void 0:r.queryCorrections.length)!==0)}async automaticallyRetryQueryWithCorrection(e){this.dispatch(At({q:e}));let t=this.getState(),r=await this.fetchFromAPI(await ft(t));return this.dispatch(Vt(e)),r}processSuccessResponse(e){return this.dispatch(_e(Ve(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(e){return yn(e.response)?e.response.success:null}getStateAfterResponse(e,t,r,n){var a;return{...r,query:{q:e,enableQuerySyntax:((a=r.query)==null?void 0:a.enableQuerySyntax)??Xe().enableQuerySyntax},search:{...$e(),duration:t,response:n,results:n.results}}}logOriginalAnalyticsQueryBeforeAutoCorrection(e,t){let r=this.getState(),n=Ut(e.response,t.mappings).success;this.analyticsAction&&this.analyticsAction()(this.dispatch,()=>this.getStateAfterResponse(e.queryExecuted,e.duration,r,n),this.extra)}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}getCurrentQuery(){var t;let e=this.getState();return((t=e.query)==null?void 0:t.q)!==void 0?e.query.q:""}get analyticsAction(){return this.config.analyticsAction}};async function dl(e,t,r){En(e);let n=new xn({...t,analyticsAction:r}),{analyticsClientMiddleware:a,preprocessRequest:i,logger:s}=t.extra,{description:o}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:a,preprocessRequest:i,logger:s}),c=await ft(e,o),l=await n.fetchFromAPI(c);return await n.process(l,c)}async function gl(e,t,r){En(e);let n=new xn({...t,analyticsAction:r}),{analyticsClientMiddleware:a,preprocessRequest:i,logger:s}=t.extra,{description:o}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:a,preprocessRequest:i,logger:s}),c=await ft(e,o),l=await n.fetchFromAPI(c);return await n.process(l,c)}async function pl(e,t){let r=new xn({...t,analyticsAction:Ws}),{analyticsClientMiddleware:n,preprocessRequest:a,logger:i}=t.extra,{description:s}=await Ws().prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:i}),o=await ll(e,s),c=await r.fetchFromAPI(o);return await r.process(c,o)}async function fl(e,t,r){let n=new xn({...t,analyticsAction:r}),{analyticsClientMiddleware:a,preprocessRequest:i,logger:s}=t.extra,{description:o}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:a,preprocessRequest:i,logger:s}),c=await ul(e,o),l=await n.fetchFromAPI(c);return await n.process(l,c)}var rv=V("search/executeSearch",async(e,t)=>{let r=t.getState();return await dl(r,t,e)}),nv=V("search/fetchPage",async(e,t)=>{let r=t.getState();return await gl(r,t,e)}),av=V("search/fetchMoreResults",async(e,t)=>{let r=t.getState();return await pl(r,t)}),iv=V("search/fetchFacetValues",async(e,t)=>{let r=t.getState();return await fl(r,t,e)}),sv=async(e,t,{request:r,mappings:n},a)=>{var l;let i=new Date().getTime(),s=Ut(await e.query(r,a),n),o=new Date().getTime()-i,c=((l=t.query)==null?void 0:l.q)||"";return{response:s,duration:o,queryExecuted:c,requestExecuted:r}},ae=V("search/executeSearch",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return dl(r,t,e.legacy);En(r);let n=new On({...t}),a=Rn(e.next),i=await ft(r,a),s=await n.fetchFromAPI(i);return await n.process(s)}),sa=V("search/fetchPage",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return gl(r,t,e.legacy);En(r);let n=new On({...t}),a=Rn(e.next),i=await ft(r,a),s=await n.fetchFromAPI(i);return await n.process(s)}),hl=V("search/fetchMoreResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return pl(r,t);let n=new On({...t}),a=Rn({actionCause:"pagerScrolling"}),i=await ll(r,a),s=await n.fetchFromAPI(i);return await n.process(s)}),Ks=V("search/fetchFacetValues",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return fl(r,t,e.legacy);let n=new On({...t}),a=Rn(e.next),i=await ul(r,a),s=await n.fetchFromAPI(i);return await n.process(s)}),yl=V("querySuggest/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:a}})=>{a(e,{id:D});let i=e.id,s=await jm(i,t()),o=await n.querySuggest(s);return pe(o)?r(o.error):{id:i,q:s.q,...o.success}}),En=e=>{var t;e.configuration.analytics.enabled&&pt.addElement({name:"Query",...((t=e.query)==null?void 0:t.q)&&{value:e.query.q},time:JSON.stringify(new Date)})},Rn=e=>({actionCause:e.actionCause,type:e.actionCause}),tt=S("breadcrumb/deselectAll"),Fn=S("breadcrumb/deselectAllNonBreadcrumbs"),dr=S("facet/updateFacetAutoSelection",e=>I(e,{allow:new J({required:!0})})),ov=class extends kn{constructor(e){super(e),this.getState=e}get activeInstantResultQuery(){let e=this.getState().instantResults;for(let t in e)for(let r in e[t].cache)if(e[t].cache[r].isActive)return e[t].q;return null}get activeInstantResultCache(){let e=this.getState().instantResults;for(let t in e)for(let r in e[t].cache)if(e[t].cache[r].isActive)return e[t].cache[r];return null}get results(){var e;return(e=this.activeInstantResultCache)==null?void 0:e.results}get queryText(){return this.activeInstantResultQuery??Xe().q}get responseTime(){var e;return((e=this.activeInstantResultCache)==null?void 0:e.duration)??$e().duration}get numberOfResults(){var e;return((e=this.activeInstantResultCache)==null?void 0:e.totalCountFiltered)??$e().response.totalCountFiltered}getSearchUID(){var e;return((e=this.activeInstantResultCache)==null?void 0:e.searchUid)||super.getSearchUID()}},cv=()=>et("analytics/instantResult/searchboxAsYouType",e=>e.makeSearchboxAsYouType(),e=>new ov(e)),lv=()=>({actionCause:"searchboxAsYouType"}),Fi={id:D},uv={...Fi,q:be};S("instantResults/register",e=>I(e,Fi));var ml=S("instantResults/updateQuery",e=>I(e,uv));S("instantResults/clearExpired",e=>I(e,Fi));var Dn=new B({required:!0,min:0}),vl=S("pagination/registerNumberOfResults",e=>I(e,Dn)),Sl=S("pagination/updateNumberOfResults",e=>I(e,Dn)),wl=S("pagination/registerPage",e=>I(e,Dn)),gr=S("pagination/updatePage",e=>I(e,Dn)),bl=S("pagination/nextPage"),Cl=S("pagination/previousPage"),Di=async(e,t)=>{var r,n,a,i;return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await Je(e.configuration.analytics),actionsHistory:pt.getHistory()},...((r=e.advancedSearchQueries)==null?void 0:r.aq)&&{aq:e.advancedSearchQueries.aq},...((n=e.advancedSearchQueries)==null?void 0:n.cq)&&{cq:e.advancedSearchQueries.cq},...((a=e.advancedSearchQueries)==null?void 0:a.lq)&&{lq:e.advancedSearchQueries.lq},...((i=e.advancedSearchQueries)==null?void 0:i.dq)&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await ur(e.configuration.analytics,t),...e.excerptLength&&!z(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}}},Ti=async(e,t)=>{var r,n,a,i;return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await Je(e.configuration.analytics),actionsHistory:pt.getHistory()},...((r=e.advancedSearchQueries)==null?void 0:r.aq)&&{aq:e.advancedSearchQueries.aq},...((n=e.advancedSearchQueries)==null?void 0:n.cq)&&{cq:e.advancedSearchQueries.cq},...((a=e.advancedSearchQueries)==null?void 0:a.lq)&&{lq:e.advancedSearchQueries.lq},...((i=e.advancedSearchQueries)==null?void 0:i.dq)&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await ur(e.configuration.analytics,t),...e.excerptLength&&!z(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}}},Js=()=>et("search/logFetchMoreResults",e=>e.makeFetchMoreResults()),Le=e=>et("search/queryError",(t,r)=>{var n,a,i,s;return t.makeQueryError({query:((n=r.query)==null?void 0:n.q)||Xe().q,aq:((a=r.advancedSearchQueries)==null?void 0:a.aq)||Br().aq,cq:((i=r.advancedSearchQueries)==null?void 0:i.cq)||Br().cq,dq:((s=r.advancedSearchQueries)==null?void 0:s.dq)||Br().dq,errorType:e.type,errorMessage:e.message})});function Il(e,t){let r={};e.forEach(i=>r[i.facetId]=i);let n=[];t.forEach(i=>{i in r&&(n.push(r[i]),delete r[i])});let a=Object.values(r);return[...n,...a]}var Fe=async(e,t)=>{var o;let r=mv(e),n=dv(e),a=gv(e),i=e.configuration.analytics.analyticsMode==="legacy"?await Ti(e,t):await Di(e,t),s=()=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0;return An({...i,...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="next",options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="legacy"},...r&&{cq:r},...n.length&&{facets:n},...e.pagination&&{numberOfResults:s(),firstResult:e.pagination.firstResult},...e.facetOptions&&{facetOptions:{freezeFacetOrder:e.facetOptions.freezeFacetOrder}},...((o=e.folding)==null?void 0:o.enabled)&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.automaticFacetSet&&{generateAutomaticFacets:{desiredCount:e.automaticFacetSet.desiredCount,numberOfValues:e.automaticFacetSet.numberOfValues,currentFacets:a}},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})};function dv(e){return Il(fv(e),e.facetOrder??[])}function gv(e){var r;let t=(r=e.automaticFacetSet)==null?void 0:r.set;return t?Object.values(t).map(n=>n.response).map(pv).filter(n=>n.currentValues.length>0):void 0}function pv(e){let{field:t,label:r,values:n}=e,a=n.filter(i=>i.state==="selected");return{field:t,label:r,currentValues:a}}function fv(e){return hv(e).filter(({facetId:t})=>{var r,n;return((n=(r=e.facetOptions)==null?void 0:r.facets[t])==null?void 0:n.enabled)??!0})}function hv(e){return[...yv(e.facetSet??{}),...Zs(e.numericFacetSet??{}),...Zs(e.dateFacetSet??{}),...it(e.categoryFacetSet??{})]}function yv(e){return it(e).map(t=>t.sortCriteria==="alphanumericDescending"?{...t,sortCriteria:{type:"alphanumeric",order:"descending"}}:t)}function Zs(e){return it(e).map(t=>{let r=t.currentValues.some(({state:n})=>n!=="idle");return t.generateAutomaticRanges&&!r?{...t,currentValues:[]}:t})}function mv(e){var a,i;let t=((a=e.advancedSearchQueries)==null?void 0:a.cq.trim())||"",r=((i=Object.values(e.tabSet||{}).find(s=>s.isActive))==null?void 0:i.expression.trim())||"",n=vv(e);return[t,r,...n].filter(s=>!!s).join(" AND ")}function vv(e){return Object.values(e.staticFilterSet||{}).map(t=>{let r=t.values.filter(a=>a.state==="selected"&&!!a.expression.trim()),n=r.map(a=>a.expression).join(" OR ");return r.length>1?`(${n})`:n})}var Xs=()=>et("analytics/didyoumean/automatic",e=>e.makeDidYouMeanAutomatic()),Sv=()=>({actionCause:"didyoumeanAutomatic"});new T({values:{undoneQuery:be},options:{required:!0}});var wv=()=>et("analytics/trigger/query",(e,t)=>{var r;return(r=t.triggers)!=null&&r.queryModification.newQuery?e.makeTriggerQuery():null}),kl=S("trigger/query/ignore",e=>I(e,new x({emptyAllowed:!0,required:!0}))),Al=S("trigger/query/modification",e=>I(e,new T({values:{originalQuery:te,modification:te}}))),pr=class{constructor(e,t=r=>{this.dispatch(At({q:r}))}){this.config=e,this.onUpdateQueryForCorrection=t}async fetchFromAPI({mappings:e,request:t},r){var o;let n=new Date().getTime(),a=Ut(await this.extra.apiClient.search(t,r),e),i=new Date().getTime()-n,s=((o=this.getState().query)==null?void 0:o.q)||"";return{response:a,duration:i,queryExecuted:s,requestExecuted:t}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return pe(e.response)?(this.dispatch(Le(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:a}=t.didYouMean,{results:i,queryCorrections:s,queryCorrection:o}=r;if(!n||!a)return null;let c=i.length===0&&s&&s.length!==0,l=!z(o)&&!z(o.correctedQuery);if(!c&&!l)return null;let u=c?await this.processLegacyDidYouMeanAutoCorrection(e):this.processModernDidYouMeanAutoCorrection(e);return this.dispatch(_e(Ve(this.getState()))),u}async processLegacyDidYouMeanAutoCorrection(e){let t=this.getCurrentQuery(),r=this.getSuccessResponse(e);if(!r.queryCorrections)return null;let{correctedQuery:n}=r.queryCorrections[0],a=await this.automaticallyRetryQueryWithCorrection(n);return pe(a.response)?(this.dispatch(Le(a.response.error)),this.rejectWithValue(a.response.error)):(this.logOriginalAnalyticsQueryBeforeAutoCorrection(e),this.dispatch(_e(Ve(this.getState()))),{...a,response:{...a.response.success,queryCorrections:r.queryCorrections},automaticallyCorrected:!0,originalQuery:t,analyticsAction:Xs()})}processModernDidYouMeanAutoCorrection(e){let t=this.getSuccessResponse(e),{correctedQuery:r,originalQuery:n}=t.queryCorrection;return this.onUpdateQueryForCorrection(r),{...e,response:{...t},queryExecuted:r,automaticallyCorrected:!0,originalQuery:n,analyticsAction:Xs()}}logOriginalAnalyticsQueryBeforeAutoCorrection(e){let t=this.getState(),r=this.getSuccessResponse(e);this.analyticsAction&&this.analyticsAction()(this.dispatch,()=>this.getStateAfterResponse(e.queryExecuted,e.duration,t,r),this.extra)}async processQueryTriggersOrContinue(e){var i,s;let t=this.getSuccessResponse(e);if(!t)return null;let r=((i=t.triggers.find(o=>o.type==="query"))==null?void 0:i.content)||"";if(!r)return null;if(((s=this.getState().triggers)==null?void 0:s.queryModification.queryToIgnore)===r)return this.dispatch(kl("")),null;this.analyticsAction&&await this.dispatch(this.analyticsAction);let n=this.getCurrentQuery(),a=await this.automaticallyRetryQueryWithTriggerModification(r);return pe(a.response)?(this.dispatch(Le(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(_e(Ve(this.getState()))),{...a,response:{...a.response.success},automaticallyCorrected:!1,originalQuery:n,analyticsAction:wv()})}getStateAfterResponse(e,t,r,n){var a;return{...r,query:{q:e,enableQuerySyntax:((a=r.query)==null?void 0:a.enableQuerySyntax)??Xe().enableQuerySyntax},search:{...$e(),duration:t,response:n,results:n.results}}}processSuccessResponse(e){return this.dispatch(_e(Ve(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(e){return yn(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let t=await this.fetchFromAPI(await Fe(this.getState()),{origin:"mainSearch"});return this.dispatch(Vt(e)),t}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(Al({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await Fe(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){var t;let e=this.getState();return((t=e.query)==null?void 0:t.q)!==void 0?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get analyticsAction(){return this.config.analyticsAction}get rejectWithValue(){return this.config.rejectWithValue}};V("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;I(e,{q:new x,enableQuerySyntax:new J,clearFilters:new J}),e.clearFilters&&(r(tt()),r(Fn())),r(dr({allow:!0})),r(At({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(gr(1))});var oa=V("search/executeSearch",async(e,t)=>{let r=t.getState();return await Mi(r,t,e)}),ca=V("search/fetchPage",async(e,t)=>{let r=t.getState();return await xl(r,t,e)}),la=V("search/fetchMoreResults",async(e,t)=>{let r=t.getState();return await El(t,r)}),bv=V("search/fetchFacetValues",async(e,t)=>{let r=t.getState();return await Av(t,e,r)});V("search/fetchInstantResults",async(e,t)=>Ol(e,t));var Cv=async(e,t)=>{var n,a;let r=await Fe(e,t);return r.request={...r.request,firstResult:(((n=e.pagination)==null?void 0:n.firstResult)??0)+(((a=e.search)==null?void 0:a.results.length)??0)},r},Iv=async(e,t,r)=>{let n=await Ti(e);return An({...n,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},kv=async(e,t)=>{let r=await Fe(e,t);return r.request.numberOfResults=0,r},ql=e=>{var t;e.configuration.analytics.enabled&&pt.addElement({name:"Query",...((t=e.query)==null?void 0:t.q)&&{value:e.query.q},time:JSON.stringify(new Date)})};async function Ol(e,t){I(e,{id:D,q:D,maxResultsPerQuery:new B({required:!0,min:1}),cacheTimeout:new B});let{q:r,maxResultsPerQuery:n}=e,a=t.getState(),i=new pr({...t,analyticsAction:cv()},l=>{t.dispatch(ml({q:l,id:e.id}))}),s=await Iv(a,r,n),o=await i.fetchFromAPI(s,{origin:"instantResults",disableAbortWarning:!0}),c=await i.process(o);return"response"in c?{results:c.response.results,searchUid:c.response.searchUid,analyticsAction:c.analyticsAction,totalCountFiltered:c.response.totalCountFiltered,duration:c.duration}:c}async function xl(e,t,r){ql(e);let{analyticsClientMiddleware:n,preprocessRequest:a,logger:i}=t.extra,{description:s}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:i}),o=new pr({...t,analyticsAction:r}),c=await Fe(e,s),l=await o.fetchFromAPI(c,{origin:"mainSearch"});return await o.process(l)}async function El(e,t){let{analyticsClientMiddleware:r,preprocessRequest:n,logger:a}=e.extra,{description:i}=await Js().prepare({getState:()=>e.getState(),analyticsClientMiddleware:r,preprocessRequest:n,logger:a}),s=new pr({...e,analyticsAction:Js()}),o=await Cv(t,i),c=await s.fetchFromAPI(o,{origin:"mainSearch"});return await s.process(c)}async function Av(e,t,r){let{analyticsClientMiddleware:n,preprocessRequest:a,logger:i}=e.extra,{description:s}=await t.prepare({getState:()=>e.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:i}),o=new pr({...e,analyticsAction:t}),c=await kv(r,s),l=await o.fetchFromAPI(c,{origin:"facetValues"});return await o.process(l)}async function Mi(e,t,r){ql(e);let{analyticsClientMiddleware:n,preprocessRequest:a,logger:i}=t.extra,{description:s}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:i}),o=await Fe(e,s),c=new pr({...t,analyticsAction:r}),l=await c.fetchFromAPI(o,{origin:"mainSearch"});return await c.process(l)}var fr=class{constructor(e,t=r=>{this.dispatch(At({q:r}))}){this.config=e,this.onUpdateQueryForCorrection=t}async fetchFromAPI({mappings:e,request:t},r){var o;let n=new Date().getTime(),a=Ut(await this.extra.apiClient.search(t,r),e),i=new Date().getTime()-n,s=((o=this.getState().query)==null?void 0:o.q)||"";return{response:a,duration:i,queryExecuted:s,requestExecuted:t}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return pe(e.response)?(this.dispatch(Le(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:a}=t.didYouMean,{results:i,queryCorrections:s,queryCorrection:o}=r;if(!n||!a)return null;let c=i.length===0&&s&&s.length!==0,l=!z(o)&&!z(o.correctedQuery);if(!c&&!l)return null;let u=c?await this.processLegacyDidYouMeanAutoCorrection(e):this.processModernDidYouMeanAutoCorrection(e);return this.dispatch(_e(Ve(this.getState()))),u}async processLegacyDidYouMeanAutoCorrection(e){let t=this.getCurrentQuery(),r=this.getSuccessResponse(e);if(!r.queryCorrections)return null;let{correctedQuery:n}=r.queryCorrections[0],a=await this.automaticallyRetryQueryWithCorrection(n);return pe(a.response)?(this.dispatch(Le(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(_e(Ve(this.getState()))),{...a,response:{...a.response.success,queryCorrections:r.queryCorrections},automaticallyCorrected:!0,originalQuery:t})}processModernDidYouMeanAutoCorrection(e){let t=this.getSuccessResponse(e),{correctedQuery:r,originalQuery:n}=t.queryCorrection;return this.onUpdateQueryForCorrection(r),{...e,response:{...t},queryExecuted:r,automaticallyCorrected:!0,originalQuery:n}}async processQueryTriggersOrContinue(e){var i,s;let t=this.getSuccessResponse(e);if(!t)return null;let r=((i=t.triggers.find(o=>o.type==="query"))==null?void 0:i.content)||"";if(!r)return null;if(((s=this.getState().triggers)==null?void 0:s.queryModification.queryToIgnore)===r)return this.dispatch(kl("")),null;let n=this.getCurrentQuery(),a=await this.automaticallyRetryQueryWithTriggerModification(r);return pe(a.response)?(this.dispatch(Le(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(_e(Ve(this.getState()))),{...a,response:{...a.response.success},automaticallyCorrected:!1,originalQuery:n})}processSuccessResponse(e){return this.dispatch(_e(Ve(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery()}}getSuccessResponse(e){return yn(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let t=this.getState(),{actionCause:r}=Sv(),n=await this.fetchFromAPI(await Fe(t,{actionCause:r}),{origin:"mainSearch"});return this.dispatch(Vt(e)),n}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(Al({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await Fe(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){var t;let e=this.getState();return((t=e.query)==null?void 0:t.q)!==void 0?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}},qv=V("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;I(e,{q:new x,enableQuerySyntax:new J,clearFilters:new J}),e.clearFilters&&(r(tt()),r(Fn())),r(dr({allow:!0})),r(At({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(gr(1))}),xe=V("search/executeSearch",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return Mi(r,t,e.legacy);Tl(r);let n=ji(e.next),a=await Fe(r,n),i=new fr({...t,analyticsAction:n}),s=await i.fetchFromAPI(a,{origin:"mainSearch"});return await i.process(s)}),Rl=V("search/fetchPage",async(e,t)=>{let r=t.getState();if(Tl(r),r.configuration.analytics.analyticsMode==="legacy"||!e.next)return xl(r,t,e.legacy);let n=new fr({...t,analyticsAction:e.next}),a=await Fe(r,e.next),i=await n.fetchFromAPI(a,{origin:"mainSearch"});return await n.process(i)}),Fl=V("search/fetchMoreResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return El(t,r);let n=Jy("pagerScrolling",t.getState),a=new fr({...t,analyticsAction:n}),i=await Ov(r,n),s=await a.fetchFromAPI(i,{origin:"mainSearch"});return await a.process(s)}),Dl=V("search/fetchFacetValues",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return Mi(r,t,e.legacy);let n=ji(e.next),a=new fr({...t,analyticsAction:n}),i=await Ev(r,n),s=await a.fetchFromAPI(i,{origin:"facetValues"});return await a.process(s)});V("search/fetchInstantResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return Ol(e,t);I(e,{id:D,q:D,maxResultsPerQuery:new B({required:!0,min:1}),cacheTimeout:new B});let{q:n,maxResultsPerQuery:a}=e,i=ji(lv()),s=await xv(r,n,a,i),o=new fr({...t,analyticsAction:i},u=>{t.dispatch(ml({q:u,id:e.id}))}),c=await o.fetchFromAPI(s,{origin:"instantResults",disableAbortWarning:!0}),l=await o.process(c);return"response"in l?{results:l.response.results,searchUid:l.response.searchUid,totalCountFiltered:l.response.totalCountFiltered,duration:l.duration}:l});var Ov=async(e,t)=>{var n,a;let r=await Fe(e,t);return r.request={...r.request,firstResult:(((n=e.pagination)==null?void 0:n.firstResult)??0)+(((a=e.search)==null?void 0:a.results.length)??0)},r},xv=async(e,t,r,n)=>{let a=await Di(e,n);return An({...a,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},Ev=async(e,t)=>{let r=await Fe(e,t);return r.request.numberOfResults=0,r},Tl=e=>{var t;e.configuration.analytics.enabled&&pt.addElement({name:"Query",...((t=e.query)==null?void 0:t.q)&&{value:e.query.q},time:JSON.stringify(new Date)})},ji=e=>({actionCause:e.actionCause,type:e.actionCause});async function Rv(e,t){var o;let{search:r,accessToken:n,organizationId:a,analytics:i}=e.configuration,s=((o=e.query)==null?void 0:o.q)||"";return{url:r.apiBaseUrl,accessToken:n,organizationId:a,enableNavigation:!1,...i.enabled&&{visitorId:await Je(e.configuration.analytics)},q:s,...t,requestedOutputSize:t.requestedOutputSize||0,...r.authenticationProviders.length&&{authentication:r.authenticationProviders.join(",")}}}var eo=V("resultPreview/fetchResultContent",async(e,{extra:t,getState:r,rejectWithValue:n})=>{let a=r(),i=await Rv(a,e),s=await t.apiClient.html(i);return pe(s)?n(s.error):{content:s.success,uniqueId:e.uniqueId}}),Fv=S("resultPreview/next"),Dv=S("resultPreview/previous"),Tv=S("resultPreview/prepare",e=>I(e,{results:new ie({required:!0})})),to=2048,Mv=V("resultPreview/updateContentURL",async(e,{getState:t,extra:r})=>{let n=t(),a=Ip(await e.buildResultPreviewRequest(n,{uniqueId:e.uniqueId,requestedOutputSize:e.requestedOutputSize}),e.path);return(a==null?void 0:a.length)>to&&r.logger.error(`The content URL was truncated as it exceeds the maximum allowed length of ${to} characters.`),{contentURL:a}});function Ml(){return{uniqueId:"",content:"",isLoading:!1,position:-1,resultsWithPreview:[]}}var ua=e=>{let{content:t,isLoading:r,uniqueId:n,contentURL:a}=Ml();e.content=t,e.isLoading=r,e.uniqueId=n,e.contentURL=a},da=e=>e.filter(t=>t.hasHtmlVersion).map(t=>t.uniqueId),jv=ne(Ml(),e=>{e.addCase(eo.pending,t=>{t.isLoading=!0}).addCase(eo.fulfilled,(t,r)=>{let{content:n,uniqueId:a}=r.payload;t.position=t.resultsWithPreview.indexOf(a),t.content=n,t.uniqueId=a,t.isLoading=!1}).addCase(xe.fulfilled,(t,r)=>{ua(t),t.resultsWithPreview=da(r.payload.response.results)}).addCase(Fl.fulfilled,(t,r)=>{ua(t),t.resultsWithPreview=t.resultsWithPreview.concat(da(r.payload.response.results))}).addCase(Rl.fulfilled,ua).addCase(Tv,(t,r)=>{t.resultsWithPreview=da(r.payload.results)}).addCase(Fv,t=>{if(t.isLoading)return;let r=t.position+1;r>t.resultsWithPreview.length-1&&(r=0),t.position=r}).addCase(Dv,t=>{if(t.isLoading)return;let r=t.position-1;r<0&&(r=t.resultsWithPreview.length-1),t.position=r}).addCase(Mv.fulfilled,(t,r)=>{t.contentURL=r.payload.contentURL})}),ga=()=>te,jl=()=>D,Pi=S("configuration/updateBasicConfiguration",e=>I(e,{accessToken:te,organizationId:te,platformUrl:te})),Pl=S("configuration/updateSearchConfiguration",e=>I(e,{apiBaseUrl:te,pipeline:new x({required:!1,emptyAllowed:!0}),searchHub:te,timezone:te,locale:te,authenticationProviders:new ie({required:!1,each:D})})),Pv={enabled:new J({default:!0}),originContext:ga(),originLevel2:ga(),originLevel3:ga(),apiBaseUrl:te,nextApiBaseUrl:te,runtimeEnvironment:new he,anonymous:new J({default:!1}),deviceId:te,userDisplayName:te,documentLocation:te,trackingId:te,analyticsMode:new x({constrainTo:["legacy","next"],required:!1,default:"legacy"}),source:new T({options:{required:!1},values:Xf.reduce((e,t)=>(e[t]=jp,e),{})})},Ul=S("configuration/updateAnalyticsConfiguration",e=>(Qo()&&(e.enabled=!1),I(e,Pv))),_l=S("configuration/analytics/disable"),Vl=S("configuration/analytics/enable"),Uv=S("configuration/analytics/originlevel2",e=>I(e,{originLevel2:jl()})),_v=S("configuration/analytics/originlevel3",e=>I(e,{originLevel3:jl()})),Vv=ne(fi(),e=>{e.addCase(Yc,(t,r)=>r.payload).addCase(De.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.searchHub)??t}).addCase(Pl,(t,r)=>r.payload.searchHub||t)}),$l=(e,t)=>{let r=e;return z(r[t])?z(e.raw[t])?null:e.raw[t]:r[t]};function Ll(e){return e.search.response.searchUid!==""}function $v(e,t,r){return e.search.results.find(n=>$l(n,t)===r)}function pa(e,t){let r=t.payload??null;r&&(e.response=$e().response,e.results=[],e.questionAnswer=Wr()),e.error=r,e.isLoading=!1}function Ba(e,t){e.error=null,e.response=t.payload.response,e.queryExecuted=t.payload.queryExecuted,e.duration=t.payload.duration,e.isLoading=!1}function Lv(e,t){Ba(e,t),e.results=t.payload.response.results,e.searchResponseId=t.payload.response.searchUid,e.questionAnswer=t.payload.response.questionAnswer,e.extendedResults=t.payload.response.extendedResults}function fa(e,t){e.isLoading=!0,e.requestId=t.meta.requestId}var fe=ne($e(),e=>{e.addCase(oa.rejected,(t,r)=>pa(t,r)),e.addCase(la.rejected,(t,r)=>pa(t,r)),e.addCase(ca.rejected,(t,r)=>pa(t,r)),e.addCase(oa.fulfilled,(t,r)=>{Lv(t,r)}),e.addCase(la.fulfilled,(t,r)=>{Ba(t,r),t.results=[...t.results,...r.payload.response.results]}),e.addCase(ca.fulfilled,(t,r)=>{Ba(t,r),t.results=r.payload.response.results}),e.addCase(bv.fulfilled,(t,r)=>{t.response.facets=r.payload.response.facets,t.response.searchUid=r.payload.response.searchUid}),e.addCase(oa.pending,fa),e.addCase(la.pending,fa),e.addCase(ca.pending,fa)}),Qv=ne(di,e=>e);function zv(){return typeof window<"u"&&typeof document<"u"}function Bv(e){var r;let t=(r=e.payload)==null?void 0:r.analyticsAction;return Ql(e)&&!z(t)}function Ql(e){return"type"in e}var Nv=e=>t=>r=>{let n;Bv(r)&&(n=r.payload.analyticsAction,delete r.payload.analyticsAction);let a=t(r);return Ql(r)&&(r.type==="search/executeSearch/fullfilled"&&n===void 0&&console.error("No analytics action associated with search:",r),r.type==="recommendation/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with recommendation:",r),r.type==="productRecommendations/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with product recommendation:",r)),n!==void 0&&e.dispatch(n),a},Hv=Qe(Eg()),zl={q:new x,enableQuerySyntax:new J,aq:new x,cq:new x,firstResult:new B({min:0}),numberOfResults:new B({min:0}),sortCriteria:new x,f:new T,fExcluded:new T,cf:new T,nf:new T,df:new T,debug:new J,sf:new T,tab:new x,af:new T},He=S("searchParameters/restore",e=>I(e,zl)),Bl=S("tab/register",e=>{let t=new T({values:{id:D,expression:be}});return I(e,t)}),ir=S("tab/updateActiveTab",e=>I(e,D)),Ui=Qe(ei()),Gv=Qe(Rg()),Yv=Qe(Fg());Ui.default.extend(Yv.default);Ui.default.extend(Gv.default);var Nl="/rest/search/v2",Hl="/rest/ua",Gl=()=>({organizationId:"",accessToken:"",platformUrl:Ss(),search:{apiBaseUrl:`${Ss()}${Nl}`,locale:"en-US",timezone:Ui.default.tz.guess(),authenticationProviders:[]},analytics:{enabled:!0,apiBaseUrl:`${Sp()}${Hl}`,nextApiBaseUrl:"",originContext:"Search",originLevel2:"default",originLevel3:"default",anonymous:!1,deviceId:"",userDisplayName:"",documentLocation:"",trackingId:"",analyticsMode:"legacy",source:{}}});function Wv(e,t){if(ip(e))return e.replace(/^(https:\/\/)platform/,"$1analytics")+Hl;let r=sp(e,t);return r?vp(t,r.environment).analytics:e}var Yl=ne(Gl(),e=>e.addCase(Pi,(t,r)=>{r.payload.accessToken&&(t.accessToken=r.payload.accessToken),r.payload.organizationId&&(t.organizationId=r.payload.organizationId),r.payload.platformUrl&&(t.platformUrl=r.payload.platformUrl,t.search.apiBaseUrl=`${r.payload.platformUrl}${Nl}`,t.analytics.apiBaseUrl=Wv(r.payload.platformUrl,t.organizationId))}).addCase(Pl,(t,r)=>{r.payload.apiBaseUrl&&(t.search.apiBaseUrl=r.payload.apiBaseUrl),r.payload.locale&&(t.search.locale=r.payload.locale),r.payload.timezone&&(t.search.timezone=r.payload.timezone),r.payload.authenticationProviders&&(t.search.authenticationProviders=r.payload.authenticationProviders)}).addCase(Ul,(t,r)=>{z(r.payload.enabled)||(t.analytics.enabled=r.payload.enabled),z(r.payload.originContext)||(t.analytics.originContext=r.payload.originContext),z(r.payload.originLevel2)||(t.analytics.originLevel2=r.payload.originLevel2),z(r.payload.originLevel3)||(t.analytics.originLevel3=r.payload.originLevel3),z(r.payload.apiBaseUrl)||(t.analytics.apiBaseUrl=r.payload.apiBaseUrl),z(r.payload.nextApiBaseUrl)||(t.analytics.nextApiBaseUrl=r.payload.nextApiBaseUrl),z(r.payload.trackingId)||(t.analytics.trackingId=r.payload.trackingId),z(r.payload.analyticsMode)||(t.analytics.analyticsMode=r.payload.analyticsMode),z(r.payload.source)||(t.analytics.source=r.payload.source);let n=(0,Hv.default)();n&&(t.analytics.analyticsMode="next",t.analytics.trackingId=n),z(r.payload.runtimeEnvironment)||(t.analytics.runtimeEnvironment=r.payload.runtimeEnvironment),z(r.payload.anonymous)||(t.analytics.anonymous=r.payload.anonymous),z(r.payload.deviceId)||(t.analytics.deviceId=r.payload.deviceId),z(r.payload.userDisplayName)||(t.analytics.userDisplayName=r.payload.userDisplayName),z(r.payload.documentLocation)||(t.analytics.documentLocation=r.payload.documentLocation)}).addCase(_l,t=>{t.analytics.enabled=!1}).addCase(Vl,t=>{t.analytics.enabled=!0}).addCase(Uv,(t,r)=>{t.analytics.originLevel2=r.payload.originLevel2}).addCase(_v,(t,r)=>{t.analytics.originLevel3=r.payload.originLevel3}).addCase(ir,(t,r)=>{t.analytics.originLevel2=r.payload}).addCase(He,(t,r)=>{t.analytics.originLevel2=r.payload.tab||t.analytics.originLevel2})),Ee=Yl;function Kv(e){return e.instantlyCallable}var Jv=()=>e=>t=>e(Kv(t)?t():t),Zv=e=>()=>t=>r=>{var i;let n=r;if(!n.error)return t(r);let a=n.error;if((i=n.payload)!=null&&i.ignored||e.error(a.stack||a.message||a.name||"Error",`Action dispatch error ${n.type}`,r),n.error.name!=="SchemaValidationError")return t(r)},Xv=e=>t=>r=>n=>(e.debug({action:n,nextState:t.getState()},`Action dispatched: ${n.type}`),r(n)),eS=()=>({referrer:document.referrer,userAgent:navigator.userAgent,location:window.location.href}),tS=()=>({referrer:"default",userAgent:"Node.js",location:"default"});function rS(e,t){let r={...e},n,a=i=>(s,o)=>{let c=i(s,o);return n?n(c,o):c};return{get combinedReducer(){let i=Gg(Object.entries(t).filter(([s])=>!(s in r)).map(([s,o])=>[s,()=>o]));return a(ec({...i,...r}))},containsAll(i){return Object.keys(i).every(s=>s in r)},add(i){Object.keys(i).filter(s=>!(s in r)).forEach(s=>r[s]=i[s])},addCrossReducer(i){n=i}}}function Wl(e,t,r){var n,a,i;t===void 0&&(t=50),r===void 0&&(r={});var s=(n=r.isImmediate)!=null&&n,o=(a=r.callback)!=null&&a,c=r.maxWait,l=Date.now(),u=[];function d(){if(c!==void 0){var f=Date.now()-l;if(f+t>=c)return c-f}return t}var g=function(){var f=[].slice.call(arguments),y=this;return new Promise(function(p,v){var b=s&&i===void 0;if(i!==void 0&&clearTimeout(i),i=setTimeout(function(){if(i=void 0,l=Date.now(),!s){var j=e.apply(y,f);o&&o(j),u.forEach(function(N){return(0,N.resolve)(j)}),u=[]}},d()),b){var A=e.apply(y,f);return o&&o(A),p(A)}u.push({resolve:p,reject:v})})};return g.cancel=function(f){i!==void 0&&clearTimeout(i),u.forEach(function(y){return(0,y.reject)(f)}),u=[]},g}function nS(e,t){let r=0,n=Wl(()=>r=0,500);return a=>i=>async s=>{if(typeof s!="function")return i(s);let o=await i(s);if(!aS(o))return o;if(typeof t!="function")return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),o;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),o;r++,n();let c=await iS(t);a.dispatch(Pi({accessToken:c})),a.dispatch(s)}}function aS(e){var t;return((t=e==null?void 0:e.error)==null?void 0:t.name)===new Yo().name}async function iS(e){try{return await e()}catch{return""}}function sS({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:n,name:a}){return mf({reducer:e,preloadedState:t,devTools:{stateSanitizer:i=>i.history?{...i,history:"<<OMIT>>"}:i,name:a,shouldHotReload:!1},middleware:i=>i({thunk:{extraArgument:n}}).prepend(...r).concat(Xv(n.logger))})}var oS={configuration:Ee,version:Qv};function cS(e,t){var s;let r=((s=e.organizationEndpoints)==null?void 0:s.analytics)||void 0,{analyticsClientMiddleware:n,...a}=e.analytics??{},i={...a,nextApiBaseUrl:`${r}/rest/organizations/${e.organizationId}/events/v1`,apiBaseUrl:r};if(Qo())return t.info("Analytics disabled since doNotTrack is active."),{...i,enabled:!1};if(i.analyticsMode==="next"&&!a.trackingId)throw new yS('analytics.trackingId is required when analytics.analyticsMode="next"');return i}function lS(e,t){var c;let r=uS(e,t),{accessToken:n,organizationId:a}=e.configuration,{organizationEndpoints:i}=e.configuration,s=(i==null?void 0:i.platform)||e.configuration.platformUrl;fS(e.configuration)&&r.logger.warn(`The \`platformUrl\` (${e.configuration.platformUrl}) option will be deprecated in the next major version. Consider using the \`organizationEndpoints\` option instead. See [Organization endpoints](https://docs.coveo.com/en/mcc80216).`),pS(e.configuration)?r.logger.warn("The `organizationEndpoints` options was not explicitly set in the Headless engine configuration. Coveo recommends setting this option, as it has resiliency benefits and simplifies the overall configuration for multi-region deployments. See [Organization endpoints](https://docs.coveo.com/en/mcc80216)."):hS(e.configuration)&&r.logger.warn(`There is a mismatch between the \`organizationId\` option (${e.configuration.organizationId}) and the organization configured in the \`organizationEndpoints\` option (${(c=e.configuration.organizationEndpoints)==null?void 0:c.platform}). This could lead to issues that are complex to troubleshoot. Please make sure both values match.`),r.dispatch(Pi({accessToken:n,organizationId:a,platformUrl:s}));let o=cS(e.configuration,r.logger);return o&&r.dispatch(Ul(o)),r}function uS(e,t){let{reducers:r}=e,n=rS({...oS,...r},e.preloadedState??{});e.crossReducer&&n.addCrossReducer(e.crossReducer);let a=t.logger,i=e.navigatorContextProvider??zv()?eS:tS,s={...t,get relay(){return Da(c.state)},get navigatorContext(){return i()}},o=dS(e,s,n),c={addReducers(l){n.containsAll(l)||(n.add(l),o.replaceReducer(n.combinedReducer))},dispatch:o.dispatch,subscribe:o.subscribe,enableAnalytics(){o.dispatch(Vl())},disableAnalytics(){o.dispatch(_l())},get state(){return o.getState()},get relay(){return Da(this.state)},get navigatorContext(){return i()},logger:a,store:o};return c}function dS(e,t,r){let{preloadedState:n,configuration:a}=e,i=a.name||"coveo-headless",s=gS(e,t.logger);return sS({preloadedState:n,reducer:r.combinedReducer,middlewares:s,thunkExtraArguments:t,name:i})}function gS(e,t){let{renewAccessToken:r}=e.configuration,n=nS(t,r);return[Jv,n,Zv(t),Nv].concat(e.middlewares||[])}function pS(e){return ut(e.organizationEndpoints)}function fS(e){var t;return!z(e.platformUrl)||z((t=e.organizationEndpoints)==null?void 0:t.platform)}function hS(e){let{platform:t}=e.organizationEndpoints;if(ut(t))return!1;let r=No(t);return r&&r.organizationId!==e.organizationId}var yS=class extends Error{constructor(e){super(e),this.name="InvalidEngineConfiguration"}},mS=Qe(Tg());function vS(e){return(0,mS.default)({name:"@coveo/headless",level:(e==null?void 0:e.level)||"warn",formatters:{log:e==null?void 0:e.logFormatter}})}function SS(e,t){let r=wS(e),n=kt,a=bS(e);return{analyticsClientMiddleware:r,validatePayload:n,preprocessRequest:a,logger:t}}function wS(e){let{analytics:t}=e,r=(n,a)=>a;return(t==null?void 0:t.analyticsClientMiddleware)||r}function bS(e){return e.preprocessRequest||Go}var CS={organizationId:D,accessToken:D,platformUrl:new x({required:!1,emptyAllowed:!1}),name:new x({required:!1,emptyAllowed:!1}),analytics:new T({options:{required:!1},values:{enabled:new J({required:!1}),originContext:new x({required:!1}),originLevel2:new x({required:!1}),originLevel3:new x({required:!1}),analyticsMode:new x({constrainTo:["legacy","next"],required:!1})}})},IS=new ye({...CS,insightId:D}),kS={insightConfiguration:mm,search:fe,insightInterface:wm,searchHub:Vv,resultPreview:jv};function XI(e){let t=vS(e.loggerOptions);AS(e.configuration,t);let r=qS(e.configuration,t),n=OS(t),a={...SS(e.configuration,t),apiClient:r,streamingClient:n},i={...e,reducers:kS},s=lS(i,a),{insightId:o}=e.configuration;return s.dispatch(Gc({insightId:o})),{...s,get state(){return s.state},executeFirstSearch(c=Km()){Ll(s.state)||s.dispatch(ae({legacy:c,next:fm()}))}}}function AS(e,t){try{IS.validate(e)}catch(r){throw t.error(r,"Insight engine configuration error"),r}}function qS(e,t){return new Tp({logger:t,preprocessRequest:e.preprocessRequest||Go})}function OS(e){return new gp({logger:e})}var $t={id:D},_i=S("querySuggest/register",e=>I(e,{...$t,count:new B({min:0})})),xS=S("querySuggest/unregister",e=>I(e,$t)),Vi=S("querySuggest/selectSuggestion",e=>I(e,{...$t,expression:be})),Nr=S("querySuggest/clear",e=>I(e,$t)),ha=V("querySuggest/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:a}})=>{a(e,$t);let i=e.id,s=await ES(i,t()),o=await n.querySuggest(s);return pe(o)?r(o.error):{id:i,q:s.q,...o.success}}),ES=async(e,t)=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl,count:t.querySuggest[e].count,q:t.querySet[e],locale:t.configuration.search.locale,timezone:t.configuration.search.timezone,actionsHistory:t.configuration.analytics.enabled?pt.getHistory():[],...t.context&&{context:t.context.contextValues},...t.pipeline&&{pipeline:t.pipeline},...t.searchHub&&{searchHub:t.searchHub},tab:t.configuration.analytics.originLevel2,...t.configuration.analytics.enabled&&{visitorId:await Je(t.configuration.analytics),...t.configuration.analytics.enabled&&await ur(t.configuration.analytics)},...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")}});function ek(e){return e.addReducers({search:fe}),{executeSearch:rv,fetchFacetValues:iv,fetchMoreResults:av,fetchPage:nv,fetchQuerySuggestions:yl,registerQuerySuggest:_i}}var RS={q:new x},FS={},DS=S("commerce/searchParameters/restore",e=>I(e,RS));S("commerce/productListingParameters/restore",e=>I(e,FS));var Kl={id:D,query:be},Jl=S("querySet/register",e=>I(e,Kl)),Na=S("querySet/update",e=>I(e,Kl)),TS=ne(sl(),e=>{e.addCase(Jl,(t,r)=>{let{id:n,query:a}=r.payload;n in t||(t[n]=a)}).addCase(Na,(t,r)=>{let{id:n,query:a}=r.payload;ya(t,n,a)}).addCase(Vi,(t,r)=>{let{id:n,expression:a}=r.payload;ya(t,n,a)}).addCase(xe.fulfilled,(t,r)=>{let{queryExecuted:n}=r.payload;Zl(t,n)}).addCase(He,ro).addCase(DS,ro).addCase(De.fulfilled,(t,r)=>{if(r.payload)for(let[n,a]of Object.entries(r.payload.querySet))ya(t,n,a)})});function ro(e,t){z(t.payload.q)||Zl(e,t.payload.q)}function Zl(e,t){Object.keys(e).forEach(r=>e[r]=t)}var ya=(e,t,r)=>{t in e&&(e[t]=r)},Z=D,MS={categoryFacetId:Z,categoryFacetPath:new ie({required:!0,each:D})},jS=(e,{categoryFacetId:t,categoryFacetPath:r})=>{var i;let n=(i=e.categoryFacetSet[t])==null?void 0:i.request.field,a=`${n}_${t}`;return{categoryFacetId:t,categoryFacetPath:r,categoryFacetField:n,categoryFacetTitle:a}},PS=e=>_("breadcrumbFacet")("analytics/categoryFacet/breadcrumb",(t,r)=>{I(e,MS);let n={...jS(r,e),...U(r.insightCaseContext)};return t.logBreadcrumbFacet(n)}),US=e=>_("showMoreFacetResults")("analytics/facet/showMore",(t,r)=>{I(e,Z);let n={...lr(e,Ze(r)),...U(r.insightCaseContext)};return t.logFacetShowMore(n)}),_S=e=>_("showLessFacetResults")("analytics/facet/showLess",(t,r)=>{I(e,Z);let n={...lr(e,Ze(r)),...U(r.insightCaseContext)};return t.logFacetShowLess(n)}),$i=e=>_("facetUpdateSort")("analytics/facet/sortChange",(t,r)=>{I(e,{facetId:Z,sortCriterion:new he({required:!0})});let{facetId:n,sortCriterion:a}=e,i=Ze(r),s={...lr(n,i),criteria:a,...U(r.insightCaseContext)};return t.logFacetUpdateSort(s)}),hr=e=>_("facetClearAll")("analytics/facet/reset",(t,r)=>{I(e,Z);let n=Ze(r),a={...lr(e,n),...U(r.insightCaseContext)};return t.logFacetClearAll(a)}),Tn=e=>_("facetSelect")("analytics/facet/select",(t,r)=>{I(e,{facetId:Z,facetValue:D});let n=Ze(r),a={...Ci(e,n),...U(r.insightCaseContext)};return t.logFacetSelect(a)}),Xl=e=>_("facetDeselect")("analytics/facet/deselect",(t,r)=>{I(e,{facetId:Z,facetValue:D});let n=Ze(r),a={...Ci(e,n),...U(r.insightCaseContext)};return t.logFacetDeselect(a)}),no=e=>_("breadcrumbFacet")("analytics/facet/breadcrumb",(t,r)=>{I(e,{facetId:Z,facetValue:D});let n={...Ci(e,Ze(r)),...U(r.insightCaseContext)};return t.logBreadcrumbFacet(n)}),VS=()=>_("breadcrumbResetAll")("analytics/facet/deselectAllBreadcrumbs",(e,t)=>e.logBreadcrumbResetAll(U(t.insightCaseContext))),$S=(e,{facetId:t,selection:r})=>{let n=(e.dateFacetSet[t]||e.numericFacetSet[t]).request.field,a=`${n}_${t}`;return{facetId:t,facetField:n,facetTitle:a,facetRangeEndInclusive:r.endInclusive,facetRangeEnd:`${r.end}`,facetRangeStart:`${r.start}`}},eu=()=>({actionCause:"breadcrumbFacet"}),yr={state:D,start:new B({required:!0}),end:new B({required:!0}),endInclusive:new J({required:!0}),numberOfResults:new B({required:!0,min:0})},mr={start:D,end:D,endInclusive:new J({required:!0}),state:D,numberOfResults:new B({required:!0,min:0})},Mn=e=>({facetId:Z,selection:typeof e.start=="string"?new T({values:mr}):new T({values:yr})}),ao=e=>_("breadcrumbFacet")("analytics/dateFacet/breadcrumb",(t,r)=>{I(e,Mn(e.selection));let n={...$S(r,e),...U(r.insightCaseContext)};return t.logBreadcrumbFacet(n)}),LS=(e,{facetId:t,selection:r})=>{let n=(e.dateFacetSet[t]||e.numericFacetSet[t]).request.field,a=`${n}_${t}`;return{facetId:t,facetField:n,facetTitle:a,facetRangeEndInclusive:r.endInclusive,facetRangeEnd:`${r.end}`,facetRangeStart:`${r.start}`}},io=e=>_("breadcrumbFacet")("analytics/numericFacet/breadcrumb",(t,r)=>{I(e,Mn(e.selection));let n={...LS(r,e),...U(r.insightCaseContext)};return t.logBreadcrumbFacet(n)}),jn={value:D,numberOfResults:new B({min:0}),state:D},QS=new B({min:1,default:8,required:!1}),zS=new B({min:1,max:20,default:5,required:!1}),BS={desiredCount:zS,numberOfValues:QS};S("automaticFacet/setOptions",e=>I(e,BS));S("automaticFacet/deselectAll",e=>I(e,Z));var NS=D,HS=S("automaticFacet/toggleSelectValue",e=>I(e,{field:NS,selection:new T({values:jn})})),GS={state:new he({required:!0}),numberOfResults:new B({required:!0,min:0}),value:new x({required:!0,emptyAllowed:!0}),path:new ie({required:!0,each:D}),moreValuesAvailable:new J({required:!1})};function tu(e){e.children.forEach(t=>{tu(t)}),kt({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},GS)}var _t={facetId:Z,field:D,delimitingCharacter:new x({required:!1,emptyAllowed:!0}),filterFacetCount:new J({required:!1}),injectionDepth:new B({required:!1,min:0}),numberOfValues:new B({required:!1,min:1}),sortCriteria:new he({required:!1}),basePath:new ie({required:!1,each:D}),filterByBasePath:new J({required:!1})},ru=S("categoryFacet/register",e=>I(e,_t)),nu=S("categoryFacet/toggleSelectValue",e=>{try{return kt(e.facetId,D),tu(e.selection),{payload:e,error:null}}catch(t){return{payload:e,error:dt(t)}}}),Li=S("categoryFacet/deselectAll",e=>I(e,_t.facetId)),YS=S("categoryFacet/updateNumberOfValues",e=>I(e,{facetId:_t.facetId,numberOfValues:_t.numberOfValues})),WS=S("categoryFacet/updateSortCriterion",e=>I(e,{facetId:_t.facetId,criterion:new he})),KS=S("categoryFacet/updateBasePath",e=>I(e,{facetId:_t.facetId,basePath:new ie({each:D})})),Qi={facetId:Z,captions:new T({options:{required:!1}}),numberOfValues:new B({required:!1,min:1}),query:new x({required:!1,emptyAllowed:!0})},JS={path:new ie({required:!0,each:D}),displayValue:be,rawValue:be,count:new B({required:!0,min:0})},au=S("categoryFacet/selectSearchResult",e=>I(e,{facetId:Z,value:new T({values:JS})})),ZS=S("categoryFacetSearch/register",e=>I(e,Qi)),iu={facetId:Z,value:new T({values:{displayValue:be,rawValue:be,count:new B({required:!0,min:0})}})},XS=S("facetSearch/register",e=>I(e,Qi)),su=S("facetSearch/update",e=>I(e,Qi)),ou=S("facetSearch/toggleSelectValue",e=>I(e,iu)),cu=S("facetSearch/toggleExcludeValue",e=>I(e,iu));function ew(e){let t=so(e.start,e),r=so(e.end,e),n=e.endInclusive??!1,a=e.state??"idle";return{start:t,end:r,endInclusive:n,state:a}}function so(e,t){let{dateFormat:r}=t;return Om(e)?(Qa(e),qm(e)):typeof e=="string"&&nr(e)?(Qa(e),e):(km(e,r),Kc(ln(e,r)))}var vr=new x({regex:/^[a-zA-Z0-9-_]+$/}),Sr=new x({required:!0}),tw=new ie({each:new x}),rw=new x,nw=new J,wr=new J,br=new B({min:0}),Lt=new B({min:1}),lu=new J({required:!0}),aw=new T,iw=new x,sw={captions:aw,numberOfValues:Lt,query:iw},zi=new T({values:sw}),uu=new T({options:{required:!1},values:{type:new x({constrainTo:["simple"],emptyAllowed:!1,required:!0}),values:new ie({required:!0,max:25,each:new x({emptyAllowed:!1,required:!0})})}}),du=new ie({min:1,max:25,required:!1,each:new x({emptyAllowed:!1,required:!0})}),ow={facetId:Z,field:new x({required:!0,emptyAllowed:!0}),filterFacetCount:new J({required:!1}),injectionDepth:new B({required:!1,min:0}),numberOfValues:new B({required:!1,min:1}),sortCriteria:new he({required:!1}),resultsMustMatch:new he({required:!1}),allowedValues:uu,customSort:du},Bi=S("facet/register",e=>I(e,ow)),Pn=S("facet/toggleSelectValue",e=>I(e,{facetId:Z,selection:new T({values:jn})})),Un=S("facet/toggleExcludeValue",e=>I(e,{facetId:Z,selection:new T({values:jn})})),Be=S("facet/deselectAll",e=>I(e,Z)),gu=S("facet/updateSortCriterion",e=>I(e,{facetId:Z,criterion:new he({required:!0})})),Ha=S("facet/updateNumberOfValues",e=>I(e,{facetId:Z,numberOfValues:new B({required:!0,min:1})})),Ga=S("facet/updateIsFieldExpanded",e=>I(e,{facetId:Z,isFieldExpanded:new J({required:!0})})),dn=S("facet/updateFreezeCurrentValues",e=>I(e,{facetId:Z,freezeCurrentValues:new J({required:!0})})),Ni=S("rangeFacet/updateSortCriterion",e=>I(e,{facetId:Z,criterion:new he({required:!0})})),cw={start:D,end:D,endInclusive:new J({required:!0}),state:D},lw={facetId:Z,field:D,currentValues:new ie({required:!1,each:new T({values:cw})}),generateAutomaticRanges:new J({required:!0}),filterFacetCount:new J({required:!1}),injectionDepth:new B({required:!1,min:0}),numberOfValues:new B({required:!1,min:1}),sortCriteria:new he({required:!1}),rangeAlgorithm:new he({required:!1})};function oo(e){return nr(e)?za(e):e}function Hi(e){e.currentValues&&e.currentValues.forEach(t=>{let{start:r,end:n}=ew(t);if(ln(oo(r)).isAfter(ln(oo(n))))throw new Error(`The start value is greater than the end value for the date range ${t.start} to ${t.end}`)})}var Cr=S("dateFacet/register",e=>{try{return kt(e,lw),Hi(e),{payload:e,error:null}}catch(t){return{payload:e,error:dt(t)}}}),Ir=S("dateFacet/toggleSelectValue",e=>I(e,{facetId:Z,selection:new T({values:mr})})),kr=S("dateFacet/toggleExcludeValue",e=>I(e,{facetId:Z,selection:new T({values:mr})})),sr=S("dateFacet/updateFacetValues",e=>{try{return kt(e,{facetId:Z,values:new ie({each:new T({values:mr})})}),Hi({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:dt(t)}}}),pu=Ni,fu=Be,uw={state:D,start:new B({required:!0}),end:new B({required:!0}),endInclusive:new J({required:!0})},dw={facetId:Z,field:D,currentValues:new ie({required:!1,each:new T({values:uw})}),generateAutomaticRanges:new J({required:!0}),filterFacetCount:new J({required:!1}),injectionDepth:new B({required:!1,min:0}),numberOfValues:new B({required:!1,min:1}),sortCriteria:new he({required:!1}),rangeAlgorithm:new he({required:!1})};function Gi(e){e.currentValues&&e.currentValues.forEach(({start:t,end:r})=>{if(t>r)throw new Error(`The start value is greater than the end value for the numeric range ${t} to ${r}`)})}var Ar=S("numericFacet/register",e=>{try{return I(e,dw),Gi(e),{payload:e,error:null}}catch(t){return{payload:e,error:dt(t)}}}),qr=S("numericFacet/toggleSelectValue",e=>I(e,{facetId:Z,selection:new T({values:yr})})),Or=S("numericFacet/toggleExcludeValue",e=>I(e,{facetId:Z,selection:new T({values:yr})})),or=S("numericFacet/updateFacetValues",e=>{try{return kt(e,{facetId:Z,values:new ie({each:new T({values:yr})})}),Gi({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:dt(t)}}}),hu=Ni,yu=Be,qt=e=>e.error!==void 0,Yi=(e=>(e.Relevance="relevance",e.Fields="fields",e))(Yi||{}),Wi=(e=>(e.Ascending="asc",e.Descending="desc",e))(Wi||{});new T({options:{required:!1},values:{by:new St({enum:Yi,required:!0}),fields:new ie({each:new T({values:{name:new x,direction:new St({enum:Wi})}})})}});var gw=()=>im("analytics/productListing/load",e=>e.makeInterfaceLoad(),e=>new ki(e));S("productlisting/setUrl",e=>I(e,{url:new x({required:!0,url:!0})}));S("productlisting/setAdditionalFields",e=>I(e,{additionalFields:new ie({required:!0,each:new x({required:!0,emptyAllowed:!1})})}));var _n=V("productlisting/fetch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t(),{apiClient:s}=a,o=await s.getProducts(await pw(i));return qt(o)?(r(Le(o.error)),n(o.error)):{response:o.success,analyticsAction:gw()}}),pw=async e=>{var n,a,i;let t=hw(e),r=await Je(e.configuration.analytics);return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,platformUrl:e.configuration.platformUrl,url:(n=e.productListing)==null?void 0:n.url,...e.configuration.analytics.enabled&&r?{clientId:r}:{},...(a=e.productListing.additionalFields)!=null&&a.length?{additionalFields:e.productListing.additionalFields}:{},...e.productListing.advancedParameters&&fw(e.productListing.advancedParameters)?{advancedParameters:e.productListing.advancedParameters||{}}:{},...t.length&&{facets:{requests:t}},...e.pagination&&{pagination:{numberOfValues:e.pagination.numberOfResults,page:Math.ceil(e.pagination.firstResult/(e.pagination.numberOfResults||1))+1}},...(((i=e.sort)==null?void 0:i.by)||"relevance")!=="relevance"&&{sort:e.sort},...e.context&&{userContext:e.context.contextValues}}};function fw(e){return e.debug}function hw(e){return Il(yw(e),e.facetOrder??[])}function yw(e){return[...it(e.facetSet??{}),...it(e.numericFacetSet??{}),...it(e.dateFacetSet??{}),...it(e.categoryFacetSet??{})]}var Ki=ne(qn(),e=>{e.addCase(vl,(t,r)=>{let n=ma(t),a=r.payload;t.defaultNumberOfResults=t.numberOfResults=a,t.firstResult=Gt(n,a)}).addCase(Sl,(t,r)=>{t.numberOfResults=r.payload,t.firstResult=0}).addCase(ir,t=>{t.firstResult=0}).addCase(wl,(t,r)=>{let n=r.payload;t.firstResult=Gt(n,t.numberOfResults)}).addCase(gr,(t,r)=>{let n=r.payload;t.firstResult=Gt(n,t.numberOfResults)}).addCase(Cl,t=>{let r=ma(t),n=Math.max(r-1,1);t.firstResult=Gt(n,t.numberOfResults)}).addCase(bl,t=>{let r=ma(t),n=mw(t),a=Math.min(r+1,n);t.firstResult=Gt(a,t.numberOfResults)}).addCase(De.fulfilled,(t,r)=>{r.payload&&(t.numberOfResults=r.payload.pagination.numberOfResults,t.firstResult=r.payload.pagination.firstResult)}).addCase(He,(t,r)=>{t.firstResult=r.payload.firstResult??t.firstResult,t.numberOfResults=r.payload.numberOfResults??t.defaultNumberOfResults}).addCase(xe.fulfilled,(t,r)=>{let{response:n}=r.payload;t.totalCountFiltered=n.totalCountFiltered}).addCase(_n.fulfilled,(t,r)=>{let{response:n}=r.payload;t.totalCountFiltered=n.pagination.totalCount}).addCase(Be,t=>{Ie(t)}).addCase(kr,t=>{Ie(t)}).addCase(Un,t=>{Ie(t)}).addCase(Or,t=>{Ie(t)}).addCase(cu,t=>{Ie(t)}).addCase(Pn,t=>{Ie(t)}).addCase(Li,t=>{Ie(t)}).addCase(nu,t=>{Ie(t)}).addCase(au,t=>{Ie(t)}).addCase(Ir,t=>{Ie(t)}).addCase(qr,t=>{Ie(t)}).addCase(tt,t=>{Ie(t)}).addCase(sr,t=>{Ie(t)}).addCase(or,t=>{Ie(t)}).addCase(ou,t=>{Ie(t)}).addCase(HS,t=>{Ie(t)})});function Ie(e){e.firstResult=qn().firstResult}function ma(e){let{firstResult:t,numberOfResults:r}=e;return mu(t,r)}function mw(e){let{totalCountFiltered:t,numberOfResults:r}=e;return vu(t,r)}function Gt(e,t){return(e-1)*t}function mu(e,t){return Math.round(e/t)+1}function vu(e,t){let r=Math.min(e,5e3);return Math.ceil(r/t)}function vw(e){return e.pagination.firstResult}function Su(e){return e.pagination.numberOfResults}function Sw(e){return e.pagination.totalCountFiltered}var xr=e=>{let t=vw(e),r=Su(e);return mu(t,r)},wu=e=>{let t=Sw(e),r=Su(e);return vu(t,r)},ww=(e,t)=>{let r=xr(e),n=wu(e),a=bw(r,t);return a=Cw(a),a=Iw(a,n),kw(a)};function bw(e,t){let r=t%2===0,n=Math.floor(t/2),a=r?n-1:n,i=e-n,s=e+a;return{start:i,end:s}}function Cw(e){let t=Math.max(1-e.start,0),r=e.start+t,n=e.end+t;return{start:r,end:n}}function Iw(e,t){let r=Math.max(e.end-t,0),n=Math.max(e.start-r,1),a=e.end-r;return{start:n,end:a}}function kw(e){let t=[];for(let r=e.start;r<=e.end;++r)t.push(r);return t}var Aw=()=>_("pagerNumber")("analytics/pager/number",(e,t)=>e.logPagerNumber({pagerNumber:xr(t),...U(t.insightCaseContext)})),qw=()=>_("pagerNext")("analytics/pager/next",(e,t)=>e.logPagerNext({pagerNumber:xr(t),...U(t.insightCaseContext)})),Ow=()=>_("pagerPrevious")("analytics/pager/previous",(e,t)=>e.logPagerPrevious({pagerNumber:xr(t),...U(t.insightCaseContext)})),xw=e=>{let t=U(e.insightCaseContext);return{targetId:t.caseId||"",targetType:"Case",caseNumber:t.caseNumber}},Ew=e=>_("staticFilterDeselect")("analytics/staticFilter/deselect",(t,r)=>t.logStaticFilterDeselect({...e,...U(r.insightCaseContext)})),we=S("facetOptions/update",(e={freezeFacetOrder:!0})=>I(e,{freezeFacetOrder:new J({required:!1})})),Qt=S("facetOptions/facet/enable",e=>I(e,Z)),We=S("facetOptions/facet/disable",e=>I(e,Z));function Ji(e,t){var i;let{facetId:r,criterion:n}=t,a=(i=e[r])==null?void 0:i.request;a&&(a.sortCriteria=n)}function _r(e){e&&(e.currentValues=e.currentValues.map(t=>({...t,state:"idle"})),e.preventAutoSelect=!0)}function bu(e,t){e&&(e.numberOfValues=t)}var Cu={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"ascending",rangeAlgorithm:"even",resultsMustMatch:"atLeastOneValue"};function Iu(e,t){let{request:r}=t,{facetId:n}=r;if(n in e)return;let a=xu(r);r.numberOfValues=a,e[n]=t}function ku(e,t,r){var a;let n=(a=e[t])==null?void 0:a.request;n&&(n.currentValues=r,n.numberOfValues=xu(n))}function Au(e,t,r){var s;let n=(s=e[t])==null?void 0:s.request;if(!n)return;let a=pn(n.currentValues,r);if(!a)return;let i=a.state==="selected";a.state=i?"idle":"selected",n.preventAutoSelect=!0}function qu(e,t,r){var s;let n=(s=e[t])==null?void 0:s.request;if(!n)return;let a=pn(n.currentValues,r);if(!a)return;let i=a.state==="excluded";a.state=i?"idle":"excluded",n.preventAutoSelect=!0}function Rt(e,t){var n;let r=(n=e[t])==null?void 0:n.request;r&&r.currentValues.forEach(a=>a.state="idle")}function Ou(e,t){Object.entries(e).forEach(([r,{request:n}])=>{let a=t[r]||[];n.currentValues.forEach(o=>{let c=!!pn(a,o);return o.state=c?"selected":"idle",o});let i=a.filter(o=>!pn(n.currentValues,o)),s=n.currentValues;s.push(...i),n.numberOfValues=Math.max(n.numberOfValues,s.length)})}function gn(e,t,r){t.forEach(n=>{var o;let a=n.facetId,i=(o=e[a])==null?void 0:o.request;if(!i)return;let s=r(n.values);i.currentValues=s,i.preventAutoSelect=!1})}function pn(e,t){let{start:r,end:n}=t;return e.find(a=>a.start===r&&a.end===n)}function xu(e){let{generateAutomaticRanges:t,currentValues:r,numberOfValues:n}=e;return t?Math.max(n,r.length):r.length}var Er=ne(Si(),e=>{e.addCase(Cr,(t,r)=>{let{payload:n}=r,a=Rw(n);Iu(t,Py(a))}).addCase(De.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.dateFacetSet)??t}).addCase(He,(t,r)=>{let n=r.payload.df||{};Ou(t,n)}).addCase(Ir,(t,r)=>{let{facetId:n,selection:a}=r.payload;Au(t,n,a)}).addCase(kr,(t,r)=>{let{facetId:n,selection:a}=r.payload;qu(t,n,a)}).addCase(sr,(t,r)=>{let{facetId:n,values:a}=r.payload;ku(t,n,a)}).addCase(fu,(t,r)=>{Rt(t,r.payload)}).addCase(tt,t=>{Object.keys(t).forEach(r=>{Rt(t,r)})}).addCase(pu,(t,r)=>{Ji(t,r.payload)}).addCase(xe.fulfilled,(t,r)=>{let n=r.payload.response.facets;gn(t,n,co)}).addCase(_n.fulfilled,(t,r)=>{var a,i;let n=((i=(a=r.payload.response)==null?void 0:a.facets)==null?void 0:i.results)||[];gn(t,n,co)}).addCase(We,(t,r)=>{Rt(t,r.payload)})});function Rw(e){return{...Cu,currentValues:[],preventAutoSelect:!1,type:"dateRange",...e}}function co(e){return e.map(t=>{let{numberOfResults:r,...n}=t;return n})}function tk(e){return e.addReducers({dateFacetSet:Er}),{deselectAllDateFacetValues:fu,registerDateFacet:Cr,toggleSelectDateFacetValue:Ir,toggleExcludeDateFacetValue:kr,updateDateFacetSortCriterion:pu,updateDateFacetValues:sr}}var Vn=ne(wi(),e=>{e.addCase(Ar,(t,r)=>{let{payload:n}=r,a=Fw(n);Iu(t,Uy(a))}).addCase(De.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.numericFacetSet)??t}).addCase(He,(t,r)=>{let n=r.payload.nf||{};Ou(t,n)}).addCase(qr,(t,r)=>{let{facetId:n,selection:a}=r.payload;Au(t,n,a)}).addCase(Or,(t,r)=>{let{facetId:n,selection:a}=r.payload;qu(t,n,a)}).addCase(or,(t,r)=>{let{facetId:n,values:a}=r.payload;ku(t,n,a)}).addCase(yu,(t,r)=>{Rt(t,r.payload)}).addCase(tt,t=>{Object.keys(t).forEach(r=>{Rt(t,r)})}).addCase(hu,(t,r)=>{Ji(t,r.payload)}).addCase(xe.fulfilled,(t,r)=>{let n=r.payload.response.facets;gn(t,n,lo)}).addCase(_n.fulfilled,(t,r)=>{var a,i;let n=((i=(a=r.payload.response)==null?void 0:a.facets)==null?void 0:i.results)||[];gn(t,n,lo)}).addCase(We,(t,r)=>{Rt(t,r.payload)})});function Fw(e){return{...Cu,currentValues:[],preventAutoSelect:!1,type:"numericalRange",...e}}function lo(e){return e.map(t=>{let{numberOfResults:r,...n}=t;return n})}function rk(e){return e.addReducers({numericFacetSet:Vn}),{deselectAllNumericFacetValues:yu,registerNumericFacet:Ar,toggleSelectNumericFacetValue:qr,toggleExcludeNumericFacetValue:Or,updateNumericFacetSortCriterion:hu,updateNumericFacetValues:or}}var Dw={results:new ie({required:!0,each:new T({values:xi})}),maxLength:new B({required:!0,min:1,default:10})},Tw=S("recentResults/registerRecentResults",e=>I(e,Dw)),$n=S("recentResults/pushRecentResult",e=>(Ei(e),{payload:e})),Mw=S("recentResults/clearRecentResults");function jw(){return{results:[],maxLength:10}}ne(jw(),e=>{e.addCase(Tw,(t,r)=>{t.results=r.payload.results.slice(0,r.payload.maxLength),t.maxLength=r.payload.maxLength}).addCase(Mw,t=>{t.results=[]}).addCase($n,(t,r)=>{let n=r.payload;t.results=t.results.filter(i=>i.uniqueId!==n.uniqueId);let a=t.results.slice(0,t.maxLength-1);t.results=[n,...a]})});var Pw=S("insight/caseContext/set",e=>{let t=new T({options:{required:!0}}),r=I(e,t).error;if(r)return{payload:e,error:r};let n=Object.values(e),a=new ie({each:be}),i=I(n,a).error;return i?{payload:e,error:i}:{payload:e}}),Uw=S("insight/caseId/set",e=>{let t=I(e,be).error;return t?{payload:e,error:t}:{payload:e}}),_w=S("insight/caseNumber/set",e=>{let t=I(e,be).error;return t?{payload:e,error:t}:{payload:e}});ne(Wm(),e=>{e.addCase(Pw,(t,r)=>{t.caseContext=r.payload}).addCase(Uw,(t,r)=>{t.caseId=r.payload}).addCase(_w,(t,r)=>{t.caseNumber=r.payload})});var Vw=new ie({each:D,required:!0}),Eu=(e,t)=>(I(e,D),ti(t)?I(t,D):I(t,Vw),{payload:{contextKey:e,contextValue:t}}),$w=S("context/set",e=>{for(let[t,r]of Object.entries(e))Eu(t,r);return{payload:e}}),Lw=S("context/add",e=>Eu(e.contextKey,e.contextValue)),Qw=S("context/remove",e=>I(e,D));ne(al(),e=>{e.addCase($w,(t,r)=>{t.contextValues=r.payload}).addCase(Lw,(t,r)=>{t.contextValues[r.payload.contextKey]=r.payload.contextValue}).addCase(Qw,(t,r)=>{delete t.contextValues[r.payload]}).addCase(De.fulfilled,(t,r)=>{r.payload&&(t.contextValues=r.payload.context.contextValues)})});var Zi={collectionField:new x({emptyAllowed:!1,required:!1}),parentField:new x({emptyAllowed:!1,required:!1}),childField:new x({emptyAllowed:!1,required:!1}),numberOfFoldedResults:new B({min:0,required:!1})},Xi=S("folding/register",e=>I(e,Zi)),va=V("folding/loadCollection",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let a=t(),i=a.configuration.analytics.analyticsMode==="legacy"?await Ti(a):await Di(a),s=await n.search({...i,q:zw(a),enableQuerySyntax:!0,cq:`@${a.folding.fields.collection}="${e}"`,filterField:a.folding.fields.collection,childField:a.folding.fields.parent,parentField:a.folding.fields.child,filterFieldRange:100},{origin:"foldingCollection"});return pe(s)?r(s.error):{collectionId:e,results:s.success.results,rootResult:a.folding.collections[e].result}});function zw(e){return e.query.q===""?"":e.query.enableQuerySyntax?`${e.query.q} OR @uri`:`( <@- ${e.query.q} -@> ) OR @uri`}var Ru=()=>({enabled:!1,fields:{collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"},filterFieldRange:2,collections:{}}),es=S("fields/registerFieldsToInclude",e=>I(e,Jo)),Fu=S("fields/fetchall/enable"),Du=S("fields/fetchall/disable"),Tu=V("fields/fetchDescription",async(e,{extra:t,getState:r,rejectWithValue:n})=>{let a=r(),{accessToken:i,organizationId:s}=a.configuration,{apiBaseUrl:o}=a.configuration.search,c=await t.apiClient.fieldDescriptions({accessToken:i,organizationId:s,url:o});return pe(c)?n(c.error):c.success.fields}),Bw=["author","language","urihash","objecttype","collection","source","permanentid"],Nw=()=>({fieldsToInclude:Bw,fetchAllFields:!1,fieldsDescription:[]}),Mu=ne(Nw(),e=>e.addCase(es,(t,r)=>{t.fieldsToInclude=[...new Set(t.fieldsToInclude.concat(r.payload))]}).addCase(Fu,t=>{t.fetchAllFields=!0}).addCase(Du,t=>{t.fetchAllFields=!1}).addCase(Tu.fulfilled,(t,{payload:r})=>{t.fieldsDescription=r}).addCase(Xi,(t,{payload:r})=>{let n=Ru().fields;t.fieldsToInclude.push(r.collectionField??n.collection,r.parentField??n.parent,r.childField??n.child)}));function nk(e){return e.addReducers({fields:Mu}),{registerFieldsToInclude:es,enableFetchAllFields:Fu,disableFetchAllFields:Du,fetchFieldsDescription:Tu}}var ju=new T({options:{required:!0},values:{articleLanguage:te,articlePublishStatus:te,articleVersionNumber:te,caseId:D,knowledgeArticleId:te,name:te,permanentId:te,resultUrl:te,source:te,title:D,uriHash:te}}),Hw=S("insight/attachToCase/setAttachedResults",e=>I(e,{results:new ie({each:ju}),loading:new J({required:!1,default:!1})})),Gw=S("insight/attachToCase/attach",e=>Pu(e)),Yw=S("insight/attachToCase/detach",e=>Pu(e)),Pu=e=>z(e.result.permanentId)&&z(e.result.uriHash)?{payload:e,error:dt(new hn("Either permanentId or uriHash is required"))}:I(e,{result:ju});function Ww(){return{results:[],loading:!1}}ne(Ww(),e=>{e.addCase(Hw,(t,r)=>{var i;let{results:n,loading:a}=r.payload;"results"in t&&((i=t.results)==null?void 0:i.length)>0||(t.results=n,a&&(t.loading=a))}).addCase(Gw,(t,r)=>{(!z(r.payload.result.permanentId)||!z(r.payload.result.uriHash))&&(t.results=[...t.results,r.payload.result])}).addCase(Yw,(t,r)=>{t.results=t.results.filter(n=>Kw(n,r.payload.result))})});var Kw=(e,t)=>{let r=!z(e.permanentId)&&(e==null?void 0:e.permanentId)===(t==null?void 0:t.permanentId),n=!z(e.uriHash)&&(e==null?void 0:e.uriHash)===(t==null?void 0:t.uriHash);return e.caseId!==t.caseId||!r&&!n},ts=()=>new T({values:{questionAnswerId:D},options:{required:!0}}),Uu=()=>new T({values:{linkText:be,linkURL:be},options:{required:!0}});function Ln(e){return I(e,ts())}var _u=S("smartSnippet/expand"),Vu=S("smartSnippet/collapse"),$u=S("smartSnippet/like"),Lu=S("smartSnippet/dislike"),Qu=S("smartSnippet/feedbackModal/open"),Hr=S("smartSnippet/feedbackModal/close"),zu=S("smartSnippet/related/expand",e=>Ln(e)),Bu=S("smartSnippet/related/collapse",e=>Ln(e)),uo=()=>({liked:!1,disliked:!1,expanded:!1,feedbackModalOpen:!1,relatedQuestions:[]}),go=(e,t)=>e.findIndex(r=>r.questionAnswerId===t.questionAnswerId);function Nu({question:e,answerSnippet:t,documentId:{contentIdKey:r,contentIdValue:n}}){return ri({question:e,answerSnippet:t,contentIdKey:r,contentIdValue:n})}function Jw(e,t){let r=Nu(e);return t&&r===t.questionAnswerId?t:{contentIdKey:e.documentId.contentIdKey,contentIdValue:e.documentId.contentIdValue,expanded:!1,questionAnswerId:r}}var Qn=ne(uo(),e=>e.addCase(_u,t=>{t.expanded=!0}).addCase(Vu,t=>{t.expanded=!1}).addCase($u,t=>{t.liked=!0,t.disliked=!1,t.feedbackModalOpen=!1}).addCase(Lu,t=>{t.liked=!1,t.disliked=!0}).addCase(Qu,t=>{t.feedbackModalOpen=!0}).addCase(Hr,t=>{t.feedbackModalOpen=!1}).addCase(xe.fulfilled,(t,r)=>{let n=r.payload.response.questionAnswer.relatedQuestions.map((i,s)=>Jw(i,t.relatedQuestions[s])),a=Nu(r.payload.response.questionAnswer);return t.questionAnswerId===a?{...t,relatedQuestions:n}:{...uo(),relatedQuestions:n,questionAnswerId:a}}).addCase(zu,(t,r)=>{let n=go(t.relatedQuestions,r.payload);n!==-1&&(t.relatedQuestions[n].expanded=!0)}).addCase(Bu,(t,r)=>{let n=go(t.relatedQuestions,r.payload);n!==-1&&(t.relatedQuestions[n].expanded=!1)}));function Zw(e,t){return e.raw[t.collection]}function Ya(e,t){return e.raw[t.parent]}function Zt(e,t){let r=e.raw[t.child];return Qg(r)?r[0]:r}function Xw(e,t){return(e||t)!==void 0&&e===t}function Hu(e,t,r,n=[]){let a=Zt(e,r);return a?n.indexOf(a)!==-1?[]:t.filter(i=>{let s=Zt(i,r)===Zt(e,r);return Ya(i,r)===a&&!s}).map(i=>({result:i,children:Hu(i,t,r,[...n,a])})):[]}function eb(e,t){return e.find(r=>{let n=Ya(r,t)===void 0,a=Xw(Ya(r,t),Zt(r,t));return n||a})}function Gu(e){return e.parentResult?Gu(e.parentResult):e}function tb(e,t,r){let n=Qc(e),a=r??eb(n,t)??Gu(e);return{result:a,children:Hu(a,n,t),moreResultsAvailable:!0,isLoadingMoreResults:!1}}function Vr(e,t,r){let n={};return e.forEach(a=>{let i=Zw(a,t);i&&(!Zt(a,t)&&!a.parentResult||(n[i]=tb(a,t,r)))}),n}function po(e,t){if(!e.collections[t])throw new Error(`Missing collection ${t} from ${Object.keys(e.collections)}: Folding most probably in an invalid state...`);return e.collections[t]}var rb=ne(Ru(),e=>e.addCase(xe.fulfilled,(t,{payload:r})=>{t.collections=t.enabled?Vr(r.response.results,t.fields):{}}).addCase(Rl.fulfilled,(t,{payload:r})=>{t.collections=t.enabled?Vr(r.response.results,t.fields):{}}).addCase(Fl.fulfilled,(t,{payload:r})=>{t.collections=t.enabled?{...t.collections,...Vr(r.response.results,t.fields)}:{}}).addCase(Xi,(t,{payload:r})=>t.enabled?t:{enabled:!0,collections:{},fields:{collection:r.collectionField??t.fields.collection,parent:r.parentField??t.fields.parent,child:r.childField??t.fields.child},filterFieldRange:r.numberOfFoldedResults??t.filterFieldRange}).addCase(va.pending,(t,{meta:r})=>{let n=r.arg;po(t,n).isLoadingMoreResults=!0}).addCase(va.rejected,(t,{meta:r})=>{let n=r.arg;po(t,n).isLoadingMoreResults=!1}).addCase(va.fulfilled,(t,{payload:{collectionId:r,results:n,rootResult:a}})=>{let i=Vr(n,t.fields,a);if(!i||!i[r])throw new Error(`Unable to create collection ${r} from received results: ${JSON.stringify(n)}. Folding most probably in an invalid state... `);t.collections[r]=i[r],t.collections[r].moreResultsAvailable=!1}));function Ae(e){let t,r=new Map,n=()=>r.size===0,a=i=>{try{let s=JSON.stringify(i),o=t!==s;return t=s,o}catch(s){return console.warn('Could not detect if state has changed, check the controller "get state method"',s),!0}};return{subscribe(i){i();let s=Symbol(),o;return n()&&(t=JSON.stringify(this.state),o=e.subscribe(()=>{a(this.state)&&r.forEach(c=>c())})),r.set(s,i),()=>{r.delete(s),n()&&o&&o()}},get state(){return{}}}}le(e=>e.queryCorrection.correctedQuery!==""||e.wasCorrectedTo!=="",e=>e);var nb=(e,t)=>{var n;let r={...Lm(),...t,correctedQuery:(t==null?void 0:t.correctedQuery)||((n=t==null?void 0:t.corrections[0])==null?void 0:n.correctedQuery)||""};e.queryCorrection=r,e.wasCorrectedTo=r.correctedQuery};ne(Qm(),e=>{e.addCase(Pm,t=>{t.enableDidYouMean=!0}).addCase(Um,t=>{t.enableDidYouMean=!1}).addCase(Vm,t=>{t.automaticallyCorrectQuery=!0}).addCase(_m,t=>{t.automaticallyCorrectQuery=!1}).addCase(xe.pending,t=>{t.queryCorrection=ar(),t.wasAutomaticallyCorrected=!1,t.wasCorrectedTo=""}).addCase(xe.fulfilled,(t,r)=>{let{queryCorrection:n,queryCorrections:a}=r.payload.response;if(t.queryCorrectionMode==="legacy"){let i=a&&a[0]?a[0]:ar();t.queryCorrection=i}t.queryCorrectionMode==="next"&&nb(t,n),t.wasAutomaticallyCorrected=r.payload.automaticallyCorrected,t.originalQuery=r.payload.originalQuery}).addCase(Vt,(t,r)=>{t.wasCorrectedTo=r.payload}).addCase($m,(t,r)=>{t.queryCorrectionMode=r.payload})});var ab=()=>({actionCause:"breadcrumbFacet"});function Sa(e,t){let r=e[t];r&&(r.request.numberOfValues=r.initialNumberOfValues,r.request.currentValues=[],r.request.preventAutoSelect=!0)}function fo(e,t,r){e.currentValues=ib(t,r),e.numberOfValues=t.length?1:r,e.preventAutoSelect=!0}function ib(e,t){if(!e.length)return[];let r=ho(e[0],t),n=r;for(let a of e.splice(1)){let i=ho(a,t);n.children.push(i),n=i}return n.state="selected",n.retrieveChildren=!0,[r]}function ho(e,t){return{value:e,retrieveCount:t,children:[],state:"idle",retrieveChildren:!1}}var sb=ne(vi(),e=>{e.addCase(ru,(t,r)=>{let n=r.payload,{facetId:a}=n;if(a in t)return;let i=lb(n),s=i.numberOfValues;t[a]={request:i,initialNumberOfValues:s}}).addCase(De.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.categoryFacetSet)??t}).addCase(He,(t,r)=>{let n=r.payload.cf||{};Object.keys(t).forEach(a=>{let i=t[a].request,s=n[a]||[];(s.length||i.currentValues.length)&&fo(i,s,t[a].initialNumberOfValues)})}).addCase(WS,(t,r)=>{var s;let{facetId:n,criterion:a}=r.payload,i=(s=t[n])==null?void 0:s.request;i&&(i.sortCriteria=a)}).addCase(KS,(t,r)=>{var s;let{facetId:n,basePath:a}=r.payload,i=(s=t[n])==null?void 0:s.request;i&&(i.basePath=[...a])}).addCase(nu,(t,r)=>{var d;let{facetId:n,selection:a,retrieveCount:i}=r.payload,s=(d=t[n])==null?void 0:d.request;if(!s)return;let{path:o}=a,c=o.slice(0,o.length-1),l=cb(s,c,i);if(l.length){let g=l[0];g.retrieveChildren=!0,g.state="selected",g.children=[];return}let u=Yu(a.value,i);u.state="selected",l.push(u),s.numberOfValues=1}).addCase(Li,(t,r)=>{let n=r.payload;Sa(t,n)}).addCase(tt,t=>{Object.keys(t).forEach(r=>Sa(t,r))}).addCase(dr,(t,r)=>Object.keys(t).forEach(n=>{t[n].request.preventAutoSelect=!r.payload.allow})).addCase(YS,(t,r)=>{var s;let{facetId:n,numberOfValues:a}=r.payload,i=(s=t[n])==null?void 0:s.request;if(i){if(!i.currentValues.length)return bu(i,a);ub(t,r.payload)}}).addCase(au,(t,r)=>{let{facetId:n,value:a}=r.payload,i=t[n];if(!i)return;let s=[...a.path,a.rawValue];fo(i.request,s,i.initialNumberOfValues)}).addCase(Dl.fulfilled,(t,r)=>{yo(t,r.payload.response.facets)}).addCase(xe.fulfilled,(t,r)=>{yo(t,r.payload.response.facets)}).addCase(We,(t,r)=>{Sa(t,r.payload)})}),ob={delimitingCharacter:";",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:5,sortCriteria:"occurrences",basePath:[],filterByBasePath:!0,resultsMustMatch:"atLeastOneValue"};function cb(e,t,r){let n=e.currentValues;for(let a of t){let i=n[0];(!i||a!==i.value)&&(i=Yu(a,r),n.length=0,n.push(i)),i.retrieveChildren=!1,i.state="idle",n=i.children}return n}function lb(e){return{...ob,currentValues:[],preventAutoSelect:!1,type:"hierarchical",...e}}function Yu(e,t){return{value:e,state:"idle",children:[],retrieveChildren:!0,retrieveCount:t}}function yo(e,t){t.forEach(r=>{var s;if(!db(e,r))return;let n=r.facetId,a=(s=e[n])==null?void 0:s.request;if(!a)return;let i=gb(a,r);a.currentValues=i?[]:a.currentValues,a.preventAutoSelect=!1})}function ub(e,t){var i;let{facetId:r,numberOfValues:n}=t,a=(i=e[r])==null?void 0:i.request.currentValues[0];if(a){for(;a.children.length&&(a==null?void 0:a.state)!=="selected";)a=a.children[0];a.retrieveCount=n}}function db(e,t){return t.facetId in e}function gb(e,t){let r=on(e.currentValues),n=on(t.values);return r.length!==n.length}var rs=()=>({actionCause:"facetUpdateSort"}),Rr=()=>({actionCause:"facetClearAll"}),zn=()=>({actionCause:"facetSelect"}),Wu=()=>({actionCause:"facetDeselect"}),mo=()=>({actionCause:"breadcrumbFacet"}),pb=()=>({actionCause:"showLessFacetResults"}),fb=()=>({actionCause:"showMoreFacetResults"}),ns=ne(bi(),e=>{e.addCase(Bi,(t,r)=>{let{facetId:n}=r.payload;n in t||(t[n]=_y(hb(r.payload)))}).addCase(De.fulfilled,(t,r)=>{if(r.payload&&Object.keys(r.payload.facetSet).length!==0)return r.payload.facetSet}).addCase(He,(t,r)=>{let n=r.payload.f||{},a=r.payload.fExcluded||{};Object.keys(t).forEach(i=>{let{request:s}=t[i],o=n[i]||[],c=a[i]||[],l=o.length+c.length,u=s.currentValues.filter(d=>!o.includes(d.value)&&!c.includes(d.value));s.currentValues=[...o.map(vo),...c.map(So),...u.map(mb)],s.preventAutoSelect=l>0,s.numberOfValues=Math.max(l,s.numberOfValues)})}).addCase(Pn,(t,r)=>{var c;let{facetId:n,selection:a}=r.payload,i=(c=t[n])==null?void 0:c.request;if(!i)return;i.preventAutoSelect=!0;let s=i.currentValues.find(l=>l.value===a.value);if(!s){$r(i,a);return}let o=s.state==="selected";s.state=o?"idle":"selected",i.freezeCurrentValues=!0}).addCase(Un,(t,r)=>{var c;let{facetId:n,selection:a}=r.payload,i=(c=t[n])==null?void 0:c.request;if(!i)return;i.preventAutoSelect=!0;let s=i.currentValues.find(l=>l.value===a.value);if(!s){$r(i,a);return}let o=s.state==="excluded";s.state=o?"idle":"excluded",i.freezeCurrentValues=!0}).addCase(dn,(t,r)=>{var s;let{facetId:n,freezeCurrentValues:a}=r.payload,i=(s=t[n])==null?void 0:s.request;i&&(i.freezeCurrentValues=a)}).addCase(Be,(t,r)=>{var n;_r((n=t[r.payload])==null?void 0:n.request)}).addCase(tt,t=>{Object.values(t).filter(r=>r.hasBreadcrumbs).forEach(({request:r})=>_r(r))}).addCase(Fn,t=>{Object.values(t).filter(r=>!r.hasBreadcrumbs).forEach(({request:r})=>_r(r))}).addCase(dr,(t,r)=>Object.values(t).forEach(n=>{n.request.preventAutoSelect=!r.payload.allow})).addCase(gu,(t,r)=>{Ji(t,r.payload)}).addCase(Ha,(t,r)=>{var i;let{facetId:n,numberOfValues:a}=r.payload;bu((i=t[n])==null?void 0:i.request,a)}).addCase(Ga,(t,r)=>{var s;let{facetId:n,isFieldExpanded:a}=r.payload,i=(s=t[n])==null?void 0:s.request;i&&(i.isFieldExpanded=a)}).addCase(xe.fulfilled,(t,r)=>{r.payload.response.facets.forEach(n=>{var a;return wa((a=t[n.facetId])==null?void 0:a.request,n)})}).addCase(_n.fulfilled,(t,r)=>{var n,a;(((a=(n=r.payload.response)==null?void 0:n.facets)==null?void 0:a.results)||[]).forEach(i=>{var s;return wa((s=t[i.facetId])==null?void 0:s.request,i)})}).addCase(Dl.fulfilled,(t,r)=>{r.payload.response.facets.forEach(n=>{var a;return wa((a=t[n.facetId])==null?void 0:a.request,n)})}).addCase(ou,(t,r)=>{var u;let{facetId:n,value:a}=r.payload,i=(u=t[n])==null?void 0:u.request;if(!i)return;let{rawValue:s}=a,{currentValues:o}=i,c=o.find(d=>d.value===s);if(c){c.state="selected";return}let l=vo(s);$r(i,l),i.freezeCurrentValues=!0,i.preventAutoSelect=!0}).addCase(cu,(t,r)=>{var u;let{facetId:n,value:a}=r.payload,i=(u=t[n])==null?void 0:u.request;if(!i)return;let{rawValue:s}=a,{currentValues:o}=i,c=o.find(d=>d.value===s);if(c){c.state="excluded";return}let l=So(s);$r(i,l),i.freezeCurrentValues=!0,i.preventAutoSelect=!0}).addCase(We,(t,r)=>{if(!(r.payload in t))return;let{request:n}=t[r.payload];_r(n)})});function $r(e,t){let{currentValues:r}=e,n=r.findIndex(o=>o.state==="idle"),a=n===-1?r.length:n,i=r.slice(0,a),s=r.slice(a+1);e.currentValues=[...i,t,...s],e.numberOfValues=e.currentValues.length}function wa(e,t){e&&(e.currentValues=t.values.map(yb),e.freezeCurrentValues=!1,e.preventAutoSelect=!1)}var Ku={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"automatic",resultsMustMatch:"atLeastOneValue"};function hb(e){return{...Ku,type:"specific",currentValues:[],freezeCurrentValues:!1,isFieldExpanded:!1,preventAutoSelect:!1,...e}}function yb(e){let{value:t,state:r}=e;return{value:t,state:r}}function vo(e){return{value:e,state:"selected"}}function So(e){return{value:e,state:"excluded"}}function mb(e){return{...e,state:"idle"}}var vb=()=>({actionCause:"breadcrumbResetAll"}),wo=eu;function Sb(e,t){return!!t&&t.facetId in e.dateFacetSet}var Ju=(e,t)=>{let r=cr(e,t);if(Sb(e,r))return r},wb=(e,t)=>(Ju(e,t)||{values:[]}).values.filter(r=>r.state==="selected"),bb=(e,t)=>(Ju(e,t)||{values:[]}).values.filter(r=>r.state!=="idle"),bo=eu;function Cb(e,t){return!!t&&t.facetId in e.numericFacetSet}var Zu=(e,t)=>{let r=cr(e,t);if(Cb(e,r))return r},Ib=(e,t)=>(Zu(e,t)||{values:[]}).values.filter(r=>r.state!=="idle"),kb=(e,t)=>(Zu(e,t)||{values:[]}).values.filter(r=>r.state==="selected"),Bn=D,as=new T({options:{required:!0},values:{caption:be,expression:be,state:new x({constrainTo:["idle","selected","excluded"]})}}),Ab=new ie({required:!0,each:as});S("staticFilter/register",e=>I(e,{id:Bn,values:Ab}));var qb=S("staticFilter/toggleSelect",e=>I(e,{id:Bn,value:as})),Ob=S("staticFilter/toggleExclude",e=>I(e,{id:Bn,value:as}));S("staticFilter/deselectAllFilterValues",e=>I(e,Bn));var xb=()=>({actionCause:"staticFilterDeselect"}),ba=e=>Object.keys(e.facetSet).map(t=>{let r=e.facetValuesSelector(e.engine.state,t).map(n=>({value:n,deselect:()=>{n.state==="selected"?e.executeToggleSelect({facetId:t,selection:n}):n.state==="excluded"&&e.executeToggleExclude({facetId:t,selection:n})}}));return{facetId:t,field:e.facetSet[t].request.field,values:r}}).filter(t=>t.values.length);function Eb(e){let t=Ae(e),{dispatch:r}=e;return{...t,get state(){return{facetBreadcrumbs:[],categoryFacetBreadcrumbs:[],numericFacetBreadcrumbs:[],dateFacetBreadcrumbs:[],staticFilterBreadcrumbs:[],hasBreadcrumbs:!1}},deselectAll:()=>{r(tt())},deselectBreadcrumb(n){n.deselect()}}}function ak(e){Rb(e);let t=Eb(e),{dispatch:r}=e,n=()=>e.state,a=()=>{let f={engine:e,facetSet:n().facetSet,executeToggleSelect:({facetId:y,selection:p})=>{let v=no({facetId:y,facetValue:p.value});r(Pn({facetId:y,selection:p})),r(dn({facetId:y,freezeCurrentValues:!1})),r(ae({legacy:v,next:mo()}))},executeToggleExclude:({facetId:y,selection:p})=>{let v=no({facetId:y,facetValue:p.value});r(Un({facetId:y,selection:p})),r(dn({facetId:y,freezeCurrentValues:!1})),r(ae({legacy:v,next:mo()}))},facetValuesSelector:Ey};return ba(f)},i=()=>{let f={engine:e,facetSet:n().numericFacetSet,executeToggleSelect:y=>{r(qr(y)),r(ae({legacy:io(y),next:bo()}))},executeToggleExclude:y=>{r(Or(y)),r(ae({legacy:io(y),next:bo()}))},facetValuesSelector:Ib};return ba(f)},s=()=>{let f={engine:e,facetSet:n().dateFacetSet,executeToggleSelect:y=>{r(Ir(y)),r(ae({legacy:ao(y),next:wo()}))},executeToggleExclude:y=>{r(kr(y)),r(ae({legacy:ao(y),next:wo()}))},facetValuesSelector:bb};return ba(f)},o=f=>{let y=jy(n(),f);return{facetId:f,field:n().categoryFacetSet[f].request.field,path:y,deselect:()=>{r(Li(f)),r(ae({legacy:PS({categoryFacetPath:y.map(p=>p.value),categoryFacetId:f}),next:ab()}))}}},c=()=>Object.keys(n().categoryFacetSet).map(o).filter(f=>f.path.length),l=()=>{let f=n().staticFilterSet||{};return Object.values(f).map(u)},u=f=>{let{id:y,values:p}=f,v=p.filter(b=>b.state!=="idle").map(b=>d(y,b));return{id:y,values:v}},d=(f,y)=>({value:y,deselect:()=>{let{caption:p,expression:v}=y,b=Ew({staticFilterId:f,staticFilterValue:{caption:p,expression:v}});y.state==="selected"?r(qb({id:f,value:y})):y.state==="excluded"&&r(Ob({id:f,value:y})),r(ae({legacy:b,next:xb()}))}});function g(){return!![...a(),...i(),...s(),...c(),...l()].length}return{...t,get state(){return{facetBreadcrumbs:a(),categoryFacetBreadcrumbs:c(),numericFacetBreadcrumbs:i(),dateFacetBreadcrumbs:s(),staticFilterBreadcrumbs:l(),hasBreadcrumbs:g()}},deselectAll:()=>{t.deselectAll(),r(ae({legacy:VS(),next:vb()}))}}}function Rb(e){return e.addReducers({configuration:Ee,search:fe,facetSet:ns,numericFacetSet:Vn,dateFacetSet:Er,categoryFacetSet:sb}),!0}var Fb=()=>et("analytics/searchbox/submit",e=>e.makeSearchboxSubmit()),Db=()=>et("analytics/pager/resize",(e,t)=>{var r;return e.makePagerResize({currentResultsPerPage:((r=t.pagination)==null?void 0:r.numberOfResults)||qn().numberOfResults})}),Tb=()=>({actionCause:"pagerResize"}),Mb=()=>({actionCause:"pagerNext"}),jb=()=>({actionCause:"pagerPrevious"}),Pb=()=>({actionCause:"pagerNumber"}),Ub=()=>_("searchboxSubmit")("analytics/searchbox/submit",(e,t)=>e.logSearchboxSubmit(U(t.insightCaseContext))),_b=Object.getOwnPropertyNames,Vb=Object.getOwnPropertySymbols,$b=Object.prototype.hasOwnProperty;function Co(e,t){return function(r,n,a){return e(r,n,a)&&t(r,n,a)}}function Lr(e){return function(t,r,n){if(!t||!r||typeof t!="object"||typeof r!="object")return e(t,r,n);var a=n.cache,i=a.get(t),s=a.get(r);if(i&&s)return i===r&&s===t;a.set(t,r),a.set(r,t);var o=e(t,r,n);return a.delete(t),a.delete(r),o}}function Io(e){return _b(e).concat(Vb(e))}var Xu=Object.hasOwn||function(e,t){return $b.call(e,t)};function zt(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var ed="_owner",ko=Object.getOwnPropertyDescriptor,Ao=Object.keys;function Lb(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function Qb(e,t){return zt(e.getTime(),t.getTime())}function qo(e,t,r){if(e.size!==t.size)return!1;for(var n={},a=e.entries(),i=0,s,o;(s=a.next())&&!s.done;){for(var c=t.entries(),l=!1,u=0;(o=c.next())&&!o.done;){var d=s.value,g=d[0],f=d[1],y=o.value,p=y[0],v=y[1];!l&&!n[u]&&(l=r.equals(g,p,i,u,e,t,r)&&r.equals(f,v,g,p,e,t,r))&&(n[u]=!0),u++}if(!l)return!1;i++}return!0}function zb(e,t,r){var n=Ao(e),a=n.length;if(Ao(t).length!==a)return!1;for(var i;a-- >0;)if(i=n[a],i===ed&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!Xu(t,i)||!r.equals(e[i],t[i],i,i,e,t,r))return!1;return!0}function Yt(e,t,r){var n=Io(e),a=n.length;if(Io(t).length!==a)return!1;for(var i,s,o;a-- >0;)if(i=n[a],i===ed&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!Xu(t,i)||!r.equals(e[i],t[i],i,i,e,t,r)||(s=ko(e,i),o=ko(t,i),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function Bb(e,t){return zt(e.valueOf(),t.valueOf())}function Nb(e,t){return e.source===t.source&&e.flags===t.flags}function Oo(e,t,r){if(e.size!==t.size)return!1;for(var n={},a=e.values(),i,s;(i=a.next())&&!i.done;){for(var o=t.values(),c=!1,l=0;(s=o.next())&&!s.done;)!c&&!n[l]&&(c=r.equals(i.value,s.value,i.value,s.value,e,t,r))&&(n[l]=!0),l++;if(!c)return!1}return!0}function Hb(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}var Gb="[object Arguments]",Yb="[object Boolean]",Wb="[object Date]",Kb="[object Map]",Jb="[object Number]",Zb="[object Object]",Xb="[object RegExp]",eC="[object Set]",tC="[object String]",rC=Array.isArray,xo=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Eo=Object.assign,nC=Object.prototype.toString.call.bind(Object.prototype.toString);function aC(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areMapsEqual,a=e.areObjectsEqual,i=e.arePrimitiveWrappersEqual,s=e.areRegExpsEqual,o=e.areSetsEqual,c=e.areTypedArraysEqual;return function(l,u,d){if(l===u)return!0;if(l==null||u==null||typeof l!="object"||typeof u!="object")return l!==l&&u!==u;var g=l.constructor;if(g!==u.constructor)return!1;if(g===Object)return a(l,u,d);if(rC(l))return t(l,u,d);if(xo!=null&&xo(l))return c(l,u,d);if(g===Date)return r(l,u,d);if(g===RegExp)return s(l,u,d);if(g===Map)return n(l,u,d);if(g===Set)return o(l,u,d);var f=nC(l);return f===Wb?r(l,u,d):f===Xb?s(l,u,d):f===Kb?n(l,u,d):f===eC?o(l,u,d):f===Zb?typeof l.then!="function"&&typeof u.then!="function"&&a(l,u,d):f===Gb?a(l,u,d):f===Yb||f===Jb||f===tC?i(l,u,d):!1}}function iC(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?Yt:Lb,areDatesEqual:Qb,areMapsEqual:n?Co(qo,Yt):qo,areObjectsEqual:n?Yt:zb,arePrimitiveWrappersEqual:Bb,areRegExpsEqual:Nb,areSetsEqual:n?Co(Oo,Yt):Oo,areTypedArraysEqual:n?Yt:Hb};if(r&&(a=Eo({},a,r(a))),t){var i=Lr(a.areArraysEqual),s=Lr(a.areMapsEqual),o=Lr(a.areObjectsEqual),c=Lr(a.areSetsEqual);a=Eo({},a,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:o,areSetsEqual:c})}return a}function sC(e){return function(t,r,n,a,i,s,o){return e(t,r,o)}}function oC(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(o,c){var l=n(),u=l.cache,d=u===void 0?t?new WeakMap:void 0:u,g=l.meta;return r(o,c,{cache:d,equals:a,meta:g,strict:i})};if(t)return function(o,c){return r(o,c,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var s={cache:void 0,equals:a,meta:void 0,strict:i};return function(o,c){return r(o,c,s)}}rt();rt({strict:!0});rt({circular:!0});rt({circular:!0,strict:!0});rt({createInternalComparator:function(){return zt}});rt({strict:!0,createInternalComparator:function(){return zt}});rt({circular:!0,createInternalComparator:function(){return zt}});rt({circular:!0,createInternalComparator:function(){return zt},strict:!0});function rt(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,i=e.strict,s=i===void 0?!1:i,o=iC(e),c=aC(o),l=n?n(c):sC(c);return oC({circular:r,comparator:c,createState:a,equals:l,strict:s})}function cC(e,t){return e.length!==t.length?!1:e.every(r=>t.findIndex(n=>lC(r,n))!==-1)}var lC=rt({createCustomConfig:e=>({...e,areArraysEqual:cC})});new ye({parameters:new T({options:{required:!0},values:zl})});var Bt=ne(il(),e=>{e.addCase(we,(t,r)=>({...t,...r.payload})).addCase(xe.fulfilled,t=>{t.freezeFacetOrder=!1}).addCase(xe.rejected,t=>{t.freezeFacetOrder=!1}).addCase(De.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.facetOptions)??t}).addCase(ru,(t,r)=>{t.facets[r.payload.facetId]=Ht()}).addCase(Bi,(t,r)=>{t.facets[r.payload.facetId]=Ht()}).addCase(Cr,(t,r)=>{t.facets[r.payload.facetId]=Ht()}).addCase(Ar,(t,r)=>{t.facets[r.payload.facetId]=Ht()}).addCase(Qt,(t,r)=>{t.facets[r.payload].enabled=!0}).addCase(We,(t,r)=>{t.facets[r.payload].enabled=!1}).addCase(He,(t,r)=>{[...Object.keys(r.payload.f??{}),...Object.keys(r.payload.fExcluded??{}),...Object.keys(r.payload.cf??{}),...Object.keys(r.payload.nf??{}),...Object.keys(r.payload.df??{})].forEach(n=>{n in t||(t.facets[n]=Ht()),t.facets[n].enabled=!0})})}),Nn=(e,t)=>{var r;return((r=e.facetOptions.facets[t])==null?void 0:r.enabled)??!0},td=e=>uC(e.cartItems,e.cart);function uC(e,t){let r=e.reduce((n,a)=>{let{productId:i,quantity:s}=t[a];return i in n||(n[i]={productId:i,quantity:0}),n[i].quantity+=s,n},{});return[...Object.values(r)]}new T({options:{required:!1},values:{by:new St({enum:Yi,required:!0}),fields:new ie({each:new T({values:{field:new x({required:!0}),direction:new St({enum:Wi}),displayName:new x}})})}});var Ot=async e=>({...await dC(e),facets:pC(e),...e.commerceSort&&{sort:fC(e.commerceSort.appliedSort)}}),dC=async(e,t)=>{let{view:r,user:n,...a}=e.commerceContext;return{accessToken:e.configuration.accessToken,url:e.configuration.platformUrl,organizationId:e.configuration.organizationId,trackingId:e.configuration.analytics.trackingId,...a,clientId:await Je(e.configuration.analytics),context:{user:n,view:r,cart:td(e.cart)},...gC(e,t)}},gC=(e,t)=>{var n,a;let r=t?(n=e.commercePagination)==null?void 0:n.recommendations[t]:(a=e.commercePagination)==null?void 0:a.principal;return r&&{page:r.page,...r.perPage&&{perPage:r.perPage}}};function pC(e){return!e.facetOrder||!e.commerceFacetSet?[]:e.facetOrder.map(t=>e.commerceFacetSet[t].request).filter(t=>t.values.length>0)}function fC(e){return e.by==="relevance"?{sortCriteria:"relevance"}:{sortCriteria:"fields",fields:e.fields.map(({name:t,direction:r})=>({field:t,direction:r}))}}var hC=async(e,t,r)=>{var A,j;let n=`*${t.categoryFacetSearchSet[e].options.query}*`,a=(A=t.commerceFacetSet[e])==null?void 0:A.request,i=a&&yC(a)?a&&mC(a):[],s=i.length?[i]:[],o=(j=t.commerceQuery)==null?void 0:j.query,{url:c,accessToken:l,organizationId:u,trackingId:d,language:g,country:f,currency:y,clientId:p,context:v,...b}=await Ot(t);return{url:c,accessToken:l,organizationId:u,facetId:e,facetQuery:n,ignorePaths:s,trackingId:d,language:g,country:f,currency:y,clientId:p,context:v,...b,query:o}};function yC(e){return e.type==="hierarchical"}var mC=e=>{let t=[],r=e.values[0];for(;r;)t.push(r.value),r=r.children[0];return t},vC=async(e,t,r)=>{var p;let n=`*${t.facetSearchSet[e].options.query}*`,a=(p=t.commerceQuery)==null?void 0:p.query;a===void 0&&(a="");let{url:i,accessToken:s,organizationId:o,trackingId:c,language:l,country:u,currency:d,clientId:g,context:f,...y}=await Ot(t);return{url:i,accessToken:s,organizationId:o,facetId:e,facetQuery:n,trackingId:c,language:l,country:u,currency:d,clientId:g,context:f,...y,query:a}},rd=e=>async(t,{getState:r,extra:{apiClient:n,validatePayload:a}})=>{let i=r();a(t,D);let s=SC(i,t)||wC(i,t)?vC(t,i):hC(t,i),o=await n.facetSearch(await s);return{facetId:t,response:o}},Ft=V("commerce/facetSearch/executeSearch",rd()),Dt=V("commerce/facetSearch/facetFieldSuggest",rd()),SC=(e,t)=>"facetSearchSet"in e&&e.facetSearchSet[t]!==void 0&&e.commerceFacetSet[t]!==void 0,wC=(e,t)=>"fieldSuggestionsOrder"in e?e.fieldSuggestionsOrder.some(r=>r.facetId===t&&r.type==="regular"):!1,nd=le(e=>{var t;return((t=e.commercePagination)==null?void 0:t.principal.perPage)||0},e=>e);le((e,t)=>{var r,n;return((n=(r=e.commercePagination)==null?void 0:r.recommendations[t])==null?void 0:n.perPage)||0},e=>e);var ad=le(e=>{var t;return((t=e.commercePagination)==null?void 0:t.principal.totalEntries)||0},e=>e);le((e,t)=>{var r,n;return((n=(r=e.commercePagination)==null?void 0:r.recommendations[t])==null?void 0:n.totalEntries)||0},e=>e);le(e=>{var t;return((t=e.commercePagination)==null?void 0:t.principal.page)||0},e=>e);le((e,t)=>{var r,n;return((n=(r=e.commercePagination)==null?void 0:r.recommendations[t])==null?void 0:n.page)||0},e=>e);le(e=>e.productListing.responseId,e=>e);le(e=>e.productListing.requestId,e=>e);var id=le(e=>{var t;return((t=e.productListing)==null?void 0:t.products.length)||0},e=>e),bC=le(e=>({total:ad(e),current:id(e)}),({current:e,total:t})=>e<t);le(e=>{var t;return(t=e.productListing)==null?void 0:t.isLoading},e=>z(e)?!1:e);le(e=>{var t;return(t=e.productListing)==null?void 0:t.error},e=>e);var sd=V("commerce/productListing/fetch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t(),{apiClient:s}=a,o=await s.getProductListing(await Ot(i));return qt(o)?(r(Le(o.error)),n(o.error)):{response:o.success}});V("commerce/productListing/fetchMoreProducts",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t();if(!bC(i))return null;let{apiClient:s}=a,o=nd(i),c=id(i)/o,l=await s.getProductListing({...await Ot(i),page:c});return qt(l)?(r(Le(l.error)),n(l.error)):{response:l.success}});var Xt=V("commerce/querySuggest/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:a}})=>{a(e,$t);let i=t(),s=await CC(e.id,i),o=await n.querySuggest(s);return qt(o)?r(o.error):{id:e.id,query:s.query,...o.success}}),CC=async(e,t)=>{let{view:r,user:n,...a}=t.commerceContext;return{accessToken:t.configuration.accessToken,url:t.configuration.platformUrl,organizationId:t.configuration.organizationId,trackingId:t.configuration.analytics.trackingId,query:t.querySet[e],...a,clientId:await Je(t.configuration.analytics),context:{user:n,view:r,cart:td(t.cart)}}},IC=S("query/updateQuery",e=>I(e,{query:new x}));le(e=>e.commerceSearch.responseId,e=>e);le(e=>e.commerceSearch.requestId,e=>e);var od=le(e=>{var t;return((t=e.commerceSearch)==null?void 0:t.products.length)||0},e=>e),kC=le(e=>({total:ad(e),current:od(e)}),({current:e,total:t})=>e<t);le(e=>{var t;return(t=e.commerceSearch)==null?void 0:t.isLoading},e=>z(e)?!1:e);le(e=>{var t;return(t=e.commerceSearch)==null?void 0:t.error},e=>e);var is=le(e=>{var t;return(t=e.commerceQuery)==null?void 0:t.query},e=>e??"");le(e=>{var t;return(t=e.commerceSearch)==null?void 0:t.queryExecuted},e=>e);var cd=(e,t)=>{var r,n;return((r=t.queryCorrection)==null?void 0:r.correctedQuery)!==void 0?(n=t.queryCorrection)==null?void 0:n.correctedQuery:is(e)},ld=V("commerce/search/executeSearch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t(),{apiClient:s}=a,o=is(i),c=await s.search({...await Ot(i),query:o});return qt(c)?(r(Le(c.error)),n(c.error)):{response:c.success,originalQuery:o,queryExecuted:cd(i,c.success)}});V("commerce/search/fetchMoreProducts",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t();if(!kC(i))return null;let{apiClient:s}=a,o=nd(i),c=od(i)/o,l=is(i),u=await s.search({...await Ot(i),query:l,page:c});return qt(u)?(r(Le(u.error)),n(u.error)):{response:u.success,originalQuery:l,queryExecuted:cd(i,u.success)}});V("commerce/search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;I(e,{query:new x,clearFilters:new J}),e.clearFilters&&(r(tt()),r(Fn())),r(dr({allow:!0})),r(IC({query:e.query})),r(gr(1))});V("commerce/search/fetchInstantProducts",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:a})=>{let i=t(),{q:s}=e,{apiClient:o}=a,c=await o.productSuggestions({...await Ot(i),query:s});if(qt(c))return r(Le(c.error)),n(c.error);let l=c.success.products.slice(0,5);return{response:{...c.success,products:l}}});function ss(e,t,r){let{facetId:n}=t;if(e[n])return;let a=!1,i={...Ct,...t},s=r();e[n]={options:i,isLoading:a,response:s,initialNumberOfValues:i.numberOfValues,requestId:""}}function ud(e,t){let{facetId:r,...n}=t,a=e[r];a&&(a.options={...a.options,...n})}function Tt(e,t,r){let n=e[t];n&&(n.requestId=r,n.isLoading=!0)}function Mt(e,t){let r=e[t];r&&(r.isLoading=!1)}function dd(e,t,r){let{facetId:n,response:a}=t,i=e[n];i&&i.requestId===r&&(i.isLoading=!1,i.response=a)}function gd(e,t,r){let{facetId:n,response:a}=t,i=e[n];i&&i.requestId===r&&(i.isLoading=!1,"success"in a&&(i.response=a.success))}function pd(e,t,r,n){let{facetId:a,response:i}=t,s=e[a];if(!s)ss(e,{facetId:a},n),s=e[a];else if(s.requestId!==r)return;s.isLoading=!1,"success"in i&&(s.response=i.success)}function AC(e,t,r,n){if(t.fieldSuggestionsFacets)for(let a of t.fieldSuggestionsFacets)a.facetId in e||a.type!=="regular"||(e[a.facetId]={options:{...Ct,query:t.query??""},isLoading:!1,response:n(),initialNumberOfValues:Ct.numberOfValues,requestId:r})}function qC(e,t,r,n){if(t.fieldSuggestionsFacets)for(let a of t.fieldSuggestionsFacets)a.facetId in e||a.type!=="hierarchical"||(e[a.facetId]={options:{...Ct,query:t.query??""},isLoading:!1,response:n(),initialNumberOfValues:Ct.numberOfValues,requestId:r})}function os(e,t,r){let{facetId:n}=t,a=e[n];a&&(a.requestId="",a.isLoading=!1,a.response=r(),a.options.numberOfValues=a.initialNumberOfValues,a.options.query=Ct.query)}function mt(e,t){Object.keys(e).forEach(r=>os(e,{facetId:r},t))}var Ct={captions:{},numberOfValues:10,query:""},OC=async(e,t,r)=>{let n=t.categoryFacetSearchSet[e].options,a=t.categoryFacetSet[e].request,{captions:i,query:s,numberOfValues:o}=n,{field:c,delimitingCharacter:l,basePath:u,filterFacetCount:d}=a,g=xC(a),f=g.length?[g]:[],y=`*${s}*`;return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")},basePath:u,captions:i,numberOfValues:o,query:y,field:c,delimitingCharacter:l,ignorePaths:f,filterFacetCount:d,type:"hierarchical",...r?{}:{searchContext:(await Fe(t)).request}}},xC=e=>{let t=[],r=e.currentValues[0];for(;r;)t.push(r.value),r=r.children[0];return t},EC=async(e,t,r)=>{let{captions:n,query:a,numberOfValues:i}=t.facetSearchSet[e].options,{field:s,currentValues:o,filterFacetCount:c}=t.facetSet[e].request,l=o.filter(d=>d.state!=="idle").map(d=>d.value),u=`*${a}*`;return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders&&{authentication:t.configuration.search.authenticationProviders.join(",")},captions:n,numberOfValues:i,query:u,field:s,ignoreValues:l,filterFacetCount:c,type:"specific",...r?{}:{searchContext:(await Fe(t)).request}}},fd=e=>async(t,{getState:r,extra:{apiClient:n,validatePayload:a}})=>{let i=r(),s;a(t,D),RC(i,t)?s=await EC(t,i,e):s=await OC(t,i,e);let o=await n.facetSearch(s);return{facetId:t,response:o}},jt=V("facetSearch/executeSearch",fd(!1));V("facetSearch/executeSearch",fd(!0));var hd=S("facetSearch/clearResults",e=>I(e,{facetId:Z})),RC=(e,t)=>e.facetSearchSet!==void 0&&e.facetSet!==void 0&&e.facetSet[t]!==void 0;function FC(){return{}}ne(FC(),e=>{e.addCase(ZS,(t,r)=>{let n=r.payload;ss(t,n,ht)}).addCase(su,(t,r)=>{ud(t,r.payload)}).addCase(Ft.pending,(t,r)=>{let n=r.meta.arg;Tt(t,n,r.meta.requestId)}).addCase(Dt.pending,(t,r)=>{let n=r.meta.arg;Tt(t,n,r.meta.requestId)}).addCase(jt.pending,(t,r)=>{let n=r.meta.arg;Tt(t,n,r.meta.requestId)}).addCase(Ft.rejected,(t,r)=>{let n=r.meta.arg;Mt(t,n)}).addCase(Dt.rejected,(t,r)=>{let n=r.meta.arg;Mt(t,n)}).addCase(jt.rejected,(t,r)=>{let n=r.meta.arg;Mt(t,n)}).addCase(Ft.fulfilled,(t,r)=>{gd(t,r.payload,r.meta.requestId)}).addCase(Dt.fulfilled,(t,r)=>{pd(t,r.payload,r.meta.requestId,ht)}).addCase(Xt.fulfilled,(t,r)=>{qC(t,r.payload,r.meta.requestId,ht)}).addCase(jt.fulfilled,(t,r)=>{dd(t,r.payload,r.meta.requestId)}).addCase(hd,(t,{payload:{facetId:r}})=>{os(t,{facetId:r},ht)}).addCase(sd.fulfilled,t=>mt(t,ht)).addCase(ld.fulfilled,t=>mt(t,ht)).addCase(xe.fulfilled,t=>{mt(t,ht)})});function ht(){return{moreValuesAvailable:!1,values:[]}}function DC(e,t){let{field:r,state:n}=e;if(!TC(e))return r;let a=`${r}_`,i=MC(a,n);return PC(r,t),`${a}${i}`}function TC(e){let{field:t,state:r}=e;return yd(r).some(n=>n&&t in n)}function MC(e,t){let r=yd(t).map(n=>Object.keys(n||{})).reduce((n,a)=>n.concat(a),[]);return jC(r,e)+1}function yd(e){let{facetSet:t,numericFacetSet:r,dateFacetSet:n,categoryFacetSet:a}=e;return[t,r,n,a]}function jC(e,t){return e.map(r=>{let n=r.split(t)[1],a=parseInt(n,10);return Number.isNaN(a)?0:a}).sort().pop()??0}function PC(e,t){let r=`A facet with field "${e}" already exists.
  To avoid unexpected behaviour, configure the #id option on the facet controller.`;t.warn(r)}function Fr(e,t){let{state:r,logger:n}=e,{field:a,facetId:i}=t;return i||DC({field:a,state:r},n)}var UC=["alphanumeric","occurrences"];new ye({field:Sr,basePath:tw,delimitingCharacter:rw,facetId:vr,facetSearch:zi,filterByBasePath:nw,filterFacetCount:wr,injectionDepth:br,numberOfValues:Lt,sortCriteria:new x({constrainTo:UC})});var _C=Intl.supportedValuesOf("currency"),VC=new x({required:!0,emptyAllowed:!1,constrainTo:_C}),md={url:D,referrer:Mp},vd={userId:te,email:te,userIp:te,userAgent:te};new T({options:{required:!0},values:{productId:te,sku:te,name:te,price:te,quantity:te}});var $C={language:D,country:D,currency:VC,user:new T({values:vd}),view:new T({options:{required:!0},values:md})};S("commerce/setContext",e=>I(e,$C));S("commerce/setUser",e=>z(e.userId)&&z(e.email)?{payload:e,error:dt(new hn("Either userId or email is required"))}:I(e,vd));var LC=S("commerce/setView",e=>I(e,md));function QC(){return{}}var Sd=ne(QC(),e=>{e.addCase(XS,(t,r)=>{let n=r.payload;ss(t,n,at)}).addCase(su,(t,r)=>{ud(t,r.payload)}).addCase(Ft.pending,(t,r)=>{let n=r.meta.arg;Tt(t,n,r.meta.requestId)}).addCase(Dt.pending,(t,r)=>{let n=r.meta.arg;Tt(t,n,r.meta.requestId)}).addCase(jt.pending,(t,r)=>{let n=r.meta.arg;Tt(t,n,r.meta.requestId)}).addCase(Ft.rejected,(t,r)=>{let n=r.meta.arg;Mt(t,n)}).addCase(Dt.rejected,(t,r)=>{let n=r.meta.arg;Mt(t,n)}).addCase(jt.rejected,(t,r)=>{let n=r.meta.arg;Mt(t,n)}).addCase(Ft.fulfilled,(t,r)=>{gd(t,r.payload,r.meta.requestId)}).addCase(Dt.fulfilled,(t,r)=>{pd(t,r.payload,r.meta.requestId,at)}).addCase(Xt.fulfilled,(t,r)=>{AC(t,r.payload,r.meta.requestId,at)}).addCase(jt.fulfilled,(t,r)=>{dd(t,r.payload,r.meta.requestId)}).addCase(hd,(t,{payload:r})=>{os(t,r,at)}).addCase(xe.fulfilled,t=>{mt(t,at)}).addCase(sd.fulfilled,t=>mt(t,at)).addCase(ld.fulfilled,t=>mt(t,at)).addCase(LC,t=>mt(t,at))});function at(){return{moreValuesAvailable:!1,values:[]}}var zC=e=>e.state==="selected",BC=(e,t)=>{let r={facetId:e,facetValue:t.value};return zC(t)?Xl(r):Tn(r)},wd=e=>e.state==="selected",NC=e=>e.state==="excluded",HC=e=>wd(e)?Wu():zn(),bd={facetId:Z,selection:new T({values:jn})},GC=V("facet/executeToggleSelect",({facetId:e,selection:t},r)=>{let{dispatch:n,extra:{validatePayload:a}}=r;a({facetId:e,selection:t},bd),n(Pn({facetId:e,selection:t})),n(we())}),YC=V("facet/executeToggleExclude",({facetId:e,selection:t},r)=>{let{dispatch:n,extra:{validatePayload:a}}=r;a({facetId:e,selection:t},bd),n(Un({facetId:e,selection:t})),n(we())}),cs=["allValues","atLeastOneValue"],Cd=["score","alphanumeric","alphanumericDescending","occurrences","automatic"],WC=new ye({facetId:vr,field:Sr,filterFacetCount:wr,injectionDepth:br,numberOfValues:Lt,sortCriteria:new x({constrainTo:Cd}),resultsMustMatch:new x({constrainTo:cs}),facetSearch:zi});function KC(e,t,r=WC){JC(e);let{dispatch:n}=e,a=Ae(e),i=Fr(e,t.options),s={...Ku,...Ng("facetSearch",t.options),field:t.options.field,facetId:i},o={facetSearch:{...Ct,...t.options.facetSearch},...s};gt(e,r,o,"buildFacet");let c=()=>Oy(e.state,i),l=()=>Tc(e.state,i),u=()=>In(e.state),d=()=>Nn(e.state,i),g=()=>{let{currentValues:y}=c();return y.filter(p=>p.state!=="idle").length},f=()=>{let{currentValues:y}=c(),p=o.numberOfValues,v=!!y.find(b=>b.state==="idle");return p<y.length&&v};return n(Bi(s)),{...a,toggleSelect:y=>n(GC({facetId:o.facetId,selection:y})),toggleExclude:y=>n(YC({facetId:o.facetId,selection:y})),toggleSingleSelect:function(y){y.state==="idle"&&n(Be(i)),this.toggleSelect(y)},toggleSingleExclude:function(y){y.state==="idle"&&n(Be(i)),this.toggleExclude(y)},isValueSelected:wd,isValueExcluded:NC,deselectAll(){n(Be(i)),n(we())},sortBy(y){n(gu({facetId:i,criterion:y})),n(we())},isSortedBy(y){return this.state.sortCriterion===y},showMoreValues(){let y=c().numberOfValues,p=o.numberOfValues,v=p-y%p,b=y+v;n(Ha({facetId:i,numberOfValues:b})),n(Ga({facetId:i,isFieldExpanded:!0})),n(we())},showLessValues(){let y=o.numberOfValues,p=Math.max(y,g());n(Ha({facetId:i,numberOfValues:p})),n(Ga({facetId:i,isFieldExpanded:!1})),n(we())},enable(){n(Qt(i))},disable(){n(We(i))},get state(){let y=c(),p=l(),v=u(),b=d(),A;typeof y.sortCriteria=="object"?A=y.sortCriteria.order==="descending"?"alphanumericDescending":"alphanumeric":A=y.sortCriteria;let j=p?p.values:[],N=j.some(Q=>Q.state!=="idle"),$=p?p.moreValuesAvailable:!1,Y=y.resultsMustMatch;return{label:p==null?void 0:p.label,facetId:i,values:j,sortCriterion:A,resultsMustMatch:Y,isLoading:v,hasActiveValues:N,canShowMoreValues:$,canShowLessValues:f(),enabled:b}}}}function JC(e){return e.addReducers({facetSet:ns,facetOptions:Bt,configuration:Ee,facetSearchSet:Sd}),!0}var ZC=new ye({facetId:vr,field:Sr,filterFacetCount:wr,injectionDepth:br,numberOfValues:Lt,sortCriteria:new x({constrainTo:Cd}),resultsMustMatch:new x({constrainTo:cs}),facetSearch:zi,allowedValues:uu,customSort:du});function ik(e,t){XC(e);let{dispatch:r}=e,n=KC(e,{...t,options:{...t.options,...t.options.allowedValues&&{allowedValues:{type:"simple",values:t.options.allowedValues}}}},ZC),a=()=>n.state.facetId,i={updateText(){},showMoreResults(){},search(){},clear(){},updateCaptions(){},select(){},exclude(){},singleSelect(){},singleExclude(){},get state(){return{values:[],isLoading:!1,moreValuesAvailable:!1,query:""}}},{state:s,...o}=i;return{...n,facetSearch:o,toggleSelect(c){n.toggleSelect(c),r(ae({legacy:BC(a(),c),next:HC(c)}))},deselectAll(){n.deselectAll(),r(ae({legacy:hr(a()),next:Rr()}))},sortBy(c){n.sortBy(c),r(ae({legacy:$i({facetId:a(),sortCriterion:c}),next:rs()}))},isSortedBy(c){return this.state.sortCriterion===c},showMoreValues(){n.showMoreValues(),r(Ks({legacy:US(a()),next:fb()}))},showLessValues(){n.showLessValues(),r(Ks({legacy:_S(a()),next:pb()}))},get state(){return{...n.state,facetSearch:i.state}}}}function XC(e){return e.addReducers({facetSet:ns,configuration:Ee,facetSearchSet:Sd,search:fe}),!0}var ls=e=>e.state==="selected",e0=e=>e.state==="excluded",Id=e=>ls(e)?Wu():zn(),kd=(e,t)=>{let r=`${t.start}..${t.end}`,n={facetId:e,facetValue:r};return ls(t)?Xl(n):Tn(n)},Ad=S("rangeFacet/executeToggleSelect",e=>I(e,Mn(e.selection))),qd=S("rangeFacet/executeToggleExclude",e=>I(e,Mn(e.selection))),Od={facetId:Z,selection:new T({values:mr})},t0=V("dateFacet/executeToggleSelect",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,Od),t(Ir(e)),t(Ad(e)),t(we())}),r0=V("dateFacet/executeToggleExclude",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,Od),t(kr(e)),t(qd(e)),t(we())});function xd(e,t){let{facetId:r,getRequest:n}=t,a=Ae(e),i=e.dispatch,s=()=>Nn(e.state,r);return{...a,isValueSelected:ls,isValueExcluded:e0,deselectAll(){i(Be(r)),i(we())},sortBy(o){i(Ni({facetId:r,criterion:o})),i(we())},isSortedBy(o){return this.state.sortCriterion===o},enable(){i(Qt(r))},disable(){i(We(r))},get state(){let o=n(),c=cr(e.state,r),l=o.sortCriteria,u=o.resultsMustMatch,d=c?c.values:[],g=In(e.state),f=s(),y=d.some(p=>p.state!=="idle");return{facetId:r,values:d,sortCriterion:l,resultsMustMatch:u,hasActiveValues:y,isLoading:g,enabled:f}}}}function Ed(e,t){if(!e.generateAutomaticRanges&&e.currentValues===void 0){let r=`currentValues should be specified for ${t} when generateAutomaticRanges is false.`;throw new Error(r)}}var Rd=["idle","selected","excluded"],Fd=["ascending","descending"],Dd=["even","equiprobable"],n0={start:new x,end:new x,endInclusive:new J,state:new x({constrainTo:Rd})},a0=new ye({facetId:vr,field:Sr,generateAutomaticRanges:lu,filterFacetCount:wr,injectionDepth:br,numberOfValues:Lt,currentValues:new ie({each:new T({values:n0})}),sortCriteria:new x({constrainTo:Fd}),rangeAlgorithm:new x({constrainTo:Dd})});function Td(e,t){gt(e,a0,t,"buildDateFacet"),Hi(t)}function i0(e,t){s0(e),Ed(t.options,"buildDateFacet");let r=e.dispatch,n=Fr(e,t.options),a={currentValues:[],...t.options,facetId:n};Td(e,a),r(Cr(a));let i=xd(e,{facetId:n,getRequest:()=>e.state.dateFacetSet[n].request});return{...i,toggleSelect:s=>r(t0({facetId:n,selection:s})),toggleSingleSelect:function(s){s.state==="idle"&&r(Be(n)),this.toggleSelect(s)},toggleExclude:s=>r(r0({facetId:n,selection:s})),toggleSingleExclude:function(s){s.state==="idle"&&r(Be(n)),this.toggleExclude(s)},get state(){return i.state}}}function s0(e){return e.addReducers({configuration:Ee,search:fe,dateFacetSet:Er,facetOptions:Bt}),!0}function sk(e,t){let r=i0(e,t),n=e.dispatch,a=()=>r.state.facetId;return{...r,deselectAll(){r.deselectAll(),n(ae({legacy:hr(a()),next:Rr()}))},sortBy(i){r.sortBy(i),n(ae({legacy:$i({facetId:a(),sortCriterion:i}),next:rs()}))},toggleSelect:i=>{r.toggleSelect(i),n(ae({legacy:kd(a(),i),next:Id(i)}))},get state(){return r.state}}}var Md={facetId:Z,selection:new T({values:yr})},o0=V("numericFacet/executeToggleSelect",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,Md),t(qr(e)),t(Ad(e)),t(we())});V("numericFacet/executeToggleExclude",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,Md),t(Or(e)),t(qd(e)),t(we())});var c0={start:new B,end:new B,endInclusive:new J,state:new x({constrainTo:Rd})},l0=new ye({facetId:vr,field:Sr,generateAutomaticRanges:lu,filterFacetCount:wr,injectionDepth:br,numberOfValues:Lt,currentValues:new ie({each:new T({values:c0})}),sortCriteria:new x({constrainTo:Fd}),resultsMustMatch:new x({constrainTo:cs}),rangeAlgorithm:new x({constrainTo:Dd})});function jd(e,t){gt(e,l0,t,"buildNumericFacet"),Gi(t)}function ok(e){return{endInclusive:!1,state:"idle",...e}}function u0(e,t){d0(e),Ed(t.options,"buildNumericFacet");let r=e.dispatch,n=Fr(e,t.options),a={currentValues:[],...t.options,facetId:n};jd(e,a),r(Ar(a));let i=xd(e,{facetId:n,getRequest:()=>e.state.numericFacetSet[n].request});return{...i,toggleSelect:s=>r(o0({facetId:n,selection:s})),toggleSingleSelect(s){s.state==="idle"&&r(Be(n)),this.toggleSelect(s)},get state(){return i.state}}}function d0(e){return e.addReducers({numericFacetSet:Vn,facetOptions:Bt,configuration:Ee,search:fe}),!0}function ck(e,t){let r=u0(e,t),n=e.dispatch,a=()=>r.state.facetId;return{...r,deselectAll(){r.deselectAll(),n(ae({legacy:hr(a()),next:Rr()}))},sortBy(i){r.sortBy(i),n(ae({legacy:$i({facetId:a(),sortCriterion:i}),next:rs()}))},toggleSelect:i=>{r.toggleSelect(i),n(ae({legacy:kd(a(),i),next:Id(i)}))},get state(){return{...r.state}}}}function g0(e,t){var c;p0(e);let r=Ae(e),{dispatch:n}=e,a=()=>e.state,i=Fr(e,t.options),s={...t.options,currentValues:(c=t.initialState)!=null&&c.range?[{...t.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:i};jd(e,s),n(Ar(s));let o=()=>Nn(e.state,i);return{...r,clear:()=>{n(or({facetId:i,values:[]})),n(we())},setRange:l=>{let u={...l,state:"selected",numberOfResults:0,endInclusive:!0},d=or({facetId:i,values:[u]});return d.error?!1:(n(d),n(we()),!0)},enable(){n(Qt(i))},disable(){n(We(i))},get state(){let l=In(a()),u=o(),d=kb(a(),i),g=d.length?d[0]:void 0;return{facetId:i,isLoading:l,range:g,enabled:u}}}}function p0(e){return e.addReducers({numericFacetSet:Vn,facetOptions:Bt,configuration:Ee,search:fe}),!0}function lk(e,t){let r=g0(e,t),{dispatch:n}=e,a=()=>r.state.facetId;return{...r,clear:()=>{r.clear(),n(ae({legacy:hr(a()),next:Rr()}))},setRange:i=>{let s=r.setRange(i);return s&&n(ae({legacy:Tn({facetId:a(),facetValue:`${i.start}..${i.end}`}),next:zn()})),s},get state(){return{...r.state}}}}function f0(e,t){var c;h0(e);let r=Ae(e),{dispatch:n}=e,a=()=>e.state,i=Fr(e,t.options),s={...t.options,currentValues:(c=t.initialState)!=null&&c.range?[{...t.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:i};Td(e,s),n(Cr(s));let o=()=>Nn(e.state,i);return{...r,clear:()=>{n(sr({facetId:i,values:[]})),n(we())},setRange:l=>{let u={...l,state:"selected",numberOfResults:0,endInclusive:!0},d=sr({facetId:i,values:[u]});return d.error?!1:(n(d),n(we()),!0)},enable(){n(Qt(i))},disable(){n(We(i))},get state(){let l=In(a()),u=o(),d=wb(a(),i),g=d.length?d[0]:void 0;return{facetId:i,isLoading:l,range:g,enabled:u}}}}function h0(e){return e.addReducers({dateFacetSet:Er,facetOptions:Bt,configuration:Ee,search:fe}),!0}function uk(e,t){y0(e);let r=f0(e,t),{dispatch:n}=e,a=()=>r.state.facetId;return{...r,clear:()=>{r.clear(),n(ae({legacy:hr(a()),next:Rr()}))},setRange:i=>{let s=r.setRange(i);return s&&n(ae({legacy:Tn({facetId:a(),facetValue:`${i.start}..${i.end}`}),next:zn()})),s},get state(){return{...r.state}}}}function y0(e){return e.addReducers({dateFacetSet:Er,configuration:Ee,search:fe}),!0}var m0=new ye({numberOfPages:new B({default:5,min:0})}),v0=new ye({page:new B({min:1})});function S0(e,t={}){w0(e);let r=Ae(e),{dispatch:n}=e,a=gt(e,m0,t.options,"buildPager"),i=ii(e,v0,t.initialState,"buildPager").page;i&&n(wl(i));let s=()=>xr(e.state),o=()=>{let{numberOfPages:l}=a;return ww(e.state,l)},c=()=>wu(e.state);return{...r,get state(){let l=s(),u=c(),d=l>1&&u>0,g=l<u;return{currentPage:l,currentPages:o(),maxPage:u,hasPreviousPage:d,hasNextPage:g}},selectPage(l){n(gr(l))},nextPage(){n(bl())},previousPage(){n(Cl())},isCurrentPage(l){return l===this.state.currentPage}}}function w0(e){return e.addReducers({configuration:Ee,pagination:Ki}),!0}function dk(e,t={}){let{dispatch:r}=e,n=S0(e,t);return{...n,get state(){return n.state},selectPage(a){n.selectPage(a),r(sa({legacy:Aw(),next:Pb()}))},nextPage(){n.nextPage(),r(sa({legacy:qw(),next:Mb()}))},previousPage(){n.previousPage(),r(sa({legacy:Ow(),next:jb()}))}}}function us(e){b0(e);let t=Ae(e),r=()=>e.state;return{...t,get state(){let n=r();return{hasError:n.search.error!==null,isLoading:n.search.isLoading,hasResults:!!n.search.results.length,firstSearchExecuted:Ll(n)}}}}function b0(e){return e.addReducers({search:fe}),!0}function C0(e){I0(e);let t=Ae(e),r=us(e),n=()=>e.state,a=()=>{let i=n().search.duration/1e3;return Math.round((i+Number.EPSILON)*100)/100};return{...t,get state(){return{...r.state,durationInMilliseconds:n().search.duration,durationInSeconds:a(),firstResult:n().pagination.firstResult+1,hasDuration:n().search.duration!==0,hasQuery:n().search.queryExecuted!=="",lastResult:n().pagination.firstResult+n().search.results.length,query:n().search.queryExecuted,total:n().pagination.totalCountFiltered}}}}function I0(e){return e.addReducers({search:fe,pagination:Ki}),!0}function gk(e){return C0(e)}var k0=new ye({fieldsToInclude:new ie({required:!1,each:new x({required:!0,emptyAllowed:!1})})});function Pd(e,t){A0(e);let r=Ae(e),n=us(e),{dispatch:a}=e,i=()=>e.state,s=gt(e,k0,t==null?void 0:t.options,"buildCoreResultList");s.fieldsToInclude&&a(es(s.fieldsToInclude));let o=()=>e.state.search.results.length<e.state.search.response.totalCountFiltered,c=0,l=0,u=5,d=200,g=!1;return{...r,get state(){let f=i();return{...n.state,results:f.search.results,moreResultsAvailable:o(),searchResponseId:f.search.searchResponseId}},fetchMoreResults:async()=>{if(!e.state.search.isLoading){if(!o()){e.logger.info("No more results are available for the result list to fetch.");return}if(Date.now()-c<d){if(l++,l>=u){c=Date.now(),!g&&e.logger.error(`The result list method "fetchMoreResults" execution prevented because it has been triggered consecutively ${u} times, with little delay. Please verify the conditions under which the function is called.`),g=!0;return}}else l=0;g=!1,t!=null&&t.fetchMoreResultsActionCreator&&(await a(t==null?void 0:t.fetchMoreResultsActionCreator()),c=Date.now())}}}}function A0(e){return e.addReducers({search:fe,configuration:Ee,fields:Mu}),!0}function pk(e,t){return Pd(e,{...t,fetchMoreResultsActionCreator:hl})}var q0=e=>_("showMoreFoldedResults")("analytics/folding/showMore",(t,r)=>(Ei(e),t.logShowMoreFoldedResults(ct(e,r),bt(e),U(r.insightCaseContext)))),O0=()=>_("showLessFoldedResults")("analytics/folding/showLess",(e,t)=>e.logShowLessFoldedResults(U(t.insightCaseContext))),x0={logShowMoreFoldedResults:q0,logShowLessFoldedResults:O0};S("folding/register",e=>I(e,Zi));var E0=V("folding/loadCollection",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let a=t(),i=await Zm(a,e),s=(await sv(n,a,i,{origin:"foldingCollection"})).response;return pe(s)?r(s.error):{collectionId:e,results:s.success.results,rootResult:a.folding.collections[e].result}}),Ud=ne(Xe(),e=>e.addCase(At,(t,r)=>({...t,...r.payload})).addCase(Vt,(t,r)=>{t.q=r.payload}).addCase(Vi,(t,r)=>{t.q=r.payload.expression}).addCase(De.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.query)??t}).addCase(He,(t,r)=>{t.q=r.payload.q??t.q,t.enableQuerySyntax=r.payload.enableQuerySyntax??t.enableQuerySyntax})),R0=new ye(Zi);function F0(e,t,r){var o;D0(e);let n=Pd(e,t),{dispatch:a}=e,i=()=>e.state,s=(o=t.options)!=null&&o.folding?gt(e,R0,t.options.folding,"buildFoldedResultList"):{};return a(Xi({...s})),{...n,loadCollection:c=>{a(t.loadCollectionActionCreator(c.result.raw[e.state.folding.fields.collection])),a(r.logShowMoreFoldedResults(c.result))},logShowMoreFoldedResults:c=>{a(r.logShowMoreFoldedResults(c))},logShowLessFoldedResults:()=>{a(r.logShowLessFoldedResults())},findResultById(c){return Wa(this.state.results,l=>l.result.uniqueId===c.result.uniqueId)},findResultByCollection(c){return Wa(this.state.results,l=>l.result.raw.foldingcollection===c.result.raw.foldingcollection)},get state(){let c=i();return{...n.state,results:n.state.results.map(l=>{let u=l.raw[c.folding.fields.collection];return!u||!c.folding.collections[u]?{result:l,moreResultsAvailable:!1,isLoadingMoreResults:!1,children:[]}:c.folding.collections[u]})}}}}function D0(e){return e.addReducers({search:fe,configuration:Yl,folding:rb,query:Ud}),!0}function Wa(e,t){for(let r=0;r<e.length;r++){let n=e[r];if(t(n))return n;if(n.children.length){let a=Wa(n.children,t);if(a)return a}}return null}function fk(e,t={}){let r=F0(e,{...t,loadCollectionActionCreator:E0,fetchMoreResultsActionCreator:hl},x0);return{...r,get state(){return r.state}}}var T0=e=>_("documentOpen")({prefix:"analytics/insight/result/open",__legacy__getBuilder:(t,r)=>{Ei(e);let n=U(r.insightCaseContext);return t.logDocumentOpen(ct(e,r),bt(e),n)},analyticsType:"InsightPanel.ItemAction",analyticsPayloadBuilder:t=>{var n;let r=ct(e,t);return{itemMetadata:pm(e,t),position:r.documentPosition,searchUid:((n=t.search)==null?void 0:n.response.searchUid)||"",action:"open",context:xw(t)}}});function Dr(e,t,r){M0(e);let n=1e3,a={selectionDelay:n,debounceWait:n,...t.options},i;return{select:Wl(r,a.debounceWait,{isImmediate:!0}),beginDelayedSelect(){i=setTimeout(r,a.selectionDelay)},cancelPendingSelect(){i&&clearTimeout(i)}}}function M0(e){return e.addReducers({configuration:Ee}),!0}function hk(e,t){let r=!1,n=()=>{r||(r=!0,e.dispatch(T0(t.options.result)))};return Dr(e,t,()=>{n(),e.dispatch($n(t.options.result))})}var j0=new ye({numberOfResults:new B({min:0})});function P0(e,t={}){U0(e);let r=Ae(e),{dispatch:n}=e,a=()=>e.state,i=ii(e,j0,t.initialState,"buildResultsPerPage").numberOfResults;return i!==void 0&&n(vl(i)),{...r,get state(){return{numberOfResults:a().pagination.numberOfResults}},set(s){n(Sl(s))},isSetTo(s){return s===this.state.numberOfResults}}}function U0(e){return e.addReducers({pagination:Ki,configuration:Ee}),!0}function yk(e,t={}){let r=P0(e,t),{dispatch:n}=e;return{...r,get state(){return{...r.state}},set(a){r.set(a),n(ae({legacy:Db(),next:Tb()}))}}}var _0=e=>et("analytics/querySuggest",(t,r)=>{let n=$0(r,e);return t.makeOmniboxAnalytics(n)}),V0=()=>({actionCause:"omniboxAnalytics"});function $0(e,t){let{id:r,suggestion:n}=t,a=e.querySuggest&&e.querySuggest[r];if(!a)throw new Error(`Unable to determine the query suggest analytics metadata to send because no query suggest with id "${r}" was found. Please check the sent #id.`);let i=a.completions.map(l=>l.expression),s=a.partialQueries.length-1,o=a.partialQueries[s]||"",c=a.responseId;return{suggestionRanking:i.indexOf(n),partialQuery:o,partialQueries:a.partialQueries,suggestions:i,querySuggestResponseId:c}}var L0=()=>({}),Q0=ne(L0(),e=>e.addCase(_i,(t,r)=>{let n=r.payload.id;n in t||(t[n]=z0(r.payload))}).addCase(xS,(t,r)=>{delete t[r.payload.id]}).addCase(ha.pending,Ro).addCase(ha.fulfilled,(t,r)=>{let n=t[r.meta.arg.id];if(!n||r.meta.requestId!==n.currentRequestId)return;let{q:a}=r.payload;a&&n.partialQueries.push(a.replace(/;/,encodeURIComponent(";"))),n.responseId=r.payload.responseId,n.completions=r.payload.completions,n.isLoading=!1,n.error=null}).addCase(ha.rejected,Fo).addCase(Xt.pending,Ro).addCase(Xt.fulfilled,(t,r)=>{let n=t[r.meta.arg.id];if(!n||r.meta.requestId!==n.currentRequestId)return;let{query:a}=r.payload;a&&n.partialQueries.push(a.replace(/;/,encodeURIComponent(";"))),n.responseId=r.payload.responseId,n.completions=r.payload.completions.map(i=>({expression:i.expression,highlighted:i.highlighted,score:0,executableConfidence:0})),n.isLoading=!1,n.error=null}).addCase(Xt.rejected,Fo).addCase(Nr,(t,r)=>{let n=t[r.payload.id];n&&(n.responseId="",n.completions=[],n.partialQueries=[])}));function z0(e){return{id:"",completions:[],responseId:"",count:5,currentRequestId:"",error:null,partialQueries:[],isLoading:!1,...e}}function Ro(e,t){let r=e[t.meta.arg.id];r&&(r.currentRequestId=t.meta.requestId,r.isLoading=!0)}function Fo(e,t){let r=e[t.meta.arg.id];r&&(r.error=t.payload||null,r.isLoading=!1)}var B0={enableQuerySyntax:!1,numberOfSuggestions:5,clearFilters:!0},Ca={open:new x,close:new x},N0={id:D,numberOfSuggestions:new B({min:0}),enableQuerySyntax:new J,highlightOptions:new T({values:{notMatchDelimiters:new T({values:Ca}),exactMatchDelimiters:new T({values:Ca}),correctionDelimiters:new T({values:Ca})}}),clearFilters:new J},H0=new ye(N0);function G0(e,t){var l,u;W0(e);let r=Ae(e),{dispatch:n}=e,a=()=>e.state,i=((l=t.options)==null?void 0:l.id)||Lo("search_box"),s={id:i,highlightOptions:{...(u=t.options)==null?void 0:u.highlightOptions},...B0,...t.options};gt(e,H0,s,"buildSearchBox"),n(Jl({id:i,query:e.state.query.q})),s.numberOfSuggestions&&n(_i({id:i,count:s.numberOfSuggestions}));let o=()=>e.state.querySet[s.id],c=async d=>{let{enableQuerySyntax:g,clearFilters:f}=s;n(qv({q:o(),enableQuerySyntax:g,clearFilters:f})),t.isNextAnalyticsReady?n(t.executeSearchActionCreator(d)):n(t.executeSearchActionCreator(d.legacy))};return{...r,updateText(d){n(Na({id:i,query:d})),this.showSuggestions()},clear(){n(Na({id:i,query:""})),n(Nr({id:i}))},showSuggestions(){s.numberOfSuggestions&&n(t.fetchQuerySuggestionsActionCreator({id:i}))},selectSuggestion(d){n(Vi({id:i,expression:d})),c({legacy:_0({id:i,suggestion:d}),next:V0()}).then(()=>{n(Nr({id:i}))})},submit(d=Fb(),g){c({legacy:d,next:g}),n(Nr({id:i}))},get state(){let d=a(),g=d.querySuggest[s.id],f=Y0(g,s.highlightOptions),y=g?g.isLoading:!1;return{value:o(),suggestions:f,isLoading:d.search.isLoading,isLoadingSuggestions:y}}}}function Y0(e,t){return e?e.completions.map(r=>({highlightedValue:zo(r.highlighted,t),rawValue:r.expression})):[]}function W0(e){return e.addReducers({query:Ud,querySuggest:Q0,configuration:Ee,querySet:TS,search:fe}),!0}function mk(e,t={}){let r=G0(e,{...t,executeSearchActionCreator:ae,fetchQuerySuggestionsActionCreator:yl,isNextAnalyticsReady:!0});return{...r,submit(){r.submit(Ub())},get state(){return r.state}}}function vk(e){return us(e)}var Do={by:new St({enum:Ai,required:!0})},K0=S("sortCriteria/register",e=>_d(e)),J0=S("sortCriteria/update",e=>_d(e)),_d=e=>$o(e)?(e.forEach(t=>I(t,Do)),{payload:e}):I(e,Do);ne(qi(),e=>{e.addCase(K0,(t,r)=>cn(r.payload)).addCase(J0,(t,r)=>cn(r.payload)).addCase(De.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.sortCriteria)??t}).addCase(He,(t,r)=>r.payload.sortCriteria??t)});var Z0=ne(ol(),e=>{e.addCase(Bl,(t,r)=>{let n=r.payload,{id:a}=n;a in t||(t[a]={...n,isActive:!1})}).addCase(ir,(t,r)=>{let n=r.payload;To(t,n)}).addCase(He,(t,r)=>{let n=r.payload.tab||"";To(t,n)}).addCase(De.fulfilled,(t,r)=>{var n;return((n=r.payload)==null?void 0:n.tabSet)??t})});function To(e,t){t in e&&Object.keys(e).forEach(r=>{e[r].isActive=r===t})}var X0=new ye({expression:be,id:D}),eI=new ye({isActive:new J});function tI(e,t){nI(t.options.id),rI(e);let r=Ae(e),{dispatch:n}=e;gt(e,X0,t.options,"buildTab");let a=ii(e,eI,t.initialState,"buildTab"),{id:i,expression:s}=t.options;return n(Bl({id:i,expression:s})),a.isActive&&n(ir(i)),{...r,select(){n(ir(i))},get state(){var o;return{isActive:(o=e.state.tabSet[i])==null?void 0:o.isActive}}}}function rI(e){return e.addReducers({configuration:Ee,tabSet:Z0}),!0}function nI(e){let t=Gl().analytics.originLevel2;if(e===t)throw new Error(`The #id option on the Tab controller cannot use the reserved value "${t}". Please specify a different value.`)}function Sk(e,t){let{dispatch:r}=e,n=tI(e,t),a=()=>r(ae({legacy:Jm(),next:hm()}));return{...n,get state(){return n.state},select(){n.select(),a()}}}function aI(e,t){iI(e);let r=g=>{var f;return((f=e.state.facetOptions.facets[g])==null?void 0:f.enabled)??!1},n=g=>{var f,y,p,v,b,A,j,N,$,Y,Q,H;return((p=(y=(f=e.state.facetSet)==null?void 0:f[g])==null?void 0:y.request)==null?void 0:p.currentValues)??((A=(b=(v=e.state.categoryFacetSet)==null?void 0:v[g])==null?void 0:b.request)==null?void 0:A.currentValues)??(($=(N=(j=e.state.numericFacetSet)==null?void 0:j[g])==null?void 0:N.request)==null?void 0:$.currentValues)??((H=(Q=(Y=e.state.dateFacetSet)==null?void 0:Y[g])==null?void 0:Q.request)==null?void 0:H.currentValues)??null},a=g=>g in e.state.facetOptions.facets,i=()=>ri({isFacetRegistered:a(t.facetId),parentFacets:t.conditions.map(({parentFacetId:g})=>a(g)?{enabled:r(g),values:n(g)}:null)}),s=()=>{let g=i();return g===u?!1:(u=g,!0)},o=()=>t.conditions.some(g=>{if(!r(g.parentFacetId))return!1;let f=n(g.parentFacetId);return f===null?!1:g.condition(f)}),c=()=>{e.state.facetSet&&Object.entries(e.state.facetSet).forEach(([g,f])=>f.request.freezeCurrentValues&&e.dispatch(dn({facetId:g,freezeCurrentValues:!1})))},l=()=>{if(!a(t.facetId))return;let g=r(t.facetId),f=o();g!==f&&(e.dispatch(f?Qt(t.facetId):We(t.facetId)),c())};if(!t.conditions.length)return{stopWatching(){}};let u=i(),d=e.subscribe(()=>{s()&&l()});return l(),{stopWatching(){d()}}}function iI(e){return e.addReducers({facetOptions:Bt}),!0}function wk(e,t){return aI(e,t)}function lt(e,t){var n,a;let r=t??((a=(n=e.search)==null?void 0:n.questionAnswer)==null?void 0:a.documentId);return r&&e.search&&$v(e,r.contentIdKey,r.contentIdValue)}function It(e,t){var n,a,i,s;let r=((n=e.questionAnswering)==null?void 0:n.relatedQuestions.findIndex(o=>o.questionAnswerId===t))??-1;return r===-1?null:((s=(i=(a=e.search)==null?void 0:a.questionAnswer)==null?void 0:i.relatedQuestions)==null?void 0:s[r])??null}var sI=()=>_("expandSmartSnippet")({prefix:"analytics/smartSnippet/expand",__legacy__getBuilder:(e,t)=>e.logExpandSmartSnippet(U(t.insightCaseContext)),analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>{var t;return{action:"expand",answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:"SmartSnippet"}}}}),oI=()=>_("collapseSmartSnippet")({prefix:"analytics/smartSnippet/collapse",__legacy__getBuilder:(e,t)=>e.logCollapseSmartSnippet(U(t.insightCaseContext)),analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>{var t;return{action:"collapse",answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:"SmartSnippet"}}}}),cI=()=>_("likeSmartSnippet")({prefix:"analytics/smartSnippet/like",__legacy__getBuilder:(e,t)=>e.logLikeSmartSnippet(U(t.insightCaseContext)),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>{var t;return{answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:"SmartSnippet"},feedback:{liked:!0}}}}),lI=()=>_("dislikeSmartSnippet")({prefix:"analytics/smartSnippet/dislike",__legacy__getBuilder:(e,t)=>e.logDislikeSmartSnippet(U(t.insightCaseContext)),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>{var t;return{answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:"SmartSnippet"},feedback:{liked:!1}}}}),uI=()=>_("openSmartSnippetSource")({prefix:"analytics/smartSnippet/source/open",__legacy__getBuilder:(e,t)=>{let r=lt(t);return e.logOpenSmartSnippetSource(ct(r,t),bt(r),U(t.insightCaseContext))},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:e=>{var n;let t=lt(e),r=bt(t);return{answer:{responseId:((n=e.search)==null?void 0:n.response.searchUid)||"",type:"SmartSnippet"},citation:{id:r.contentIDValue,type:"Source"}}}}),Vd=e=>_("openSmartSnippetSource")({prefix:"analytics/smartSnippet/source/open",__legacy__getBuilder:(t,r)=>{I(e,Uu());let n=lt(r);return t.logOpenSmartSnippetInlineLink(ct(n,r),{...bt(n),...e},U(r.insightCaseContext))},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:t=>{var a;let r=lt(t),n=bt(r);return{answer:{responseId:((a=t.search)==null?void 0:a.response.searchUid)||"",type:"SmartSnippet"},citation:{id:n.contentIDValue,type:"InlineLink"}}}}),dI=()=>_("openSmartSnippetFeedbackModal")("analytics/smartSnippet/feedbackModal/open",(e,t)=>e.logOpenSmartSnippetFeedbackModal(U(t.insightCaseContext))),gI=()=>_("closeSmartSnippetFeedbackModal")("analytics/smartSnippet/feedbackModal/close",(e,t)=>e.logCloseSmartSnippetFeedbackModal(U(t.insightCaseContext))),pI=e=>_("sendSmartSnippetReason")({prefix:"analytics/smartSnippet/sendFeedback",__legacy__getBuilder:(t,r)=>t.logSmartSnippetFeedbackReason(e,void 0,U(r.insightCaseContext)),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>{var r;return{answer:{responseId:((r=t.search)==null?void 0:r.response.searchUid)||"",type:"SmartSnippet"},feedback:{liked:!1,reason:e}}}}),fI=e=>_("sendSmartSnippetReason")({prefix:"analytics/smartSnippet/sendFeedback",__legacy__getBuilder:(t,r)=>t.logSmartSnippetFeedbackReason("other",e,U(r.insightCaseContext)),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>{var r;return{answer:{responseId:((r=t.search)==null?void 0:r.response.searchUid)||"",type:"SmartSnippet"},feedback:{liked:!1,reason:"other",details:e}}}}),hI=e=>_("expandSmartSnippetSuggestion")({prefix:"analytics/smartSnippetSuggestion/expand",__legacy__getBuilder:(t,r)=>{Ln(e);let n=It(r,e.questionAnswerId);return n?t.logExpandSmartSnippetSuggestion({question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId},U(r.insightCaseContext)):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:t=>{var r;return{action:"expand",answer:{responseId:((r=t.search)==null?void 0:r.response.searchUid)||"",type:"SmartSnippetSuggestion"}}}}),yI=e=>_("collapseSmartSnippetSuggestion")({prefix:"analytics/smartSnippetSuggestion/collapse",__legacy__getBuilder:(t,r)=>{Ln(e);let n=It(r,e.questionAnswerId);return n?t.logCollapseSmartSnippetSuggestion({question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId},U(r.insightCaseContext)):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:t=>{var r;return{action:"collapse",answer:{responseId:((r=t.search)==null?void 0:r.response.searchUid)||"",type:"SmartSnippetSuggestion"}}}}),$d=e=>_("openSmartSnippetSuggestionSource")({prefix:"analytics/smartSnippetSuggestion/source/open",__legacy__getBuilder:(t,r)=>{I(e,ts());let n=It(r,e.questionAnswerId);if(!n)return null;let a=lt(r,n.documentId);return a?t.logOpenSmartSnippetSuggestionSource(ct(a,r),{question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId},U(r.insightCaseContext)):null},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:t=>{var n;let r=It(t,e.questionAnswerId);return{answer:{responseId:((n=t.search)==null?void 0:n.response.searchUid)||"",type:"SmartSnippetSuggestion"},citation:{id:(r==null?void 0:r.documentId.contentIdValue)||"",type:"Source"}}}}),mI=(e,t)=>_("openSmartSnippetSuggestionSource")({prefix:"analytics/smartSnippetSuggestion/source/open",__legacy__getBuilder:(r,n)=>{I(e,ts()),I(t,Uu());let a=It(n,e.questionAnswerId);if(!a)return null;let i=lt(n,a.documentId);return i?r.logOpenSmartSnippetSuggestionInlineLink(ct(i,n),{question:a.question,answerSnippet:a.answerSnippet,documentId:a.documentId,linkText:t.linkText,linkURL:t.linkURL},U(n.insightCaseContext)):null},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:r=>{var a;let n=It(r,e.questionAnswerId);return{answer:{responseId:((a=r.search)==null?void 0:a.response.searchUid)||"",type:"SmartSnippetSuggestion"},citation:{id:(n==null?void 0:n.documentId.contentIdValue)||"",type:"InlineLink"}}}}),Ld={logExpandSmartSnippet:sI,logCollapseSmartSnippet:oI,logLikeSmartSnippet:cI,logDislikeSmartSnippet:lI,logOpenSmartSnippetSource:uI,logOpenSmartSnippetInlineLink:Vd,logOpenSmartSnippetFeedbackModal:dI,logCloseSmartSnippetFeedbackModal:gI,logSmartSnippetFeedback:pI,logSmartSnippetDetailedFeedback:fI,logExpandSmartSnippetSuggestion:hI,logCollapseSmartSnippetSuggestion:yI,logOpenSmartSnippetSuggestionSource:$d};function vI(e,t,r){var c;SI(e);let n=Ae(e),a=()=>e.state,i=()=>lt(a()),s=null,o=Dr(e,{options:{selectionDelay:(c=r==null?void 0:r.options)==null?void 0:c.selectionDelay}},()=>{let l=i();if(!l){s=null;return}let{searchResponseId:u}=a().search;s!==u&&(s=u,e.dispatch(t.logOpenSmartSnippetSource()),e.dispatch($n(l)))});return{...n,get state(){let l=a();return{question:l.search.questionAnswer.question,answer:l.search.questionAnswer.answerSnippet,documentId:l.search.questionAnswer.documentId,expanded:l.questionAnswering.expanded,answerFound:l.search.questionAnswer.answerSnippet!=="",liked:l.questionAnswering.liked,disliked:l.questionAnswering.disliked,feedbackModalOpen:l.questionAnswering.feedbackModalOpen,source:i()}},expand(){e.dispatch(t.logExpandSmartSnippet()),e.dispatch(_u())},collapse(){e.dispatch(t.logCollapseSmartSnippet()),e.dispatch(Vu())},like(){e.dispatch(t.logLikeSmartSnippet()),e.dispatch($u())},dislike(){e.dispatch(t.logDislikeSmartSnippet()),e.dispatch(Lu())},openFeedbackModal(){e.dispatch(t.logOpenSmartSnippetFeedbackModal()),e.dispatch(Qu())},closeFeedbackModal(){e.dispatch(t.logCloseSmartSnippetFeedbackModal()),e.dispatch(Hr())},sendFeedback(l){e.dispatch(t.logSmartSnippetFeedback(l)),e.dispatch(Hr())},sendDetailedFeedback(l){e.dispatch(t.logSmartSnippetDetailedFeedback(l)),e.dispatch(Hr())},selectSource(){o.select()},beginDelayedSelectSource(){o.beginDelayedSelect()},cancelPendingSelectSource(){o.cancelPendingSelect()}}}function SI(e){return e.addReducers({search:fe,questionAnswering:Qn}),!0}function Qd(e,t){wI(e);let r=()=>e.state,n=new Set,a=u=>n.has(u)?!0:(n.add(u),!1),i=null,s=u=>{i!==u&&(i=u,c={},n.clear())},o=(u,d,g)=>{var f;return Dr(e,{options:{selectionDelay:(f=t==null?void 0:t.options)==null?void 0:f.selectionDelay}},()=>{a(d)||e.dispatch(g?mI({questionAnswerId:g},u):Vd(u))})},c={},l=(u,d)=>{let{searchResponseId:g}=r().search;s(g);let f=ri({...u,questionAnswerId:d});return f in c||(c[f]=o(u,f,d)),c[f]};return{selectInlineLink(u,d){var g;(g=l(u,d))==null||g.select()},beginDelayedSelectInlineLink(u,d){var g;(g=l(u,d))==null||g.beginDelayedSelect()},cancelPendingSelectInlineLink(u,d){var g;(g=l(u,d))==null||g.cancelPendingSelect()}}}function wI(e){return e.addReducers({search:fe,questionAnswering:Qn}),!0}function bk(e,t){var a;let r=vI(e,Ld,t),n=Qd(e,{options:{selectionDelay:(a=t==null?void 0:t.options)==null?void 0:a.selectionDelay}});return{...r,get state(){return r.state},selectInlineLink(i){n.selectInlineLink(i)},beginDelayedSelectInlineLink(i){n.beginDelayedSelectInlineLink(i)},cancelPendingSelectInlineLink(i){n.cancelPendingSelectInlineLink(i)}}}function bI(e,t){CI(e);let r=Ae(e),n=()=>e.state,a=i=>{let{contentIdKey:s,contentIdValue:o}=i;return e.state.search.results.find(c=>$l(c,s)===o)};return{...r,get state(){let i=n();return{questions:i.search.questionAnswer.relatedQuestions.map((s,o)=>({question:s.question,answer:s.answerSnippet,documentId:s.documentId,questionAnswerId:i.questionAnswering.relatedQuestions[o].questionAnswerId,expanded:i.questionAnswering.relatedQuestions[o].expanded,source:a(s.documentId)}))}},expand(i){let s={questionAnswerId:i};e.dispatch(t.logExpandSmartSnippetSuggestion(s)),e.dispatch(zu(s))},collapse(i){let s={questionAnswerId:i};e.dispatch(t.logCollapseSmartSnippetSuggestion(s)),e.dispatch(Bu(s))}}}function CI(e){return e.addReducers({search:fe,questionAnswering:Qn}),!0}function II(e,t){kI(e);let r=()=>e.state,n=d=>{let g=r(),f=It(g,d);return f?lt(g,f.documentId):null},a=new Set,i=d=>a.has(d)?!0:(a.add(d),!1),s=null,o=d=>{s!==d&&(s=d,l={},a.clear())},c=(d,g)=>{var f;return Dr(e,{options:{selectionDelay:(f=t==null?void 0:t.options)==null?void 0:f.selectionDelay}},()=>{i(g)||(e.dispatch($d({questionAnswerId:g})),e.dispatch($n(d)))})},l={},u=d=>{let{searchResponseId:g}=r().search;o(g);let f=n(d);return f?(d in l||(l[d]=c(f,d)),l[d]):null};return{selectSource(d){var g;(g=u(d))==null||g.select()},beginDelayedSelectSource(d){var g;(g=u(d))==null||g.beginDelayedSelect()},cancelPendingSelectSource(d){var g;(g=u(d))==null||g.cancelPendingSelect()}}}function kI(e){return e.addReducers({search:fe,questionAnswering:Qn}),!0}function Ck(e,t){var i,s;let r=bI(e,Ld),n=Qd(e,{options:{selectionDelay:(i=t==null?void 0:t.options)==null?void 0:i.selectionDelay}}),a=II(e,{options:{selectionDelay:(s=t==null?void 0:t.options)==null?void 0:s.selectionDelay}});return{...r,get state(){return r.state},selectSource(o){a.selectSource(o)},beginDelayedSelectSource(o){a.beginDelayedSelectSource(o)},cancelPendingSelectSource(o){a.cancelPendingSelectSource(o)},selectInlineLink(o,c){n.selectInlineLink(c,o)},beginDelayedSelectInlineLink(o,c){n.beginDelayedSelectInlineLink(c,o)},cancelPendingSelectInlineLink(o,c){n.cancelPendingSelectInlineLink(c,o)}}}function zd(e,t){var r,n;return(n=(r=e.generatedAnswer)==null?void 0:r.citations)==null?void 0:n.find(a=>a.id===t)}function Te(e){var t,r,n;return(n=(r=(t=e.search)==null?void 0:t.response)==null?void 0:r.extendedResults)==null?void 0:n.generativeQuestionAnsweringId}var AI=e=>et("analytics/generatedAnswer/streamEnd",(t,r)=>{var i,s;let n=Te(r),a=e?!((i=r.generatedAnswer)!=null&&i.answer)||!((s=r.generatedAnswer)!=null&&s.answer.length):void 0;return n?t.makeGeneratedAnswerStreamEnd({generativeQuestionAnsweringId:n,answerGenerated:e,answerTextIsEmpty:a}):null}),qI=()=>({actionCause:"retryGeneratedAnswer"}),OI=()=>({actionCause:"rephraseGeneratedAnswer"}),Ge="RGA",xI=()=>_("retryGeneratedAnswer")("analytics/generatedAnswer/retry",(e,t)=>e.logRetryGeneratedAnswer(U(t.insightCaseContext))),EI=e=>_("rephraseGeneratedAnswer")("analytics/generatedAnswer/rephrase",(t,r)=>{let n=Te(r);return n?t.logRephraseGeneratedAnswer({generativeQuestionAnsweringId:n,rephraseFormat:e.answerStyle},U(r.insightCaseContext)):null}),Bd=e=>_("openGeneratedAnswerSource")({prefix:"analytics/generatedAnswer/openAnswerSource",__legacy__getBuilder:(t,r)=>{let n=Te(r),a=zd(r,e);return!n||!a?null:t.logOpenGeneratedAnswerSource({generativeQuestionAnsweringId:n,permanentId:a.permanentid,citationId:a.id},U(r.insightCaseContext))},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:t=>{var r;return{answer:{responseId:((r=t.search)==null?void 0:r.response.searchUid)||"",type:Ge},citation:{id:e,type:"Source"}}}}),RI=(e,t)=>_("generatedAnswerSourceHover")({prefix:"analytics/generatedAnswer/hoverCitation",__legacy__getBuilder:(r,n)=>{let a=Te(n),i=zd(n,e);return!a||!i?null:r.logGeneratedAnswerSourceHover({generativeQuestionAnsweringId:a,permanentId:i.permanentid,citationId:i.id,citationHoverTimeMs:t},U(n.insightCaseContext))},analyticsType:"Qna.CitationHover",analyticsPayloadBuilder:r=>{var n;return{answer:{responseId:((n=r.search)==null?void 0:n.response.searchUid)||"",type:Ge},citation:{id:e,type:"Source"},citationHoverTimeInMs:t}}}),FI=()=>_("likeGeneratedAnswer")({prefix:"analytics/generatedAnswer/like",__legacy__getBuilder:(e,t)=>{let r=Te(t);return r?e.logLikeGeneratedAnswer({generativeQuestionAnsweringId:r},U(t.insightCaseContext)):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>{var t;return{answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:Ge},feedback:{liked:!0}}}}),DI=()=>_("dislikeGeneratedAnswer")({prefix:"analytics/generatedAnswer/dislike",__legacy__getBuilder:(e,t)=>{let r=Te(t);return r?e.logDislikeGeneratedAnswer({generativeQuestionAnsweringId:r},U(t.insightCaseContext)):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>{var t;return{answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:Ge},feedback:{liked:!1}}}}),TI=e=>_("generatedAnswerFeedbackSubmit")({prefix:"analytics/generatedAnswer/sendFeedback",__legacy__getBuilder:(t,r)=>{let n=Te(r);return n?t.logGeneratedAnswerFeedbackSubmit({generativeQuestionAnsweringId:n,reason:e},U(r.insightCaseContext)):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>{var r;return{answer:{responseId:((r=t.search)==null?void 0:r.response.searchUid)||"",type:Ge},feedback:{liked:!1,reason:e}}}}),MI=e=>_("generatedAnswerFeedbackSubmit")({prefix:"analytics/generatedAnswer/sendFeedback",__legacy__getBuilder:(t,r)=>{let n=Te(r);return n?t.logGeneratedAnswerFeedbackSubmit({generativeQuestionAnsweringId:n,reason:"other",details:e},U(r.insightCaseContext)):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>{var r;return{answer:{responseId:((r=t.search)==null?void 0:r.response.searchUid)||"",type:Ge},feedback:{liked:!1,reason:"other",details:e}}}}),jI=e=>_("generatedAnswerStreamEnd")("analytics/generatedAnswer/streamEnd",(t,r)=>{let n=Te(r);return n?t.logGeneratedAnswerStreamEnd({generativeQuestionAnsweringId:n,answerGenerated:e},U(r.insightCaseContext)):null}),PI=()=>_("generatedAnswerShowAnswers")({prefix:"analytics/generatedAnswer/show",__legacy__getBuilder:(e,t)=>{let r=Te(t);return r?e.logGeneratedAnswerShowAnswers({generativeQuestionAnsweringId:r},U(t.insightCaseContext)):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>{var t;return{action:"show",answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:Ge}}}}),UI=()=>_("generatedAnswerHideAnswers")({prefix:"analytics/generatedAnswer/hide",__legacy__getBuilder:(e,t)=>{let r=Te(t);return r?e.logGeneratedAnswerHideAnswers({generativeQuestionAnsweringId:r},U(t.insightCaseContext)):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>{var t;return{action:"hide",answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:Ge}}}}),_I=()=>_("generatedAnswerExpand")({prefix:"analytics/generatedAnswer/expand",__legacy__getBuilder:(e,t)=>{let r=Te(t);return r?e.logGeneratedAnswerExpand({generativeQuestionAnsweringId:r},U(t.insightCaseContext)):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>{var t;return{action:"expand",answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:Ge}}}}),VI=()=>_("generatedAnswerCollapse")({prefix:"analytics/generatedAnswer/collapse",__legacy__getBuilder:(e,t)=>{let r=Te(t);return r?e.logGeneratedAnswerCollapse({generativeQuestionAnsweringId:r},U(t.insightCaseContext)):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>{var t;return{action:"collapse",answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:Ge}}}}),$I=()=>_("generatedAnswerCopyToClipboard")({prefix:"analytics/generatedAnswer/copy",__legacy__getBuilder:(e,t)=>{let r=Te(t);return r?e.logGeneratedAnswerCopyToClipboard({generativeQuestionAnsweringId:r},U(t.insightCaseContext)):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>{var t;return{action:"copyToClipboard",answer:{responseId:((t=e.search)==null?void 0:t.response.searchUid)||"",type:Ge}}}}),Ia={logCopyGeneratedAnswer:$I,logGeneratedAnswerHideAnswers:UI,logGeneratedAnswerShowAnswers:PI,logGeneratedAnswerStreamEnd:jI,logGeneratedAnswerDetailedFeedback:MI,logGeneratedAnswerFeedback:TI,logDislikeGeneratedAnswer:DI,logLikeGeneratedAnswer:FI,logHoverCitation:RI,logOpenGeneratedAnswerSource:Bd,logRetryGeneratedAnswer:xI,logRephraseGeneratedAnswer:EI,logGeneratedAnswerExpand:_I,logGeneratedAnswerCollapse:VI},LI=async e=>{var t;return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.platformUrl,streamId:(t=e.search.extendedResults)==null?void 0:t.generativeQuestionAnsweringId}},QI=["default","bullet","step","concise"],zI=["text/plain","text/markdown"],Jt=new x({required:!0}),Nd=new x,Hn=new J({required:!0}),BI={id:Jt,title:Jt,uri:Jt,permanentid:Jt,clickUri:Nd},Hd=new x({required:!0,constrainTo:zI}),Gr=S("generatedAnswer/setIsVisible",e=>I(e,Hn)),Gd=S("generatedAnswer/updateMessage",e=>I(e,{textDelta:Jt})),Yd=S("generatedAnswer/updateCitations",e=>I(e,{citations:new ie({required:!0,each:new T({values:BI})})})),Wd=S("generatedAnswer/updateError",e=>I(e,{message:Nd,code:new B({min:0})})),ds=S("generatedAnswer/resetAnswer"),Kd=S("generatedAnswer/like"),Jd=S("generatedAnswer/dislike"),Zd=S("generatedAnswer/feedbackModal/open"),Ka=S("generatedAnswer/expand"),Xd=S("generatedAnswer/collapse"),eg=S("generatedAnswer/setId",e=>I(e,{id:new x({required:!0})})),tg=S("generatedAnswer/feedbackModal/close"),Ja=S("generatedAnswer/sendFeedback"),Yr=S("generatedAnswer/setIsLoading",e=>I(e,Hn)),Za=S("generatedAnswer/setIsStreaming",e=>I(e,Hn)),rg=S("generatedAnswer/setAnswerContentFormat",e=>I(e,Hd)),Xa=S("generatedAnswer/updateResponseFormat",e=>I(e,{answerStyle:new x({required:!0,constrainTo:QI}),contentFormat:new ie({each:Hd,default:["text/plain"]})})),ng=S("generatedAnswer/registerFieldsToIncludeInCitations",e=>I(e,Jo)),ag=S("generatedAnswer/setIsAnswerGenerated",e=>I(e,Hn)),NI=V("generatedAnswer/streamAnswer",async(e,t)=>{var u;let r=t.getState(),{dispatch:n,extra:a}=t,{setAbortControllerRef:i}=e,s=await LI(r),o=(d,g)=>{switch(d){case"genqa.headerMessageType":{let f=JSON.parse(g);n(rg(f.contentFormat));break}case"genqa.messageType":n(Gd(JSON.parse(g)));break;case"genqa.citationsType":n(Yd(JSON.parse(g)));break;case"genqa.endOfStreamType":{let f=JSON.parse(g).answerGenerated;n(Za(!1)),n(ag(f)),n(AI(f));break}default:r.debug&&a.logger.warn(`Unknown payloadType: "${d}"`)}};n(Yr(!0));let c=d=>d.streamId===t.getState().search.extendedResults.generativeQuestionAnsweringId,l=(u=a.streamingClient)==null?void 0:u.streamGeneratedAnswer(s,{write:d=>{c(s)&&(n(Yr(!1)),d.payload&&d.payloadType&&o(d.payloadType,d.payload))},abort:d=>{c(s)&&n(Wd(d))},close:()=>{c(s)&&n(Za(!1))},resetAnswer:()=>{c(s)&&n(ds())}});l?i(l):n(Yr(!1))});function Mo(){return{id:"",isVisible:!0,isLoading:!1,isStreaming:!1,citations:[],liked:!1,disliked:!1,responseFormat:{answerStyle:"default",contentFormat:["text/plain"]},feedbackModalOpen:!1,feedbackSubmitted:!1,fieldsToIncludeInCitations:[],isAnswerGenerated:!1,expanded:!1}}var HI=ne(Mo(),e=>e.addCase(Gr,(t,{payload:r})=>{t.isVisible=r}).addCase(eg,(t,{payload:r})=>{t.id=r.id}).addCase(Gd,(t,{payload:r})=>{t.isLoading=!1,t.isStreaming=!0,t.answer||(t.answer=""),t.answer+=r.textDelta,delete t.error}).addCase(Yd,(t,{payload:r})=>{t.isLoading=!1,t.isStreaming=!0,t.citations=t.citations.concat(r.citations),delete t.error}).addCase(Wd,(t,{payload:r})=>{t.isLoading=!1,t.isStreaming=!1,t.error={...r,isRetryable:r.code===Ho},t.citations=[],delete t.answer}).addCase(Kd,t=>{t.liked=!0,t.disliked=!1}).addCase(Jd,t=>{t.liked=!1,t.disliked=!0}).addCase(Zd,t=>{t.feedbackModalOpen=!0}).addCase(tg,t=>{t.feedbackModalOpen=!1}).addCase(Ja,t=>{t.feedbackSubmitted=!0}).addCase(ds,t=>({...Mo(),responseFormat:t.responseFormat,fieldsToIncludeInCitations:t.fieldsToIncludeInCitations,isVisible:t.isVisible,id:t.id})).addCase(Yr,(t,{payload:r})=>{t.isLoading=r}).addCase(Za,(t,{payload:r})=>{t.isStreaming=r}).addCase(rg,(t,{payload:r})=>{t.answerContentFormat=r}).addCase(Xa,(t,{payload:r})=>{t.responseFormat=r}).addCase(ng,(t,r)=>{t.fieldsToIncludeInCitations=[...new Set(t.fieldsToIncludeInCitations.concat(r.payload))]}).addCase(ag,(t,{payload:r})=>{t.isAnswerGenerated=r}).addCase(Ka,t=>{t.expanded=!0}).addCase(Xd,t=>{t.expanded=!1})),je={engines:{},setAbortControllerRef:(e,t)=>{je.engines[t].abortController=e},getIsStreamInProgress:e=>{var t;return!je.engines[e].abortController||(t=je.engines[e].abortController)!=null&&t.signal.aborted?(je.engines[e].abortController=void 0,!1):!0},subscribeToSearchRequests:e=>{let t=()=>{var s;let r=e.state,n=r.search.requestId,a=r.search.extendedResults.generativeQuestionAnsweringId,i=r.generatedAnswer.id;je.engines[i].lastRequestId!==n&&(je.engines[i].lastRequestId=n,(s=je.engines[i].abortController)==null||s.abort(),e.dispatch(ds())),!je.getIsStreamInProgress(i)&&a&&a!==je.engines[i].lastStreamId&&(je.engines[i].lastStreamId=a,e.dispatch(NI({setAbortControllerRef:o=>je.setAbortControllerRef(o,i)})))};return e.subscribe(t)}};function GI(e,t,r={}){var l,u,d;YI(e);let{dispatch:n}=e,a=Ae(e),i=()=>e.state;if(!e.state.generatedAnswer.id){let g=Lo("genQA-",12);n(eg({id:g})),je.engines[g]={abortController:void 0,lastRequestId:"",lastStreamId:""}}let s=(l=r.initialState)==null?void 0:l.isVisible;s!==void 0&&n(Gr(s));let o=(u=r.initialState)==null?void 0:u.responseFormat;o&&n(Xa(o));let c=r.fieldsToIncludeInCitations;return c&&n(ng(c)),(d=r.initialState)!=null&&d.expanded&&n(Ka()),je.subscribeToSearchRequests(e),{...a,get state(){return i().generatedAnswer},like(){this.state.liked||(n(Kd()),n(t.logLikeGeneratedAnswer()))},dislike(){this.state.disliked||(n(Jd()),n(t.logDislikeGeneratedAnswer()))},openFeedbackModal(){n(Zd())},closeFeedbackModal(){n(tg())},sendFeedback(g){n(t.logGeneratedAnswerFeedback(g)),n(Ja())},sendDetailedFeedback(g){n(t.logGeneratedAnswerDetailedFeedback(g)),n(Ja())},logCitationClick(g){n(t.logOpenGeneratedAnswerSource(g))},logCitationHover(g,f){n(t.logHoverCitation(g,f))},rephrase(g){n(Xa(g))},show(){this.state.isVisible||(n(Gr(!0)),n(t.logGeneratedAnswerShowAnswers()))},hide(){this.state.isVisible&&(n(Gr(!1)),n(t.logGeneratedAnswerHideAnswers()))},expand(){this.state.expanded||(n(Ka()),n(t.logGeneratedAnswerExpand()))},collapse(){this.state.expanded&&(n(Xd()),n(t.logGeneratedAnswerCollapse()))},logCopyToClipboard(){n(t.logCopyGeneratedAnswer())},retry(){}}}function YI(e){return e.addReducers({generatedAnswer:HI}),!0}function Ik(e,t={}){let{dispatch:r}=e,n=GI(e,Ia,t);return{...n,get state(){return n.state},retry(){r(ae({legacy:Ia.logRetryGeneratedAnswer(),next:qI()}))},rephrase(a){n.rephrase(a),r(ae({legacy:Ia.logRephraseGeneratedAnswer(a),next:OI()}))}}}function WI(e,t,r){let n=!1,a=()=>{n||(n=!0,e.dispatch(t.logOpenGeneratedAnswerSource(r.options.citation.id)))};return Dr(e,r,()=>{a()})}function kk(e,t){return WI(e,{logOpenGeneratedAnswerSource:Bd},t)}function KI(e){JI(e);let t=Ae(e),r=()=>e.state;return{...t,get state(){return{hasError:r().search.error!==null,error:r().search.error}}}}function JI(e){return e.addReducers({search:fe}),!0}function Ak(e){return KI(e)}Mg();export{Sk as $,ck as A,vk as C,ik as G,ak as O,dk as P,gk as Q,uk as R,ok as S,hk as a,ek as b,wk as c,bk as d,yk as e,ew as f,ZI as g,sk as h,tk as i,Ak as j,lk as k,Ck as l,nk as m,vp as n,XI as o,Ik as p,mk as q,fk as t,kk as v,rk as w,pk as z};
