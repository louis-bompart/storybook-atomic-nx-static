import{r as t,h as s,g as e}from"./p-00525453.js";import{t as i,M as r}from"./p-e12016d2.js";import{e as n}from"./p-8f5830b4.js";import{I as o}from"./p-5ff0fe21.js";import{g as a,a as h,I as l}from"./p-0e55feeb.js";import{d as u}from"./p-a6063f86.js";import"./p-a2fc549d.js";import"./p-b0ede3ce.js";import"./p-1580513b.js";import"./p-9935af75.js";import"./p-e9c4f463.js";const c=class{constructor(s){t(this,s);this.results=[];this.display="list";this.templateHasError=false;this.maxResultsPerQuery=4;this.density="normal";this.imageSize="icon";this.error=undefined;this.templateHasError=false;this.maxResultsPerQuery=4;this.density="normal";this.imageSize="icon";this.ariaLabelGenerator=undefined}async setRenderFunction(t){this.itemRenderingFunction=t}componentWillLoad(){try{u((t=>{this.bindings=t;return this.initialize()}),this.host)}catch(t){this.error=t}}getLink(t){var s;const e=t.tagName==="ATOMIC-RESULT"?t:t===null||t===void 0?void 0:t.querySelector("atomic-result");return((s=e===null||e===void 0?void 0:e.shadowRoot)===null||s===void 0?void 0:s.querySelector("atomic-result-link a"))||null}handleLinkClick(t,s){const e=s=>t.setAttribute("target",s);const i=t.getAttribute("target");s&&e("_blank");t.click();s&&e(i||"");return true}renderItems(){if(!this.bindings.suggestedQuery()||this.bindings.store.isMobile()){return[]}const t=this.instantResults.state.results.length?this.instantResults.state.results:this.results;const e=t.map((t=>{var e;const r=a(this.bindings.i18n,((e=this.ariaLabelGenerator)===null||e===void 0?void 0:e.call(this,this.bindings,t))||t.title,t.uniqueId);return{...r,content:s("atomic-result",{key:`instant-result-${n(t.uniqueId)}`,part:"outline",result:t,interactiveResult:i(this.bindings.engine,{options:{result:t}}),display:this.display,density:this.density,imageSize:this.imageSize,content:this.itemTemplateProvider.getTemplateContent(t),stopPropagation:false,renderingFunction:this.itemRenderingFunction}),onSelect:t=>{const s=this.getLink(t.target);if(!s){return}this.handleLinkClick(s,t.ctrlKey||t.metaKey)}}}));if(e.length){const t=h(this.bindings.i18n);e.push({...t,content:s(l,{i18n:this.bindings.i18n}),onSelect:()=>{this.bindings.clearSuggestions();this.bindings.searchBoxController.updateText(this.instantResults.state.q);this.bindings.searchBoxController.submit()}})}return e}initialize(){this.instantResults=r(this.bindings.engine,{options:{maxResultsPerQuery:this.maxResultsPerQuery}});this.itemTemplateProvider=new o({includeDefaultTemplate:true,templateElements:Array.from(this.host.querySelectorAll("atomic-result-template")),getResultTemplateRegistered:()=>true,setResultTemplateRegistered:()=>{},getTemplateHasError:()=>this.templateHasError,setTemplateHasError:t=>{this.templateHasError=t},bindings:this.bindings});return{position:Array.from(this.host.parentNode.children).indexOf(this.host),panel:"right",onSuggestedQueryChange:t=>{this.instantResults.updateQuery(t);return this.onSuggestedQueryChange()},renderItems:()=>this.renderItems()}}onSuggestedQueryChange(){if(!this.bindings.getSuggestionElements().length&&!this.bindings.searchBoxController.state.value){console.warn("There doesn't seem to be any query suggestions configured. Make sure to include either an atomic-search-box-query-suggestions or atomic-search-box-recent-queries in your search box in order to see some instant results.")}return new Promise((t=>{const s=this.instantResults.subscribe((()=>{const e=this.instantResults.state;if(!e.isLoading){if(e.results.length){this.results=e.results}s();t()}}))}))}render(){if(this.error){return s("atomic-component-error",{key:"130c4d2a0963dc0a637b77ca63b2ca78feed7059",element:this.host,error:this.error})}}get host(){return e(this)}};export{c as atomic_search_box_instant_results};
//# sourceMappingURL=p-ae1bcfdc.entry.js.map