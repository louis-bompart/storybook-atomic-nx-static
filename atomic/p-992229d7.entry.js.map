{"version":3,"names":["atomicRefineToggleCss","AtomicRefineToggleStyle0","AtomicRefineToggle","this","collapseFacetsAfter","initialize","searchStatus","buildSearchStatus","bindings","engine","loadModal","modalRef","document","createElement","host","insertAdjacentElement","openButton","buttonRef","enableModal","isOpen","render","searchStatusState","hasError","firstSearchExecuted","h","part","class","hasResults","Button","style","onClick","text","i18n","t","ref","button","__decorate","InitializeBindings","BindStateToController"],"sources":["src/components/search/atomic-refine-toggle/atomic-refine-toggle.pcss?tag=atomic-refine-toggle&encapsulation=shadow","src/components/search/atomic-refine-toggle/atomic-refine-toggle.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\r\n","import {\r\n  buildSearchStatus,\r\n  SearchStatusState,\r\n  SearchStatus,\r\n} from '@coveo/headless';\r\nimport {Component, h, Prop, State, Element} from '@stencil/core';\r\nimport {\r\n  InitializeBindings,\r\n  InitializableComponent,\r\n  BindStateToController,\r\n} from '../../../utils/initialization-utils';\r\nimport {Button} from '../../common/button';\r\nimport {Bindings} from '../atomic-search-interface/atomic-search-interface';\r\n\r\n/**\r\n * The `atomic-refine-toggle` component displays a button that opens a modal containing the facets and the sort components.\r\n *\r\n * When this component is added to the `atomic-search-interface`, an `atomic-refine-modal` component is automatically created.\r\n * @part button - The refine toggle button.\r\n */\r\n@Component({\r\n  tag: 'atomic-refine-toggle',\r\n  styleUrl: 'atomic-refine-toggle.pcss',\r\n  shadow: true,\r\n})\r\nexport class AtomicRefineToggle implements InitializableComponent {\r\n  @Element() public host!: HTMLElement;\r\n  public searchStatus!: SearchStatus;\r\n  private modalRef?: HTMLAtomicRefineModalElement;\r\n  private buttonRef?: HTMLButtonElement;\r\n\r\n  @InitializeBindings() public bindings!: Bindings;\r\n  @State() public error!: Error;\r\n  @BindStateToController('searchStatus')\r\n  @State()\r\n  private searchStatusState!: SearchStatusState;\r\n\r\n  /**\r\n   * The number of expanded facets inside the refine modal.\r\n   * Remaining facets are automatically collapsed.\r\n   *\r\n   * Using the value `0` collapses all facets.\r\n   */\r\n  @Prop({reflect: true}) public collapseFacetsAfter = 0;\r\n\r\n  public initialize() {\r\n    this.searchStatus = buildSearchStatus(this.bindings.engine);\r\n  }\r\n\r\n  private loadModal() {\r\n    if (this.modalRef) {\r\n      return;\r\n    }\r\n\r\n    this.modalRef = document.createElement('atomic-refine-modal');\r\n    this.host.insertAdjacentElement('beforebegin', this.modalRef);\r\n    this.modalRef.openButton = this.buttonRef;\r\n    this.modalRef.collapseFacetsAfter = this.collapseFacetsAfter;\r\n  }\r\n\r\n  private enableModal() {\r\n    this.modalRef && (this.modalRef.isOpen = true);\r\n  }\r\n\r\n  public render() {\r\n    if (this.searchStatusState.hasError) {\r\n      return;\r\n    }\r\n\r\n    if (!this.searchStatusState.firstSearchExecuted) {\r\n      return (\r\n        <div\r\n          part=\"placeholder\"\r\n          aria-hidden\r\n          class=\"rounded w-28 h-8 my-2 bg-neutral animate-pulse\"\r\n        ></div>\r\n      );\r\n    }\r\n\r\n    if (!this.searchStatusState.hasResults) {\r\n      return;\r\n    }\r\n\r\n    return (\r\n      <Button\r\n        style=\"outline-primary\"\r\n        class=\"p-3 w-full\"\r\n        onClick={() => this.enableModal()}\r\n        text={this.bindings.i18n.t('sort-and-filter')}\r\n        ref={(button) => {\r\n          if (!button) {\r\n            return;\r\n          }\r\n          this.buttonRef = button;\r\n          this.loadModal();\r\n        }}\r\n        part=\"button\"\r\n      ></Button>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"wRAAA,MAAMA,EAAwB,w+tCAC9B,MAAAC,EAAeD,E,iXCwBFE,EAAkB,M,yBAkBCC,KAAAC,oBAAsB,E,+EAAA,C,CAE7C,UAAAC,GACLF,KAAKG,aAAeC,EAAkBJ,KAAKK,SAASC,O,CAG9C,SAAAC,GACN,GAAIP,KAAKQ,SAAU,CACjB,M,CAGFR,KAAKQ,SAAWC,SAASC,cAAc,uBACvCV,KAAKW,KAAKC,sBAAsB,cAAeZ,KAAKQ,UACpDR,KAAKQ,SAASK,WAAab,KAAKc,UAChCd,KAAKQ,SAASP,oBAAsBD,KAAKC,mB,CAGnC,WAAAc,GACNf,KAAKQ,WAAaR,KAAKQ,SAASQ,OAAS,K,CAGpC,MAAAC,GACL,GAAIjB,KAAKkB,kBAAkBC,SAAU,CACnC,M,CAGF,IAAKnB,KAAKkB,kBAAkBE,oBAAqB,CAC/C,OACEC,EAAA,OACEC,KAAK,cAAa,mBAElBC,MAAM,kD,CAKZ,IAAKvB,KAAKkB,kBAAkBM,WAAY,CACtC,M,CAGF,OACEH,EAACI,EAAM,CACLC,MAAM,kBACNH,MAAM,aACNI,QAAS,IAAM3B,KAAKe,cACpBa,KAAM5B,KAAKK,SAASwB,KAAKC,EAAE,mBAC3BC,IAAMC,IACJ,IAAKA,EAAQ,CACX,M,CAEFhC,KAAKc,UAAYkB,EACjBhC,KAAKO,WAAW,EAElBe,KAAK,U,6BAjEkBW,EAAA,CAA5BC,K,+BAIOD,EAAA,CAFPE,EAAsB,iB"}