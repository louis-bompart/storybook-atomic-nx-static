{"file":"atomic-quickview-modal2.js","mappings":"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","names":["buildInteractiveResult"],"sources":["src/components/search/result-template-components/atomic-quickview-sidebar/atomic-quickview-sidebar.tsx","src/components/search/result-template-components/quickview-iframe/quickview-iframe.tsx","src/components/search/result-template-components/quickview-preview-bar/quickview-preview-bar.ts","src/utils/color-utils.ts","src/components/search/result-template-components/quickview-word-highlight/quickview-word-highlight.tsx","src/components/search/result-template-components/atomic-quickview-modal/atomic-quickview-modal.pcss?tag=atomic-quickview-modal&encapsulation=shadow","src/components/search/result-template-components/atomic-quickview-modal/atomic-quickview-modal.tsx"],"sourcesContent":["import {Fragment, FunctionalComponent, h} from '@stencil/core';\nimport {i18n} from 'i18next';\nimport Add from '../../../../images/add.svg';\nimport ArrowDown from '../../../../images/arrow-bottom-rounded.svg';\nimport ArrowUp from '../../../../images/arrow-top-rounded.svg';\nimport MinimizeIcon from '../../../../images/menu.svg';\nimport Remove from '../../../../images/remove.svg';\nimport {Checkbox} from '../../../common/checkbox';\nimport {FieldsetGroup} from '../../../common/fieldset-group';\nimport {IconButton} from '../../../common/iconButton';\nimport type {HighlightKeywords} from '../atomic-quickview-modal/atomic-quickview-modal';\nimport {QuickviewWordHighlight} from '../quickview-word-highlight/quickview-word-highlight';\n\nconst identifierKeywordsSection = 'coveo-quickview-sidebar-keywords';\n\nexport interface QuickviewSidebarProps {\n  words: Record<string, QuickviewWordHighlight>;\n  i18n: i18n;\n  highlightKeywords: HighlightKeywords;\n  onHighlightKeywords: (highlight: HighlightKeywords) => void;\n  minimized: boolean;\n  onMinimize: (minimize: boolean) => void;\n}\n\nexport const QuickviewSidebar: FunctionalComponent<QuickviewSidebarProps> = (\n  props\n) => {\n  const {words, minimized} = props;\n  const numberOfWords = Object.values(words).length;\n\n  if (numberOfWords === 0) {\n    return;\n  }\n\n  const minimizeButton = (\n    <MinimizeButton {...props} wordsLength={numberOfWords} />\n  );\n\n  return (\n    <div class=\"p-4 border-r border-neutral h-full\">\n      {minimized && minimizeButton}\n      <div class=\"flex items-center justify-between\">\n        <div class=\"flex items-center\">\n          <HighlightKeywordsCheckbox {...props} />\n        </div>\n        {!minimized && <div>{minimizeButton}</div>}\n      </div>\n\n      {!minimized && <Keywords {...props} words={words} />}\n    </div>\n  );\n};\n\nconst MinimizeButton: FunctionalComponent<\n  Pick<\n    QuickviewSidebarProps,\n    'i18n' | 'minimized' | 'onMinimize' | 'highlightKeywords'\n  > & {wordsLength: number}\n> = ({i18n, minimized, onMinimize, highlightKeywords, wordsLength}) => (\n  <IconButton\n    partPrefix=\"sidebar-minimize\"\n    icon={MinimizeIcon}\n    style=\"text-transparent\"\n    title={i18n.t('quickview-toggle-navigation')}\n    ariaLabel={i18n.t('quickview-toggle-navigation')}\n    onClick={() => onMinimize(!minimized)}\n    badge={\n      highlightKeywords && minimized ? <slot>{wordsLength}</slot> : undefined\n    }\n    class={`w-fit ${minimized ? '' : 'ml-auto'}`}\n    ariaExpanded={(!minimized).toString()}\n    ariaControls={identifierKeywordsSection}\n  />\n);\n\nconst HighlightKeywordsCheckbox: FunctionalComponent<\n  Pick<\n    QuickviewSidebarProps,\n    'i18n' | 'highlightKeywords' | 'onHighlightKeywords' | 'minimized'\n  >\n> = ({i18n, highlightKeywords, onHighlightKeywords, minimized}) => (\n  <Fragment>\n    <Checkbox\n      text={i18n.t('keywords-highlight')}\n      class=\"mr-2\"\n      id=\"atomic-quickview-sidebar-highlight-keywords\"\n      checked={!highlightKeywords.highlightNone}\n      onToggle={(checked) =>\n        onHighlightKeywords({\n          ...highlightKeywords,\n          highlightNone: !checked,\n        })\n      }\n    ></Checkbox>\n    {!minimized && (\n      <label\n        class=\"font-bold cursor-pointer whitespace-nowrap\"\n        htmlFor=\"atomic-quickview-sidebar-highlight-keywords\"\n      >\n        {i18n.t('keywords-highlight')}\n      </label>\n    )}\n  </Fragment>\n);\n\nconst Keywords: FunctionalComponent<\n  Pick<\n    QuickviewSidebarProps,\n    'i18n' | 'onHighlightKeywords' | 'highlightKeywords'\n  > & {\n    words: Record<string, QuickviewWordHighlight>;\n  }\n> = ({words, i18n, highlightKeywords, onHighlightKeywords}) => {\n  return (\n    <div id={identifierKeywordsSection}>\n      {Object.values(words).map((keyword) => {\n        const wordIsEnabled =\n          !highlightKeywords.highlightNone &&\n          (highlightKeywords.keywords[keyword.text] === undefined ||\n            highlightKeywords.keywords[keyword.text].enabled === true);\n\n        return (\n          <div\n            key={keyword.text}\n            class=\"flex items-center justify-between gap-x-2 my-4 w-100\"\n          >\n            <div\n              class={`flex grow items-center bg-background border border-neutral rounded-lg overflow-x-auto ${\n                !wordIsEnabled ? 'pointer-events-none opacity-50' : ''\n              }`}\n            >\n              <div\n                class=\"flex items-center grow p-4 border-r\"\n                aria-hidden=\"true\"\n              >\n                <div\n                  class=\"w-5 h-5 flex-none mr-2\"\n                  style={{backgroundColor: keyword.color}}\n                ></div>\n                <div class=\"grow mr-2 whitespace-nowrap\">{keyword.text}</div>\n                <div class=\"flex-none\">\n                  (\n                  {new Intl.NumberFormat(i18n.language, {\n                    notation: 'compact',\n                  }).format(keyword.occurrences)}\n                  )\n                </div>\n              </div>\n              <FieldsetGroup\n                label={i18n.t('quickview-navigate-keywords', {\n                  occurrences: keyword.occurrences,\n                  keyword: keyword.text,\n                })}\n              >\n                <div class=\"flex px-2\">\n                  <IconButton\n                    partPrefix=\"sidebar-next\"\n                    icon={ArrowDown}\n                    disabled={!wordIsEnabled}\n                    style=\"text-transparent\"\n                    class=\"border-0\"\n                    ariaLabel={i18n.t('next')}\n                    title={i18n.t('next')}\n                    onClick={() => keyword.navigateForward()}\n                  />\n                  <IconButton\n                    partPrefix=\"sidebar-previous\"\n                    icon={ArrowUp}\n                    disabled={!wordIsEnabled}\n                    style=\"text-transparent\"\n                    class=\"border-0\"\n                    ariaLabel={i18n.t('previous')}\n                    title={i18n.t('previous')}\n                    onClick={() => keyword.navigateBackward()}\n                  />\n                </div>\n              </FieldsetGroup>\n            </div>\n            <IconButton\n              partPrefix=\"sidebar-remove-word\"\n              class={`${\n                highlightKeywords.highlightNone\n                  ? 'pointer-events-none opacity-50'\n                  : ''\n              }`}\n              tabIndex={highlightKeywords.highlightNone ? '-1' : '0'}\n              ariaPressed={(!wordIsEnabled).toString()}\n              style=\"text-transparent\"\n              icon={wordIsEnabled ? Remove : Add}\n              ariaLabel={i18n.t('quickview-remove-word')}\n              onClick={() => {\n                onHighlightKeywords({\n                  ...highlightKeywords,\n                  keywords: {\n                    ...highlightKeywords.keywords,\n                    [keyword.text]: {\n                      enabled: !wordIsEnabled,\n                      indexIdentifier: keyword.indexIdentifier,\n                    },\n                  },\n                });\n              }}\n            />\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n","import {SearchEngine} from '@coveo/headless';\nimport {FunctionalComponent, h} from '@stencil/core';\n\nconst documentIdentifierInIframe = 'CoveoDocIdentifier';\n\nconst writeDocument = (documentWriter: Document, content: string) => {\n  documentWriter.open();\n  documentWriter.write(content);\n  documentWriter.close();\n  if (documentWriter.scrollingElement) {\n    documentWriter.scrollingElement.scrollTop = 0;\n  }\n};\n\nconst currentResultAlreadyWrittenToDocument = (\n  documentWriter: Document,\n  uniqueIdentifier: string\n) => {\n  const currentDocIdentifier = documentWriter.getElementById(\n    documentIdentifierInIframe\n  );\n\n  return (\n    currentDocIdentifier &&\n    currentDocIdentifier.textContent === uniqueIdentifier\n  );\n};\n\nconst ensureSameResultIsNotOverwritten = (\n  documentWriter: Document,\n  uniqueIdentifier: string\n) => {\n  const docIdentifier = documentWriter.createElement('div');\n  docIdentifier.style.display = 'none';\n  docIdentifier.setAttribute('aria-hidden', 'true');\n  docIdentifier.id = documentIdentifierInIframe;\n  docIdentifier.textContent = uniqueIdentifier;\n  documentWriter.body.appendChild(docIdentifier);\n};\n\nconst warnAboutLimitedUsageQuickview = (logger?: SearchEngine['logger']) => {\n  logger?.warn(\n    'Quickview initialized in restricted mode due to incompatible sandboxing environment. Keywords hit navigation will be disabled.'\n  );\n};\n\nexport const QuickviewIframe: FunctionalComponent<{\n  content?: string;\n  onSetIframeRef: (ref: HTMLIFrameElement) => void;\n  uniqueIdentifier?: string;\n  sandbox?: string;\n  src?: string;\n  logger?: SearchEngine['logger'];\n}> = ({onSetIframeRef, uniqueIdentifier, content, sandbox, src, logger}) => {\n  // When a document is written with document.open/document.write/document.close\n  // it is not synchronous and the content of the iframe is only available to be queried at the end of the current call stack.\n  // This add a \"wait\" (setTimeout 0) before calling the `onSetIframeRef` from the parent modal quickview\n  const waitForIframeContentToBeWritten = () => {\n    return new Promise((resolve) => setTimeout(resolve));\n  };\n\n  return (\n    <iframe\n      src=\"about:blank\"\n      class=\"w-full h-full\"\n      sandbox={sandbox}\n      ref={async (el) => {\n        const iframeRef = el as HTMLIFrameElement;\n\n        if (!uniqueIdentifier || !content) {\n          return;\n        }\n\n        const documentWriter = iframeRef.contentDocument;\n        if (!documentWriter) {\n          if (src) {\n            warnAboutLimitedUsageQuickview(logger);\n            iframeRef.src = src;\n          }\n\n          return;\n        }\n        if (\n          currentResultAlreadyWrittenToDocument(\n            documentWriter,\n            uniqueIdentifier\n          )\n        ) {\n          return;\n        }\n\n        writeDocument(documentWriter, content);\n        ensureSameResultIsNotOverwritten(documentWriter, uniqueIdentifier);\n\n        await waitForIframeContentToBeWritten();\n        onSetIframeRef(iframeRef);\n      }}\n    ></iframe>\n  );\n};\n","import {HighlightKeywords} from '../atomic-quickview-modal/atomic-quickview-modal';\nimport {QuickviewWordHighlight} from '../quickview-word-highlight/quickview-word-highlight';\n\nconst buildPreviewBar = (documentWriter: Document) => {\n  const previewBarId = 'CoveoPreviewBar';\n  const bar =\n    documentWriter.getElementById(previewBarId) ||\n    documentWriter.createElement('div');\n\n  bar.id = previewBarId;\n  bar.innerHTML = '';\n  bar.style.position = 'fixed';\n  bar.style.top = '0';\n  bar.style.right = '0';\n  bar.style.width = '15px';\n  bar.style.height = '100%';\n  bar.setAttribute('aria-hidden', 'true');\n  return bar;\n};\n\nconst buildPreviewUnit = (\n  documentWriter: Document,\n  word: QuickviewWordHighlight,\n  wordElement: HTMLElement,\n  docHeight: number,\n  highlightKeywords: HighlightKeywords\n) => {\n  const previewUnit = documentWriter.createElement('div');\n  if (highlightKeywords.keywords[word.text]?.enabled === false) {\n    previewUnit.style.display = 'none';\n    return previewUnit;\n  }\n\n  const elementPosition = wordElement.getBoundingClientRect().top;\n\n  previewUnit.style.position = 'absolute';\n  previewUnit.style.top = `${(elementPosition / docHeight) * 100}%`;\n  previewUnit.style.width = '100%';\n  previewUnit.style.height = '1px';\n  previewUnit.style.border = `1px solid ${word.previewBorderColor}`;\n  previewUnit.style.backgroundColor = word.color;\n  return previewUnit;\n};\n\nexport const buildQuickviewPreviewBar = (\n  words: Record<string, QuickviewWordHighlight>,\n  highlightKeywords: HighlightKeywords,\n  iframe?: HTMLIFrameElement\n) => {\n  if (!iframe) {\n    return;\n  }\n  const documentWriter = iframe.contentDocument;\n  if (!documentWriter) {\n    return;\n  }\n  const bar = buildPreviewBar(documentWriter);\n  if (highlightKeywords.highlightNone) {\n    bar.remove();\n    return;\n  }\n  const docHeight = documentWriter.body.scrollHeight;\n\n  Object.values(words).forEach((word) => {\n    word.elements.forEach((wordElement) => {\n      const previewUnit = buildPreviewUnit(\n        documentWriter,\n        word,\n        wordElement,\n        docHeight,\n        highlightKeywords\n      );\n\n      bar.appendChild(previewUnit);\n    });\n  });\n  documentWriter.body.appendChild(bar);\n};\n","export const rgbToHsv = (r: number, g: number, b: number) => {\n  const max = Math.max(r, g, b);\n  const min = Math.min(r, g, b);\n\n  let h: number;\n  const v = max;\n\n  const d = max - min;\n  const s = max === 0 ? 0 : d / max;\n\n  if (max === min) {\n    h = 0;\n  } else {\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n      default:\n        h = (r - g) / d + 4;\n        break;\n    }\n    h /= 6;\n  }\n\n  return {h, s, v};\n};\n\nexport const hsvToRgb = (h: number, s: number, v: number) => {\n  let r, g, b;\n\n  const i = Math.floor(h * 6);\n  const f = h * 6 - i;\n  const p = v * (1 - s);\n  const q = v * (1 - f * s);\n  const t = v * (1 - (1 - f) * s);\n\n  switch (i % 6) {\n    case 0:\n      (r = v), (g = t), (b = p);\n      break;\n    case 1:\n      (r = q), (g = v), (b = p);\n      break;\n    case 2:\n      (r = p), (g = v), (b = t);\n      break;\n    case 3:\n      (r = p), (g = q), (b = v);\n      break;\n    case 4:\n      (r = t), (g = p), (b = v);\n      break;\n    case 5:\n    default:\n      (r = v), (g = p), (b = q);\n      break;\n  }\n\n  return {\n    r: Math.round(r),\n    g: Math.round(g),\n    b: Math.round(b),\n  };\n};\n","import {TermsToHighlight} from '@coveo/headless';\nimport {hsvToRgb, rgbToHsv} from '../../../../utils/color-utils';\n\nexport const HIGHLIGHT_PREFIX = 'CoveoHighlight';\nexport class QuickviewWordHighlight {\n  public text: string;\n  public indexIdentifier: string;\n  public occurrences = 0;\n  public color: string;\n  public focusedColor: string;\n  public previewBorderColor: string;\n  public elements: HTMLElement[] = [];\n\n  private currentNavigationPosition = -1;\n\n  constructor(\n    private stemmingInfoFromIndex: TermsToHighlight,\n    keywordElementInIframe: HTMLElement\n  ) {\n    const parsed = this.parseKeywordIdentifier(keywordElementInIframe);\n    if (!parsed) {\n      throw 'Invalid keyword identifier for quickview';\n    }\n\n    this.text = this.getText(keywordElementInIframe);\n    this.indexIdentifier = `${parsed.keywordIdentifier}-${this.text}`;\n    this.color = keywordElementInIframe.style.backgroundColor;\n    this.focusedColor = this.computeInvertedColor();\n    this.previewBorderColor = this.computeSaturatedColor();\n\n    this.addElement(keywordElementInIframe);\n  }\n\n  public addElement(keywordElementInIframe: HTMLElement) {\n    this.occurrences++;\n    this.elements.push(keywordElementInIframe);\n  }\n\n  public navigateForward() {\n    this.currentNavigationPosition++;\n    if (this.currentNavigationPosition >= this.elements.length) {\n      this.currentNavigationPosition = 0;\n    }\n    this.highlightNavigation();\n    this.putElementIntoView();\n    return this.elements[this.currentNavigationPosition];\n  }\n\n  public navigateBackward() {\n    this.currentNavigationPosition--;\n    if (this.currentNavigationPosition < 0) {\n      this.currentNavigationPosition = this.elements.length - 1;\n    }\n    this.highlightNavigation();\n    this.putElementIntoView();\n    return this.elements[this.currentNavigationPosition];\n  }\n\n  private isTaggedWord(element: HTMLElement) {\n    return element.nodeName.toLowerCase() === 'coveotaggedword';\n  }\n\n  private highlightNavigation() {\n    const currentElement = this.elements[this.currentNavigationPosition];\n    const otherElements = this.elements.filter((el) => el !== currentElement);\n    currentElement.style.color = this.color;\n    currentElement.style.backgroundColor = this.focusedColor;\n    otherElements.forEach((element) => {\n      element.style.color = '';\n      element.style.backgroundColor = this.color;\n    });\n  }\n\n  private putElementIntoView() {\n    const element = this.elements[this.currentNavigationPosition];\n    element.scrollIntoView();\n  }\n\n  private getText(element: HTMLElement) {\n    const innerTextOfHTMLElement = this.getHighlightedInnerText(element);\n    return this.resolveOriginalTerm(innerTextOfHTMLElement).trim();\n  }\n\n  private resolveOriginalTerm(highlight: string): string {\n    // First try to find either an exact match between the highlight and the original non-stemmed keyword.\n    // Otherwise try to find a match between the highlight and the stemming keyword expansions\n    // If nothing is found (which should not normally happen...), simply return the highlight keyword as is.\n\n    const found = Object.keys(this.stemmingInfoFromIndex).find(\n      (originalTerm) => {\n        const originalTermMatch =\n          originalTerm.toLowerCase() === highlight.toLowerCase();\n        if (originalTermMatch) {\n          return true;\n        }\n        const stemmingExpansions = this.stemmingInfoFromIndex[originalTerm];\n        if (!stemmingExpansions) {\n          return false;\n        }\n\n        const stemmingExpansionMatch = stemmingExpansions.find(\n          (stemmingExpansion) =>\n            stemmingExpansion.toLowerCase() === highlight.toLowerCase()\n        );\n        return stemmingExpansionMatch;\n      }\n    );\n    return found || highlight;\n  }\n\n  private getHighlightedInnerText(element: HTMLElement): string {\n    if (!this.isTaggedWord(element)) {\n      return this.getTextOfHTMLElement(element);\n    }\n\n    const children = Array.from(element.children) as HTMLElement[];\n    if (children.length >= 1) {\n      return this.getTextOfHTMLElement(children[0]);\n    }\n\n    return '';\n  }\n\n  private parseKeywordIdentifier(element: HTMLElement) {\n    const parts = element.id\n      .substring(HIGHLIGHT_PREFIX.length + 1)\n      .match(/^([0-9]+)\\.([0-9]+)\\.([0-9]+)$/);\n\n    if (!parts || parts.length <= 3) {\n      return null;\n    }\n\n    return {\n      keywordIdentifier: parts[1],\n      keywordTermPart: parseInt(parts[3], 10),\n    };\n  }\n\n  private getTextOfHTMLElement(el: HTMLElement) {\n    return el.innerText || el.textContent || '';\n  }\n\n  private computeInvertedColor() {\n    const {r, g, b} = this.extractRgb();\n    return `rgb(${255 - r}, ${255 - g}, ${255 - b})`;\n  }\n\n  private computeSaturatedColor() {\n    const {r, g, b} = this.extractRgb();\n    const {h, s, v} = rgbToHsv(r, g, b);\n    let newSaturation = s * 2;\n    if (newSaturation > 1) {\n      newSaturation = 1;\n    }\n    const {\n      r: rSaturated,\n      g: gSaturated,\n      b: bSaturated,\n    } = hsvToRgb(h, newSaturation, v);\n    return `rgb(${rSaturated}, ${gSaturated}, ${bSaturated})`;\n  }\n\n  private extractRgb() {\n    const rgbExtracted = this.color.match(/\\d+/g);\n    if (!rgbExtracted) {\n      return {r: 255, g: 255, b: 255};\n    }\n\n    return {\n      r: parseInt(rgbExtracted[0], 10),\n      g: parseInt(rgbExtracted[1], 10),\n      b: parseInt(rgbExtracted[2], 10),\n    };\n  }\n}\n\nexport const getWordsHighlights = (\n  stemmingInfoFromIndex: TermsToHighlight,\n  iframe?: HTMLIFrameElement\n) => {\n  const wordsHighlights: Record<string, QuickviewWordHighlight> = {};\n  if (!iframe) {\n    return wordsHighlights;\n  }\n\n  iframe.contentDocument?.body\n    .querySelectorAll(`[id^=\"${HIGHLIGHT_PREFIX}\"]`)\n    .forEach((el) => {\n      const wordHTMLElementToHighlight = el as HTMLElement;\n\n      const wordHighlight = new QuickviewWordHighlight(\n        stemmingInfoFromIndex,\n        wordHTMLElementToHighlight\n      );\n\n      if (!wordHighlight.text) {\n        return;\n      }\n\n      const alreadyScannedKeyword =\n        wordsHighlights[wordHighlight.indexIdentifier];\n\n      if (alreadyScannedKeyword) {\n        alreadyScannedKeyword.addElement(wordHTMLElementToHighlight);\n      } else {\n        wordsHighlights[wordHighlight.indexIdentifier] = wordHighlight;\n      }\n    });\n\n  return wordsHighlights;\n};\n","@import '../../../../global/global.pcss';\n@import '../../../../global/mixins.pcss';\n\n.atomic-quickview-modal {\n  &::part(backdrop) {\n    grid-template-columns: 1fr max(80vw, 30rem) 1fr;\n  }\n  &::part(body),\n  &::part(header),\n  &::part(footer) {\n    @apply max-w-full;\n  }\n\n  &::part(footer) {\n    @apply flex justify-center;\n  }\n\n  &::part(body-wrapper) {\n    @apply p-0 overflow-hidden h-full;\n  }\n\n  &::part(body) {\n    @apply h-full;\n  }\n\n  &::part(backdrop) {\n    grid-template-rows: 1fr 100% 3fr;\n  }\n\n  &::part(header-wrapper) {\n    @apply bg-neutral-light;\n  }\n\n  a {\n    @mixin link-style;\n  }\n}\n","import {\n  buildInteractiveResult,\n  Result,\n  InteractiveResult,\n  TermsToHighlight,\n} from '@coveo/headless';\nimport {\n  Component,\n  Event,\n  EventEmitter,\n  h,\n  Prop,\n  State,\n  Watch,\n  Method,\n  VNode,\n  Fragment,\n} from '@stencil/core';\nimport CloseIcon from '../../../../images/close.svg';\nimport {\n  InitializableComponent,\n  InitializeBindings,\n} from '../../../../utils/initialization-utils';\nimport {Button} from '../../../common/button';\nimport {IconButton} from '../../../common/iconButton';\nimport {LinkWithItemAnalytics} from '../../../common/item-link/item-link';\nimport {Bindings} from '../../atomic-search-interface/atomic-search-interface';\nimport {QuickviewSidebar} from '../atomic-quickview-sidebar/atomic-quickview-sidebar';\nimport {QuickviewIframe} from '../quickview-iframe/quickview-iframe';\nimport {buildQuickviewPreviewBar} from '../quickview-preview-bar/quickview-preview-bar';\nimport {\n  getWordsHighlights,\n  HIGHLIGHT_PREFIX,\n  QuickviewWordHighlight,\n} from '../quickview-word-highlight/quickview-word-highlight';\n\nexport interface HighlightKeywords {\n  highlightNone: boolean;\n  keywords: {\n    [text: string]: {\n      indexIdentifier: string;\n      enabled: boolean;\n    };\n  };\n}\n\n/**\n * The modal opened when clicking on a quickview button.\n * Do not use this component directly; use `atomic-quickview` instead.\n *\n * @part quickview-modal-header-icon - The close icon of the modal.\n * @part quickview-modal-header-title - The title of the modal.\n */\n@Component({\n  tag: 'atomic-quickview-modal',\n  styleUrl: 'atomic-quickview-modal.pcss',\n  shadow: true,\n})\nexport class AtomicQuickviewModal implements InitializableComponent {\n  @InitializeBindings() public bindings!: Bindings;\n  @State() public error!: Error;\n\n  @State() private highlightKeywords: HighlightKeywords = {\n    highlightNone: false,\n    keywords: {},\n  };\n  @Watch('highlightKeywords')\n  watchHighlightKeywords() {\n    this.handleHighlightsScripts();\n  }\n\n  @Event({eventName: 'atomic/quickview/next'}) nextQuickview?: EventEmitter;\n  @Event({eventName: 'atomic/quickview/previous'})\n  previousQuickview?: EventEmitter;\n\n  @State() private minimizeSidebar = false;\n  @State() private words: Record<string, QuickviewWordHighlight> = {};\n  private iframeRef?: HTMLIFrameElement;\n\n  @Prop({mutable: true, reflect: false}) content?: string;\n  @Prop({mutable: true, reflect: false}) result?: Result;\n  @Prop() current?: number;\n  @Prop() total?: number;\n  @Prop() sandbox?: string;\n  @Prop() modalCloseCallback?: () => void;\n\n  private interactiveResult?: InteractiveResult;\n\n  public componentWillRender(): void {\n    this.minimizeSidebar = this.bindings.store.isMobile();\n  }\n\n  @Method()\n  public async reset() {\n    this.highlightKeywords = {\n      highlightNone: false,\n      keywords: {},\n    };\n    this.minimizeSidebar = false;\n    this.iframeRef = undefined;\n    this.content = undefined;\n    this.result = undefined;\n    this.interactiveResult = undefined;\n  }\n\n  private renderHeader() {\n    let headerContent: VNode | null = null;\n    if (this.result) {\n      this.interactiveResult = buildInteractiveResult(this.bindings.engine, {\n        options: {result: this.result},\n      });\n      headerContent = (\n        <Fragment>\n          <LinkWithItemAnalytics\n            href={this.result?.clickUri}\n            onSelect={() => this.interactiveResult?.select()}\n            onBeginDelayedSelect={() =>\n              this.interactiveResult?.beginDelayedSelect()\n            }\n            onCancelPendingSelect={() =>\n              this.interactiveResult?.cancelPendingSelect()\n            }\n            className=\"truncate\"\n            part=\"quickview-modal-header-title\"\n          >\n            {this.result.title}\n          </LinkWithItemAnalytics>\n          <IconButton\n            partPrefix=\"quickview-modal-header\"\n            icon={CloseIcon}\n            onClick={() => this.onClose()}\n            ariaLabel={this.bindings.i18n.t('close')}\n            style=\"text-transparent\"\n            title={this.bindings.i18n.t('close')}\n          />\n        </Fragment>\n      );\n    }\n    return (\n      <div slot=\"header\" class=\"w-full flex justify-between items-center\">\n        {headerContent}\n      </div>\n    );\n  }\n\n  private renderBody() {\n    return (\n      <div slot=\"body\" class=\"grid grid-cols-[min-content_auto] h-full\">\n        <div\n          class=\"h-full overflow-y-auto\"\n          style={{backgroundColor: 'var(--atomic-neutral-light)'}}\n        >\n          <QuickviewSidebar\n            words={this.words}\n            i18n={this.bindings.i18n}\n            highlightKeywords={this.highlightKeywords}\n            onHighlightKeywords={(highlight) =>\n              (this.highlightKeywords = highlight)\n            }\n            minimized={this.minimizeSidebar}\n            onMinimize={(minimize) => (this.minimizeSidebar = minimize)}\n          />\n        </div>\n        <div class=\"overflow-auto relative\">\n          <QuickviewIframe\n            logger={this.logger}\n            src={this.quickviewSrc}\n            sandbox={this.sandbox}\n            uniqueIdentifier={this.quickviewUniqueIdentifier}\n            content={this.content}\n            onSetIframeRef={async (ref) => {\n              this.iframeRef = ref;\n              this.words = getWordsHighlights(\n                this.termsToHighlight,\n                this.iframeRef\n              );\n              this.handleHighlightsScripts();\n            }}\n          />\n          {buildQuickviewPreviewBar(\n            this.words,\n            this.highlightKeywords,\n            this.iframeRef\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  private renderFooter() {\n    return (\n      <div slot=\"footer\" class=\"flex items-center gap-2\">\n        <Button\n          class=\"p-2\"\n          style=\"square-neutral\"\n          onClick={() => this.previousQuickview?.emit()}\n          text={this.bindings.i18n.t('quickview-previous')}\n        ></Button>\n        <p class=\"text-center\">\n          {this.bindings.i18n.t('showing-results-of', {\n            first: this.current,\n            total: this.total,\n          })}\n        </p>\n        <Button\n          class=\"p-2\"\n          style=\"square-neutral\"\n          onClick={() => this.nextQuickview?.emit()}\n          text={this.bindings.i18n.t('quickview-next')}\n        ></Button>\n      </div>\n    );\n  }\n\n  private onClose() {\n    this.content = undefined;\n    this.result = undefined;\n    this.modalCloseCallback && this.modalCloseCallback();\n  }\n\n  private get isOpen() {\n    return !!this.content && !!this.result;\n  }\n\n  private get highlightScriptId() {\n    return 'CoveoDisableHighlightStyle';\n  }\n\n  private get logger() {\n    return this.bindings.engine.logger;\n  }\n\n  private get quickviewSrc() {\n    return this.bindings.engine.state.resultPreview?.contentURL;\n  }\n\n  private enableHighlights() {\n    this.removeDisableHighlightScript();\n  }\n\n  private enableHighlightsSpecificKeyword(identifier: string) {\n    this.removeDisableHighlightScript(identifier);\n  }\n\n  private disableHighlights() {\n    this.createDisableHighlightScript();\n  }\n\n  private disableHighlightsSpecificKeyword(identifier: string) {\n    this.createDisableHighlightScript(identifier);\n  }\n\n  private removeDisableHighlightScript(identifier?: string) {\n    const doc = this.iframeRef?.contentWindow?.document;\n    if (!doc) {\n      return;\n    }\n    doc\n      .getElementById(\n        `${this.highlightScriptId}${identifier ? `:${identifier}` : ''}`\n      )\n      ?.remove();\n  }\n\n  private createDisableHighlightScript(identifier?: string) {\n    const doc = this.iframeRef?.contentWindow?.document;\n    if (!doc) {\n      return;\n    }\n\n    const head = doc.head;\n    const scriptId = `${this.highlightScriptId}${\n      identifier ? `:${identifier}` : ''\n    }`;\n    const style =\n      doc.getElementById(scriptId) || this.bindings.createStyleElement();\n    style.setAttribute('id', scriptId);\n    head.appendChild(style);\n    style.appendChild(\n      doc.createTextNode(`[id^=\"${HIGHLIGHT_PREFIX}${\n        identifier ? `:${identifier}` : ''\n      }\"] {\n      background-color: inherit !important;\n      color: inherit !important;\n    }`)\n    );\n  }\n\n  private get termsToHighlight() {\n    const flatPhrasesToHighlight: TermsToHighlight = {};\n\n    const phrasesToHighlight =\n      this.bindings.engine.state.search.response.phrasesToHighlight;\n\n    Object.entries(phrasesToHighlight).forEach(([phrase, keywords]) => {\n      flatPhrasesToHighlight[phrase] = Object.entries(keywords).flatMap(\n        ([keywordEntry, keywordStemming]) => {\n          return [keywordEntry, ...keywordStemming];\n        }\n      );\n    });\n\n    return {\n      ...this.bindings.engine.state.search.response.termsToHighlight,\n      ...flatPhrasesToHighlight,\n    };\n  }\n\n  private get requestId() {\n    return this.bindings.engine.state.search.requestId;\n  }\n\n  private get quickviewUniqueIdentifier() {\n    return this.result?.uniqueId + this.requestId;\n  }\n\n  private handleHighlightsScripts() {\n    if (!this.highlightKeywords.highlightNone) {\n      this.enableHighlights();\n    } else {\n      this.disableHighlights();\n    }\n    Object.values(this.highlightKeywords.keywords).forEach((word) => {\n      if (word.enabled) {\n        this.enableHighlightsSpecificKeyword(word.indexIdentifier);\n      } else {\n        this.disableHighlightsSpecificKeyword(word.indexIdentifier);\n      }\n    });\n  }\n\n  public render() {\n    return (\n      <atomic-modal\n        fullscreen={this.bindings.store.isMobile()}\n        class={'atomic-quickview-modal'}\n        isOpen={this.isOpen}\n        close={() => this.onClose()}\n      >\n        {this.renderHeader()}\n        {this.renderBody()}\n        {this.renderFooter()}\n      </atomic-modal>\n    );\n  }\n}\n"],"version":3}