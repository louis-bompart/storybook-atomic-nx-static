{"file":"search-suggestion-c6ba8a04.js","mappings":"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","names":[],"sources":["src/components/common/search-box/search-box-wrapper.tsx","src/components/common/search-box/text-area-clear-button.tsx","src/components/common/search-box/search-text-area.tsx","src/utils/promise-utils.ts","src/components/common/suggestions/suggestion-manager.ts","src/components/search/atomic-search-box/search-suggestion.tsx"],"sourcesContent":["import {FunctionalComponent, h} from '@stencil/core';\r\n\r\ninterface Props {\r\n  disabled: boolean;\r\n  textArea?: boolean;\r\n}\r\n\r\nexport const SearchBoxWrapper: FunctionalComponent<Props> = (\r\n  props,\r\n  children\r\n) => {\r\n  const getClasses = () => {\r\n    const baseClasses =\r\n      'flex bg-background w-full border border-neutral rounded-md focus-within:ring';\r\n    const focusClasses = props.disabled\r\n      ? 'focus-within:border-disabled focus-within:ring-neutral'\r\n      : 'focus-within:border-primary focus-within:ring-ring-primary';\r\n    const inputTypeClasses = props.textArea\r\n      ? 'absolute top-0 left-0'\r\n      : 'relative h-full';\r\n\r\n    return [baseClasses, focusClasses, inputTypeClasses].join(' ');\r\n  };\r\n\r\n  return (\r\n    <div part=\"wrapper\" class={getClasses()}>\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n","import {FunctionalComponent, h} from '@stencil/core';\r\nimport ClearSlim from '../../../images/clear-slim.svg';\r\nimport {Button, ButtonProps} from '../button';\r\nimport {AnyBindings} from '../interface/bindings';\r\n\r\ninterface Props extends Partial<ButtonProps> {\r\n  bindings: AnyBindings;\r\n  inputRef: HTMLInputElement | HTMLTextAreaElement | null;\r\n}\r\n\r\nexport const TextAreaClearButton: FunctionalComponent<Props> = ({\r\n  inputRef,\r\n  bindings,\r\n  onClick,\r\n  ...defaultButtonProps\r\n}) => (\r\n  <div\r\n    part=\"clear-button-wrapper\"\r\n    class=\"py-2 flex items-start justify-center items-center ml-2\"\r\n  >\r\n    <Button\r\n      style=\"text-transparent\"\r\n      part=\"clear-button\"\r\n      class=\"flex items-center justify-center w-8 h-8 text-neutral-dark shrink-0\"\r\n      onClick={() => {\r\n        onClick?.();\r\n        inputRef?.focus();\r\n      }}\r\n      ariaLabel={bindings.i18n.t('clear')}\r\n      {...defaultButtonProps}\r\n    >\r\n      <atomic-icon\r\n        part=\"clear-icon\"\r\n        icon={ClearSlim}\r\n        class=\"w-4 h-4\"\r\n      ></atomic-icon>\r\n    </Button>\r\n  </div>\r\n);\r\n","import {FunctionalComponent, h} from '@stencil/core';\r\nimport {JSXBase} from '@stencil/core/internal';\r\nimport {AnyBindings} from '../interface/bindings';\r\nimport {TextAreaClearButton} from './text-area-clear-button';\r\n\r\ninterface Props extends JSXBase.TextareaHTMLAttributes<HTMLTextAreaElement> {\r\n  textAreaRef: HTMLTextAreaElement;\r\n  loading: boolean;\r\n  bindings: AnyBindings;\r\n  value: string;\r\n  ariaLabel: string;\r\n  onClear(): void;\r\n  popup?: {\r\n    id: string;\r\n    activeDescendant: string;\r\n    expanded: boolean;\r\n    hasSuggestions: boolean;\r\n  };\r\n}\r\n\r\nfunction getPopupAttributes(props: Required<Props>['popup']) {\r\n  return {\r\n    role: 'combobox',\r\n    autocomplete: 'off',\r\n    autocapitalize: 'off',\r\n    autocorrect: 'off',\r\n    ...(props.activeDescendant && {\r\n      'aria-activedescendant': props.activeDescendant,\r\n    }),\r\n    'aria-expanded': `${props.hasSuggestions && props.expanded}`,\r\n    'aria-autocomplete': 'both',\r\n    'aria-haspopup': 'true',\r\n    'aria-controls': props.id,\r\n  };\r\n}\r\n\r\nfunction syncTextWithReplica(elem: HTMLTextAreaElement, value?: string) {\r\n  const parent = elem?.parentNode as HTMLElement;\r\n  if (!parent) {\r\n    return;\r\n  }\r\n  if (elem.value === '\\n') {\r\n    return;\r\n  }\r\n  parent.dataset.replicatedValue = value ?? elem.value;\r\n}\r\n\r\nfunction resetReplicaText(elem: HTMLTextAreaElement) {\r\n  const parent = elem?.parentNode as HTMLElement;\r\n  if (parent) {\r\n    delete parent.dataset.replicatedValue;\r\n  }\r\n}\r\n\r\nfunction collapseTextArea(elem: HTMLTextAreaElement) {\r\n  const parent = elem?.parentNode as HTMLElement;\r\n  if (parent) {\r\n    parent.classList.remove('expanded');\r\n  }\r\n}\r\n\r\nfunction expandTextArea(elem: HTMLTextAreaElement) {\r\n  const parent = elem?.parentNode as HTMLElement;\r\n  if (parent) {\r\n    parent.classList.add('expanded');\r\n  }\r\n}\r\n\r\nexport const SearchTextArea: FunctionalComponent<Props> = ({\r\n  textAreaRef,\r\n  loading,\r\n  bindings,\r\n  onInput,\r\n  onFocus,\r\n  onBlur,\r\n  onChange,\r\n  onKeyDown,\r\n  onKeyUp,\r\n  value,\r\n  ariaLabel,\r\n  onClear,\r\n  popup,\r\n  ...defaultInputProps\r\n}) => (\r\n  <div class=\"grow flex overflow-hidden\">\r\n    <div part=\"textarea-expander\" class=\"grow grid overflow-hidden\">\r\n      <textarea\r\n        part=\"textarea\"\r\n        aria-label={ariaLabel}\r\n        placeholder={bindings.i18n.t('search')}\r\n        class=\"placeholder-neutral-dark\"\r\n        rows={1}\r\n        onInput={(e) => {\r\n          onInput?.(e);\r\n          syncTextWithReplica(textAreaRef);\r\n        }}\r\n        onKeyDown={(e) => {\r\n          syncTextWithReplica(textAreaRef);\r\n          if (e.key === 'Enter') {\r\n            if (e.shiftKey) {\r\n              return;\r\n            }\r\n            e.preventDefault();\r\n          }\r\n          onKeyDown?.(e);\r\n        }}\r\n        onKeyUp={(e) => {\r\n          onKeyUp?.(e);\r\n          if (e.key === 'Enter') {\r\n            e.preventDefault();\r\n            return;\r\n          }\r\n          syncTextWithReplica(textAreaRef);\r\n        }}\r\n        onBlur={(e) => {\r\n          onBlur?.(e);\r\n          collapseTextArea(textAreaRef);\r\n          syncTextWithReplica(textAreaRef);\r\n        }}\r\n        onChange={(e) => {\r\n          onChange?.(e);\r\n          syncTextWithReplica(textAreaRef);\r\n        }}\r\n        onFocus={(e) => {\r\n          onFocus?.(e);\r\n          const target = e.target as HTMLTextAreaElement;\r\n          syncTextWithReplica(textAreaRef ?? target);\r\n          expandTextArea(textAreaRef ?? target);\r\n        }}\r\n        autocomplete=\"off\"\r\n        {...(popup && getPopupAttributes(popup))}\r\n        {...defaultInputProps}\r\n        value={value}\r\n      />\r\n    </div>\r\n\r\n    {loading && (\r\n      <div class=\"searchbox-button-wrapper flex items-center justify-center ml-2\">\r\n        <span\r\n          part=\"loading\"\r\n          class=\"loading w-5 h-5 rounded-full bg-gradient-to-r animate-spin mr-2 grid place-items-center\"\r\n        ></span>\r\n      </div>\r\n    )}\r\n    {!loading && value && (\r\n      <TextAreaClearButton\r\n        inputRef={textAreaRef}\r\n        bindings={bindings}\r\n        onClick={() => {\r\n          onClear();\r\n          resetReplicaText(textAreaRef);\r\n        }}\r\n      />\r\n    )}\r\n  </div>\r\n);\r\n","export function promiseTimeout<T>(prom: T | Promise<T>, ms: number) {\r\n  let id: NodeJS.Timeout;\r\n  const timeout = new Promise((_, reject) => {\r\n    id = setTimeout(() => {\r\n      reject(new Error('Promise timed out.'));\r\n    }, ms);\r\n  });\r\n  return Promise.race([prom, timeout]).then(() => {\r\n    clearTimeout(id);\r\n  });\r\n}\r\n","import {isNullOrUndefined} from '@coveo/bueno';\r\nimport {forceUpdate} from '@stencil/core';\r\nimport DOMPurify from 'dompurify';\r\nimport {debounce} from '../../../utils/debounce-utils';\r\nimport {promiseTimeout} from '../../../utils/promise-utils';\r\nimport {\r\n  SearchBoxSuggestionElement,\r\n  SearchBoxSuggestionsBindings,\r\n  SearchBoxSuggestionsEvent,\r\n  elementHasNoQuery,\r\n  elementHasQuery,\r\n} from './suggestions-common';\r\n\r\n/**\r\n * List of suggestions that will be displayed along other lists (e.g recent queries) when the search box's input is selected.\r\n */\r\nexport interface SearchBoxSuggestions {\r\n  /**\r\n   * The search box will sort the position of suggestions using this value, the lowest value being first.\r\n   * By default, the DOM position will be used.\r\n   */\r\n  position: number;\r\n  /**\r\n   * Whether the suggestions should be listed in the right or left panel. By default, the suggestions are listed in the right panel.\r\n   */\r\n  panel?: 'left' | 'right';\r\n  /**\r\n   * Method that returns the list of elements which will be rendered in the list of suggestions.\r\n   */\r\n  renderItems(): SearchBoxSuggestionElement[];\r\n  /**\r\n   * Hook called when the user changes the search box's input value. This can lead to all the query suggestions being updated.\r\n   */\r\n  onInput?(): Promise<unknown> | void;\r\n  /**\r\n   * Hook called when the current suggested query changes as the user navigates the list of suggestions.\r\n   * This is used for instant results, which are rendered based on the current suggested query.\r\n   * @param q The new current suggested query.\r\n   */\r\n  onSuggestedQueryChange?(q: string): Promise<unknown> | void;\r\n}\r\n\r\ninterface SearchBoxProps {\r\n  getSearchBoxValue: () => string;\r\n  updateQuery: (suggestedQuery: string) => void;\r\n  getSuggestionTimeout: () => number;\r\n  getNumberOfSuggestionsToDisplay: () => number;\r\n  getSuggestionDelay: () => number;\r\n  getLogger: () => Pick<typeof console, 'warn'>;\r\n  getHost: () => HTMLElement;\r\n}\r\n\r\nexport class SuggestionManager<SearchBoxController> {\r\n  public suggestions: SearchBoxSuggestions[] = [];\r\n  public leftSuggestionElements: SearchBoxSuggestionElement[] = [];\r\n  public rightSuggestionElements: SearchBoxSuggestionElement[] = [];\r\n  public leftPanel: HTMLElement | undefined = undefined;\r\n  public rightPanel: HTMLElement | undefined = undefined;\r\n  public triggerSuggestions: () => Promise<void>;\r\n  public activeDescendant = '';\r\n  public suggestedQuery = '';\r\n\r\n  private queryDataAttribute = 'data-query';\r\n  private suggestionEvents: SearchBoxSuggestionsEvent<SearchBoxController>[] =\r\n    [];\r\n\r\n  private previousActiveDescendantElement: HTMLElement | null = null;\r\n  private leftSuggestions: SearchBoxSuggestions[] = [];\r\n  private rightSuggestions: SearchBoxSuggestions[] = [];\r\n\r\n  constructor(private ownerSearchBoxProps: SearchBoxProps) {\r\n    this.triggerSuggestions = debounce(\r\n      () => this.executeQuerySuggestion(),\r\n      this.ownerSearchBoxProps.getSuggestionDelay()\r\n    );\r\n  }\r\n\r\n  public get partialSuggestionBindings(): Pick<\r\n    SearchBoxSuggestionsBindings<SearchBoxController>,\r\n    | 'suggestedQuery'\r\n    | 'clearSuggestions'\r\n    | 'triggerSuggestions'\r\n    | 'getSuggestions'\r\n    | 'getSuggestionElements'\r\n  > {\r\n    return {\r\n      suggestedQuery: () => this.suggestedQuery,\r\n      clearSuggestions: () => this.clearSuggestions(),\r\n      triggerSuggestions: () => this.triggerSuggestions(),\r\n      getSuggestions: () => this.suggestions,\r\n      getSuggestionElements: () => this.allSuggestionElements,\r\n    };\r\n  }\r\n\r\n  public get activeDescendantElement(): HTMLElement | null {\r\n    if (!this.hasActiveDescendant) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      this.leftPanel?.querySelector(`#${this.activeDescendant}`) ||\r\n      this.rightPanel?.querySelector(`#${this.activeDescendant}`) ||\r\n      null\r\n    );\r\n  }\r\n\r\n  public onSubmit() {\r\n    this.updateActiveDescendant();\r\n    this.clearSuggestions();\r\n  }\r\n\r\n  public updateActiveDescendant(id = '') {\r\n    this.activeDescendant = id;\r\n    forceUpdate(this.ownerSearchBoxProps.getHost());\r\n  }\r\n\r\n  public clickOnActiveElement() {\r\n    this.activeDescendantElement?.click();\r\n    this.updateActiveDescendant();\r\n  }\r\n\r\n  public isRightPanelInFocus() {\r\n    if (\r\n      isNullOrUndefined(this.panelInFocus) ||\r\n      isNullOrUndefined(this.rightPanel)\r\n    ) {\r\n      return false;\r\n    }\r\n\r\n    return this.panelInFocus === this.rightPanel;\r\n  }\r\n\r\n  public initializeSuggestions(\r\n    bindings: SearchBoxSuggestionsBindings<SearchBoxController>\r\n  ) {\r\n    this.suggestions = this.suggestionEvents.map((event) => event(bindings));\r\n  }\r\n\r\n  public registerSuggestionsFromEvent(\r\n    event: CustomEvent<SearchBoxSuggestionsEvent<SearchBoxController>>,\r\n    bindings: SearchBoxSuggestionsBindings<SearchBoxController>\r\n  ) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    this.suggestionEvents.push(event.detail);\r\n    this.suggestions.push(event.detail(bindings));\r\n  }\r\n\r\n  public registerSuggestions(suggestions: SearchBoxSuggestions) {\r\n    this.suggestions.push(suggestions);\r\n  }\r\n\r\n  public get isDoubleList() {\r\n    return Boolean(\r\n      this.leftSuggestionElements.length && this.rightSuggestionElements.length\r\n    );\r\n  }\r\n\r\n  public focusPanel(side: 'left' | 'right') {\r\n    const panel = side === 'left' ? this.leftPanel : this.rightPanel;\r\n\r\n    if (this.panelInFocus === panel) {\r\n      return;\r\n    }\r\n    if (panel && panel.firstElementChild) {\r\n      const panelHasActiveDescendant =\r\n        this.previousActiveDescendantElement &&\r\n        panel.contains(this.previousActiveDescendantElement);\r\n      const newValue = panelHasActiveDescendant\r\n        ? this.previousActiveDescendantElement!\r\n        : (panel.firstElementChild as HTMLElement);\r\n      this.updateDescendants(newValue.id);\r\n    }\r\n  }\r\n\r\n  public clearSuggestions() {\r\n    this.clearSuggestionElements();\r\n    this.updateActiveDescendant();\r\n  }\r\n\r\n  public focusNextValue() {\r\n    if (!this.hasSuggestions || !this.nextOrFirstValue) {\r\n      return;\r\n    }\r\n\r\n    this.focusValue(this.nextOrFirstValue as HTMLElement);\r\n  }\r\n\r\n  public focusValue(value: HTMLElement) {\r\n    this.updateActiveDescendant(value.id);\r\n    this.scrollActiveDescendantIntoView();\r\n    this.updateQueryFromSuggestion();\r\n  }\r\n\r\n  public onSuggestionMouseOver(\r\n    item: SearchBoxSuggestionElement,\r\n    side: 'left' | 'right',\r\n    id: string\r\n  ) {\r\n    const thisPanel = side === 'left' ? this.leftPanel : this.rightPanel;\r\n    if (this.panelInFocus === thisPanel) {\r\n      this.updateActiveDescendant(id);\r\n    } else {\r\n      this.updateDescendants(id);\r\n    }\r\n    if (item.query) {\r\n      this.updateSuggestedQuery(item.query);\r\n    }\r\n  }\r\n\r\n  public onSuggestionClick(item: SearchBoxSuggestionElement, e: Event) {\r\n    if (item.query) {\r\n      this.clearSuggestions();\r\n      this.updateOwnerSearchboxQuery(item.query);\r\n    }\r\n    item.onSelect && item.onSelect(e);\r\n  }\r\n\r\n  public get hasSuggestions() {\r\n    return !!this.allSuggestionElements.length;\r\n  }\r\n\r\n  public get allSuggestionElements() {\r\n    return [...this.leftSuggestionElements, ...this.rightSuggestionElements];\r\n  }\r\n\r\n  public focusPreviousValue() {\r\n    if (this.firstValue === this.activeDescendantElement) {\r\n      this.updateActiveDescendant();\r\n      return;\r\n    }\r\n\r\n    if (!this.hasSuggestions || !this.previousOrLastValue) {\r\n      return;\r\n    }\r\n\r\n    this.focusValue(this.previousOrLastValue as HTMLElement);\r\n  }\r\n\r\n  public get hasActiveDescendant() {\r\n    return this.activeDescendant !== '';\r\n  }\r\n\r\n  private async executeQuerySuggestion() {\r\n    this.updateActiveDescendant();\r\n    const settled = await Promise.allSettled(\r\n      this.suggestions.map((suggestion) =>\r\n        promiseTimeout(\r\n          suggestion.onInput ? suggestion.onInput() : Promise.resolve(),\r\n          this.ownerSearchBoxProps.getSuggestionTimeout()\r\n        )\r\n      )\r\n    );\r\n\r\n    const fulfilledSuggestions: SearchBoxSuggestions[] = [];\r\n\r\n    settled.forEach((prom, j) => {\r\n      if (prom.status === 'fulfilled') {\r\n        fulfilledSuggestions.push(this.suggestions[j]);\r\n      } else {\r\n        this.ownerSearchBoxProps\r\n          .getLogger()\r\n          .warn(\r\n            'Some query suggestions are not being shown because the promise timed out.'\r\n          );\r\n      }\r\n    });\r\n\r\n    const splitSuggestions = (side: 'left' | 'right', isDefault = false) =>\r\n      fulfilledSuggestions\r\n        .filter(\r\n          (suggestion) =>\r\n            suggestion.panel === side || (!suggestion.panel && isDefault)\r\n        )\r\n        .sort(this.sortSuggestions);\r\n\r\n    this.leftSuggestions = splitSuggestions('left', true);\r\n    this.leftSuggestionElements = this.getAndFilterLeftSuggestionElements();\r\n\r\n    this.rightSuggestions = splitSuggestions('right');\r\n    this.rightSuggestionElements = this.getSuggestionElements(\r\n      this.rightSuggestions\r\n    );\r\n\r\n    const defaultSuggestedQuery =\r\n      this.allSuggestionElements.find(elementHasQuery)?.query || '';\r\n\r\n    this.updateSuggestedQuery(defaultSuggestedQuery);\r\n  }\r\n\r\n  private get lastValue() {\r\n    return this.panelInFocus?.lastElementChild;\r\n  }\r\n\r\n  private get previousOrLastValue() {\r\n    if (!this.hasActiveDescendant) {\r\n      return this.lastValue;\r\n    }\r\n\r\n    return (\r\n      this.activeDescendantElement?.previousElementSibling || this.lastValue\r\n    );\r\n  }\r\n\r\n  private sortSuggestions(a: SearchBoxSuggestions, b: SearchBoxSuggestions) {\r\n    return a.position - b.position;\r\n  }\r\n\r\n  private get nextOrFirstValue() {\r\n    if (!this.hasActiveDescendant) {\r\n      return this.firstValue;\r\n    }\r\n\r\n    return this.activeDescendantElement?.nextElementSibling || this.firstValue;\r\n  }\r\n\r\n  private get firstValue() {\r\n    return this.panelInFocus?.firstElementChild;\r\n  }\r\n\r\n  private get panelInFocus() {\r\n    if (this.leftPanel?.contains(this.activeDescendantElement)) {\r\n      return this.leftPanel;\r\n    }\r\n    if (this.rightPanel?.contains(this.activeDescendantElement)) {\r\n      return this.rightPanel;\r\n    }\r\n    return this.leftPanel || this.rightPanel;\r\n  }\r\n\r\n  private scrollActiveDescendantIntoView() {\r\n    this.activeDescendantElement?.scrollIntoView({\r\n      block: 'nearest',\r\n    });\r\n  }\r\n\r\n  private updateQueryFromSuggestion() {\r\n    const suggestedQuery = this.activeDescendantElement?.getAttribute(\r\n      this.queryDataAttribute\r\n    );\r\n    this.updateOwnerSearchboxQuery(suggestedQuery || '');\r\n  }\r\n\r\n  private updateOwnerSearchboxQuery(query: string) {\r\n    if (query && this.ownerSearchBoxProps.getSearchBoxValue() !== query) {\r\n      this.ownerSearchBoxProps.updateQuery(query);\r\n      this.updateSuggestedQuery(query);\r\n    }\r\n  }\r\n\r\n  private async updateSuggestedQuery(suggestedQuery: string) {\r\n    await Promise.allSettled(\r\n      this.suggestions.map((suggestion) =>\r\n        promiseTimeout(\r\n          suggestion.onSuggestedQueryChange\r\n            ? suggestion.onSuggestedQueryChange(suggestedQuery)\r\n            : Promise.resolve(),\r\n          this.ownerSearchBoxProps.getSuggestionTimeout()\r\n        )\r\n      )\r\n    );\r\n    this.suggestedQuery = suggestedQuery;\r\n    this.updateSuggestionElements(suggestedQuery);\r\n    forceUpdate(this.ownerSearchBoxProps.getHost());\r\n  }\r\n\r\n  private updateSuggestionElements(query: string) {\r\n    if (!this.isPanelInFocus(this.leftPanel, query)) {\r\n      this.leftSuggestionElements = this.getAndFilterLeftSuggestionElements();\r\n    }\r\n\r\n    if (!this.isPanelInFocus(this.rightPanel, query)) {\r\n      this.rightSuggestionElements = this.getSuggestionElements(\r\n        this.rightSuggestions\r\n      );\r\n    }\r\n  }\r\n\r\n  private isPanelInFocus(\r\n    panel: HTMLElement | undefined,\r\n    query: string\r\n  ): boolean {\r\n    if (!this.activeDescendantElement) {\r\n      return false;\r\n    }\r\n\r\n    if (query) {\r\n      const escaped = DOMPurify.sanitize(query);\r\n      return !!panel?.querySelector(\r\n        `[${this.queryDataAttribute}=\"${escaped}\"]`\r\n      );\r\n    }\r\n\r\n    return this.activeDescendantElement?.closest('ul') === panel;\r\n  }\r\n\r\n  private getAndFilterLeftSuggestionElements() {\r\n    const suggestionElements = this.getSuggestionElements(this.leftSuggestions);\r\n    const filterOnDuplicate = new Set();\r\n\r\n    const out = suggestionElements.filter((suggestionElement) => {\r\n      if (isNullOrUndefined(suggestionElement.query)) {\r\n        return true;\r\n      }\r\n      if (filterOnDuplicate.has(suggestionElement.query)) {\r\n        return false;\r\n      } else {\r\n        filterOnDuplicate.add(suggestionElement.query);\r\n        return true;\r\n      }\r\n    });\r\n\r\n    return out;\r\n  }\r\n\r\n  private getSuggestionElements(suggestions: SearchBoxSuggestions[]) {\r\n    const elements = suggestions\r\n      .map((suggestion) => suggestion.renderItems())\r\n      .flat();\r\n\r\n    const max =\r\n      this.ownerSearchBoxProps.getNumberOfSuggestionsToDisplay() +\r\n      elements.filter(elementHasNoQuery).length;\r\n\r\n    return elements.slice(0, max);\r\n  }\r\n\r\n  private updateDescendants(activeDescendant = '') {\r\n    const newPrevDescendantElement = this.activeDescendantElement;\r\n    this.previousActiveDescendantElement = newPrevDescendantElement;\r\n    this.updateActiveDescendant(activeDescendant);\r\n  }\r\n\r\n  private clearSuggestionElements() {\r\n    this.leftSuggestionElements = [];\r\n    this.rightSuggestionElements = [];\r\n  }\r\n}\r\n","import {h, FunctionalComponent, VNode, Fragment} from '@stencil/core';\r\nimport {JSXBase} from '@stencil/core/internal';\r\nimport {isMacOS} from '../../../utils/device-utils';\r\nimport {AnyBindings} from '../../common/interface/bindings';\r\nimport {SearchBoxSuggestionElement} from '../../common/suggestions/suggestions-common';\r\n\r\nexport const queryDataAttribute = 'data-query';\r\n\r\ntype Side = 'left' | 'right';\r\n\r\ninterface SearchSuggestionProps {\r\n  bindings: AnyBindings;\r\n  id: string;\r\n  suggestion: SearchBoxSuggestionElement;\r\n  isSelected: boolean;\r\n  side: Side;\r\n  index: number;\r\n  lastIndex: number;\r\n  isDoubleList: boolean;\r\n}\r\n\r\ninterface ButtonSearchSuggestionProps extends SearchSuggestionProps {\r\n  onClick?(e: Event): void;\r\n  onMouseOver?(e: Event): void;\r\n}\r\n\r\nfunction getPartsForSuggestion(\r\n  suggestion: SearchBoxSuggestionElement,\r\n  isSelected: boolean\r\n) {\r\n  let part = 'suggestion';\r\n  if (isSelected) {\r\n    part += ' active-suggestion';\r\n  }\r\n  if (suggestion.query) {\r\n    part += ' suggestion-with-query';\r\n  }\r\n  if (suggestion.part) {\r\n    part += ` ${suggestion.part}`;\r\n  }\r\n  return part;\r\n}\r\n\r\nfunction getClassesForSuggestion(isSelected: boolean) {\r\n  return `flex px-4 min-h-[40px] items-center text-left text-neutral-dark cursor-pointer ${\r\n    isSelected ? 'bg-neutral-light' : ''\r\n  }`;\r\n}\r\n\r\nfunction isHTMLElement(el: VNode | Element): el is HTMLElement {\r\n  return el instanceof HTMLElement;\r\n}\r\n\r\nfunction ensureContentForRenderedSuggestion({\r\n  renderedSuggestion,\r\n  suggestion,\r\n}: {\r\n  renderedSuggestion: HTMLElement;\r\n  suggestion: SearchBoxSuggestionElement;\r\n}) {\r\n  if (isHTMLElement(suggestion.content)) {\r\n    renderedSuggestion.replaceChildren(suggestion.content);\r\n  }\r\n}\r\n\r\nfunction getAriaLabelForRenderedSuggestion({\r\n  bindings,\r\n  renderedSuggestion,\r\n  suggestion,\r\n  side,\r\n  index,\r\n  lastIndex,\r\n  isDoubleList,\r\n  isButton,\r\n}: {\r\n  bindings: AnyBindings;\r\n  renderedSuggestion: HTMLElement;\r\n  suggestion: SearchBoxSuggestionElement;\r\n  side: Side;\r\n  index: number;\r\n  lastIndex: number;\r\n  isDoubleList: boolean;\r\n  isButton: boolean;\r\n}) {\r\n  const contentLabel =\r\n    suggestion.ariaLabel ??\r\n    suggestion.query ??\r\n    renderedSuggestion.innerText ??\r\n    bindings.i18n.t('no-title');\r\n  const labelWithType =\r\n    isMacOS() && isButton\r\n      ? bindings.i18n.t('search-suggestion-button', {\r\n          label: contentLabel,\r\n          interpolation: {escapeValue: false},\r\n        })\r\n      : contentLabel;\r\n  const position = index + 1;\r\n  const count = lastIndex + 1;\r\n\r\n  if (!isDoubleList) {\r\n    return bindings.i18n.t('search-suggestion-single-list', {\r\n      label: labelWithType,\r\n      position,\r\n      count,\r\n      interpolation: {escapeValue: false},\r\n    });\r\n  }\r\n\r\n  return bindings.i18n.t('search-suggestion-double-list', {\r\n    label: labelWithType,\r\n    position,\r\n    count,\r\n    side: bindings.i18n.t(side === 'left' ? 'left' : 'right'),\r\n    interpolation: {escapeValue: false},\r\n  });\r\n}\r\n\r\nfunction getContentForSuggestion(suggestion: SearchBoxSuggestionElement) {\r\n  return !isHTMLElement(suggestion.content) ? (\r\n    suggestion.content\r\n  ) : (\r\n    <Fragment></Fragment>\r\n  );\r\n}\r\n\r\nfunction getCommonSearchSuggestionAttributes(\r\n  {\r\n    bindings,\r\n    id,\r\n    suggestion,\r\n    isSelected,\r\n    side,\r\n    index,\r\n    lastIndex,\r\n    isDoubleList,\r\n  }: SearchSuggestionProps,\r\n  isButton: boolean\r\n): JSXBase.HTMLAttributes<HTMLElement> {\r\n  return {\r\n    id: id,\r\n    key: suggestion.key,\r\n    part: getPartsForSuggestion(suggestion, isSelected),\r\n    class: getClassesForSuggestion(isSelected),\r\n    ref: (el) => {\r\n      if (!el) {\r\n        return;\r\n      }\r\n      ensureContentForRenderedSuggestion({\r\n        renderedSuggestion: el,\r\n        suggestion,\r\n      });\r\n      el.setAttribute(\r\n        'aria-label',\r\n        getAriaLabelForRenderedSuggestion({\r\n          bindings,\r\n          renderedSuggestion: el,\r\n          suggestion,\r\n          side,\r\n          index,\r\n          lastIndex,\r\n          isDoubleList,\r\n          isButton,\r\n        })\r\n      );\r\n    },\r\n  };\r\n}\r\n\r\nexport const SimpleSearchSuggestion: FunctionalComponent<\r\n  SearchSuggestionProps\r\n> = (props) => {\r\n  return (\r\n    <span {...getCommonSearchSuggestionAttributes(props, false)}>\r\n      {getContentForSuggestion(props.suggestion)}\r\n    </span>\r\n  );\r\n};\r\n\r\nexport const ButtonSearchSuggestion: FunctionalComponent<\r\n  ButtonSearchSuggestionProps\r\n> = (props) => {\r\n  return (\r\n    <button\r\n      {...getCommonSearchSuggestionAttributes(props, true)}\r\n      onMouseDown={(e) => e.preventDefault()}\r\n      onClick={(e: Event) => props.onClick?.(e)}\r\n      onMouseOver={(e: Event) => props.onMouseOver?.(e)}\r\n      {...{[queryDataAttribute]: props.suggestion.query}}\r\n    >\r\n      {getContentForSuggestion(props.suggestion)}\r\n    </button>\r\n  );\r\n};\r\n"],"version":3}