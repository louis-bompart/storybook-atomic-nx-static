{"file":"atomic-generated-answer-feedback-modal.entry.js","mappings":"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","names":[],"sources":["src/components/common/generated-answer/atomic-generated-answer-feedback/atomic-generated-answer-feedback-modal.pcss?tag=atomic-generated-answer-feedback-modal&encapsulation=shadow","src/components/common/generated-answer/atomic-generated-answer-feedback/atomic-generated-answer-feedback-modal.tsx"],"sourcesContent":["@import '../../../../global/global.pcss';\n","import {GeneratedAnswer, GeneratedAnswerFeedback} from '@coveo/headless';\nimport {\n  Component,\n  State,\n  h,\n  Watch,\n  Prop,\n  Element,\n  Event,\n  EventEmitter,\n} from '@stencil/core/internal';\nimport {AnyBindings} from '../../../../components';\nimport CloseIcon from '../../../../images/close.svg';\nimport Success from '../../../../images/success.svg';\nimport {\n  InitializableComponent,\n  InitializeBindings,\n} from '../../../../utils/initialization-utils';\nimport {updateBreakpoints} from '../../../../utils/replace-breakpoint';\nimport {once, randomID} from '../../../../utils/utils';\nimport {Button} from '../../button';\nimport {IconButton} from '../../iconButton';\n\n/**\n * @internal\n */\n@Component({\n  tag: 'atomic-generated-answer-feedback-modal',\n  styleUrl: 'atomic-generated-answer-feedback-modal.pcss',\n  shadow: true,\n})\nexport class AtomicGeneratedAnswerFeedbackModal\n  implements InitializableComponent<AnyBindings>\n{\n  @InitializeBindings() public bindings!: AnyBindings;\n  @Element() public host!: HTMLElement;\n\n  /**\n   * Indicates whether the modal is open.\n   */\n  @Prop({reflect: true, mutable: true}) isOpen = false;\n  /**\n   * A `GeneratedAnswer` controller instance. It is used when the user interacts with the modal.\n   */\n  @Prop({reflect: true, mutable: true}) generatedAnswer!: GeneratedAnswer;\n\n  @State() public error!: Error;\n  @State() currentAnswer?: GeneratedAnswerFeedback | 'other' | undefined;\n  @State() feedbackSubmitted: boolean = false;\n\n  private readonly formId = randomID(\n    'atomic-generated-answer-feedback-modal-form-'\n  );\n  private detailsInputRef?: HTMLTextAreaElement;\n\n  @Event() feedbackSent!: EventEmitter;\n\n  @Watch('isOpen')\n  watchToggleOpen(isOpen: boolean) {\n    if (isOpen) {\n      this.generatedAnswer.openFeedbackModal();\n    }\n  }\n\n  private static options: {\n    id: string;\n    localeKey: string;\n    correspondingAnswer: GeneratedAnswerFeedback | 'other';\n  }[] = [\n    {\n      id: 'irrelevant',\n      localeKey: 'irrelevant',\n      correspondingAnswer: 'irrelevant',\n    },\n    {\n      id: 'notAccurate',\n      localeKey: 'not-accurate',\n      correspondingAnswer: 'notAccurate',\n    },\n    {\n      id: 'outOfDate',\n      localeKey: 'out-of-date',\n      correspondingAnswer: 'outOfDate',\n    },\n    {\n      id: 'harmful',\n      localeKey: 'harmful',\n      correspondingAnswer: 'harmful',\n    },\n    {\n      id: 'other',\n      localeKey: 'other',\n      correspondingAnswer: 'other',\n    },\n  ];\n\n  private setIsOpen(isOpen: boolean) {\n    this.isOpen = isOpen;\n  }\n\n  private close() {\n    this.feedbackSubmitted = false;\n    if (this.detailsInputRef) {\n      this.detailsInputRef.value = '';\n    }\n    this.currentAnswer = undefined;\n    this.setIsOpen(false);\n    this.generatedAnswer.closeFeedbackModal();\n  }\n\n  private updateBreakpoints = once(() => updateBreakpoints(this.host));\n\n  private setCurrentAnswer(answer?: GeneratedAnswerFeedback | 'other') {\n    this.currentAnswer = answer;\n  }\n\n  public sendFeedback() {\n    if (this.currentAnswer === 'other') {\n      this.generatedAnswer.sendDetailedFeedback(this.detailsInputRef!.value);\n    } else {\n      this.generatedAnswer.sendFeedback(\n        this.currentAnswer as GeneratedAnswerFeedback\n      );\n    }\n    this.feedbackSent.emit();\n  }\n\n  private renderHeader() {\n    return (\n      <div\n        slot=\"header\"\n        part=\"modal-header\"\n        class=\"w-full flex justify-between items-center\"\n      >\n        <h1>{this.bindings.i18n.t('feedback')}</h1>\n        <IconButton\n          style=\"text-transparent\"\n          class=\"search-clear-button\"\n          onClick={() => this.close()}\n          icon={CloseIcon}\n          partPrefix={'close'}\n          ariaLabel={this.bindings.i18n.t('modal-done')}\n        />\n      </div>\n    );\n  }\n\n  private renderOptions() {\n    return (\n      <fieldset>\n        <legend part=\"reason-title\" class=\"text-base\">\n          {this.bindings.i18n.t('generated-answer-feedback-instructions')}\n        </legend>\n        {AtomicGeneratedAnswerFeedbackModal.options.map(\n          ({id, localeKey, correspondingAnswer}) => (\n            <div\n              class={`flex items-center ${correspondingAnswer} mobile-only:mt-4 desktop-only:mt-6`}\n              key={id}\n              part=\"reason\"\n            >\n              <input\n                part=\"reason-radio\"\n                type=\"radio\"\n                name=\"answer\"\n                id={id}\n                checked={this.currentAnswer === correspondingAnswer}\n                onChange={(e) =>\n                  (e.currentTarget as HTMLInputElement | null)?.checked &&\n                  this.setCurrentAnswer(correspondingAnswer)\n                }\n                class=\"mr-2\"\n                required\n              />\n              <label part=\"reason-label\" htmlFor={id}>\n                {this.bindings.i18n.t(localeKey)}\n              </label>\n            </div>\n          )\n        )}\n      </fieldset>\n    );\n  }\n\n  private renderDetails() {\n    if (this.currentAnswer !== 'other') {\n      return;\n    }\n\n    return (\n      <fieldset>\n        <textarea\n          part=\"details-input\"\n          name=\"answer-details\"\n          ref={(detailsInput) => (this.detailsInputRef = detailsInput)}\n          class=\"mt-2 p-2 w-full text-base leading-5 border border-neutral resize-none rounded\"\n          rows={4}\n          placeholder={this.bindings.i18n.t('add-details')}\n          required\n        ></textarea>\n      </fieldset>\n    );\n  }\n\n  private renderBody() {\n    return !this.feedbackSubmitted ? (\n      <form\n        part=\"form\"\n        id={this.formId}\n        slot=\"body\"\n        onSubmit={(e) => {\n          e.preventDefault();\n          this.feedbackSubmitted = true;\n          this.sendFeedback();\n        }}\n        class=\"flex flex-col gap-8 text-base leading-4 text-neutral-dark p-2\"\n      >\n        {this.renderOptions()}\n        {this.renderDetails()}\n      </form>\n    ) : (\n      <div slot=\"body\" class=\"flex flex-col items-center gap-4 my-4\">\n        <atomic-icon icon={Success} class=\"w-48\" />\n        <p class=\"text-base\">\n          {this.bindings.i18n.t('generated-answer-feedback-success')}\n        </p>\n      </div>\n    );\n  }\n\n  private renderFooter() {\n    return (\n      <div slot=\"footer\" part=\"modalFooter\">\n        {!this.feedbackSubmitted ? (\n          <div part=\"buttons\" class=\"flex justify-end gap-2 px-4\">\n            <Button\n              part=\"cancel-button\"\n              style=\"outline-neutral\"\n              class=\"text-primary flex justify-center text-sm leading-4 p-2\"\n              ariaLabel={this.bindings.i18n.t('close')}\n              onClick={() => this.close()}\n            >\n              {this.bindings.i18n.t('close')}\n            </Button>\n            <Button\n              part=\"submit-button\"\n              style=\"primary\"\n              type=\"submit\"\n              form={this.formId}\n              class=\"flex justify-center text-sm leading-4 p-2\"\n              ariaLabel={this.bindings.i18n.t('feedback-send')}\n            >\n              {this.bindings.i18n.t('feedback-send')}\n            </Button>\n          </div>\n        ) : (\n          <div part=\"buttons\" class=\"flex justify-end gap-2 p-2\">\n            <Button\n              part=\"cancel-button\"\n              style=\"primary\"\n              onClick={() => this.close()}\n              class=\"flex justify-center text-sm leading-4 p-2\"\n              ariaLabel={this.bindings.i18n.t('modal-done')}\n            >\n              {this.bindings.i18n.t('modal-done')}\n            </Button>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  public render() {\n    this.updateBreakpoints();\n\n    return (\n      <atomic-modal\n        fullscreen={false}\n        isOpen={this.isOpen}\n        close={() => this.close()}\n        container={this.host}\n        exportparts=\"backdrop,container,header,header-wrapper,header-ruler,body,body-wrapper,footer,footer-wrapper,footer-wrapper\"\n      >\n        {this.renderHeader()}\n        {this.renderBody()}\n        {this.renderFooter()}\n      </atomic-modal>\n    );\n  }\n}\n"],"version":3}