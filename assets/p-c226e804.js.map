{"version":3,"names":["SmartSnippetSuggestionCommon","constructor","props","this","style","styleTag","_a","getHost","querySelector","content","getSnippetStyle","innerHTML","getRelatedQuestionId","index","id","getQuestionPart","prefix","relatedQuestion","expanded","toggleQuestion","getQuestionsList","collapse","questionAnswerId","expand","renderQuestion","headingLevel","getHeadingLevel","h","Button","part","onClick","class","ariaExpanded","ariaControls","icon","ArrowDown","ArrowRight","Heading","level","question","renderContent","exportparts","htmlContent","answer","innerStyle","onSelectInlineLink","e","selectInlineLink","detail","onBeginDelayedSelectInlineLink","beginDelayedSelectInlineLink","onCancelPendingSelectInlineLink","cancelPendingSelectInlineLink","renderSource","source","getBindings","i18n","t","anchorAttributes","_b","getSourceAnchorAttributes","call","onSelectSource","selectSource","onBeginDelayedSelectSource","beginDelayedSelectSource","onCancelPendingSelectSource","cancelPendingSelectSource","hideDuringRender","shouldHide","host","visibility","position","renderRelatedQuestion","key","render","getState","questions","length","Hidden","map","i"],"sources":["src/components/common/smart-snippets/atomic-smart-snippet-suggestions/smart-snippet-suggestions-common.tsx"],"sourcesContent":["import {\r\n  SmartSnippetRelatedQuestion,\r\n  SmartSnippetQuestionsList,\r\n  SmartSnippetQuestionsListState,\r\n} from '@coveo/headless';\r\nimport {h} from '@stencil/core';\r\nimport ArrowDown from '../../../../images/arrow-down.svg';\r\nimport ArrowRight from '../../../../images/arrow-right.svg';\r\nimport {Button} from '../../button';\r\nimport {Heading} from '../../heading';\r\nimport {Hidden} from '../../hidden';\r\nimport {AnyBindings} from '../../interface/bindings';\r\n\r\ninterface SmartSnippetSuggestionProps {\r\n  id: string;\r\n  getSourceAnchorAttributes?: () => Attr[] | undefined;\r\n  getHost: () => HTMLElement;\r\n  getBindings: () => AnyBindings;\r\n  getHeadingLevel: () => number;\r\n  getState: () => SmartSnippetQuestionsListState;\r\n  getQuestionsList: () => SmartSnippetQuestionsList;\r\n  getSnippetStyle: () => string | undefined;\r\n}\r\n\r\nexport class SmartSnippetSuggestionCommon {\r\n  constructor(private props: SmartSnippetSuggestionProps) {}\r\n\r\n  private get style() {\r\n    const styleTag = this.props\r\n      .getHost()\r\n      .querySelector('template')\r\n      ?.content.querySelector('style');\r\n    if (!styleTag) {\r\n      return this.props.getSnippetStyle();\r\n    }\r\n    return styleTag.innerHTML;\r\n  }\r\n\r\n  private getRelatedQuestionId(index: number) {\r\n    return `${this.props.id}-${index}`;\r\n  }\r\n\r\n  private getQuestionPart(\r\n    prefix: string,\r\n    relatedQuestion: SmartSnippetRelatedQuestion\r\n  ) {\r\n    return prefix + (relatedQuestion.expanded ? '-expanded' : '-collapsed');\r\n  }\r\n\r\n  private toggleQuestion(relatedQuestion: SmartSnippetRelatedQuestion) {\r\n    if (relatedQuestion.expanded) {\r\n      this.props.getQuestionsList().collapse(relatedQuestion.questionAnswerId);\r\n    } else {\r\n      this.props.getQuestionsList().expand(relatedQuestion.questionAnswerId);\r\n    }\r\n  }\r\n\r\n  private renderQuestion(\r\n    relatedQuestion: SmartSnippetRelatedQuestion,\r\n    index: number\r\n  ) {\r\n    const headingLevel = this.props.getHeadingLevel();\r\n    return (\r\n      <Button\r\n        style=\"text-neutral\"\r\n        part={this.getQuestionPart('question-button', relatedQuestion)}\r\n        onClick={() => this.toggleQuestion(relatedQuestion)}\r\n        class=\"flex items-center px-4\"\r\n        ariaExpanded={`${relatedQuestion.expanded}`}\r\n        ariaControls={this.getRelatedQuestionId(index)}\r\n      >\r\n        <atomic-icon\r\n          icon={relatedQuestion.expanded ? ArrowDown : ArrowRight}\r\n          part={this.getQuestionPart('question-icon', relatedQuestion)}\r\n          class=\"w-2.5 mr-3 stroke-[1.25]\"\r\n        ></atomic-icon>\r\n        <Heading\r\n          level={headingLevel ? headingLevel + 1 : headingLevel}\r\n          class=\"text-left text-xl font-bold py-4\"\r\n          part={this.getQuestionPart('question-text', relatedQuestion)}\r\n        >\r\n          {relatedQuestion.question}\r\n        </Heading>\r\n      </Button>\r\n    );\r\n  }\r\n\r\n  private renderContent(relatedQuestion: SmartSnippetRelatedQuestion) {\r\n    return (\r\n      <atomic-smart-snippet-answer\r\n        exportparts=\"answer\"\r\n        htmlContent={relatedQuestion.answer}\r\n        innerStyle={this.style}\r\n        onSelectInlineLink={(e) =>\r\n          this.props\r\n            .getQuestionsList()\r\n            .selectInlineLink(relatedQuestion.questionAnswerId, e.detail)\r\n        }\r\n        onBeginDelayedSelectInlineLink={(e) =>\r\n          this.props\r\n            .getQuestionsList()\r\n            .beginDelayedSelectInlineLink(\r\n              relatedQuestion.questionAnswerId,\r\n              e.detail\r\n            )\r\n        }\r\n        onCancelPendingSelectInlineLink={(e) =>\r\n          this.props\r\n            .getQuestionsList()\r\n            .cancelPendingSelectInlineLink(\r\n              relatedQuestion.questionAnswerId,\r\n              e.detail\r\n            )\r\n        }\r\n      ></atomic-smart-snippet-answer>\r\n    );\r\n  }\r\n\r\n  private renderSource(relatedQuestion: SmartSnippetRelatedQuestion) {\r\n    const {source} = relatedQuestion;\r\n    if (!source) {\r\n      return [];\r\n    }\r\n    return (\r\n      <footer\r\n        part=\"footer\"\r\n        aria-label={this.props.getBindings().i18n.t('smart-snippet-source')}\r\n      >\r\n        {\r\n          <atomic-smart-snippet-source\r\n            source={source}\r\n            anchorAttributes={this.props.getSourceAnchorAttributes?.()}\r\n            onSelectSource={() =>\r\n              this.props\r\n                .getQuestionsList()\r\n                .selectSource(relatedQuestion.questionAnswerId)\r\n            }\r\n            onBeginDelayedSelectSource={() =>\r\n              this.props\r\n                .getQuestionsList()\r\n                .beginDelayedSelectSource(relatedQuestion.questionAnswerId)\r\n            }\r\n            onCancelPendingSelectSource={() =>\r\n              this.props\r\n                .getQuestionsList()\r\n                .cancelPendingSelectSource(relatedQuestion.questionAnswerId)\r\n            }\r\n          ></atomic-smart-snippet-source>\r\n        }\r\n      </footer>\r\n    );\r\n  }\r\n\r\n  public hideDuringRender(shouldHide: boolean) {\r\n    const host = this.props.getHost();\r\n    host.style.visibility = shouldHide ? 'hidden' : '';\r\n    host.style.position = shouldHide ? 'absolute' : '';\r\n  }\r\n\r\n  public renderRelatedQuestion(\r\n    relatedQuestion: SmartSnippetRelatedQuestion,\r\n    index: number\r\n  ) {\r\n    return (\r\n      <li\r\n        key={relatedQuestion.questionAnswerId}\r\n        part={this.getQuestionPart('question-answer', relatedQuestion)}\r\n        class=\"flex flex-col\"\r\n      >\r\n        <article class=\"contents\">\r\n          {this.renderQuestion(relatedQuestion, index)}\r\n          {relatedQuestion.expanded && (\r\n            <div\r\n              part=\"answer-and-source\"\r\n              class=\"pl-10 pr-6 pb-6\"\r\n              id={this.getRelatedQuestionId(index)}\r\n            >\r\n              {this.renderContent(relatedQuestion)}\r\n              {this.renderSource(relatedQuestion)}\r\n            </div>\r\n          )}\r\n        </article>\r\n      </li>\r\n    );\r\n  }\r\n\r\n  public render() {\r\n    if (!this.props.getState().questions.length) {\r\n      return <Hidden></Hidden>;\r\n    }\r\n\r\n    return (\r\n      <aside\r\n        part=\"container\"\r\n        class=\"bg-background border border-neutral rounded-lg text-on-background overflow-hidden\"\r\n      >\r\n        <Heading\r\n          level={this.props.getHeadingLevel()}\r\n          part=\"heading\"\r\n          class=\"px-6 py-4 text-xl leading-8 border-b border-neutral\"\r\n        >\r\n          {this.props.getBindings().i18n.t('smart-snippet-people-also-ask')}\r\n        </Heading>\r\n        <ul part=\"questions\" class=\"divide-neutral divide-y\">\r\n          {this.props\r\n            .getState()\r\n            .questions.map((relatedQuestion, i) =>\r\n              this.renderRelatedQuestion(relatedQuestion, i)\r\n            )}\r\n        </ul>\r\n      </aside>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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"}