{"file":"search-suggestion.js","mappings":"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","names":[],"sources":["src/components/common/search-box/search-box-wrapper.tsx","src/components/common/search-box/text-area-clear-button.tsx","src/components/common/search-box/search-text-area.tsx","src/utils/promise-utils.ts","src/components/common/suggestions/suggestion-manager.ts","src/components/search/atomic-search-box/search-suggestion.tsx"],"sourcesContent":["import {FunctionalComponent, h} from '@stencil/core';\n\ninterface Props {\n  disabled: boolean;\n  textArea?: boolean;\n}\n\nexport const SearchBoxWrapper: FunctionalComponent<Props> = (\n  props,\n  children\n) => {\n  const getClasses = () => {\n    const baseClasses =\n      'flex bg-background w-full border border-neutral rounded-md focus-within:ring';\n    const focusClasses = props.disabled\n      ? 'focus-within:border-disabled focus-within:ring-neutral'\n      : 'focus-within:border-primary focus-within:ring-ring-primary';\n    const inputTypeClasses = props.textArea\n      ? 'absolute top-0 left-0'\n      : 'relative h-full';\n\n    return [baseClasses, focusClasses, inputTypeClasses].join(' ');\n  };\n\n  return (\n    <div part=\"wrapper\" class={getClasses()}>\n      {children}\n    </div>\n  );\n};\n","import {FunctionalComponent, h} from '@stencil/core';\nimport ClearSlim from '../../../images/clear-slim.svg';\nimport {Button, ButtonProps} from '../button';\nimport {AnyBindings} from '../interface/bindings';\n\ninterface Props extends Partial<ButtonProps> {\n  bindings: AnyBindings;\n  inputRef: HTMLInputElement | HTMLTextAreaElement | null;\n}\n\nexport const TextAreaClearButton: FunctionalComponent<Props> = ({\n  inputRef,\n  bindings,\n  onClick,\n  ...defaultButtonProps\n}) => (\n  <div\n    part=\"clear-button-wrapper\"\n    class=\"py-2 flex items-start justify-center items-center ml-2\"\n  >\n    <Button\n      style=\"text-transparent\"\n      part=\"clear-button\"\n      class=\"flex items-center justify-center w-8 h-8 text-neutral-dark shrink-0\"\n      onClick={() => {\n        onClick?.();\n        inputRef?.focus();\n      }}\n      ariaLabel={bindings.i18n.t('clear')}\n      {...defaultButtonProps}\n    >\n      <atomic-icon\n        part=\"clear-icon\"\n        icon={ClearSlim}\n        class=\"w-4 h-4\"\n      ></atomic-icon>\n    </Button>\n  </div>\n);\n","import {FunctionalComponent, h} from '@stencil/core';\nimport {JSXBase} from '@stencil/core/internal';\nimport {AnyBindings} from '../interface/bindings';\nimport {TextAreaClearButton} from './text-area-clear-button';\n\ninterface Props extends JSXBase.TextareaHTMLAttributes<HTMLTextAreaElement> {\n  textAreaRef: HTMLTextAreaElement;\n  loading: boolean;\n  bindings: AnyBindings;\n  value: string;\n  ariaLabel: string;\n  onClear(): void;\n  popup?: {\n    id: string;\n    activeDescendant: string;\n    expanded: boolean;\n    hasSuggestions: boolean;\n  };\n}\n\nfunction getPopupAttributes(props: Required<Props>['popup']) {\n  return {\n    role: 'combobox',\n    autocomplete: 'off',\n    autocapitalize: 'off',\n    autocorrect: 'off',\n    ...(props.activeDescendant && {\n      'aria-activedescendant': props.activeDescendant,\n    }),\n    'aria-expanded': `${props.hasSuggestions && props.expanded}`,\n    'aria-autocomplete': 'both',\n    'aria-haspopup': 'true',\n    'aria-controls': props.id,\n  };\n}\n\nfunction syncTextWithReplica(elem: HTMLTextAreaElement, value?: string) {\n  const parent = elem?.parentNode as HTMLElement;\n  if (!parent) {\n    return;\n  }\n  if (elem.value === '\\n') {\n    return;\n  }\n  parent.dataset.replicatedValue = value ?? elem.value;\n}\n\nfunction resetReplicaText(elem: HTMLTextAreaElement) {\n  const parent = elem?.parentNode as HTMLElement;\n  if (parent) {\n    delete parent.dataset.replicatedValue;\n  }\n}\n\nfunction collapseTextArea(elem: HTMLTextAreaElement) {\n  const parent = elem?.parentNode as HTMLElement;\n  if (parent) {\n    parent.classList.remove('expanded');\n  }\n}\n\nfunction expandTextArea(elem: HTMLTextAreaElement) {\n  const parent = elem?.parentNode as HTMLElement;\n  if (parent) {\n    parent.classList.add('expanded');\n  }\n}\n\nexport const SearchTextArea: FunctionalComponent<Props> = ({\n  textAreaRef,\n  loading,\n  bindings,\n  onInput,\n  onFocus,\n  onBlur,\n  onChange,\n  onKeyDown,\n  onKeyUp,\n  value,\n  ariaLabel,\n  onClear,\n  popup,\n  ...defaultInputProps\n}) => (\n  <div class=\"grow flex overflow-hidden\">\n    <div part=\"textarea-expander\" class=\"grow grid overflow-hidden\">\n      <textarea\n        part=\"textarea\"\n        aria-label={ariaLabel}\n        placeholder={bindings.i18n.t('search')}\n        class=\"placeholder-neutral-dark\"\n        rows={1}\n        onInput={(e) => {\n          onInput?.(e);\n          syncTextWithReplica(textAreaRef);\n        }}\n        onKeyDown={(e) => {\n          syncTextWithReplica(textAreaRef);\n          if (e.key === 'Enter') {\n            if (e.shiftKey) {\n              return;\n            }\n            e.preventDefault();\n          }\n          onKeyDown?.(e);\n        }}\n        onKeyUp={(e) => {\n          onKeyUp?.(e);\n          if (e.key === 'Enter') {\n            e.preventDefault();\n            return;\n          }\n          syncTextWithReplica(textAreaRef);\n        }}\n        onBlur={(e) => {\n          onBlur?.(e);\n          collapseTextArea(textAreaRef);\n          syncTextWithReplica(textAreaRef);\n        }}\n        onChange={(e) => {\n          onChange?.(e);\n          syncTextWithReplica(textAreaRef);\n        }}\n        onFocus={(e) => {\n          onFocus?.(e);\n          const target = e.target as HTMLTextAreaElement;\n          syncTextWithReplica(textAreaRef ?? target);\n          expandTextArea(textAreaRef ?? target);\n        }}\n        autocomplete=\"off\"\n        {...(popup && getPopupAttributes(popup))}\n        {...defaultInputProps}\n        value={value}\n      />\n    </div>\n\n    {loading && (\n      <div class=\"searchbox-button-wrapper flex items-center justify-center ml-2\">\n        <span\n          part=\"loading\"\n          class=\"loading w-5 h-5 rounded-full bg-gradient-to-r animate-spin mr-2 grid place-items-center\"\n        ></span>\n      </div>\n    )}\n    {!loading && value && (\n      <TextAreaClearButton\n        inputRef={textAreaRef}\n        bindings={bindings}\n        onClick={() => {\n          onClear();\n          resetReplicaText(textAreaRef);\n        }}\n      />\n    )}\n  </div>\n);\n","export function promiseTimeout<T>(prom: T | Promise<T>, ms: number) {\n  let id: NodeJS.Timeout;\n  const timeout = new Promise((_, reject) => {\n    id = setTimeout(() => {\n      reject(new Error('Promise timed out.'));\n    }, ms);\n  });\n  return Promise.race([prom, timeout]).then(() => {\n    clearTimeout(id);\n  });\n}\n","import {isNullOrUndefined} from '@coveo/bueno';\nimport {forceUpdate} from '@stencil/core';\nimport DOMPurify from 'dompurify';\nimport {debounce} from '../../../utils/debounce-utils';\nimport {promiseTimeout} from '../../../utils/promise-utils';\nimport {\n  SearchBoxSuggestionElement,\n  SearchBoxSuggestionsBindings,\n  SearchBoxSuggestionsEvent,\n  elementHasNoQuery,\n  elementHasQuery,\n} from './suggestions-common';\n\n/**\n * List of suggestions that will be displayed along other lists (e.g recent queries) when the search box's input is selected.\n */\nexport interface SearchBoxSuggestions {\n  /**\n   * The search box will sort the position of suggestions using this value, the lowest value being first.\n   * By default, the DOM position will be used.\n   */\n  position: number;\n  /**\n   * Whether the suggestions should be listed in the right or left panel. By default, the suggestions are listed in the right panel.\n   */\n  panel?: 'left' | 'right';\n  /**\n   * Method that returns the list of elements which will be rendered in the list of suggestions.\n   */\n  renderItems(): SearchBoxSuggestionElement[];\n  /**\n   * Hook called when the user changes the search box's input value. This can lead to all the query suggestions being updated.\n   */\n  onInput?(): Promise<unknown> | void;\n  /**\n   * Hook called when the current suggested query changes as the user navigates the list of suggestions.\n   * This is used for instant results, which are rendered based on the current suggested query.\n   * @param q The new current suggested query.\n   */\n  onSuggestedQueryChange?(q: string): Promise<unknown> | void;\n}\n\ninterface SearchBoxProps {\n  getSearchBoxValue: () => string;\n  updateQuery: (suggestedQuery: string) => void;\n  getSuggestionTimeout: () => number;\n  getNumberOfSuggestionsToDisplay: () => number;\n  getSuggestionDelay: () => number;\n  getLogger: () => Pick<typeof console, 'warn'>;\n  getHost: () => HTMLElement;\n}\n\nexport class SuggestionManager<SearchBoxController> {\n  public suggestions: SearchBoxSuggestions[] = [];\n  public leftSuggestionElements: SearchBoxSuggestionElement[] = [];\n  public rightSuggestionElements: SearchBoxSuggestionElement[] = [];\n  public leftPanel: HTMLElement | undefined = undefined;\n  public rightPanel: HTMLElement | undefined = undefined;\n  public triggerSuggestions: () => Promise<void>;\n  public activeDescendant = '';\n  public suggestedQuery = '';\n\n  private queryDataAttribute = 'data-query';\n  private suggestionEvents: SearchBoxSuggestionsEvent<SearchBoxController>[] =\n    [];\n\n  private previousActiveDescendantElement: HTMLElement | null = null;\n  private leftSuggestions: SearchBoxSuggestions[] = [];\n  private rightSuggestions: SearchBoxSuggestions[] = [];\n\n  constructor(private ownerSearchBoxProps: SearchBoxProps) {\n    this.triggerSuggestions = debounce(\n      () => this.executeQuerySuggestion(),\n      this.ownerSearchBoxProps.getSuggestionDelay()\n    );\n  }\n\n  public get partialSuggestionBindings(): Pick<\n    SearchBoxSuggestionsBindings<SearchBoxController>,\n    | 'suggestedQuery'\n    | 'clearSuggestions'\n    | 'triggerSuggestions'\n    | 'getSuggestions'\n    | 'getSuggestionElements'\n  > {\n    return {\n      suggestedQuery: () => this.suggestedQuery,\n      clearSuggestions: () => this.clearSuggestions(),\n      triggerSuggestions: () => this.triggerSuggestions(),\n      getSuggestions: () => this.suggestions,\n      getSuggestionElements: () => this.allSuggestionElements,\n    };\n  }\n\n  public get activeDescendantElement(): HTMLElement | null {\n    if (!this.hasActiveDescendant) {\n      return null;\n    }\n\n    return (\n      this.leftPanel?.querySelector(`#${this.activeDescendant}`) ||\n      this.rightPanel?.querySelector(`#${this.activeDescendant}`) ||\n      null\n    );\n  }\n\n  public onSubmit() {\n    this.updateActiveDescendant();\n    this.clearSuggestions();\n  }\n\n  public updateActiveDescendant(id = '') {\n    this.activeDescendant = id;\n    forceUpdate(this.ownerSearchBoxProps.getHost());\n  }\n\n  public clickOnActiveElement() {\n    this.activeDescendantElement?.click();\n    this.updateActiveDescendant();\n  }\n\n  public isRightPanelInFocus() {\n    if (\n      isNullOrUndefined(this.panelInFocus) ||\n      isNullOrUndefined(this.rightPanel)\n    ) {\n      return false;\n    }\n\n    return this.panelInFocus === this.rightPanel;\n  }\n\n  public initializeSuggestions(\n    bindings: SearchBoxSuggestionsBindings<SearchBoxController>\n  ) {\n    this.suggestions = this.suggestionEvents.map((event) => event(bindings));\n  }\n\n  public registerSuggestionsFromEvent(\n    event: CustomEvent<SearchBoxSuggestionsEvent<SearchBoxController>>,\n    bindings: SearchBoxSuggestionsBindings<SearchBoxController>\n  ) {\n    event.preventDefault();\n    event.stopPropagation();\n    this.suggestionEvents.push(event.detail);\n    this.suggestions.push(event.detail(bindings));\n  }\n\n  public registerSuggestions(suggestions: SearchBoxSuggestions) {\n    this.suggestions.push(suggestions);\n  }\n\n  public get isDoubleList() {\n    return Boolean(\n      this.leftSuggestionElements.length && this.rightSuggestionElements.length\n    );\n  }\n\n  public focusPanel(side: 'left' | 'right') {\n    const panel = side === 'left' ? this.leftPanel : this.rightPanel;\n\n    if (this.panelInFocus === panel) {\n      return;\n    }\n    if (panel && panel.firstElementChild) {\n      const panelHasActiveDescendant =\n        this.previousActiveDescendantElement &&\n        panel.contains(this.previousActiveDescendantElement);\n      const newValue = panelHasActiveDescendant\n        ? this.previousActiveDescendantElement!\n        : (panel.firstElementChild as HTMLElement);\n      this.updateDescendants(newValue.id);\n    }\n  }\n\n  public clearSuggestions() {\n    this.clearSuggestionElements();\n    this.updateActiveDescendant();\n  }\n\n  public focusNextValue() {\n    if (!this.hasSuggestions || !this.nextOrFirstValue) {\n      return;\n    }\n\n    this.focusValue(this.nextOrFirstValue as HTMLElement);\n  }\n\n  public focusValue(value: HTMLElement) {\n    this.updateActiveDescendant(value.id);\n    this.scrollActiveDescendantIntoView();\n    this.updateQueryFromSuggestion();\n  }\n\n  public onSuggestionMouseOver(\n    item: SearchBoxSuggestionElement,\n    side: 'left' | 'right',\n    id: string\n  ) {\n    const thisPanel = side === 'left' ? this.leftPanel : this.rightPanel;\n    if (this.panelInFocus === thisPanel) {\n      this.updateActiveDescendant(id);\n    } else {\n      this.updateDescendants(id);\n    }\n    if (item.query) {\n      this.updateSuggestedQuery(item.query);\n    }\n  }\n\n  public onSuggestionClick(item: SearchBoxSuggestionElement, e: Event) {\n    if (item.query) {\n      this.clearSuggestions();\n      this.updateOwnerSearchboxQuery(item.query);\n    }\n    item.onSelect && item.onSelect(e);\n  }\n\n  public get hasSuggestions() {\n    return !!this.allSuggestionElements.length;\n  }\n\n  public get allSuggestionElements() {\n    return [...this.leftSuggestionElements, ...this.rightSuggestionElements];\n  }\n\n  public focusPreviousValue() {\n    if (this.firstValue === this.activeDescendantElement) {\n      this.updateActiveDescendant();\n      return;\n    }\n\n    if (!this.hasSuggestions || !this.previousOrLastValue) {\n      return;\n    }\n\n    this.focusValue(this.previousOrLastValue as HTMLElement);\n  }\n\n  public get hasActiveDescendant() {\n    return this.activeDescendant !== '';\n  }\n\n  private async executeQuerySuggestion() {\n    this.updateActiveDescendant();\n    const settled = await Promise.allSettled(\n      this.suggestions.map((suggestion) =>\n        promiseTimeout(\n          suggestion.onInput ? suggestion.onInput() : Promise.resolve(),\n          this.ownerSearchBoxProps.getSuggestionTimeout()\n        )\n      )\n    );\n\n    const fulfilledSuggestions: SearchBoxSuggestions[] = [];\n\n    settled.forEach((prom, j) => {\n      if (prom.status === 'fulfilled') {\n        fulfilledSuggestions.push(this.suggestions[j]);\n      } else {\n        this.ownerSearchBoxProps\n          .getLogger()\n          .warn(\n            'Some query suggestions are not being shown because the promise timed out.'\n          );\n      }\n    });\n\n    const splitSuggestions = (side: 'left' | 'right', isDefault = false) =>\n      fulfilledSuggestions\n        .filter(\n          (suggestion) =>\n            suggestion.panel === side || (!suggestion.panel && isDefault)\n        )\n        .sort(this.sortSuggestions);\n\n    this.leftSuggestions = splitSuggestions('left', true);\n    this.leftSuggestionElements = this.getAndFilterLeftSuggestionElements();\n\n    this.rightSuggestions = splitSuggestions('right');\n    this.rightSuggestionElements = this.getSuggestionElements(\n      this.rightSuggestions\n    );\n\n    const defaultSuggestedQuery =\n      this.allSuggestionElements.find(elementHasQuery)?.query || '';\n\n    this.updateSuggestedQuery(defaultSuggestedQuery);\n  }\n\n  private get lastValue() {\n    return this.panelInFocus?.lastElementChild;\n  }\n\n  private get previousOrLastValue() {\n    if (!this.hasActiveDescendant) {\n      return this.lastValue;\n    }\n\n    return (\n      this.activeDescendantElement?.previousElementSibling || this.lastValue\n    );\n  }\n\n  private sortSuggestions(a: SearchBoxSuggestions, b: SearchBoxSuggestions) {\n    return a.position - b.position;\n  }\n\n  private get nextOrFirstValue() {\n    if (!this.hasActiveDescendant) {\n      return this.firstValue;\n    }\n\n    return this.activeDescendantElement?.nextElementSibling || this.firstValue;\n  }\n\n  private get firstValue() {\n    return this.panelInFocus?.firstElementChild;\n  }\n\n  private get panelInFocus() {\n    if (this.leftPanel?.contains(this.activeDescendantElement)) {\n      return this.leftPanel;\n    }\n    if (this.rightPanel?.contains(this.activeDescendantElement)) {\n      return this.rightPanel;\n    }\n    return this.leftPanel || this.rightPanel;\n  }\n\n  private scrollActiveDescendantIntoView() {\n    this.activeDescendantElement?.scrollIntoView({\n      block: 'nearest',\n    });\n  }\n\n  private updateQueryFromSuggestion() {\n    const suggestedQuery = this.activeDescendantElement?.getAttribute(\n      this.queryDataAttribute\n    );\n    this.updateOwnerSearchboxQuery(suggestedQuery || '');\n  }\n\n  private updateOwnerSearchboxQuery(query: string) {\n    if (query && this.ownerSearchBoxProps.getSearchBoxValue() !== query) {\n      this.ownerSearchBoxProps.updateQuery(query);\n      this.updateSuggestedQuery(query);\n    }\n  }\n\n  private async updateSuggestedQuery(suggestedQuery: string) {\n    await Promise.allSettled(\n      this.suggestions.map((suggestion) =>\n        promiseTimeout(\n          suggestion.onSuggestedQueryChange\n            ? suggestion.onSuggestedQueryChange(suggestedQuery)\n            : Promise.resolve(),\n          this.ownerSearchBoxProps.getSuggestionTimeout()\n        )\n      )\n    );\n    this.suggestedQuery = suggestedQuery;\n    this.updateSuggestionElements(suggestedQuery);\n    forceUpdate(this.ownerSearchBoxProps.getHost());\n  }\n\n  private updateSuggestionElements(query: string) {\n    if (!this.isPanelInFocus(this.leftPanel, query)) {\n      this.leftSuggestionElements = this.getAndFilterLeftSuggestionElements();\n    }\n\n    if (!this.isPanelInFocus(this.rightPanel, query)) {\n      this.rightSuggestionElements = this.getSuggestionElements(\n        this.rightSuggestions\n      );\n    }\n  }\n\n  private isPanelInFocus(\n    panel: HTMLElement | undefined,\n    query: string\n  ): boolean {\n    if (!this.activeDescendantElement) {\n      return false;\n    }\n\n    if (query) {\n      const escaped = DOMPurify.sanitize(query);\n      return !!panel?.querySelector(\n        `[${this.queryDataAttribute}=\"${escaped}\"]`\n      );\n    }\n\n    return this.activeDescendantElement?.closest('ul') === panel;\n  }\n\n  private getAndFilterLeftSuggestionElements() {\n    const suggestionElements = this.getSuggestionElements(this.leftSuggestions);\n    const filterOnDuplicate = new Set();\n\n    const out = suggestionElements.filter((suggestionElement) => {\n      if (isNullOrUndefined(suggestionElement.query)) {\n        return true;\n      }\n      if (filterOnDuplicate.has(suggestionElement.query)) {\n        return false;\n      } else {\n        filterOnDuplicate.add(suggestionElement.query);\n        return true;\n      }\n    });\n\n    return out;\n  }\n\n  private getSuggestionElements(suggestions: SearchBoxSuggestions[]) {\n    const elements = suggestions\n      .map((suggestion) => suggestion.renderItems())\n      .flat();\n\n    const max =\n      this.ownerSearchBoxProps.getNumberOfSuggestionsToDisplay() +\n      elements.filter(elementHasNoQuery).length;\n\n    return elements.slice(0, max);\n  }\n\n  private updateDescendants(activeDescendant = '') {\n    const newPrevDescendantElement = this.activeDescendantElement;\n    this.previousActiveDescendantElement = newPrevDescendantElement;\n    this.updateActiveDescendant(activeDescendant);\n  }\n\n  private clearSuggestionElements() {\n    this.leftSuggestionElements = [];\n    this.rightSuggestionElements = [];\n  }\n}\n","import {h, FunctionalComponent, VNode, Fragment} from '@stencil/core';\nimport {JSXBase} from '@stencil/core/internal';\nimport {isMacOS} from '../../../utils/device-utils';\nimport {AnyBindings} from '../../common/interface/bindings';\nimport {SearchBoxSuggestionElement} from '../../common/suggestions/suggestions-common';\n\nexport const queryDataAttribute = 'data-query';\n\ntype Side = 'left' | 'right';\n\ninterface SearchSuggestionProps {\n  bindings: AnyBindings;\n  id: string;\n  suggestion: SearchBoxSuggestionElement;\n  isSelected: boolean;\n  side: Side;\n  index: number;\n  lastIndex: number;\n  isDoubleList: boolean;\n}\n\ninterface ButtonSearchSuggestionProps extends SearchSuggestionProps {\n  onClick?(e: Event): void;\n  onMouseOver?(e: Event): void;\n}\n\nfunction getPartsForSuggestion(\n  suggestion: SearchBoxSuggestionElement,\n  isSelected: boolean\n) {\n  let part = 'suggestion';\n  if (isSelected) {\n    part += ' active-suggestion';\n  }\n  if (suggestion.query) {\n    part += ' suggestion-with-query';\n  }\n  if (suggestion.part) {\n    part += ` ${suggestion.part}`;\n  }\n  return part;\n}\n\nfunction getClassesForSuggestion(isSelected: boolean) {\n  return `flex px-4 min-h-[40px] items-center text-left text-neutral-dark cursor-pointer ${\n    isSelected ? 'bg-neutral-light' : ''\n  }`;\n}\n\nfunction isHTMLElement(el: VNode | Element): el is HTMLElement {\n  return el instanceof HTMLElement;\n}\n\nfunction ensureContentForRenderedSuggestion({\n  renderedSuggestion,\n  suggestion,\n}: {\n  renderedSuggestion: HTMLElement;\n  suggestion: SearchBoxSuggestionElement;\n}) {\n  if (isHTMLElement(suggestion.content)) {\n    renderedSuggestion.replaceChildren(suggestion.content);\n  }\n}\n\nfunction getAriaLabelForRenderedSuggestion({\n  bindings,\n  renderedSuggestion,\n  suggestion,\n  side,\n  index,\n  lastIndex,\n  isDoubleList,\n  isButton,\n}: {\n  bindings: AnyBindings;\n  renderedSuggestion: HTMLElement;\n  suggestion: SearchBoxSuggestionElement;\n  side: Side;\n  index: number;\n  lastIndex: number;\n  isDoubleList: boolean;\n  isButton: boolean;\n}) {\n  const contentLabel =\n    suggestion.ariaLabel ??\n    suggestion.query ??\n    renderedSuggestion.innerText ??\n    bindings.i18n.t('no-title');\n  const labelWithType =\n    isMacOS() && isButton\n      ? bindings.i18n.t('search-suggestion-button', {\n          label: contentLabel,\n          interpolation: {escapeValue: false},\n        })\n      : contentLabel;\n  const position = index + 1;\n  const count = lastIndex + 1;\n\n  if (!isDoubleList) {\n    return bindings.i18n.t('search-suggestion-single-list', {\n      label: labelWithType,\n      position,\n      count,\n      interpolation: {escapeValue: false},\n    });\n  }\n\n  return bindings.i18n.t('search-suggestion-double-list', {\n    label: labelWithType,\n    position,\n    count,\n    side: bindings.i18n.t(side === 'left' ? 'left' : 'right'),\n    interpolation: {escapeValue: false},\n  });\n}\n\nfunction getContentForSuggestion(suggestion: SearchBoxSuggestionElement) {\n  return !isHTMLElement(suggestion.content) ? (\n    suggestion.content\n  ) : (\n    <Fragment></Fragment>\n  );\n}\n\nfunction getCommonSearchSuggestionAttributes(\n  {\n    bindings,\n    id,\n    suggestion,\n    isSelected,\n    side,\n    index,\n    lastIndex,\n    isDoubleList,\n  }: SearchSuggestionProps,\n  isButton: boolean\n): JSXBase.HTMLAttributes<HTMLElement> {\n  return {\n    id: id,\n    key: suggestion.key,\n    part: getPartsForSuggestion(suggestion, isSelected),\n    class: getClassesForSuggestion(isSelected),\n    ref: (el) => {\n      if (!el) {\n        return;\n      }\n      ensureContentForRenderedSuggestion({\n        renderedSuggestion: el,\n        suggestion,\n      });\n      el.setAttribute(\n        'aria-label',\n        getAriaLabelForRenderedSuggestion({\n          bindings,\n          renderedSuggestion: el,\n          suggestion,\n          side,\n          index,\n          lastIndex,\n          isDoubleList,\n          isButton,\n        })\n      );\n    },\n  };\n}\n\nexport const SimpleSearchSuggestion: FunctionalComponent<\n  SearchSuggestionProps\n> = (props) => {\n  return (\n    <span {...getCommonSearchSuggestionAttributes(props, false)}>\n      {getContentForSuggestion(props.suggestion)}\n    </span>\n  );\n};\n\nexport const ButtonSearchSuggestion: FunctionalComponent<\n  ButtonSearchSuggestionProps\n> = (props) => {\n  return (\n    <button\n      {...getCommonSearchSuggestionAttributes(props, true)}\n      onMouseDown={(e) => e.preventDefault()}\n      onClick={(e: Event) => props.onClick?.(e)}\n      onMouseOver={(e: Event) => props.onMouseOver?.(e)}\n      {...{[queryDataAttribute]: props.suggestion.query}}\n    >\n      {getContentForSuggestion(props.suggestion)}\n    </button>\n  );\n};\n"],"version":3}