import{N as h,g as a,O as m}from"./atomic-breadbox.new.stories-D03zBEda.js";import{P as p,M as f}from"./p-e12016d2-D4PWgvR2.js";import{r as c}from"./p-55d2bcf3-DJQIxeeN.js";import{m as y}from"./p-6fadd170-Cg3VAl32.js";import{s as g}from"./p-9935af75-BsJQUBM3.js";import{e as V}from"./p-5a302484-DffL6r5g.js";import"./iframe-DTo5wNcQ.js";import"../sb-preview/runtime.js";import"./p-1580513b-De1d4bsn.js";import"./p-e9c4f463-BPmi-3c5.js";import"./p-231defbf-B5u3bU8V.js";const v=":host>ul{display:flex;list-style:none;margin:0;padding:0}:host>ul li{display:inline-block}.separator::before{display:inline;content:',\\00a0'}",b=v;var d=function(e,t,r,s){var l=arguments.length,i=l<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,r):s,n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,s);else for(var u=e.length-1;u>=0;u--)(n=e[u])&&(i=(l<3?n(i):l>3?n(t,r,i):n(t,r))||i);return l>3&&i&&Object.defineProperty(t,r,i),i};const o=class{constructor(e){h(this,e),this.maxValuesToDisplay=3,this.delimiter=null,this.sortedValues=null,this.error=void 0,this.field=void 0,this.maxValuesToDisplay=3,this.delimiter=null}initialize(){this.breadcrumbManager=p(this.bindings.engine)}get resultValues(){const e=f.getResultProperty(this.result,this.field);return e===null?null:Array.isArray(e)?e.map(t=>`${t}`.trim()):typeof e!="string"||e.trim()===""?(this.error=new Error(`Could not parse "${e}" from field "${this.field}" as a string array.`),null):this.delimiter?e.split(this.delimiter).map(t=>t.trim()):[e]}get facetSelectedValues(){return this.breadcrumbManager.state.facetBreadcrumbs.filter(e=>e.field===this.field).reduce((e,t)=>[...e,...t.values.map(({value:r})=>r.value)],[])}updateSortedValues(){const e=this.resultValues;if(e===null){this.sortedValues=null;return}const t=new Set(e),r=this.facetSelectedValues.filter(s=>t.has(s));this.sortedValues=Array.from(e.reduce((s,l)=>s.add(l),new Set(r)))}getShouldDisplayLabel(e){return this.maxValuesToDisplay>0&&e.length>this.maxValuesToDisplay}getNumberOfValuesToDisplay(e){return e.length<=this.maxValuesToDisplay?e.length:this.maxValuesToDisplay<2?this.maxValuesToDisplay:Math.min(e.length-2,this.maxValuesToDisplay)}renderValue(e){const t=c(this.field,e,this.bindings.i18n),r=g(e);return a("li",{key:e,part:"result-multi-value-text-value"},a("slot",{name:`result-multi-value-text-value-${r}`},t))}renderSeparator(e,t){return a("li",{"aria-hidden":"true",part:"result-multi-value-text-separator",key:`${e}~${t}`,class:"separator"})}renderMoreLabel(e){return a("li",{key:"more-field-values",part:"result-multi-value-text-value-more"},this.bindings.i18n.t("n-more",{value:e}))}renderListItems(e){const t=this.getNumberOfValuesToDisplay(e),r=[];for(let s=0;s<t;s++)s>0&&r.push(this.renderSeparator(e[s-1],e[s])),r.push(this.renderValue(e[s]));return this.getShouldDisplayLabel(e)&&(r.push(this.renderSeparator(e[t-1],"more-field-values")),r.push(this.renderMoreLabel(e.length-t))),r}componentWillRender(){this.updateSortedValues()}render(){if(this.sortedValues===null){this.host.remove();return}return a("ul",{part:"result-multi-value-text-list"},...this.renderListItems(this.sortedValues))}get host(){return m(this)}};d([y()],o.prototype,"bindings",void 0);d([V()],o.prototype,"result",void 0);o.style=b;export{o as atomic_result_multi_value_text};
