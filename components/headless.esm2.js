/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ch=Object.create;var fc=Object.defineProperty;var sh=Object.getOwnPropertyDescriptor;var uh=Object.getOwnPropertyNames;var lh=Object.getPrototypeOf,dh=Object.prototype.hasOwnProperty;var mh=(e,t,r)=>t in e?fc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ph=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var ce=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var fh=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of uh(t))!dh.call(e,n)&&n!==r&&fc(e,n,{get:()=>t[n],enumerable:!(o=sh(t,n))||o.enumerable});return e};var Qe=(e,t,r)=>(r=e!=null?ch(lh(e)):{},fh(t||!e||!e.__esModule?fc(r,"default",{value:e,enumerable:!0}):r,e));var qn=(e,t,r)=>mh(e,typeof t!="symbol"?t+"":t,r);var bu=ce((zA,Au)=>{Au.exports=fetch;});var Pu=ce(ko=>{var Tn=ko&&ko.__assign||function(){return Tn=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);}return e},Tn.apply(this,arguments)};Object.defineProperty(ko,"__esModule",{value:!0});var gh={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return !0},startingDelay:100,timeMultiple:2};function hh(e){var t=Tn(Tn({},gh),e);return t.numOfAttempts<1&&(t.numOfAttempts=1),t}ko.getSanitizedOptions=hh;});var Iu=ce(gc=>{Object.defineProperty(gc,"__esModule",{value:!0});function yh(e){var t=Math.random()*e;return Math.round(t)}gc.fullJitter=yh;});var wu=ce(hc=>{Object.defineProperty(hc,"__esModule",{value:!0});function Sh(e){return e}hc.noJitter=Sh;});var Eu=ce(yc=>{Object.defineProperty(yc,"__esModule",{value:!0});var Ch=Iu(),xh=wu();function Rh(e){switch(e.jitter){case"full":return Ch.fullJitter;case"none":default:return xh.noJitter}}yc.JitterFactory=Rh;});var Cc=ce(Sc=>{Object.defineProperty(Sc,"__esModule",{value:!0});var vh=Eu(),Fh=function(){function e(t){this.options=t,this.attempt=0;}return e.prototype.apply=function(){var t=this;return new Promise(function(r){return setTimeout(r,t.jitteredDelay)})},e.prototype.setAttemptNumber=function(t){this.attempt=t;},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){var t=vh.JitterFactory(this.options);return t(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var t=this.options.startingDelay,r=this.options.timeMultiple,o=this.numOfDelayedAttempts,n=t*Math.pow(r,o);return Math.min(n,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}();Sc.Delay=Fh;});var Ou=ce(vt=>{var Ah=vt&&vt.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,n){o.__proto__=n;}||function(o,n){for(var a in n)n.hasOwnProperty(a)&&(o[a]=n[a]);},e(t,r)};return function(t,r){e(t,r);function o(){this.constructor=t;}t.prototype=r===null?Object.create(r):(o.prototype=r.prototype,new o);}}(),bh=vt&&vt.__awaiter||function(e,t,r,o){function n(a){return a instanceof r?a:new r(function(i){i(a);})}return new(r||(r=Promise))(function(a,i){function c(l){try{s(o.next(l));}catch(d){i(d);}}function u(l){try{s(o.throw(l));}catch(d){i(d);}}function s(l){l.done?a(l.value):n(l.value).then(c,u);}s((o=o.apply(e,t||[])).next());})},Ph=vt&&vt.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},o,n,a,i;return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(s){return function(l){return u([s,l])}}function u(s){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,n&&(a=s[0]&2?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[s[0]&2,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,n=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){r.label=s[1];break}if(s[0]===6&&r.label<a[1]){r.label=a[1],a=s;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(s);break}a[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r);}catch(l){s=[6,l],n=0;}finally{o=a=0;}if(s[0]&5)throw s[1];return {value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(vt,"__esModule",{value:!0});var Ih=Cc(),wh=function(e){Ah(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.apply=function(){return bh(this,void 0,void 0,function(){return Ph(this,function(r){return [2,this.isFirstAttempt?!0:e.prototype.apply.call(this)]})})},Object.defineProperty(t.prototype,"isFirstAttempt",{get:function(){return this.attempt===0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),t}(Ih.Delay);vt.SkipFirstDelay=wh;});var qu=ce(Do=>{var Eh=Do&&Do.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,n){o.__proto__=n;}||function(o,n){for(var a in n)n.hasOwnProperty(a)&&(o[a]=n[a]);},e(t,r)};return function(t,r){e(t,r);function o(){this.constructor=t;}t.prototype=r===null?Object.create(r):(o.prototype=r.prototype,new o);}}();Object.defineProperty(Do,"__esModule",{value:!0});var Oh=Cc(),qh=function(e){Eh(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Oh.Delay);Do.AlwaysDelay=qh;});var Tu=ce(xc=>{Object.defineProperty(xc,"__esModule",{value:!0});var Th=Ou(),kh=qu();function Dh(e,t){var r=Vh(e);return r.setAttemptNumber(t),r}xc.DelayFactory=Dh;function Vh(e){return e.delayFirstAttempt?new kh.AlwaysDelay(e):new Th.SkipFirstDelay(e)}});var ku=ce(yr=>{var Rc=yr&&yr.__awaiter||function(e,t,r,o){function n(a){return a instanceof r?a:new r(function(i){i(a);})}return new(r||(r=Promise))(function(a,i){function c(l){try{s(o.next(l));}catch(d){i(d);}}function u(l){try{s(o.throw(l));}catch(d){i(d);}}function s(l){l.done?a(l.value):n(l.value).then(c,u);}s((o=o.apply(e,t||[])).next());})},vc=yr&&yr.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},o,n,a,i;return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(s){return function(l){return u([s,l])}}function u(s){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,n&&(a=s[0]&2?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[s[0]&2,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,n=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){r.label=s[1];break}if(s[0]===6&&r.label<a[1]){r.label=a[1],a=s;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(s);break}a[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r);}catch(l){s=[6,l],n=0;}finally{o=a=0;}if(s[0]&5)throw s[1];return {value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(yr,"__esModule",{value:!0});var Nh=Pu(),Mh=Tu();function Lh(e,t){return t===void 0&&(t={}),Rc(this,void 0,void 0,function(){var r,o;return vc(this,function(n){switch(n.label){case 0:return r=Nh.getSanitizedOptions(t),o=new Uh(e,r),[4,o.execute()];case 1:return [2,n.sent()]}})})}yr.backOff=Lh;var Uh=function(){function e(t,r){this.request=t,this.options=r,this.attemptNumber=0;}return e.prototype.execute=function(){return Rc(this,void 0,void 0,function(){var t,r;return vc(this,function(o){switch(o.label){case 0:if(this.attemptLimitReached)return [3,7];o.label=1;case 1:return o.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return o.sent(),[4,this.request()];case 3:return [2,o.sent()];case 4:return t=o.sent(),this.attemptNumber++,[4,this.options.retry(t,this.attemptNumber)];case 5:if(r=o.sent(),!r||this.attemptLimitReached)throw t;return [3,6];case 6:return [3,0];case 7:throw new Error("Something went wrong.")}})})},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return Rc(this,void 0,void 0,function(){var t;return vc(this,function(r){switch(r.label){case 0:return t=Mh.DelayFactory(this.options,this.attemptNumber),[4,t.apply()];case 1:return r.sent(),[2]}})})},e}();});var Vu=ce((rb,Du)=>{function Qh(e){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");if(e=`${e}`,e=e.replace(/[ \t\n\f\r]/g,""),e.length%4===0&&(e=e.replace(/==?$/,"")),e.length%4===1||/[^+/0-9A-Za-z]/.test(e))return null;let t="",r=0,o=0;for(let n=0;n<e.length;n++)r<<=6,r|=_h(e[n]),o+=6,o===24&&(t+=String.fromCharCode((r&16711680)>>16),t+=String.fromCharCode((r&65280)>>8),t+=String.fromCharCode(r&255),r=o=0);return o===12?(r>>=4,t+=String.fromCharCode(r)):o===18&&(r>>=2,t+=String.fromCharCode((r&65280)>>8),t+=String.fromCharCode(r&255)),t}var Bh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function _h(e){let t=Bh.indexOf(e);return t<0?void 0:t}Du.exports=Qh;});var Mu=ce((ob,Nu)=>{function jh(e){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");let t;for(e=`${e}`,t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return null;let r="";for(t=0;t<e.length;t+=3){let o=[void 0,void 0,void 0,void 0];o[0]=e.charCodeAt(t)>>2,o[1]=(e.charCodeAt(t)&3)<<4,e.length>t+1&&(o[1]|=e.charCodeAt(t+1)>>4,o[2]=(e.charCodeAt(t+1)&15)<<2),e.length>t+2&&(o[2]|=e.charCodeAt(t+2)>>6,o[3]=e.charCodeAt(t+2)&63);for(let n=0;n<o.length;n++)typeof o[n]>"u"?r+="=":r+=zh(o[n]);}return r}var $h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function zh(e){if(e>=0&&e<64)return $h[e]}Nu.exports=jh;});var Uu=ce((nb,Lu)=>{var Hh=Vu(),Wh=Mu();Lu.exports={atob:Hh,btoa:Wh};});var Da=ce((Cs,xs)=>{(function(e,t){typeof Cs=="object"&&typeof xs<"u"?xs.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs=t();})(Cs,function(){var e=1e3,t=6e4,r=36e5,o="millisecond",n="second",a="minute",i="hour",c="day",u="week",s="month",l="quarter",d="year",p="date",m="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(L){var I=["th","st","nd","rd"],A=L%100;return "["+L+(I[(A-20)%10]||I[A]||I[0])+"]"}},E=function(L,I,A){var O=String(L);return !O||O.length>=I?L:""+Array(I+1-O.length).join(A)+L},k={s:E,z:function(L){var I=-L.utcOffset(),A=Math.abs(I),O=Math.floor(A/60),b=A%60;return (I<=0?"+":"-")+E(O,2,"0")+":"+E(b,2,"0")},m:function L(I,A){if(I.date()<A.date())return -L(A,I);var O=12*(A.year()-I.year())+(A.month()-I.month()),b=I.clone().add(O,s),U=A-b<0,B=I.clone().add(O+(U?-1:1),s);return +(-(O+(A-b)/(U?b-B:B-b))||0)},a:function(L){return L<0?Math.ceil(L)||0:Math.floor(L)},p:function(L){return {M:s,y:d,w:u,d:c,D:p,h:i,m:a,s:n,ms:o,Q:l}[L]||String(L||"").toLowerCase().replace(/s$/,"")},u:function(L){return L===void 0}},K="en",$={};$[K]=v;var Z="$isDayjsObject",Y=function(L){return L instanceof ye||!(!L||!L[Z])},re=function L(I,A,O){var b;if(!I)return K;if(typeof I=="string"){var U=I.toLowerCase();$[U]&&(b=U),A&&($[U]=A,b=U);var B=I.split("-");if(!b&&B.length>1)return L(B[0])}else {var ee=I.name;$[ee]=I,b=ee;}return !O&&b&&(K=b),b||!O&&K},J=function(L,I){if(Y(L))return L.clone();var A=typeof I=="object"?I:{};return A.date=L,A.args=arguments,new ye(A)},j=k;j.l=re,j.i=Y,j.w=function(L,I){return J(L,{locale:I.$L,utc:I.$u,x:I.$x,$offset:I.$offset})};var ye=function(){function L(A){this.$L=re(A.locale,null,!0),this.parse(A),this.$x=this.$x||A.x||{},this[Z]=!0;}var I=L.prototype;return I.parse=function(A){this.$d=function(O){var b=O.date,U=O.utc;if(b===null)return new Date(NaN);if(j.u(b))return new Date;if(b instanceof Date)return new Date(b);if(typeof b=="string"&&!/Z$/i.test(b)){var B=b.match(g);if(B){var ee=B[2]-1||0,ne=(B[7]||"0").substring(0,3);return U?new Date(Date.UTC(B[1],ee,B[3]||1,B[4]||0,B[5]||0,B[6]||0,ne)):new Date(B[1],ee,B[3]||1,B[4]||0,B[5]||0,B[6]||0,ne)}}return new Date(b)}(A),this.init();},I.init=function(){var A=this.$d;this.$y=A.getFullYear(),this.$M=A.getMonth(),this.$D=A.getDate(),this.$W=A.getDay(),this.$H=A.getHours(),this.$m=A.getMinutes(),this.$s=A.getSeconds(),this.$ms=A.getMilliseconds();},I.$utils=function(){return j},I.isValid=function(){return this.$d.toString()!==m},I.isSame=function(A,O){var b=J(A);return this.startOf(O)<=b&&b<=this.endOf(O)},I.isAfter=function(A,O){return J(A)<this.startOf(O)},I.isBefore=function(A,O){return this.endOf(O)<J(A)},I.$g=function(A,O,b){return j.u(A)?this[O]:this.set(b,A)},I.unix=function(){return Math.floor(this.valueOf()/1e3)},I.valueOf=function(){return this.$d.getTime()},I.startOf=function(A,O){var b=this,U=!!j.u(O)||O,B=j.p(A),ee=function(et,me){var Ne=j.w(b.$u?Date.UTC(b.$y,me,et):new Date(b.$y,me,et),b);return U?Ne:Ne.endOf(c)},ne=function(et,me){return j.w(b.toDate()[et].apply(b.toDate("s"),(U?[0,0,0,0]:[23,59,59,999]).slice(me)),b)},se=this.$W,de=this.$M,Ee=this.$D,_t="set"+(this.$u?"UTC":"");switch(B){case d:return U?ee(1,0):ee(31,11);case s:return U?ee(1,de):ee(0,de+1);case u:var lt=this.$locale().weekStart||0,xt=(se<lt?se+7:se)-lt;return ee(U?Ee-xt:Ee+(6-xt),de);case c:case p:return ne(_t+"Hours",0);case i:return ne(_t+"Minutes",1);case a:return ne(_t+"Seconds",2);case n:return ne(_t+"Milliseconds",3);default:return this.clone()}},I.endOf=function(A){return this.startOf(A,!1)},I.$set=function(A,O){var b,U=j.p(A),B="set"+(this.$u?"UTC":""),ee=(b={},b[c]=B+"Date",b[p]=B+"Date",b[s]=B+"Month",b[d]=B+"FullYear",b[i]=B+"Hours",b[a]=B+"Minutes",b[n]=B+"Seconds",b[o]=B+"Milliseconds",b)[U],ne=U===c?this.$D+(O-this.$W):O;if(U===s||U===d){var se=this.clone().set(p,1);se.$d[ee](ne),se.init(),this.$d=se.set(p,Math.min(this.$D,se.daysInMonth())).$d;}else ee&&this.$d[ee](ne);return this.init(),this},I.set=function(A,O){return this.clone().$set(A,O)},I.get=function(A){return this[j.p(A)]()},I.add=function(A,O){var b,U=this;A=Number(A);var B=j.p(O),ee=function(de){var Ee=J(U);return j.w(Ee.date(Ee.date()+Math.round(de*A)),U)};if(B===s)return this.set(s,this.$M+A);if(B===d)return this.set(d,this.$y+A);if(B===c)return ee(1);if(B===u)return ee(7);var ne=(b={},b[a]=t,b[i]=r,b[n]=e,b)[B]||1,se=this.$d.getTime()+A*ne;return j.w(se,this)},I.subtract=function(A,O){return this.add(-1*A,O)},I.format=function(A){var O=this,b=this.$locale();if(!this.isValid())return b.invalidDate||m;var U=A||"YYYY-MM-DDTHH:mm:ssZ",B=j.z(this),ee=this.$H,ne=this.$m,se=this.$M,de=b.weekdays,Ee=b.months,_t=b.meridiem,lt=function(me,Ne,Rt,jt){return me&&(me[Ne]||me(O,U))||Rt[Ne].slice(0,jt)},xt=function(me){return j.s(ee%12||12,me,"0")},et=_t||function(me,Ne,Rt){var jt=me<12?"AM":"PM";return Rt?jt.toLowerCase():jt};return U.replace(x,function(me,Ne){return Ne||function(Rt){switch(Rt){case"YY":return String(O.$y).slice(-2);case"YYYY":return j.s(O.$y,4,"0");case"M":return se+1;case"MM":return j.s(se+1,2,"0");case"MMM":return lt(b.monthsShort,se,Ee,3);case"MMMM":return lt(Ee,se);case"D":return O.$D;case"DD":return j.s(O.$D,2,"0");case"d":return String(O.$W);case"dd":return lt(b.weekdaysMin,O.$W,de,2);case"ddd":return lt(b.weekdaysShort,O.$W,de,3);case"dddd":return de[O.$W];case"H":return String(ee);case"HH":return j.s(ee,2,"0");case"h":return xt(1);case"hh":return xt(2);case"a":return et(ee,ne,!0);case"A":return et(ee,ne,!1);case"m":return String(ne);case"mm":return j.s(ne,2,"0");case"s":return String(O.$s);case"ss":return j.s(O.$s,2,"0");case"SSS":return j.s(O.$ms,3,"0");case"Z":return B}return null}(me)||B.replace(":","")})},I.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},I.diff=function(A,O,b){var U,B=this,ee=j.p(O),ne=J(A),se=(ne.utcOffset()-this.utcOffset())*t,de=this-ne,Ee=function(){return j.m(B,ne)};switch(ee){case d:U=Ee()/12;break;case s:U=Ee();break;case l:U=Ee()/3;break;case u:U=(de-se)/6048e5;break;case c:U=(de-se)/864e5;break;case i:U=de/r;break;case a:U=de/t;break;case n:U=de/e;break;default:U=de;}return b?U:j.a(U)},I.daysInMonth=function(){return this.endOf(s).$D},I.$locale=function(){return $[this.$L]},I.locale=function(A,O){if(!A)return this.$L;var b=this.clone(),U=re(A,O,!0);return U&&(b.$L=U),b},I.clone=function(){return j.w(this.$d,this)},I.toDate=function(){return new Date(this.valueOf())},I.toJSON=function(){return this.isValid()?this.toISOString():null},I.toISOString=function(){return this.$d.toISOString()},I.toString=function(){return this.$d.toUTCString()},L}(),Ze=ye.prototype;return J.prototype=Ze,[["$ms",o],["$s",n],["$m",a],["$H",i],["$W",c],["$M",s],["$y",d],["$D",p]].forEach(function(L){Ze[L[1]]=function(I){return this.$g(I,L[0],L[1])};}),J.extend=function(L,I){return L.$i||(L(I,ye,J),L.$i=!0),J},J.locale=re,J.isDayjs=Y,J.unix=function(L){return J(1e3*L)},J.en=$[K],J.Ls=$,J.p={},J});});var Kd=ce((Rs,vs)=>{(function(e,t){typeof Rs=="object"&&typeof vs<"u"?vs.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_quarterOfYear=t();})(Rs,function(){var e="month",t="quarter";return function(r,o){var n=o.prototype;n.quarter=function(c){return this.$utils().u(c)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(c-1))};var a=n.add;n.add=function(c,u){return c=Number(c),this.$utils().p(u)===t?this.add(3*c,e):a.bind(this)(c,u)};var i=n.startOf;n.startOf=function(c,u){var s=this.$utils(),l=!!s.u(u)||u;if(s.p(c)===t){var d=this.quarter()-1;return l?this.month(3*d).startOf(e).startOf("day"):this.month(3*d+2).endOf(e).endOf("day")}return i.bind(this)(c,u)};}});});var Yd=ce((Fs,As)=>{(function(e,t){typeof Fs=="object"&&typeof As<"u"?As.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_customParseFormat=t();})(Fs,function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,o=/\d\d?/,n=/\d*[^-_:/,()\s\d]+/,a={},i=function(m){return (m=+m)+(m>68?1900:2e3)},c=function(m){return function(g){this[m]=+g;}},u=[/[+-]\d\d:?(\d\d)?|Z/,function(m){(this.zone||(this.zone={})).offset=function(g){if(!g||g==="Z")return 0;var x=g.match(/([+-]|\d\d)/g),v=60*x[1]+(+x[2]||0);return v===0?0:x[0]==="+"?-v:v}(m);}],s=function(m){var g=a[m];return g&&(g.indexOf?g:g.s.concat(g.f))},l=function(m,g){var x,v=a.meridiem;if(v){for(var E=1;E<=24;E+=1)if(m.indexOf(v(E,0,g))>-1){x=E>12;break}}else x=m===(g?"pm":"PM");return x},d={A:[n,function(m){this.afternoon=l(m,!1);}],a:[n,function(m){this.afternoon=l(m,!0);}],S:[/\d/,function(m){this.milliseconds=100*+m;}],SS:[r,function(m){this.milliseconds=10*+m;}],SSS:[/\d{3}/,function(m){this.milliseconds=+m;}],s:[o,c("seconds")],ss:[o,c("seconds")],m:[o,c("minutes")],mm:[o,c("minutes")],H:[o,c("hours")],h:[o,c("hours")],HH:[o,c("hours")],hh:[o,c("hours")],D:[o,c("day")],DD:[r,c("day")],Do:[n,function(m){var g=a.ordinal,x=m.match(/\d+/);if(this.day=x[0],g)for(var v=1;v<=31;v+=1)g(v).replace(/\[|\]/g,"")===m&&(this.day=v);}],M:[o,c("month")],MM:[r,c("month")],MMM:[n,function(m){var g=s("months"),x=(s("monthsShort")||g.map(function(v){return v.slice(0,3)})).indexOf(m)+1;if(x<1)throw new Error;this.month=x%12||x;}],MMMM:[n,function(m){var g=s("months").indexOf(m)+1;if(g<1)throw new Error;this.month=g%12||g;}],Y:[/[+-]?\d+/,c("year")],YY:[r,function(m){this.year=i(m);}],YYYY:[/\d{4}/,c("year")],Z:u,ZZ:u};function p(m){var g,x;g=m,x=a&&a.formats;for(var v=(m=g.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(re,J,j){var ye=j&&j.toUpperCase();return J||x[j]||e[j]||x[ye].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(Ze,L,I){return L||I.slice(1)})})).match(t),E=v.length,k=0;k<E;k+=1){var K=v[k],$=d[K],Z=$&&$[0],Y=$&&$[1];v[k]=Y?{regex:Z,parser:Y}:K.replace(/^\[|\]$/g,"");}return function(re){for(var J={},j=0,ye=0;j<E;j+=1){var Ze=v[j];if(typeof Ze=="string")ye+=Ze.length;else {var L=Ze.regex,I=Ze.parser,A=re.slice(ye),O=L.exec(A)[0];I.call(J,O),re=re.replace(O,"");}}return function(b){var U=b.afternoon;if(U!==void 0){var B=b.hours;U?B<12&&(b.hours+=12):B===12&&(b.hours=0),delete b.afternoon;}}(J),J}}return function(m,g,x){x.p.customParseFormat=!0,m&&m.parseTwoDigitYear&&(i=m.parseTwoDigitYear);var v=g.prototype,E=v.parse;v.parse=function(k){var K=k.date,$=k.utc,Z=k.args;this.$u=$;var Y=Z[1];if(typeof Y=="string"){var re=Z[2]===!0,J=Z[3]===!0,j=re||J,ye=Z[2];J&&(ye=Z[2]),a=this.$locale(),!re&&ye&&(a=x.Ls[ye]),this.$d=function(A,O,b){try{if(["x","X"].indexOf(O)>-1)return new Date((O==="X"?1e3:1)*A);var U=p(O)(A),B=U.year,ee=U.month,ne=U.day,se=U.hours,de=U.minutes,Ee=U.seconds,_t=U.milliseconds,lt=U.zone,xt=new Date,et=ne||(B||ee?1:xt.getDate()),me=B||xt.getFullYear(),Ne=0;B&&!ee||(Ne=ee>0?ee-1:xt.getMonth());var Rt=se||0,jt=de||0,mc=Ee||0,pc=_t||0;return lt?new Date(Date.UTC(me,Ne,et,Rt,jt,mc,pc+60*lt.offset*1e3)):b?new Date(Date.UTC(me,Ne,et,Rt,jt,mc,pc)):new Date(me,Ne,et,Rt,jt,mc,pc)}catch{return new Date("")}}(K,Y,$),this.init(),ye&&ye!==!0&&(this.$L=this.locale(ye).$L),j&&K!=this.format(Y)&&(this.$d=new Date("")),a={};}else if(Y instanceof Array)for(var Ze=Y.length,L=1;L<=Ze;L+=1){Z[1]=Y[L-1];var I=x.apply(this,Z);if(I.isValid()){this.$d=I.$d,this.$L=I.$L,this.init();break}L===Ze&&(this.$d=new Date(""));}else E.call(this,k);};}});});var Bp=ce((ZQ,Qp)=>{var UR=/(^|; )Coveo-Pendragon=([^;]*)/;Qp.exports=()=>UR.exec(document.cookie)?.pop()||null;});var _p=ce((Ks,Ys)=>{(function(e,t){typeof Ks=="object"&&typeof Ys<"u"?Ys.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_timezone=t();})(Ks,function(){var e={year:0,month:1,day:2,hour:3,minute:4,second:5},t={};return function(r,o,n){var a,i=function(l,d,p){p===void 0&&(p={});var m=new Date(l),g=function(x,v){v===void 0&&(v={});var E=v.timeZoneName||"short",k=x+"|"+E,K=t[k];return K||(K=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:x,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:E}),t[k]=K),K}(d,p);return g.formatToParts(m)},c=function(l,d){for(var p=i(l,d),m=[],g=0;g<p.length;g+=1){var x=p[g],v=x.type,E=x.value,k=e[v];k>=0&&(m[k]=parseInt(E,10));}var K=m[3],$=K===24?0:K,Z=m[0]+"-"+m[1]+"-"+m[2]+" "+$+":"+m[4]+":"+m[5]+":000",Y=+l;return (n.utc(Z).valueOf()-(Y-=Y%1e3))/6e4},u=o.prototype;u.tz=function(l,d){l===void 0&&(l=a);var p=this.utcOffset(),m=this.toDate(),g=m.toLocaleString("en-US",{timeZone:l}),x=Math.round((m-new Date(g))/1e3/60),v=n(g,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(m.getTimezoneOffset()/15)-x,!0);if(d){var E=v.utcOffset();v=v.add(p-E,"minute");}return v.$x.$timezone=l,v},u.offsetName=function(l){var d=this.$x.$timezone||n.tz.guess(),p=i(this.valueOf(),d,{timeZoneName:l}).find(function(m){return m.type.toLowerCase()==="timezonename"});return p&&p.value};var s=u.startOf;u.startOf=function(l,d){if(!this.$x||!this.$x.$timezone)return s.call(this,l,d);var p=n(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return s.call(p,l,d).tz(this.$x.$timezone,!0)},n.tz=function(l,d,p){var m=p&&d,g=p||d||a,x=c(+n(),g);if(typeof l!="string")return n(l).tz(g);var v=function($,Z,Y){var re=$-60*Z*1e3,J=c(re,Y);if(Z===J)return [re,Z];var j=c(re-=60*(J-Z)*1e3,Y);return J===j?[re,J]:[$-60*Math.min(J,j)*1e3,Math.max(J,j)]}(n.utc(l,m).valueOf(),x,g),E=v[0],k=v[1],K=n(E).utcOffset(k);return K.$x.$timezone=g,K},n.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},n.tz.setDefault=function(l){a=l;};}});});var jp=ce((Gs,Js)=>{(function(e,t){typeof Gs=="object"&&typeof Js<"u"?Js.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_utc=t();})(Gs,function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(o,n,a){var i=n.prototype;a.utc=function(m){var g={date:m,utc:!0,args:arguments};return new n(g)},i.utc=function(m){var g=a(this.toDate(),{locale:this.$L,utc:!0});return m?g.add(this.utcOffset(),e):g},i.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var c=i.parse;i.parse=function(m){m.utc&&(this.$u=!0),this.$utils().u(m.$offset)||(this.$offset=m.$offset),c.call(this,m);};var u=i.init;i.init=function(){if(this.$u){var m=this.$d;this.$y=m.getUTCFullYear(),this.$M=m.getUTCMonth(),this.$D=m.getUTCDate(),this.$W=m.getUTCDay(),this.$H=m.getUTCHours(),this.$m=m.getUTCMinutes(),this.$s=m.getUTCSeconds(),this.$ms=m.getUTCMilliseconds();}else u.call(this);};var s=i.utcOffset;i.utcOffset=function(m,g){var x=this.$utils().u;if(x(m))return this.$u?0:x(this.$offset)?s.call(this):this.$offset;if(typeof m=="string"&&(m=function(K){K===void 0&&(K="");var $=K.match(t);if(!$)return null;var Z=(""+$[0]).match(r)||["-",0,0],Y=Z[0],re=60*+Z[1]+ +Z[2];return re===0?0:Y==="+"?re:-re}(m),m===null))return this;var v=Math.abs(m)<=16?60*m:m,E=this;if(g)return E.$offset=v,E.$u=m===0,E;if(m!==0){var k=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(E=this.local().add(v+k,e)).$offset=v,E.$x.$localOffset=k;}else E=this.utc();return E};var l=i.format;i.format=function(m){var g=m||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,g)},i.valueOf=function(){var m=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*m},i.isUTC=function(){return !!this.$u},i.toISOString=function(){return this.toDate().toISOString()},i.toString=function(){return this.toDate().toUTCString()};var d=i.toDate;i.toDate=function(m){return m==="s"&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var p=i.diff;i.diff=function(m,g,x){if(m&&this.$u===m.$u)return p.call(this,m,g,x);var v=this.local(),E=a(m).local();return p.call(v,E,g,x)};}});});var af=ce((s_,nf)=>{function XR(e){try{return JSON.stringify(e)}catch{return '"[Circular]"'}}nf.exports=ZR;function ZR(e,t,r){var o=r&&r.stringify||XR,n=1;if(typeof e=="object"&&e!==null){var a=t.length+n;if(a===1)return e;var i=new Array(a);i[0]=o(e);for(var c=1;c<a;c++)i[c]=o(t[c]);return i.join(" ")}if(typeof e!="string")return e;var u=t.length;if(u===0)return e;for(var s="",l=1-n,d=-1,p=e&&e.length||0,m=0;m<p;){if(e.charCodeAt(m)===37&&m+1<p){switch(d=d>-1?d:0,e.charCodeAt(m+1)){case 100:case 102:if(l>=u||t[l]==null)break;d<m&&(s+=e.slice(d,m)),s+=Number(t[l]),d=m+2,m++;break;case 105:if(l>=u||t[l]==null)break;d<m&&(s+=e.slice(d,m)),s+=Math.floor(Number(t[l])),d=m+2,m++;break;case 79:case 111:case 106:if(l>=u||t[l]===void 0)break;d<m&&(s+=e.slice(d,m));var g=typeof t[l];if(g==="string"){s+="'"+t[l]+"'",d=m+2,m++;break}if(g==="function"){s+=t[l].name||"<anonymous>",d=m+2,m++;break}s+=o(t[l]),d=m+2,m++;break;case 115:if(l>=u)break;d<m&&(s+=e.slice(d,m)),s+=String(t[l]),d=m+2,m++;break;case 37:d<m&&(s+=e.slice(d,m)),s+="%",d=m+2,m++,l--;break}++l;}++m;}return d===-1?e:(d<p&&(s+=e.slice(d)),s)}});var mf=ce((u_,Bi)=>{var cf=af();Bi.exports=Bt;var bn=fv().console||{},ev={mapHttpRequest:Li,mapHttpResponse:Li,wrapRequestSerializer:tu,wrapResponseSerializer:tu,wrapErrorSerializer:tu,req:Li,res:Li,err:uf,errWithCause:uf};function Ui(e,t){return e==="silent"?1/0:t.levels.values[e]}var nu=Symbol("pino.logFuncs"),ru=Symbol("pino.hierarchy"),tv={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function sf(e,t){let r={logger:t,parent:e[ru]};t[ru]=r;}function rv(e,t,r){let o={};t.forEach(n=>{o[n]=r[n]?r[n]:bn[n]||bn[tv[n]||"log"]||Pn;}),e[nu]=o;}function ov(e,t){return Array.isArray(e)?e.filter(function(o){return o!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function Bt(e){e=e||{},e.browser=e.browser||{};let t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");let r=e.browser.write||bn;e.browser.write&&(e.browser.asObject=!0);let o=e.serializers||{},n=ov(e.browser.serialize,o),a=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(a=!1);let i=Object.keys(e.customLevels||{}),c=["error","fatal","warn","info","debug","trace"].concat(i);typeof r=="function"&&c.forEach(function(x){r[x]=r;}),(e.enabled===!1||e.browser.disabled)&&(e.level="silent");let u=e.level||"info",s=Object.create(r);s.log||(s.log=Pn),rv(s,c,r),sf({},s),Object.defineProperty(s,"levelVal",{get:d}),Object.defineProperty(s,"level",{get:p,set:m});let l={transmit:t,serialize:n,asObject:e.browser.asObject,formatters:e.browser.formatters,levels:c,timestamp:dv(e)};s.levels=nv(e),s.level=u,s.setMaxListeners=s.getMaxListeners=s.emit=s.addListener=s.on=s.prependListener=s.once=s.prependOnceListener=s.removeListener=s.removeAllListeners=s.listeners=s.listenerCount=s.eventNames=s.write=s.flush=Pn,s.serializers=o,s._serialize=n,s._stdErrSerialize=a,s.child=g,t&&(s._logEvent=ou());function d(){return Ui(this.level,this)}function p(){return this._level}function m(x){if(x!=="silent"&&!this.levels.values[x])throw Error("unknown level "+x);this._level=x,Lr(this,l,s,"error"),Lr(this,l,s,"fatal"),Lr(this,l,s,"warn"),Lr(this,l,s,"info"),Lr(this,l,s,"debug"),Lr(this,l,s,"trace"),i.forEach(v=>{Lr(this,l,s,v);});}function g(x,v){if(!x)throw new Error("missing bindings for child Pino");v=v||{},n&&x.serializers&&(v.serializers=x.serializers);let E=v.serializers;if(n&&E){var k=Object.assign({},o,E),K=e.browser.serialize===!0?Object.keys(k):n;delete x.serializers,Qi([x],K,k,this._stdErrSerialize);}function $(Y){this._childLevel=(Y._childLevel|0)+1,this.bindings=x,k&&(this.serializers=k,this._serialize=K),t&&(this._logEvent=ou([].concat(Y._logEvent.bindings,x)));}$.prototype=this;let Z=new $(this);return sf(this,Z),Z.level=this.level,Z}return s}function nv(e){let t=e.customLevels||{},r=Object.assign({},Bt.levels.values,t),o=Object.assign({},Bt.levels.labels,av(t));return {values:r,labels:o}}function av(e){let t={};return Object.keys(e).forEach(function(r){t[e[r]]=r;}),t}Bt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Bt.stdSerializers=ev;Bt.stdTimeFunctions=Object.assign({},{nullTime:lf,epochTime:df,unixTime:mv,isoTime:pv});function iv(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[ru];for(;r.parent;)r=r.parent,r.logger.bindings&&t.push(r.logger.bindings);return t.reverse()}function Lr(e,t,r,o){if(Object.defineProperty(e,o,{value:Ui(e.level,r)>Ui(o,r)?Pn:r[nu][o],writable:!0,enumerable:!0,configurable:!0}),!t.transmit&&e[o]===Pn)return;e[o]=sv(e,t,r,o);let n=iv(e);n.length!==0&&(e[o]=cv(n,e[o]));}function cv(e,t){return function(){return t.apply(this,[...e,...arguments])}}function sv(e,t,r,o){return function(n){return function(){let i=t.timestamp(),c=new Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===bn?bn:this;for(var s=0;s<c.length;s++)c[s]=arguments[s];if(t.serialize&&!t.asObject&&Qi(c,this._serialize,this.serializers,this._stdErrSerialize),t.asObject||t.formatters?n.call(u,uv(this,o,c,i,t.formatters)):n.apply(u,c),t.transmit){let l=t.transmit.level||e._level,d=r.levels.values[l],p=r.levels.values[o];if(p<d)return;lv(this,{ts:i,methodLevel:o,methodValue:p,transmitLevel:l,transmitValue:r.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:Ui(e._level,r)},c);}}}(e[nu][o])}function uv(e,t,r,o,n={}){let{level:a=()=>e.levels.values[t],log:i=p=>p}=n;e._serialize&&Qi(r,e._serialize,e.serializers,e._stdErrSerialize);let c=r.slice(),u=c[0],s={};o&&(s.time=o),s.level=a(t,e.levels.values[t]);let l=(e._childLevel|0)+1;if(l<1&&(l=1),u!==null&&typeof u=="object"){for(;l--&&typeof c[0]=="object";)Object.assign(s,c.shift());u=c.length?cf(c.shift(),c):void 0;}else typeof u=="string"&&(u=cf(c.shift(),c));return u!==void 0&&(s.msg=u),i(s)}function Qi(e,t,r,o){for(let n in e)if(o&&e[n]instanceof Error)e[n]=Bt.stdSerializers.err(e[n]);else if(typeof e[n]=="object"&&!Array.isArray(e[n]))for(let a in e[n])t&&t.indexOf(a)>-1&&a in r&&(e[n][a]=r[a](e[n][a]));}function lv(e,t,r){let o=t.send,n=t.ts,a=t.methodLevel,i=t.methodValue,c=t.val,u=e._logEvent.bindings;Qi(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=n,e._logEvent.messages=r.filter(function(s){return u.indexOf(s)===-1}),e._logEvent.level.label=a,e._logEvent.level.value=i,o(a,e._logEvent,c),e._logEvent=ou(u);}function ou(e){return {ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function uf(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)t[r]===void 0&&(t[r]=e[r]);return t}function dv(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?lf:df}function Li(){return {}}function tu(e){return e}function Pn(){}function lf(){return !1}function df(){return Date.now()}function mv(){return Math.round(Date.now()/1e3)}function pv(){return new Date(Date.now()).toISOString()}function fv(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}Bi.exports.default=Bt;Bi.exports.pino=Bt;});var To=()=>global.crypto,Fu=()=>{typeof window<"u"||(To()||(global.crypto=ph("crypto")),!To().getRandomValues&&To().webcrypto&&(global.crypto.getRandomValues=To().webcrypto.getRandomValues.bind(To().webcrypto)));};var $u=Qe(bu()),zu=Qe(ku());var Br=class extends Error{constructor(){super(),this.name="ExpiredToken",this.message="The token being used to perform the request is expired.";}},Sr=class extends Error{constructor(t,r){super(),this.name="Disconnected",this.message=`Client could not connect to the following URL: ${t}`,this.statusCode=r??0;}};Qe(Uu());var Cr=(e,t=5)=>e+Math.random().toString(36).substring(2,2+t);var Yh=new Set(["1",1,"yes",!0]);function kn(){if(typeof navigator>"u"||typeof window>"u")return !1;let e=navigator,t=window;return [e.globalPrivacyControl,e.doNotTrack,e.msDoNotTrack,t.doNotTrack].some(r=>Yh.has(r))}function Qu(e){let t={};for(let[r,o]of e)t[r]=o;return t}function Vo(e){if(typeof e!="object"||!e)return e;try{return JSON.parse(JSON.stringify(e))}catch{return e}}function Bu(e){let t=[];for(let r in e){let o=encodeURIComponent(r),n=encodeURIComponent(e[r]);t.push(`${o}=${n}`);}return t.join("&")}function _u(e){return typeof e!="object"||!e?!1:Object.values(e).every(Gh)}function Gh(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function ju(e){return e===429}var _r=class e{static async call(t){let r=Jh(t),{logger:o}=t,n=await e.preprocessRequest(r,t);o.info(n,"Platform request");let{url:a,...i}=n,c=async()=>{let u=await(0, $u.default)(a,i);if(ju(u.status))throw u;return u};try{let u=await(0, zu.backOff)(c,{retry:s=>{let l=s&&ju(s.status);return l&&o.info("Platform retrying request"),l}});if(u.status===419)throw o.info("Platform renewing token"),new Br;if(u.status===404)throw new Sr(a,u.status);return o.info({response:u,requestInfo:n},"Platform response"),u}catch(u){return u.message==="Failed to fetch"?new Sr(a):u}}static async preprocessRequest(t,r){let{origin:o,preprocessRequest:n,logger:a,requestMetadata:i}=r,{signal:c,...u}=t,s=Vo(u);try{let l=await n(t,o,i);return {...t,...l}}catch(l){a.error(l,"Platform request preprocessing failed. Returning default request options.");}return s}};function Hu(e,t){let r=!t||!t.environment||t.environment==="prod"?"":t.environment,o=!t||!t.region||t.region==="us"?"":`-${t.region}`;return `https://${e}${r}${o}.cloud.coveo.com`}function No(e,t="prod"){let r=t==="prod"?"":t,o=`https://${e}.org${r}.coveo.com`,n=`https://${e}.analytics.org${r}.coveo.com`,a=`${o}/rest/search/v2`,i=`https://${e}.admin.org${r}.coveo.com`;return {platform:o,analytics:n,search:a,admin:i}}function Fc(e){return e?.multiRegionSubDomain?`https://${e.multiRegionSubDomain}.org.coveo.com`:Hu("platform",e)}function Wu(e){return Hu("analytics",e)}function Jh(e){let{url:t,method:r,requestParams:o,contentType:n,accessToken:a,signal:i}=e,c=e.method==="POST"||e.method==="PUT",u=Xh(o,n);return {url:t,method:r,headers:{"Content-Type":n,Authorization:`Bearer ${a}`,...e.headers},...c&&{body:u},signal:i}}function Xh(e,t){return t==="application/x-www-form-urlencoded"?_u(e)?Bu(e):"":JSON.stringify(e)}function Zh(e){return {statusCode:e.statusCode,type:e.name,message:e.message}}function ey(e){return {statusCode:e.code,type:e.name,message:e.message,ignored:!0}}function Ac(e,t){if(t&&e.name==="AbortError")return {error:ey(e)};if(e instanceof Sr)return {error:Zh(e)};throw e}var jr=(e,t)=>({...Mo(e,t),requestParams:ty(e)}),ty=e=>{let{trackingId:t,clientId:r,context:o,language:n,country:a,currency:i,page:c,perPage:u,facets:s,sort:l}=e;return {trackingId:t,clientId:r,context:o,language:n,country:a,currency:i,page:c,perPage:u,facets:s,sort:l}},Mo=(e,t)=>{let{url:r,organizationId:o,accessToken:n}=e,a=`${r}/rest/organizations/${o}/commerce/v2/${t}`;return {accessToken:n,method:"POST",contentType:"application/json",url:a,origin:"commerceApiFetch"}};var Ku=(e,t)=>({...Mo(e,t),requestParams:ry(e)}),ry=e=>{let{slotId:t,trackingId:r,clientId:o,context:n,language:a,country:i,currency:c,page:u}=e;return {slotId:t,trackingId:r,clientId:o,context:n,language:a,country:i,currency:c,page:u}};var Yu=e=>({...Mo(e,"search/querySuggest"),requestParams:oy(e)}),oy=e=>{let{trackingId:t,query:r,clientId:o,context:n,language:a,country:i,currency:c}=e;return {trackingId:t,query:r,clientId:o,context:n,language:a,country:i,currency:c}};var ve=e=>e.error!==void 0,Dn=class{constructor(t){this.options=t;}async getProductListing(t){return this.query({...jr(t,"listing"),...this.options})}async getRecommendations(t){return this.query({...Ku(t,"recommendations"),...this.options})}async search(t){let r=jr(t,"search");return this.query({...r,requestParams:{...r.requestParams,query:t?.query},...this.options})}async productSuggestions(t){let r=jr(t,"search/productSuggest");return this.query({...r,requestParams:{...r.requestParams,query:t?.query},...this.options})}async querySuggest(t){let r=Yu(t);return this.query({...r,requestParams:{...r.requestParams,query:t?.query},...this.options})}async facetSearch(t){let r=jr(t,"facet");return this.query({...r,requestParams:{...r.requestParams,facetId:t?.facetId,facetQuery:t?.facetQuery,query:t?.query},...this.options})}async plan(t){let r=jr(t,"search");return this.query({...r,requestParams:{...r.requestParams,query:t?.query},...this.options})}async query(t){let r=await _r.call(t);if(r instanceof Error)return Ac(r);let o=await r.json();return r.ok?{success:o}:{error:o}}};var Vn=e=>e;function Se(e){return `Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var ny=typeof Symbol=="function"&&Symbol.observable||"@@observable",Gu=ny,bc=()=>Math.random().toString(36).substring(7).split("").join("."),ay={INIT:`@@redux/INIT${bc()}`,REPLACE:`@@redux/REPLACE${bc()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${bc()}`},Nn=ay;function Mn(e){if(typeof e!="object"||e===null)return !1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Pc(e,t,r){if(typeof e!="function")throw new Error(Se(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Se(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Se(1));return r(Pc)(e,t)}let o=e,n=t,a=new Map,i=a,c=0,u=!1;function s(){i===a&&(i=new Map,a.forEach((v,E)=>{i.set(E,v);}));}function l(){if(u)throw new Error(Se(3));return n}function d(v){if(typeof v!="function")throw new Error(Se(4));if(u)throw new Error(Se(5));let E=!0;s();let k=c++;return i.set(k,v),function(){if(E){if(u)throw new Error(Se(6));E=!1,s(),i.delete(k),a=null;}}}function p(v){if(!Mn(v))throw new Error(Se(7));if(typeof v.type>"u")throw new Error(Se(8));if(typeof v.type!="string")throw new Error(Se(17));if(u)throw new Error(Se(9));try{u=!0,n=o(n,v);}finally{u=!1;}return (a=i).forEach(k=>{k();}),v}function m(v){if(typeof v!="function")throw new Error(Se(10));o=v,p({type:Nn.REPLACE});}function g(){let v=d;return {subscribe(E){if(typeof E!="object"||E===null)throw new Error(Se(11));function k(){let $=E;$.next&&$.next(l());}return k(),{unsubscribe:v(k)}},[Gu](){return this}}}return p({type:Nn.INIT}),{dispatch:p,subscribe:d,getState:l,replaceReducer:m,[Gu]:g}}function iy(e){Object.keys(e).forEach(t=>{let r=e[t];if(typeof r(void 0,{type:Nn.INIT})>"u")throw new Error(Se(12));if(typeof r(void 0,{type:Nn.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Se(13))});}function Ln(e){let t=Object.keys(e),r={};for(let i=0;i<t.length;i++){let c=t[i];typeof e[c]=="function"&&(r[c]=e[c]);}let o=Object.keys(r),a;try{iy(r);}catch(i){a=i;}return function(c={},u){if(a)throw a;let s=!1,l={};for(let d=0;d<o.length;d++){let p=o[d],m=r[p],g=c[p],x=m(g,u);if(typeof x>"u"){throw new Error(Se(14))}l[p]=x,s=s||x!==g;}return s=s||o.length!==Object.keys(c).length,s?l:c}}function $r(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...o)=>t(r(...o)))}function Ju(...e){return t=>(r,o)=>{let n=t(r,o),a=()=>{throw new Error(Se(15))},i={getState:n.getState,dispatch:(u,...s)=>a(u,...s)},c=e.map(u=>u(i));return a=$r(...c)(n.dispatch),{...n,dispatch:a}}}function Xu(e){return Mn(e)&&"type"in e&&typeof e.type=="string"}var nl=Symbol.for("immer-nothing"),Zu=Symbol.for("immer-draftable"),Me=Symbol.for("immer-state");function tt(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var zr=Object.getPrototypeOf;function dt(e){return !!e&&!!e[Me]}function rt(e){return e?al(e)||Array.isArray(e)||!!e[Zu]||!!e.constructor?.[Zu]||_n(e)||jn(e):!1}var cy=Object.prototype.constructor.toString();function al(e){if(!e||typeof e!="object")return !1;let t=zr(e);if(t===null)return !0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===cy}function Lo(e,t){Bn(e)===0?Object.entries(e).forEach(([r,o])=>{t(r,o,e);}):e.forEach((r,o)=>t(o,r,e));}function Bn(e){let t=e[Me];return t?t.type_:Array.isArray(e)?1:_n(e)?2:jn(e)?3:0}function Ec(e,t){return Bn(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function il(e,t,r){let o=Bn(e);o===2?e.set(t,r):o===3?e.add(r):e[t]=r;}function sy(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function _n(e){return e instanceof Map}function jn(e){return e instanceof Set}function xr(e){return e.copy_||e.base_}function Oc(e,t){if(_n(e))return new Map(e);if(jn(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&al(e))return zr(e)?{...e}:Object.assign(Object.create(null),e);let r=Object.getOwnPropertyDescriptors(e);delete r[Me];let o=Reflect.ownKeys(r);for(let n=0;n<o.length;n++){let a=o[n],i=r[a];i.writable===!1&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(r[a]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[a]});}return Object.create(zr(e),r)}function Vc(e,t=!1){return $n(e)||dt(e)||!rt(e)||(Bn(e)>1&&(e.set=e.add=e.clear=e.delete=uy),Object.freeze(e),t&&Lo(e,(r,o)=>Vc(o,!0))),e}function uy(){tt(2);}function $n(e){return Object.isFrozen(e)}var ly={};function Rr(e){let t=ly[e];return t||tt(0,e),t}var Uo;function cl(){return Uo}function dy(e,t){return {drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function el(e,t){t&&(Rr("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t);}function qc(e){Tc(e),e.drafts_.forEach(my),e.drafts_=null;}function Tc(e){e===Uo&&(Uo=e.parent_);}function tl(e){return Uo=dy(Uo,e)}function my(e){let t=e[Me];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0;}function rl(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[Me].modified_&&(qc(t),tt(4)),rt(e)&&(e=Un(t,e),t.parent_||Qn(t,e)),t.patches_&&Rr("Patches").generateReplacementPatches_(r[Me].base_,e,t.patches_,t.inversePatches_)):e=Un(t,r,[]),qc(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==nl?e:void 0}function Un(e,t,r){if($n(t))return t;let o=t[Me];if(!o)return Lo(t,(n,a)=>ol(e,o,t,n,a,r)),t;if(o.scope_!==e)return t;if(!o.modified_)return Qn(e,o.base_,!0),o.base_;if(!o.finalized_){o.finalized_=!0,o.scope_.unfinalizedDrafts_--;let n=o.copy_,a=n,i=!1;o.type_===3&&(a=new Set(n),n.clear(),i=!0),Lo(a,(c,u)=>ol(e,o,n,c,u,r,i)),Qn(e,n,!1),r&&e.patches_&&Rr("Patches").generatePatches_(o,r,e.patches_,e.inversePatches_);}return o.copy_}function ol(e,t,r,o,n,a,i){if(dt(n)){let c=a&&t&&t.type_!==3&&!Ec(t.assigned_,o)?a.concat(o):void 0,u=Un(e,n,c);if(il(r,o,u),dt(u))e.canAutoFreeze_=!1;else return}else i&&r.add(n);if(rt(n)&&!$n(n)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Un(e,n),(!t||!t.scope_.parent_)&&Qn(e,n);}}function Qn(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Vc(t,r);}function py(e,t){let r=Array.isArray(e),o={type_:r?1:0,scope_:t?t.scope_:cl(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},n=o,a=Nc;r&&(n=[o],a=Qo);let{revoke:i,proxy:c}=Proxy.revocable(n,a);return o.draft_=c,o.revoke_=i,c}var Nc={get(e,t){if(t===Me)return e;let r=xr(e);if(!Ec(r,t))return fy(e,r,t);let o=r[t];return e.finalized_||!rt(o)?o:o===Ic(e.base_,t)?(wc(e),e.copy_[t]=Dc(o,e)):o},has(e,t){return t in xr(e)},ownKeys(e){return Reflect.ownKeys(xr(e))},set(e,t,r){let o=sl(xr(e),t);if(o?.set)return o.set.call(e.draft_,r),!0;if(!e.modified_){let n=Ic(xr(e),t),a=n?.[Me];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(sy(r,n)&&(r!==void 0||Ec(e.base_,t)))return !0;wc(e),kc(e);}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Ic(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,wc(e),kc(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=xr(e),o=Reflect.getOwnPropertyDescriptor(r,t);return o&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:o.enumerable,value:r[t]}},defineProperty(){tt(11);},getPrototypeOf(e){return zr(e.base_)},setPrototypeOf(){tt(12);}},Qo={};Lo(Nc,(e,t)=>{Qo[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)};});Qo.deleteProperty=function(e,t){return Qo.set.call(this,e,t,void 0)};Qo.set=function(e,t,r){return Nc.set.call(this,e[0],t,r,e[0])};function Ic(e,t){let r=e[Me];return (r?xr(r):e)[t]}function fy(e,t,r){let o=sl(t,r);return o?"value"in o?o.value:o.get?.call(e.draft_):void 0}function sl(e,t){if(!(t in e))return;let r=zr(e);for(;r;){let o=Object.getOwnPropertyDescriptor(r,t);if(o)return o;r=zr(r);}}function kc(e){e.modified_||(e.modified_=!0,e.parent_&&kc(e.parent_));}function wc(e){e.copy_||(e.copy_=Oc(e.base_,e.scope_.immer_.useStrictShallowCopy_));}var gy=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,o)=>{if(typeof t=="function"&&typeof r!="function"){let a=r;r=t;let i=this;return function(u=a,...s){return i.produce(u,l=>r.call(this,l,...s))}}typeof r!="function"&&tt(6),o!==void 0&&typeof o!="function"&&tt(7);let n;if(rt(t)){let a=tl(this),i=Dc(t,void 0),c=!0;try{n=r(i),c=!1;}finally{c?qc(a):Tc(a);}return el(a,o),rl(n,a)}else if(!t||typeof t!="object"){if(n=r(t),n===void 0&&(n=t),n===nl&&(n=void 0),this.autoFreeze_&&Vc(n,!0),o){let a=[],i=[];Rr("Patches").generateReplacementPatches_(t,n,a,i),o(a,i);}return n}else tt(1,t);},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return (i,...c)=>this.produceWithPatches(i,u=>t(u,...c));let o,n;return [this.produce(t,r,(i,c)=>{o=i,n=c;}),o,n]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy);}createDraft(e){rt(e)||tt(8),dt(e)&&(e=Mc(e));let t=tl(this),r=Dc(e,void 0);return r[Me].isManual_=!0,Tc(t),r}finishDraft(e,t){let r=e&&e[Me];(!r||!r.isManual_)&&tt(9);let{scope_:o}=r;return el(o,t),rl(void 0,o)}setAutoFreeze(e){this.autoFreeze_=e;}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e;}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let n=t[r];if(n.path.length===0&&n.op==="replace"){e=n.value;break}}r>-1&&(t=t.slice(r+1));let o=Rr("Patches").applyPatches_;return dt(e)?o(e,t):this.produce(e,n=>o(n,t))}};function Dc(e,t){let r=_n(e)?Rr("MapSet").proxyMap_(e,t):jn(e)?Rr("MapSet").proxySet_(e,t):py(e,t);return (t?t.scope_:cl()).drafts_.push(r),r}function Mc(e){return dt(e)||tt(10,e),ul(e)}function ul(e){if(!rt(e)||$n(e))return e;let t=e[Me],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Oc(e,t.scope_.immer_.useStrictShallowCopy_);}else r=Oc(e,!0);return Lo(r,(o,n)=>{il(r,o,ul(n));}),t&&(t.finalized_=!1),r}var Le=new gy,zn=Le.produce;Le.produceWithPatches.bind(Le);Le.setAutoFreeze.bind(Le);Le.setUseStrictShallowCopy.bind(Le);Le.applyPatches.bind(Le);Le.createDraft.bind(Le);Le.finishDraft.bind(Le);function hy(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function yy(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Sy(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){let r=e.map(o=>typeof o=="function"?`function ${o.name||"unnamed"}()`:typeof o).join(", ");throw new TypeError(`${t}[${r}]`)}}var ll=e=>Array.isArray(e)?e:[e];function Cy(e){let t=Array.isArray(e[0])?e[0]:e;return Sy(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function xy(e,t){let r=[],{length:o}=e;for(let n=0;n<o;n++)r.push(e[n].apply(null,t));return r}var Ry=class{constructor(e){this.value=e;}deref(){return this.value}},vy=typeof WeakRef<"u"?WeakRef:Ry,Fy=0,dl=1;function Hn(){return {s:Fy,v:void 0,o:null,p:null}}function Bo(e,t={}){let r=Hn(),{resultEqualityCheck:o}=t,n,a=0;function i(){let c=r,{length:u}=arguments;for(let d=0,p=u;d<p;d++){let m=arguments[d];if(typeof m=="function"||typeof m=="object"&&m!==null){let g=c.o;g===null&&(c.o=g=new WeakMap);let x=g.get(m);x===void 0?(c=Hn(),g.set(m,c)):c=x;}else {let g=c.p;g===null&&(c.p=g=new Map);let x=g.get(m);x===void 0?(c=Hn(),g.set(m,c)):c=x;}}let s=c,l;if(c.s===dl?l=c.v:(l=e.apply(null,arguments),a++),s.s=dl,o){let d=n?.deref?.()??n;d!=null&&o(d,l)&&(l=d,a!==0&&a--),n=typeof l=="object"&&l!==null||typeof l=="function"?new vy(l):l;}return s.v=l,l}return i.clearCache=()=>{r=Hn(),i.resetResultsCount();},i.resultsCount=()=>a,i.resetResultsCount=()=>{a=0;},i}function Wn(e,...t){let r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,o=(...n)=>{let a=0,i=0,c,u={},s=n.pop();typeof s=="object"&&(u=s,s=n.pop()),hy(s,`createSelector expects an output function after the inputs, but received: [${typeof s}]`);let l={...r,...u},{memoize:d,memoizeOptions:p=[],argsMemoize:m=Bo,argsMemoizeOptions:g=[],devModeChecks:x={}}=l,v=ll(p),E=ll(g),k=Cy(n),K=d(function(){return a++,s.apply(null,arguments)},...v),Z=m(function(){i++;let re=xy(k,arguments);return c=K.apply(null,re),c},...E);return Object.assign(Z,{resultFunc:s,memoizedResultFunc:K,dependencies:k,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0;},lastResult:()=>c,recomputations:()=>a,resetRecomputations:()=>{a=0;},memoize:d,argsMemoize:m})};return Object.assign(o,{withTypes:()=>o}),o}var D=Wn(Bo),Ay=Object.assign((e,t=D)=>{yy(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e),o=r.map(a=>e[a]);return t(o,(...a)=>a.reduce((i,c,u)=>(i[r[u]]=c,i),{}))},{withTypes:()=>Ay});function ml(e){return ({dispatch:r,getState:o})=>n=>a=>typeof a=="function"?a(r,o,e):n(a)}var pl=ml(),fl=ml;var by=(...e)=>{let t=Wn(...e),r=Object.assign((...o)=>{let n=t(...o),a=(i,...c)=>n(dt(i)?Mc(i):i,...c);return Object.assign(a,n),a},{withTypes:()=>r});return r};by(Bo);var Py=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?$r:$r.apply(null,arguments)},Iy=e=>e&&typeof e.match=="function";function f(e,t){function r(...o){if(t){let n=t(...o);if(!n)throw new Error(Oe(0));return {type:e,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return {type:e,payload:o[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=o=>Xu(o)&&o.type===e,r}var yl=class _o extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,_o.prototype);}static get[Symbol.species](){return _o}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new _o(...t[0].concat(this)):new _o(...t.concat(this))}};function gl(e){return rt(e)?zn(e,()=>{}):e}function wy(e){return typeof e=="boolean"}var Ey=()=>function(t){let{thunk:r=!0,immutableCheck:o=!0,serializableCheck:n=!0,actionCreatorCheck:a=!0}=t??{},i=new yl;return r&&(wy(r)?i.push(pl):i.push(fl(r.extraArgument))),i},Oy="RTK_autoBatch";var Sl=e=>t=>{setTimeout(t,e);},qy=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Sl(10),Ty=(e={type:"raf"})=>t=>(...r)=>{let o=t(...r),n=!0,a=!1,i=!1,c=new Set,u=e.type==="tick"?queueMicrotask:e.type==="raf"?qy:e.type==="callback"?e.queueNotification:Sl(e.timeout),s=()=>{i=!1,a&&(a=!1,c.forEach(l=>l()));};return Object.assign({},o,{subscribe(l){let d=()=>n&&l(),p=o.subscribe(d);return c.add(l),()=>{p(),c.delete(l);}},dispatch(l){try{return n=!l?.meta?.[Oy],a=!n,a&&(i||(i=!0,u(s))),o.dispatch(l)}finally{n=!0;}}})},ky=e=>function(r){let{autoBatch:o=!0}=r??{},n=new yl(e);return o&&n.push(Ty(typeof o=="object"?o:void 0)),n},$t=!0;function Cl(e){let t=Ey(),{reducer:r=void 0,middleware:o,devTools:n=!0,preloadedState:a=void 0,enhancers:i=void 0}=e||{},c;if(typeof r=="function")c=r;else if(Mn(r))c=Ln(r);else throw new Error(Oe(1));let u;if(typeof o=="function"){if(u=o(t),!$t);}else u=t();let s=$r;n&&(s=Py({trace:!$t,...typeof n=="object"&&n}));let l=Ju(...u),d=ky(l);let p=typeof i=="function"?i(d):d();let m=s(...p);return Pc(c,a,m)}function Dy(e){let t={},r=[],o,n={addCase(a,i){let c=typeof a=="string"?a:a.type;if(!c)throw new Error(Oe(28));if(c in t)throw new Error(Oe(29));return t[c]=i,n},addMatcher(a,i){return r.push({matcher:a,reducer:i}),n},addDefaultCase(a){return o=a,n}};return e(n),[t,r,o]}function Vy(e){return typeof e=="function"}function q(e,t){let[r,o,n]=Dy(t),a;if(Vy(e))a=()=>gl(e());else {let c=gl(e);a=()=>c;}function i(c=a(),u){let s=[r[u.type],...o.filter(({matcher:l})=>l(u)).map(({reducer:l})=>l)];return s.filter(l=>!!l).length===0&&(s=[n]),s.reduce((l,d)=>{if(d)if(dt(l)){let m=d(l,u);return m===void 0?l:m}else {if(rt(l))return zn(l,p=>d(p,u));{let p=d(l,u);if(p===void 0){if(l===null)return l;throw new Error(Oe(9))}return p}}return l},c)}return i.getInitialState=a,i}var Ny="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",xl=(e=21)=>{let t="",r=e;for(;r--;)t+=Ny[Math.random()*64|0];return t},My=(e,t)=>Iy(e)?e.match(t):e(t);function Ly(...e){return t=>e.some(r=>My(r,t))}var Uy=["name","message","stack","code"],Lc=class{constructor(e,t){qn(this,"_type");this.payload=e,this.meta=t;}},hl=class{constructor(e,t){qn(this,"_type");this.payload=e,this.meta=t;}},Qy=e=>{if(typeof e=="object"&&e!==null){let t={};for(let r of Uy)typeof e[r]=="string"&&(t[r]=e[r]);return t}return {message:String(e)}},T=(()=>{function e(t,r,o){let n=f(t+"/fulfilled",(u,s,l,d)=>({payload:u,meta:{...d||{},arg:l,requestId:s,requestStatus:"fulfilled"}})),a=f(t+"/pending",(u,s,l)=>({payload:void 0,meta:{...l||{},arg:s,requestId:u,requestStatus:"pending"}})),i=f(t+"/rejected",(u,s,l,d,p)=>({payload:d,error:(o&&o.serializeError||Qy)(u||"Rejected"),meta:{...p||{},arg:l,requestId:s,rejectedWithValue:!!d,requestStatus:"rejected",aborted:u?.name==="AbortError",condition:u?.name==="ConditionError"}}));function c(u){return (s,l,d)=>{let p=o?.idGenerator?o.idGenerator(u):xl(),m=new AbortController,g,x;function v(k){x=k,m.abort();}let E=async function(){let k;try{let $=o?.condition?.(u,{getState:l,extra:d});if(_y($)&&($=await $),$===!1||m.signal.aborted)throw {name:"ConditionError",message:"Aborted due to condition callback returning false."};let Z=new Promise((Y,re)=>{g=()=>{re({name:"AbortError",message:x||"Aborted"});},m.signal.addEventListener("abort",g);});s(a(p,u,o?.getPendingMeta?.({requestId:p,arg:u},{getState:l,extra:d}))),k=await Promise.race([Z,Promise.resolve(r(u,{dispatch:s,getState:l,extra:d,requestId:p,signal:m.signal,abort:v,rejectWithValue:(Y,re)=>new Lc(Y,re),fulfillWithValue:(Y,re)=>new hl(Y,re)})).then(Y=>{if(Y instanceof Lc)throw Y;return Y instanceof hl?n(Y.payload,p,u,Y.meta):n(Y,p,u)})]);}catch($){k=$ instanceof Lc?i(null,p,u,$.payload,$.meta):i($,p,u);}finally{g&&m.signal.removeEventListener("abort",g);}return o&&!o.dispatchConditionRejection&&i.match(k)&&k.meta.condition||s(k),k}();return Object.assign(E,{abort:v,requestId:p,arg:u,unwrap(){return E.then(By)}})}}return Object.assign(c,{pending:a,rejected:i,fulfilled:n,settled:Ly(i,n),typePrefix:t})}return e.withTypes=()=>e,e})();function By(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function _y(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var $y=(e,t)=>{if(typeof e!="function")throw new Error(Oe(32))};var Uc="listenerMiddleware";var zy=e=>{let{type:t,actionCreator:r,matcher:o,predicate:n,effect:a}=e;if(t)n=f(t).match;else if(r)t=r.type,n=r.match;else if(o)n=o;else if(!n)throw new Error(Oe(21));return $y(a),{predicate:n,type:t,effect:a}},Hy=Object.assign(e=>{let{type:t,predicate:r,effect:o}=zy(e);return {id:xl(),effect:o,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Oe(22))}}},{withTypes:()=>Hy});var Wy=Object.assign(f(`${Uc}/add`),{withTypes:()=>Wy});f(`${Uc}/removeAll`);var Ky=Object.assign(f(`${Uc}/remove`),{withTypes:()=>Ky});function Oe(e){return `Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}function Yy(e,t){let r=`
  The following properties are invalid:

    ${e.join(`
	`)}
  
  ${t}
  `;return new vr(r)}var vr=class extends Error{constructor(e){super(e),this.name="SchemaValidationError";}},z=class{constructor(e){this.definition=e;}validate(e={},t=""){let r={...this.default,...e},o=[];for(let n in this.definition){let a=this.definition[n].validate(r[n]);a&&o.push(`${n}: ${a}`);}if(o.length)throw Yy(o,t);return r}get default(){let e={};for(let t in this.definition){let r=this.definition[t].default;r!==void 0&&(e[t]=r);}return e}},te=class{constructor(e={}){this.baseConfig=e;}validate(e){return this.baseConfig.required&&M(e)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return this.baseConfig.required===!0}};function Ft(e){return e===void 0}function Gy(e){return e===null}function M(e){return Ft(e)||Gy(e)}var P=class{constructor(e={}){this.config=e,this.value=new te(e);}validate(e){let t=this.value.validate(e);return t||(Jy(e)?e<this.config.min?`minimum value of ${this.config.min} not respected.`:e>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}};function Jy(e){return Ft(e)||Al(e)}function Al(e){return typeof e=="number"&&!isNaN(e)}var V=class{constructor(e={}){this.value=new te(e);}validate(e){let t=this.value.validate(e);return t||(Xy(e)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}};function Xy(e){return Ft(e)||bl(e)}function bl(e){return typeof e=="boolean"}var Zy=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i,C=class{constructor(e={}){this.config={emptyAllowed:!0,url:!1,...e},this.value=new te(this.config);}validate(e){let{emptyAllowed:t,url:r,regex:o,constrainTo:n}=this.config,a=this.value.validate(e);return a||(Ft(e)?null:Qc(e)?!t&&!e.length?"value is an empty string.":r&&!Zy.test(e)?"value is not a valid URL.":o&&!o.test(e)?`value did not match provided regex ${o}`:n&&!n.includes(e)?`value should be one of: ${n.join(", ")}.`:null:"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}};function Qc(e){return Object.prototype.toString.call(e)==="[object String]"}var F=class{constructor(e={}){this.config={options:{required:!1},values:{},...e};}validate(e){if(Ft(e))return this.config.options.required?"value is required and is currently undefined":null;if(!Pl(e))return "value is not an object";for(let[r,o]of Object.entries(this.config.values))if(o.required&&M(e[r]))return `value does not contain ${r}`;let t="";for(let[r,o]of Object.entries(this.config.values)){let n=e[r],a=o.validate(n);a!==null&&(t+=" "+a);}return t===""?null:t}get default(){}get required(){return !!this.config.options.required}};function Pl(e){return e!==void 0&&typeof e=="object"}var H=class{constructor(e={}){this.config=e,this.value=new te(this.config);}validate(e){if(!M(e)&&!Array.isArray(e))return "value is not an array";let t=this.value.validate(e);if(t!==null)return t;if(M(e))return null;if(this.config.max!==void 0&&e.length>this.config.max)return `value contains more than ${this.config.max}`;if(this.config.min!==void 0&&e.length<this.config.min)return `value contains less than ${this.config.min}`;if(this.config.each!==void 0){let r="";return e.forEach(o=>{this.config.each.required&&M(o)&&(r=`value is null or undefined: ${e.join(",")}`);let n=this.validatePrimitiveValue(o,this.config.each);n!==null&&(r+=" "+n);}),r===""?null:r}return null}validatePrimitiveValue(e,t){return bl(e)||Qc(e)||Al(e)||Pl(e)?t.validate(e):"value is not a primitive value"}get default(){}get required(){return this.value.required}};function Kn(e){return Array.isArray(e)}var ot=class{constructor(e){this.config=e,this.value=new te(e);}validate(e){let t=this.value.validate(e);return t!==null?t:Ft(e)||Object.values(this.config.enum).find(o=>o===e)?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}};var R=new C({required:!0,emptyAllowed:!1}),X=new C({required:!1,emptyAllowed:!1}),pe=new C({required:!0,emptyAllowed:!0}),Yn=new C({required:!1,emptyAllowed:!0});new H({each:R,required:!0});var Il=new C({required:!1,emptyAllowed:!1,regex:/^\d+\.\d+\.\d+$/}),nt=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),Be=(e,t)=>{if("required"in t)return {payload:new z({value:t}).validate({value:e}).value};let n=new F({options:{required:!0},values:t}).validate(e);if(n)throw new vr(n);return {payload:e}},h=(e,t)=>{try{return Be(e,t)}catch(r){return {payload:e,error:nt(r)}}},qe=(e,t,r,o)=>{let n=`Check the initialState of ${o}`;return wl(e,t,r,n,"Controller initialization error")},Ie=(e,t,r,o)=>{let n=`Check the options of ${o}`;return wl(e,t,r,n,"Controller initialization error")},wl=(e,t,r,o,n)=>{try{return t.validate(r,o)}catch(a){throw e.logger.error(a,n),a}};function jo(e){return e.currency}var El=(e,t)=>({currency:jo(t.commerceContext),products:eS(t.cart),transaction:e}),Fr=D(e=>e.cart,e=>e.cartItems,(e,t)=>t.map(r=>e[r])),eS=D(Fr,e=>e.map(({quantity:t,...r})=>({quantity:t,product:r})));var Bc={productId:R,quantity:new P({required:!0,min:0}),name:new C({required:!1}),price:new P({required:!1,min:0})},_c=new H({each:new F({values:{...Bc}})}),jc={items:_c};new z(jc);var Gn=T("commerce/cart/purchase",async(e,{extra:t,getState:r})=>{let o=El(e,r()),{relay:n}=t;n.emit("ec.purchase",o);}),Hr=f("commerce/cart/setItems",e=>h(e,_c)),Jn=f("commerce/cart/updateItemQuantity",e=>h(e,Bc));var ql="coveo-headless-internal-state",w=Symbol.for(ql),Tl=e=>new Proxy(e,{ownKeys(t){return Reflect.ownKeys(t).filter(r=>r!==w)},get(t,r,o){return typeof r=="symbol"&&r.description===ql&&r!==w&&e.logger.warn(`You might be loading Headless twice. Please check your setup.
If you are trying to access the inner state... Don't`),Reflect.get(t,r,o)}});function _(e){let t,r=new Map,o=()=>r.size===0,n=a=>{try{let i=JSON.stringify(a),c=t!==i;return t=i,c}catch(i){return console.warn('Could not detect if state has changed, check the controller "get state method"',i),!0}};return {subscribe(a){a();let i=Symbol(),c;return o()&&(t=JSON.stringify(this.state),c=e.subscribe(()=>{n(this.state)&&r.forEach(u=>u());})),r.set(i,a),()=>{r.delete(i),o()&&c&&c();}},get state(){return {}}}}D(Fr,e=>e.reduce((t,r)=>t+r.quantity,0));D(Fr,e=>e.reduce((t,r)=>t+r.price*r.quantity,0));function Ar(e){return `${e.productId},${e.name},${e.price}`}var Zn=()=>({cartItems:[],cart:{},purchasedItems:[],purchased:{}}),ea=e=>Ml(e.cartItems,e.cart),Nl=e=>Ml(e.purchasedItems,e.purchased);function Ml(e,t){let r=e.reduce((o,n)=>{let{productId:a,quantity:i}=t[n];return a in o||(o[a]={productId:a,quantity:0}),o[a].quantity+=i,o},{});return [...Object.values(r)]}var Xn=q(Zn(),e=>{e.addCase(Hr,(t,{payload:r})=>{let{cart:o,cartItems:n}=r.reduce((a,i)=>{let c=Ar(i);return {cartItems:[...a.cartItems,c],cart:{...a.cart,[c]:i},purchasedItems:[],purchased:{}}},Zn());Ll(t,n,o);}).addCase(Jn,(t,{payload:r})=>{let o=Ar(r);if(!(o in t.cart)){oS(r,t);return}if(r.quantity<=0){nS(r,t);return}t.cart[o]=r;}).addCase(Gn.fulfilled,t=>{aS(t);let{cart:r,cartItems:o}=Zn();Ll(t,o,r);});});function Ll(e,t,r){e.cartItems=t,e.cart=r;}function oS(e,t){if(e.quantity<=0)return;let r=Ar(e);t.cartItems=[...t.cartItems,r],t.cart[r]=e;}function nS(e,t){let r=Ar(e);t.cartItems=t.cartItems.filter(o=>o!==r),delete t.cart[r];}function aS(e){for(let t of e.cartItems){if(t in e.purchased){e.purchased[t].quantity+=e.cart[t].quantity;continue}e.purchasedItems=[...e.purchasedItems,t],e.purchased[t]=e.cart[t];}}var iS=Intl.supportedValuesOf("currency"),cS=new C({required:!0,emptyAllowed:!1,constrainTo:iS}),$c={url:R,referrer:Yn},zc={userId:X,email:X,userIp:X,userAgent:X},sS=new F({options:{required:!0},values:{productId:X,sku:X,name:X,price:X,quantity:X}});({items:new H({each:sS})});var $o={language:R,country:R,currency:cS,user:new F({values:zc}),view:new F({options:{required:!0},values:$c})};new z($o);var we=f("commerce/setContext",e=>h(e,$o)),mt=f("commerce/setUser",e=>M(e.userId)&&M(e.email)?{payload:e,error:nt(new vr("Either userId or email is required"))}:h(e,zc)),_e=f("commerce/setView",e=>h(e,$c));var Ql=()=>({language:"",country:"",currency:"",view:{url:""}});var zt=q(Ql(),e=>{e.addCase(we,(t,{payload:r})=>r).addCase(mt,(t,{payload:r})=>{t.user=r;}).addCase(_e,(t,{payload:r})=>{t.view=r;});});var fe=f("breadcrumb/deselectAll"),Ht=f("breadcrumb/deselectAllNonBreadcrumbs");var Q=R;var uS={state:new te({required:!0}),numberOfResults:new P({required:!0,min:0}),value:new C({required:!0,emptyAllowed:!0}),path:new H({required:!0,each:R}),moreValuesAvailable:new V({required:!1})};function Hc(e){e.children.forEach(t=>{Hc(t);}),Be({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},uS);}var Wr={facetId:Q,field:R,delimitingCharacter:new C({required:!1,emptyAllowed:!0}),filterFacetCount:new V({required:!1}),injectionDepth:new P({required:!1,min:0}),numberOfValues:new P({required:!1,min:1}),sortCriteria:new te({required:!1}),basePath:new H({required:!1,each:R}),filterByBasePath:new V({required:!1})},Kr=5,Bl=f("categoryFacet/register",e=>h(e,Wr)),Wt=f("categoryFacet/toggleSelectValue",e=>{try{return Be(e.facetId,R),Hc(e.selection),{payload:e,error:null}}catch(t){return {payload:e,error:nt(t)}}}),_l=f("categoryFacet/deselectAll",e=>h(e,Wr.facetId)),zo=f("categoryFacet/updateNumberOfValues",e=>h(e,{facetId:Wr.facetId,numberOfValues:Wr.numberOfValues}));f("categoryFacet/updateSortCriterion",e=>h(e,{facetId:Wr.facetId,criterion:new te}));f("categoryFacet/updateBasePath",e=>h(e,{facetId:Wr.facetId,basePath:new H({each:R})}));var Ho={facetId:Q,captions:new F({options:{required:!1}}),numberOfValues:new P({required:!1,min:1}),query:new C({required:!1,emptyAllowed:!0})};var lS={path:new H({required:!0,each:R}),displayValue:pe,rawValue:pe,count:new P({required:!0,min:0})},Yr=f("categoryFacet/selectSearchResult",e=>h(e,{facetId:Q,value:new F({values:lS})})),ta=f("categoryFacetSearch/register",e=>h(e,Ho));var jl={facetId:Q,value:new F({values:{displayValue:pe,rawValue:pe,count:new P({required:!0,min:0})}})},ra=f("facetSearch/register",e=>h(e,Ho)),Kt=f("facetSearch/update",e=>h(e,Ho)),At=f("facetSearch/toggleSelectValue",e=>h(e,jl)),bt=f("facetSearch/toggleExcludeValue",e=>h(e,jl));var oa=new C({regex:/^[a-zA-Z0-9-_]+$/}),na=new C({required:!0});new H({each:new C});new C;new V;var aa=new V,ia=new P({min:0}),Wo=new P({min:1}),ca=new V({required:!0}),dS=new F,mS=new C,pS={captions:dS,numberOfValues:Wo,query:mS};new F({values:pS});var $l=new F({options:{required:!1},values:{type:new C({constrainTo:["simple"],emptyAllowed:!1,required:!0}),values:new H({required:!0,max:25,each:new C({emptyAllowed:!1,required:!0})})}});new V;var zl=new H({min:1,max:25,required:!1,each:new C({emptyAllowed:!1,required:!0})});var Ko={value:R,numberOfResults:new P({min:0}),state:R};var fS={facetId:Q,field:new C({required:!0,emptyAllowed:!0}),filterFacetCount:new V({required:!1}),injectionDepth:new P({required:!1,min:0}),numberOfValues:new P({required:!1,min:1}),sortCriteria:new te({required:!1}),resultsMustMatch:new te({required:!1}),allowedValues:$l,customSort:zl},sa=f("facet/register",e=>h(e,fS)),je=f("facet/toggleSelectValue",e=>h(e,{facetId:Q,selection:new F({values:Ko})})),$e=f("facet/toggleExcludeValue",e=>h(e,{facetId:Q,selection:new F({values:Ko})})),ie=f("facet/deselectAll",e=>h(e,Q)),Hl=f("facet/updateSortCriterion",e=>h(e,{facetId:Q,criterion:new te({required:!0})})),br=f("facet/updateNumberOfValues",e=>h(e,{facetId:Q,numberOfValues:new P({required:!0,min:1})})),Pr=f("facet/updateIsFieldExpanded",e=>h(e,{facetId:Q,isFieldExpanded:new V({required:!0})})),Wl=f("facet/updateFreezeCurrentValues",e=>h(e,{facetId:Q,freezeCurrentValues:new V({required:!0})}));var Pt=f("facetOptions/update",(e={freezeFacetOrder:!0})=>h(e,{freezeFacetOrder:new V({required:!1})})),Wc=f("facetOptions/facet/enable",e=>h(e,Q)),It=f("facetOptions/facet/disable",e=>h(e,Q));var gS=f("history/undo"),hS=f("history/redo"),pt=f("history/snapshot");T("history/back",async(e,{dispatch:t})=>{t(gS()),await t(ge());});T("history/forward",async(e,{dispatch:t})=>{t(hS()),await t(ge());});var ge=T("history/change",async(e,{getState:t})=>t().history.present);function wt(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]]);return r}function y(e,t,r,o){function n(a){return a instanceof r?a:new r(function(i){i(a);})}return new(r||(r=Promise))(function(a,i){function c(l){try{s(o.next(l));}catch(d){i(d);}}function u(l){try{s(o.throw(l));}catch(d){i(d);}}function s(l){l.done?a(l.value):n(l.value).then(c,u);}s((o=o.apply(e,t||[])).next());})}var W;(function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect";})(W||(W={}));function Kl(){return typeof window<"u"}function cs(){return typeof navigator<"u"}function Gr(){return typeof document<"u"}function Yc(){try{return typeof localStorage<"u"}catch{return !1}}function yS(){try{return typeof sessionStorage<"u"}catch{return !1}}function id(){return cs()&&navigator.cookieEnabled}var SS=[W.click,W.custom,W.search,W.view],CS=(e,t)=>SS.indexOf(e)!==-1?Object.assign({language:Gr()?document.documentElement.lang:"unknown",userAgent:cs()?navigator.userAgent:"unknown"},t):t,Jo=class e{static set(t,r,o){var n,a,i,c;o&&(a=new Date,a.setTime(a.getTime()+o)),c=window.location.hostname,c.indexOf(".")===-1?Yl(t,r,a):(i=c.split("."),n=i[i.length-2]+"."+i[i.length-1],Yl(t,r,a,n));}static get(t){for(var r=t+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){var a=o[n];if(a=a.replace(/^\s+/,""),a.lastIndexOf(r,0)===0)return a.substring(r.length,a.length)}return null}static erase(t){e.set(t,"",-1);}};function Yl(e,t,r,o){document.cookie=`${e}=${t}`+(r?`;expires=${r.toUTCString()}`:"")+(o?`;domain=${o}`:"")+";path=/;SameSite=Lax";}function xS(){return Yc()?localStorage:id()?new Xo:yS()?sessionStorage:new Xr}var Xo=class e{getItem(t){return Jo.get(`${e.prefix}${t}`)}removeItem(t){Jo.erase(`${e.prefix}${t}`);}setItem(t,r,o){Jo.set(`${e.prefix}${t}`,r,o);}};Xo.prefix="coveo_";var Gc=class{constructor(){this.cookieStorage=new Xo;}getItem(t){return localStorage.getItem(t)||this.cookieStorage.getItem(t)}removeItem(t){this.cookieStorage.removeItem(t),localStorage.removeItem(t);}setItem(t,r){localStorage.setItem(t,r),this.cookieStorage.setItem(t,r,31556926e3);}},Xr=class{getItem(t){return null}removeItem(t){}setItem(t,r){}},Yo="__coveo.analytics.history",cd=20,sd=1e3*60,ud=75,Zr=class{constructor(t){this.store=t||xS();}addElement(t){t.internalTime=new Date().getTime(),t=this.cropQueryElement(this.stripEmptyQuery(t));let r=this.getHistoryWithInternalTime();r!=null?this.isValidEntry(t)&&this.setHistory([t].concat(r)):this.setHistory([t]);}addElementAsync(t){return y(this,void 0,void 0,function*(){t.internalTime=new Date().getTime(),t=this.cropQueryElement(this.stripEmptyQuery(t));let r=yield this.getHistoryWithInternalTimeAsync();r!=null?this.isValidEntry(t)&&this.setHistory([t].concat(r)):this.setHistory([t]);})}getHistory(){let t=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(t))}getHistoryAsync(){return y(this,void 0,void 0,function*(){let t=yield this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(t))})}getHistoryWithInternalTime(){try{let t=this.store.getItem(Yo);return t&&typeof t=="string"?JSON.parse(t):[]}catch{return []}}getHistoryWithInternalTimeAsync(){return y(this,void 0,void 0,function*(){try{let t=yield this.store.getItem(Yo);return t?JSON.parse(t):[]}catch{return []}})}setHistory(t){try{this.store.setItem(Yo,JSON.stringify(t.slice(0,cd)));}catch{}}clear(){try{this.store.removeItem(Yo);}catch{}}getMostRecentElement(){let t=this.getHistoryWithInternalTime();return Array.isArray(t)?t.sort((o,n)=>(n.internalTime||0)-(o.internalTime||0))[0]:null}cropQueryElement(t){return t.name&&t.value&&t.name.toLowerCase()==="query"&&(t.value=t.value.slice(0,ud)),t}isValidEntry(t){let r=this.getMostRecentElement();return r&&r.value==t.value?(t.internalTime||0)-(r.internalTime||0)>sd:!0}stripInternalTime(t){return Array.isArray(t)?t.map(r=>{let{name:o,time:n,value:a}=r;return {name:o,time:n,value:a}}):[]}stripEmptyQuery(t){let{name:r,time:o,value:n}=t;return r&&typeof n=="string"&&r.toLowerCase()==="query"&&n.trim()===""?{name:r,time:o}:t}stripEmptyQueries(t){return t.map(r=>this.stripEmptyQuery(r))}},ld=Object.freeze({__proto__:null,HistoryStore:Zr,MAX_NUMBER_OF_HISTORY_ELEMENTS:cd,MAX_VALUE_SIZE:ud,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:sd,STORE_KEY:Yo,default:Zr}),RS=(e,t)=>y(void 0,void 0,void 0,function*(){return e===W.view?(yield vS(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t}),vS=e=>y(void 0,void 0,void 0,function*(){let t=new Zr,r={name:"PageView",value:e,time:new Date().toISOString()};yield t.addElementAsync(r);}),ua,FS=new Uint8Array(16);function AS(){if(!ua&&(ua=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ua))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ua(FS)}var bS=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function da(e){return typeof e=="string"&&bS.test(e)}var Ce=[];for(let e=0;e<256;++e)Ce.push((e+256).toString(16).slice(1));function dd(e,t=0){return (Ce[e[t+0]]+Ce[e[t+1]]+Ce[e[t+2]]+Ce[e[t+3]]+"-"+Ce[e[t+4]]+Ce[e[t+5]]+"-"+Ce[e[t+6]]+Ce[e[t+7]]+"-"+Ce[e[t+8]]+Ce[e[t+9]]+"-"+Ce[e[t+10]]+Ce[e[t+11]]+Ce[e[t+12]]+Ce[e[t+13]]+Ce[e[t+14]]+Ce[e[t+15]]).toLowerCase()}function PS(e){if(!da(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}function IS(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var wS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",ES="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function OS(e,t,r){function o(n,a,i,c){var u;if(typeof n=="string"&&(n=IS(n)),typeof a=="string"&&(a=PS(a)),((u=a)===null||u===void 0?void 0:u.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let s=new Uint8Array(16+n.length);if(s.set(a),s.set(n,a.length),s=r(s),s[6]=s[6]&15|t,s[8]=s[8]&63|128,i){c=c||0;for(let l=0;l<16;++l)i[c+l]=s[l];return i}return dd(s)}try{o.name=e;}catch{}return o.DNS=wS,o.URL=ES,o}var qS=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Gl={randomUUID:qS};function Ir(e,t,r){if(Gl.randomUUID&&!t&&!e)return Gl.randomUUID();e=e||{};let o=e.random||(e.rng||AS)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,t){r=r||0;for(let n=0;n<16;++n)t[r+n]=o[n];return t}return dd(o)}function TS(e,t,r,o){switch(e){case 0:return t&r^~t&o;case 1:return t^r^o;case 2:return t&r^t&o^r&o;case 3:return t^r^o}}function Kc(e,t){return e<<t|e>>>32-t}function kS(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){let i=unescape(encodeURIComponent(e));e=[];for(let c=0;c<i.length;++c)e.push(i.charCodeAt(c));}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let o=e.length/4+2,n=Math.ceil(o/16),a=new Array(n);for(let i=0;i<n;++i){let c=new Uint32Array(16);for(let u=0;u<16;++u)c[u]=e[i*64+u*4]<<24|e[i*64+u*4+1]<<16|e[i*64+u*4+2]<<8|e[i*64+u*4+3];a[i]=c;}a[n-1][14]=(e.length-1)*8/Math.pow(2,32),a[n-1][14]=Math.floor(a[n-1][14]),a[n-1][15]=(e.length-1)*8&4294967295;for(let i=0;i<n;++i){let c=new Uint32Array(80);for(let m=0;m<16;++m)c[m]=a[i][m];for(let m=16;m<80;++m)c[m]=Kc(c[m-3]^c[m-8]^c[m-14]^c[m-16],1);let u=r[0],s=r[1],l=r[2],d=r[3],p=r[4];for(let m=0;m<80;++m){let g=Math.floor(m/20),x=Kc(u,5)+TS(g,s,l,d)+p+t[g]+c[m]>>>0;p=d,d=l,l=Kc(s,30)>>>0,s=u,u=x;}r[0]=r[0]+u>>>0,r[1]=r[1]+s>>>0,r[2]=r[2]+l>>>0,r[3]=r[3]+d>>>0,r[4]=r[4]+p>>>0;}return [r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var DS=OS("v5",80,kS),Jl=DS,md="2.30.2",Go={pageview:"pageview",event:"event"},Yt=class e{constructor(t,r){if(!da(t))throw Error("Not a valid uuid");this.clientId=t,this.creationDate=Math.floor(r/1e3);}toString(){return this.clientId.replace(/-/g,"")+"."+this.creationDate.toString()}get expired(){let t=Math.floor(Date.now()/1e3)-this.creationDate;return t<0||t>e.expirationTime}validate(t,r){return !this.expired&&this.matchReferrer(t,r)}matchReferrer(t,r){try{let o=new URL(t);return r.some(n=>new RegExp(n.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(o.host))}catch{return !1}}static fromString(t){let r=t.split(".");if(r.length!==2)return null;let[o,n]=r;if(o.length!==32||isNaN(parseInt(n)))return null;let a=o.substring(0,8)+"-"+o.substring(8,12)+"-"+o.substring(12,16)+"-"+o.substring(16,20)+"-"+o.substring(20,32);return da(a)?new e(a,Number.parseInt(n)*1e3):null}};Yt.cvo_cid="cvo_cid";Yt.expirationTime=120;var ze=Object.keys;function la(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}var Zc={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},VS=ze(Zc).map(e=>Zc[e]),NS=[...VS].join("|"),MS=new RegExp(`^(${NS}$)`),LS={svcAction:"svc_action",svcActionData:"svc_action_data"},QS=e=>MS.test(e),BS=[QS],Zl={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},ed={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr",group:"group"},Fe={action:"pa",list:"pal",listSource:"pls"},pa={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},_S=["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit"],es={id:"quoteId",affiliation:"quoteAffiliation"},ts={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},jS={add:Fe,bookmark_add:Fe,bookmark_remove:Fe,click:Fe,checkout:Fe,checkout_option:Fe,detail:Fe,impression:Fe,remove:Fe,refund:Object.assign(Object.assign({},Fe),pa),purchase:Object.assign(Object.assign({},Fe),pa),quickview:Fe,quote:Object.assign(Object.assign({},Fe),es),review:Object.assign(Object.assign({},Fe),ts)},$S=ze(Zl).map(e=>Zl[e]),zS=ze(ed).map(e=>ed[e]),HS=ze(Fe).map(e=>Fe[e]),WS=ze(pa).map(e=>pa[e]),KS=ze(ts).map(e=>ts[e]),YS=ze(es).map(e=>es[e]),GS=[...$S,"custom"].join("|"),JS=[...zS,"custom"].join("|"),pd="(pr[0-9]+)",fd="(il[0-9]+pi[0-9]+)",XS=new RegExp(`^${pd}(${GS})$`),ZS=new RegExp(`^(${fd}(${JS}))|(il[0-9]+nm)$`),eC=new RegExp(`^(${HS.join("|")})$`),tC=new RegExp(`^(${WS.join("|")})$`),rC=new RegExp(`^${pd}custom$`),oC=new RegExp(`^${fd}custom$`),nC=new RegExp(`^(${[..._S,...KS,...YS].join("|")})$`),aC=e=>XS.test(e),iC=e=>ZS.test(e),cC=e=>eC.test(e),sC=e=>tC.test(e),uC=e=>nC.test(e),lC=[iC,aC,cC,sC,uC],dC=[rC,oC],mC={anonymizeIp:"aip"},pC={eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"},fC={hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"},gC=["contentId","contentIdKey","contentType","searchHub","tab","searchUid","permanentId","contentLocale","trackingId"],hC=Object.assign(Object.assign(Object.assign(Object.assign({},mC),pC),fC),gC.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:t}),{})),rs=Object.assign(Object.assign({},hC),LS),yC=e=>{let t=!!e.action&&jS[e.action]||{};return ze(e).reduce((r,o)=>{let n=t[o]||rs[o]||o;return Object.assign(Object.assign({},r),{[n]:e[o]})},{})},SC=ze(rs).map(e=>rs[e]),CC=e=>SC.indexOf(e)!==-1,xC=e=>e==="custom",RC=e=>[...lC,...BS,CC,xC].some(t=>t(e)),vC=e=>ze(e).reduce((t,r)=>{let o=FC(r);return o?Object.assign(Object.assign({},t),AC(o,e[r])):Object.assign(Object.assign({},t),{[r]:e[r]})},{}),FC=e=>{let t;return [...dC].every(r=>{var o;return t=(o=r.exec(e))===null||o===void 0?void 0:o[1],!t}),t},AC=(e,t)=>ze(t).reduce((r,o)=>Object.assign(Object.assign({},r),{[`${e}${o}`]:t[o]}),{}),os=class{constructor(t){this.opts=t;}sendEvent(t,r){return y(this,void 0,void 0,function*(){if(!this.isAvailable())throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');let{baseUrl:o,preprocessRequest:n}=this.opts,a=yield this.getQueryParamsForEventType(t),{url:i,payload:c}=yield this.preProcessRequestAsPotentialJSONString(`${o}/analytics/${t}?${a}`,r,n),u=this.encodeForEventType(t,c),s=new Blob([u],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(i,s);})}isAvailable(){return "sendBeacon"in navigator}deleteHttpCookieVisitorId(){return Promise.resolve()}preProcessRequestAsPotentialJSONString(t,r,o){return y(this,void 0,void 0,function*(){let n=t,a=r;if(o){let i=yield o({url:t,body:JSON.stringify(r)},"analyticsBeacon"),{url:c,body:u}=i;n=c||t;try{a=JSON.parse(u);}catch(s){console.error("Unable to process the request body as a JSON string",s);}}return {payload:a,url:n}})}encodeForEventType(t,r){return this.isEventTypeLegacy(t)?this.encodeEventToJson(t,r):this.encodeEventToJson(t,r,this.opts.token)}getQueryParamsForEventType(t){return y(this,void 0,void 0,function*(){let{token:r,visitorIdProvider:o}=this.opts,n=yield o.getCurrentVisitorId();return [r&&this.isEventTypeLegacy(t)?`access_token=${r}`:"",n?`visitorId=${n}`:"","discardVisitInfo=true"].filter(a=>!!a).join("&")})}isEventTypeLegacy(t){return [W.click,W.custom,W.search,W.view].indexOf(t)!==-1}encodeEventToJson(t,r,o){let n=`${t}Event=${encodeURIComponent(JSON.stringify(r))}`;return o&&(n=`access_token=${encodeURIComponent(o)}&${n}`),n}},ns=class{sendEvent(t,r){return y(this,void 0,void 0,function*(){return Promise.resolve()})}deleteHttpCookieVisitorId(){return y(this,void 0,void 0,function*(){return Promise.resolve()})}},td=window.fetch,fa=class{constructor(t){this.opts=t;}sendEvent(t,r){return y(this,void 0,void 0,function*(){let{baseUrl:o,visitorIdProvider:n,preprocessRequest:a}=this.opts,i=this.shouldAppendVisitorId(t)?yield this.getVisitorIdParam():"",c={url:`${o}/analytics/${t}${i}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(r)},u=Object.assign(Object.assign({},c),a?yield a(c,"analyticsFetch"):{}),{url:s}=u,l=wt(u,["url"]),d;try{d=yield td(s,l);}catch(p){console.error("An error has occured when sending the event.",p);return}if(d.ok){let p=yield d.json();return p.visitorId&&n.setCurrentVisitorId(p.visitorId),p}else {try{d.json();}catch{}throw console.error(`An error has occured when sending the "${t}" event.`,d,r),new Error(`An error has occurred when sending the "${t}" event. Check the console logs for more details.`)}})}deleteHttpCookieVisitorId(){return y(this,void 0,void 0,function*(){let{baseUrl:t}=this.opts,r=`${t}/analytics/visit`;yield td(r,{headers:this.getHeaders(),method:"DELETE"});})}shouldAppendVisitorId(t){return [W.click,W.custom,W.search,W.view].indexOf(t)!==-1}getVisitorIdParam(){return y(this,void 0,void 0,function*(){let{visitorIdProvider:t}=this.opts,r=yield t.getCurrentVisitorId();return r?`?visitor=${r}`:""})}getHeaders(){let{token:t}=this.opts;return Object.assign(Object.assign({},t?{Authorization:`Bearer ${t}`}:{}),{"Content-Type":"application/json"})}},as=class{constructor(t,r){Yc()&&id()?this.storage=new Gc:Yc()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new Xr),this.client=new fa(t),this.beaconClient=new os(t),window.addEventListener("beforeunload",()=>{let o=r();for(let{eventType:n,payload:a}of o)this.beaconClient.sendEvent(n,a);});}getClientDependingOnEventType(t){return t==="click"&&this.beaconClient.isAvailable()?this.beaconClient:this.client}},is=class{constructor(t,r){this.storage=r||new Xr,this.client=new fa(t);}getClientDependingOnEventType(t){return this.client}},ga=class{constructor(){this.storage=new Xr,this.client=new ns;}getClientDependingOnEventType(t){return this.client}},bC="xx",PC=e=>e?.startsWith(bC)||!1,IC=`
        We've detected you're using React Native but have not provided the corresponding runtime, 
        for an optimal experience please use the "coveo.analytics/react-native" subpackage.
        Follow the Readme on how to set it up: https://github.com/coveo/coveo.analytics.js#using-react-native
    `;function wC(){return typeof navigator<"u"&&navigator.product=="ReactNative"}var EC=["1",1,"yes",!0];function ha(){return cs()&&[navigator.globalPrivacyControl,navigator.doNotTrack,navigator.msDoNotTrack,window.doNotTrack].some(e=>EC.indexOf(e)!==-1)}var gd="v15",hd={default:"https://analytics.cloud.coveo.com/rest/ua",production:"https://analytics.cloud.coveo.com/rest/ua",hipaa:"https://analyticshipaa.cloud.coveo.com/rest/ua"};function OC(e=hd.default,t=gd,r=!1){if(e=e.replace(/\/$/,""),r)return `${e}/${t}`;let o=e.endsWith("/rest")||e.endsWith("/rest/ua");return `${e}${o?"":"/rest"}/${t}`}var qC="38824e1f-37f5-42d3-8372-a4b8fa9df946",Ot=class{get defaultOptions(){return {endpoint:hd.default,isCustomEndpoint:!1,token:"",version:gd,beforeSendHooks:[],afterSendHooks:[]}}get version(){return md}constructor(t){if(this.acceptedLinkReferrers=[],!t)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),t),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[RS,CS].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};let r={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};ha()?this.runtime=new ga:this.runtime=this.options.runtimeEnvironment||this.initRuntime(r),this.addEventTypeMapping(W.view,{newEventType:W.view,addClientIdParameter:!0}),this.addEventTypeMapping(W.click,{newEventType:W.click,addClientIdParameter:!0}),this.addEventTypeMapping(W.custom,{newEventType:W.custom,addClientIdParameter:!0}),this.addEventTypeMapping(W.search,{newEventType:W.search,addClientIdParameter:!0});}initRuntime(t){return Kl()&&Gr()?new as(t,()=>{let r=[...this.bufferedRequests];return this.bufferedRequests=[],r}):(wC()&&console.warn(IC),new is(t))}get storage(){return this.runtime.storage}determineVisitorId(){return y(this,void 0,void 0,function*(){try{return Kl()&&this.extractClientIdFromLink(window.location.href)||(yield this.storage.getItem("visitorId"))||Ir()}catch(t){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",t),Ir()}})}getCurrentVisitorId(){return y(this,void 0,void 0,function*(){if(!this.visitorId){let t=yield this.determineVisitorId();yield this.setCurrentVisitorId(t);}return this.visitorId})}setCurrentVisitorId(t){return y(this,void 0,void 0,function*(){this.visitorId=t,yield this.storage.setItem("visitorId",t);})}setClientId(t,r){return y(this,void 0,void 0,function*(){if(da(t))this.setCurrentVisitorId(t.toLowerCase());else {if(!r)throw Error("Cannot generate uuid client id without a specific namespace string.");this.setCurrentVisitorId(Jl(t,Jl(r,qC)));}})}getParameters(t,...r){return y(this,void 0,void 0,function*(){return yield this.resolveParameters(t,...r)})}getPayload(t,...r){return y(this,void 0,void 0,function*(){let o=yield this.resolveParameters(t,...r);return yield this.resolvePayloadForParameters(t,o)})}get currentVisitorId(){return typeof(this.visitorId||this.storage.getItem("visitorId"))!="string"&&this.setCurrentVisitorId(Ir()),this.visitorId}set currentVisitorId(t){this.visitorId=t,this.storage.setItem("visitorId",t);}extractClientIdFromLink(t){if(ha())return null;try{let r=new URL(t).searchParams.get(Yt.cvo_cid);if(r==null)return null;let o=Yt.fromString(r);return !o||!Gr()||!o.validate(document.referrer,this.acceptedLinkReferrers)?null:o.clientId}catch{}return null}resolveParameters(t,...r){return y(this,void 0,void 0,function*(){let{variableLengthArgumentsNames:o=[],addVisitorIdParameter:n=!1,usesMeasurementProtocol:a=!1,addClientIdParameter:i=!1}=this.eventTypeMapping[t]||{};return yield [m=>o.length>0?this.parseVariableArgumentsPayload(o,m):m[0],m=>y(this,void 0,void 0,function*(){return Object.assign(Object.assign({},m),{visitorId:n?yield this.getCurrentVisitorId():""})}),m=>y(this,void 0,void 0,function*(){return i?Object.assign(Object.assign({},m),{clientId:yield this.getCurrentVisitorId()}):m}),m=>a?this.ensureAnonymousUserWhenUsingApiKey(m):m,m=>this.beforeSendHooks.reduce((g,x)=>y(this,void 0,void 0,function*(){let v=yield g;return yield x(t,v)}),m)].reduce((m,g)=>y(this,void 0,void 0,function*(){let x=yield m;return yield g(x)}),Promise.resolve(r))})}resolvePayloadForParameters(t,r){return y(this,void 0,void 0,function*(){let{usesMeasurementProtocol:o=!1}=this.eventTypeMapping[t]||{};return yield [d=>this.setTrackingIdIfTrackingIdNotPresent(d),d=>this.removeEmptyPayloadValues(d,t),d=>this.validateParams(d,t),d=>o?yC(d):d,d=>o?this.removeUnknownParameters(d):d,d=>o?this.processCustomParameters(d):this.mapCustomParametersToCustomData(d)].reduce((d,p)=>y(this,void 0,void 0,function*(){let m=yield d;return yield p(m)}),Promise.resolve(r))})}makeEvent(t,...r){return y(this,void 0,void 0,function*(){let{newEventType:o=t}=this.eventTypeMapping[t]||{},n=yield this.resolveParameters(t,...r),a=yield this.resolvePayloadForParameters(t,n);return {eventType:o,payload:a,log:i=>y(this,void 0,void 0,function*(){return this.bufferedRequests.push({eventType:o,payload:Object.assign(Object.assign({},a),i)}),yield Promise.all(this.afterSendHooks.map(c=>c(t,Object.assign(Object.assign({},n),i)))),yield this.deferExecution(),yield this.sendFromBuffer()})}})}sendEvent(t,...r){return y(this,void 0,void 0,function*(){return (yield this.makeEvent(t,...r)).log({})})}deferExecution(){return new Promise(t=>setTimeout(t,0))}sendFromBuffer(){return y(this,void 0,void 0,function*(){let t=this.bufferedRequests.shift();if(t){let{eventType:r,payload:o}=t;return this.runtime.getClientDependingOnEventType(r).sendEvent(r,o)}})}clear(){this.storage.removeItem("visitorId"),new Zr().clear();}deleteHttpOnlyVisitorId(){this.runtime.client.deleteHttpCookieVisitorId();}makeSearchEvent(t){return y(this,void 0,void 0,function*(){return this.makeEvent(W.search,t)})}sendSearchEvent(t){var{searchQueryUid:r}=t,o=wt(t,["searchQueryUid"]);return y(this,void 0,void 0,function*(){return (yield this.makeSearchEvent(o)).log({searchQueryUid:r})})}makeClickEvent(t){return y(this,void 0,void 0,function*(){return this.makeEvent(W.click,t)})}sendClickEvent(t){var{searchQueryUid:r}=t,o=wt(t,["searchQueryUid"]);return y(this,void 0,void 0,function*(){return (yield this.makeClickEvent(o)).log({searchQueryUid:r})})}makeCustomEvent(t){return y(this,void 0,void 0,function*(){return this.makeEvent(W.custom,t)})}sendCustomEvent(t){var{lastSearchQueryUid:r}=t,o=wt(t,["lastSearchQueryUid"]);return y(this,void 0,void 0,function*(){return (yield this.makeCustomEvent(o)).log({lastSearchQueryUid:r})})}makeViewEvent(t){return y(this,void 0,void 0,function*(){return this.makeEvent(W.view,t)})}sendViewEvent(t){return y(this,void 0,void 0,function*(){return (yield this.makeViewEvent(t)).log({})})}getVisit(){return y(this,void 0,void 0,function*(){let r=yield (yield fetch(`${this.baseUrl}/analytics/visit`)).json();return this.visitorId=r.visitorId,r})}getHealth(){return y(this,void 0,void 0,function*(){return yield (yield fetch(`${this.baseUrl}/analytics/monitoring/health`)).json()})}registerBeforeSendEventHook(t){this.beforeSendHooks.push(t);}registerAfterSendEventHook(t){this.afterSendHooks.push(t);}addEventTypeMapping(t,r){this.eventTypeMapping[t]=r;}setAcceptedLinkReferrers(t){if(Array.isArray(t)&&t.every(r=>typeof r=="string"))this.acceptedLinkReferrers=t;else throw Error("Parameter should be an array of domain strings")}parseVariableArgumentsPayload(t,r){let o={};for(let n=0,a=r.length;n<a;n++){let i=r[n];if(typeof i=="string")o[t[n]]=i;else if(typeof i=="object")return Object.assign(Object.assign({},o),i)}return o}isKeyAllowedEmpty(t,r){return ({[W.search]:["queryText"]}[t]||[]).indexOf(r)!==-1}removeEmptyPayloadValues(t,r){let o=n=>typeof n<"u"&&n!==null&&n!=="";return Object.keys(t).filter(n=>this.isKeyAllowedEmpty(r,n)||o(t[n])).reduce((n,a)=>Object.assign(Object.assign({},n),{[a]:t[a]}),{})}removeUnknownParameters(t){return Object.keys(t).filter(o=>{if(RC(o))return !0;console.log(o,"is not processed by coveoua");}).reduce((o,n)=>Object.assign(Object.assign({},o),{[n]:t[n]}),{})}processCustomParameters(t){let{custom:r}=t,o=wt(t,["custom"]),n={};r&&la(r)&&(n=this.lowercaseKeys(r));let a=vC(o);return Object.assign(Object.assign({},n),a)}mapCustomParametersToCustomData(t){let{custom:r}=t,o=wt(t,["custom"]);if(r&&la(r)){let n=this.lowercaseKeys(r);return Object.assign(Object.assign({},o),{customData:Object.assign(Object.assign({},n),t.customData)})}else return t}lowercaseKeys(t){let r=Object.keys(t),o={};return r.forEach(n=>{o[n.toLowerCase()]=t[n];}),o}validateParams(t,r){let{anonymizeIp:o}=t,n=wt(t,["anonymizeIp"]);return o!==void 0&&["0","false","undefined","null","{}","[]",""].indexOf(`${o}`.toLowerCase())==-1&&(n.anonymizeIp=1),(r==W.view||r==W.click||r==W.search||r==W.custom)&&(n.originLevel3=this.limit(n.originLevel3,128)),r==W.view&&(n.location=this.limit(n.location,128)),(r=="pageview"||r=="event")&&(n.referrer=this.limit(n.referrer,2048),n.location=this.limit(n.location,2048),n.page=this.limit(n.page,2048)),n}ensureAnonymousUserWhenUsingApiKey(t){let{userId:r}=t,o=wt(t,["userId"]);return PC(this.options.token)&&!r?(o.userId="anonymous",o):t}setTrackingIdIfTrackingIdNotPresent(t){let{trackingId:r}=t,o=wt(t,["trackingId"]);return r?t:(o.hasOwnProperty("custom")&&la(o.custom)&&(o.custom.hasOwnProperty("context_website")||o.custom.hasOwnProperty("siteName"))&&(o.trackingId=o.custom.context_website||o.custom.siteName),o.hasOwnProperty("customData")&&la(o.customData)&&(o.customData.hasOwnProperty("context_website")||o.customData.hasOwnProperty("siteName"))&&(o.trackingId=o.customData.context_website||o.customData.siteName),o)}limit(t,r){return typeof t!="string"?t:t.substring(0,r)}get baseUrl(){return OC(this.options.endpoint,this.options.version,this.options.isCustomEndpoint)}},Et;(function(e){e.contextChanged="contextChanged",e.expandToFullUI="expandToFullUI",e.openUserActions="openUserActions",e.showPrecedingSessions="showPrecedingSessions",e.showFollowingSessions="showFollowingSessions",e.clickViewedDocument="clickViewedDocument",e.clickPageView="clickPageView",e.createArticle="createArticle";})(Et||(Et={}));var S;(function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.undoTriggerQuery="undoQuery",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.staticFilterClearAll="staticFilterClearAll",e.staticFilterSelect="staticFilterSelect",e.staticFilterDeselect="staticFilterDeselect",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",e.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",e.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",e.openSmartSnippetSource="openSmartSnippetSource",e.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",e.openSmartSnippetInlineLink="openSmartSnippetInlineLink",e.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",e.recentQueryClick="recentQueriesClick",e.clearRecentQueries="clearRecentQueries",e.recentResultClick="recentResultClick",e.clearRecentResults="clearRecentResults",e.noResultsBack="noResultsBack",e.showMoreFoldedResults="showMoreFoldedResults",e.showLessFoldedResults="showLessFoldedResults",e.copyToClipboard="copyToClipboard",e.caseSendEmail="Case.SendEmail",e.feedItemTextPost="FeedItem.TextPost",e.caseAttach="caseAttach",e.caseDetach="caseDetach",e.retryGeneratedAnswer="retryGeneratedAnswer",e.likeGeneratedAnswer="likeGeneratedAnswer",e.dislikeGeneratedAnswer="dislikeGeneratedAnswer",e.openGeneratedAnswerSource="openGeneratedAnswerSource",e.generatedAnswerStreamEnd="generatedAnswerStreamEnd",e.generatedAnswerSourceHover="generatedAnswerSourceHover",e.generatedAnswerCopyToClipboard="generatedAnswerCopyToClipboard",e.generatedAnswerHideAnswers="generatedAnswerHideAnswers",e.generatedAnswerShowAnswers="generatedAnswerShowAnswers",e.generatedAnswerExpand="generatedAnswerExpand",e.generatedAnswerCollapse="generatedAnswerCollapse",e.generatedAnswerFeedbackSubmit="generatedAnswerFeedbackSubmit",e.rephraseGeneratedAnswer="rephraseGeneratedAnswer";})(S||(S={}));var rd={[S.triggerNotify]:"queryPipelineTriggers",[S.triggerExecute]:"queryPipelineTriggers",[S.triggerQuery]:"queryPipelineTriggers",[S.triggerRedirect]:"queryPipelineTriggers",[S.queryError]:"errors",[S.queryErrorBack]:"errors",[S.queryErrorClear]:"errors",[S.queryErrorRetry]:"errors",[S.pagerNext]:"getMoreResults",[S.pagerPrevious]:"getMoreResults",[S.pagerNumber]:"getMoreResults",[S.pagerResize]:"getMoreResults",[S.pagerScrolling]:"getMoreResults",[S.facetSearch]:"facet",[S.facetShowLess]:"facet",[S.facetShowMore]:"facet",[S.recommendation]:"recommendation",[S.likeSmartSnippet]:"smartSnippet",[S.dislikeSmartSnippet]:"smartSnippet",[S.expandSmartSnippet]:"smartSnippet",[S.collapseSmartSnippet]:"smartSnippet",[S.openSmartSnippetFeedbackModal]:"smartSnippet",[S.closeSmartSnippetFeedbackModal]:"smartSnippet",[S.sendSmartSnippetReason]:"smartSnippet",[S.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[S.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions",[S.showMoreSmartSnippetSuggestion]:"smartSnippetSuggestions",[S.showLessSmartSnippetSuggestion]:"smartSnippetSuggestions",[S.clearRecentQueries]:"recentQueries",[S.recentResultClick]:"recentlyClickedDocuments",[S.clearRecentResults]:"recentlyClickedDocuments",[S.showLessFoldedResults]:"folding",[S.caseDetach]:"case",[S.likeGeneratedAnswer]:"generatedAnswer",[S.dislikeGeneratedAnswer]:"generatedAnswer",[S.openGeneratedAnswerSource]:"generatedAnswer",[S.generatedAnswerStreamEnd]:"generatedAnswer",[S.generatedAnswerSourceHover]:"generatedAnswer",[S.generatedAnswerCopyToClipboard]:"generatedAnswer",[S.generatedAnswerHideAnswers]:"generatedAnswer",[S.generatedAnswerShowAnswers]:"generatedAnswer",[S.generatedAnswerExpand]:"generatedAnswer",[S.generatedAnswerCollapse]:"generatedAnswer",[S.generatedAnswerFeedbackSubmit]:"generatedAnswer",[Et.expandToFullUI]:"interface",[Et.openUserActions]:"User Actions",[Et.showPrecedingSessions]:"User Actions",[Et.showFollowingSessions]:"User Actions",[Et.clickViewedDocument]:"User Actions",[Et.clickPageView]:"User Actions",[Et.createArticle]:"createArticle"},eo=class{constructor(){this.runtime=new ga,this.currentVisitorId="";}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}makeEvent(t){return Promise.resolve({eventType:t,payload:null,log:()=>Promise.resolve()})}sendEvent(){return Promise.resolve()}makeSearchEvent(){return this.makeEvent(W.search)}sendSearchEvent(){return Promise.resolve()}makeClickEvent(){return this.makeEvent(W.click)}sendClickEvent(){return Promise.resolve()}makeCustomEvent(){return this.makeEvent(W.custom)}sendCustomEvent(){return Promise.resolve()}makeViewEvent(){return this.makeEvent(W.view)}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}get version(){return md}};function TC(e){let t="";return e.filter(r=>{let o=r!==t;return t=r,o})}function kC(e){return e.map(t=>t.replace(/;/g,""))}function yd(e){let r=e.join(";");return r.length<=256?r:yd(e.slice(1))}var od=e=>{let t=kC(e),r=TC(t);return yd(r)};function nd(e){let t=typeof e.partialQueries=="string"?e.partialQueries:od(e.partialQueries),r=typeof e.suggestions=="string"?e.suggestions:od(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}var Gt=class{constructor(t,r){this.opts=t,this.provider=r;let o=t.enableAnalytics===!1||ha();this.coveoAnalyticsClient=o?new eo:new Ot(t);}disable(){this.coveoAnalyticsClient=new eo;}enable(){this.coveoAnalyticsClient=new Ot(this.opts);}makeInterfaceLoad(){return this.makeSearchEvent(S.interfaceLoad)}logInterfaceLoad(){return y(this,void 0,void 0,function*(){return (yield this.makeInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationInterfaceLoad(){return this.makeSearchEvent(S.recommendationInterfaceLoad)}logRecommendationInterfaceLoad(){return y(this,void 0,void 0,function*(){return (yield this.makeRecommendationInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendation(){return this.makeCustomEvent(S.recommendation)}logRecommendation(){return y(this,void 0,void 0,function*(){return (yield this.makeRecommendation()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationOpen(t,r){return this.makeClickEvent(S.recommendationOpen,t,r)}logRecommendationOpen(t,r){return y(this,void 0,void 0,function*(){return (yield this.makeRecommendationOpen(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterClearAll(t){return this.makeSearchEvent(S.staticFilterClearAll,t)}logStaticFilterClearAll(t){return y(this,void 0,void 0,function*(){return (yield this.makeStaticFilterClearAll(t)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterSelect(t){return this.makeSearchEvent(S.staticFilterSelect,t)}logStaticFilterSelect(t){return y(this,void 0,void 0,function*(){return (yield this.makeStaticFilterSelect(t)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterDeselect(t){return this.makeSearchEvent(S.staticFilterDeselect,t)}logStaticFilterDeselect(t){return y(this,void 0,void 0,function*(){return (yield this.makeStaticFilterDeselect(t)).log({searchUID:this.provider.getSearchUID()})})}makeFetchMoreResults(){return this.makeCustomEvent(S.pagerScrolling,{type:"getMoreResults"})}logFetchMoreResults(){return y(this,void 0,void 0,function*(){return (yield this.makeFetchMoreResults()).log({searchUID:this.provider.getSearchUID()})})}makeInterfaceChange(t){return this.makeSearchEvent(S.interfaceChange,t)}logInterfaceChange(t){return y(this,void 0,void 0,function*(){return (yield this.makeInterfaceChange(t)).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanAutomatic(){return this.makeSearchEvent(S.didyoumeanAutomatic)}logDidYouMeanAutomatic(){return y(this,void 0,void 0,function*(){return (yield this.makeDidYouMeanAutomatic()).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanClick(){return this.makeSearchEvent(S.didyoumeanClick)}logDidYouMeanClick(){return y(this,void 0,void 0,function*(){return (yield this.makeDidYouMeanClick()).log({searchUID:this.provider.getSearchUID()})})}makeResultsSort(t){return this.makeSearchEvent(S.resultsSort,t)}logResultsSort(t){return y(this,void 0,void 0,function*(){return (yield this.makeResultsSort(t)).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxSubmit(){return this.makeSearchEvent(S.searchboxSubmit)}logSearchboxSubmit(){return y(this,void 0,void 0,function*(){return (yield this.makeSearchboxSubmit()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxClear(){return this.makeSearchEvent(S.searchboxClear)}logSearchboxClear(){return y(this,void 0,void 0,function*(){return (yield this.makeSearchboxClear()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxAsYouType(){return this.makeSearchEvent(S.searchboxAsYouType)}logSearchboxAsYouType(){return y(this,void 0,void 0,function*(){return (yield this.makeSearchboxAsYouType()).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbFacet(t){return this.makeSearchEvent(S.breadcrumbFacet,t)}logBreadcrumbFacet(t){return y(this,void 0,void 0,function*(){return (yield this.makeBreadcrumbFacet(t)).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbResetAll(){return this.makeSearchEvent(S.breadcrumbResetAll)}logBreadcrumbResetAll(){return y(this,void 0,void 0,function*(){return (yield this.makeBreadcrumbResetAll()).log({searchUID:this.provider.getSearchUID()})})}makeDocumentQuickview(t,r){return this.makeClickEvent(S.documentQuickview,t,r)}logDocumentQuickview(t,r){return y(this,void 0,void 0,function*(){return (yield this.makeDocumentQuickview(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeDocumentOpen(t,r){return this.makeClickEvent(S.documentOpen,t,r)}logDocumentOpen(t,r){return y(this,void 0,void 0,function*(){return (yield this.makeDocumentOpen(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxAnalytics(t){return this.makeSearchEvent(S.omniboxAnalytics,nd(t))}logOmniboxAnalytics(t){return y(this,void 0,void 0,function*(){return (yield this.makeOmniboxAnalytics(t)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxFromLink(t){return this.makeSearchEvent(S.omniboxFromLink,nd(t))}logOmniboxFromLink(t){return y(this,void 0,void 0,function*(){return (yield this.makeOmniboxFromLink(t)).log({searchUID:this.provider.getSearchUID()})})}makeSearchFromLink(){return this.makeSearchEvent(S.searchFromLink)}logSearchFromLink(){return y(this,void 0,void 0,function*(){return (yield this.makeSearchFromLink()).log({searchUID:this.provider.getSearchUID()})})}makeTriggerNotify(t){return this.makeCustomEvent(S.triggerNotify,t)}logTriggerNotify(t){return y(this,void 0,void 0,function*(){return (yield this.makeTriggerNotify(t)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerExecute(t){return this.makeCustomEvent(S.triggerExecute,t)}logTriggerExecute(t){return y(this,void 0,void 0,function*(){return (yield this.makeTriggerExecute(t)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerQuery(){return this.makeCustomEvent(S.triggerQuery,{query:this.provider.getSearchEventRequestPayload().queryText},"queryPipelineTriggers")}logTriggerQuery(){return y(this,void 0,void 0,function*(){return (yield this.makeTriggerQuery()).log({searchUID:this.provider.getSearchUID()})})}makeUndoTriggerQuery(t){return this.makeSearchEvent(S.undoTriggerQuery,t)}logUndoTriggerQuery(t){return y(this,void 0,void 0,function*(){return (yield this.makeUndoTriggerQuery(t)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerRedirect(t){return this.makeCustomEvent(S.triggerRedirect,Object.assign(Object.assign({},t),{query:this.provider.getSearchEventRequestPayload().queryText}))}logTriggerRedirect(t){return y(this,void 0,void 0,function*(){return (yield this.makeTriggerRedirect(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerResize(t){return this.makeCustomEvent(S.pagerResize,t)}logPagerResize(t){return y(this,void 0,void 0,function*(){return (yield this.makePagerResize(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerNumber(t){return this.makeCustomEvent(S.pagerNumber,t)}logPagerNumber(t){return y(this,void 0,void 0,function*(){return (yield this.makePagerNumber(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerNext(t){return this.makeCustomEvent(S.pagerNext,t)}logPagerNext(t){return y(this,void 0,void 0,function*(){return (yield this.makePagerNext(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerPrevious(t){return this.makeCustomEvent(S.pagerPrevious,t)}logPagerPrevious(t){return y(this,void 0,void 0,function*(){return (yield this.makePagerPrevious(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerScrolling(){return this.makeCustomEvent(S.pagerScrolling)}logPagerScrolling(){return y(this,void 0,void 0,function*(){return (yield this.makePagerScrolling()).log({searchUID:this.provider.getSearchUID()})})}makeFacetClearAll(t){return this.makeSearchEvent(S.facetClearAll,t)}logFacetClearAll(t){return y(this,void 0,void 0,function*(){return (yield this.makeFacetClearAll(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSearch(t){return this.makeSearchEvent(S.facetSearch,t)}logFacetSearch(t){return y(this,void 0,void 0,function*(){return (yield this.makeFacetSearch(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelect(t){return this.makeSearchEvent(S.facetSelect,t)}logFacetSelect(t){return y(this,void 0,void 0,function*(){return (yield this.makeFacetSelect(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetDeselect(t){return this.makeSearchEvent(S.facetDeselect,t)}logFacetDeselect(t){return y(this,void 0,void 0,function*(){return (yield this.makeFacetDeselect(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetExclude(t){return this.makeSearchEvent(S.facetExclude,t)}logFacetExclude(t){return y(this,void 0,void 0,function*(){return (yield this.makeFacetExclude(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUnexclude(t){return this.makeSearchEvent(S.facetUnexclude,t)}logFacetUnexclude(t){return y(this,void 0,void 0,function*(){return (yield this.makeFacetUnexclude(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelectAll(t){return this.makeSearchEvent(S.facetSelectAll,t)}logFacetSelectAll(t){return y(this,void 0,void 0,function*(){return (yield this.makeFacetSelectAll(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUpdateSort(t){return this.makeSearchEvent(S.facetUpdateSort,t)}logFacetUpdateSort(t){return y(this,void 0,void 0,function*(){return (yield this.makeFacetUpdateSort(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowMore(t){return this.makeCustomEvent(S.facetShowMore,t)}logFacetShowMore(t){return y(this,void 0,void 0,function*(){return (yield this.makeFacetShowMore(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowLess(t){return this.makeCustomEvent(S.facetShowLess,t)}logFacetShowLess(t){return y(this,void 0,void 0,function*(){return (yield this.makeFacetShowLess(t)).log({searchUID:this.provider.getSearchUID()})})}makeQueryError(t){return this.makeCustomEvent(S.queryError,t)}logQueryError(t){return y(this,void 0,void 0,function*(){return (yield this.makeQueryError(t)).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorBack(){return y(this,void 0,void 0,function*(){let t=yield this.makeCustomEvent(S.queryErrorBack);return {description:t.description,log:()=>y(this,void 0,void 0,function*(){return yield t.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(S.queryErrorBack)})}})}logQueryErrorBack(){return y(this,void 0,void 0,function*(){return (yield this.makeQueryErrorBack()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorRetry(){return y(this,void 0,void 0,function*(){let t=yield this.makeCustomEvent(S.queryErrorRetry);return {description:t.description,log:()=>y(this,void 0,void 0,function*(){return yield t.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(S.queryErrorRetry)})}})}logQueryErrorRetry(){return y(this,void 0,void 0,function*(){return (yield this.makeQueryErrorRetry()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorClear(){return y(this,void 0,void 0,function*(){let t=yield this.makeCustomEvent(S.queryErrorClear);return {description:t.description,log:()=>y(this,void 0,void 0,function*(){return yield t.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(S.queryErrorClear)})}})}logQueryErrorClear(){return y(this,void 0,void 0,function*(){return (yield this.makeQueryErrorClear()).log({searchUID:this.provider.getSearchUID()})})}makeLikeSmartSnippet(){return this.makeCustomEvent(S.likeSmartSnippet)}logLikeSmartSnippet(){return y(this,void 0,void 0,function*(){return (yield this.makeLikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeDislikeSmartSnippet(){return this.makeCustomEvent(S.dislikeSmartSnippet)}logDislikeSmartSnippet(){return y(this,void 0,void 0,function*(){return (yield this.makeDislikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippet(){return this.makeCustomEvent(S.expandSmartSnippet)}logExpandSmartSnippet(){return y(this,void 0,void 0,function*(){return (yield this.makeExpandSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippet(){return this.makeCustomEvent(S.collapseSmartSnippet)}logCollapseSmartSnippet(){return y(this,void 0,void 0,function*(){return (yield this.makeCollapseSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetFeedbackModal(){return this.makeCustomEvent(S.openSmartSnippetFeedbackModal)}logOpenSmartSnippetFeedbackModal(){return y(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeCloseSmartSnippetFeedbackModal(){return this.makeCustomEvent(S.closeSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return y(this,void 0,void 0,function*(){return (yield this.makeCloseSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeSmartSnippetFeedbackReason(t,r){return this.makeCustomEvent(S.sendSmartSnippetReason,{reason:t,details:r})}logSmartSnippetFeedbackReason(t,r){return y(this,void 0,void 0,function*(){return (yield this.makeSmartSnippetFeedbackReason(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippetSuggestion(t){return this.makeCustomEvent(S.expandSmartSnippetSuggestion,"documentId"in t?t:{documentId:t})}logExpandSmartSnippetSuggestion(t){return y(this,void 0,void 0,function*(){return (yield this.makeExpandSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippetSuggestion(t){return this.makeCustomEvent(S.collapseSmartSnippetSuggestion,"documentId"in t?t:{documentId:t})}logCollapseSmartSnippetSuggestion(t){return y(this,void 0,void 0,function*(){return (yield this.makeCollapseSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreSmartSnippetSuggestion(t){return this.makeCustomEvent(S.showMoreSmartSnippetSuggestion,t)}logShowMoreSmartSnippetSuggestion(t){return y(this,void 0,void 0,function*(){return (yield this.makeShowMoreSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessSmartSnippetSuggestion(t){return this.makeCustomEvent(S.showLessSmartSnippetSuggestion,t)}logShowLessSmartSnippetSuggestion(t){return y(this,void 0,void 0,function*(){return (yield this.makeShowLessSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSource(t,r){return this.makeClickEvent(S.openSmartSnippetSource,t,r)}logOpenSmartSnippetSource(t,r){return y(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetSource(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionSource(t,r){return this.makeClickEvent(S.openSmartSnippetSuggestionSource,t,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},r)}makeCopyToClipboard(t,r){return this.makeClickEvent(S.copyToClipboard,t,r)}logCopyToClipboard(t,r){return y(this,void 0,void 0,function*(){return (yield this.makeCopyToClipboard(t,r)).log({searchUID:this.provider.getSearchUID()})})}logOpenSmartSnippetSuggestionSource(t,r){return y(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetSuggestionSource(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetInlineLink(t,r){return this.makeClickEvent(S.openSmartSnippetInlineLink,t,{contentIDKey:r.contentIDKey,contentIDValue:r.contentIDValue},r)}logOpenSmartSnippetInlineLink(t,r){return y(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetInlineLink(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionInlineLink(t,r){return this.makeClickEvent(S.openSmartSnippetSuggestionInlineLink,t,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},r)}logOpenSmartSnippetSuggestionInlineLink(t,r){return y(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetSuggestionInlineLink(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeRecentQueryClick(){return this.makeSearchEvent(S.recentQueryClick)}logRecentQueryClick(){return y(this,void 0,void 0,function*(){return (yield this.makeRecentQueryClick()).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentQueries(){return this.makeCustomEvent(S.clearRecentQueries)}logClearRecentQueries(){return y(this,void 0,void 0,function*(){return (yield this.makeClearRecentQueries()).log({searchUID:this.provider.getSearchUID()})})}makeRecentResultClick(t,r){return this.makeCustomEvent(S.recentResultClick,{info:t,identifier:r})}logRecentResultClick(t,r){return y(this,void 0,void 0,function*(){return (yield this.makeRecentResultClick(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentResults(){return this.makeCustomEvent(S.clearRecentResults)}logClearRecentResults(){return y(this,void 0,void 0,function*(){return (yield this.makeClearRecentResults()).log({searchUID:this.provider.getSearchUID()})})}makeNoResultsBack(){return this.makeSearchEvent(S.noResultsBack)}logNoResultsBack(){return y(this,void 0,void 0,function*(){return (yield this.makeNoResultsBack()).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreFoldedResults(t,r){return this.makeClickEvent(S.showMoreFoldedResults,t,r)}logShowMoreFoldedResults(t,r){return y(this,void 0,void 0,function*(){return (yield this.makeShowMoreFoldedResults(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessFoldedResults(){return this.makeCustomEvent(S.showLessFoldedResults)}logShowLessFoldedResults(){return y(this,void 0,void 0,function*(){return (yield this.makeShowLessFoldedResults()).log({searchUID:this.provider.getSearchUID()})})}makeEventDescription(t,r){var o;return {actionCause:r,customData:(o=t.payload)===null||o===void 0?void 0:o.customData}}makeCustomEvent(t,r,o=rd[t]){return y(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),a=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:o,eventValue:t}),i=yield this.coveoAnalyticsClient.makeCustomEvent(a);return {description:this.makeEventDescription(i,t),log:({searchUID:c})=>i.log({lastSearchQueryUid:c})}})}logCustomEvent(t,r,o=rd[t]){return y(this,void 0,void 0,function*(){return (yield this.makeCustomEvent(t,r,o)).log({searchUID:this.provider.getSearchUID()})})}makeCustomEventWithType(t,r,o){return y(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),o),a=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:r,eventValue:t}),i=yield this.coveoAnalyticsClient.makeCustomEvent(a);return {description:this.makeEventDescription(i,t),log:({searchUID:c})=>i.log({lastSearchQueryUid:c})}})}logCustomEventWithType(t,r,o){return y(this,void 0,void 0,function*(){return (yield this.makeCustomEventWithType(t,r,o)).log({searchUID:this.provider.getSearchUID()})})}logSearchEvent(t,r){return y(this,void 0,void 0,function*(){return (yield this.makeSearchEvent(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeSearchEvent(t,r){return y(this,void 0,void 0,function*(){let o=yield this.getBaseSearchEventRequest(t,r),n=yield this.coveoAnalyticsClient.makeSearchEvent(o);return {description:this.makeEventDescription(n,t),log:({searchUID:a})=>n.log({searchQueryUid:a})}})}makeClickEvent(t,r,o,n){return y(this,void 0,void 0,function*(){let a=Object.assign(Object.assign(Object.assign({},r),yield this.getBaseEventRequest(Object.assign(Object.assign({},o),n))),{queryPipeline:this.provider.getPipeline(),actionCause:t}),i=yield this.coveoAnalyticsClient.makeClickEvent(a);return {description:this.makeEventDescription(i,t),log:({searchUID:c})=>i.log({searchQueryUid:c})}})}logClickEvent(t,r,o,n){return y(this,void 0,void 0,function*(){return (yield this.makeClickEvent(t,r,o,n)).log({searchUID:this.provider.getSearchUID()})})}getBaseSearchEventRequest(t,r){var o,n;return y(this,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},r),(n=(o=this.provider).getGeneratedAnswerMetadata)===null||n===void 0?void 0:n.call(o)))),this.provider.getSearchEventRequestPayload()),{queryPipeline:this.provider.getPipeline(),actionCause:t})})}getBaseEventRequest(t){return y(this,void 0,void 0,function*(){let r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t);return Object.assign(Object.assign(Object.assign({},this.getOrigins()),this.getSplitTestRun()),{customData:r,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})})}getOrigins(){var t,r;return {originContext:(r=(t=this.provider).getOriginContext)===null||r===void 0?void 0:r.call(t),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof Ot?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getSplitTestRun(){let t=this.provider.getSplitTestRunName?this.provider.getSplitTestRunName():"",r=this.provider.getSplitTestRunVersion?this.provider.getSplitTestRunVersion():"";return Object.assign(Object.assign({},t&&{splitTestRunName:t}),r&&{splitTestRunVersion:r})}makeLikeGeneratedAnswer(t){return this.makeCustomEvent(S.likeGeneratedAnswer,t)}logLikeGeneratedAnswer(t){return y(this,void 0,void 0,function*(){return (yield this.makeLikeGeneratedAnswer(t)).log({searchUID:this.provider.getSearchUID()})})}makeDislikeGeneratedAnswer(t){return this.makeCustomEvent(S.dislikeGeneratedAnswer,t)}logDislikeGeneratedAnswer(t){return y(this,void 0,void 0,function*(){return (yield this.makeDislikeGeneratedAnswer(t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenGeneratedAnswerSource(t){return this.makeCustomEvent(S.openGeneratedAnswerSource,t)}logOpenGeneratedAnswerSource(t){return y(this,void 0,void 0,function*(){return (yield this.makeOpenGeneratedAnswerSource(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerSourceHover(t){return this.makeCustomEvent(S.generatedAnswerSourceHover,t)}logGeneratedAnswerSourceHover(t){return y(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerSourceHover(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCopyToClipboard(t){return this.makeCustomEvent(S.generatedAnswerCopyToClipboard,t)}logGeneratedAnswerCopyToClipboard(t){return y(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerCopyToClipboard(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerHideAnswers(t){return this.makeCustomEvent(S.generatedAnswerHideAnswers,t)}logGeneratedAnswerHideAnswers(t){return y(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerHideAnswers(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerShowAnswers(t){return this.makeCustomEvent(S.generatedAnswerShowAnswers,t)}logGeneratedAnswerShowAnswers(t){return y(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerShowAnswers(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerExpand(t){return this.makeCustomEvent(S.generatedAnswerExpand,t)}logGeneratedAnswerExpand(t){return y(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerExpand(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCollapse(t){return this.makeCustomEvent(S.generatedAnswerCollapse,t)}logGeneratedAnswerCollapse(t){return y(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerCollapse(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerFeedbackSubmit(t){return this.makeCustomEvent(S.generatedAnswerFeedbackSubmit,t)}logGeneratedAnswerFeedbackSubmit(t){return y(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerFeedbackSubmit(t)).log({searchUID:this.provider.getSearchUID()})})}makeRephraseGeneratedAnswer(t){return this.makeSearchEvent(S.rephraseGeneratedAnswer,t)}logRephraseGeneratedAnswer(t){return y(this,void 0,void 0,function*(){return (yield this.makeRephraseGeneratedAnswer(t)).log({searchUID:this.provider.getSearchUID()})})}makeRetryGeneratedAnswer(){return this.makeSearchEvent(S.retryGeneratedAnswer)}logRetryGeneratedAnswer(){return y(this,void 0,void 0,function*(){return (yield this.makeRetryGeneratedAnswer()).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerStreamEnd(t){return this.makeCustomEvent(S.generatedAnswerStreamEnd,t)}logGeneratedAnswerStreamEnd(t){return y(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerStreamEnd(t)).log({searchUID:this.provider.getSearchUID()})})}},ya=Object.assign({},Go);Object.keys(ya).map(e=>ya[e]);var Sa;(function(e){e.click="click",e.flowStart="flowStart";})(Sa||(Sa={}));var at;(function(e){e.enterInterface="ticket_create_start",e.fieldUpdate="ticket_field_update",e.fieldSuggestionClick="ticket_classification_click",e.suggestionClick="suggestion_click",e.suggestionRate="suggestion_rate",e.nextCaseStep="ticket_next_stage",e.caseCancelled="ticket_cancel",e.caseSolved="ticket_cancel",e.caseCreated="ticket_create";})(at||(at={}));var Ca;(function(e){e.quit="Quit",e.solved="Solved";})(Ca||(Ca={}));var Ae=e=>new Ot(e).getCurrentVisitorId(),He=new ld.HistoryStore,qt=(e,t)=>typeof t=="function"?(...r)=>{let o=Vo(r[0]);try{return t.apply(t,r)}catch(n){return e.error(n,"Error in analytics preprocessRequest. Returning original request."),o}}:void 0,Tt=(e,t)=>(...r)=>{let o=Vo(r[1]);try{return t.apply(t,r)}catch(n){return e.error(n,"Error in analytics hook. Returning original request."),o}};function Ra(e,t){let r={};e.forEach(a=>r[a.facetId]=a);let o=[];t.forEach(a=>{a in r&&(o.push(r[a]),delete r[a]);});let n=Object.values(r);return [...o,...n]}function kt(e){return Object.values(e).map(t=>t.request)}var wr=()=>({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,lq:"",lqWasSet:!1,dq:"",dqWasSet:!1,defaultFilters:{cq:"",aq:"",lq:"",dq:""}});function DC({config:e,environment:t,event:r,listenerManager:o}){let{url:n,token:a,mode:i}=e;i!=="disabled"&&(o.call(r),t.send(n,a,r));}var VC=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function NC(e){return typeof e=="string"&&VC.test(e)}function MC(e){let t="visitorId";return {getClientId:()=>{let r=e.get(),o=r.storage,n=o.getItem(t),a=n&&NC(n)?n:r.generateUUID();return o.setItem(t,a),a},clear:()=>{e.get().storage.removeItem(t);}}}var Cd="0.7.7";function LC(e){let{trackingId:t}=e;return {trackingId:t}}function UC(e){return (e.source||[]).concat([`relay@${Cd}`])}function xd(e,t,r,o){let{getReferrer:n,getLocation:a,getUserAgent:i}=r,c=LC(t),u=o.getClientId();return Object.freeze({type:e,config:c,ts:Date.now(),source:UC(t),clientId:u,userAgent:i(),referrer:n(),location:a()})}function QC(e,t,r,o,n){return {...t,meta:xd(e,r,o,n)}}var BC="*";function _C(){let e=[];function t({type:u,callback:s}){return e.findIndex(l=>l.type===u&&l.callback===s)}function r(u,s){return u.type==="*"||s===u.type}function o(u){return t(u)<0&&e.push(u),()=>c(u.type,u.callback)}function n(u){e.forEach(s=>{if(r(s,u.meta.type))try{s.callback(u);}catch(l){console.error(l);}});}function a(u){if(u===BC)e.length=0;else for(let s=e.length-1;s>=0;s--)e[s].type===u&&e.splice(s,1);}function i(u){let s=t(u);s>=0&&e.splice(s,1);}function c(u,s){s?i({type:u,callback:s}):a(u);}return {add:o,call:n,remove:c}}function Sd({url:e,token:t,trackingId:r,...o}){return Object.freeze({url:e,token:t,trackingId:r,...!!o.mode&&{mode:o.mode},...!!o.source&&{source:o.source}})}function jC(e){let t=Sd(e);return {get:()=>t,update:r=>{t=Sd({...t,...r});}}}function $C(){let e=typeof window<"u";return {sendMessage(t){e&&window.postMessage(t,"*");}}}var ss=zC();function zC(){let e="coveo_",t=r=>{let o=r.split(".").slice(-2);return o.length==2?o.join("."):""};return {getItem(r){let o=`${e}${r}=`,n=document.cookie.split(";");for(let a of n){let i=a.replace(/^\s+/,"");if(i.lastIndexOf(o,0)===0)return i.substring(o.length,i.length)}return null},setItem(r,o,n){let a=t(window.location.hostname),i=`;expires=${new Date(new Date().getTime()+n).toUTCString()}`,c=a?`;domain=${a}`:"";document.cookie=`${e}${r}=${o}${i}${c};path=/;SameSite=Lax`;},removeItem(r){this.setItem(r,"",-1);}}}function HC(){return {getItem(e){return ss.getItem(e)||localStorage.getItem(e)},removeItem(e){ss.removeItem(e),localStorage.removeItem(e);},setItem(e,t){localStorage.setItem(e,t),ss.setItem(e,t,31556952e3);}}}function WC(){let e=document.referrer;return e===""?null:e}function KC(){return {runtime:"browser",send:(e,t,r)=>{let o=navigator.sendBeacon(`${e}?access_token=${t}`,new Blob([JSON.stringify([r])],{type:"application/json"}));if($C().sendMessage({kind:"EVENT_PROTOCOL",event:r,url:e,token:t}),!o)throw new Error("Failed to send the event(s) because the payload size exceeded the maximum allowed size (32 KB). Please contact support if the problem persists.")},getReferrer:()=>WC(),getLocation:()=>window.location.href,getUserAgent:()=>navigator.userAgent,generateUUID:()=>crypto.randomUUID(),storage:HC()}}function YC(){return {getItem(){return null},removeItem(){},setItem(){}}}function GC(){return {runtime:"null",send:()=>{},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>"",storage:YC()}}function JC(e){return e.get().mode!=="disabled"&&XC()?KC():GC()}function XC(){try{return typeof window=="object"}catch{return !1}}function ZC(e){return {get:()=>Object.freeze(JC(e))}}function Rd(e){let t=jC(e),r=_C(),o=ZC(t),n=MC(o);return {emit:(a,i)=>{let c=t.get(),u=o.get(),s=QC(a,i,c,u,n);return DC({config:c,environment:u,event:s,listenerManager:r})},getMeta:a=>xd(a,t.get(),o.get(),n),on:(a,i)=>r.add({type:a,callback:i}),off:(a,i)=>r.remove(a,i),updateConfig:a=>t.update(a),version:Cd,clearStorage:()=>{n.clear();}}}var to="2.63.3",vd=["@coveo/atomic","@coveo/quantic"];var va=D(e=>e.source,e=>[`@coveo/headless@${to}`].concat(Object.entries(e).map(([t,r])=>`${t}@${r}`)));var Zo=D(e=>e.configuration.accessToken,e=>e.configuration.analytics,e=>va(e.configuration.analytics),(e,{trackingId:t,nextApiBaseUrl:r,enabled:o},n)=>Rd({mode:o?"emit":"disabled",url:r,token:e,trackingId:t,source:n}));var ro=()=>"default";var Fa=()=>({url:"",clientId:"",additionalFields:[],advancedParameters:{debug:!1},products:[],facets:{results:[]},error:null,isLoading:!1,responseId:""});var ex=e=>{let t=e.configuration.search.locale.split("-")[0];return !t||t.length!==2?"en":t},Dt=class{constructor(t){this.getState=t;this.state=t();}getLanguage(){return ex(this.state)}getBaseMetadata(){let{context:t,configuration:r}=this.state,o=t?.contextValues||{},n={};for(let[a,i]of Object.entries(o)){let c=`context_${a}`;n[c]=i;}return r.analytics.analyticsMode==="legacy"&&(n.coveoHeadlessVersion=to),n}getOriginContext(){return this.state.configuration.analytics.originContext}getOriginLevel1(){return this.state.searchHub||ro()}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3}getIsAnonymous(){return this.state.configuration.analytics.anonymous}};function Aa(){return {desiredCount:5,numberOfValues:8,set:{}}}function rn(e){let{activeValue:t,ancestryMap:r}=tx(e);return t?rx(t,r):[]}function tx(e){let t=[...e],r=new Map;for(;t.length>0;){let o=t.shift();if(o.state==="selected")return {activeValue:o,ancestryMap:r};if(r)for(let n of o.children)r.set(n,o);t.unshift(...o.children);}return {}}function rx(e,t){let r=[];if(!e)return [];let o=e;do r.unshift(o),o=t.get(o);while(o);return r}var nx=(e,t)=>e.categoryFacetSet[t]?.request;var ds=(e,t)=>{let r=nx(e,t);return rn(r?.currentValues??[])};function ba(){return {}}function bd(e){return {request:e}}function oo(){return {}}function Pd(e){return {request:e}}function no(){return {}}function Id(e){return {request:e,hasBreadcrumbs:!0}}function ao(){return {}}function it(e){return {facetSet:e.facetSet??ao(),categoryFacetSet:e.categoryFacetSet??ba(),dateFacetSet:e.dateFacetSet??oo(),numericFacetSet:e.numericFacetSet??no(),automaticFacetSet:e.automaticFacetSet??Aa()}}var ms=e=>{let t=[];return cx(e).forEach((r,o)=>{let n=Td(e,r.facetId),a=mx(r,o+1);if(ix(r)){if(!!!ds(e,r.facetId).length)return;t.push({...a,...lx(e,r.facetId),facetType:n,state:"selected"});return}r.currentValues.forEach((i,c)=>{if(i.state==="idle")return;let u=wd(i,c+1,n),s=ax(r)?Ed(i):ux(i);t.push({...a,...u,...s});});}),sx(e).forEach((r,o)=>{let n=dx(r,o+1);r.values.forEach((a,i)=>{if(a.state==="idle")return;let c=wd(a,i+1,"specific"),u=Ed(a);t.push({...n,...c,...u});});}),t},ax=e=>e.type==="specific",ix=e=>e.type==="hierarchical",cx=e=>[...Object.values(e.facetSet),...Object.values(e.categoryFacetSet),...Object.values(e.dateFacetSet),...Object.values(e.numericFacetSet)].map(t=>t.request),sx=e=>[...Object.values(e.automaticFacetSet.set)].map(t=>t.response),wd=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),ux=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),Ed=e=>({displayValue:e.value,value:e.value}),Od=(e,t)=>ds(e,t).map(o=>o.value).join(";"),lx=(e,t)=>{let o=Od(e,t);return {value:o,valuePosition:1,displayValue:o}},dx=(e,t)=>({title:ps(e.field,e.field),field:e.field,id:e.field,facetPosition:t}),mx=(e,t)=>({title:ps(e.field,e.facetId),field:e.field,id:e.facetId,facetPosition:t}),ps=(e,t)=>`${e}_${t}`,qd=(e,t)=>e.facetSet[t]?.request||e.categoryFacetSet[t]?.request||e.dateFacetSet[t]?.request||e.numericFacetSet[t]?.request||e.automaticFacetSet.set[t]?.response,Td=(e,t)=>{let r=qd(e,t);return r?r.type:"specific"};var be=()=>({q:"",enableQuerySyntax:!1});function on(){return {answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}}function Ue(){return {response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:on(),pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],searchResponseId:"",requestId:"",questionAnswer:on(),extendedResults:{}}}var Or=class extends Dt{constructor(){super(...arguments);this.initialState=Fa();}getPipeline(){return ""}getSearchEventRequestPayload(){return {queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){return this.getState().productListing?.responseId||this.initialState.responseId}mapResultsToAnalyticsDocument(){return this.state.productListing?.products.map(r=>({documentUri:r.documentUri,documentUriHash:r.documentUriHash,permanentid:r.permanentid}))}get numberOfResults(){return this.state.productListing.products.length}},kd=({logger:e,getState:t,analyticsClientMiddleware:r=(a,i)=>i,preprocessRequest:o,provider:n=new Or(t)})=>{let a=t(),i=a.configuration.accessToken,c=a.configuration.analytics.apiBaseUrl,u=a.configuration.analytics.runtimeEnvironment,s=a.configuration.analytics.enabled,l=new Gt({token:i,endpoint:c,runtimeEnvironment:u,preprocessRequest:qt(e,o),beforeSendHooks:[Tt(e,r),(d,p)=>(e.info({...p,type:d,endpoint:c,token:i},"Analytics request"),p)]},n);return s||l.disable(),l};var Dd=(r=>(r.Ascending="ascending",r.Descending="descending",r))(Dd||{}),Vd=(a=>(a.Relevancy="relevancy",a.QRE="qre",a.Date="date",a.Field="field",a.NoSort="nosort",a))(Vd||{}),fs=e=>{if(Kn(e))return e.map(t=>fs(t)).join(",");switch(e.by){case"relevancy":case"qre":case"nosort":return e.by;case"date":return `date ${e.order}`;case"field":return `@${e.field} ${e.order}`;default:return ""}},Nd=()=>({by:"relevancy"});new F({values:{by:new ot({enum:Vd,required:!0}),order:new ot({enum:Dd}),field:new C}});function qr(){return fs(Nd())}var nn=class nn extends Dt{constructor(){super(...arguments);this.getFacetRequest=r=>this.state.facetSet?.[r]?.request||this.state.categoryFacetSet?.[r]?.request||this.state.dateFacetSet?.[r]?.request||this.state.numericFacetSet?.[r]?.request||this.state.automaticFacetSet?.set[r]?.response;}getFacetState(){return ms(it(this.getState()))}getPipeline(){return this.state.pipeline||this.state.search?.response.pipeline||nn.fallbackPipelineName}getSearchEventRequestPayload(){return {queryText:this.queryText,responseTime:this.responseTime,results:this.resultURIs,numberOfResults:this.numberOfResults}}getSearchUID(){let r=this.getState();return r.search?.searchResponseId||r.search?.response.searchUid||Ue().response.searchUid}getSplitTestRunName(){return this.state.search?.response.splitTestRun}getSplitTestRunVersion(){let r=!!this.getSplitTestRunName(),o=this.state.search?.response.pipeline||this.state.pipeline||nn.fallbackPipelineName;return r?o:void 0}getBaseMetadata(){let r=this.getState(),o=super.getBaseMetadata(),n=r.search?.response?.extendedResults?.generativeQuestionAnsweringId;return n&&(o.generativeQuestionAnsweringId=n),o}getFacetMetadata(r,o){let a=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),facetId:r,facetField:a,facetValue:o,facetTitle:`${a}_${r}`}}getFacetClearAllMetadata(r){let n=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),facetId:r,facetField:n,facetTitle:`${n}_${r}`}}getFacetUpdateSortMetadata(r,o){let a=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),facetId:r,facetField:a,criteria:o,facetTitle:`${a}_${r}`}}getRangeBreadcrumbFacetMetadata(r,o){let a=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),facetId:r,facetField:a,facetRangeEnd:o.end,facetRangeEndInclusive:o.endInclusive,facetRangeStart:o.start,facetTitle:`${a}_${r}`}}getResultSortMetadata(){return {...this.getBaseMetadata(),resultsSortBy:this.state.sortCriteria??qr()}}getStaticFilterToggleMetadata(r,o){return {...this.getBaseMetadata(),staticFilterId:r,staticFilterValue:o}}getStaticFilterClearAllMetadata(r){return {...this.getBaseMetadata(),staticFilterId:r}}getUndoTriggerQueryMetadata(r){return {...this.getBaseMetadata(),undoneQuery:r}}getCategoryBreadcrumbFacetMetadata(r,o){let a=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),categoryFacetId:r,categoryFacetField:a,categoryFacetPath:o,categoryFacetTitle:`${a}_${r}`}}getOmniboxAnalyticsMetadata(r,o){let n=this.state.querySuggest&&this.state.querySuggest[r],a=n.completions.map(s=>s.expression),i=n.partialQueries.length-1,c=n.partialQueries[i]||"",u=n.responseId;return {...this.getBaseMetadata(),suggestionRanking:a.indexOf(o),partialQuery:c,partialQueries:n.partialQueries.length>0?n.partialQueries:"",suggestions:a.length>0?a:"",querySuggestResponseId:u}}getInterfaceChangeMetadata(){return {...this.getBaseMetadata(),interfaceChangeTo:this.state.configuration.analytics.originLevel2}}getOmniboxFromLinkMetadata(r){return {...this.getBaseMetadata(),...r}}getGeneratedAnswerMetadata(){let r=this.getState(),o={};return r.generatedAnswer?.isVisible!==void 0&&(o.showGeneratedAnswer=r.generatedAnswer.isVisible),o}get resultURIs(){return this.results?.map(r=>({documentUri:r.uri,documentUriHash:r.raw.urihash}))}get results(){return this.state.search?.response.results}get queryText(){return this.state.query?.q||be().q}get responseTime(){return this.state.search?.duration||Ue().duration}get numberOfResults(){return this.state.search?.response.totalCountFiltered||Ue().response.totalCountFiltered}};nn.fallbackPipelineName="default";var Jt=nn,Md=({logger:e,getState:t,analyticsClientMiddleware:r=(a,i)=>i,preprocessRequest:o,provider:n=new Jt(t)})=>{let a=t(),i=a.configuration.accessToken,c=a.configuration.analytics.apiBaseUrl,u=a.configuration.analytics.runtimeEnvironment,s=a.configuration.analytics.enabled,l=new Gt({token:i,endpoint:c,runtimeEnvironment:u,preprocessRequest:qt(e,o),beforeSendHooks:[Tt(e,r),(d,p)=>(e.info({...p,type:d,endpoint:c,token:i},"Analytics request"),p)]},n);return s||l.disable(),l},gs=()=>{let t=He.getHistory().reverse().find(r=>r.name==="PageView"&&r.value);return t?t.value:""};var hs=()=>"";function Ld(e,t){return {...new Jt(t).getBaseMetadata(),actionCause:e,type:e}}function px(e){return Object.assign(e,{instantlyCallable:!0})}function fx(e,t){let r=a=>px(T(e,a)),o=r(async(a,{getState:i,extra:c})=>{let{analyticsClientMiddleware:u,preprocessRequest:s,logger:l}=c;return await(await t({getState:i,analyticsClientMiddleware:u,preprocessRequest:s,logger:l})).log({state:i(),extra:c})});return Object.assign(o,{prepare:async({getState:a,analyticsClientMiddleware:i,preprocessRequest:c,logger:u})=>{let{description:s,log:l}=await t({getState:a,analyticsClientMiddleware:i,preprocessRequest:c,logger:u});return {description:s,action:r(async(d,{getState:p,extra:m})=>await l({state:p(),extra:m}))}}}),o}var Ia=(e,t,r)=>{function o(...n){let a=n.length===1?{...n[0],__legacy__getBuilder:t(n[0].__legacy__getBuilder),analyticsConfigurator:e,providerClass:r}:{prefix:n[0],__legacy__getBuilder:t(n[1]),__legacy__provider:n[2],analyticsConfigurator:e,providerClass:r};return yx(a)}return o},gx=e=>e.configuration.analytics.analyticsMode==="legacy",hx=e=>e.configuration.analytics.analyticsMode==="next",yx=({prefix:e,__legacy__getBuilder:t,__legacy__provider:r,analyticsPayloadBuilder:o,analyticsType:n,analyticsConfigurator:a,providerClass:i})=>(r??(r=c=>new i(c)),fx(e,async({getState:c,analyticsClientMiddleware:u,preprocessRequest:s,logger:l})=>{let d=[],p={log:async({state:E})=>{for(let k of d)await k(E);}},m=c(),g=a({getState:c,logger:l,analyticsClientMiddleware:u,preprocessRequest:s,provider:r(c)}),x=await t(g,c());p.description=x?.description,d.push(async E=>{gx(E)&&await Sx(x,r,E,l,g.coveoAnalyticsClient);});let{emit:v}=Zo(m);return d.push(async E=>{if(hx(E)&&n&&o){let k=o(E);await vx(v,n,k);}}),p}));async function Sx(e,t,r,o,n){t(()=>r);let a=await e?.log({searchUID:t(()=>r).getSearchUID()});o.info({client:n,response:a},"Analytics response");}var he=Ia(Md,e=>e,Jt);var Ud=Ia(kd,e=>e,Or);var xx={urihash:new C,sourcetype:new C,permanentid:new C};({uniqueId:R,raw:new F({values:xx}),title:R,uri:R,clickUri:R,rankingModifier:new C({required:!1,emptyAllowed:!0})});async function vx(e,t,r){await e(t,r);}var ys=()=>he("search/logFetchMoreResults",e=>e.makeFetchMoreResults()),xe=e=>he("search/queryError",(t,r)=>t.makeQueryError({query:r.query?.q||be().q,aq:r.advancedSearchQueries?.aq||wr().aq,cq:r.advancedSearchQueries?.cq||wr().cq,dq:r.advancedSearchQueries?.dq||wr().dq,errorType:e.type,errorMessage:e.message}));var ct=(r=>(r.Relevance="relevance",r.Fields="fields",r))(ct||{}),io=(r=>(r.Ascending="asc",r.Descending="desc",r))(io||{}),Xt=()=>({by:"relevance"});new F({options:{required:!1},values:{by:new ot({enum:ct,required:!0}),fields:new H({each:new F({values:{name:new C,direction:new ot({enum:io})}})})}});var Qd=()=>Ud("analytics/productListing/load",e=>e.makeInterfaceLoad(),e=>new Or(e));f("productlisting/setUrl",e=>h(e,{url:new C({required:!0,url:!0})}));f("productlisting/setAdditionalFields",e=>h(e,{additionalFields:new H({required:!0,each:new C({required:!0,emptyAllowed:!1})})}));var Zt=T("productlisting/fetch",async(e,{getState:t,dispatch:r,rejectWithValue:o,extra:n})=>{let a=t(),{apiClient:i}=n,c=await i.getProducts(await Fx(a));return ve(c)?(r(xe(c.error)),o(c.error)):{response:c.success,analyticsAction:Qd()}}),Fx=async e=>{let t=bx(e),r=await Ae(e.configuration.analytics);return {accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,platformUrl:e.configuration.platformUrl,url:e.productListing?.url,...e.configuration.analytics.enabled&&r?{clientId:r}:{},...e.productListing.additionalFields?.length?{additionalFields:e.productListing.additionalFields}:{},...e.productListing.advancedParameters&&Ax(e.productListing.advancedParameters)?{advancedParameters:e.productListing.advancedParameters||{}}:{},...t.length&&{facets:{requests:t}},...e.pagination&&{pagination:{numberOfValues:e.pagination.numberOfResults,page:Math.ceil(e.pagination.firstResult/(e.pagination.numberOfResults||1))+1}},...(e.sort?.by||"relevance")!=="relevance"&&{sort:e.sort},...e.context&&{userContext:e.context.contextValues}}};function Ax(e){return e.debug}function bx(e){return Ra(Px(e),e.facetOrder??[])}function Px(e){return [...kt(e.facetSet??{}),...kt(e.numericFacetSet??{}),...kt(e.dateFacetSet??{}),...kt(e.categoryFacetSet??{})]}var wa={q:new C,enableQuerySyntax:new V,aq:new C,cq:new C,firstResult:new P({min:0}),numberOfResults:new P({min:0}),sortCriteria:new C,f:new F,fExcluded:new F,cf:new F,nf:new F,df:new F,debug:new V,sf:new F,tab:new C,af:new F};var Re=f("searchParameters/restore",e=>h(e,wa));var ft=f("facet/updateFacetAutoSelection",e=>h(e,{allow:new V({required:!0})}));var Ea=class extends Jt{constructor(r){super(r);this.getState=r;}get activeInstantResultQuery(){let r=this.getState().instantResults;for(let o in r)for(let n in r[o].cache)if(r[o].cache[n].isActive)return r[o].q;return null}get activeInstantResultCache(){let r=this.getState().instantResults;for(let o in r)for(let n in r[o].cache)if(r[o].cache[n].isActive)return r[o].cache[n];return null}get results(){return this.activeInstantResultCache?.results}get queryText(){return this.activeInstantResultQuery??be().q}get responseTime(){return this.activeInstantResultCache?.duration??Ue().duration}get numberOfResults(){return this.activeInstantResultCache?.totalCountFiltered??Ue().response.totalCountFiltered}getSearchUID(){return this.activeInstantResultCache?.searchUid||super.getSearchUID()}};var Bd=()=>he("analytics/instantResult/searchboxAsYouType",e=>e.makeSearchboxAsYouType(),e=>new Ea(e)),_d=()=>({actionCause:"searchboxAsYouType"});var Ss={id:R},Ox={...Ss,q:pe};f("instantResults/register",e=>h(e,Ss));var Oa=f("instantResults/updateQuery",e=>h(e,Ox));f("instantResults/clearExpired",e=>h(e,Ss));var qa=new P({required:!0,min:0}),jd=f("pagination/registerNumberOfResults",e=>h(e,qa)),$d=f("pagination/updateNumberOfResults",e=>h(e,qa)),zd=f("pagination/registerPage",e=>h(e,qa)),gt=f("pagination/updatePage",e=>h(e,qa)),Hd=f("pagination/nextPage"),Wd=f("pagination/previousPage");var ht=f("query/updateQuery",e=>h(e,{q:new C,enableQuerySyntax:new V}));var er=async(e,t)=>{let r=e.analyticsMode==="next";return {analytics:{clientId:await Ae(e),clientTimestamp:new Date().toISOString(),documentReferrer:e.originLevel3,originContext:e.originContext,...t&&{actionCause:t.actionCause,customData:t.customData},...t&&!r&&{customData:t.customData},...e.userDisplayName&&{userDisplayName:e.userDisplayName},...e.documentLocation&&{documentLocation:e.documentLocation},...e.deviceId&&{deviceId:e.deviceId},...gs()&&{pageId:gs()},...r&&e.trackingId&&{trackingId:e.trackingId},capture:r,...r&&{source:va(e)}}}};var Ta=async(e,t)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await Ae(e.configuration.analytics),actionsHistory:He.getHistory()},...e.advancedSearchQueries?.aq&&{aq:e.advancedSearchQueries.aq},...e.advancedSearchQueries?.cq&&{cq:e.advancedSearchQueries.cq},...e.advancedSearchQueries?.lq&&{lq:e.advancedSearchQueries.lq},...e.advancedSearchQueries?.dq&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await er(e.configuration.analytics,t),...e.excerptLength&&!M(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});var ka=async(e,t)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await Ae(e.configuration.analytics),actionsHistory:He.getHistory()},...e.advancedSearchQueries?.aq&&{aq:e.advancedSearchQueries.aq},...e.advancedSearchQueries?.cq&&{cq:e.advancedSearchQueries.cq},...e.advancedSearchQueries?.lq&&{lq:e.advancedSearchQueries.lq},...e.advancedSearchQueries?.dq&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await er(e.configuration.analytics,t),...e.excerptLength&&!M(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});var an=Qe(Da()),Jd=Qe(Kd());var Va=Qe(Da()),Gd=Qe(Yd());Va.default.extend(Gd.default);var bs="YYYY/MM/DD@HH:mm:ss",qx="1401-01-01";function co(e,t){let r=(0, Va.default)(e,t);return !r.isValid()&&!t?(0, Va.default)(e,bs):r}function Na(e){return e.format(bs)}function Ps(e,t){let r=co(e,t);if(!r.isValid()){let o=". Please provide a date format string in the configuration options. See https://day.js.org/docs/en/parse/string-format for more information.",n=` with the format "${t}"`;throw new Error(`Could not parse the provided date "${e}"${t?n:o}`)}Is(r);}function Is(e){if(e.isBefore(qx))throw new Error(`Date is before year 1401, which is unsupported by the API: ${e}`)}an.default.extend(Jd.default);var Xd=["past","now","next"],Zd=["minute","hour","day","week","month","quarter","year"],Tx=e=>{let t=e==="now";return {amount:new P({required:!t,min:1}),unit:new C({required:!t,constrainTo:Zd}),period:new C({required:!0,constrainTo:Xd})}};function Ma(e){if(typeof e=="string"&&!Nt(e))throw new Error(`The value "${e}" is not respecting the relative date format "period-amount-unit"`);let t=typeof e=="string"?nm(e):e;new z(Tx(t.period)).validate(t);let r=tm(t),o=JSON.stringify(t);if(!r.isValid())throw new Error(`Date is invalid: ${o}`);Is(r);}function em(e){let{period:t,amount:r,unit:o}=e;switch(t){case"past":case"next":return `${t}-${r}-${o}`;case"now":return t}}function tm(e){let{period:t,amount:r,unit:o}=e;switch(t){case"past":return (0, an.default)().subtract(r,o);case"next":return (0, an.default)().add(r,o);case"now":return (0, an.default)()}}function cn(e){return Na(tm(nm(e)))}function rm(e){return e.toLocaleLowerCase().split("-")}function Nt(e){let[t,r,o]=rm(e);if(t==="now")return !0;if(!Xd.includes(t)||!Zd.includes(o))return !1;let n=parseInt(r);return !(isNaN(n)||n<=0)}function om(e){return !!e&&typeof e=="object"&&"period"in e}function nm(e){let[t,r,o]=rm(e);return t==="now"?{period:"now"}:{period:t,amount:r?parseInt(r):void 0,unit:o||void 0}}function am(e){return e.type==="dateRange"}function im(e){return `start${e}`}function cm(e){return `end${e}`}var kx=()=>({dateFacetValueMap:{}});function Dx(e,t,r){let o=e.start,n=e.end;return Nt(o)&&(o=cn(o),r.dateFacetValueMap[t][im(o)]=e.start),Nt(n)&&(n=cn(n),r.dateFacetValueMap[t][cm(n)]=e.end),{...e,start:o,end:n}}function Vx(e,t){if(am(e)){let{facetId:r,currentValues:o}=e;return t.dateFacetValueMap[r]={},{...e,currentValues:o.map(n=>Dx(n,r,t))}}return e}function so(e){let t=kx();return {request:{...e,facets:e.facets?.map(o=>Vx(o,t))},mappings:t}}function Nx(e,t,r){return {...e,start:r.dateFacetValueMap[t][im(e.start)]||e.start,end:r.dateFacetValueMap[t][cm(e.end)]||e.end}}function Mx(e,t){return e.facetId in t.dateFacetValueMap}function Lx(e,t){return Mx(e,t)?{...e,values:e.values.map(r=>Nx(r,e.facetId,t))}:e}function La(e,t){return "success"in e?{success:{...e.success,facets:e.success.facets?.map(o=>Lx(o,t))}}:e}var ue=async(e,t)=>{let r=zx(e),o=Ux(e),n=Qx(e),a=e.configuration.analytics.analyticsMode==="legacy"?await ka(e,t):await Ta(e,t),i=()=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0;return so({...a,...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="next",options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="legacy"},...r&&{cq:r},...o.length&&{facets:o},...e.pagination&&{numberOfResults:i(),firstResult:e.pagination.firstResult},...e.facetOptions&&{facetOptions:{freezeFacetOrder:e.facetOptions.freezeFacetOrder}},...e.folding?.enabled&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.automaticFacetSet&&{generateAutomaticFacets:{desiredCount:e.automaticFacetSet.desiredCount,numberOfValues:e.automaticFacetSet.numberOfValues,currentFacets:n}},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})};function Ux(e){return Ra(_x(e),e.facetOrder??[])}function Qx(e){let t=e.automaticFacetSet?.set;return t?Object.values(t).map(r=>r.response).map(Bx).filter(r=>r.currentValues.length>0):void 0}function Bx(e){let{field:t,label:r,values:o}=e,n=o.filter(a=>a.state==="selected");return {field:t,label:r,currentValues:n}}function _x(e){return jx(e).filter(({facetId:t})=>e.facetOptions?.facets[t]?.enabled??!0)}function jx(e){return [...$x(e.facetSet??{}),...sm(e.numericFacetSet??{}),...sm(e.dateFacetSet??{}),...kt(e.categoryFacetSet??{})]}function $x(e){return kt(e).map(t=>t.sortCriteria==="alphanumericDescending"?{...t,sortCriteria:{type:"alphanumeric",order:"descending"}}:t)}function sm(e){return kt(e).map(t=>{let o=t.currentValues.some(({state:n})=>n!=="idle");return t.generateAutomaticRanges&&!o?{...t,currentValues:[]}:t})}function zx(e){let t=e.advancedSearchQueries?.cq.trim()||"",o=Object.values(e.tabSet||{}).find(a=>a.isActive)?.expression.trim()||"",n=Hx(e);return [t,o,...n].filter(a=>!!a).join(" AND ")}function Hx(e){return Object.values(e.staticFilterSet||{}).map(r=>{let o=r.values.filter(a=>a.state==="selected"&&!!a.expression.trim()),n=o.map(a=>a.expression).join(" OR ");return o.length>1?`(${n})`:n})}var um=e=>/^https:\/\/platform(dev|stg|hipaa)?(-)?(eu|au)?\.cloud\.coveo\.com/.test(e),lm=(e,t)=>{let r=ws(e);return r&&r.organizationId===t?r:null},ws=e=>{let t=e.match(/^https:\/\/(?<organizationId>\w+)\.org(?<environment>dev|stg|hipaa)?\.coveo\.com/);return t?.groups?t.groups:null};var Qa=e=>e.success!==void 0,We=e=>e.error!==void 0;f("didYouMean/enable");f("didYouMean/disable");f("didYouMean/automaticCorrections/disable");f("didYouMean/automaticCorrections/enable");var uo=f("didYouMean/correction",e=>h(e,R));f("didYouMean/automaticCorrections/mode",e=>h(e,new C({constrainTo:["next","legacy"],emptyAllowed:!1,required:!0})));var Es=()=>he("analytics/didyoumean/automatic",e=>e.makeDidYouMeanAutomatic());var dm=()=>({actionCause:"didyoumeanAutomatic"});function mm(){return {contextValues:{}}}var Ba=()=>!1;function pm(){return {contextValues:{}}}function lo(){return {enabled:!0}}function _a(){return {freezeFacetOrder:!1,facets:{}}}function ja(){return []}function tr(){return {firstResult:0,defaultNumberOfResults:10,numberOfResults:10,totalCountFiltered:0}}function $a(){return {}}function fm(){return {}}function gm(){return {}}function yt(e){return {context:e.context||mm(),dictionaryFieldContext:e.dictionaryFieldContext||pm(),facetSet:e.facetSet||ao(),numericFacetSet:e.numericFacetSet||no(),dateFacetSet:e.dateFacetSet||oo(),categoryFacetSet:e.categoryFacetSet||ba(),automaticFacetSet:e.automaticFacetSet??Aa(),pagination:e.pagination||tr(),query:e.query||be(),tabSet:e.tabSet||gm(),advancedSearchQueries:e.advancedSearchQueries||wr(),staticFilterSet:e.staticFilterSet||fm(),querySet:e.querySet||$a(),sortCriteria:e.sortCriteria||qr(),pipeline:e.pipeline||hs(),searchHub:e.searchHub||ro(),facetOptions:e.facetOptions||_a(),facetOrder:e.facetOrder??ja(),debug:e.debug??Ba()}}new F({values:{undoneQuery:pe},options:{required:!0}});var hm=()=>he("analytics/trigger/query",(e,t)=>t.triggers?.queryModification.newQuery?e.makeTriggerQuery():null);var za=f("trigger/query/ignore",e=>h(e,new C({emptyAllowed:!0,required:!0}))),Ha=f("trigger/query/modification",e=>h(e,new F({values:{originalQuery:X,modification:X}})));var rr=class{constructor(t,r=o=>{this.dispatch(ht({q:o}));}){this.config=t;this.onUpdateQueryForCorrection=r;}async fetchFromAPI({mappings:t,request:r},o){let n=new Date().getTime(),a=La(await this.extra.apiClient.search(r,o),t),i=new Date().getTime()-n,c=this.getState().query?.q||"";return {response:a,duration:i,queryExecuted:c,requestExecuted:r}}async process(t){return this.processQueryErrorOrContinue(t)??await this.processQueryCorrectionsOrContinue(t)??await this.processQueryTriggersOrContinue(t)??this.processSuccessResponse(t)}processQueryErrorOrContinue(t){return We(t.response)?(this.dispatch(xe(t.response.error)),this.rejectWithValue(t.response.error)):null}async processQueryCorrectionsOrContinue(t){let r=this.getState(),o=this.getSuccessResponse(t);if(!o||!r.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:a}=r.didYouMean,{results:i,queryCorrections:c,queryCorrection:u}=o;if(!n||!a)return null;let s=i.length===0&&c&&c.length!==0,l=!M(u)&&!M(u.correctedQuery);if(!s&&!l)return null;let p=s?await this.processLegacyDidYouMeanAutoCorrection(t):this.processModernDidYouMeanAutoCorrection(t);return this.dispatch(pt(yt(this.getState()))),p}async processLegacyDidYouMeanAutoCorrection(t){let r=this.getCurrentQuery(),o=this.getSuccessResponse(t);if(!o.queryCorrections)return null;let{correctedQuery:n}=o.queryCorrections[0],a=await this.automaticallyRetryQueryWithCorrection(n);return We(a.response)?(this.dispatch(xe(a.response.error)),this.rejectWithValue(a.response.error)):(this.logOriginalAnalyticsQueryBeforeAutoCorrection(t),this.dispatch(pt(yt(this.getState()))),{...a,response:{...a.response.success,queryCorrections:o.queryCorrections},automaticallyCorrected:!0,originalQuery:r,analyticsAction:Es()})}processModernDidYouMeanAutoCorrection(t){let r=this.getSuccessResponse(t),{correctedQuery:o,originalQuery:n}=r.queryCorrection;return this.onUpdateQueryForCorrection(o),{...t,response:{...r},queryExecuted:o,automaticallyCorrected:!0,originalQuery:n,analyticsAction:Es()}}logOriginalAnalyticsQueryBeforeAutoCorrection(t){let r=this.getState(),o=this.getSuccessResponse(t);this.analyticsAction&&this.analyticsAction()(this.dispatch,()=>this.getStateAfterResponse(t.queryExecuted,t.duration,r,o),this.extra);}async processQueryTriggersOrContinue(t){let r=this.getSuccessResponse(t);if(!r)return null;let o=r.triggers.find(c=>c.type==="query")?.content||"";if(!o)return null;if(this.getState().triggers?.queryModification.queryToIgnore===o)return this.dispatch(za("")),null;this.analyticsAction&&await this.dispatch(this.analyticsAction);let a=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(o);return We(i.response)?(this.dispatch(xe(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(pt(yt(this.getState()))),{...i,response:{...i.response.success},automaticallyCorrected:!1,originalQuery:a,analyticsAction:hm()})}getStateAfterResponse(t,r,o,n){return {...o,query:{q:t,enableQuerySyntax:o.query?.enableQuerySyntax??be().enableQuerySyntax},search:{...Ue(),duration:r,response:n,results:n.results}}}processSuccessResponse(t){return this.dispatch(pt(yt(this.getState()))),{...t,response:this.getSuccessResponse(t),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(t){return Qa(t.response)?t.response.success:null}async automaticallyRetryQueryWithCorrection(t){this.onUpdateQueryForCorrection(t);let r=await this.fetchFromAPI(await ue(this.getState()),{origin:"mainSearch"});return this.dispatch(uo(t)),r}async automaticallyRetryQueryWithTriggerModification(t){return this.dispatch(Ha({newQuery:t,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(t),await this.fetchFromAPI(await ue(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){let t=this.getState();return t.query?.q!==void 0?t.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get analyticsAction(){return this.config.analyticsAction}get rejectWithValue(){return this.config.rejectWithValue}};T("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;h(e,{q:new C,enableQuerySyntax:new V,clearFilters:new V}),e.clearFilters&&(r(fe()),r(Ht())),r(ft({allow:!0})),r(ht({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(gt(1));});var Wa=T("search/executeSearch",async(e,t)=>{let r=t.getState();return await Ga(r,t,e)}),Ka=T("search/fetchPage",async(e,t)=>{let r=t.getState();return await qs(r,t,e)}),Ya=T("search/fetchMoreResults",async(e,t)=>{let r=t.getState();return await Ts(t,r)}),ym=T("search/fetchFacetValues",async(e,t)=>{let r=t.getState();return await eR(t,e,r)});T("search/fetchInstantResults",async(e,t)=>Os(e,t));var Jx=async(e,t)=>{let r=await ue(e,t);return r.request={...r.request,firstResult:(e.pagination?.firstResult??0)+(e.search?.results.length??0)},r},Xx=async(e,t,r)=>{let o=await ka(e);return so({...o,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},Zx=async(e,t)=>{let r=await ue(e,t);return r.request.numberOfResults=0,r},Sm=e=>{e.configuration.analytics.enabled&&He.addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)});};async function Os(e,t){h(e,{id:R,q:R,maxResultsPerQuery:new P({required:!0,min:1}),cacheTimeout:new P});let{q:r,maxResultsPerQuery:o}=e,n=t.getState(),a=new rr({...t,analyticsAction:Bd()},s=>{t.dispatch(Oa({q:s,id:e.id}));}),i=await Xx(n,r,o),c=await a.fetchFromAPI(i,{origin:"instantResults",disableAbortWarning:!0}),u=await a.process(c);return "response"in u?{results:u.response.results,searchUid:u.response.searchUid,analyticsAction:u.analyticsAction,totalCountFiltered:u.response.totalCountFiltered,duration:u.duration}:u}async function qs(e,t,r){Sm(e);let{analyticsClientMiddleware:o,preprocessRequest:n,logger:a}=t.extra,{description:i}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:o,preprocessRequest:n,logger:a}),c=new rr({...t,analyticsAction:r}),u=await ue(e,i),s=await c.fetchFromAPI(u,{origin:"mainSearch"});return await c.process(s)}async function Ts(e,t){let{analyticsClientMiddleware:r,preprocessRequest:o,logger:n}=e.extra,{description:a}=await ys().prepare({getState:()=>e.getState(),analyticsClientMiddleware:r,preprocessRequest:o,logger:n}),i=new rr({...e,analyticsAction:ys()}),c=await Jx(t,a),u=await i.fetchFromAPI(c,{origin:"mainSearch"});return await i.process(u)}async function eR(e,t,r){let{analyticsClientMiddleware:o,preprocessRequest:n,logger:a}=e.extra,{description:i}=await t.prepare({getState:()=>e.getState(),analyticsClientMiddleware:o,preprocessRequest:n,logger:a}),c=new rr({...e,analyticsAction:t}),u=await Zx(r,i),s=await c.fetchFromAPI(u,{origin:"facetValues"});return await c.process(s)}async function Ga(e,t,r){Sm(e);let{analyticsClientMiddleware:o,preprocessRequest:n,logger:a}=t.extra,{description:i}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:o,preprocessRequest:n,logger:a}),c=await ue(e,i),u=new rr({...t,analyticsAction:r}),s=await u.fetchFromAPI(c,{origin:"mainSearch"});return await u.process(s)}var or=class{constructor(t,r=o=>{this.dispatch(ht({q:o}));}){this.config=t;this.onUpdateQueryForCorrection=r;}async fetchFromAPI({mappings:t,request:r},o){let n=new Date().getTime(),a=La(await this.extra.apiClient.search(r,o),t),i=new Date().getTime()-n,c=this.getState().query?.q||"";return {response:a,duration:i,queryExecuted:c,requestExecuted:r}}async process(t){return this.processQueryErrorOrContinue(t)??await this.processQueryCorrectionsOrContinue(t)??await this.processQueryTriggersOrContinue(t)??this.processSuccessResponse(t)}processQueryErrorOrContinue(t){return We(t.response)?(this.dispatch(xe(t.response.error)),this.rejectWithValue(t.response.error)):null}async processQueryCorrectionsOrContinue(t){let r=this.getState(),o=this.getSuccessResponse(t);if(!o||!r.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:a}=r.didYouMean,{results:i,queryCorrections:c,queryCorrection:u}=o;if(!n||!a)return null;let s=i.length===0&&c&&c.length!==0,l=!M(u)&&!M(u.correctedQuery);if(!s&&!l)return null;let p=s?await this.processLegacyDidYouMeanAutoCorrection(t):this.processModernDidYouMeanAutoCorrection(t);return this.dispatch(pt(yt(this.getState()))),p}async processLegacyDidYouMeanAutoCorrection(t){let r=this.getCurrentQuery(),o=this.getSuccessResponse(t);if(!o.queryCorrections)return null;let{correctedQuery:n}=o.queryCorrections[0],a=await this.automaticallyRetryQueryWithCorrection(n);return We(a.response)?(this.dispatch(xe(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(pt(yt(this.getState()))),{...a,response:{...a.response.success,queryCorrections:o.queryCorrections},automaticallyCorrected:!0,originalQuery:r})}processModernDidYouMeanAutoCorrection(t){let r=this.getSuccessResponse(t),{correctedQuery:o,originalQuery:n}=r.queryCorrection;return this.onUpdateQueryForCorrection(o),{...t,response:{...r},queryExecuted:o,automaticallyCorrected:!0,originalQuery:n}}async processQueryTriggersOrContinue(t){let r=this.getSuccessResponse(t);if(!r)return null;let o=r.triggers.find(c=>c.type==="query")?.content||"";if(!o)return null;if(this.getState().triggers?.queryModification.queryToIgnore===o)return this.dispatch(za("")),null;let a=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(o);return We(i.response)?(this.dispatch(xe(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(pt(yt(this.getState()))),{...i,response:{...i.response.success},automaticallyCorrected:!1,originalQuery:a})}processSuccessResponse(t){return this.dispatch(pt(yt(this.getState()))),{...t,response:this.getSuccessResponse(t),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery()}}getSuccessResponse(t){return Qa(t.response)?t.response.success:null}async automaticallyRetryQueryWithCorrection(t){this.onUpdateQueryForCorrection(t);let r=this.getState(),{actionCause:o}=dm(),n=await this.fetchFromAPI(await ue(r,{actionCause:o}),{origin:"mainSearch"});return this.dispatch(uo(t)),n}async automaticallyRetryQueryWithTriggerModification(t){return this.dispatch(Ha({newQuery:t,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(t),await this.fetchFromAPI(await ue(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){let t=this.getState();return t.query?.q!==void 0?t.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}};T("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;h(e,{q:new C,enableQuerySyntax:new V,clearFilters:new V}),e.clearFilters&&(r(fe()),r(Ht())),r(ft({allow:!0})),r(ht({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(gt(1));});var oe=T("search/executeSearch",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return Ga(r,t,e.legacy);xm(r);let o=ks(e.next),n=await ue(r,o),a=new or({...t,analyticsAction:o}),i=await a.fetchFromAPI(n,{origin:"mainSearch"});return await a.process(i)});T("search/fetchPage",async(e,t)=>{let r=t.getState();if(xm(r),r.configuration.analytics.analyticsMode==="legacy"||!e.next)return qs(r,t,e.legacy);let o=new or({...t,analyticsAction:e.next}),n=await ue(r,e.next),a=await o.fetchFromAPI(n,{origin:"mainSearch"});return await o.process(a)});T("search/fetchMoreResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return Ts(t,r);let o=Ld("pagerScrolling",t.getState),n=new or({...t,analyticsAction:o}),a=await rR(r,o),i=await n.fetchFromAPI(a,{origin:"mainSearch"});return await n.process(i)});var Cm=T("search/fetchFacetValues",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return Ga(r,t,e.legacy);let o=ks(e.next),n=new or({...t,analyticsAction:o}),a=await nR(r,o),i=await n.fetchFromAPI(a,{origin:"facetValues"});return await n.process(i)});T("search/fetchInstantResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return Os(e,t);h(e,{id:R,q:R,maxResultsPerQuery:new P({required:!0,min:1}),cacheTimeout:new P});let{q:o,maxResultsPerQuery:n}=e,a=ks(_d()),i=await oR(r,o,n,a),c=new or({...t,analyticsAction:a},l=>{t.dispatch(Oa({q:l,id:e.id}));}),u=await c.fetchFromAPI(i,{origin:"instantResults",disableAbortWarning:!0}),s=await c.process(u);return "response"in s?{results:s.response.results,searchUid:s.response.searchUid,totalCountFiltered:s.response.totalCountFiltered,duration:s.duration}:s});var rR=async(e,t)=>{let r=await ue(e,t);return r.request={...r.request,firstResult:(e.pagination?.firstResult??0)+(e.search?.results.length??0)},r},oR=async(e,t,r,o)=>{let n=await Ta(e,o);return so({...n,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},nR=async(e,t)=>{let r=await ue(e,t);return r.request.numberOfResults=0,r},xm=e=>{e.configuration.analytics.enabled&&He.addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)});},ks=e=>({actionCause:e.actionCause,type:e.actionCause});function mo(e,t){let{facetId:r,criterion:o}=t,n=e[r]?.request;n&&(n.sortCriteria=o);}function sn(e){e&&(e.currentValues=e.currentValues.map(t=>({...t,state:"idle"})),e.preventAutoSelect=!0);}function Ja(e,t){e&&(e.numberOfValues=t);}q(ao(),e=>{e.addCase(sa,(t,r)=>{let{facetId:o}=r.payload;o in t||(t[o]=Id(iR(r.payload)));}).addCase(ge.fulfilled,(t,r)=>{if(r.payload&&Object.keys(r.payload.facetSet).length!==0)return r.payload.facetSet}).addCase(Re,(t,r)=>{let o=r.payload.f||{},n=r.payload.fExcluded||{};Object.keys(t).forEach(i=>{let{request:c}=t[i],u=o[i]||[],s=n[i]||[],l=u.length+s.length,d=c.currentValues.filter(p=>!u.includes(p.value)&&!s.includes(p.value));c.currentValues=[...u.map(Rm),...s.map(vm),...d.map(cR)],c.preventAutoSelect=l>0,c.numberOfValues=Math.max(l,c.numberOfValues);});}).addCase(je,(t,r)=>{let{facetId:o,selection:n}=r.payload,a=t[o]?.request;if(!a)return;a.preventAutoSelect=!0;let i=a.currentValues.find(u=>u.value===n.value);if(!i){Xa(a,n);return}let c=i.state==="selected";i.state=c?"idle":"selected",a.freezeCurrentValues=!0;}).addCase($e,(t,r)=>{let{facetId:o,selection:n}=r.payload,a=t[o]?.request;if(!a)return;a.preventAutoSelect=!0;let i=a.currentValues.find(u=>u.value===n.value);if(!i){Xa(a,n);return}let c=i.state==="excluded";i.state=c?"idle":"excluded",a.freezeCurrentValues=!0;}).addCase(Wl,(t,r)=>{let{facetId:o,freezeCurrentValues:n}=r.payload,a=t[o]?.request;a&&(a.freezeCurrentValues=n);}).addCase(ie,(t,r)=>{sn(t[r.payload]?.request);}).addCase(fe,t=>{Object.values(t).filter(r=>r.hasBreadcrumbs).forEach(({request:r})=>sn(r));}).addCase(Ht,t=>{Object.values(t).filter(r=>!r.hasBreadcrumbs).forEach(({request:r})=>sn(r));}).addCase(ft,(t,r)=>Object.values(t).forEach(o=>{o.request.preventAutoSelect=!r.payload.allow;})).addCase(Hl,(t,r)=>{mo(t,r.payload);}).addCase(br,(t,r)=>{let{facetId:o,numberOfValues:n}=r.payload;Ja(t[o]?.request,n);}).addCase(Pr,(t,r)=>{let{facetId:o,isFieldExpanded:n}=r.payload,a=t[o]?.request;a&&(a.isFieldExpanded=n);}).addCase(oe.fulfilled,(t,r)=>{r.payload.response.facets.forEach(n=>Ds(t[n.facetId]?.request,n));}).addCase(Zt.fulfilled,(t,r)=>{(r.payload.response?.facets?.results||[]).forEach(n=>Ds(t[n.facetId]?.request,n));}).addCase(Cm.fulfilled,(t,r)=>{r.payload.response.facets.forEach(n=>Ds(t[n.facetId]?.request,n));}).addCase(At,(t,r)=>{let{facetId:o,value:n}=r.payload,a=t[o]?.request;if(!a)return;let{rawValue:i}=n,{currentValues:c}=a,u=c.find(l=>l.value===i);if(u){u.state="selected";return}let s=Rm(i);Xa(a,s),a.freezeCurrentValues=!0,a.preventAutoSelect=!0;}).addCase(bt,(t,r)=>{let{facetId:o,value:n}=r.payload,a=t[o]?.request;if(!a)return;let{rawValue:i}=n,{currentValues:c}=a,u=c.find(l=>l.value===i);if(u){u.state="excluded";return}let s=vm(i);Xa(a,s),a.freezeCurrentValues=!0,a.preventAutoSelect=!0;}).addCase(It,(t,r)=>{if(!(r.payload in t))return;let{request:o}=t[r.payload];sn(o);});});function Xa(e,t){let{currentValues:r}=e,o=r.findIndex(c=>c.state==="idle"),n=o===-1?r.length:o,a=r.slice(0,n),i=r.slice(n+1);e.currentValues=[...a,t,...i],e.numberOfValues=e.currentValues.length;}function Ds(e,t){e&&(e.currentValues=t.values.map(Vs),e.freezeCurrentValues=!1,e.preventAutoSelect=!1);}var aR={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"automatic",resultsMustMatch:"atLeastOneValue"};function iR(e){return {...aR,type:"specific",currentValues:[],freezeCurrentValues:!1,isFieldExpanded:!1,preventAutoSelect:!1,...e}}function Vs(e){let{value:t,state:r}=e;return {value:t,state:r}}function Rm(e){return {value:e,state:"selected"}}function vm(e){return {value:e,state:"excluded"}}function cR(e){return {...e,state:"idle"}}function un(e){let t=Fm(e.start,e),r=Fm(e.end,e),o=e.endInclusive??!1,n=e.state??"idle";return {start:t,end:r,endInclusive:o,state:n}}function Fm(e,t){let{dateFormat:r}=t;return om(e)?(Ma(e),em(e)):typeof e=="string"&&Nt(e)?(Ma(e),e):(Ps(e,r),Na(co(e,r)))}var ln=f("rangeFacet/updateSortCriterion",e=>h(e,{facetId:Q,criterion:new te({required:!0})}));var kr={state:R,start:new P({required:!0}),end:new P({required:!0}),endInclusive:new V({required:!0}),numberOfResults:new P({required:!0,min:0})},Dr={start:R,end:R,endInclusive:new V({required:!0}),state:R,numberOfResults:new P({required:!0,min:0})},Ns=e=>({facetId:Q,selection:typeof e.start=="string"?new F({values:Dr}):new F({values:kr})});var sR={start:R,end:R,endInclusive:new V({required:!0}),state:R},uR={facetId:Q,field:R,currentValues:new H({required:!1,each:new F({values:sR})}),generateAutomaticRanges:new V({required:!0}),filterFacetCount:new V({required:!1}),injectionDepth:new P({required:!1,min:0}),numberOfValues:new P({required:!1,min:1}),sortCriteria:new te({required:!1}),rangeAlgorithm:new te({required:!1})};function Am(e){return Nt(e)?cn(e):e}function Ms(e){e.currentValues&&e.currentValues.forEach(t=>{let{start:r,end:o}=un(t);if(co(Am(r)).isAfter(co(Am(o))))throw new Error(`The start value is greater than the end value for the date range ${t.start} to ${t.end}`)});}var dn=f("dateFacet/register",e=>{try{return Be(e,uR),Ms(e),{payload:e,error:null}}catch(t){return {payload:e,error:nt(t)}}}),Ke=f("dateFacet/toggleSelectValue",e=>h(e,{facetId:Q,selection:new F({values:Dr})})),Ye=f("dateFacet/toggleExcludeValue",e=>h(e,{facetId:Q,selection:new F({values:Dr})})),Za=f("dateFacet/updateFacetValues",e=>{try{return Be(e,{facetId:Q,values:new H({each:new F({values:Dr})})}),Ms({currentValues:e.values}),{payload:e,error:null}}catch(t){return {payload:e,error:nt(t)}}}),bm=ln,Pm=ie;var ti={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"ascending",rangeAlgorithm:"even",resultsMustMatch:"atLeastOneValue"};function ri(e,t){let{request:r}=t,{facetId:o}=r;if(o in e)return;let n=Im(r);r.numberOfValues=n,e[o]=t;}function oi(e,t,r){let o=e[t]?.request;o&&(o.currentValues=r,o.numberOfValues=Im(o));}function ni(e,t,r){let o=e[t]?.request;if(!o)return;let n=ei(o.currentValues,r);if(!n)return;let a=n.state==="selected";n.state=a?"idle":"selected",o.preventAutoSelect=!0;}function ai(e,t,r){let o=e[t]?.request;if(!o)return;let n=ei(o.currentValues,r);if(!n)return;let a=n.state==="excluded";n.state=a?"idle":"excluded",o.preventAutoSelect=!0;}function nr(e,t){let r=e[t]?.request;r&&r.currentValues.forEach(o=>o.state="idle");}function ii(e,t){Object.entries(e).forEach(([r,{request:o}])=>{let n=t[r]||[];o.currentValues.forEach(c=>{let u=!!ei(n,c);return c.state=u?"selected":"idle",c});let a=n.filter(c=>!ei(o.currentValues,c)),i=o.currentValues;i.push(...a),o.numberOfValues=Math.max(o.numberOfValues,i.length);});}function po(e,t,r){t.forEach(o=>{let n=o.facetId,a=e[n]?.request;if(!a)return;let i=r(o.values);a.currentValues=i,a.preventAutoSelect=!1;});}function ei(e,t){let{start:r,end:o}=t;return e.find(n=>n.start===r&&n.end===o)}function mn(e,t){let{start:r,end:o,endInclusive:n}=t;return e.find(a=>a.start===r&&a.end===o&&a.endInclusive===n)}function Im(e){let{generateAutomaticRanges:t,currentValues:r,numberOfValues:o}=e;return t?Math.max(o,r.length):r.length}q(oo(),e=>{e.addCase(dn,(t,r)=>{let{payload:o}=r,n=dR(o);ri(t,bd(n));}).addCase(ge.fulfilled,(t,r)=>r.payload?.dateFacetSet??t).addCase(Re,(t,r)=>{let o=r.payload.df||{};ii(t,o);}).addCase(Ke,(t,r)=>{let{facetId:o,selection:n}=r.payload;ni(t,o,n);}).addCase(Ye,(t,r)=>{let{facetId:o,selection:n}=r.payload;ai(t,o,n);}).addCase(Za,(t,r)=>{let{facetId:o,values:n}=r.payload;oi(t,o,n);}).addCase(Pm,(t,r)=>{nr(t,r.payload);}).addCase(fe,t=>{Object.keys(t).forEach(r=>{nr(t,r);});}).addCase(bm,(t,r)=>{mo(t,r.payload);}).addCase(oe.fulfilled,(t,r)=>{let o=r.payload.response.facets;po(t,o,ci);}).addCase(Zt.fulfilled,(t,r)=>{let o=r.payload.response?.facets?.results||[];po(t,o,ci);}).addCase(It,(t,r)=>{nr(t,r.payload);});});function dR(e){return {...ti,currentValues:[],preventAutoSelect:!1,type:"dateRange",...e}}function ci(e){return e.map(t=>{let{numberOfResults:r,...o}=t;return o})}var mR={state:R,start:new P({required:!0}),end:new P({required:!0}),endInclusive:new V({required:!0})},pR={facetId:Q,field:R,currentValues:new H({required:!1,each:new F({values:mR})}),generateAutomaticRanges:new V({required:!0}),filterFacetCount:new V({required:!1}),injectionDepth:new P({required:!1,min:0}),numberOfValues:new P({required:!1,min:1}),sortCriteria:new te({required:!1}),rangeAlgorithm:new te({required:!1})};function Ls(e){e.currentValues&&e.currentValues.forEach(({start:t,end:r})=>{if(t>r)throw new Error(`The start value is greater than the end value for the numeric range ${t} to ${r}`)});}var pn=f("numericFacet/register",e=>{try{return h(e,pR),Ls(e),{payload:e,error:null}}catch(t){return {payload:e,error:nt(t)}}}),Te=f("numericFacet/toggleSelectValue",e=>h(e,{facetId:Q,selection:new F({values:kr})})),ke=f("numericFacet/toggleExcludeValue",e=>h(e,{facetId:Q,selection:new F({values:kr})})),ar=f("numericFacet/updateFacetValues",e=>{try{return Be(e,{facetId:Q,values:new H({each:new F({values:kr})})}),Ls({currentValues:e.values}),{payload:e,error:null}}catch(t){return {payload:e,error:nt(t)}}}),wm=ln,Em=ie;q(no(),e=>{e.addCase(pn,(t,r)=>{let{payload:o}=r,n=fR(o);ri(t,Pd(n));}).addCase(ge.fulfilled,(t,r)=>r.payload?.numericFacetSet??t).addCase(Re,(t,r)=>{let o=r.payload.nf||{};ii(t,o);}).addCase(Te,(t,r)=>{let{facetId:o,selection:n}=r.payload;ni(t,o,n);}).addCase(ke,(t,r)=>{let{facetId:o,selection:n}=r.payload;ai(t,o,n);}).addCase(ar,(t,r)=>{let{facetId:o,values:n}=r.payload;oi(t,o,n);}).addCase(Em,(t,r)=>{nr(t,r.payload);}).addCase(fe,t=>{Object.keys(t).forEach(r=>{nr(t,r);});}).addCase(wm,(t,r)=>{mo(t,r.payload);}).addCase(oe.fulfilled,(t,r)=>{let o=r.payload.response.facets;po(t,o,fn);}).addCase(Zt.fulfilled,(t,r)=>{let o=r.payload.response?.facets?.results||[];po(t,o,fn);}).addCase(It,(t,r)=>{nr(t,r.payload);});});function fR(e){return {...ti,currentValues:[],preventAutoSelect:!1,type:"numericalRange",...e}}function fn(e){return e.map(t=>{let{numberOfResults:r,...o}=t;return o})}var Tm=new F({options:{required:!1},values:{by:new ot({enum:ct,required:!0}),fields:new H({each:new F({values:{field:new C({required:!0}),direction:new ot({enum:io}),displayName:new C}})})}});var st=async e=>({...await gn(e),facets:hR(e),...e.commerceSort&&{sort:yR(e.commerceSort.appliedSort)}}),gn=async(e,t)=>{let{view:r,user:o,...n}=e.commerceContext;return {accessToken:e.configuration.accessToken,url:e.configuration.platformUrl,organizationId:e.configuration.organizationId,trackingId:e.configuration.analytics.trackingId,...n,clientId:await Ae(e.configuration.analytics),context:{user:o,view:r,cart:ea(e.cart)},...gR(e,t)}},gR=(e,t)=>{let r=t?e.commercePagination?.recommendations[t]:e.commercePagination?.principal;return r&&{page:r.page,...r.perPage&&{perPage:r.perPage}}};function hR(e){return !e.facetOrder||!e.commerceFacetSet?[]:e.facetOrder.map(t=>e.commerceFacetSet[t].request).filter(t=>t.values.length>0)}function yR(e){return e.by==="relevance"?{sortCriteria:"relevance"}:{sortCriteria:"fields",fields:e.fields.map(({name:t,direction:r})=>({field:t,direction:r}))}}var fo=D(e=>e.commercePagination?.principal.perPage||0,e=>e),km=D((e,t)=>e.commercePagination?.recommendations[t]?.perPage||0,e=>e),go=D(e=>e.commercePagination?.principal.totalEntries||0,e=>e),Dm=D((e,t)=>e.commercePagination?.recommendations[t]?.totalEntries||0,e=>e),Vm=D(e=>e.commercePagination?.principal.page||0,e=>e);D((e,t)=>e.commercePagination?.recommendations[t]?.page||0,e=>e);var si=D(e=>e.productListing.responseId,e=>e),Nm=D(e=>e.productListing.requestId,e=>e),hn=D(e=>e.productListing?.products.length||0,e=>e),Mm=D(e=>({total:go(e),current:hn(e)}),({current:e,total:t})=>e<t),Lm=D(e=>e.productListing?.isLoading,e=>M(e)?!1:e),Um=D(e=>e.productListing?.error,e=>e);var ae=T("commerce/productListing/fetch",async(e,{getState:t,dispatch:r,rejectWithValue:o,extra:n})=>{let a=t(),{apiClient:i}=n,c=await i.getProductListing(await st(a));return ve(c)?(r(xe(c.error)),o(c.error)):{response:c.success}}),ho=T("commerce/productListing/fetchMoreProducts",async(e,{getState:t,dispatch:r,rejectWithValue:o,extra:n})=>{let a=t();if(!Mm(a))return null;let{apiClient:c}=n,u=fo(a),l=hn(a)/u,d=await c.getProductListing({...await st(a),page:l});return ve(d)?(r(xe(d.error)),o(d.error)):{response:d.success}});var Mt=f("query/updateQuery",e=>h(e,{query:new C}));var yn=D(e=>e.commerceSearch.responseId,e=>e),Qm=D(e=>e.commerceSearch.requestId,e=>e),Sn=D(e=>e.commerceSearch?.products.length||0,e=>e),Bm=D(e=>({total:go(e),current:Sn(e)}),({current:e,total:t})=>e<t),_m=D(e=>e.commerceSearch?.isLoading,e=>M(e)?!1:e),jm=D(e=>e.commerceSearch?.error,e=>e),ui=D(e=>e.commerceQuery?.query,e=>e??""),$m=D(e=>e.commerceSearch?.queryExecuted,e=>e),Us=(e,t)=>t.queryCorrection?.correctedQuery!==void 0?t.queryCorrection?.correctedQuery:ui(e);var G=T("commerce/search/executeSearch",async(e,{getState:t,dispatch:r,rejectWithValue:o,extra:n})=>{let a=t(),{apiClient:i}=n,c=ui(a),u=await i.search({...await st(a),query:c});return ve(u)?(r(xe(u.error)),o(u.error)):{response:u.success,originalQuery:c,queryExecuted:Us(a,u.success)}}),yo=T("commerce/search/fetchMoreProducts",async(e,{getState:t,dispatch:r,rejectWithValue:o,extra:n})=>{let a=t();if(!Bm(a))return null;let{apiClient:c}=n,u=fo(a),l=Sn(a)/u,d=ui(a),p=await c.search({...await st(a),query:d,page:l});return ve(p)?(r(xe(p.error)),o(p.error)):{response:p.success,originalQuery:d,queryExecuted:Us(a,p.success)}}),li=T("commerce/search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;h(e,{query:new C,clearFilters:new V}),e.clearFilters&&(r(fe()),r(Ht())),r(ft({allow:!0})),r(Mt({query:e.query})),r(gt(1));}),So=T("commerce/search/fetchInstantProducts",async(e,{getState:t,dispatch:r,rejectWithValue:o,extra:n})=>{let a=t(),{q:i}=e,{apiClient:c}=n,u=await c.productSuggestions({...await st(a),query:i});if(ve(u))return r(xe(u.error)),o(u.error);let s=u.success.products.slice(0,5);return {response:{...u.success,products:s}}});var zm=async(e,t,r)=>{let n=`*${t.categoryFacetSearchSet[e].options.query}*`,a=t.commerceFacetSet[e]?.request,i=a&&SR(a)?a&&CR(a):[],c=i.length?[i]:[],u=t.commerceQuery?.query,{url:s,accessToken:l,organizationId:d,trackingId:p,language:m,country:g,currency:x,clientId:v,context:E,...k}=await st(t);return {url:s,accessToken:l,organizationId:d,facetId:e,facetQuery:n,ignorePaths:c,trackingId:p,language:m,country:g,currency:x,clientId:v,context:E,...!r&&{...k,query:u}}};function SR(e){return e.type==="hierarchical"}var CR=e=>{let t=[],r=e.values[0];for(;r;)t.push(r.value),r=r.children[0];return t};var Hm=async(e,t,r)=>{let n=`*${t.facetSearchSet[e].options.query}*`,a=t.commerceQuery?.query;a===void 0&&(a="");let{url:i,accessToken:c,organizationId:u,trackingId:s,language:l,country:d,currency:p,clientId:m,context:g,...x}=await st(t);return {url:i,accessToken:c,organizationId:u,facetId:e,facetQuery:n,trackingId:s,language:l,country:d,currency:p,clientId:m,context:g,...!r&&{...x,query:a}}};var Wm=e=>async(t,{getState:r,extra:{apiClient:o,validatePayload:n}})=>{let a=r();n(t,R);let i=xR(a,t)||RR(a,t)?Hm(t,a,e):zm(t,a,e),c=await o.facetSearch(await i);return {facetId:t,response:c}},Ge=T("commerce/facetSearch/executeSearch",Wm(!1)),De=T("commerce/facetSearch/facetFieldSuggest",Wm(!1)),xR=(e,t)=>"facetSearchSet"in e&&e.facetSearchSet[t]!==void 0&&e.commerceFacetSet[t]!==void 0,RR=(e,t)=>"fieldSuggestionsOrder"in e?e.fieldSuggestionsOrder.some(r=>r.facetId===t&&r.type==="regular"):!1;function Km(e,t){let{facetId:r,numberOfValues:o}=t,n=e[r]?.request.values[0];if(n){for(;n.children.length&&n?.state!=="selected";)n=n.children[0];n.retrieveCount=o;}}function Ym(){return {}}var Je=q(Ym(),e=>{e.addCase(ae.fulfilled,Jm).addCase(G.fulfilled,Jm).addCase(De.fulfilled,vR).addCase(je,(t,r)=>{let{facetId:o,selection:n}=r.payload,a=t[o]?.request;if(!a||!Qs(a))return;a.preventAutoSelect=!0;let i=a.values.find(c=>c.value===n.value);if(!i){cr(a,n);return}ir(i,"select");}).addCase(Te,(t,r)=>{let{facetId:o,selection:n}=r.payload,a=t[o]?.request;if(!a||!Bs(a))return;a.preventAutoSelect=!0;let i=mn(a.values,n);if(!i){cr(a,n);return}if(ir(i,"select"),a.interval==="continuous"&&i.state==="idle"){a.values=[];return}}).addCase(Ke,(t,r)=>{let{facetId:o,selection:n}=r.payload,a=t[o]?.request;if(!a||!Gm(a))return;a.preventAutoSelect=!0;let i=mn(a.values,n);if(!i){cr(a,n);return}ir(i,"select");}).addCase(Wt,(t,r)=>{let{facetId:o,selection:n,retrieveCount:a}=r.payload,i=t[o]?.request;if(!i||!js(i))return;let{path:c}=n,u=c.slice(0,c.length-1),s=AR(i,u,a);if(s.length){let d=s[0];d.state="selected",d.children=[];return}let l=di(n.value,a);l.state="selected",s.push(l),i.numberOfValues=1;}).addCase($e,(t,r)=>{let{facetId:o,selection:n}=r.payload,a=t[o]?.request;if(!a||!Qs(a))return;a.preventAutoSelect=!0;let i=a.values.find(c=>c.value===n.value);if(!i){cr(a,n);return}ir(i,"exclude");}).addCase(ke,(t,r)=>{let{facetId:o,selection:n}=r.payload,a=t[o]?.request;if(!a||!Bs(a))return;a.preventAutoSelect=!0;let i=mn(a.values,n);if(!i){cr(a,n);return}if(ir(i,"exclude"),a.interval==="continuous"&&i.state==="idle"){a.values=[];return}}).addCase(Ye,(t,r)=>{let{facetId:o,selection:n}=r.payload,a=t[o]?.request;if(!a||!Gm(a))return;a.preventAutoSelect=!0;let i=mn(a.values,n);if(!i){cr(a,n);return}ir(i,"exclude");}).addCase(zo,(t,r)=>{let{facetId:o,numberOfValues:n}=r.payload,a=t[o]?.request;if(a){if(!a.values.length)return Ja(a,n);Km(t,r.payload);}}).addCase(At,(t,r)=>{let{facetId:o,value:n}=r.payload,a=t[o]?.request;if(!a||!Qs(a))return;let{rawValue:i}=n;a.preventAutoSelect=!0;let c=a.values.find(u=>u.value===i);if(!c){cr(a,{state:"selected",value:i});return}ir(c,"select");}).addCase(bt,(t,r)=>{let{facetId:o,value:n}=r.payload,a=t[o]?.request;if(!a||a.type!=="regular"&&a.type!=="hierarchical")return;let{rawValue:i}=n;a.preventAutoSelect=!0;let c=a.values.find(u=>u.value===i);if(!c){cr(a,{state:"excluded",value:i});return}ir(c,"exclude");}).addCase(Yr,(t,r)=>{let{facetId:o,value:n}=r.payload,a=t[o];if(!a||!js(a?.request))return;let i=[...n.path,n.rawValue];wR(a.request,i,a.request.initialNumberOfValues);}).addCase(ar,(t,r)=>{let{facetId:o,values:n}=r.payload,a=t[o]?.request;!a||!Bs(a)||(a.values=fn(n),a.numberOfValues=n.length);}).addCase(br,(t,r)=>{let{facetId:o,numberOfValues:n}=r.payload,a=t[o]?.request;a&&(a.numberOfValues=n);}).addCase(Pr,(t,r)=>{let{facetId:o,isFieldExpanded:n}=r.payload,a=t[o]?.request;a&&(a.isFieldExpanded=n);}).addCase(ft,(t,r)=>Object.values(t).forEach(o=>{o.request.preventAutoSelect=!r.payload.allow;})).addCase(ie,(t,r)=>{let o=r.payload,n=t[o]?.request;n&&FR(n);}).addCase(fe,IR).addCase(we,_s).addCase(_e,_s).addCase(mt,_s);});function Qs(e){return e.type==="regular"}function Bs(e){return e.type==="numericalRange"}function Gm(e){return e.type==="dateRange"}function js(e){return e.type==="hierarchical"}function Jm(e,t){let r=new Set(Object.keys(e)),o=t.payload.response.facets;for(let n of o)bR(e,n,r);for(let n of r)delete e[n];}function vR(e,t){let r=t.payload.facetId,o=e[r]?.request;o||(e[r]={request:{}},o=e[r].request,o.initialNumberOfValues=10);}function FR(e){e.type==="hierarchical"?(e.numberOfValues=e.initialNumberOfValues,e.values=[],e.preventAutoSelect=!0):e.values.forEach(t=>t.state="idle");}function AR(e,t,r){let o=e.values;for(let n of t){let a=o[0];(!a||n!==a.value)&&(a=di(n,r),o.length=0,o.push(a)),a.state="idle",o=a.children;}return o}function di(e,t){return {children:[],state:"idle",value:e,retrieveCount:t}}function ir(e,t){switch(e.state){case"idle":e.state=t==="exclude"?"excluded":"selected";break;case"excluded":e.state=t==="exclude"?"idle":"selected";break;case"selected":e.state=t==="exclude"?"excluded":"idle";break;}}function bR(e,t,r){let o=t.facetId??t.field,n=e[o]?.request;n?r.delete(o):(e[o]={request:{}},n=e[o].request,n.initialNumberOfValues=t.numberOfValues),n.facetId=o,n.displayName=t.displayName,n.numberOfValues=t.numberOfValues,n.field=t.field,n.type=t.type,n.values=PR(t)??[],n.preventAutoSelect=!1,t.type==="hierarchical"&&js(n)?n.delimitingCharacter=t.delimitingCharacter:t.type==="numericalRange"&&(n.interval=t.interval,t.domain&&(n.domain={min:t.domain.min,max:t.domain.max,increment:t.domain.increment}));}function PR(e){switch(e.type){case"numericalRange":return fn(e.values);case"dateRange":return ci(e.values);case"hierarchical":return e.values.every(t=>t.state==="idle"&&t.children.length===0)?[]:e.values.map(Xm);case"regular":return e.values.map(Vs);default:return}}function Xm(e){let t=e.children.every(n=>n.state==="idle"&&n.children.length===0)?[]:e.children.map(Xm),{state:r,value:o}=e;return {children:t,state:r,value:o,retrieveCount:Kr}}function cr(e,t){let{values:r}=e,o=r.findIndex(c=>c.state==="idle"),n=o===-1?r.length:o,a=r.slice(0,n),i=r.slice(n+1);e.values=[...a,t,...i],e.numberOfValues=e.values.length;}function IR(e){Object.values(e).forEach(t=>{t.request.values.forEach(r=>r.state="idle");});}function _s(e){Object.values(e).forEach(t=>{t.request.values=[];});}function wR(e,t,r){e.values=ER(t,r),e.numberOfValues=t.length?1:r,e.preventAutoSelect=!0;}function ER(e,t){if(!e.length)return [];let r=di(e[0],t),o=r;for(let n of e.splice(1)){let a=di(n,t);o.children.push(a),o=a;}return o.state="selected",[r]}var $s={slotId:R,productId:new C({required:!1,emptyAllowed:!1})},Zm=new z($s);var zs=D((e,t)=>e.recommendations&&e.recommendations[t]?.products.length||0,e=>e),ep=D((e,t)=>({total:Dm(e,t),current:zs(e,t)}),({current:e,total:t})=>e<t);D((e,t)=>e.recommendations?e.recommendations[t]?.isLoading:!1,e=>M(e)?!1:e);var tp=async(e,t,r)=>{let o=await gn(t,e);return {...o,context:{...o.context,...r?{product:{productId:r}}:{},purchased:Nl(t.cart)},slotId:e}},Lt=T("commerce/recommendations/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:o}})=>{let{slotId:n,productId:a}=e,i=await tp(n,t(),a),c=await o.getRecommendations(i);return ve(c)?r(c.error):{response:c.success}}),Co=T("commerce/recommendations/fetchMore",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:o}})=>{let n=e.slotId,a=t();if(ep(a,n))return null;let c=km(a,n),s=zs(a,n)/c,l={...await tp(n,a),page:s},d=await o.getRecommendations(l);return ve(d)?r(d.error):{response:d.success}}),mi=f("commerce/recommendations/registerSlot",e=>h(e,$s));var pi={slotId:Yn},OR={...pi,pageSize:new P({required:!0,min:0})},Cn=f("commerce/pagination/setPageSize",e=>h(e,OR)),qR={...pi,page:new P({required:!0,min:0})},fi=f("commerce/pagination/selectPage",e=>h(e,qR)),gi=f("commerce/pagination/nextPage",e=>h(e,pi)),hi=f("commerce/pagination/previousPage",e=>h(e,pi)),yi=f("commerce/pagination/registerRecommendationsSlot",e=>h(e,{slotId:R}));function rp(){return {principal:Si(),recommendations:{}}}function Si(){return {page:0,totalEntries:0,totalPages:0}}var xi=q(rp(),e=>{e.addCase(gi,(t,r)=>{let o=Ci(t,r.payload?.slotId);o&&o.page<o.totalPages-1&&++o.page;}).addCase(hi,(t,r)=>{let o=Ci(t,r.payload?.slotId);o&&o.page>0&&--o.page;}).addCase(fi,(t,r)=>{let o=Ci(t,r.payload.slotId);o&&r.payload.page>=0&&r.payload.page<o.totalPages&&(o.page=r.payload.page);}).addCase(Cn,(t,r)=>{let o=Ci(t,r.payload.slotId);o&&(o.perPage=r.payload.pageSize);}).addCase(ae.fulfilled,(t,r)=>{t.principal=r.payload.response.pagination;}).addCase(G.fulfilled,(t,r)=>{t.principal=r.payload.response.pagination;}).addCase(Lt.fulfilled,(t,r)=>{t.recommendations[r.meta.arg.slotId]=r.payload.response.pagination;}).addCase(yi,(t,r)=>{let o=r.payload.slotId;o in t||(t.recommendations[o]=Si());}).addCase(ie,sr).addCase(je,sr).addCase($e,sr).addCase(Te,sr).addCase(ke,sr).addCase(we,sr).addCase(_e,sr).addCase(mt,sr);});function Ci(e,t){return t?e.recommendations[t]:e.principal}function sr(e){e.principal.page=Si().page;}var op=()=>({error:null,isLoading:!1,requestId:"",responseId:"",facets:[],products:[]});var ur=q(op(),e=>{e.addCase(ae.rejected,(t,r)=>{np(t,r.payload);}).addCase(ho.rejected,(t,r)=>{np(t,r.payload);}).addCase(ae.fulfilled,(t,r)=>{ap(t,r.payload.response),t.products=r.payload.response.products;}).addCase(ho.fulfilled,(t,r)=>{r.payload&&(ap(t,r.payload.response),t.products=t.products.concat(r.payload.response.products));}).addCase(ae.pending,(t,r)=>{ip(t,r.meta.requestId);}).addCase(ho.pending,(t,r)=>{ip(t,r.meta.requestId);});});function np(e,t){e.error=t||null,e.isLoading=!1;}function ap(e,t){e.error=null,e.facets=t.facets,e.responseId=t.responseId,e.isLoading=!1;}function ip(e,t){e.isLoading=!0,e.requestId=t;}var Ri={q:new C},vi={};var xo=f("commerce/searchParameters/restore",e=>h(e,Ri)),cp=f("commerce/productListingParameters/restore",e=>h(e,vi));var xn=()=>({query:""});var Xe=q(xn(),e=>{e.addCase(Mt,(t,r)=>({...t,...r.payload})).addCase(xo,(t,r)=>{t.query=r.payload.q??"";});});var sp=()=>({}),up=()=>({headline:"",error:null,isLoading:!1,responseId:"",products:[]});var Fi=q(sp(),e=>{e.addCase(mi,(t,r)=>{let o=r.payload.slotId;o in t||(t[o]=TR());}).addCase(Lt.rejected,(t,r)=>{lp(t,r.meta.arg.slotId,r.payload);}).addCase(Co.rejected,(t,r)=>{lp(t,r.meta.arg.slotId,r.payload);}).addCase(Lt.fulfilled,(t,r)=>{let o=r.meta.arg.slotId,n=r.payload.response;dp(t,o,n);let a=t[o];a&&(a.products=n.products);}).addCase(Co.fulfilled,(t,r)=>{if(!r.payload)return;let o=r.meta.arg.slotId,n=r.payload.response;dp(t,o,n);let a=t[o];a&&(a.products=a.products.concat(n.products));}).addCase(Lt.pending,(t,r)=>{mp(t,r.meta.arg.slotId);}).addCase(Co.pending,(t,r)=>{mp(t,r.meta.arg.slotId);});});function TR(e){return {...up(),...e}}function lp(e,t,r){let o=e[t];o&&(o.error=r??null,o.isLoading=!1);}function dp(e,t,r){let o=e[t];o&&(o.error=null,o.headline=r.headline,o.responseId=r.responseId,o.isLoading=!1);}function mp(e,t){let r=e[t];r&&(r.isLoading=!0);}var pp=()=>({error:null,isLoading:!1,requestId:"",responseId:"",products:[],facets:[],queryExecuted:""});var St=q(pp(),e=>{e.addCase(G.rejected,(t,r)=>{fp(t,r.payload);}).addCase(yo.rejected,(t,r)=>{fp(t,r.payload);}).addCase(G.fulfilled,(t,r)=>{hp(t,r.payload.response,r.payload.queryExecuted),t.products=r.payload.response.products;}).addCase(yo.fulfilled,(t,r)=>{r.payload&&(hp(t,r.payload.response,r.payload.queryExecuted),t.products=t.products.concat(r.payload.response.products));}).addCase(G.pending,(t,r)=>{gp(t,r.meta.requestId);}).addCase(yo.pending,(t,r)=>{gp(t,r.meta.requestId);});});function fp(e,t){e.error=t||null,e.isLoading=!1;}function gp(e,t){e.isLoading=!0,e.requestId=t;}function hp(e,t,r){e.error=null,e.facets=t.facets,e.responseId=t.responseId,e.isLoading=!1,e.queryExecuted=r??"";}var Rn=f("commerce/sort/apply",e=>h(e,{by:new ot({enum:ct,required:!0})}));function vn(){return {appliedSort:Xt(),availableSorts:[Xt()]}}var yp=e=>e.sortCriteria==="relevance"?Xt():{by:"fields",fields:(e.fields||[]).map(({field:t,direction:r,displayName:o})=>({name:t,direction:r,displayName:o}))},Ai=q(vn(),e=>{e.addCase(Rn,(t,r)=>{t.appliedSort=r.payload;}).addCase(ae.fulfilled,Sp).addCase(G.fulfilled,Sp).addCase(we,vn).addCase(_e,vn).addCase(mt,vn);});function Sp(e,t){let r=t.payload.response;e.appliedSort=yp(r.sort.appliedSort),e.availableSorts=r.sort.availableSorts.map(yp);}function Cp(e){return e.query="",e.queryModification={originalQuery:"",newQuery:"",queryToIgnore:e.queryModification.queryToIgnore},e}function xp(e,t){let r=[],o=[],n=[],a=[];return t.forEach(i=>{switch(i.type){case"redirect":r.push(i.content);break;case"query":o.push(i.content);break;case"execute":n.push({functionName:i.content.name,params:i.content.params});break;case"notify":a.push(i.content);break}}),e.redirectTo=r[0]??"",e.query=e.queryModification.newQuery,e.executions=n,e.notifications=a,e}function Rp(e,t){return e.queryModification={...t,queryToIgnore:""},e}function vp(e,t){return e.queryModification.queryToIgnore=t,e}var Fp=()=>({redirectTo:"",query:"",executions:[],notifications:[],queryModification:{originalQuery:"",newQuery:"",queryToIgnore:""}});var Ap=f("commerce/trigger/query/ignore",e=>h(e,new C({emptyAllowed:!0,required:!0}))),bp=f("commerce/trigger/query/modification",e=>h(e,new F({values:{originalQuery:X,modification:X}})));var bi=q(Fp(),e=>e.addCase(G.pending,Cp).addCase(G.fulfilled,(t,r)=>xp(t,r.payload.response.triggers)).addCase(bp,(t,r)=>Rp(t,r.payload)).addCase(Ap,(t,r)=>vp(t,r.payload)));var Ro=q(ja(),e=>{e.addCase(oe.fulfilled,Hs).addCase(ae.fulfilled,Hs).addCase(G.fulfilled,Hs).addCase(ge.fulfilled,(t,r)=>r.payload?.facetOrder??t);});function Hs(e,t){return t.payload.response.facets.map(r=>r.facetId)}var Vr={id:R},Nr=f("querySuggest/register",e=>h(e,{...Vr,count:new P({min:0})})),Pp=f("querySuggest/unregister",e=>h(e,Vr)),ut=f("querySuggest/selectSuggestion",e=>h(e,{...Vr,expression:pe})),Ut=f("querySuggest/clear",e=>h(e,Vr)),Pi=T("querySuggest/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:o,validatePayload:n}})=>{n(e,Vr);let a=e.id,i=await kR(a,t()),c=await o.querySuggest(i);return We(c)?r(c.error):{id:a,q:i.q,...c.success}}),kR=async(e,t)=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl,count:t.querySuggest[e].count,q:t.querySet[e],locale:t.configuration.search.locale,timezone:t.configuration.search.timezone,actionsHistory:t.configuration.analytics.enabled?He.getHistory():[],...t.context&&{context:t.context.contextValues},...t.pipeline&&{pipeline:t.pipeline},...t.searchHub&&{searchHub:t.searchHub},tab:t.configuration.analytics.originLevel2,...t.configuration.analytics.enabled&&{visitorId:await Ae(t.configuration.analytics),...t.configuration.analytics.enabled&&await er(t.configuration.analytics)},...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")}});var Ve=T("commerce/querySuggest/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:o,validatePayload:n}})=>{n(e,Vr);let a=t(),i=await DR(e.id,a),c=await o.querySuggest(i);return ve(c)?r(c.error):{id:e.id,query:i.query,...c.success}}),DR=async(e,t)=>{let{view:r,user:o,...n}=t.commerceContext;return {accessToken:t.configuration.accessToken,url:t.configuration.platformUrl,organizationId:t.configuration.organizationId,trackingId:t.configuration.analytics.trackingId,query:t.querySet[e],...n,clientId:await Ae(t.configuration.analytics),context:{user:o,view:r,cart:ea(t.cart)}}};function Fn(e,t,r){let{facetId:o}=t;if(e[o])return;let n=!1,a={...lr,...t},i=r();e[o]={options:a,isLoading:n,response:i,initialNumberOfValues:a.numberOfValues,requestId:""};}function Ii(e,t){let{facetId:r,...o}=t,n=e[r];n&&(n.options={...n.options,...o});}function dr(e,t,r){let o=e[t];o&&(o.requestId=r,o.isLoading=!0);}function mr(e,t){let r=e[t];r&&(r.isLoading=!1);}function wi(e,t,r){let{facetId:o,response:n}=t,a=e[o];a&&a.requestId===r&&(a.isLoading=!1,a.response=n);}function Ei(e,t,r){let{facetId:o,response:n}=t,a=e[o];a&&a.requestId===r&&(a.isLoading=!1,"success"in n&&(a.response=n.success));}function Oi(e,t,r,o){let{facetId:n,response:a}=t,i=e[n];if(!i)Fn(e,{facetId:n},o),i=e[n];else if(i.requestId!==r)return;i.isLoading=!1,"success"in a&&(i.response=a.success);}function Ip(e,t,r,o){if(t.fieldSuggestionsFacets)for(let n of t.fieldSuggestionsFacets)n.facetId in e||n.type!=="regular"||(e[n.facetId]={options:{...lr,query:t.query??""},isLoading:!1,response:o(),initialNumberOfValues:lr.numberOfValues,requestId:r});}function wp(e,t,r,o){if(t.fieldSuggestionsFacets)for(let n of t.fieldSuggestionsFacets)n.facetId in e||n.type!=="hierarchical"||(e[n.facetId]={options:{...lr,query:t.query??""},isLoading:!1,response:o(),initialNumberOfValues:lr.numberOfValues,requestId:r});}function An(e,t,r){let{facetId:o}=t,n=e[o];n&&(n.requestId="",n.isLoading=!1,n.response=r(),n.options.numberOfValues=n.initialNumberOfValues,n.options.query=lr.query);}function Qt(e,t){Object.keys(e).forEach(r=>An(e,{facetId:r},t));}var lr={captions:{},numberOfValues:10,query:""};var Ep=async(e,t,r)=>{let o=t.categoryFacetSearchSet[e].options,n=t.categoryFacetSet[e].request,{captions:a,query:i,numberOfValues:c}=o,{field:u,delimitingCharacter:s,basePath:l,filterFacetCount:d}=n,p=VR(n),m=p.length?[p]:[],g=`*${i}*`;return {url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")},basePath:l,captions:a,numberOfValues:c,query:g,field:u,delimitingCharacter:s,ignorePaths:m,filterFacetCount:d,type:"hierarchical",...r?{}:{searchContext:(await ue(t)).request}}},VR=e=>{let t=[],r=e.currentValues[0];for(;r;)t.push(r.value),r=r.children[0];return t};var Op=async(e,t,r)=>{let{captions:o,query:n,numberOfValues:a}=t.facetSearchSet[e].options,{field:i,currentValues:c,filterFacetCount:u}=t.facetSet[e].request,s=c.filter(d=>d.state!=="idle").map(d=>d.value),l=`*${n}*`;return {url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders&&{authentication:t.configuration.search.authenticationProviders.join(",")},captions:o,numberOfValues:a,query:l,field:i,ignoreValues:s,filterFacetCount:u,type:"specific",...r?{}:{searchContext:(await ue(t)).request}}};var qp=e=>async(t,{getState:r,extra:{apiClient:o,validatePayload:n}})=>{let a=r(),i;n(t,R),NR(a,t)?i=await Op(t,a,e):i=await Ep(t,a,e);let c=await o.facetSearch(i);return {facetId:t,response:c}},pr=T("facetSearch/executeSearch",qp(!1));T("facetSearch/executeSearch",qp(!0));var vo=f("facetSearch/clearResults",e=>h(e,{facetId:Q})),NR=(e,t)=>e.facetSearchSet!==void 0&&e.facetSet!==void 0&&e.facetSet[t]!==void 0;function Tp(){return {}}var qi=q(Tp(),e=>{e.addCase(ta,(t,r)=>{let o=r.payload;Fn(t,o,Mr);}).addCase(Kt,(t,r)=>{Ii(t,r.payload);}).addCase(Ge.pending,(t,r)=>{let o=r.meta.arg;dr(t,o,r.meta.requestId);}).addCase(De.pending,(t,r)=>{let o=r.meta.arg;dr(t,o,r.meta.requestId);}).addCase(pr.pending,(t,r)=>{let o=r.meta.arg;dr(t,o,r.meta.requestId);}).addCase(Ge.rejected,(t,r)=>{let o=r.meta.arg;mr(t,o);}).addCase(De.rejected,(t,r)=>{let o=r.meta.arg;mr(t,o);}).addCase(pr.rejected,(t,r)=>{let o=r.meta.arg;mr(t,o);}).addCase(Ge.fulfilled,(t,r)=>{Ei(t,r.payload,r.meta.requestId);}).addCase(De.fulfilled,(t,r)=>{Oi(t,r.payload,r.meta.requestId,Mr);}).addCase(Ve.fulfilled,(t,r)=>{wp(t,r.payload,r.meta.requestId,Mr);}).addCase(pr.fulfilled,(t,r)=>{wi(t,r.payload,r.meta.requestId);}).addCase(vo,(t,{payload:{facetId:r}})=>{An(t,{facetId:r},Mr);}).addCase(ae.fulfilled,t=>Qt(t,Mr)).addCase(G.fulfilled,t=>Qt(t,Mr)).addCase(oe.fulfilled,t=>{Qt(t,Mr);});});function Mr(){return {moreValuesAvailable:!1,values:[]}}function kp(){return {}}var Ti=q(kp(),e=>{e.addCase(ra,(t,r)=>{let o=r.payload;Fn(t,o,fr);}).addCase(Kt,(t,r)=>{Ii(t,r.payload);}).addCase(Ge.pending,(t,r)=>{let o=r.meta.arg;dr(t,o,r.meta.requestId);}).addCase(De.pending,(t,r)=>{let o=r.meta.arg;dr(t,o,r.meta.requestId);}).addCase(pr.pending,(t,r)=>{let o=r.meta.arg;dr(t,o,r.meta.requestId);}).addCase(Ge.rejected,(t,r)=>{let o=r.meta.arg;mr(t,o);}).addCase(De.rejected,(t,r)=>{let o=r.meta.arg;mr(t,o);}).addCase(pr.rejected,(t,r)=>{let o=r.meta.arg;mr(t,o);}).addCase(Ge.fulfilled,(t,r)=>{Ei(t,r.payload,r.meta.requestId);}).addCase(De.fulfilled,(t,r)=>{Oi(t,r.payload,r.meta.requestId,fr);}).addCase(Ve.fulfilled,(t,r)=>{Ip(t,r.payload,r.meta.requestId,fr);}).addCase(pr.fulfilled,(t,r)=>{wi(t,r.payload,r.meta.requestId);}).addCase(vo,(t,{payload:r})=>{An(t,r,fr);}).addCase(oe.fulfilled,t=>{Qt(t,fr);}).addCase(ae.fulfilled,t=>Qt(t,fr)).addCase(G.fulfilled,t=>Qt(t,fr)).addCase(_e,t=>Qt(t,fr));});function fr(){return {moreValuesAvailable:!1,values:[]}}var Ws=()=>X,Dp=()=>R,gr=f("configuration/updateBasicConfiguration",e=>h(e,{accessToken:X,organizationId:X,platformUrl:X})),Vp=f("configuration/updateSearchConfiguration",e=>h(e,{apiBaseUrl:X,pipeline:new C({required:!1,emptyAllowed:!0}),searchHub:X,timezone:X,locale:X,authenticationProviders:new H({required:!1,each:R})})),MR={enabled:new V({default:!0}),originContext:Ws(),originLevel2:Ws(),originLevel3:Ws(),apiBaseUrl:X,nextApiBaseUrl:X,runtimeEnvironment:new te,anonymous:new V({default:!1}),deviceId:X,userDisplayName:X,documentLocation:X,trackingId:X,analyticsMode:new C({constrainTo:["legacy","next"],required:!1,default:"legacy"}),source:new F({options:{required:!1},values:vd.reduce((e,t)=>(e[t]=Il,e),{})})},Fo=f("configuration/updateAnalyticsConfiguration",e=>(kn()&&(e.enabled=!1),h(e,MR))),Ao=f("configuration/analytics/disable"),bo=f("configuration/analytics/enable"),ki=f("configuration/analytics/originlevel2",e=>h(e,{originLevel2:Dp()})),Di=f("configuration/analytics/originlevel3",e=>h(e,{originLevel3:Dp()}));var Np=q(to,e=>e);function Mp(){return typeof window<"u"&&typeof document<"u"}function LR(e){let t=e.payload?.analyticsAction;return Lp(e)&&!M(t)}function Lp(e){return "type"in e}var Up=e=>t=>r=>{let o;LR(r)&&(o=r.payload.analyticsAction,delete r.payload.analyticsAction);let n=t(r);return Lp(r)&&(r.type==="search/executeSearch/fullfilled"&&o===void 0&&console.error("No analytics action associated with search:",r),r.type==="recommendation/get/fullfilled"&&o===void 0&&console.error("No analytics action associated with recommendation:",r),r.type==="productRecommendations/get/fullfilled"&&o===void 0&&console.error("No analytics action associated with product recommendation:",r)),o!==void 0&&e.dispatch(o),n};var Wp=Qe(Bp());f("tab/register",e=>{let t=new F({values:{id:R,expression:pe}});return h(e,t)});var Vi=f("tab/updateActiveTab",e=>h(e,R));var Ni=Qe(Da()),$p=Qe(_p()),zp=Qe(jp());Ni.default.extend(zp.default);Ni.default.extend($p.default);var Xs="/rest/search/v2",Zs="/rest/ua",Hp=()=>({organizationId:"",accessToken:"",platformUrl:Fc(),search:{apiBaseUrl:`${Fc()}${Xs}`,locale:"en-US",timezone:Ni.default.tz.guess(),authenticationProviders:[]},analytics:{enabled:!0,apiBaseUrl:`${Wu()}${Zs}`,nextApiBaseUrl:"",originContext:"Search",originLevel2:"default",originLevel3:"default",anonymous:!1,deviceId:"",userDisplayName:"",documentLocation:"",trackingId:"",analyticsMode:"legacy",source:{}}});function QR(e,t){if(um(e))return e.replace(/^(https:\/\/)platform/,"$1analytics")+Zs;let o=lm(e,t);return o?No(t,o.environment).analytics:e}var Kp=q(Hp(),e=>e.addCase(gr,(t,r)=>{r.payload.accessToken&&(t.accessToken=r.payload.accessToken),r.payload.organizationId&&(t.organizationId=r.payload.organizationId),r.payload.platformUrl&&(t.platformUrl=r.payload.platformUrl,t.search.apiBaseUrl=`${r.payload.platformUrl}${Xs}`,t.analytics.apiBaseUrl=QR(r.payload.platformUrl,t.organizationId));}).addCase(Vp,(t,r)=>{r.payload.apiBaseUrl&&(t.search.apiBaseUrl=r.payload.apiBaseUrl),r.payload.locale&&(t.search.locale=r.payload.locale),r.payload.timezone&&(t.search.timezone=r.payload.timezone),r.payload.authenticationProviders&&(t.search.authenticationProviders=r.payload.authenticationProviders);}).addCase(Fo,(t,r)=>{M(r.payload.enabled)||(t.analytics.enabled=r.payload.enabled),M(r.payload.originContext)||(t.analytics.originContext=r.payload.originContext),M(r.payload.originLevel2)||(t.analytics.originLevel2=r.payload.originLevel2),M(r.payload.originLevel3)||(t.analytics.originLevel3=r.payload.originLevel3),M(r.payload.apiBaseUrl)||(t.analytics.apiBaseUrl=r.payload.apiBaseUrl),M(r.payload.nextApiBaseUrl)||(t.analytics.nextApiBaseUrl=r.payload.nextApiBaseUrl),M(r.payload.trackingId)||(t.analytics.trackingId=r.payload.trackingId),M(r.payload.analyticsMode)||(t.analytics.analyticsMode=r.payload.analyticsMode),M(r.payload.source)||(t.analytics.source=r.payload.source);let o=(0, Wp.default)();o&&(t.analytics.analyticsMode="next",t.analytics.trackingId=o),M(r.payload.runtimeEnvironment)||(t.analytics.runtimeEnvironment=r.payload.runtimeEnvironment),M(r.payload.anonymous)||(t.analytics.anonymous=r.payload.anonymous),M(r.payload.deviceId)||(t.analytics.deviceId=r.payload.deviceId),M(r.payload.userDisplayName)||(t.analytics.userDisplayName=r.payload.userDisplayName),M(r.payload.documentLocation)||(t.analytics.documentLocation=r.payload.documentLocation);}).addCase(Ao,t=>{t.analytics.enabled=!1;}).addCase(bo,t=>{t.analytics.enabled=!0;}).addCase(ki,(t,r)=>{t.analytics.originLevel2=r.payload.originLevel2;}).addCase(Di,(t,r)=>{t.analytics.originLevel3=r.payload.originLevel3;}).addCase(Vi,(t,r)=>{t.analytics.originLevel2=r.payload;}).addCase(Re,(t,r)=>{t.analytics.originLevel2=r.payload.tab||t.analytics.originLevel2;}));var le=Kp;function BR(e){return e.instantlyCallable}var Yp=()=>e=>t=>e(BR(t)?t():t);var Gp=e=>()=>t=>r=>{let o=r;if(!o.error)return t(r);let n=o.error;if(o.payload?.ignored||e.error(n.stack||n.message||n.name||"Error",`Action dispatch error ${o.type}`,r),o.error.name!=="SchemaValidationError")return t(r)},Jp=e=>t=>r=>o=>(e.debug({action:o,nextState:t.getState()},`Action dispatched: ${o.type}`),r(o));var Xp=()=>({referrer:document.referrer,userAgent:navigator.userAgent,location:window.location.href}),Zp=()=>({referrer:"default",userAgent:"Node.js",location:"default"});function ef(e,t){let r={...e},o,n=a=>(i,c)=>{let u=a(i,c);return o?o(u,c):u};return {get combinedReducer(){let a=Qu(Object.entries(t).filter(([i])=>!(i in r)).map(([i,c])=>[i,()=>c]));return n(Ln({...a,...r}))},containsAll(a){return Object.keys(a).every(c=>c in r)},add(a){Object.keys(a).filter(i=>!(i in r)).forEach(i=>r[i]=a[i]);},addCrossReducer(a){o=a;}}}function Mi(e,t,r){var o,n,a;t===void 0&&(t=50),r===void 0&&(r={});var i=(o=r.isImmediate)!=null&&o,c=(n=r.callback)!=null&&n,u=r.maxWait,s=Date.now(),l=[];function d(){if(u!==void 0){var m=Date.now()-s;if(m+t>=u)return u-m}return t}var p=function(){var m=[].slice.call(arguments),g=this;return new Promise(function(x,v){var E=i&&a===void 0;if(a!==void 0&&clearTimeout(a),a=setTimeout(function(){if(a=void 0,s=Date.now(),!i){var K=e.apply(g,m);c&&c(K),l.forEach(function($){return (0, $.resolve)(K)}),l=[];}},d()),E){var k=e.apply(g,m);return c&&c(k),x(k)}l.push({resolve:x,reject:v});})};return p.cancel=function(m){a!==void 0&&clearTimeout(a),l.forEach(function(g){return (0, g.reject)(m)}),l=[];},p}function tf(e,t){let r=0,o=Mi(()=>r=0,500);return n=>a=>async i=>{if(!(typeof i=="function"))return a(i);let u=await a(i);if(!_R(u))return u;if(typeof t!="function")return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),u;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),u;r++,o();let s=await jR(t);n.dispatch(gr({accessToken:s})),n.dispatch(i);}}function _R(e){return e?.error?.name===new Br().name}async function jR(e){try{return await e()}catch{return ""}}function rf({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:o,name:n}){return Cl({reducer:e,preloadedState:t,devTools:{stateSanitizer:a=>a.history?{...a,history:"<<OMIT>>"}:a,name:n,shouldHotReload:!1},middleware:a=>a({thunk:{extraArgument:o}}).prepend(...r).concat(Jp(o.logger))})}var $R={configuration:le,version:Np};function zR(e,t){let r=e.organizationEndpoints?.analytics||void 0,{analyticsClientMiddleware:o,...n}=e.analytics??{},a={...n,nextApiBaseUrl:`${r}/rest/organizations/${e.organizationId}/events/v1`,apiBaseUrl:r};if(kn())return t.info("Analytics disabled since doNotTrack is active."),{...a,enabled:!1};if(a.analyticsMode==="next"&&!n.trackingId)throw new eu('analytics.trackingId is required when analytics.analyticsMode="next"');return a}function of(e,t){let r=HR(e,t),{accessToken:o,organizationId:n}=e.configuration,{organizationEndpoints:a}=e.configuration,i=a?.platform||e.configuration.platformUrl;GR(e.configuration)&&r.logger.warn(`The \`platformUrl\` (${e.configuration.platformUrl}) option will be deprecated in the next major version. Consider using the \`organizationEndpoints\` option instead. See [Organization endpoints](https://docs.coveo.com/en/mcc80216).`),YR(e.configuration)?r.logger.warn("The `organizationEndpoints` options was not explicitly set in the Headless engine configuration. Coveo recommends setting this option, as it has resiliency benefits and simplifies the overall configuration for multi-region deployments. See [Organization endpoints](https://docs.coveo.com/en/mcc80216)."):JR(e.configuration)&&r.logger.warn(`There is a mismatch between the \`organizationId\` option (${e.configuration.organizationId}) and the organization configured in the \`organizationEndpoints\` option (${e.configuration.organizationEndpoints?.platform}). This could lead to issues that are complex to troubleshoot. Please make sure both values match.`),r.dispatch(gr({accessToken:o,organizationId:n,platformUrl:i}));let c=zR(e.configuration,r.logger);return c&&r.dispatch(Fo(c)),r}function HR(e,t){let{reducers:r}=e,o=ef({...$R,...r},e.preloadedState??{});e.crossReducer&&o.addCrossReducer(e.crossReducer);let n=t.logger,a=e.navigatorContextProvider??Mp()?Xp:Zp,i={...t,get relay(){return Zo(u.state)},get navigatorContext(){return a()}},c=WR(e,i,o),u={addReducers(s){o.containsAll(s)||(o.add(s),c.replaceReducer(o.combinedReducer));},dispatch:c.dispatch,subscribe:c.subscribe,enableAnalytics(){c.dispatch(bo());},disableAnalytics(){c.dispatch(Ao());},get state(){return c.getState()},get relay(){return Zo(this.state)},get navigatorContext(){return a()},logger:n,store:c};return u}function WR(e,t,r){let{preloadedState:o,configuration:n}=e,a=n.name||"coveo-headless",i=KR(e,t.logger);return rf({preloadedState:o,reducer:r.combinedReducer,middlewares:i,thunkExtraArguments:t,name:a})}function KR(e,t){let{renewAccessToken:r}=e.configuration,o=tf(t,r);return [Yp,o,Gp(t),Up].concat(e.middlewares||[])}function YR(e){return Ft(e.organizationEndpoints)}function GR(e){return !M(e.platformUrl)||M(e.organizationEndpoints?.platform)}function JR(e){let{platform:t}=e.organizationEndpoints;if(Ft(t))return !1;let r=ws(t);return r&&r.organizationId!==e.organizationId}var eu=class extends Error{constructor(t){super(t),this.name="InvalidEngineConfiguration";}};var pf=Qe(mf());function ff(e){return (0, pf.default)({name:"@coveo/headless",level:e?.level||"warn",formatters:{log:e?.logFormatter}})}function gf(e,t){let r=gv(e),o=Be,n=hv(e);return {analyticsClientMiddleware:r,validatePayload:o,preprocessRequest:n,logger:t}}function gv(e){let{analytics:t}=e,r=(o,n)=>n;return t?.analyticsClientMiddleware||r}function hv(e){return e.preprocessRequest||Vn}var hf={organizationId:R,accessToken:R,platformUrl:new C({required:!1,emptyAllowed:!1}),name:new C({required:!1,emptyAllowed:!1}),analytics:new F({options:{required:!1},values:{enabled:new V({required:!1}),originContext:new C({required:!1}),originLevel2:new C({required:!1}),originLevel3:new C({required:!1}),analyticsMode:new C({constrainTo:["legacy","next"],required:!1})}})};var yf=new z({...hf,context:new F({options:{required:!0},values:$o}),cart:new F({values:jc})});var yv={productListing:ur,recommendations:Fi,commerceSearch:St,commercePagination:xi,commerceSort:Ai,facetOrder:Ro,facetSearchSet:Ti,categoryFacetSearchSet:qi,commerceFacetSet:Je,commerceContext:zt,commerceQuery:Xe,cart:Xn,triggers:bi};function Sv(e){let t=ff(e.loggerOptions);Cv(e.configuration,t);let r=xv(e.configuration,t),o={...gf(e.configuration,t),apiClient:r},n={...e,reducers:yv},a=of(n,o),{state:i,...c}=a;return c.dispatch(we(e.configuration.context)),e.configuration.cart!==void 0&&e.configuration.cart.items!==void 0&&c.dispatch(Hr(e.configuration.cart.items)),Tl({...c,get[w](){return a.state},get configuration(){return a.state.configuration},executeFirstSearch(){let u=G();a.dispatch(u);},executeFirstSearchAfterStandaloneSearchBoxRedirect(){let u=G();a.dispatch(u);}})}function Cv(e,t){try{yf.validate(e);}catch(r){throw t.error("Commerce engine configuration error",r),r}}function xv(e,t){return new Dn({logger:t,preprocessRequest:e.preprocessRequest||Vn})}var Af={id:R,query:pe},In=f("querySet/register",e=>h(e,Af)),Po=f("querySet/update",e=>h(e,Af));var wn=q($a(),e=>{e.addCase(In,(t,r)=>{let{id:o,query:n}=r.payload;o in t||(t[o]=n);}).addCase(Po,(t,r)=>{let{id:o,query:n}=r.payload;au(t,o,n);}).addCase(ut,(t,r)=>{let{id:o,expression:n}=r.payload;au(t,o,n);}).addCase(oe.fulfilled,(t,r)=>{let{queryExecuted:o}=r.payload;Pf(t,o);}).addCase(Re,bf).addCase(xo,bf).addCase(ge.fulfilled,(t,r)=>{if(r.payload)for(let[o,n]of Object.entries(r.payload.querySet))au(t,o,n);});});function bf(e,t){M(t.payload.q)||Pf(e,t.payload.q);}function Pf(e,t){Object.keys(e).forEach(r=>e[r]=t);}var au=(e,t,r)=>{t in e&&(e[t]=r);};var If=()=>({});var Ur=q(If(),e=>e.addCase(Nr,(t,r)=>{let o=r.payload.id;o in t||(t[o]=Rv(r.payload));}).addCase(Pp,(t,r)=>{delete t[r.payload.id];}).addCase(Pi.pending,wf).addCase(Pi.fulfilled,(t,r)=>{let o=t[r.meta.arg.id];if(!o||r.meta.requestId!==o.currentRequestId)return;let{q:n}=r.payload;n&&o.partialQueries.push(n.replace(/;/,encodeURIComponent(";"))),o.responseId=r.payload.responseId,o.completions=r.payload.completions,o.isLoading=!1,o.error=null;}).addCase(Pi.rejected,Ef).addCase(Ve.pending,wf).addCase(Ve.fulfilled,(t,r)=>{let o=t[r.meta.arg.id];if(!o||r.meta.requestId!==o.currentRequestId)return;let{query:n}=r.payload;n&&o.partialQueries.push(n.replace(/;/,encodeURIComponent(";"))),o.responseId=r.payload.responseId,o.completions=r.payload.completions.map(a=>({expression:a.expression,highlighted:a.highlighted,score:0,executableConfidence:0})),o.isLoading=!1,o.error=null;}).addCase(Ve.rejected,Ef).addCase(Ut,(t,r)=>{let o=t[r.payload.id];o&&(o.responseId="",o.completions=[],o.partialQueries=[]);}));function Rv(e){return {id:"",completions:[],responseId:"",count:5,currentRequestId:"",error:null,partialQueries:[],isLoading:!1,...e}}function wf(e,t){let r=e[t.meta.arg.id];r&&(r.currentRequestId=t.meta.requestId,r.isLoading=!0);}function Ef(e,t){let r=e[t.meta.arg.id];r&&(r.error=t.payload||null,r.isLoading=!1);}function zj(e){return e.addReducers({querySuggest:Ur,querySet:wn}),{clearQuerySuggest:Ut,fetchQuerySuggestions:Ve,registerQuerySuggest:Nr,selectQuerySuggestion:ut}}q(_a(),e=>{e.addCase(Pt,(t,r)=>({...t,...r.payload})).addCase(oe.fulfilled,t=>{t.freezeFacetOrder=!1;}).addCase(oe.rejected,t=>{t.freezeFacetOrder=!1;}).addCase(ge.fulfilled,(t,r)=>r.payload?.facetOptions??t).addCase(Bl,(t,r)=>{t.facets[r.payload.facetId]=lo();}).addCase(sa,(t,r)=>{t.facets[r.payload.facetId]=lo();}).addCase(dn,(t,r)=>{t.facets[r.payload.facetId]=lo();}).addCase(pn,(t,r)=>{t.facets[r.payload.facetId]=lo();}).addCase(Wc,(t,r)=>{t.facets[r.payload].enabled=!0;}).addCase(It,(t,r)=>{t.facets[r.payload].enabled=!1;}).addCase(Re,(t,r)=>{[...Object.keys(r.payload.f??{}),...Object.keys(r.payload.fExcluded??{}),...Object.keys(r.payload.cf??{}),...Object.keys(r.payload.nf??{}),...Object.keys(r.payload.df??{})].forEach(o=>{o in t||(t.facets[o]=lo()),t.facets[o].enabled=!0;});});});var _i=f("rangeFacet/executeToggleSelect",e=>h(e,Ns(e.selection))),ji=f("rangeFacet/executeToggleExclude",e=>h(e,Ns(e.selection)));var qf={facetId:Q,selection:new F({values:Dr})};T("dateFacet/executeToggleSelect",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,qf),t(Ke(e)),t(_i(e)),t(Pt());});T("dateFacet/executeToggleExclude",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,qf),t(Ye(e)),t(ji(e)),t(Pt());});function iu(e,t){let r=t.payload??null;r&&(e.response=Ue().response,e.results=[],e.questionAnswer=on()),e.error=r,e.isLoading=!1;}function su(e,t){e.error=null,e.response=t.payload.response,e.queryExecuted=t.payload.queryExecuted,e.duration=t.payload.duration,e.isLoading=!1;}function kv(e,t){su(e,t),e.results=t.payload.response.results,e.searchResponseId=t.payload.response.searchUid,e.questionAnswer=t.payload.response.questionAnswer,e.extendedResults=t.payload.response.extendedResults;}function cu(e,t){e.isLoading=!0,e.requestId=t.meta.requestId;}q(Ue(),e=>{e.addCase(Wa.rejected,(t,r)=>iu(t,r)),e.addCase(Ya.rejected,(t,r)=>iu(t,r)),e.addCase(Ka.rejected,(t,r)=>iu(t,r)),e.addCase(Wa.fulfilled,(t,r)=>{kv(t,r);}),e.addCase(Ya.fulfilled,(t,r)=>{su(t,r),t.results=[...t.results,...r.payload.response.results];}),e.addCase(Ka.fulfilled,(t,r)=>{su(t,r),t.results=r.payload.response.results;}),e.addCase(ym.fulfilled,(t,r)=>{t.response.facets=r.payload.response.facets,t.response.searchUid=r.payload.response.searchUid;}),e.addCase(Wa.pending,cu),e.addCase(Ya.pending,cu),e.addCase(Ka.pending,cu);});var zi=["idle","selected","excluded"];var Hi=["ascending","descending"],Wi=["even","equiprobable"];var Dv={start:new C,end:new C,endInclusive:new V,state:new C({constrainTo:zi})};new z({facetId:oa,field:na,generateAutomaticRanges:ca,filterFacetCount:aa,injectionDepth:ia,numberOfValues:Wo,currentValues:new H({each:new F({values:Dv})}),sortCriteria:new C({constrainTo:Hi}),rangeAlgorithm:new C({constrainTo:Wi})});var Df={facetId:Q,selection:new F({values:kr})};T("numericFacet/executeToggleSelect",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,Df),t(Te(e)),t(_i(e)),t(Pt());});T("numericFacet/executeToggleExclude",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,Df),t(ke(e)),t(ji(e)),t(Pt());});var Vf=["allValues","atLeastOneValue"];var jv={start:new P,end:new P,endInclusive:new V,state:new C({constrainTo:zi})};new z({facetId:oa,field:na,generateAutomaticRanges:ca,filterFacetCount:aa,injectionDepth:ia,numberOfValues:Wo,currentValues:new H({each:new F({values:jv})}),sortCriteria:new C({constrainTo:Hi}),resultsMustMatch:new C({constrainTo:Vf}),rangeAlgorithm:new C({constrainTo:Wi})});var lu="&",uu="=";var Mf=e=>t=>Object.entries(t).map(e).filter(r=>r).join(lu);function Lf(e,t){return `${e}${uu}${encodeURIComponent(t)}`}function Uf(e){let[t,...r]=e.split(uu),o=r.join(uu);return [t,o]}var Qf={serialize:$v,deserialize:zv},Bf={serialize:()=>"",deserialize:()=>({})};function $v(e){return Mf(Hv)(e)}function zv(e){return e.split(lu).map(Uf).filter(Wv).map(Yv).reduce((o,n)=>{let[a,i]=n;return {...o,[a]:i}},{})}function Hv(e){let[t,r]=e;return t!=="q"?"":Lf(t,r)}function Wv(e){let t=Kv(e[0]),r=e.length===2;return t&&r}function Kv(e){return e in{q:!0}}function Yv(e){let[t,r]=e;return [t,decodeURIComponent(r)]}var Io=()=>({correctedQuery:"",corrections:[],originalQuery:""});var _f=(e,t)=>{let r={...Io(),...t,correctedQuery:t?.correctedQuery||t?.corrections[0]?.correctedQuery||""};e.queryCorrection=r,e.wasCorrectedTo=r.correctedQuery;};function jf(){return {wasCorrectedTo:"",queryCorrection:Io(),originalQuery:""}}var $f=q(jf(),e=>{e.addCase(G.pending,t=>{t.queryCorrection=Io(),t.wasCorrectedTo="";}).addCase(G.fulfilled,(t,r)=>{let{queryCorrection:o}=r.payload.response;_f(t,o),t.originalQuery=r.payload.originalQuery;});});var zf=D(e=>e.queryCorrection.correctedQuery!==""||e.wasCorrectedTo!=="",e=>e);function Hf(e){if(!Gv(e));let t=_(e),r=()=>e[w].didYouMean,o=()=>zf(r());return {...t,get state(){let n=r();return {originalQuery:n.originalQuery,wasCorrectedTo:n.wasCorrectedTo,queryCorrection:n.queryCorrection,hasQueryCorrection:o(),wasAutomaticallyCorrected:o()}}}}function Gv(e){return e.addReducers({didYouMean:$f}),!0}var Kf="hierarchical",Wf={regular:{toggleSelectActionCreator:je,toggleExcludeActionCreator:$e},numericalRange:{toggleSelectActionCreator:Te,toggleExcludeActionCreator:ke},dateRange:{toggleSelectActionCreator:Ke,toggleExcludeActionCreator:Ye},[Kf]:{toggleSelectActionCreator:Wt}};function Yf(e,t){if(!Jv(e));let r=_(e),{dispatch:o}=e,n=i=>({facetId:i.facetId,facetDisplayName:i.displayName,field:i.field,type:i.type,values:i.values.filter(c=>c.state!=="idle").map(c=>({value:c,deselect:()=>{c.state==="selected"?(o(Wf[i.type].toggleSelectActionCreator({facetId:i.facetId,selection:c})),o(t.fetchProductsActionCreator())):c.state==="excluded"&&i.type!==Kf&&(o(Wf[i.type].toggleExcludeActionCreator({facetId:i.facetId,selection:c})),o(t.fetchProductsActionCreator()));}}))}),a=D(i=>i.facetOrder,i=>{let c=i.map(u=>t.facetResponseSelector(e[w],u)).filter(u=>u!==void 0).map(n)??[];return {facetBreadcrumbs:c,hasBreadcrumbs:c.length>0}});return {...r,deselectAll:()=>{o(fe());},get state(){return a(e[w])}}}function Jv(e){return e.addReducers({facetOrder:Ro,commerceFacetSet:Je}),!0}function hr(e,t){if(!Xv(e));let{dispatch:r}=e,o=_(e),n=t.options.facetId,a=()=>e[w].commerceFacetSet[n]?.request,i=()=>t.options.facetResponseSelector(e[w],n),c=()=>t.options.isFacetLoadingResponseSelector(e[w]),u=()=>a()?.values?.filter(s=>s.state!=="idle").length??0;return {...o,toggleSelect:s=>{r(t.options.toggleSelectActionCreator({selection:s,facetId:n})),r(t.options.fetchProductsActionCreator());},toggleExclude:s=>{if(!t.options.toggleExcludeActionCreator){e.logger.warn("No toggle exclude action creator provided; calling #toggleExclude had no effect.");return}r(t.options.toggleExcludeActionCreator({selection:s,facetId:n})),r(t.options.fetchProductsActionCreator());},toggleSingleSelect:function(s){s.state==="idle"&&r(ie(n)),this.toggleSelect(s);},toggleSingleExclude:function(s){if(!t.options.toggleExcludeActionCreator){e.logger.warn("No toggle exclude action creator provided; calling #toggleSingleExclude had no effect.");return}s.state==="idle"&&r(ie(n)),this.toggleExclude(s);},isValueSelected:s=>s.state==="selected",isValueExcluded:s=>s.state==="excluded",deselectAll(){r(ie(n)),r(t.options.fetchProductsActionCreator());},showMoreValues(){let s=a()?.numberOfValues??0,l=a()?.initialNumberOfValues??0,d=l-s%l,p=s+d;r(br({facetId:n,numberOfValues:p})),r(Pr({facetId:n,isFieldExpanded:!0})),r(t.options.fetchProductsActionCreator());},showLessValues(){let s=a()?.initialNumberOfValues??0,l=Math.max(s,u());r(br({facetId:n,numberOfValues:l})),r(Pr({facetId:n,isFieldExpanded:!1})),r(t.options.fetchProductsActionCreator());},get state(){let s=i(),l=s?.moreValuesAvailable??!1,d=s?.values??[],p=d.some(m=>m.state!=="idle");return {facetId:n,type:s?.type??"regular",field:s?.field??"",displayName:s?.displayName??"",values:d,isLoading:c(),canShowMoreValues:l,canShowLessValues:Zv(a()),hasActiveValues:p}}}}function Xv(e){return e.addReducers({commerceFacetSet:Je}),!0}var Zv=e=>{if(!e)return !1;let t=e.initialNumberOfValues,r=!!e.values.find(o=>o.state==="idle");return (t??0)<(e.numberOfValues??0)&&r};function Ki(e,t){let r=e.dispatch,{options:o,getFacetSearch:n,executeFacetSearchActionCreator:a,executeFieldSuggestActionCreator:i}=t,{facetId:c}=o;return {updateText(u){r(Kt({facetId:c,query:u,numberOfValues:n().initialNumberOfValues}));},showMoreResults(){let{initialNumberOfValues:u,options:s}=n();r(Kt({facetId:c,numberOfValues:s.numberOfValues+u})),r(t.isForFieldSuggestions?i(c):a(c));},search(){r(t.isForFieldSuggestions?i(c):a(c));},clear(){r(vo({facetId:c}));},updateCaptions(u){r(Kt({facetId:c,captions:u}));},get state(){let{response:u,isLoading:s,options:l}=n(),{query:d}=l,p=u.values;return {...u,values:p,isLoading:s,query:d}}}}function Gf(e,t){let{dispatch:r}=e,o={...lr,...t.options},{facetId:n}=o,a=()=>"state"in e?e.state.categoryFacetSearchSet[n]:e[w].categoryFacetSearchSet[n];r(ta(o));let i=Ki(e,{options:o,getFacetSearch:a,isForFieldSuggestions:t.isForFieldSuggestions,executeFacetSearchActionCreator:t.executeFacetSearchActionCreator,executeFieldSuggestActionCreator:t.executeFieldSuggestActionCreator});return {...i,select(c){r(Yr({facetId:n,value:c})),t.select(c);},get state(){return i.state}}}function Yi(e,t){if(!eF(e));let{showMoreResults:r,updateCaptions:o,...n}=Gf(e,{...t,executeFacetSearchActionCreator:Ge,executeFieldSuggestActionCreator:De});return n}function eF(e){return e.addReducers({categoryFacetSearchSet:qi}),!0}function Jf(e,t){let r=hr(e,{options:{...t,toggleSelectActionCreator:Wt}}),{deselectAll:o,isValueSelected:n,subscribe:a,toggleSelect:i}=r,{dispatch:c}=e,u=()=>r.state.facetId,l=Yi(e,{options:{facetId:u(),...t.facetSearch},select:()=>{c(t.fetchProductsActionCreator());},isForFieldSuggestions:!1}),{state:d,...p}=l,m=D(g=>g.categoryFacetSearchSet[u()],g=>({isLoading:g.isLoading,moreValuesAvailable:g.response.moreValuesAvailable,query:g.options.query,values:g.response.values}));return {deselectAll:o,isValueSelected:n,subscribe:a,toggleSelect:i,showMoreValues(){let{facetId:g}=t,{activeValue:x,values:v}=this.state,E=(x?.children.length??v.length)+Kr;c(zo({facetId:g,numberOfValues:E})),c(t.fetchProductsActionCreator());},showLessValues(){let{facetId:g}=t;c(zo({facetId:g,numberOfValues:Kr})),c(t.fetchProductsActionCreator());},facetSearch:p,get state(){let g=rn(r.state.values),x=g.length?g[g.length-1]:void 0,v=x?x.children.length>Kr:!1,E=x?.moreValuesAvailable??r.state.canShowMoreValues??!1,k=!!x;return {...r.state,activeValue:x,canShowLessValues:v,canShowMoreValues:E,hasActiveValues:k,selectedValueAncestry:g,facetSearch:m(e[w])}},type:"hierarchical"}}function Xf(e,t){return {...hr(e,{options:{...t,toggleSelectActionCreator:Ke,toggleExcludeActionCreator:Ye}}),type:"dateRange"}}function Zf(e,t){if(!tF(e));let r=_(e),o=D([a=>a.facetOrder,a=>a.commerceFacetSet],(a,i)=>a.map(c=>n(i,c))),n=D((a,i)=>({facetId:i,type:a[i].request.type}),({type:a,facetId:i})=>{switch(a){case"dateRange":return t.buildDateFacet(e,{facetId:i});case"hierarchical":return t.buildCategoryFacet(e,{facetId:i});case"numericalRange":return t.buildNumericFacet(e,{facetId:i});case"regular":return t.buildRegularFacet(e,{facetId:i})}});return {...r,get facets(){return o(e[w])},get state(){return e[w].facetOrder}}}function tF(e){return e.addReducers({facetOrder:Ro,commerceFacetSet:Je}),!0}function eg(e,t){let r=hr(e,{options:{...t,toggleSelectActionCreator:Te,toggleExcludeActionCreator:ke}}),{dispatch:o}=e,{facetId:n,fetchProductsActionCreator:a}=t;return {...r,setRanges(i){o(ar({facetId:n,values:i})),o(a());},get state(){let i=t.facetResponseSelector(e[w],n);if(i?.type==="numericalRange"&&i.domain){let{min:c,max:u}=i.domain;return {...r.state,domain:{min:c,max:u}}}return {...r.state}},type:"numericalRange"}}function tg(e,t){let{dispatch:r}=e,{options:o,select:n,exclude:a,isForFieldSuggestions:i,executeFacetSearchActionCreator:c,executeFieldSuggestActionCreator:u}=t,{facetId:s}=o,l=()=>"state"in e?e.state.facetSearchSet[s]:e[w].facetSearchSet[s];r(ra(o));let d=Ki(e,{options:o,getFacetSearch:l,isForFieldSuggestions:i,executeFacetSearchActionCreator:c,executeFieldSuggestActionCreator:u});return {...d,select(p){r(At({facetId:s,value:p})),n(p);},exclude(p){r(bt({facetId:s,value:p})),a(p);},singleSelect(p){r(ie(s)),r(At({facetId:s,value:p})),n(p);},singleExclude(p){r(ie(s)),r(bt({facetId:s,value:p})),a(p);},get state(){let{values:p}=d.state;return {...d.state,values:p.map(({count:m,displayValue:g,rawValue:x})=>({count:m,displayValue:g,rawValue:x}))}}}}function Gi(e,t){if(!rF(e));let{showMoreResults:r,updateCaptions:o,...n}=tg(e,{...t,executeFacetSearchActionCreator:Ge,executeFieldSuggestActionCreator:De});return {...n}}function rF(e){return e.addReducers({facetSearchSet:Ti}),!0}function rg(e,t){let r=hr(e,{options:{...t,toggleSelectActionCreator:je,toggleExcludeActionCreator:$e}}),o=()=>r.state.facetId,{dispatch:n}=e,i=Gi(e,{options:{facetId:o(),...t.facetSearch},select:()=>{n(t.fetchProductsActionCreator());},exclude:()=>{n(t.fetchProductsActionCreator());},isForFieldSuggestions:!1}),{state:c,...u}=i,s=D(l=>l.facetSearchSet[o()],l=>({facetSearch:{isLoading:l.isLoading,moreValuesAvailable:l.response.moreValuesAvailable,query:l.options.query,values:l.response.values}}));return {...r,facetSearch:u,get state(){return {...r.state,...s(e[w])}},type:"regular"}}var oF=new z({pageSize:new P({min:1,max:1e3,required:!1})});function og(e,t){if(!nF(e));let r=_(e),{dispatch:o}=e;Ie(e,oF,t.options,"buildCorePagination");let n=t.options?.slotId;t.options?.pageSize&&o(Cn({slotId:n,pageSize:t.options.pageSize})),n&&o(yi({slotId:n}));let a=D(i=>n?i.commercePagination.recommendations[n]:i.commercePagination.principal,({perPage:i,...c})=>({pageSize:i??0,...c}));return {...r,get state(){return a(e[w])},selectPage(i){o(fi({slotId:n,page:i})),o(t.fetchProductsActionCreator());},nextPage(){o(gi({slotId:n})),o(t.fetchProductsActionCreator());},previousPage(){o(hi({slotId:n})),o(t.fetchProductsActionCreator());},setPageSize(i){o(Cn({slotId:n,pageSize:i})),o(t.fetchProductsActionCreator());},fetchMoreProducts(){o(t.fetchMoreProductsActionCreator());}}}function nF(e){return e.addReducers({commercePagination:xi}),!0}T("commerce/product/view",async(e,{extra:t,getState:r})=>{let{relay:o}=t,a={currency:jo(r().commerceContext),product:e};o.emit("ec.productView",a);});var ag=T("commerce/product/click",async(e,{extra:t,getState:r})=>{let{relay:o}=t,a={currency:jo(r().commerceContext),...e};o.emit("ec.productClick",a);});function ig(e,t,r){if(!aF(e));let o=1e3,n={selectionDelay:o,debounceWait:o,...t.options},a;return {select:Mi(r,n.debounceWait,{isImmediate:!0}),beginDelayedSelect(){a=setTimeout(r,n.selectionDelay);},cancelPendingSelect(){a&&clearTimeout(a);}}}function aF(e){return e.addReducers({configuration:le}),!0}function cg(e,t){let r=!1;return ig(e,t,()=>{r||(r=!0,e.dispatch(ag({product:t.options.product,position:t.options.position,responseId:t.responseIdSelector(e[w])})));})}function iF(e,t){if(!t)return;let r=new z({criterion:Tm});qe(e,r,t,"buildSort");}function sg(e,t){if(!cF(e));let{dispatch:r}=e,o=_(e);iF(e,t.initialState);let n=t.initialState?.criterion;return n&&r(Rn(n)),{...o,get state(){return e[w].commerceSort},sortBy(a){r(Rn(a)),r(gt(0)),r(t.fetchProductsActionCreator());},isSortedBy(a){return JSON.stringify(this.state.appliedSort)===JSON.stringify(a)},isAvailable(a){return this.state.availableSorts.some(i=>JSON.stringify(i)===JSON.stringify(a))}}}function cF(e){return e.addReducers({commerceSort:Ai}),!0}var sF=Object.getOwnPropertyNames,uF=Object.getOwnPropertySymbols,lF=Object.prototype.hasOwnProperty;function ug(e,t){return function(o,n,a){return e(o,n,a)&&t(o,n,a)}}function Ji(e){return function(r,o,n){if(!r||!o||typeof r!="object"||typeof o!="object")return e(r,o,n);var a=n.cache,i=a.get(r),c=a.get(o);if(i&&c)return i===o&&c===r;a.set(r,o),a.set(o,r);var u=e(r,o,n);return a.delete(r),a.delete(o),u}}function lg(e){return sF(e).concat(uF(e))}var yg=Object.hasOwn||function(e,t){return lF.call(e,t)};function wo(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var Sg="_owner",dg=Object.getOwnPropertyDescriptor,mg=Object.keys;function dF(e,t,r){var o=e.length;if(t.length!==o)return !1;for(;o-- >0;)if(!r.equals(e[o],t[o],o,o,e,t,r))return !1;return !0}function mF(e,t){return wo(e.getTime(),t.getTime())}function pg(e,t,r){if(e.size!==t.size)return !1;for(var o={},n=e.entries(),a=0,i,c;(i=n.next())&&!i.done;){for(var u=t.entries(),s=!1,l=0;(c=u.next())&&!c.done;){var d=i.value,p=d[0],m=d[1],g=c.value,x=g[0],v=g[1];!s&&!o[l]&&(s=r.equals(p,x,a,l,e,t,r)&&r.equals(m,v,p,x,e,t,r))&&(o[l]=!0),l++;}if(!s)return !1;a++;}return !0}function pF(e,t,r){var o=mg(e),n=o.length;if(mg(t).length!==n)return !1;for(var a;n-- >0;)if(a=o[n],a===Sg&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!yg(t,a)||!r.equals(e[a],t[a],a,a,e,t,r))return !1;return !0}function En(e,t,r){var o=lg(e),n=o.length;if(lg(t).length!==n)return !1;for(var a,i,c;n-- >0;)if(a=o[n],a===Sg&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!yg(t,a)||!r.equals(e[a],t[a],a,a,e,t,r)||(i=dg(e,a),c=dg(t,a),(i||c)&&(!i||!c||i.configurable!==c.configurable||i.enumerable!==c.enumerable||i.writable!==c.writable)))return !1;return !0}function fF(e,t){return wo(e.valueOf(),t.valueOf())}function gF(e,t){return e.source===t.source&&e.flags===t.flags}function fg(e,t,r){if(e.size!==t.size)return !1;for(var o={},n=e.values(),a,i;(a=n.next())&&!a.done;){for(var c=t.values(),u=!1,s=0;(i=c.next())&&!i.done;)!u&&!o[s]&&(u=r.equals(a.value,i.value,a.value,i.value,e,t,r))&&(o[s]=!0),s++;if(!u)return !1}return !0}function hF(e,t){var r=e.length;if(t.length!==r)return !1;for(;r-- >0;)if(e[r]!==t[r])return !1;return !0}var yF="[object Arguments]",SF="[object Boolean]",CF="[object Date]",xF="[object Map]",RF="[object Number]",vF="[object Object]",FF="[object RegExp]",AF="[object Set]",bF="[object String]",PF=Array.isArray,gg=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,hg=Object.assign,IF=Object.prototype.toString.call.bind(Object.prototype.toString);function wF(e){var t=e.areArraysEqual,r=e.areDatesEqual,o=e.areMapsEqual,n=e.areObjectsEqual,a=e.arePrimitiveWrappersEqual,i=e.areRegExpsEqual,c=e.areSetsEqual,u=e.areTypedArraysEqual;return function(l,d,p){if(l===d)return !0;if(l==null||d==null||typeof l!="object"||typeof d!="object")return l!==l&&d!==d;var m=l.constructor;if(m!==d.constructor)return !1;if(m===Object)return n(l,d,p);if(PF(l))return t(l,d,p);if(gg!=null&&gg(l))return u(l,d,p);if(m===Date)return r(l,d,p);if(m===RegExp)return i(l,d,p);if(m===Map)return o(l,d,p);if(m===Set)return c(l,d,p);var g=IF(l);return g===CF?r(l,d,p):g===FF?i(l,d,p):g===xF?o(l,d,p):g===AF?c(l,d,p):g===vF?typeof l.then!="function"&&typeof d.then!="function"&&n(l,d,p):g===yF?n(l,d,p):g===SF||g===RF||g===bF?a(l,d,p):!1}}function EF(e){var t=e.circular,r=e.createCustomConfig,o=e.strict,n={areArraysEqual:o?En:dF,areDatesEqual:mF,areMapsEqual:o?ug(pg,En):pg,areObjectsEqual:o?En:pF,arePrimitiveWrappersEqual:fF,areRegExpsEqual:gF,areSetsEqual:o?ug(fg,En):fg,areTypedArraysEqual:o?En:hF};if(r&&(n=hg({},n,r(n))),t){var a=Ji(n.areArraysEqual),i=Ji(n.areMapsEqual),c=Ji(n.areObjectsEqual),u=Ji(n.areSetsEqual);n=hg({},n,{areArraysEqual:a,areMapsEqual:i,areObjectsEqual:c,areSetsEqual:u});}return n}function OF(e){return function(t,r,o,n,a,i,c){return e(t,r,c)}}function qF(e){var t=e.circular,r=e.comparator,o=e.createState,n=e.equals,a=e.strict;if(o)return function(u,s){var l=o(),d=l.cache,p=d===void 0?t?new WeakMap:void 0:d,m=l.meta;return r(u,s,{cache:p,equals:n,meta:m,strict:a})};if(t)return function(u,s){return r(u,s,{cache:new WeakMap,equals:n,meta:void 0,strict:a})};var i={cache:void 0,equals:n,meta:void 0,strict:a};return function(u,s){return r(u,s,i)}}Ct();Ct({strict:!0});Ct({circular:!0});Ct({circular:!0,strict:!0});Ct({createInternalComparator:function(){return wo}});Ct({strict:!0,createInternalComparator:function(){return wo}});Ct({circular:!0,createInternalComparator:function(){return wo}});Ct({circular:!0,createInternalComparator:function(){return wo},strict:!0});function Ct(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,o=e.createInternalComparator,n=e.createState,a=e.strict,i=a===void 0?!1:a,c=EF(e),u=wF(c),s=o?o(u):OF(u);return qF({circular:r,comparator:u,createState:n,equals:s,strict:i})}function TF(e,t){return e.length!==t.length?!1:e.every(r=>t.findIndex(o=>Qr(r,o))!==-1)}var Qr=Ct({createCustomConfig:e=>({...e,areArraysEqual:TF})});var NF=new P({min:1,default:8,required:!1}),MF=new P({min:1,max:20,default:5,required:!1}),LF={desiredCount:MF,numberOfValues:NF};f("automaticFacet/setOptions",e=>h(e,LF));f("automaticFacet/deselectAll",e=>h(e,Q));var UF=R,xg=f("automaticFacet/toggleSelectValue",e=>h(e,{field:UF,selection:new F({values:Ko})}));q(tr(),e=>{e.addCase(jd,(t,r)=>{let o=du(t),n=r.payload;t.defaultNumberOfResults=t.numberOfResults=n,t.firstResult=On(o,n);}).addCase($d,(t,r)=>{t.numberOfResults=r.payload,t.firstResult=0;}).addCase(Vi,t=>{t.firstResult=0;}).addCase(zd,(t,r)=>{let o=r.payload;t.firstResult=On(o,t.numberOfResults);}).addCase(gt,(t,r)=>{let o=r.payload;t.firstResult=On(o,t.numberOfResults);}).addCase(Wd,t=>{let r=du(t),o=Math.max(r-1,1);t.firstResult=On(o,t.numberOfResults);}).addCase(Hd,t=>{let r=du(t),o=QF(t),n=Math.min(r+1,o);t.firstResult=On(n,t.numberOfResults);}).addCase(ge.fulfilled,(t,r)=>{r.payload&&(t.numberOfResults=r.payload.pagination.numberOfResults,t.firstResult=r.payload.pagination.firstResult);}).addCase(Re,(t,r)=>{t.firstResult=r.payload.firstResult??t.firstResult,t.numberOfResults=r.payload.numberOfResults??t.defaultNumberOfResults;}).addCase(oe.fulfilled,(t,r)=>{let{response:o}=r.payload;t.totalCountFiltered=o.totalCountFiltered;}).addCase(Zt.fulfilled,(t,r)=>{let{response:o}=r.payload;t.totalCountFiltered=o.pagination.totalCount;}).addCase(ie,t=>{Pe(t);}).addCase(Ye,t=>{Pe(t);}).addCase($e,t=>{Pe(t);}).addCase(ke,t=>{Pe(t);}).addCase(bt,t=>{Pe(t);}).addCase(je,t=>{Pe(t);}).addCase(_l,t=>{Pe(t);}).addCase(Wt,t=>{Pe(t);}).addCase(Yr,t=>{Pe(t);}).addCase(Ke,t=>{Pe(t);}).addCase(Te,t=>{Pe(t);}).addCase(fe,t=>{Pe(t);}).addCase(Za,t=>{Pe(t);}).addCase(ar,t=>{Pe(t);}).addCase(At,t=>{Pe(t);}).addCase(xg,t=>{Pe(t);});});function Pe(e){e.firstResult=tr().firstResult;}function du(e){let{firstResult:t,numberOfResults:r}=e;return vg(t,r)}function QF(e){let{totalCountFiltered:t,numberOfResults:r}=e;return Fg(t,r)}function On(e,t){return (e-1)*t}function vg(e,t){return Math.round(e/t)+1}function Fg(e,t){let r=Math.min(e,5e3);return Math.ceil(r/t)}new z({parameters:new F({options:{required:!0},values:wa})});var Ag=new z({fragment:new C});function bg(e,t){let r;function o(){r=t.requestIdSelector(e[w]);}function n(){return r!==t.requestIdSelector(e[w])}qe(e,Ag,t.initialState,"buildUrlManager");let a=_(e),i=t.initialState.fragment;o();let c=t.parameterManagerBuilder(e,{initialState:{parameters:t.serializer.deserialize(i)}});return {...a,subscribe(u){let s=()=>{let l=this.state.fragment;!_F(t.serializer.deserialize,i,l)&&n()&&(i=l,u()),o();};return s(),e.subscribe(s)},get state(){return {fragment:t.serializer.serialize(c.state.parameters)}},synchronize(u){i=u;let s=t.serializer.deserialize(u);c.synchronize(s);}}}function _F(e,t,r){if(t===r)return !0;let o=e(t),n=e(r);return Qr(o,n)}function Pg(e,t){return {...wg(e,t),didYouMean(){return Hf(e)}}}function Ig(e,t){return wg(e,t)}function wg(e,t){let{fetchProductsActionCreator:r,facetResponseSelector:o,isFacetLoadingResponseSelector:n,requestIdSelector:a,parameterManagerBuilder:i,serializer:c}=t;return {...mu(e,t),sort(u){return sg(e,{...u,fetchProductsActionCreator:r})},facetGenerator(){let u={fetchProductsActionCreator:r,facetResponseSelector:o,isFacetLoadingResponseSelector:n};return Zf(e,{buildRegularFacet:(s,l)=>rg(e,{...l,...u}),buildNumericFacet:(s,l)=>eg(e,{...l,...u}),buildDateFacet:(s,l)=>Xf(e,{...l,...u}),buildCategoryFacet:(s,l)=>Jf(e,{...l,...u})})},breadcrumbManager(){return Yf(e,{facetResponseSelector:o,fetchProductsActionCreator:r})},urlManager(u){return bg(e,{...u,requestIdSelector:a,parameterManagerBuilder:i,serializer:c})}}}function mu(e,t){let{responseIdSelector:r,fetchProductsActionCreator:o,fetchMoreProductsActionCreator:n,slotId:a}=t;return {interactiveProduct(i){return cg(e,{...i,responseIdSelector:r})},pagination(i){return og(e,{...i,options:{...i?.options,slotId:a},fetchProductsActionCreator:o,fetchMoreProductsActionCreator:n})}}}function Xi(e,t){return !!t&&t.facetId in e.commerceFacetSet}var Eg=(e,t)=>{let r=e.productListing.facets.find(o=>o.facetId===t);if(Xi(e,r))return r},Og=e=>e.productListing.isLoading;var jF=e=>new z({parameters:new F({options:{required:!0},values:e})});function Zi(e,t){let{dispatch:r}=e,o=_(e);return qe(e,jF(t.parametersDefinition),t.initialState,"buildCoreParameterManager"),r(t.restoreActionCreator(t.initialState.parameters)),{...o,synchronize(n){let a=t.activeParametersSelector(e[w]),i=t.enrichParameters(e[w],a),c=t.enrichParameters(e[w],n);Qr(i,c)||(r(t.restoreActionCreator(n)),r(t.fetchProductsActionCreator()));},get state(){return {parameters:t.activeParametersSelector(e[w])}}}}function qg(e,t){return Zi(e,{...t,parametersDefinition:vi,activeParametersSelector:$F,restoreActionCreator:cp,fetchProductsActionCreator:ae,enrichParameters:()=>({})})}function $F(e){return {}}function zF(e){if(!HF(e));let t=_(e),{dispatch:r}=e,o=()=>e[w],n=Ig(e,{responseIdSelector:si,fetchProductsActionCreator:ae,fetchMoreProductsActionCreator:ho,facetResponseSelector:Eg,isFacetLoadingResponseSelector:Og,requestIdSelector:Nm,parameterManagerBuilder:qg,serializer:Bf});return {...t,...n,get state(){let{products:a,error:i,isLoading:c,responseId:u}=o().productListing;return {products:a,error:i,isLoading:c,responseId:u}},refresh:()=>r(ae())}}function HF(e){return e.addReducers({productListing:ur,commerceContext:zt,configuration:le}),!0}function WF(e,t){if(!KF(e));qe(e,Zm,t.options,"buildRecommendations");let r=_(e),{dispatch:o}=e,{slotId:n,productId:a}=t.options;o(mi({slotId:n}));let i=D(u=>u.recommendations[n],u=>u),c=mu(e,{slotId:n,responseIdSelector:u=>u.recommendations[n].responseId,fetchProductsActionCreator:()=>Lt({slotId:n}),fetchMoreProductsActionCreator:()=>Co({slotId:n})});return {...r,...c,get state(){return i(e[w])},refresh:()=>o(Lt({slotId:n,productId:a}))}}function KF(e){return e.addReducers({recommendations:Fi}),!0}var ec=(e,t)=>{let r=e.commerceSearch.facets.find(o=>o.facetId===t);if(Xi(e,r))return r},tc=e=>e.commerceSearch.isLoading;function Tg(e,t){if(!XF(e));return Zi(e,{...t,activeParametersSelector:GF,restoreActionCreator:xo,parametersDefinition:Ri,fetchProductsActionCreator:G,enrichParameters:(r,o)=>({q:xn().query,...o})})}function GF(e){return {...JF(e)}}function JF(e){if(e.commerceQuery===void 0)return {};let t=e.commerceQuery.query;return t!==xn().query?{q:t}:{}}function XF(e){return e.addReducers({commerceQuery:Xe}),!0}function ZF(e){if(!eA(e));let t=_(e),{dispatch:r}=e,o=()=>e[w],n=Pg(e,{responseIdSelector:yn,fetchProductsActionCreator:G,fetchMoreProductsActionCreator:yo,facetResponseSelector:ec,isFacetLoadingResponseSelector:tc,requestIdSelector:Qm,parameterManagerBuilder:Tg,serializer:Qf});return {...t,...n,get state(){return o().commerceSearch},executeFirstSearch(){yn(o())===""&&r(G());}}}function eA(e){return e.addReducers({commerceContext:zt,configuration:le,commerceSearch:St,commerceQuery:Xe}),!0}q(be(),e=>e.addCase(ht,(t,r)=>({...t,...r.payload})).addCase(uo,(t,r)=>{t.q=r.payload;}).addCase(ut,(t,r)=>{t.q=r.payload.expression;}).addCase(ge.fulfilled,(t,r)=>r.payload?.query??t).addCase(Re,(t,r)=>{t.q=r.payload.q??t.q,t.enableQuerySyntax=r.payload.enableQuerySyntax??t.enableQuerySyntax;}));function kg(e,t){return e=rA(e),e.replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,(r,o,n,a)=>o?pu(o,t.notMatchDelimiters):n?pu(n,t.exactMatchDelimiters):a?pu(a,t.correctionDelimiters):r)}function pu(e,t){return t?t.open+e+t.close:e}function rA(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r="(?:"+Object.keys(t).join("|")+")",o=RegExp(r),n=RegExp(r,"g");return o.test(e)?e.replace(n,a=>t[a]):e}var fu={open:new C,close:new C},gu={id:R,numberOfSuggestions:new P({min:0}),enableQuerySyntax:new V,highlightOptions:new F({values:{notMatchDelimiters:new F({values:fu}),exactMatchDelimiters:new F({values:fu}),correctionDelimiters:new F({values:fu})}}),clearFilters:new V};new z(gu);function Dg(e,t){return e?e.completions.map(r=>({highlightedValue:kg(r.highlighted,t),rawValue:r.expression})):[]}var rc={clearFilters:!0},{id:nA,highlightOptions:aA,clearFilters:iA}=gu,hu={id:nA,highlightOptions:aA,clearFilters:iA},Vg=new z(hu);function yu(e,t={}){if(!cA(e));let r=_(e),{dispatch:o}=e,n=()=>e[w],a=t.options?.id||Cr("search_box"),i={id:a,highlightOptions:{...t.options?.highlightOptions},...rc,...t.options};Ie(e,Vg,i,"buildSearchBox"),o(In({id:a,query:n().commerceQuery.query??""})),o(Nr({id:a}));let c=()=>n().querySet[i.id],u=async()=>{let s={query:c(),clearFilters:i.clearFilters};o(li(s)),o(G());};return {...r,updateText(s){o(Po({id:a,query:s})),this.showSuggestions();},clear(){o(Po({id:a,query:""})),o(Ut({id:a}));},showSuggestions(){o(Ve({id:a}));},selectSuggestion(s){o(ut({id:a,expression:s})),u().then(()=>{o(Ut({id:a}));});},submit(){u(),o(Ut({id:a}));},get state(){let s=n().querySuggest[i.id],l=Dg(s,i.highlightOptions),d=s?s.isLoading:!1;return {value:c(),suggestions:l,isLoading:n().commerceSearch.isLoading,isLoadingSuggestions:d}}}}function cA(e){return e.addReducers({commerceQuery:Xe,querySuggest:Ur,configuration:le,querySet:wn,commerceSearch:St}),!0}var sA={queries:new H({required:!0,each:new C({emptyAllowed:!1})}),maxLength:new P({required:!0,min:1,default:10})},Eo=f("recentQueries/registerRecentQueries",e=>h(e,sA)),Oo=f("recentQueries/clearRecentQueries");function oc(){return {queries:[],maxLength:10}}q(oc(),e=>{e.addCase(Eo,Su).addCase(Oo,Cu).addCase(oe.fulfilled,(t,r)=>{let o=r.payload.queryExecuted.trim(),n=r.payload.response.results;!o.length||!n.length||xu(o,t);});});function Su(e,t){e.queries=t.payload.queries.slice(0,t.payload.maxLength),e.maxLength=t.payload.maxLength;}function Cu(e){e.queries=[];}function xu(e,t){t.queries=t.queries.filter(o=>o!==e);let r=t.queries.slice(0,t.maxLength-1);t.queries=[e,...r];}var Ng=q(oc(),e=>{e.addCase(Eo,Su).addCase(Oo,Cu).addCase(G.fulfilled,(t,r)=>{let o=r.payload.queryExecuted?.trim()||"",n=r.payload.response.products;!o.length||!n.length||xu(o,t);});});var uA={queries:[]},lA={maxLength:10,clearFilters:!0},dA=new z({queries:new H({required:!0})}),mA=new z({maxLength:new P({required:!0,min:1}),clearFilters:new V});function pA(e,t){Ie(e,mA,t?.options,"buildRecentQueriesList"),qe(e,dA,t?.initialState,"buildRecentQueriesList");}function fA(e,t){if(!gA(e));let r=_(e),{dispatch:o}=e,n=()=>e[w],a={...lA,...t?.options},i={...uA,...t?.initialState};pA(e,{options:a,initialState:i});let c={queries:i.queries,maxLength:a.maxLength};return o(Eo(c)),{...r,get state(){let u=n();return {...u.recentQueries,analyticsEnabled:u.configuration.analytics.enabled}},clear(){o(Oo());},executeRecentQuery(u){let s=new P({required:!0,min:0,max:this.state.queries.length}).validate(u);if(s)throw new Error(s);let l={query:this.state.queries[u],clearFilters:a.clearFilters};o(li(l)),o(G());}}}function gA(e){return e.addReducers({search:St,recentQueries:Ng}),!0}var Ru={id:R},hA={...Ru,query:pe},nc=f("instantProducts/register",e=>h(e,Ru)),ac=f("instantProducts/updateQuery",e=>h(e,hA)),ic=f("instantProducts/clearExpired",e=>h(e,Ru));function cc(e){return e?e.expiresAt&&Date.now()>=e.expiresAt:!1}var Mg=(e,t)=>{let{id:r}=e;if(!t[r])return t[r]={q:"",cache:{}},t},Lg=(e,t)=>{let{q:r,id:o}=e;r&&(t[o].q=r);},Ug=(e,t)=>{let{id:r}=e;Object.entries(t[r].cache).forEach(([o,n])=>{cc(n)&&delete t[r].cache[o];});},Qg=(e,t,r)=>{for(let n in t)for(let a in t[n].cache)t[n].cache[a].isActive=!1;if(!vu(e,t)){yA(e,t,r);return}let o=vu(e,t);o.isLoading=!0,o.isActive=!0,o.error=null;},Bg=(e,t,r)=>{let{id:o,q:n,searchUid:a,cacheTimeout:i,totalCountFiltered:c,duration:u}=e;t[o].cache[n]={...vu(e,t),...r,isActive:!0,searchUid:a,isLoading:!1,error:null,expiresAt:i?i+Date.now():0,totalCountFiltered:c,duration:u};},_g=(e,t)=>{let{id:r,q:o,error:n}=e;t[r].cache[o].error=n||null,t[r].cache[o].isLoading=!1,t[r].cache[o].isActive=!1;},vu=(e,t)=>{let{q:r,id:o}=e;return t[o].cache[r]||null},yA=(e,t,r)=>{let{q:o,id:n}=e;t[n].cache[o]={isLoading:!0,error:null,expiresAt:0,isActive:!0,searchUid:"",totalCountFiltered:0,duration:0,...r};};function jg(){return {}}var $g=q(jg(),e=>{e.addCase(nc,(t,r)=>{Mg(r.payload,t);}).addCase(ac,(t,r)=>{Lg({...r.payload,q:r.payload.query},t);}).addCase(ic,(t,r)=>{Ug(r.payload,t);}).addCase(So.pending,(t,r)=>{Qg(r.meta.arg,t,{products:[]});}).addCase(So.fulfilled,(t,r)=>{let{response:{products:o,responseId:n,pagination:{totalEntries:a}}}=r.payload;Bg({duration:0,searchUid:n,totalCountFiltered:a,...r.meta.arg},t,{products:o});}).addCase(So.rejected,(t,r)=>{_g(r.meta.arg,t);});});var SA={searchBoxId:X,cacheTimeout:new P},CA=new z(SA);function xA(e,t){if(!RA(e));let r=_(e),{dispatch:o}=e,n=()=>e[w],a={searchBoxId:t.options.searchBoxId||Cr("instant-products-"),cacheTimeout:t.options.cacheTimeout||6e4};Ie(e,CA,a,"buildInstantProducts");let i=a.searchBoxId;o(nc({id:i}));let c=()=>n().instantProducts[i],u=d=>c().cache[d],s=()=>c().q,l=()=>{let d=u(s());return d?d.isLoading?[]:d.products:[]};return {...r,updateQuery(d){if(!d)return;let p=u(d);(!p||!p.isLoading&&(p.error||cc(p)))&&o(So({id:i,q:d,cacheTimeout:a.cacheTimeout})),o(ac({id:i,query:d}));},clearExpired(){o(ic({id:i}));},get state(){let d=s(),p=u(d);return {query:d,isLoading:p?.isLoading||!1,error:p?.error||null,products:l()}}}}function RA(e){return e.addReducers({instantProducts:$g}),!0}function sc(e){return e.type==="redirect"}var zg=f("standaloneSearchBox/register",e=>h(e,{id:R,redirectionUrl:R})),Hg=f("standaloneSearchBox/reset",e=>h(e,{id:R})),qo=T("commerce/standaloneSearchBox/fetchRedirect",async(e,{getState:t,rejectWithValue:r,extra:o})=>{h(e,{id:new C({emptyAllowed:!1})});let n=t(),{apiClient:a}=o,i=await vA(n),c=await a.plan(i);if(ve(c))return r(c.error);let u=c.success.triggers.filter(sc);return u.length?u[0].content:""}),vA=async e=>({query:e.commerceQuery.query,...await gn(e)});var uc=class{constructor(t){this.response=t;}get basicExpression(){return this.response.parsedInput.basicExpression}get largeExpression(){return this.response.parsedInput.largeExpression}get redirectionUrl(){let t=this.response.preprocessingOutput.triggers.filter(sc);return t.length?t[0].content:null}};var Wg=f("standaloneSearchBox/register",e=>h(e,{id:R,redirectionUrl:R})),Kg=f("standaloneSearchBox/reset",e=>h(e,{id:R}));f("standaloneSearchBox/updateAnalyticsToSearchFromLink",e=>h(e,{id:R}));f("standaloneSearchBox/updateAnalyticsToOmniboxFromLink");T("standaloneSearchBox/fetchRedirect",async(e,{dispatch:t,getState:r,rejectWithValue:o,extra:{apiClient:n,validatePayload:a}})=>{a(e,{id:new C({emptyAllowed:!1})});let i=await AA(r()),c=await n.plan(i);if(We(c))return o(c.error);let{redirectionUrl:u}=new uc(c.success);return u&&t(FA(u)),u||""});var FA=e=>he("analytics/standaloneSearchBox/redirect",t=>t.makeTriggerRedirect({redirectedTo:e})),AA=async e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,timezone:e.configuration.search.timezone,q:e.query.q,...e.context&&{context:e.context.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub},...e.configuration.analytics.enabled&&{visitorId:await Ae(e.configuration.analytics)},...e.configuration.analytics.enabled&&await er(e.configuration.analytics),...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});function Yg(){return {}}var Jg=q(Yg(),e=>e.addCase(Wg,(t,r)=>{let{id:o,redirectionUrl:n}=r.payload;o in t||(t[o]=Gg(n));}).addCase(Kg,(t,r)=>{let{id:o}=r.payload,n=t[o];if(n){t[o]=Gg(n.defaultRedirectionUrl);return}}).addCase(qo.pending,(t,r)=>{let o=t[r.meta.arg.id];o&&(o.isLoading=!0);}).addCase(qo.fulfilled,(t,r)=>{let o=r.payload,n=t[r.meta.arg.id];n&&(n.redirectTo=o||n.defaultRedirectionUrl,n.isLoading=!1);}).addCase(qo.rejected,(t,r)=>{let o=t[r.meta.arg.id];o&&(o.isLoading=!1);}));function Gg(e){return {defaultRedirectionUrl:e,redirectTo:"",isLoading:!1}}var Xg=new z({...hu,redirectionUrl:new C({required:!0,emptyAllowed:!1})});function bA(e,t){if(!PA(e));let{dispatch:r}=e,o=()=>e[w],n=t.options.id||Cr("standalone_search_box"),a={id:n,highlightOptions:{...t.options.highlightOptions},...rc,...t.options};Ie(e,Xg,a,"buildStandaloneSearchBox");let i=yu(e,{options:a});return r(zg({id:n,redirectionUrl:a.redirectionUrl})),{...i,updateText(c){i.updateText(c);},selectSuggestion(c){r(ut({id:n,expression:c})),this.submit();},afterRedirection(){r(Hg({id:n}));},submit(){r(Mt({query:this.state.value})),r(qo({id:n}));},get state(){let u=o().commerceStandaloneSearchBoxSet[n];return {...i.state,redirectTo:u.redirectTo}}}}function PA(e){return e.addReducers({commerceQuery:Xe,commerceStandaloneSearchBoxSet:Jg,configuration:le,querySuggest:Ur}),!0}var IA=new z({content:new te({required:!0}),conditions:new te({required:!0}),priority:new P({required:!1,default:0,min:0}),fields:new H({required:!1,each:R})});function Zg(){let e=[],t=r=>{let o=IA.validate(r);if(!r.conditions.every(a=>a instanceof Function))throw new vr("Each template condition should be a function that takes a Result or Product as an argument and returns a boolean");return o};return {registerTemplates(...r){r.forEach(o=>{let n={...t(o),fields:o.fields||[]};e.push(n);}),e.sort((o,n)=>n.priority-o.priority);},selectTemplate(r){let o=e.find(n=>n.conditions.every(a=>a(r)));return o?o.content:null}}}function wA(){return Zg()}var lc=(e,t)=>{let r=_(e),{options:{selectNumProducts:o,selectResponseId:n,selectLoading:a,selectError:i}}=t,c=()=>e[w],u=()=>Vm(c()),s=()=>fo(c()),l=()=>go(c()),d=()=>!!n(c()),p=()=>d()&&l()>0,m=()=>p()?u()*s()+1:0,g=()=>p()?m()+(o(c())-1):0;return {...r,get state(){return {firstSearchExecuted:d(),firstProduct:m(),lastProduct:g(),totalNumberOfProducts:l(),hasProducts:p(),isLoading:a(c()),hasError:i(c())!==null}}}};function eh(e){return e.addReducers({commerceSearch:St}),!0}var EA=e=>{if(!eh(e));let t=lc(e,{options:{selectNumProducts:Sn,selectResponseId:yn,selectLoading:_m,selectError:jm}});return {...t,get state(){return {...t.state,query:$m(e[w])||""}}}};function th(e){return e.addReducers({productListing:ur}),!0}var OA=e=>{if(!th(e));return lc(e,{options:{selectNumProducts:hn,selectResponseId:si,selectLoading:Lm,selectError:Um}})};var dc=(e,t)=>{let r=e;return M(r[t])?M(e.additionalFields[t])?null:e.additionalFields[t]:r[t]},qA=e=>t=>e.every(r=>!M(dc(t,r))),TA=e=>t=>e.every(r=>M(dc(t,r))),kA=(e,t)=>r=>{let o=rh(e,r);return t.some(n=>o.some(a=>`${a}`.toLowerCase()===n.toLowerCase()))},DA=(e,t)=>r=>{let o=rh(e,r);return t.every(n=>o.every(a=>`${a}`.toLowerCase()!==n.toLowerCase()))},rh=(e,t)=>{let r=dc(t,e);return Kn(r)?r:[r]},VA={getProductProperty:dc,fieldsMustBeDefined:qA,fieldsMustNotBeDefined:TA,fieldMustMatch:kA,fieldMustNotMatch:DA};function oh(){return []}q(oh(),e=>{e.addCase(Ve.fulfilled,(t,r)=>r.payload.fieldSuggestionsFacets??[]);});Fu();/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

export { EA as E, Mt as M, No as N, OA as O, Sv as S, VA as V, WF as W, ZF as Z, zj as a, bA as b, fA as f, wA as w, xA as x, yu as y, zF as z };

//# sourceMappingURL=headless.esm2.js.map