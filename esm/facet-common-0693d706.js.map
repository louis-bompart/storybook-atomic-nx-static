{"file":"facet-common-0693d706.js","mappings":"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","names":[],"sources":["src/components/common/facets/facet-common.tsx"],"sourcesContent":["import {i18n} from 'i18next';\nimport {FacetValue, SearchStatusState} from '../types';\n\nexport interface FacetValueProps {\n  i18n: i18n;\n  displayValue: string;\n  numberOfResults: number;\n  isSelected: boolean;\n  onClick(): void;\n  searchQuery?: string;\n  class?: string;\n  part?: string;\n  additionalPart?: string;\n  buttonRef?: (element?: HTMLButtonElement) => void;\n}\n\nexport function shouldDisplayInputForFacetRange(facetRange: {\n  hasInput: boolean;\n  hasInputRange: boolean;\n  searchStatusState: SearchStatusState;\n  facetValues: Pick<FacetValue, 'numberOfResults' | 'state'>[];\n}) {\n  const {hasInput, hasInputRange, searchStatusState, facetValues} = facetRange;\n  if (!hasInput) {\n    return false;\n  }\n\n  if (hasInputRange) {\n    return true;\n  }\n\n  if (!searchStatusState.hasResults) {\n    return false;\n  }\n\n  const onlyValuesWithResultsOrActive =\n    facetValues.filter(\n      (value) => value.numberOfResults || value.state !== 'idle'\n    ) || [];\n\n  if (!onlyValuesWithResultsOrActive.length) {\n    return false;\n  }\n\n  return true;\n}\n\nexport type BaseFacetElement = HTMLElement & {\n  facetId: string;\n  isCollapsed: boolean;\n};\n\nexport function sortFacetVisibility(\n  facetElements: BaseFacetElement[],\n  facetInfoMap: Record<string, {isHidden: () => boolean}>\n) {\n  const visibleFacets: BaseFacetElement[] = [];\n  const invisibleFacets: BaseFacetElement[] = [];\n\n  facetElements.forEach((facet) => {\n    if (facetInfoMap[facet.facetId] && facetInfoMap[facet.facetId].isHidden()) {\n      invisibleFacets.push(facet);\n    } else {\n      visibleFacets.push(facet);\n    }\n  });\n\n  return {visibleFacets, invisibleFacets};\n}\n\nexport function collapseFacetsAfter(\n  facets: BaseFacetElement[],\n  visibleFacetsCount: number\n) {\n  if (visibleFacetsCount === -1) {\n    return;\n  }\n\n  facets.forEach((facet, index) => {\n    facet.isCollapsed = index + 1 > visibleFacetsCount;\n  });\n}\n\nexport function isAutomaticFacetGenerator(\n  element: HTMLElement\n): element is HTMLAtomicAutomaticFacetGeneratorElement {\n  return element.tagName === 'ATOMIC-AUTOMATIC-FACET-GENERATOR';\n}\n\nfunction isPseudoFacet(el: Element): el is BaseFacetElement {\n  return 'facetId' in el;\n}\n\nexport function getFacetsInChildren(parent: HTMLElement): BaseFacetElement[] {\n  const facets = Array.from(parent.children).filter((child) =>\n    isPseudoFacet(child)\n  ) as BaseFacetElement[];\n\n  return facets;\n}\nexport function getAutomaticFacetGenerator(\n  parent: HTMLElement\n): HTMLAtomicAutomaticFacetGeneratorElement | undefined {\n  return (Array.from(parent.children) as HTMLElement[]).find(\n    isAutomaticFacetGenerator\n  );\n}\n\nconst get2DMatrix = (xSize: number, ySize: number = 0) =>\n  new Array(xSize).fill(null).map(() => new Array(ySize));\n\nfunction findIndiceOfParent(\n  facet: BaseFacetElement,\n  parents: (HTMLElement | null)[]\n) {\n  for (let i = 0; i < parents.length; i++) {\n    if (parents[i]?.contains(facet)) {\n      return i;\n    }\n  }\n  return parents.length;\n}\n\n/**\n * Triage elements by their parents.\n * @param facets Facet Elements\n * @param parents Elements that may contains the facets\n * @returns an array in the same order as the parents, containing the facets that are contained by the corresponding parent.\n * The last element of the array contains the facets that are not contained by any of the parents.\n */\nexport function triageFacetsByParents(\n  facets: BaseFacetElement[],\n  ...parents: (HTMLElement | null)[]\n) {\n  const sortedFacets: BaseFacetElement[][] = get2DMatrix(parents.length + 1);\n  for (const facet of facets) {\n    const indice = findIndiceOfParent(facet, parents);\n    sortedFacets[indice].push(facet);\n  }\n  return sortedFacets;\n}\n"],"version":3}