{"version":3,"names":["SmartSnippetSuggestionCommon","constructor","props","this","style","styleTag","_a","getHost","querySelector","content","getSnippetStyle","innerHTML","getRelatedQuestionId","index","id","getQuestionPart","prefix","relatedQuestion","expanded","toggleQuestion","getQuestionsList","collapse","questionAnswerId","expand","renderQuestion","headingLevel","getHeadingLevel","h","Button","part","onClick","class","ariaExpanded","ariaControls","icon","ArrowDown","ArrowRight","Heading","level","question","renderContent","exportparts","htmlContent","answer","innerStyle","onSelectInlineLink","e","selectInlineLink","detail","onBeginDelayedSelectInlineLink","beginDelayedSelectInlineLink","onCancelPendingSelectInlineLink","cancelPendingSelectInlineLink","renderSource","source","getBindings","i18n","t","anchorAttributes","_b","getSourceAnchorAttributes","call","onSelectSource","selectSource","onBeginDelayedSelectSource","beginDelayedSelectSource","onCancelPendingSelectSource","cancelPendingSelectSource","hideDuringRender","shouldHide","host","visibility","position","renderRelatedQuestion","key","render","getState","questions","length","Hidden","map","i"],"sources":["src/components/common/smart-snippets/atomic-smart-snippet-suggestions/smart-snippet-suggestions-common.tsx"],"sourcesContent":["import {\n  SmartSnippetRelatedQuestion,\n  SmartSnippetQuestionsList,\n  SmartSnippetQuestionsListState,\n} from '@coveo/headless';\nimport {h} from '@stencil/core';\nimport ArrowDown from '../../../../images/arrow-down.svg';\nimport ArrowRight from '../../../../images/arrow-right.svg';\nimport {Button} from '../../button';\nimport {Heading} from '../../heading';\nimport {Hidden} from '../../hidden';\nimport {AnyBindings} from '../../interface/bindings';\n\ninterface SmartSnippetSuggestionProps {\n  id: string;\n  getSourceAnchorAttributes?: () => Attr[] | undefined;\n  getHost: () => HTMLElement;\n  getBindings: () => AnyBindings;\n  getHeadingLevel: () => number;\n  getState: () => SmartSnippetQuestionsListState;\n  getQuestionsList: () => SmartSnippetQuestionsList;\n  getSnippetStyle: () => string | undefined;\n}\n\nexport class SmartSnippetSuggestionCommon {\n  constructor(private props: SmartSnippetSuggestionProps) {}\n\n  private get style() {\n    const styleTag = this.props\n      .getHost()\n      .querySelector('template')\n      ?.content.querySelector('style');\n    if (!styleTag) {\n      return this.props.getSnippetStyle();\n    }\n    return styleTag.innerHTML;\n  }\n\n  private getRelatedQuestionId(index: number) {\n    return `${this.props.id}-${index}`;\n  }\n\n  private getQuestionPart(\n    prefix: string,\n    relatedQuestion: SmartSnippetRelatedQuestion\n  ) {\n    return prefix + (relatedQuestion.expanded ? '-expanded' : '-collapsed');\n  }\n\n  private toggleQuestion(relatedQuestion: SmartSnippetRelatedQuestion) {\n    if (relatedQuestion.expanded) {\n      this.props.getQuestionsList().collapse(relatedQuestion.questionAnswerId);\n    } else {\n      this.props.getQuestionsList().expand(relatedQuestion.questionAnswerId);\n    }\n  }\n\n  private renderQuestion(\n    relatedQuestion: SmartSnippetRelatedQuestion,\n    index: number\n  ) {\n    const headingLevel = this.props.getHeadingLevel();\n    return (\n      <Button\n        style=\"text-neutral\"\n        part={this.getQuestionPart('question-button', relatedQuestion)}\n        onClick={() => this.toggleQuestion(relatedQuestion)}\n        class=\"flex items-center px-4\"\n        ariaExpanded={`${relatedQuestion.expanded}`}\n        ariaControls={this.getRelatedQuestionId(index)}\n      >\n        <atomic-icon\n          icon={relatedQuestion.expanded ? ArrowDown : ArrowRight}\n          part={this.getQuestionPart('question-icon', relatedQuestion)}\n          class=\"w-2.5 mr-3 stroke-[1.25]\"\n        ></atomic-icon>\n        <Heading\n          level={headingLevel ? headingLevel + 1 : headingLevel}\n          class=\"text-left text-xl font-bold py-4\"\n          part={this.getQuestionPart('question-text', relatedQuestion)}\n        >\n          {relatedQuestion.question}\n        </Heading>\n      </Button>\n    );\n  }\n\n  private renderContent(relatedQuestion: SmartSnippetRelatedQuestion) {\n    return (\n      <atomic-smart-snippet-answer\n        exportparts=\"answer\"\n        htmlContent={relatedQuestion.answer}\n        innerStyle={this.style}\n        onSelectInlineLink={(e) =>\n          this.props\n            .getQuestionsList()\n            .selectInlineLink(relatedQuestion.questionAnswerId, e.detail)\n        }\n        onBeginDelayedSelectInlineLink={(e) =>\n          this.props\n            .getQuestionsList()\n            .beginDelayedSelectInlineLink(\n              relatedQuestion.questionAnswerId,\n              e.detail\n            )\n        }\n        onCancelPendingSelectInlineLink={(e) =>\n          this.props\n            .getQuestionsList()\n            .cancelPendingSelectInlineLink(\n              relatedQuestion.questionAnswerId,\n              e.detail\n            )\n        }\n      ></atomic-smart-snippet-answer>\n    );\n  }\n\n  private renderSource(relatedQuestion: SmartSnippetRelatedQuestion) {\n    const {source} = relatedQuestion;\n    if (!source) {\n      return [];\n    }\n    return (\n      <footer\n        part=\"footer\"\n        aria-label={this.props.getBindings().i18n.t('smart-snippet-source')}\n      >\n        {\n          <atomic-smart-snippet-source\n            source={source}\n            anchorAttributes={this.props.getSourceAnchorAttributes?.()}\n            onSelectSource={() =>\n              this.props\n                .getQuestionsList()\n                .selectSource(relatedQuestion.questionAnswerId)\n            }\n            onBeginDelayedSelectSource={() =>\n              this.props\n                .getQuestionsList()\n                .beginDelayedSelectSource(relatedQuestion.questionAnswerId)\n            }\n            onCancelPendingSelectSource={() =>\n              this.props\n                .getQuestionsList()\n                .cancelPendingSelectSource(relatedQuestion.questionAnswerId)\n            }\n          ></atomic-smart-snippet-source>\n        }\n      </footer>\n    );\n  }\n\n  public hideDuringRender(shouldHide: boolean) {\n    const host = this.props.getHost();\n    host.style.visibility = shouldHide ? 'hidden' : '';\n    host.style.position = shouldHide ? 'absolute' : '';\n  }\n\n  public renderRelatedQuestion(\n    relatedQuestion: SmartSnippetRelatedQuestion,\n    index: number\n  ) {\n    return (\n      <li\n        key={relatedQuestion.questionAnswerId}\n        part={this.getQuestionPart('question-answer', relatedQuestion)}\n        class=\"flex flex-col\"\n      >\n        <article class=\"contents\">\n          {this.renderQuestion(relatedQuestion, index)}\n          {relatedQuestion.expanded && (\n            <div\n              part=\"answer-and-source\"\n              class=\"pl-10 pr-6 pb-6\"\n              id={this.getRelatedQuestionId(index)}\n            >\n              {this.renderContent(relatedQuestion)}\n              {this.renderSource(relatedQuestion)}\n            </div>\n          )}\n        </article>\n      </li>\n    );\n  }\n\n  public render() {\n    if (!this.props.getState().questions.length) {\n      return <Hidden></Hidden>;\n    }\n\n    return (\n      <aside\n        part=\"container\"\n        class=\"bg-background border border-neutral rounded-lg text-on-background overflow-hidden\"\n      >\n        <Heading\n          level={this.props.getHeadingLevel()}\n          part=\"heading\"\n          class=\"px-6 py-4 text-xl leading-8 border-b border-neutral\"\n        >\n          {this.props.getBindings().i18n.t('smart-snippet-people-also-ask')}\n        </Heading>\n        <ul part=\"questions\" class=\"divide-neutral divide-y\">\n          {this.props\n            .getState()\n            .questions.map((relatedQuestion, i) =>\n              this.renderRelatedQuestion(relatedQuestion, i)\n            )}\n        </ul>\n      </aside>\n    );\n  }\n}\n"],"mappings":"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"}