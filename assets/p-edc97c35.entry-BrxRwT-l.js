import{N as y,O as g,g as v}from"./atomic-breadbox.new.stories-D5_t4T0B.js";import{s as d}from"./p-b6da4b1f-BEE80E8s.js";import{p as u}from"./p-794b93a9-Bwn0XXeG.js";import{S as w,d as T,m as N}from"./p-f5723aee-D-iZ1npx.js";import{i as C}from"./p-053b4bcb-CV68hI9Q.js";import{t as M}from"./p-4328fcc3-C1crOUOq.js";import"./index-Bqoxw6Vv.js";import"./_commonjsHelpers-BosuxZz1.js";import"./iframe-0V_eukm8.js";import"../sb-preview/runtime.js";import"./p-7e7b1a62-C6-3oFSh.js";import"./p-e9c4f463-BPmi-3c5.js";function b(e){return C(e)?"section":T(e)?N(e)&&e.tagName.toLowerCase()===M?"table-column-definition":"other":"metadata"}function E(e){return w(Array.from(e),t=>b(t))}class ${constructor({host:t,setError:o,validParents:r,allowEmpty:i=!1}){this.matchConditions=[],this.host=t,this.validateTemplate(t,o,r,i)}validateTemplate(t,o,r,i=!0){var n;const a=r.map(p=>p.toUpperCase()).includes(((n=t.parentElement)===null||n===void 0?void 0:n.nodeName)||""),s=t.nodeName.toLowerCase();if(!a){o(new Error(`The "${s}" component has to be the child of one of the following: ${r.map(p=>`"${p.toLowerCase()}"`).join(", ")}.`));return}const c=t.querySelector("template");if(!c){o(new Error(`The "${s}" component must contain a "template" element as a child.`));return}if(!i&&!c.innerHTML.trim()){o(new Error(`The "template" tag inside "${s}" cannot be empty.`));return}c.content.querySelector("script")&&console.warn('Any "script" tags defined inside of "template" elements are not supported and will not be executed when the products are rendered.',t);const{section:m,other:l}=E(c.content.childNodes);m!=null&&m.length&&(l!=null&&l.length)&&console.warn("Product templates should only contain section elements or non-section elements. Future updates could unpredictably affect this product template.",t,{sectionNodes:m,otherNodes:l})}getTemplate(t,o){return o?null:{conditions:t.concat(this.matchConditions),content:L(this.host).content,priority:1}}renderIfError(t){if(t)return v("atomic-component-error",{element:this.host,error:t})}}function L(e){return e.querySelector("template")}function O(e,t){const o=[];for(const r in e)o.push(u.fieldMustMatch(r,e[r]));for(const r in t)o.push(u.fieldMustNotMatch(r,t[r]));return o}var h=function(e,t,o,r){var i=arguments.length,n=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,o):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(n=(i<3?a(n):i>3?a(t,o,n):a(t,o))||n);return i>3&&n&&Object.defineProperty(t,o,n),n};const f=class{constructor(e){y(this,e),this.conditions=[],this.mustMatch={},this.mustNotMatch={},this.error=void 0,this.conditions=[],this.productTemplateCommon=new $({host:this.host,setError:t=>{this.error=t},validParents:["atomic-commerce-product-list","atomic-commerce-recommendation-list"],allowEmpty:!0})}componentWillLoad(){this.productTemplateCommon.matchConditions=O(this.mustMatch,this.mustNotMatch)}async getTemplate(){return this.productTemplateCommon.getTemplate(this.conditions,this.error)}render(){return this.productTemplateCommon.renderIfError(this.error)}get host(){return g(this)}};h([d({splitValues:!0})],f.prototype,"mustMatch",void 0);h([d({splitValues:!0})],f.prototype,"mustNotMatch",void 0);export{f as atomic_product_template};
