{"file":"atomic-aria-live.entry.cjs.js","mappings":";;;;;;;;;MAsBa,cAAc;;;QAER,YAAO,GAAsB,EAAE,CAAC;QAEzC,kBAAa,GAAGA,iCAAmB,CAAC,EAAC,KAAK,EAAE,GAAG,EAAC,CAAC,CAAC;QAClD,OAAE,GAAGC,cAAQ,CAAC,YAAY,CAAC,CAAC;uBAHU,EAAE;;IAMtC,cAAc,CAAC,EAAC,MAAM,EAAE,IAAI,EAAqC;QACzE,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE;YAC9C,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC;SAC1B;KACF;IAED,IAAY,mBAAmB;QAC7B,IAAI,OAAO,GAAmB,IAAI,CAAC,IAAI,CAAC;QACxC,OAAO,OAAO,EAAE;YACd,IAAI,OAAO,CAAC,OAAO,KAAK,yBAAyB,EAAE;gBACjD,OAAO,IAAI,CAAC;aACb;YACD,OAAO,GAAG,OAAO,CAAC,aAAa,CAAC;SACjC;QACD,OAAO,KAAK,CAAC;KACd;;;;IAMM,MAAM,aAAa,CACxB,MAAc,EACd,OAAe,EACf,SAAkB;QAElB,MAAM,YAAY,GAAG,OAClB,IAAI,CAAC,OAAO,GAAG,EAAC,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC,MAAM,GAAG,EAAC,SAAS,EAAE,OAAO,EAAC,EAAC,CAAC,CAAC;QAErE,IAAI,OAAO,EAAE;YACX,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;SAClD;aAAM;YACL,IAAI,CAAC,aAAa,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;YAChD,YAAY,EAAE,CAAC;SAChB;KACF;;;;IAMM,MAAM,cAAc,CAAC,MAAc,EAAE,SAAkB;QAC5D,IAAI,MAAM,IAAI,IAAI,CAAC,OAAO,EAAE;YAC1B,OAAO;SACR;QACD,IAAI,CAAC,OAAO,GAAG,EAAC,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC,MAAM,GAAG,EAAC,SAAS,EAAE,OAAO,EAAE,EAAE,EAAC,EAAC,CAAC;KACtE;IAEM,oBAAoB;QACzB,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;KAC5B;IAEM,MAAM;QACX,QACEC,QAACC,UAAI,qDACH,KAAK,EAAE;gBACL,QAAQ,EAAE,UAAU;gBACpB,OAAO,EAAE,OAAO;gBAChB,MAAM,EAAE,GAAG;gBACX,QAAQ,EAAE,QAAQ;gBAClB,MAAM,EAAE,GAAG;aACZ,IAEA,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,CAC/B,CAAC,CAAC,UAAU,EAAE,EAAC,SAAS,EAAE,OAAO,EAAC,CAAC,MACjCD,iBACE,GAAG,EAAE,UAAU,EACf,EAAE,EAAE,GAAG,IAAI,CAAC,EAAE,IAAI,UAAU,EAAE,eACnB,SAAS,GAAG,WAAW,GAAG,QAAQ,EAC7C,IAAI,EAAC,QAAQ,IAEZ,OAAO,CACJ,CACP,CACF,CACI,EACP;KACH;;;;;;","names":["buildDebouncedQueue","randomID","h","Host"],"sources":["src/components/search/atomic-search-interface/atomic-aria-live.tsx"],"sourcesContent":["import {\r\n  Component,\r\n  h,\r\n  Host,\r\n  State,\r\n  Element,\r\n  Method,\r\n  Listen,\r\n} from '@stencil/core';\r\nimport {FindAriaLiveEventArgs} from '../../../utils/accessibility-utils';\r\nimport {buildDebouncedQueue} from '../../../utils/debounce-utils';\r\nimport {randomID} from '../../../utils/utils';\r\n\r\ntype Regions = {[regionName: string]: {assertive: boolean; message: string}};\r\n\r\n/**\r\n * The `atomic-aria-live` component notifies screen readers of changes in the search interface.\r\n */\r\n@Component({\r\n  tag: 'atomic-aria-live',\r\n  shadow: false,\r\n})\r\nexport class AtomicAriaLive {\r\n  @Element() private host!: HTMLAtomicAriaLiveElement;\r\n  @State() private regions: Readonly<Regions> = {};\r\n\r\n  private messagesQueue = buildDebouncedQueue({delay: 500});\r\n  private id = randomID('aria-live-');\r\n\r\n  @Listen('atomic/accessibility/findAriaLive', {target: 'document'})\r\n  protected onFindAriaLive({detail: args}: CustomEvent<FindAriaLiveEventArgs>) {\r\n    if (!args.element || !this.isInSearchInterface) {\r\n      args.element = this.host;\r\n    }\r\n  }\r\n\r\n  private get isInSearchInterface() {\r\n    let element: Element | null = this.host;\r\n    while (element) {\r\n      if (element.tagName === 'ATOMIC-SEARCH-INTERFACE') {\r\n        return true;\r\n      }\r\n      element = element.parentElement;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * @internal\r\n   */\r\n  @Method()\r\n  public async updateMessage(\r\n    region: string,\r\n    message: string,\r\n    assertive: boolean\r\n  ) {\r\n    const updateRegion = () =>\r\n      (this.regions = {...this.regions, [region]: {assertive, message}});\r\n\r\n    if (message) {\r\n      this.messagesQueue.enqueue(updateRegion, region);\r\n    } else {\r\n      this.messagesQueue.cancelActionIfQueued(region);\r\n      updateRegion();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @internal\r\n   */\r\n  @Method()\r\n  public async registerRegion(region: string, assertive: boolean) {\r\n    if (region in this.regions) {\r\n      return;\r\n    }\r\n    this.regions = {...this.regions, [region]: {assertive, message: ''}};\r\n  }\r\n\r\n  public disconnectedCallback() {\r\n    this.messagesQueue.clear();\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <Host\r\n        style={{\r\n          position: 'absolute',\r\n          display: 'block',\r\n          height: '0',\r\n          overflow: 'hidden',\r\n          margin: '0',\r\n        }}\r\n      >\r\n        {Object.entries(this.regions).map(\r\n          ([regionName, {assertive, message}]) => (\r\n            <div\r\n              key={regionName}\r\n              id={`${this.id}-${regionName}`}\r\n              aria-live={assertive ? 'assertive' : 'polite'}\r\n              role=\"status\"\r\n            >\r\n              {message}\r\n            </div>\r\n          )\r\n        )}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"version":3}