{"version":3,"names":["CategoryFacetAllCategoryButton","i18n","onClick","allCategories","t","h","Button","style","part","icon","LeftArrow","class","CategoryFacetValueLink","displayValue","numberOfResults","isParent","isSelected","searchQuery","isLeafValue","setRef","children","partNames","push","FacetValueLink","join","buttonRef","btn","subList","FacetValueLabelHighlight","CategoryFacetChildValueLink","props","CategoryFacetChildrenAsTreeContainer","className","CategoryFacetParentAsTreeContainer","isTopLevel","CategoryFacetParentButton","field","facetValue","getFieldValueCaption","value","ariaLabel","count","ariaPressed","CategoryFacetParentValueLink","CategoryFacetSearchResultsContainer","_","SEPARATOR","ELLIPSIS","PATH_MAX_LENGTH","CategoryFacetSearchValue","toLocaleString","language","inLabel","localizedPath","path","length","map","child","parent","ellipsedPath","firstPart","slice","lastParts","concat","renderPath","index","key","text","CategoryFacetTreeValueContainer","atomicCategoryFacetCss","AtomicCategoryFacetStyle0","AtomicCategoryFacet","this","resultIndexToFocusOnShowMore","label","numberOfValues","withSearch","sortCriteria","delimitingCharacter","basePath","filterByBasePath","isCollapsed","headingLevel","filterFacetCount","injectionDepth","dependsOn","initialize","searchStatus","buildSearchStatus","bindings","engine","options","facetId","facetSearch","facet","buildCategoryFacet","announceFacetSearchResultsWithAriaLive","msg","facetSearchAriaMessage","state","facetInfo","element","host","isHidden","store","registerFacet","initializePopover","hasValues","values","numberOfActiveValues","facetState","hasActiveValues","initializeDependenciesManager","focusTargets","showLessFocus","FocusTargetController","showMoreFocus","headerFocus","activeValueFocus","disconnectedCallback","isConnected","_a","dependenciesManager","stopWatching","searchStatusState","hasError","enabled","parents","componentShouldUpdate","next","prev","propName","isCategoryFacetState","shouldUpdateFacetSearchComponent","hasParents","buildFacetConditionsManager","conditions","parseDependsOn","renderHeader","FacetHeader","onToggleCollapse","onClearFilters","focusAfterSearch","deselectAll","headerRef","header","setTarget","renderSearchInput","FacetSearchInput","query","onChange","clear","updateCaptions","getFieldCaptions","updateText","search","onClear","renderValuesTree","isRoot","renderChildren","parentValue","toggleSelect","activeParent","activeParentDisplayValue","el","renderChild","isShowLessFocusTarget","isShowMoreFocusTarget","i","renderSearchResults","select","renderMatches","FacetSearchMatches","numberOfMatches","hasMoreMatches","moreValuesAvailable","renderShowMoreLess","FacetShowMoreLess","onShowMore","showMoreValues","onShowLess","showLessValues","canShowLessValues","canShowMoreValues","render","valuesAsTrees","firstSearchExecuted","FacetGuard","hasResults","FacetContainer","shouldDisplaySearchResults","Fragment","FacetValuesGroup","FacetPlaceholder","__decorate","InitializeBindings","BindStateToController","ArrayProp","MapProp","AriaLiveRegion"],"sources":["src/components/common/facets/category-facet/all-categories-button.tsx","src/components/common/facets/category-facet/value-link.tsx","src/components/common/facets/category-facet/child-value-link.tsx","src/components/common/facets/category-facet/children-as-tree-container.tsx","src/components/common/facets/category-facet/parent-as-tree-container.tsx","src/components/common/facets/category-facet/parent-button.tsx","src/components/common/facets/category-facet/parent-value-link.tsx","src/components/common/facets/category-facet/search-results-container.tsx","src/components/common/facets/category-facet/search-value.tsx","src/components/common/facets/category-facet/value-as-tree-container.tsx","src/components/search/facets/atomic-category-facet/atomic-category-facet.pcss?tag=atomic-category-facet&encapsulation=shadow","src/components/search/facets/atomic-category-facet/atomic-category-facet.tsx"],"sourcesContent":["import {FunctionalComponent, h} from '@stencil/core';\nimport {i18n} from 'i18next';\nimport LeftArrow from '../../../../images/arrow-left-rounded.svg';\nimport {Button} from '../../button';\n\ninterface CategoryFacetAllCategoryButtonProps {\n  i18n: i18n;\n  onClick(): void;\n}\n\nexport const CategoryFacetAllCategoryButton: FunctionalComponent<\n  CategoryFacetAllCategoryButtonProps\n> = ({i18n, onClick}) => {\n  const allCategories = i18n.t('all-categories');\n  return (\n    <Button\n      style=\"text-neutral\"\n      part=\"all-categories-button\"\n      onClick={() => {\n        onClick();\n      }}\n    >\n      <atomic-icon\n        aria-hidden=\"true\"\n        icon={LeftArrow}\n        part=\"back-arrow\"\n      ></atomic-icon>\n      <span class=\"truncate\">{allCategories}</span>\n    </Button>\n  );\n};\n","import {FunctionalComponent, h} from '@stencil/core';\nimport {i18n} from 'i18next';\nimport {FacetValueLabelHighlight} from '../facet-value-label-highlight/facet-value-label-highlight';\nimport {FacetValueLink} from '../facet-value-link/facet-value-link';\n\nexport interface CategoryFacetValueLinkProps {\n  displayValue: string;\n  numberOfResults: number;\n  i18n: i18n;\n  onClick: () => void;\n  isParent: boolean;\n  isSelected: boolean;\n  searchQuery: string;\n  isLeafValue: boolean;\n  setRef: (el?: HTMLButtonElement) => void;\n}\n\nexport const CategoryFacetValueLink: FunctionalComponent<\n  CategoryFacetValueLinkProps\n> = (\n  {\n    displayValue,\n    numberOfResults,\n    i18n,\n    onClick,\n    isParent,\n    isSelected,\n    searchQuery,\n    isLeafValue,\n    setRef,\n  },\n  children\n) => {\n  const partNames = [];\n  if (isParent) {\n    partNames.push('active-parent');\n  } else {\n    partNames.push(`value-link${isSelected ? ' value-link-selected' : ''}`);\n  }\n\n  if (isLeafValue) {\n    partNames.push('leaf-value');\n  } else {\n    partNames.push('node-value');\n  }\n\n  return (\n    <FacetValueLink\n      displayValue={displayValue}\n      numberOfResults={numberOfResults}\n      isSelected={isSelected}\n      i18n={i18n}\n      onClick={() => {\n        onClick();\n      }}\n      searchQuery={searchQuery}\n      part={partNames.join(' ')}\n      class=\"contents\"\n      buttonRef={(btn) => setRef(btn)}\n      subList={children}\n    >\n      <FacetValueLabelHighlight\n        displayValue={displayValue}\n        isSelected={isSelected}\n      ></FacetValueLabelHighlight>\n    </FacetValueLink>\n  );\n};\n","import {FunctionalComponent, h} from '@stencil/core';\nimport {\n  CategoryFacetValueLink,\n  CategoryFacetValueLinkProps,\n} from './value-link';\n\ninterface CategoryFacetChildValueLinkProps\n  extends Omit<CategoryFacetValueLinkProps, 'isParent'> {}\n\nexport const CategoryFacetChildValueLink: FunctionalComponent<\n  CategoryFacetChildValueLinkProps\n> = (props, children) => {\n  return (\n    <CategoryFacetValueLink {...props} isParent={false}>\n      {children}\n    </CategoryFacetValueLink>\n  );\n};\n","import {FunctionalComponent, h} from '@stencil/core';\n\ninterface CategoryFacetChildrenAsTreeContainerProps {\n  className?: string;\n}\nexport const CategoryFacetChildrenAsTreeContainer: FunctionalComponent<\n  CategoryFacetChildrenAsTreeContainerProps\n> = ({className}, children) => {\n  return (\n    <ul part=\"values\" class={className ?? ''}>\n      {children}\n    </ul>\n  );\n};\n","import {FunctionalComponent, h} from '@stencil/core';\n\nexport interface CategoryFacetParentAsTreeContainerProps {\n  isTopLevel: boolean;\n  className?: string;\n}\nexport const CategoryFacetParentAsTreeContainer: FunctionalComponent<\n  CategoryFacetParentAsTreeContainerProps\n> = ({isTopLevel, className}, children) => {\n  return (\n    <ul class={className ?? ''} part={`${isTopLevel ? '' : 'sub-'}parents`}>\n      {children}\n    </ul>\n  );\n};\n","import {FunctionalComponent, h} from '@stencil/core';\nimport {i18n} from 'i18next';\nimport LeftArrow from '../../../../images/arrow-left-rounded.svg';\nimport {getFieldValueCaption} from '../../../../utils/field-utils';\nimport {Button} from '../../button';\n\ninterface CategoryFacetParentButtonProps {\n  i18n: i18n;\n  field: string;\n  facetValue: {value: string; numberOfResults: number};\n  onClick: () => void;\n}\nexport const CategoryFacetParentButton: FunctionalComponent<\n  CategoryFacetParentButtonProps\n> = ({field, facetValue, i18n, onClick}) => {\n  const displayValue = getFieldValueCaption(field, facetValue.value, i18n);\n  const ariaLabel = i18n.t('facet-value', {\n    value: displayValue,\n    count: facetValue.numberOfResults,\n  });\n\n  return (\n    <Button\n      style=\"text-neutral\"\n      part=\"parent-button\"\n      ariaPressed=\"false\"\n      onClick={() => {\n        onClick();\n      }}\n      ariaLabel={ariaLabel}\n    >\n      <atomic-icon\n        icon={LeftArrow}\n        part=\"back-arrow\"\n        class=\"back-arrow\"\n      ></atomic-icon>\n      <span class=\"truncate\">{displayValue}</span>\n    </Button>\n  );\n};\n","import {FunctionalComponent, h} from '@stencil/core';\nimport {\n  CategoryFacetValueLink,\n  CategoryFacetValueLinkProps,\n} from './value-link';\n\ninterface CategoryFacetParentValueLinkProps\n  extends Omit<CategoryFacetValueLinkProps, 'isParent' | 'isSelected'> {}\n\nexport const CategoryFacetParentValueLink: FunctionalComponent<\n  CategoryFacetParentValueLinkProps\n> = (props, children) => {\n  return (\n    <CategoryFacetValueLink {...props} isParent isSelected>\n      {children}\n    </CategoryFacetValueLink>\n  );\n};\n","import {FunctionalComponent, h} from '@stencil/core';\n\nexport const CategoryFacetSearchResultsContainer: FunctionalComponent = (\n  _,\n  children\n) => {\n  return (\n    <ul part=\"search-results\" class=\"mt-3\">\n      {children}\n    </ul>\n  );\n};\n","import {FunctionalComponent, h} from '@stencil/core';\nimport {i18n} from 'i18next';\nimport {getFieldValueCaption} from '../../../../utils/field-utils';\nimport {Button} from '../../button';\nimport {FacetValueLabelHighlight} from '../facet-value-label-highlight/facet-value-label-highlight';\n\ninterface CategoryFacetSearchValueProps {\n  value: {count: number; path: string[]; displayValue: string};\n  i18n: i18n;\n  field: string;\n  onClick(): void;\n  searchQuery: string;\n}\n\nconst SEPARATOR = '/';\nconst ELLIPSIS = '...';\nconst PATH_MAX_LENGTH = 3;\n\nexport const CategoryFacetSearchValue: FunctionalComponent<\n  CategoryFacetSearchValueProps\n> = ({value, field, i18n, onClick, searchQuery}) => {\n  const count = value.count.toLocaleString(i18n.language);\n  const inLabel = i18n.t('in');\n  const allCategories = i18n.t('all-categories');\n  const localizedPath = value.path.length\n    ? value.path.map((value) => getFieldValueCaption(field, value, i18n))\n    : [allCategories];\n  const ariaLabel = i18n.t('under', {\n    child: i18n.t('facet-value', {\n      numberOfResults: value.count,\n      value: value.displayValue,\n    }),\n    parent: localizedPath.join(', '),\n  });\n\n  function ellipsedPath(path: string[]) {\n    if (path.length <= PATH_MAX_LENGTH) {\n      return path;\n    }\n    const firstPart = path.slice(0, 1);\n    const lastParts = path.slice(-PATH_MAX_LENGTH + 1);\n    return firstPart.concat(ELLIPSIS, ...lastParts);\n  }\n\n  function renderPath(path: string[]) {\n    if (!path.length) {\n      return <span class=\"truncate\">{`${inLabel} ${allCategories}`}</span>;\n    }\n\n    return [\n      <span class=\"mr-0.5\">{inLabel}</span>,\n      ellipsedPath(path).map((value, index) => [\n        index > 0 && <span class=\"mx-0.5\">{SEPARATOR}</span>,\n        <span class={value === ELLIPSIS ? '' : 'truncate flex-1 max-w-max'}>\n          {value}\n        </span>,\n      ]),\n    ];\n  }\n\n  return (\n    <li key={value.displayValue}>\n      <Button\n        style=\"text-neutral\"\n        part=\"search-result\"\n        onClick={() => onClick()}\n        class=\"w-full flex flex-col px-2 py-2.5 truncate group no-outline\"\n        aria-label={ariaLabel}\n      >\n        <div class=\"w-full flex\">\n          <FacetValueLabelHighlight\n            displayValue={value.displayValue}\n            isSelected={false}\n            searchQuery={searchQuery}\n          ></FacetValueLabelHighlight>\n          <span part=\"value-count\" class=\"value-count\">\n            {i18n.t('between-parentheses', {\n              text: count,\n            })}\n          </span>\n        </div>\n        <div\n          part=\"search-result-path\"\n          class=\"flex w-full text-neutral-dark mt-1 group-focus:text-primary group-hover:text-primary\"\n        >\n          {renderPath(localizedPath)}\n        </div>\n      </Button>\n    </li>\n  );\n};\n","import {FunctionalComponent, h} from '@stencil/core';\n\nexport const CategoryFacetTreeValueContainer: FunctionalComponent = (\n  _,\n  children\n) => {\n  return <li class=\"contents\">{children}</li>;\n};\n","@import '../../../common/facets/facet-common.pcss';\n@import '../../../common/facets/facet-search/facet-search.pcss';\n\n[part~='active-parent'] {\n  @apply pl-9;\n}\n\n[part~='parents'] [part~='values'] {\n  @apply pl-9;\n}\n\n[part~='all-categories-button'],\n[part~='parent-button'] {\n  @apply w-full py-2.5 pr-2 pl-7 text-left relative flex items-center;\n}\n\n[part~='back-arrow'] {\n  @apply h-5 w-5 absolute left-1;\n}\n","import {\n  CategoryFacet,\n  buildCategoryFacet,\n  CategoryFacetState,\n  CategoryFacetOptions,\n  CategoryFacetSortCriterion,\n  SearchStatus,\n  SearchStatusState,\n  buildSearchStatus,\n  CategoryFacetValue,\n  buildFacetConditionsManager,\n  FacetConditionsManager,\n  FacetValueRequest,\n  CategoryFacetValueRequest,\n} from '@coveo/headless';\nimport {Component, h, State, Prop, Element, Fragment} from '@stencil/core';\nimport {\n  AriaLiveRegion,\n  FocusTargetController,\n} from '../../../../utils/accessibility-utils';\nimport {\n  getFieldCaptions,\n  getFieldValueCaption,\n} from '../../../../utils/field-utils';\nimport {\n  BindStateToController,\n  InitializableComponent,\n  InitializeBindings,\n} from '../../../../utils/initialization-utils';\nimport {ArrayProp, MapProp} from '../../../../utils/props-utils';\nimport {CategoryFacetAllCategoryButton} from '../../../common/facets/category-facet/all-categories-button';\nimport {CategoryFacetChildValueLink} from '../../../common/facets/category-facet/child-value-link';\nimport {CategoryFacetChildrenAsTreeContainer} from '../../../common/facets/category-facet/children-as-tree-container';\nimport {CategoryFacetParentAsTreeContainer} from '../../../common/facets/category-facet/parent-as-tree-container';\nimport {CategoryFacetParentButton} from '../../../common/facets/category-facet/parent-button';\nimport {CategoryFacetParentValueLink} from '../../../common/facets/category-facet/parent-value-link';\nimport {CategoryFacetSearchResultsContainer} from '../../../common/facets/category-facet/search-results-container';\nimport {CategoryFacetSearchValue} from '../../../common/facets/category-facet/search-value';\nimport {CategoryFacetTreeValueContainer} from '../../../common/facets/category-facet/value-as-tree-container';\nimport {parseDependsOn} from '../../../common/facets/depends-on';\nimport {FacetInfo} from '../../../common/facets/facet-common-store';\nimport {FacetContainer} from '../../../common/facets/facet-container/facet-container';\nimport {FacetGuard} from '../../../common/facets/facet-guard';\nimport {FacetHeader} from '../../../common/facets/facet-header/facet-header';\nimport {FacetPlaceholder} from '../../../common/facets/facet-placeholder/facet-placeholder';\nimport {announceFacetSearchResultsWithAriaLive} from '../../../common/facets/facet-search/facet-search-aria-live';\nimport {FacetSearchInput} from '../../../common/facets/facet-search/facet-search-input';\nimport {FacetSearchMatches} from '../../../common/facets/facet-search/facet-search-matches';\nimport {\n  shouldUpdateFacetSearchComponent,\n  shouldDisplaySearchResults,\n} from '../../../common/facets/facet-search/facet-search-utils';\nimport {FacetShowMoreLess} from '../../../common/facets/facet-show-more-less/facet-show-more-less';\nimport {FacetValuesGroup} from '../../../common/facets/facet-values-group/facet-values-group';\nimport {Bindings} from '../../atomic-search-interface/atomic-search-interface';\nimport {initializePopover} from '../atomic-popover/popover-type';\n\n/**\n * A facet is a list of values for a certain field occurring in the results, ordered using a configurable criteria (e.g., number of occurrences).\n * An `atomic-category-facet` displays a facet of values in a browsable, hierarchical fashion.\n *\n * @part facet - The wrapper for the entire facet.\n * @part placeholder - The placeholder shown before the first search is executed.\n *\n * @part label-button - The button that displays the label and allows to expand/collapse the facet.\n * @part label-button-icon - The label button icon.\n *\n * @part search-wrapper - The search box wrapper.\n * @part search-input - The search box input.\n * @part search-icon - The search box submit button.\n * @part search-clear-button - The button to clear the search box of input.\n * @part more-matches - The label indicating there are more matches for the current facet search query.\n * @part no-matches - The label indicating there are no matches for the current facet search query.\n * @part matches-query - The highlighted query inside the matches labels.\n * @part search-results - The search results container.\n * @part search-result - The search result value.\n * @part search-result-path - The search result path.\n * @part search-highlight - The highlighted query inside the facet values.\n *\n * @part parents - The container surrounding the whole hierarchy of values.\n * @part sub-parents - The container surrounding a sub-hierarchy of values.\n * @part values - The container surrounding either the children of the active value or the values at the base.\n * @part all-categories-button - The \"View all\" button displayed first within the parents.\n * @part parent-button - The clickable parent button displayed first within sub-parents.\n * @part active-parent - The clickable active parent displayed first within the last sub-parents.\n * @part value-link - The clickable value displayed first within values.\n * @part back-arrow - The back arrow displayed before the clickable parents.\n * @part value-label - The facet value label within a value button.\n * @part value-count - The facet value count within a value button.\n * @part leaf-value - A facet value with no child value.\n * @part node-value - A facet value with child values.\n *\n * @part show-more - The show more results button.\n * @part show-less - The show less results button.\n * @part show-more-less-icon - The icons of the show more & show less buttons.\n */\n@Component({\n  tag: 'atomic-category-facet',\n  styleUrl: 'atomic-category-facet.pcss',\n  shadow: true,\n})\nexport class AtomicCategoryFacet implements InitializableComponent {\n  @InitializeBindings() public bindings!: Bindings;\n  public facet!: CategoryFacet;\n  private dependenciesManager?: FacetConditionsManager;\n  private resultIndexToFocusOnShowMore = 0;\n  public searchStatus!: SearchStatus;\n  @Element() private host!: HTMLElement;\n\n  @BindStateToController('facet')\n  @State()\n  public facetState!: CategoryFacetState;\n  @BindStateToController('searchStatus')\n  @State()\n  public searchStatusState!: SearchStatusState;\n  @State() public error!: Error;\n\n  /**\n   * Specifies a unique identifier for the facet.\n   */\n  @Prop({mutable: true, reflect: true}) public facetId?: string;\n  /**\n   * The non-localized label for the facet.\n   * Used in the `atomic-breadbox` component through the bindings store.\n   */\n  @Prop({reflect: true}) public label = 'no-label';\n  /**\n   * The field whose values you want to display in the facet.\n   */\n  @Prop({reflect: true}) public field!: string;\n  /**\n   * The number of values to request for this facet.\n   * Also determines the number of additional values to request each time more values are shown.\n   */\n  @Prop({reflect: true}) public numberOfValues = 8;\n  /**\n   * Whether this facet should contain a search box.\n   *\n   */\n  @Prop({reflect: true}) public withSearch = false;\n  /**\n   * The sort criterion to apply to the returned facet values.\n   * Possible values are 'alphanumeric' and 'occurrences'.\n   * For this criterion to apply to the top-layer facet values, disable\n   * [facet value ordering](https://docs.coveo.com/en/l1qf4156/#facet-value-ordering)\n   * in your Dynamic Navigation Experience configuration.\n   */\n  // TODO: add automatic (occurrences when not expanded, alphanumeric when expanded)\n  @Prop({reflect: true}) public sortCriteria: CategoryFacetSortCriterion =\n    'occurrences';\n  /**\n   * The character that separates values of a multi-value field.\n   *\n   * *Note:* If you use the [example formatting](https://docs.coveo.com/en/atomic/latest/reference/components/atomic-category-facet/#usage-notes) for the associated multi-value field, you must set this value to `|` or the facet won't display properly.\n   */\n  @Prop({reflect: true}) public delimitingCharacter = ';';\n  /**\n   * The base path shared by all values for the facet.\n   *\n   * Specify the property as an array using a JSON string representation:\n   * ```html\n   *  <atomic-category-facet base-path='[\"first value\", \"second value\"]' ></atomic-category-facet>\n   * ```\n   */\n  @ArrayProp()\n  @Prop({reflect: true, mutable: true})\n  public basePath: string[] | string = '[]';\n\n  /**\n   * Whether to use basePath as a filter for the results.\n   */\n  @Prop({reflect: true}) public filterByBasePath = true;\n  /**\n   * Specifies whether the facet is collapsed. When the facet is the child of an `atomic-facet-manager` component, the facet manager controls this property.\n   */\n  @Prop({reflect: true, mutable: true}) public isCollapsed = false;\n  /**\n   * The [heading level](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/Heading_Elements) to use for the heading over the facet, from 1 to 6.\n   */\n  @Prop({reflect: true}) public headingLevel = 0;\n  /**\n   * Whether to exclude the parents of folded results when estimating the result count for each facet value.\n   */\n  @Prop({reflect: true}) public filterFacetCount = true;\n  /**\n   * The maximum number of results to scan in the index to ensure that the facet lists all potential facet values.\n   * Note: A high injectionDepth may negatively impact the facet request performance.\n   * Minimum: `0`\n   * Default: `1000`\n   */\n  @Prop({reflect: true}) public injectionDepth = 1000;\n  // @Prop() public customSort?: string; TODO: KIT-753 Add customSort option for facet\n\n  /**\n   * The required facets and values for this facet to be displayed.\n   * Examples:\n   * ```html\n   * <atomic-facet facet-id=\"abc\" field=\"objecttype\" ...></atomic-facet>\n   *\n   * <!-- To show the facet when any value is selected in the facet with id \"abc\": -->\n   * <atomic-category-facet\n   *   depends-on-abc\n   *   ...\n   * ></atomic-category-facet>\n   *\n   * <!-- To show the facet when value \"doc\" is selected in the facet with id \"abc\": -->\n   * <atomic-category-facet\n   *   depends-on-abc=\"doc\"\n   *   ...\n   * ></atomic-category-facet>\n   * ```\n   */\n  @MapProp() @Prop() public dependsOn: Record<string, string> = {};\n\n  private showLessFocus?: FocusTargetController;\n\n  private showMoreFocus?: FocusTargetController;\n\n  private headerFocus?: FocusTargetController;\n\n  private activeValueFocus?: FocusTargetController;\n\n  @AriaLiveRegion('facet-search')\n  protected facetSearchAriaMessage!: string;\n\n  public initialize() {\n    this.searchStatus = buildSearchStatus(this.bindings.engine);\n    const options: CategoryFacetOptions = {\n      facetId: this.facetId,\n      field: this.field,\n      numberOfValues: this.numberOfValues,\n      sortCriteria: this.sortCriteria,\n      facetSearch: {numberOfValues: this.numberOfValues},\n      basePath: [...this.basePath],\n      delimitingCharacter: this.delimitingCharacter,\n      filterByBasePath: this.filterByBasePath,\n      injectionDepth: this.injectionDepth,\n      filterFacetCount: this.filterFacetCount,\n    };\n    this.facet = buildCategoryFacet(this.bindings.engine, {options});\n    announceFacetSearchResultsWithAriaLive(\n      this.facet,\n      this.label,\n      (msg) => (this.facetSearchAriaMessage = msg),\n      this.bindings.i18n\n    );\n    this.facetId = this.facet.state.facetId;\n    const facetInfo: FacetInfo = {\n      label: () => this.bindings.i18n.t(this.label),\n      facetId: this.facetId!,\n      element: this.host,\n      isHidden: () => this.isHidden,\n    };\n    this.bindings.store.registerFacet('categoryFacets', facetInfo);\n    initializePopover(this.host, {\n      ...facetInfo,\n      hasValues: () => !!this.facet.state.values.length,\n      numberOfActiveValues: () => (this.facetState.hasActiveValues ? 1 : 0),\n    });\n    this.initializeDependenciesManager();\n  }\n\n  private get focusTargets() {\n    if (!this.showLessFocus) {\n      this.showLessFocus = new FocusTargetController(this);\n    }\n    if (!this.showMoreFocus) {\n      this.showMoreFocus = new FocusTargetController(this);\n    }\n    if (!this.headerFocus) {\n      this.headerFocus = new FocusTargetController(this);\n    }\n    if (!this.activeValueFocus) {\n      this.activeValueFocus = new FocusTargetController(this);\n    }\n\n    return {\n      showLessFocus: this.showLessFocus,\n      showMoreFocus: this.showMoreFocus,\n      headerFocus: this.headerFocus,\n      activeValueFocus: this.activeValueFocus,\n    };\n  }\n\n  public disconnectedCallback() {\n    if (this.host.isConnected) {\n      return;\n    }\n    this.dependenciesManager?.stopWatching();\n  }\n\n  private get isHidden() {\n    return (\n      this.searchStatusState.hasError ||\n      !this.facet.state.enabled ||\n      (!this.facet.state.values.length && !this.facet.state.parents.length)\n    );\n  }\n\n  public componentShouldUpdate(\n    next: unknown,\n    prev: unknown,\n    propName: keyof AtomicCategoryFacet\n  ) {\n    if (\n      this.isCategoryFacetState(prev, propName) &&\n      this.isCategoryFacetState(next, propName)\n    ) {\n      return shouldUpdateFacetSearchComponent(\n        next.facetSearch,\n        prev.facetSearch\n      );\n    }\n    return true;\n  }\n\n  private get hasParents() {\n    return !!this.facetState.parents.length;\n  }\n\n  private initializeDependenciesManager() {\n    this.dependenciesManager = buildFacetConditionsManager(\n      this.bindings.engine,\n      {\n        facetId: this.facetId!,\n        conditions: parseDependsOn<\n          FacetValueRequest | CategoryFacetValueRequest\n        >(this.dependsOn),\n      }\n    );\n  }\n\n  private renderHeader() {\n    return (\n      <FacetHeader\n        i18n={this.bindings.i18n}\n        label={this.label}\n        numberOfActiveValues={\n          this.facetState.hasActiveValues && this.isCollapsed ? 1 : 0\n        }\n        isCollapsed={this.isCollapsed}\n        headingLevel={this.headingLevel}\n        onToggleCollapse={() => (this.isCollapsed = !this.isCollapsed)}\n        onClearFilters={() => {\n          this.focusTargets.headerFocus.focusAfterSearch();\n          this.facet.deselectAll();\n        }}\n        headerRef={(header) => {\n          this.focusTargets.headerFocus.setTarget(header);\n          if (!this.hasParents) {\n            this.focusTargets.activeValueFocus.setTarget(header);\n          }\n        }}\n      ></FacetHeader>\n    );\n  }\n\n  private renderSearchInput() {\n    if (!this.withSearch) {\n      return;\n    }\n\n    return (\n      <FacetSearchInput\n        i18n={this.bindings.i18n}\n        label={this.label}\n        query={this.facetState.facetSearch.query}\n        onChange={(value) => {\n          if (value === '') {\n            this.facet.facetSearch.clear();\n            return;\n          }\n          this.facet.facetSearch.updateCaptions(\n            getFieldCaptions(this.field, this.bindings.i18n)\n          );\n          this.facet.facetSearch.updateText(value);\n          this.facet.facetSearch.search();\n        }}\n        onClear={() => this.facet.facetSearch.clear()}\n      ></FacetSearchInput>\n    );\n  }\n\n  private renderValuesTree(parents: CategoryFacetValue[], isRoot: boolean) {\n    if (!this.hasParents) {\n      return this.renderChildren();\n    }\n\n    if (isRoot) {\n      return (\n        <CategoryFacetTreeValueContainer>\n          <CategoryFacetAllCategoryButton\n            i18n={this.bindings.i18n}\n            onClick={() => {\n              this.focusTargets.activeValueFocus.focusAfterSearch();\n              this.facet.deselectAll();\n            }}\n          />\n          <CategoryFacetParentAsTreeContainer isTopLevel={false}>\n            {this.renderValuesTree(parents, false)}\n          </CategoryFacetParentAsTreeContainer>\n        </CategoryFacetTreeValueContainer>\n      );\n    }\n\n    if (parents.length > 1) {\n      const parentValue = parents[0];\n\n      return (\n        <CategoryFacetTreeValueContainer>\n          <CategoryFacetParentButton\n            facetValue={parentValue}\n            field={this.field}\n            i18n={this.bindings.i18n}\n            onClick={() => {\n              this.focusTargets.activeValueFocus.focusAfterSearch();\n              this.facet.toggleSelect(parentValue);\n            }}\n          />\n          <CategoryFacetParentAsTreeContainer isTopLevel={false}>\n            {this.renderValuesTree(parents.slice(1), false)}\n          </CategoryFacetParentAsTreeContainer>\n        </CategoryFacetTreeValueContainer>\n      );\n    }\n\n    const activeParent = parents[0];\n    const activeParentDisplayValue = getFieldValueCaption(\n      this.field,\n      activeParent.value,\n      this.bindings.i18n\n    );\n\n    return (\n      <CategoryFacetParentValueLink\n        displayValue={activeParentDisplayValue}\n        numberOfResults={activeParent.numberOfResults}\n        i18n={this.bindings.i18n}\n        isLeafValue={activeParent.isLeafValue}\n        onClick={() => {\n          this.focusTargets.activeValueFocus.focusAfterSearch();\n          this.facet.deselectAll();\n        }}\n        searchQuery={this.facetState.facetSearch.query}\n        setRef={(el) => this.focusTargets.activeValueFocus.setTarget(el)}\n      >\n        <CategoryFacetChildrenAsTreeContainer>\n          {this.renderChildren()}\n        </CategoryFacetChildrenAsTreeContainer>\n      </CategoryFacetParentValueLink>\n    );\n  }\n\n  private renderChild(\n    facetValue: CategoryFacetValue,\n    isShowLessFocusTarget: boolean,\n    isShowMoreFocusTarget: boolean\n  ) {\n    const displayValue = getFieldValueCaption(\n      this.field,\n      facetValue.value,\n      this.bindings.i18n\n    );\n    const isSelected = facetValue.state === 'selected';\n    return (\n      <CategoryFacetChildValueLink\n        displayValue={displayValue}\n        i18n={this.bindings.i18n}\n        isLeafValue={facetValue.isLeafValue}\n        isSelected={isSelected}\n        numberOfResults={facetValue.numberOfResults}\n        onClick={() => {\n          this.focusTargets.activeValueFocus.focusAfterSearch();\n          this.facet.toggleSelect(facetValue);\n        }}\n        searchQuery={this.facetState.facetSearch.query}\n        setRef={(element) => {\n          isShowLessFocusTarget &&\n            this.focusTargets.showLessFocus.setTarget(element);\n          isShowMoreFocusTarget &&\n            this.focusTargets.showMoreFocus.setTarget(element);\n        }}\n      ></CategoryFacetChildValueLink>\n    );\n  }\n\n  private renderChildren() {\n    if (!this.facetState.values.length) {\n      return;\n    }\n\n    return this.facetState.values.map((value, i) =>\n      this.renderChild(value, i === 0, i === this.resultIndexToFocusOnShowMore)\n    );\n  }\n\n  private renderSearchResults() {\n    return (\n      <CategoryFacetSearchResultsContainer>\n        {this.facetState.facetSearch.values.map((value) => (\n          <CategoryFacetSearchValue\n            value={value}\n            field={this.field}\n            i18n={this.bindings.i18n}\n            searchQuery={this.facetState.facetSearch.query}\n            onClick={() => {\n              this.focusTargets.activeValueFocus.focusAfterSearch();\n              this.facet.facetSearch.select(value);\n            }}\n          ></CategoryFacetSearchValue>\n        ))}\n      </CategoryFacetSearchResultsContainer>\n    );\n  }\n\n  private renderMatches() {\n    return (\n      <FacetSearchMatches\n        i18n={this.bindings.i18n}\n        query={this.facetState.facetSearch.query}\n        numberOfMatches={this.facetState.facetSearch.values.length}\n        hasMoreMatches={this.facetState.facetSearch.moreValuesAvailable}\n      ></FacetSearchMatches>\n    );\n  }\n\n  private renderShowMoreLess() {\n    return (\n      <div class={this.hasParents ? 'pl-9' : ''}>\n        <FacetShowMoreLess\n          label={this.label}\n          i18n={this.bindings.i18n}\n          onShowMore={() => {\n            this.resultIndexToFocusOnShowMore = this.facetState.values.length;\n            this.focusTargets.showMoreFocus.focusAfterSearch();\n            this.facet.showMoreValues();\n          }}\n          onShowLess={() => {\n            this.focusTargets.showLessFocus.focusAfterSearch();\n            this.facet.showLessValues();\n          }}\n          canShowLessValues={this.facetState.canShowLessValues}\n          canShowMoreValues={this.facetState.canShowMoreValues}\n        ></FacetShowMoreLess>\n      </div>\n    );\n  }\n\n  private isCategoryFacetState(\n    state: unknown,\n    propName: string\n  ): state is CategoryFacetState {\n    return (\n      propName === 'facetState' &&\n      typeof (state as CategoryFacetState)?.facetId === 'string'\n    );\n  }\n\n  public render() {\n    const {\n      bindings: {i18n},\n      label,\n      facetState: {facetSearch, enabled, valuesAsTrees, parents},\n      searchStatusState: {hasError, firstSearchExecuted},\n    } = this;\n\n    return (\n      <FacetGuard\n        enabled={enabled}\n        firstSearchExecuted={firstSearchExecuted}\n        hasError={hasError}\n        hasResults={valuesAsTrees.length > 0}\n      >\n        {firstSearchExecuted ? (\n          <FacetContainer>\n            {this.renderHeader()}\n            {!this.isCollapsed && [\n              this.renderSearchInput(),\n              shouldDisplaySearchResults(facetSearch) ? (\n                <Fragment>\n                  {facetSearch.values.length ? (\n                    <FacetValuesGroup\n                      i18n={i18n}\n                      label={label}\n                      query={facetSearch.query}\n                    >\n                      {this.renderSearchResults()}\n                    </FacetValuesGroup>\n                  ) : (\n                    <div class=\"mt-3\"></div>\n                  )}\n                  {this.renderMatches()}\n                </Fragment>\n              ) : (\n                <Fragment>\n                  <FacetValuesGroup i18n={i18n} label={label}>\n                    {this.hasParents ? (\n                      <CategoryFacetParentAsTreeContainer\n                        isTopLevel={true}\n                        className=\"mt-3\"\n                      >\n                        {this.renderValuesTree(parents, true)}\n                      </CategoryFacetParentAsTreeContainer>\n                    ) : (\n                      <CategoryFacetChildrenAsTreeContainer className=\"mt-3\">\n                        {this.renderChildren()}\n                      </CategoryFacetChildrenAsTreeContainer>\n                    )}\n                  </FacetValuesGroup>\n                  {this.renderShowMoreLess()}\n                </Fragment>\n              ),\n            ]}\n          </FacetContainer>\n        ) : (\n          <FacetPlaceholder\n            isCollapsed={this.isCollapsed}\n            numberOfValues={this.numberOfValues}\n          />\n        )}\n      </FacetGuard>\n    );\n  }\n}\n"],"mappings":"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"}