{"file":"atomic-category-facet.entry.esm.js","mappings":"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","names":["LeftArrow","buildFacetConditionsManager"],"sources":["src/components/common/facets/category-facet/all-categories-button.tsx","src/components/common/facets/category-facet/value-link.tsx","src/components/common/facets/category-facet/child-value-link.tsx","src/components/common/facets/category-facet/children-as-tree-container.tsx","src/components/common/facets/category-facet/parent-as-tree-container.tsx","src/components/common/facets/category-facet/parent-button.tsx","src/components/common/facets/category-facet/parent-value-link.tsx","src/components/common/facets/category-facet/search-results-container.tsx","src/components/common/facets/category-facet/search-value.tsx","src/components/common/facets/category-facet/value-as-tree-container.tsx","src/components/search/facets/atomic-category-facet/atomic-category-facet.pcss?tag=atomic-category-facet&encapsulation=shadow","src/components/search/facets/atomic-category-facet/atomic-category-facet.tsx"],"sourcesContent":["import {FunctionalComponent, h} from '@stencil/core';\r\nimport {i18n} from 'i18next';\r\nimport LeftArrow from '../../../../images/arrow-left-rounded.svg';\r\nimport {Button} from '../../button';\r\n\r\ninterface CategoryFacetAllCategoryButtonProps {\r\n  i18n: i18n;\r\n  onClick(): void;\r\n}\r\n\r\nexport const CategoryFacetAllCategoryButton: FunctionalComponent<\r\n  CategoryFacetAllCategoryButtonProps\r\n> = ({i18n, onClick}) => {\r\n  const allCategories = i18n.t('all-categories');\r\n  return (\r\n    <Button\r\n      style=\"text-neutral\"\r\n      part=\"all-categories-button\"\r\n      onClick={() => {\r\n        onClick();\r\n      }}\r\n    >\r\n      <atomic-icon\r\n        aria-hidden=\"true\"\r\n        icon={LeftArrow}\r\n        part=\"back-arrow\"\r\n      ></atomic-icon>\r\n      <span class=\"truncate\">{allCategories}</span>\r\n    </Button>\r\n  );\r\n};\r\n","import {FunctionalComponent, h} from '@stencil/core';\r\nimport {i18n} from 'i18next';\r\nimport {FacetValueLabelHighlight} from '../facet-value-label-highlight/facet-value-label-highlight';\r\nimport {FacetValueLink} from '../facet-value-link/facet-value-link';\r\n\r\nexport interface CategoryFacetValueLinkProps {\r\n  displayValue: string;\r\n  numberOfResults: number;\r\n  i18n: i18n;\r\n  onClick: () => void;\r\n  isParent: boolean;\r\n  isSelected: boolean;\r\n  searchQuery: string;\r\n  isLeafValue: boolean;\r\n  setRef: (el?: HTMLButtonElement) => void;\r\n}\r\n\r\nexport const CategoryFacetValueLink: FunctionalComponent<\r\n  CategoryFacetValueLinkProps\r\n> = (\r\n  {\r\n    displayValue,\r\n    numberOfResults,\r\n    i18n,\r\n    onClick,\r\n    isParent,\r\n    isSelected,\r\n    searchQuery,\r\n    isLeafValue,\r\n    setRef,\r\n  },\r\n  children\r\n) => {\r\n  const partNames = [];\r\n  if (isParent) {\r\n    partNames.push('active-parent');\r\n  } else {\r\n    partNames.push(`value-link${isSelected ? ' value-link-selected' : ''}`);\r\n  }\r\n\r\n  if (isLeafValue) {\r\n    partNames.push('leaf-value');\r\n  } else {\r\n    partNames.push('node-value');\r\n  }\r\n\r\n  return (\r\n    <FacetValueLink\r\n      displayValue={displayValue}\r\n      numberOfResults={numberOfResults}\r\n      isSelected={isSelected}\r\n      i18n={i18n}\r\n      onClick={() => {\r\n        onClick();\r\n      }}\r\n      searchQuery={searchQuery}\r\n      part={partNames.join(' ')}\r\n      class=\"contents\"\r\n      buttonRef={(btn) => setRef(btn)}\r\n      subList={children}\r\n    >\r\n      <FacetValueLabelHighlight\r\n        displayValue={displayValue}\r\n        isSelected={isSelected}\r\n      ></FacetValueLabelHighlight>\r\n    </FacetValueLink>\r\n  );\r\n};\r\n","import {FunctionalComponent, h} from '@stencil/core';\r\nimport {\r\n  CategoryFacetValueLink,\r\n  CategoryFacetValueLinkProps,\r\n} from './value-link';\r\n\r\ninterface CategoryFacetChildValueLinkProps\r\n  extends Omit<CategoryFacetValueLinkProps, 'isParent'> {}\r\n\r\nexport const CategoryFacetChildValueLink: FunctionalComponent<\r\n  CategoryFacetChildValueLinkProps\r\n> = (props, children) => {\r\n  return (\r\n    <CategoryFacetValueLink {...props} isParent={false}>\r\n      {children}\r\n    </CategoryFacetValueLink>\r\n  );\r\n};\r\n","import {FunctionalComponent, h} from '@stencil/core';\r\n\r\ninterface CategoryFacetChildrenAsTreeContainerProps {\r\n  className?: string;\r\n}\r\nexport const CategoryFacetChildrenAsTreeContainer: FunctionalComponent<\r\n  CategoryFacetChildrenAsTreeContainerProps\r\n> = ({className}, children) => {\r\n  return (\r\n    <ul part=\"values\" class={className ?? ''}>\r\n      {children}\r\n    </ul>\r\n  );\r\n};\r\n","import {FunctionalComponent, h} from '@stencil/core';\r\n\r\nexport interface CategoryFacetParentAsTreeContainerProps {\r\n  isTopLevel: boolean;\r\n  className?: string;\r\n}\r\nexport const CategoryFacetParentAsTreeContainer: FunctionalComponent<\r\n  CategoryFacetParentAsTreeContainerProps\r\n> = ({isTopLevel, className}, children) => {\r\n  return (\r\n    <ul class={className ?? ''} part={`${isTopLevel ? '' : 'sub-'}parents`}>\r\n      {children}\r\n    </ul>\r\n  );\r\n};\r\n","import {FunctionalComponent, h} from '@stencil/core';\r\nimport {i18n} from 'i18next';\r\nimport LeftArrow from '../../../../images/arrow-left-rounded.svg';\r\nimport {getFieldValueCaption} from '../../../../utils/field-utils';\r\nimport {Button} from '../../button';\r\n\r\ninterface CategoryFacetParentButtonProps {\r\n  i18n: i18n;\r\n  field: string;\r\n  facetValue: {value: string; numberOfResults: number};\r\n  onClick: () => void;\r\n}\r\nexport const CategoryFacetParentButton: FunctionalComponent<\r\n  CategoryFacetParentButtonProps\r\n> = ({field, facetValue, i18n, onClick}) => {\r\n  const displayValue = getFieldValueCaption(field, facetValue.value, i18n);\r\n  const ariaLabel = i18n.t('facet-value', {\r\n    value: displayValue,\r\n    count: facetValue.numberOfResults,\r\n  });\r\n\r\n  return (\r\n    <Button\r\n      style=\"text-neutral\"\r\n      part=\"parent-button\"\r\n      ariaPressed=\"false\"\r\n      onClick={() => {\r\n        onClick();\r\n      }}\r\n      ariaLabel={ariaLabel}\r\n    >\r\n      <atomic-icon\r\n        icon={LeftArrow}\r\n        part=\"back-arrow\"\r\n        class=\"back-arrow\"\r\n      ></atomic-icon>\r\n      <span class=\"truncate\">{displayValue}</span>\r\n    </Button>\r\n  );\r\n};\r\n","import {FunctionalComponent, h} from '@stencil/core';\r\nimport {\r\n  CategoryFacetValueLink,\r\n  CategoryFacetValueLinkProps,\r\n} from './value-link';\r\n\r\ninterface CategoryFacetParentValueLinkProps\r\n  extends Omit<CategoryFacetValueLinkProps, 'isParent' | 'isSelected'> {}\r\n\r\nexport const CategoryFacetParentValueLink: FunctionalComponent<\r\n  CategoryFacetParentValueLinkProps\r\n> = (props, children) => {\r\n  return (\r\n    <CategoryFacetValueLink {...props} isParent isSelected>\r\n      {children}\r\n    </CategoryFacetValueLink>\r\n  );\r\n};\r\n","import {FunctionalComponent, h} from '@stencil/core';\r\n\r\nexport const CategoryFacetSearchResultsContainer: FunctionalComponent = (\r\n  _,\r\n  children\r\n) => {\r\n  return (\r\n    <ul part=\"search-results\" class=\"mt-3\">\r\n      {children}\r\n    </ul>\r\n  );\r\n};\r\n","import {FunctionalComponent, h} from '@stencil/core';\r\nimport {i18n} from 'i18next';\r\nimport {getFieldValueCaption} from '../../../../utils/field-utils';\r\nimport {Button} from '../../button';\r\nimport {FacetValueLabelHighlight} from '../facet-value-label-highlight/facet-value-label-highlight';\r\n\r\ninterface CategoryFacetSearchValueProps {\r\n  value: {count: number; path: string[]; displayValue: string};\r\n  i18n: i18n;\r\n  field: string;\r\n  onClick(): void;\r\n  searchQuery: string;\r\n}\r\n\r\nconst SEPARATOR = '/';\r\nconst ELLIPSIS = '...';\r\nconst PATH_MAX_LENGTH = 3;\r\n\r\nexport const CategoryFacetSearchValue: FunctionalComponent<\r\n  CategoryFacetSearchValueProps\r\n> = ({value, field, i18n, onClick, searchQuery}) => {\r\n  const count = value.count.toLocaleString(i18n.language);\r\n  const inLabel = i18n.t('in');\r\n  const allCategories = i18n.t('all-categories');\r\n  const localizedPath = value.path.length\r\n    ? value.path.map((value) => getFieldValueCaption(field, value, i18n))\r\n    : [allCategories];\r\n  const ariaLabel = i18n.t('under', {\r\n    child: i18n.t('facet-value', {\r\n      numberOfResults: value.count,\r\n      value: value.displayValue,\r\n    }),\r\n    parent: localizedPath.join(', '),\r\n  });\r\n\r\n  function ellipsedPath(path: string[]) {\r\n    if (path.length <= PATH_MAX_LENGTH) {\r\n      return path;\r\n    }\r\n    const firstPart = path.slice(0, 1);\r\n    const lastParts = path.slice(-PATH_MAX_LENGTH + 1);\r\n    return firstPart.concat(ELLIPSIS, ...lastParts);\r\n  }\r\n\r\n  function renderPath(path: string[]) {\r\n    if (!path.length) {\r\n      return <span class=\"truncate\">{`${inLabel} ${allCategories}`}</span>;\r\n    }\r\n\r\n    return [\r\n      <span class=\"mr-0.5\">{inLabel}</span>,\r\n      ellipsedPath(path).map((value, index) => [\r\n        index > 0 && <span class=\"mx-0.5\">{SEPARATOR}</span>,\r\n        <span class={value === ELLIPSIS ? '' : 'truncate flex-1 max-w-max'}>\r\n          {value}\r\n        </span>,\r\n      ]),\r\n    ];\r\n  }\r\n\r\n  return (\r\n    <li key={value.displayValue}>\r\n      <Button\r\n        style=\"text-neutral\"\r\n        part=\"search-result\"\r\n        onClick={() => onClick()}\r\n        class=\"w-full flex flex-col px-2 py-2.5 truncate group no-outline\"\r\n        aria-label={ariaLabel}\r\n      >\r\n        <div class=\"w-full flex\">\r\n          <FacetValueLabelHighlight\r\n            displayValue={value.displayValue}\r\n            isSelected={false}\r\n            searchQuery={searchQuery}\r\n          ></FacetValueLabelHighlight>\r\n          <span part=\"value-count\" class=\"value-count\">\r\n            {i18n.t('between-parentheses', {\r\n              text: count,\r\n            })}\r\n          </span>\r\n        </div>\r\n        <div\r\n          part=\"search-result-path\"\r\n          class=\"flex w-full text-neutral-dark mt-1 group-focus:text-primary group-hover:text-primary\"\r\n        >\r\n          {renderPath(localizedPath)}\r\n        </div>\r\n      </Button>\r\n    </li>\r\n  );\r\n};\r\n","import {FunctionalComponent, h} from '@stencil/core';\r\n\r\nexport const CategoryFacetTreeValueContainer: FunctionalComponent = (\r\n  _,\r\n  children\r\n) => {\r\n  return <li class=\"contents\">{children}</li>;\r\n};\r\n","@import '../../../common/facets/facet-common.pcss';\r\n@import '../../../common/facets/facet-search/facet-search.pcss';\r\n\r\n[part~='active-parent'] {\r\n  @apply pl-9;\r\n}\r\n\r\n[part~='parents'] [part~='values'] {\r\n  @apply pl-9;\r\n}\r\n\r\n[part~='all-categories-button'],\r\n[part~='parent-button'] {\r\n  @apply w-full py-2.5 pr-2 pl-7 text-left relative flex items-center;\r\n}\r\n\r\n[part~='back-arrow'] {\r\n  @apply h-5 w-5 absolute left-1;\r\n}\r\n","import {\r\n  CategoryFacet,\r\n  buildCategoryFacet,\r\n  CategoryFacetState,\r\n  CategoryFacetOptions,\r\n  CategoryFacetSortCriterion,\r\n  SearchStatus,\r\n  SearchStatusState,\r\n  buildSearchStatus,\r\n  CategoryFacetValue,\r\n  buildFacetConditionsManager,\r\n  FacetConditionsManager,\r\n  FacetValueRequest,\r\n  CategoryFacetValueRequest,\r\n} from '@coveo/headless';\r\nimport {Component, h, State, Prop, Element, Fragment} from '@stencil/core';\r\nimport {\r\n  AriaLiveRegion,\r\n  FocusTargetController,\r\n} from '../../../../utils/accessibility-utils';\r\nimport {\r\n  getFieldCaptions,\r\n  getFieldValueCaption,\r\n} from '../../../../utils/field-utils';\r\nimport {\r\n  BindStateToController,\r\n  InitializableComponent,\r\n  InitializeBindings,\r\n} from '../../../../utils/initialization-utils';\r\nimport {ArrayProp, MapProp} from '../../../../utils/props-utils';\r\nimport {CategoryFacetAllCategoryButton} from '../../../common/facets/category-facet/all-categories-button';\r\nimport {CategoryFacetChildValueLink} from '../../../common/facets/category-facet/child-value-link';\r\nimport {CategoryFacetChildrenAsTreeContainer} from '../../../common/facets/category-facet/children-as-tree-container';\r\nimport {CategoryFacetParentAsTreeContainer} from '../../../common/facets/category-facet/parent-as-tree-container';\r\nimport {CategoryFacetParentButton} from '../../../common/facets/category-facet/parent-button';\r\nimport {CategoryFacetParentValueLink} from '../../../common/facets/category-facet/parent-value-link';\r\nimport {CategoryFacetSearchResultsContainer} from '../../../common/facets/category-facet/search-results-container';\r\nimport {CategoryFacetSearchValue} from '../../../common/facets/category-facet/search-value';\r\nimport {CategoryFacetTreeValueContainer} from '../../../common/facets/category-facet/value-as-tree-container';\r\nimport {parseDependsOn} from '../../../common/facets/depends-on';\r\nimport {FacetInfo} from '../../../common/facets/facet-common-store';\r\nimport {FacetContainer} from '../../../common/facets/facet-container/facet-container';\r\nimport {FacetGuard} from '../../../common/facets/facet-guard';\r\nimport {FacetHeader} from '../../../common/facets/facet-header/facet-header';\r\nimport {FacetPlaceholder} from '../../../common/facets/facet-placeholder/facet-placeholder';\r\nimport {announceFacetSearchResultsWithAriaLive} from '../../../common/facets/facet-search/facet-search-aria-live';\r\nimport {FacetSearchInput} from '../../../common/facets/facet-search/facet-search-input';\r\nimport {FacetSearchMatches} from '../../../common/facets/facet-search/facet-search-matches';\r\nimport {\r\n  shouldUpdateFacetSearchComponent,\r\n  shouldDisplaySearchResults,\r\n} from '../../../common/facets/facet-search/facet-search-utils';\r\nimport {FacetShowMoreLess} from '../../../common/facets/facet-show-more-less/facet-show-more-less';\r\nimport {FacetValuesGroup} from '../../../common/facets/facet-values-group/facet-values-group';\r\nimport {Bindings} from '../../atomic-search-interface/atomic-search-interface';\r\nimport {initializePopover} from '../atomic-popover/popover-type';\r\n\r\n/**\r\n * A facet is a list of values for a certain field occurring in the results, ordered using a configurable criteria (e.g., number of occurrences).\r\n * An `atomic-category-facet` displays a facet of values in a browsable, hierarchical fashion.\r\n *\r\n * @part facet - The wrapper for the entire facet.\r\n * @part placeholder - The placeholder shown before the first search is executed.\r\n *\r\n * @part label-button - The button that displays the label and allows to expand/collapse the facet.\r\n * @part label-button-icon - The label button icon.\r\n *\r\n * @part search-wrapper - The search box wrapper.\r\n * @part search-input - The search box input.\r\n * @part search-icon - The search box submit button.\r\n * @part search-clear-button - The button to clear the search box of input.\r\n * @part more-matches - The label indicating there are more matches for the current facet search query.\r\n * @part no-matches - The label indicating there are no matches for the current facet search query.\r\n * @part matches-query - The highlighted query inside the matches labels.\r\n * @part search-results - The search results container.\r\n * @part search-result - The search result value.\r\n * @part search-result-path - The search result path.\r\n * @part search-highlight - The highlighted query inside the facet values.\r\n *\r\n * @part parents - The container surrounding the whole hierarchy of values.\r\n * @part sub-parents - The container surrounding a sub-hierarchy of values.\r\n * @part values - The container surrounding either the children of the active value or the values at the base.\r\n * @part all-categories-button - The \"View all\" button displayed first within the parents.\r\n * @part parent-button - The clickable parent button displayed first within sub-parents.\r\n * @part active-parent - The clickable active parent displayed first within the last sub-parents.\r\n * @part value-link - The clickable value displayed first within values.\r\n * @part back-arrow - The back arrow displayed before the clickable parents.\r\n * @part value-label - The facet value label within a value button.\r\n * @part value-count - The facet value count within a value button.\r\n * @part leaf-value - A facet value with no child value.\r\n * @part node-value - A facet value with child values.\r\n *\r\n * @part show-more - The show more results button.\r\n * @part show-less - The show less results button.\r\n * @part show-more-less-icon - The icons of the show more & show less buttons.\r\n */\r\n@Component({\r\n  tag: 'atomic-category-facet',\r\n  styleUrl: 'atomic-category-facet.pcss',\r\n  shadow: true,\r\n})\r\nexport class AtomicCategoryFacet implements InitializableComponent {\r\n  @InitializeBindings() public bindings!: Bindings;\r\n  public facet!: CategoryFacet;\r\n  private dependenciesManager?: FacetConditionsManager;\r\n  private resultIndexToFocusOnShowMore = 0;\r\n  public searchStatus!: SearchStatus;\r\n  @Element() private host!: HTMLElement;\r\n\r\n  @BindStateToController('facet')\r\n  @State()\r\n  public facetState!: CategoryFacetState;\r\n  @BindStateToController('searchStatus')\r\n  @State()\r\n  public searchStatusState!: SearchStatusState;\r\n  @State() public error!: Error;\r\n\r\n  /**\r\n   * Specifies a unique identifier for the facet.\r\n   */\r\n  @Prop({mutable: true, reflect: true}) public facetId?: string;\r\n  /**\r\n   * The non-localized label for the facet.\r\n   * Used in the `atomic-breadbox` component through the bindings store.\r\n   */\r\n  @Prop({reflect: true}) public label = 'no-label';\r\n  /**\r\n   * The field whose values you want to display in the facet.\r\n   */\r\n  @Prop({reflect: true}) public field!: string;\r\n  /**\r\n   * The number of values to request for this facet.\r\n   * Also determines the number of additional values to request each time more values are shown.\r\n   */\r\n  @Prop({reflect: true}) public numberOfValues = 8;\r\n  /**\r\n   * Whether this facet should contain a search box.\r\n   *\r\n   */\r\n  @Prop({reflect: true}) public withSearch = false;\r\n  /**\r\n   * The sort criterion to apply to the returned facet values.\r\n   * Possible values are 'alphanumeric' and 'occurrences'.\r\n   * For this criterion to apply to the top-layer facet values, disable\r\n   * [facet value ordering](https://docs.coveo.com/en/l1qf4156/#facet-value-ordering)\r\n   * in your Dynamic Navigation Experience configuration.\r\n   */\r\n  // TODO: add automatic (occurrences when not expanded, alphanumeric when expanded)\r\n  @Prop({reflect: true}) public sortCriteria: CategoryFacetSortCriterion =\r\n    'occurrences';\r\n  /**\r\n   * The character that separates values of a multi-value field.\r\n   *\r\n   * *Note:* If you use the [example formatting](https://docs.coveo.com/en/atomic/latest/reference/components/atomic-category-facet/#usage-notes) for the associated multi-value field, you must set this value to `|` or the facet won't display properly.\r\n   */\r\n  @Prop({reflect: true}) public delimitingCharacter = ';';\r\n  /**\r\n   * The base path shared by all values for the facet.\r\n   *\r\n   * Specify the property as an array using a JSON string representation:\r\n   * ```html\r\n   *  <atomic-category-facet base-path='[\"first value\", \"second value\"]' ></atomic-category-facet>\r\n   * ```\r\n   */\r\n  @ArrayProp()\r\n  @Prop({reflect: true, mutable: true})\r\n  public basePath: string[] | string = '[]';\r\n\r\n  /**\r\n   * Whether to use basePath as a filter for the results.\r\n   */\r\n  @Prop({reflect: true}) public filterByBasePath = true;\r\n  /**\r\n   * Specifies whether the facet is collapsed. When the facet is the child of an `atomic-facet-manager` component, the facet manager controls this property.\r\n   */\r\n  @Prop({reflect: true, mutable: true}) public isCollapsed = false;\r\n  /**\r\n   * The [heading level](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/Heading_Elements) to use for the heading over the facet, from 1 to 6.\r\n   */\r\n  @Prop({reflect: true}) public headingLevel = 0;\r\n  /**\r\n   * Whether to exclude the parents of folded results when estimating the result count for each facet value.\r\n   */\r\n  @Prop({reflect: true}) public filterFacetCount = true;\r\n  /**\r\n   * The maximum number of results to scan in the index to ensure that the facet lists all potential facet values.\r\n   * Note: A high injectionDepth may negatively impact the facet request performance.\r\n   * Minimum: `0`\r\n   * Default: `1000`\r\n   */\r\n  @Prop({reflect: true}) public injectionDepth = 1000;\r\n  // @Prop() public customSort?: string; TODO: KIT-753 Add customSort option for facet\r\n\r\n  /**\r\n   * The required facets and values for this facet to be displayed.\r\n   * Examples:\r\n   * ```html\r\n   * <atomic-facet facet-id=\"abc\" field=\"objecttype\" ...></atomic-facet>\r\n   *\r\n   * <!-- To show the facet when any value is selected in the facet with id \"abc\": -->\r\n   * <atomic-category-facet\r\n   *   depends-on-abc\r\n   *   ...\r\n   * ></atomic-category-facet>\r\n   *\r\n   * <!-- To show the facet when value \"doc\" is selected in the facet with id \"abc\": -->\r\n   * <atomic-category-facet\r\n   *   depends-on-abc=\"doc\"\r\n   *   ...\r\n   * ></atomic-category-facet>\r\n   * ```\r\n   */\r\n  @MapProp() @Prop() public dependsOn: Record<string, string> = {};\r\n\r\n  private showLessFocus?: FocusTargetController;\r\n\r\n  private showMoreFocus?: FocusTargetController;\r\n\r\n  private headerFocus?: FocusTargetController;\r\n\r\n  private activeValueFocus?: FocusTargetController;\r\n\r\n  @AriaLiveRegion('facet-search')\r\n  protected facetSearchAriaMessage!: string;\r\n\r\n  public initialize() {\r\n    this.searchStatus = buildSearchStatus(this.bindings.engine);\r\n    const options: CategoryFacetOptions = {\r\n      facetId: this.facetId,\r\n      field: this.field,\r\n      numberOfValues: this.numberOfValues,\r\n      sortCriteria: this.sortCriteria,\r\n      facetSearch: {numberOfValues: this.numberOfValues},\r\n      basePath: [...this.basePath],\r\n      delimitingCharacter: this.delimitingCharacter,\r\n      filterByBasePath: this.filterByBasePath,\r\n      injectionDepth: this.injectionDepth,\r\n      filterFacetCount: this.filterFacetCount,\r\n    };\r\n    this.facet = buildCategoryFacet(this.bindings.engine, {options});\r\n    announceFacetSearchResultsWithAriaLive(\r\n      this.facet,\r\n      this.label,\r\n      (msg) => (this.facetSearchAriaMessage = msg),\r\n      this.bindings.i18n\r\n    );\r\n    this.facetId = this.facet.state.facetId;\r\n    const facetInfo: FacetInfo = {\r\n      label: () => this.bindings.i18n.t(this.label),\r\n      facetId: this.facetId!,\r\n      element: this.host,\r\n      isHidden: () => this.isHidden,\r\n    };\r\n    this.bindings.store.registerFacet('categoryFacets', facetInfo);\r\n    initializePopover(this.host, {\r\n      ...facetInfo,\r\n      hasValues: () => !!this.facet.state.values.length,\r\n      numberOfActiveValues: () => (this.facetState.hasActiveValues ? 1 : 0),\r\n    });\r\n    this.initializeDependenciesManager();\r\n  }\r\n\r\n  private get focusTargets() {\r\n    if (!this.showLessFocus) {\r\n      this.showLessFocus = new FocusTargetController(this);\r\n    }\r\n    if (!this.showMoreFocus) {\r\n      this.showMoreFocus = new FocusTargetController(this);\r\n    }\r\n    if (!this.headerFocus) {\r\n      this.headerFocus = new FocusTargetController(this);\r\n    }\r\n    if (!this.activeValueFocus) {\r\n      this.activeValueFocus = new FocusTargetController(this);\r\n    }\r\n\r\n    return {\r\n      showLessFocus: this.showLessFocus,\r\n      showMoreFocus: this.showMoreFocus,\r\n      headerFocus: this.headerFocus,\r\n      activeValueFocus: this.activeValueFocus,\r\n    };\r\n  }\r\n\r\n  public disconnectedCallback() {\r\n    if (this.host.isConnected) {\r\n      return;\r\n    }\r\n    this.dependenciesManager?.stopWatching();\r\n  }\r\n\r\n  private get isHidden() {\r\n    return (\r\n      this.searchStatusState.hasError ||\r\n      !this.facet.state.enabled ||\r\n      (!this.facet.state.values.length && !this.facet.state.parents.length)\r\n    );\r\n  }\r\n\r\n  public componentShouldUpdate(\r\n    next: unknown,\r\n    prev: unknown,\r\n    propName: keyof AtomicCategoryFacet\r\n  ) {\r\n    if (\r\n      this.isCategoryFacetState(prev, propName) &&\r\n      this.isCategoryFacetState(next, propName)\r\n    ) {\r\n      return shouldUpdateFacetSearchComponent(\r\n        next.facetSearch,\r\n        prev.facetSearch\r\n      );\r\n    }\r\n    return true;\r\n  }\r\n\r\n  private get hasParents() {\r\n    return !!this.facetState.parents.length;\r\n  }\r\n\r\n  private initializeDependenciesManager() {\r\n    this.dependenciesManager = buildFacetConditionsManager(\r\n      this.bindings.engine,\r\n      {\r\n        facetId: this.facetId!,\r\n        conditions: parseDependsOn<\r\n          FacetValueRequest | CategoryFacetValueRequest\r\n        >(this.dependsOn),\r\n      }\r\n    );\r\n  }\r\n\r\n  private renderHeader() {\r\n    return (\r\n      <FacetHeader\r\n        i18n={this.bindings.i18n}\r\n        label={this.label}\r\n        numberOfActiveValues={\r\n          this.facetState.hasActiveValues && this.isCollapsed ? 1 : 0\r\n        }\r\n        isCollapsed={this.isCollapsed}\r\n        headingLevel={this.headingLevel}\r\n        onToggleCollapse={() => (this.isCollapsed = !this.isCollapsed)}\r\n        onClearFilters={() => {\r\n          this.focusTargets.headerFocus.focusAfterSearch();\r\n          this.facet.deselectAll();\r\n        }}\r\n        headerRef={(header) => {\r\n          this.focusTargets.headerFocus.setTarget(header);\r\n          if (!this.hasParents) {\r\n            this.focusTargets.activeValueFocus.setTarget(header);\r\n          }\r\n        }}\r\n      ></FacetHeader>\r\n    );\r\n  }\r\n\r\n  private renderSearchInput() {\r\n    if (!this.withSearch) {\r\n      return;\r\n    }\r\n\r\n    return (\r\n      <FacetSearchInput\r\n        i18n={this.bindings.i18n}\r\n        label={this.label}\r\n        query={this.facetState.facetSearch.query}\r\n        onChange={(value) => {\r\n          if (value === '') {\r\n            this.facet.facetSearch.clear();\r\n            return;\r\n          }\r\n          this.facet.facetSearch.updateCaptions(\r\n            getFieldCaptions(this.field, this.bindings.i18n)\r\n          );\r\n          this.facet.facetSearch.updateText(value);\r\n          this.facet.facetSearch.search();\r\n        }}\r\n        onClear={() => this.facet.facetSearch.clear()}\r\n      ></FacetSearchInput>\r\n    );\r\n  }\r\n\r\n  private renderValuesTree(parents: CategoryFacetValue[], isRoot: boolean) {\r\n    if (!this.hasParents) {\r\n      return this.renderChildren();\r\n    }\r\n\r\n    if (isRoot) {\r\n      return (\r\n        <CategoryFacetTreeValueContainer>\r\n          <CategoryFacetAllCategoryButton\r\n            i18n={this.bindings.i18n}\r\n            onClick={() => {\r\n              this.focusTargets.activeValueFocus.focusAfterSearch();\r\n              this.facet.deselectAll();\r\n            }}\r\n          />\r\n          <CategoryFacetParentAsTreeContainer isTopLevel={false}>\r\n            {this.renderValuesTree(parents, false)}\r\n          </CategoryFacetParentAsTreeContainer>\r\n        </CategoryFacetTreeValueContainer>\r\n      );\r\n    }\r\n\r\n    if (parents.length > 1) {\r\n      const parentValue = parents[0];\r\n\r\n      return (\r\n        <CategoryFacetTreeValueContainer>\r\n          <CategoryFacetParentButton\r\n            facetValue={parentValue}\r\n            field={this.field}\r\n            i18n={this.bindings.i18n}\r\n            onClick={() => {\r\n              this.focusTargets.activeValueFocus.focusAfterSearch();\r\n              this.facet.toggleSelect(parentValue);\r\n            }}\r\n          />\r\n          <CategoryFacetParentAsTreeContainer isTopLevel={false}>\r\n            {this.renderValuesTree(parents.slice(1), false)}\r\n          </CategoryFacetParentAsTreeContainer>\r\n        </CategoryFacetTreeValueContainer>\r\n      );\r\n    }\r\n\r\n    const activeParent = parents[0];\r\n    const activeParentDisplayValue = getFieldValueCaption(\r\n      this.field,\r\n      activeParent.value,\r\n      this.bindings.i18n\r\n    );\r\n\r\n    return (\r\n      <CategoryFacetParentValueLink\r\n        displayValue={activeParentDisplayValue}\r\n        numberOfResults={activeParent.numberOfResults}\r\n        i18n={this.bindings.i18n}\r\n        isLeafValue={activeParent.isLeafValue}\r\n        onClick={() => {\r\n          this.focusTargets.activeValueFocus.focusAfterSearch();\r\n          this.facet.deselectAll();\r\n        }}\r\n        searchQuery={this.facetState.facetSearch.query}\r\n        setRef={(el) => this.focusTargets.activeValueFocus.setTarget(el)}\r\n      >\r\n        <CategoryFacetChildrenAsTreeContainer>\r\n          {this.renderChildren()}\r\n        </CategoryFacetChildrenAsTreeContainer>\r\n      </CategoryFacetParentValueLink>\r\n    );\r\n  }\r\n\r\n  private renderChild(\r\n    facetValue: CategoryFacetValue,\r\n    isShowLessFocusTarget: boolean,\r\n    isShowMoreFocusTarget: boolean\r\n  ) {\r\n    const displayValue = getFieldValueCaption(\r\n      this.field,\r\n      facetValue.value,\r\n      this.bindings.i18n\r\n    );\r\n    const isSelected = facetValue.state === 'selected';\r\n    return (\r\n      <CategoryFacetChildValueLink\r\n        displayValue={displayValue}\r\n        i18n={this.bindings.i18n}\r\n        isLeafValue={facetValue.isLeafValue}\r\n        isSelected={isSelected}\r\n        numberOfResults={facetValue.numberOfResults}\r\n        onClick={() => {\r\n          this.focusTargets.activeValueFocus.focusAfterSearch();\r\n          this.facet.toggleSelect(facetValue);\r\n        }}\r\n        searchQuery={this.facetState.facetSearch.query}\r\n        setRef={(element) => {\r\n          isShowLessFocusTarget &&\r\n            this.focusTargets.showLessFocus.setTarget(element);\r\n          isShowMoreFocusTarget &&\r\n            this.focusTargets.showMoreFocus.setTarget(element);\r\n        }}\r\n      ></CategoryFacetChildValueLink>\r\n    );\r\n  }\r\n\r\n  private renderChildren() {\r\n    if (!this.facetState.values.length) {\r\n      return;\r\n    }\r\n\r\n    return this.facetState.values.map((value, i) =>\r\n      this.renderChild(value, i === 0, i === this.resultIndexToFocusOnShowMore)\r\n    );\r\n  }\r\n\r\n  private renderSearchResults() {\r\n    return (\r\n      <CategoryFacetSearchResultsContainer>\r\n        {this.facetState.facetSearch.values.map((value) => (\r\n          <CategoryFacetSearchValue\r\n            value={value}\r\n            field={this.field}\r\n            i18n={this.bindings.i18n}\r\n            searchQuery={this.facetState.facetSearch.query}\r\n            onClick={() => {\r\n              this.focusTargets.activeValueFocus.focusAfterSearch();\r\n              this.facet.facetSearch.select(value);\r\n            }}\r\n          ></CategoryFacetSearchValue>\r\n        ))}\r\n      </CategoryFacetSearchResultsContainer>\r\n    );\r\n  }\r\n\r\n  private renderMatches() {\r\n    return (\r\n      <FacetSearchMatches\r\n        i18n={this.bindings.i18n}\r\n        query={this.facetState.facetSearch.query}\r\n        numberOfMatches={this.facetState.facetSearch.values.length}\r\n        hasMoreMatches={this.facetState.facetSearch.moreValuesAvailable}\r\n      ></FacetSearchMatches>\r\n    );\r\n  }\r\n\r\n  private renderShowMoreLess() {\r\n    return (\r\n      <div class={this.hasParents ? 'pl-9' : ''}>\r\n        <FacetShowMoreLess\r\n          label={this.label}\r\n          i18n={this.bindings.i18n}\r\n          onShowMore={() => {\r\n            this.resultIndexToFocusOnShowMore = this.facetState.values.length;\r\n            this.focusTargets.showMoreFocus.focusAfterSearch();\r\n            this.facet.showMoreValues();\r\n          }}\r\n          onShowLess={() => {\r\n            this.focusTargets.showLessFocus.focusAfterSearch();\r\n            this.facet.showLessValues();\r\n          }}\r\n          canShowLessValues={this.facetState.canShowLessValues}\r\n          canShowMoreValues={this.facetState.canShowMoreValues}\r\n        ></FacetShowMoreLess>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private isCategoryFacetState(\r\n    state: unknown,\r\n    propName: string\r\n  ): state is CategoryFacetState {\r\n    return (\r\n      propName === 'facetState' &&\r\n      typeof (state as CategoryFacetState)?.facetId === 'string'\r\n    );\r\n  }\r\n\r\n  public render() {\r\n    const {\r\n      bindings: {i18n},\r\n      label,\r\n      facetState: {facetSearch, enabled, valuesAsTrees, parents},\r\n      searchStatusState: {hasError, firstSearchExecuted},\r\n    } = this;\r\n\r\n    return (\r\n      <FacetGuard\r\n        enabled={enabled}\r\n        firstSearchExecuted={firstSearchExecuted}\r\n        hasError={hasError}\r\n        hasResults={valuesAsTrees.length > 0}\r\n      >\r\n        {firstSearchExecuted ? (\r\n          <FacetContainer>\r\n            {this.renderHeader()}\r\n            {!this.isCollapsed && [\r\n              this.renderSearchInput(),\r\n              shouldDisplaySearchResults(facetSearch) ? (\r\n                <Fragment>\r\n                  {facetSearch.values.length ? (\r\n                    <FacetValuesGroup\r\n                      i18n={i18n}\r\n                      label={label}\r\n                      query={facetSearch.query}\r\n                    >\r\n                      {this.renderSearchResults()}\r\n                    </FacetValuesGroup>\r\n                  ) : (\r\n                    <div class=\"mt-3\"></div>\r\n                  )}\r\n                  {this.renderMatches()}\r\n                </Fragment>\r\n              ) : (\r\n                <Fragment>\r\n                  <FacetValuesGroup i18n={i18n} label={label}>\r\n                    {this.hasParents ? (\r\n                      <CategoryFacetParentAsTreeContainer\r\n                        isTopLevel={true}\r\n                        className=\"mt-3\"\r\n                      >\r\n                        {this.renderValuesTree(parents, true)}\r\n                      </CategoryFacetParentAsTreeContainer>\r\n                    ) : (\r\n                      <CategoryFacetChildrenAsTreeContainer className=\"mt-3\">\r\n                        {this.renderChildren()}\r\n                      </CategoryFacetChildrenAsTreeContainer>\r\n                    )}\r\n                  </FacetValuesGroup>\r\n                  {this.renderShowMoreLess()}\r\n                </Fragment>\r\n              ),\r\n            ]}\r\n          </FacetContainer>\r\n        ) : (\r\n          <FacetPlaceholder\r\n            isCollapsed={this.isCollapsed}\r\n            numberOfValues={this.numberOfValues}\r\n          />\r\n        )}\r\n      </FacetGuard>\r\n    );\r\n  }\r\n}\r\n"],"version":3}