/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var VF=Object.create;var Ls=Object.defineProperty;var NF=Object.getOwnPropertyDescriptor;var LF=Object.getOwnPropertyNames;var MF=Object.getPrototypeOf,QF=Object.prototype.hasOwnProperty;var BF=(e,t,r)=>t in e?Ls(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var UF=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var fe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),_F=(e,t)=>{for(var r in t)Ls(e,r,{get:t[r],enumerable:!0});},jF=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of LF(t))!QF.call(e,o)&&o!==r&&Ls(e,o,{get:()=>t[o],enumerable:!(n=NF(t,o))||n.enumerable});return e};var He=(e,t,r)=>(r=e!=null?VF(MF(e)):{},jF(t||!e||!e.__esModule?Ls(r,"default",{value:e,enumerable:!0}):r,e));var Ms=(e,t,r)=>BF(e,typeof t!="symbol"?t+"":t,r);var Rf=fe((wq,Af)=>{function $F(e){try{return JSON.stringify(e)}catch{return '"[Circular]"'}}Af.exports=HF;function HF(e,t,r){var n=r&&r.stringify||$F,o=1;if(typeof e=="object"&&e!==null){var a=t.length+o;if(a===1)return e;var i=new Array(a);i[0]=n(e);for(var s=1;s<a;s++)i[s]=n(t[s]);return i.join(" ")}if(typeof e!="string")return e;var c=t.length;if(c===0)return e;for(var u="",l=1-o,d=-1,p=e&&e.length||0,m=0;m<p;){if(e.charCodeAt(m)===37&&m+1<p){switch(d=d>-1?d:0,e.charCodeAt(m+1)){case 100:case 102:if(l>=c||t[l]==null)break;d<m&&(u+=e.slice(d,m)),u+=Number(t[l]),d=m+2,m++;break;case 105:if(l>=c||t[l]==null)break;d<m&&(u+=e.slice(d,m)),u+=Math.floor(Number(t[l])),d=m+2,m++;break;case 79:case 111:case 106:if(l>=c||t[l]===void 0)break;d<m&&(u+=e.slice(d,m));var S=typeof t[l];if(S==="string"){u+="'"+t[l]+"'",d=m+2,m++;break}if(S==="function"){u+=t[l].name||"<anonymous>",d=m+2,m++;break}u+=n(t[l]),d=m+2,m++;break;case 115:if(l>=c)break;d<m&&(u+=e.slice(d,m)),u+=String(t[l]),d=m+2,m++;break;case 37:d<m&&(u+=e.slice(d,m)),u+="%",d=m+2,m++,l--;break}++l;}++m;}return d===-1?e:(d<p&&(u+=e.slice(d)),u)}});var qd=fe((Eq,_s)=>{var bf=Rf();_s.exports=br;var ki=iA().console||{},zF={mapHttpRequest:Qs,mapHttpResponse:Qs,wrapRequestSerializer:Id,wrapResponseSerializer:Id,wrapErrorSerializer:Id,req:Qs,res:Qs,err:Pf,errWithCause:Pf};function Bs(e,t){return e==="silent"?1/0:t.levels.values[e]}var Td=Symbol("pino.logFuncs"),kd=Symbol("pino.hierarchy"),GF={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function vf(e,t){let r={logger:t,parent:e[kd]};t[kd]=r;}function WF(e,t,r){let n={};t.forEach(o=>{n[o]=r[o]?r[o]:ki[o]||ki[GF[o]||"log"]||Oi;}),e[Td]=n;}function YF(e,t){return Array.isArray(e)?e.filter(function(n){return n!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function br(e){e=e||{},e.browser=e.browser||{};let t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");let r=e.browser.write||ki;e.browser.write&&(e.browser.asObject=!0);let n=e.serializers||{},o=YF(e.browser.serialize,n),a=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(a=!1);let i=Object.keys(e.customLevels||{}),s=["error","fatal","warn","info","debug","trace"].concat(i);typeof r=="function"&&s.forEach(function(F){r[F]=r;}),(e.enabled===!1||e.browser.disabled)&&(e.level="silent");let c=e.level||"info",u=Object.create(r);u.log||(u.log=Oi),WF(u,s,r),vf({},u),Object.defineProperty(u,"levelVal",{get:d}),Object.defineProperty(u,"level",{get:p,set:m});let l={transmit:t,serialize:o,asObject:e.browser.asObject,formatters:e.browser.formatters,levels:s,timestamp:nA(e)};u.levels=KF(e),u.level=c,u.setMaxListeners=u.getMaxListeners=u.emit=u.addListener=u.on=u.prependListener=u.once=u.prependOnceListener=u.removeListener=u.removeAllListeners=u.listeners=u.listenerCount=u.eventNames=u.write=u.flush=Oi,u.serializers=n,u._serialize=o,u._stdErrSerialize=a,u.child=S,t&&(u._logEvent=Od());function d(){return Bs(this.level,this)}function p(){return this._level}function m(F){if(F!=="silent"&&!this.levels.values[F])throw Error("unknown level "+F);this._level=F,Un(this,l,u,"error"),Un(this,l,u,"fatal"),Un(this,l,u,"warn"),Un(this,l,u,"info"),Un(this,l,u,"debug"),Un(this,l,u,"trace"),i.forEach(y=>{Un(this,l,u,y);});}function S(F,y){if(!F)throw new Error("missing bindings for child Pino");y=y||{},o&&F.serializers&&(y.serializers=F.serializers);let A=y.serializers;if(o&&A){var w=Object.assign({},n,A),V=e.browser.serialize===!0?Object.keys(w):o;delete F.serializers,Us([F],V,w,this._stdErrSerialize);}function U(Y){this._childLevel=(Y._childLevel|0)+1,this.bindings=F,w&&(this.serializers=w,this._serialize=V),t&&(this._logEvent=Od([].concat(Y._logEvent.bindings,F)));}U.prototype=this;let Z=new U(this);return vf(this,Z),Z.level=this.level,Z}return u}function KF(e){let t=e.customLevels||{},r=Object.assign({},br.levels.values,t),n=Object.assign({},br.levels.labels,JF(t));return {values:r,labels:n}}function JF(e){let t={};return Object.keys(e).forEach(function(r){t[e[r]]=r;}),t}br.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};br.stdSerializers=zF;br.stdTimeFunctions=Object.assign({},{nullTime:wf,epochTime:Ef,unixTime:oA,isoTime:aA});function XF(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[kd];for(;r.parent;)r=r.parent,r.logger.bindings&&t.push(r.logger.bindings);return t.reverse()}function Un(e,t,r,n){if(Object.defineProperty(e,n,{value:Bs(e.level,r)>Bs(n,r)?Oi:r[Td][n],writable:!0,enumerable:!0,configurable:!0}),!t.transmit&&e[n]===Oi)return;e[n]=eA(e,t,r,n);let o=XF(e);o.length!==0&&(e[n]=ZF(o,e[n]));}function ZF(e,t){return function(){return t.apply(this,[...e,...arguments])}}function eA(e,t,r,n){return function(o){return function(){let i=t.timestamp(),s=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===ki?ki:this;for(var u=0;u<s.length;u++)s[u]=arguments[u];if(t.serialize&&!t.asObject&&Us(s,this._serialize,this.serializers,this._stdErrSerialize),t.asObject||t.formatters?o.call(c,tA(this,n,s,i,t.formatters)):o.apply(c,s),t.transmit){let l=t.transmit.level||e._level,d=r.levels.values[l],p=r.levels.values[n];if(p<d)return;rA(this,{ts:i,methodLevel:n,methodValue:p,transmitLevel:l,transmitValue:r.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:Bs(e._level,r)},s);}}}(e[Td][n])}function tA(e,t,r,n,o={}){let{level:a=()=>e.levels.values[t],log:i=p=>p}=o;e._serialize&&Us(r,e._serialize,e.serializers,e._stdErrSerialize);let s=r.slice(),c=s[0],u={};n&&(u.time=n),u.level=a(t,e.levels.values[t]);let l=(e._childLevel|0)+1;if(l<1&&(l=1),c!==null&&typeof c=="object"){for(;l--&&typeof s[0]=="object";)Object.assign(u,s.shift());c=s.length?bf(s.shift(),s):void 0;}else typeof c=="string"&&(c=bf(s.shift(),s));return c!==void 0&&(u.msg=c),i(u)}function Us(e,t,r,n){for(let o in e)if(n&&e[o]instanceof Error)e[o]=br.stdSerializers.err(e[o]);else if(typeof e[o]=="object"&&!Array.isArray(e[o]))for(let a in e[o])t&&t.indexOf(a)>-1&&a in r&&(e[o][a]=r[a](e[o][a]));}function rA(e,t,r){let n=t.send,o=t.ts,a=t.methodLevel,i=t.methodValue,s=t.val,c=e._logEvent.bindings;Us(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=o,e._logEvent.messages=r.filter(function(u){return c.indexOf(u)===-1}),e._logEvent.level.label=a,e._logEvent.level.value=i,n(a,e._logEvent,s),e._logEvent=Od(c);}function Od(e){return {ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function Pf(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)t[r]===void 0&&(t[r]=e[r]);return t}function nA(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?wf:Ef}function Qs(){return {}}function Id(e){return e}function Oi(){}function wf(){return !1}function Ef(){return Date.now()}function oA(){return Math.round(Date.now()/1e3)}function aA(){return new Date(Date.now()).toISOString()}function iA(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}_s.exports.default=br;_s.exports.pino=br;});var Hs=fe((Dd,Vd)=>{(function(e,t){typeof Dd=="object"&&typeof Vd<"u"?Vd.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs=t();})(Dd,function(){var e=1e3,t=6e4,r=36e5,n="millisecond",o="second",a="minute",i="hour",s="day",c="week",u="month",l="quarter",d="year",p="date",m="Invalid Date",S=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,F=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(z){var D=["th","st","nd","rd"],T=z%100;return "["+z+(D[(T-20)%10]||D[T]||D[0])+"]"}},A=function(z,D,T){var _=String(z);return !_||_.length>=D?z:""+Array(D+1-_.length).join(T)+z},w={s:A,z:function(z){var D=-z.utcOffset(),T=Math.abs(D),_=Math.floor(T/60),q=T%60;return (D<=0?"+":"-")+A(_,2,"0")+":"+A(q,2,"0")},m:function z(D,T){if(D.date()<T.date())return -z(T,D);var _=12*(T.year()-D.year())+(T.month()-D.month()),q=D.clone().add(_,u),G=T-q<0,W=D.clone().add(_+(G?-1:1),u);return +(-(_+(T-q)/(G?q-W:W-q))||0)},a:function(z){return z<0?Math.ceil(z)||0:Math.floor(z)},p:function(z){return {M:u,y:d,w:c,d:s,D:p,h:i,m:a,s:o,ms:n,Q:l}[z]||String(z||"").toLowerCase().replace(/s$/,"")},u:function(z){return z===void 0}},V="en",U={};U[V]=y;var Z="$isDayjsObject",Y=function(z){return z instanceof Te||!(!z||!z[Z])},te=function z(D,T,_){var q;if(!D)return V;if(typeof D=="string"){var G=D.toLowerCase();U[G]&&(q=G),T&&(U[G]=T,q=G);var W=D.split("-");if(!q&&W.length>1)return z(W[0])}else {var ae=D.name;U[ae]=D,q=ae;}return !_&&q&&(V=q),q||!_&&V},K=function(z,D){if(Y(z))return z.clone();var T=typeof D=="object"?D:{};return T.date=z,T.args=arguments,new Te(T)},J=w;J.l=te,J.i=Y,J.w=function(z,D){return K(z,{locale:D.$L,utc:D.$u,x:D.$x,$offset:D.$offset})};var Te=function(){function z(T){this.$L=te(T.locale,null,!0),this.parse(T),this.$x=this.$x||T.x||{},this[Z]=!0;}var D=z.prototype;return D.parse=function(T){this.$d=function(_){var q=_.date,G=_.utc;if(q===null)return new Date(NaN);if(J.u(q))return new Date;if(q instanceof Date)return new Date(q);if(typeof q=="string"&&!/Z$/i.test(q)){var W=q.match(S);if(W){var ae=W[2]-1||0,me=(W[7]||"0").substring(0,3);return G?new Date(Date.UTC(W[1],ae,W[3]||1,W[4]||0,W[5]||0,W[6]||0,me)):new Date(W[1],ae,W[3]||1,W[4]||0,W[5]||0,W[6]||0,me)}}return new Date(q)}(T),this.init();},D.init=function(){var T=this.$d;this.$y=T.getFullYear(),this.$M=T.getMonth(),this.$D=T.getDate(),this.$W=T.getDay(),this.$H=T.getHours(),this.$m=T.getMinutes(),this.$s=T.getSeconds(),this.$ms=T.getMilliseconds();},D.$utils=function(){return J},D.isValid=function(){return this.$d.toString()!==m},D.isSame=function(T,_){var q=K(T);return this.startOf(_)<=q&&q<=this.endOf(_)},D.isAfter=function(T,_){return K(T)<this.startOf(_)},D.isBefore=function(T,_){return this.endOf(_)<K(T)},D.$g=function(T,_,q){return J.u(T)?this[_]:this.set(q,T)},D.unix=function(){return Math.floor(this.valueOf()/1e3)},D.valueOf=function(){return this.$d.getTime()},D.startOf=function(T,_){var q=this,G=!!J.u(_)||_,W=J.p(T),ae=function(Rt,ve){var rt=J.w(q.$u?Date.UTC(q.$y,ve,Rt):new Date(q.$y,ve,Rt),q);return G?rt:rt.endOf(s)},me=function(Rt,ve){return J.w(q.toDate()[Rt].apply(q.toDate("s"),(G?[0,0,0,0]:[23,59,59,999]).slice(ve)),q)},he=this.$W,be=this.$M,$e=this.$D,Hr="set"+(this.$u?"UTC":"");switch(W){case d:return G?ae(1,0):ae(31,11);case u:return G?ae(1,be):ae(0,be+1);case c:var Lt=this.$locale().weekStart||0,Ar=(he<Lt?he+7:he)-Lt;return ae(G?$e-Ar:$e+(6-Ar),be);case s:case p:return me(Hr+"Hours",0);case i:return me(Hr+"Minutes",1);case a:return me(Hr+"Seconds",2);case o:return me(Hr+"Milliseconds",3);default:return this.clone()}},D.endOf=function(T){return this.startOf(T,!1)},D.$set=function(T,_){var q,G=J.p(T),W="set"+(this.$u?"UTC":""),ae=(q={},q[s]=W+"Date",q[p]=W+"Date",q[u]=W+"Month",q[d]=W+"FullYear",q[i]=W+"Hours",q[a]=W+"Minutes",q[o]=W+"Seconds",q[n]=W+"Milliseconds",q)[G],me=G===s?this.$D+(_-this.$W):_;if(G===u||G===d){var he=this.clone().set(p,1);he.$d[ae](me),he.init(),this.$d=he.set(p,Math.min(this.$D,he.daysInMonth())).$d;}else ae&&this.$d[ae](me);return this.init(),this},D.set=function(T,_){return this.clone().$set(T,_)},D.get=function(T){return this[J.p(T)]()},D.add=function(T,_){var q,G=this;T=Number(T);var W=J.p(_),ae=function(be){var $e=K(G);return J.w($e.date($e.date()+Math.round(be*T)),G)};if(W===u)return this.set(u,this.$M+T);if(W===d)return this.set(d,this.$y+T);if(W===s)return ae(1);if(W===c)return ae(7);var me=(q={},q[a]=t,q[i]=r,q[o]=e,q)[W]||1,he=this.$d.getTime()+T*me;return J.w(he,this)},D.subtract=function(T,_){return this.add(-1*T,_)},D.format=function(T){var _=this,q=this.$locale();if(!this.isValid())return q.invalidDate||m;var G=T||"YYYY-MM-DDTHH:mm:ssZ",W=J.z(this),ae=this.$H,me=this.$m,he=this.$M,be=q.weekdays,$e=q.months,Hr=q.meridiem,Lt=function(ve,rt,Rr,zr){return ve&&(ve[rt]||ve(_,G))||Rr[rt].slice(0,zr)},Ar=function(ve){return J.s(ae%12||12,ve,"0")},Rt=Hr||function(ve,rt,Rr){var zr=ve<12?"AM":"PM";return Rr?zr.toLowerCase():zr};return G.replace(F,function(ve,rt){return rt||function(Rr){switch(Rr){case"YY":return String(_.$y).slice(-2);case"YYYY":return J.s(_.$y,4,"0");case"M":return he+1;case"MM":return J.s(he+1,2,"0");case"MMM":return Lt(q.monthsShort,he,$e,3);case"MMMM":return Lt($e,he);case"D":return _.$D;case"DD":return J.s(_.$D,2,"0");case"d":return String(_.$W);case"dd":return Lt(q.weekdaysMin,_.$W,be,2);case"ddd":return Lt(q.weekdaysShort,_.$W,be,3);case"dddd":return be[_.$W];case"H":return String(ae);case"HH":return J.s(ae,2,"0");case"h":return Ar(1);case"hh":return Ar(2);case"a":return Rt(ae,me,!0);case"A":return Rt(ae,me,!1);case"m":return String(me);case"mm":return J.s(me,2,"0");case"s":return String(_.$s);case"ss":return J.s(_.$s,2,"0");case"SSS":return J.s(_.$ms,3,"0");case"Z":return W}return null}(ve)||W.replace(":","")})},D.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},D.diff=function(T,_,q){var G,W=this,ae=J.p(_),me=K(T),he=(me.utcOffset()-this.utcOffset())*t,be=this-me,$e=function(){return J.m(W,me)};switch(ae){case d:G=$e()/12;break;case u:G=$e();break;case l:G=$e()/3;break;case c:G=(be-he)/6048e5;break;case s:G=(be-he)/864e5;break;case i:G=be/r;break;case a:G=be/t;break;case o:G=be/e;break;default:G=be;}return q?G:J.a(G)},D.daysInMonth=function(){return this.endOf(u).$D},D.$locale=function(){return U[this.$L]},D.locale=function(T,_){if(!T)return this.$L;var q=this.clone(),G=te(T,_,!0);return G&&(q.$L=G),q},D.clone=function(){return J.w(this.$d,this)},D.toDate=function(){return new Date(this.valueOf())},D.toJSON=function(){return this.isValid()?this.toISOString():null},D.toISOString=function(){return this.$d.toISOString()},D.toString=function(){return this.$d.toUTCString()},z}(),At=Te.prototype;return K.prototype=At,[["$ms",n],["$s",o],["$m",a],["$H",i],["$W",s],["$M",u],["$y",d],["$D",p]].forEach(function(z){At[z[1]]=function(D){return this.$g(D,z[0],z[1])};}),K.extend=function(z,D){return z.$i||(z(D,Te,K),z.$i=!0),K},K.locale=te,K.isDayjs=Y,K.unix=function(z){return K(1e3*z)},K.en=U[V],K.Ls=U,K.p={},K});});var Df=fe((Nd,Ld)=>{(function(e,t){typeof Nd=="object"&&typeof Ld<"u"?Ld.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_timezone=t();})(Nd,function(){var e={year:0,month:1,day:2,hour:3,minute:4,second:5},t={};return function(r,n,o){var a,i=function(l,d,p){p===void 0&&(p={});var m=new Date(l),S=function(F,y){y===void 0&&(y={});var A=y.timeZoneName||"short",w=F+"|"+A,V=t[w];return V||(V=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:F,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:A}),t[w]=V),V}(d,p);return S.formatToParts(m)},s=function(l,d){for(var p=i(l,d),m=[],S=0;S<p.length;S+=1){var F=p[S],y=F.type,A=F.value,w=e[y];w>=0&&(m[w]=parseInt(A,10));}var V=m[3],U=V===24?0:V,Z=m[0]+"-"+m[1]+"-"+m[2]+" "+U+":"+m[4]+":"+m[5]+":000",Y=+l;return (o.utc(Z).valueOf()-(Y-=Y%1e3))/6e4},c=n.prototype;c.tz=function(l,d){l===void 0&&(l=a);var p=this.utcOffset(),m=this.toDate(),S=m.toLocaleString("en-US",{timeZone:l}),F=Math.round((m-new Date(S))/1e3/60),y=o(S,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(m.getTimezoneOffset()/15)-F,!0);if(d){var A=y.utcOffset();y=y.add(p-A,"minute");}return y.$x.$timezone=l,y},c.offsetName=function(l){var d=this.$x.$timezone||o.tz.guess(),p=i(this.valueOf(),d,{timeZoneName:l}).find(function(m){return m.type.toLowerCase()==="timezonename"});return p&&p.value};var u=c.startOf;c.startOf=function(l,d){if(!this.$x||!this.$x.$timezone)return u.call(this,l,d);var p=o(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return u.call(p,l,d).tz(this.$x.$timezone,!0)},o.tz=function(l,d,p){var m=p&&d,S=p||d||a,F=s(+o(),S);if(typeof l!="string")return o(l).tz(S);var y=function(U,Z,Y){var te=U-60*Z*1e3,K=s(te,Y);if(Z===K)return [te,Z];var J=s(te-=60*(K-Z)*1e3,Y);return K===J?[te,K]:[U-60*Math.min(K,J)*1e3,Math.max(K,J)]}(o.utc(l,m).valueOf(),F,S),A=y[0],w=y[1],V=o(A).utcOffset(w);return V.$x.$timezone=S,V},o.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},o.tz.setDefault=function(l){a=l;};}});});var Vf=fe((Md,Qd)=>{(function(e,t){typeof Md=="object"&&typeof Qd<"u"?Qd.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_utc=t();})(Md,function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(n,o,a){var i=o.prototype;a.utc=function(m){var S={date:m,utc:!0,args:arguments};return new o(S)},i.utc=function(m){var S=a(this.toDate(),{locale:this.$L,utc:!0});return m?S.add(this.utcOffset(),e):S},i.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var s=i.parse;i.parse=function(m){m.utc&&(this.$u=!0),this.$utils().u(m.$offset)||(this.$offset=m.$offset),s.call(this,m);};var c=i.init;i.init=function(){if(this.$u){var m=this.$d;this.$y=m.getUTCFullYear(),this.$M=m.getUTCMonth(),this.$D=m.getUTCDate(),this.$W=m.getUTCDay(),this.$H=m.getUTCHours(),this.$m=m.getUTCMinutes(),this.$s=m.getUTCSeconds(),this.$ms=m.getUTCMilliseconds();}else c.call(this);};var u=i.utcOffset;i.utcOffset=function(m,S){var F=this.$utils().u;if(F(m))return this.$u?0:F(this.$offset)?u.call(this):this.$offset;if(typeof m=="string"&&(m=function(V){V===void 0&&(V="");var U=V.match(t);if(!U)return null;var Z=(""+U[0]).match(r)||["-",0,0],Y=Z[0],te=60*+Z[1]+ +Z[2];return te===0?0:Y==="+"?te:-te}(m),m===null))return this;var y=Math.abs(m)<=16?60*m:m,A=this;if(S)return A.$offset=y,A.$u=m===0,A;if(m!==0){var w=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(A=this.local().add(y+w,e)).$offset=y,A.$x.$localOffset=w;}else A=this.utc();return A};var l=i.format;i.format=function(m){var S=m||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,S)},i.valueOf=function(){var m=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*m},i.isUTC=function(){return !!this.$u},i.toISOString=function(){return this.toDate().toISOString()},i.toString=function(){return this.toDate().toUTCString()};var d=i.toDate;i.toDate=function(m){return m==="s"&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var p=i.diff;i.diff=function(m,S,F){if(m&&this.$u===m.$u)return p.call(this,m,S,F);var y=this.local(),A=a(m).local();return p.call(y,A,S,F)};}});});var Lf=fe((Uq,Nf)=>{Nf.exports=fetch;});var Mf=fe(Di=>{var zs=Di&&Di.__assign||function(){return zs=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);}return e},zs.apply(this,arguments)};Object.defineProperty(Di,"__esModule",{value:!0});var gA={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return !0},startingDelay:100,timeMultiple:2};function SA(e){var t=zs(zs({},gA),e);return t.numOfAttempts<1&&(t.numOfAttempts=1),t}Di.getSanitizedOptions=SA;});var Qf=fe(Bd=>{Object.defineProperty(Bd,"__esModule",{value:!0});function hA(e){var t=Math.random()*e;return Math.round(t)}Bd.fullJitter=hA;});var Bf=fe(Ud=>{Object.defineProperty(Ud,"__esModule",{value:!0});function yA(e){return e}Ud.noJitter=yA;});var Uf=fe(_d=>{Object.defineProperty(_d,"__esModule",{value:!0});var CA=Qf(),xA=Bf();function FA(e){switch(e.jitter){case"full":return CA.fullJitter;case"none":default:return xA.noJitter}}_d.JitterFactory=FA;});var $d=fe(jd=>{Object.defineProperty(jd,"__esModule",{value:!0});var AA=Uf(),RA=function(){function e(t){this.options=t,this.attempt=0;}return e.prototype.apply=function(){var t=this;return new Promise(function(r){return setTimeout(r,t.jitteredDelay)})},e.prototype.setAttemptNumber=function(t){this.attempt=t;},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){var t=AA.JitterFactory(this.options);return t(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var t=this.options.startingDelay,r=this.options.timeMultiple,n=this.numOfDelayedAttempts,o=t*Math.pow(r,n);return Math.min(o,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}();jd.Delay=RA;});var _f=fe(vr=>{var bA=vr&&vr.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o;}||function(n,o){for(var a in o)o.hasOwnProperty(a)&&(n[a]=o[a]);},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t;}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n);}}(),vA=vr&&vr.__awaiter||function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(i){i(a);})}return new(r||(r=Promise))(function(a,i){function s(l){try{u(n.next(l));}catch(d){i(d);}}function c(l){try{u(n.throw(l));}catch(d){i(d);}}function u(l){l.done?a(l.value):o(l.value).then(s,c);}u((n=n.apply(e,t||[])).next());})},PA=vr&&vr.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,i;return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return c([u,l])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(a=u[0]&2?o.return:u[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,u[1])).done)return a;switch(o=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){r.label=u[1];break}if(u[0]===6&&r.label<a[1]){r.label=a[1],a=u;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(u);break}a[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r);}catch(l){u=[6,l],o=0;}finally{n=a=0;}if(u[0]&5)throw u[1];return {value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(vr,"__esModule",{value:!0});var wA=$d(),EA=function(e){bA(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.apply=function(){return vA(this,void 0,void 0,function(){return PA(this,function(r){return [2,this.isFirstAttempt?!0:e.prototype.apply.call(this)]})})},Object.defineProperty(t.prototype,"isFirstAttempt",{get:function(){return this.attempt===0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),t}(wA.Delay);vr.SkipFirstDelay=EA;});var jf=fe(Vi=>{var IA=Vi&&Vi.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o;}||function(n,o){for(var a in o)o.hasOwnProperty(a)&&(n[a]=o[a]);},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t;}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n);}}();Object.defineProperty(Vi,"__esModule",{value:!0});var kA=$d(),OA=function(e){IA(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(kA.Delay);Vi.AlwaysDelay=OA;});var $f=fe(Hd=>{Object.defineProperty(Hd,"__esModule",{value:!0});var TA=_f(),qA=jf();function DA(e,t){var r=VA(e);return r.setAttemptNumber(t),r}Hd.DelayFactory=DA;function VA(e){return e.delayFirstAttempt?new qA.AlwaysDelay(e):new TA.SkipFirstDelay(e)}});var Hf=fe(_n=>{var zd=_n&&_n.__awaiter||function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(i){i(a);})}return new(r||(r=Promise))(function(a,i){function s(l){try{u(n.next(l));}catch(d){i(d);}}function c(l){try{u(n.throw(l));}catch(d){i(d);}}function u(l){l.done?a(l.value):o(l.value).then(s,c);}u((n=n.apply(e,t||[])).next());})},Gd=_n&&_n.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,i;return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return c([u,l])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(a=u[0]&2?o.return:u[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,u[1])).done)return a;switch(o=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){r.label=u[1];break}if(u[0]===6&&r.label<a[1]){r.label=a[1],a=u;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(u);break}a[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r);}catch(l){u=[6,l],o=0;}finally{n=a=0;}if(u[0]&5)throw u[1];return {value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(_n,"__esModule",{value:!0});var NA=Mf(),LA=$f();function MA(e,t){return t===void 0&&(t={}),zd(this,void 0,void 0,function(){var r,n;return Gd(this,function(o){switch(o.label){case 0:return r=NA.getSanitizedOptions(t),n=new QA(e,r),[4,n.execute()];case 1:return [2,o.sent()]}})})}_n.backOff=MA;var QA=function(){function e(t,r){this.request=t,this.options=r,this.attemptNumber=0;}return e.prototype.execute=function(){return zd(this,void 0,void 0,function(){var t,r;return Gd(this,function(n){switch(n.label){case 0:if(this.attemptLimitReached)return [3,7];n.label=1;case 1:return n.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return n.sent(),[4,this.request()];case 3:return [2,n.sent()];case 4:return t=n.sent(),this.attemptNumber++,[4,this.options.retry(t,this.attemptNumber)];case 5:if(r=n.sent(),!r||this.attemptLimitReached)throw t;return [3,6];case 6:return [3,0];case 7:throw new Error("Something went wrong.")}})})},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return zd(this,void 0,void 0,function(){var t;return Gd(this,function(r){switch(r.label){case 0:return t=LA.DelayFactory(this.options,this.attemptNumber),[4,t.apply()];case 1:return r.sent(),[2]}})})},e}();});var Gf=fe((Xq,zf)=>{function BA(e){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");if(e=`${e}`,e=e.replace(/[ \t\n\f\r]/g,""),e.length%4===0&&(e=e.replace(/==?$/,"")),e.length%4===1||/[^+/0-9A-Za-z]/.test(e))return null;let t="",r=0,n=0;for(let o=0;o<e.length;o++)r<<=6,r|=_A(e[o]),n+=6,n===24&&(t+=String.fromCharCode((r&16711680)>>16),t+=String.fromCharCode((r&65280)>>8),t+=String.fromCharCode(r&255),r=n=0);return n===12?(r>>=4,t+=String.fromCharCode(r)):n===18&&(r>>=2,t+=String.fromCharCode((r&65280)>>8),t+=String.fromCharCode(r&255)),t}var UA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function _A(e){let t=UA.indexOf(e);return t<0?void 0:t}zf.exports=BA;});var Yf=fe((Zq,Wf)=>{function jA(e){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");let t;for(e=`${e}`,t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return null;let r="";for(t=0;t<e.length;t+=3){let n=[void 0,void 0,void 0,void 0];n[0]=e.charCodeAt(t)>>2,n[1]=(e.charCodeAt(t)&3)<<4,e.length>t+1&&(n[1]|=e.charCodeAt(t+1)>>4,n[2]=(e.charCodeAt(t+1)&15)<<2),e.length>t+2&&(n[2]|=e.charCodeAt(t+2)>>6,n[3]=e.charCodeAt(t+2)&63);for(let o=0;o<n.length;o++)typeof n[o]>"u"?r+="=":r+=HA(n[o]);}return r}var $A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function HA(e){if(e>=0&&e<64)return $A[e]}Wf.exports=jA;});var Wd=fe((eD,Kf)=>{var zA=Gf(),GA=Yf();Kf.exports={atob:zA,btoa:GA};});var eS=fe((eL,Zg)=>{var Rp=typeof self<"u"?self:typeof window<"u"?window:void 0;if(!Rp)throw new Error("Unable to find global scope. Are you sure this is running in the browser?");if(!Rp.AbortController)throw new Error('Could not find "AbortController" in the global scope. You need to polyfill it first');Zg.exports.AbortController=Rp.AbortController;});var gh=fe((nm,om)=>{(function(e,t){typeof nm=="object"&&typeof om<"u"?om.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_quarterOfYear=t();})(nm,function(){var e="month",t="quarter";return function(r,n){var o=n.prototype;o.quarter=function(s){return this.$utils().u(s)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(s-1))};var a=o.add;o.add=function(s,c){return s=Number(s),this.$utils().p(c)===t?this.add(3*s,e):a.bind(this)(s,c)};var i=o.startOf;o.startOf=function(s,c){var u=this.$utils(),l=!!u.u(c)||c;if(u.p(s)===t){var d=this.quarter()-1;return l?this.month(3*d).startOf(e).startOf("day"):this.month(3*d+2).endOf(e).endOf("day")}return i.bind(this)(s,c)};}});});var Sh=fe((am,im)=>{(function(e,t){typeof am=="object"&&typeof im<"u"?im.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_customParseFormat=t();})(am,function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,n=/\d\d?/,o=/\d*[^-_:/,()\s\d]+/,a={},i=function(m){return (m=+m)+(m>68?1900:2e3)},s=function(m){return function(S){this[m]=+S;}},c=[/[+-]\d\d:?(\d\d)?|Z/,function(m){(this.zone||(this.zone={})).offset=function(S){if(!S||S==="Z")return 0;var F=S.match(/([+-]|\d\d)/g),y=60*F[1]+(+F[2]||0);return y===0?0:F[0]==="+"?-y:y}(m);}],u=function(m){var S=a[m];return S&&(S.indexOf?S:S.s.concat(S.f))},l=function(m,S){var F,y=a.meridiem;if(y){for(var A=1;A<=24;A+=1)if(m.indexOf(y(A,0,S))>-1){F=A>12;break}}else F=m===(S?"pm":"PM");return F},d={A:[o,function(m){this.afternoon=l(m,!1);}],a:[o,function(m){this.afternoon=l(m,!0);}],S:[/\d/,function(m){this.milliseconds=100*+m;}],SS:[r,function(m){this.milliseconds=10*+m;}],SSS:[/\d{3}/,function(m){this.milliseconds=+m;}],s:[n,s("seconds")],ss:[n,s("seconds")],m:[n,s("minutes")],mm:[n,s("minutes")],H:[n,s("hours")],h:[n,s("hours")],HH:[n,s("hours")],hh:[n,s("hours")],D:[n,s("day")],DD:[r,s("day")],Do:[o,function(m){var S=a.ordinal,F=m.match(/\d+/);if(this.day=F[0],S)for(var y=1;y<=31;y+=1)S(y).replace(/\[|\]/g,"")===m&&(this.day=y);}],M:[n,s("month")],MM:[r,s("month")],MMM:[o,function(m){var S=u("months"),F=(u("monthsShort")||S.map(function(y){return y.slice(0,3)})).indexOf(m)+1;if(F<1)throw new Error;this.month=F%12||F;}],MMMM:[o,function(m){var S=u("months").indexOf(m)+1;if(S<1)throw new Error;this.month=S%12||S;}],Y:[/[+-]?\d+/,s("year")],YY:[r,function(m){this.year=i(m);}],YYYY:[/\d{4}/,s("year")],Z:c,ZZ:c};function p(m){var S,F;S=m,F=a&&a.formats;for(var y=(m=S.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(te,K,J){var Te=J&&J.toUpperCase();return K||F[J]||e[J]||F[Te].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(At,z,D){return z||D.slice(1)})})).match(t),A=y.length,w=0;w<A;w+=1){var V=y[w],U=d[V],Z=U&&U[0],Y=U&&U[1];y[w]=Y?{regex:Z,parser:Y}:V.replace(/^\[|\]$/g,"");}return function(te){for(var K={},J=0,Te=0;J<A;J+=1){var At=y[J];if(typeof At=="string")Te+=At.length;else {var z=At.regex,D=At.parser,T=te.slice(Te),_=z.exec(T)[0];D.call(K,_),te=te.replace(_,"");}}return function(q){var G=q.afternoon;if(G!==void 0){var W=q.hours;G?W<12&&(q.hours+=12):W===12&&(q.hours=0),delete q.afternoon;}}(K),K}}return function(m,S,F){F.p.customParseFormat=!0,m&&m.parseTwoDigitYear&&(i=m.parseTwoDigitYear);var y=S.prototype,A=y.parse;y.parse=function(w){var V=w.date,U=w.utc,Z=w.args;this.$u=U;var Y=Z[1];if(typeof Y=="string"){var te=Z[2]===!0,K=Z[3]===!0,J=te||K,Te=Z[2];K&&(Te=Z[2]),a=this.$locale(),!te&&Te&&(a=F.Ls[Te]),this.$d=function(T,_,q){try{if(["x","X"].indexOf(_)>-1)return new Date((_==="X"?1e3:1)*T);var G=p(_)(T),W=G.year,ae=G.month,me=G.day,he=G.hours,be=G.minutes,$e=G.seconds,Hr=G.milliseconds,Lt=G.zone,Ar=new Date,Rt=me||(W||ae?1:Ar.getDate()),ve=W||Ar.getFullYear(),rt=0;W&&!ae||(rt=ae>0?ae-1:Ar.getMonth());var Rr=he||0,zr=be||0,wd=$e||0,Ed=Hr||0;return Lt?new Date(Date.UTC(ve,rt,Rt,Rr,zr,wd,Ed+60*Lt.offset*1e3)):q?new Date(Date.UTC(ve,rt,Rt,Rr,zr,wd,Ed)):new Date(ve,rt,Rt,Rr,zr,wd,Ed)}catch{return new Date("")}}(V,Y,U),this.init(),Te&&Te!==!0&&(this.$L=this.locale(Te).$L),J&&V!=this.format(Y)&&(this.$d=new Date("")),a={};}else if(Y instanceof Array)for(var At=Y.length,z=1;z<=At;z+=1){Z[1]=Y[z-1];var D=F.apply(this,Z);if(D.isValid()){this.$d=D.$d,this.$L=D.$L,this.init();break}z===At&&(this.$d=new Date(""));}else A.call(this,w);};}});});var jh=fe((W_,_h)=>{var sw=/(^|; )Coveo-Pendragon=([^;]*)/;_h.exports=()=>sw.exec(document.cookie)?.pop()||null;});var Ii=()=>global.crypto,Ff=()=>{typeof window<"u"||(Ii()||(global.crypto=UF("crypto")),!Ii().getRandomValues&&Ii().webcrypto&&(global.crypto.getRandomValues=Ii().webcrypto.getRandomValues.bind(Ii().webcrypto)));};He(qd());var If=()=>({referrer:document.referrer,userAgent:navigator.userAgent,location:window.location.href}),js=()=>({referrer:"default",userAgent:"Node.js",location:"default"});var sA="coveo-headless-internal-state",Ti=Symbol.for(sA);var dA=10,$s=e=>({past:[],present:e,future:[]}),pA=e=>{let{past:t,present:r,future:n}=e;if(!r||t.length===0)return e;let o=t[t.length-1];return {past:t.slice(0,t.length-1),present:o,future:[r,...n]}},mA=e=>{let{past:t,present:r,future:n}=e;if(!r||n.length===0)return e;let o=n[0],a=n.slice(1);return {past:[...t,r],present:o,future:a}},fA=e=>{let{action:t,state:r,reducer:n}=e,{past:o,present:a}=r,i=n(a,t);return a?a===i?r:{past:[...o,a].slice(-dA),present:i,future:[]}:$s(i)},qf=e=>{let{actionTypes:t,reducer:r}=e,n=$s();return (o=n,a)=>{switch(a.type){case t.undo:return pA(o);case t.redo:return mA(o);case t.snapshot:return fA({state:o,reducer:r,action:a});default:return o}}};var nt=()=>({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,lq:"",lqWasSet:!1,dq:"",dqWasSet:!1,defaultFilters:{cq:"",aq:"",lq:"",dq:""}});var Xs=He(Hs()),sg=He(Df()),cg=He(Vf());var og=He(Lf()),ag=He(Hf());var xo=class extends Error{constructor(){super(),this.name="ExpiredToken",this.message="The token being used to perform the request is expired.";}},jn=class extends Error{constructor(t,r){super(),this.name="Disconnected",this.message=`Client could not connect to the following URL: ${t}`,this.statusCode=r??0;}};var Jf=He(Wd()),Gr=(e,t=5)=>e+Math.random().toString(36).substring(2,2+t);function Gs(e){return Array.isArray(e)}function Ws(e){return e.trim()===""}function Xf(e,t){return [...e.reduce((r,n)=>{let o=t(n);return r.has(o)||r.set(o,n),r},new Map).values()]}function WA(e){return (typeof btoa<"u"?btoa:Jf.btoa)(encodeURI(e))}function Ys(e,t){let{[e]:r,...n}=t;return n}function Fo(e){return WA(JSON.stringify(e))}var YA=new Set(["1",1,"yes",!0]);function Ks(){if(typeof navigator>"u"||typeof window>"u")return !1;let e=navigator,t=window;return [e.globalPrivacyControl,e.doNotTrack,e.msDoNotTrack,t.doNotTrack].some(r=>YA.has(r))}function Zf(e){let t={};for(let[r,n]of e)t[r]=n;return t}function eg(e,t,r){return clearTimeout(t),setTimeout(e,r)}function Ni(e){if(typeof e!="object"||!e)return e;try{return JSON.parse(JSON.stringify(e))}catch{return e}}function tg(e){let t=[];for(let r in e){let n=encodeURIComponent(r),o=encodeURIComponent(e[r]);t.push(`${n}=${o}`);}return t.join("&")}function rg(e){return typeof e!="object"||!e?!1:Object.values(e).every(KA)}function KA(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function ng(e){return e===429}var ot=class e{static async call(t){let r=JA(t),{logger:n}=t,o=await e.preprocessRequest(r,t);n.info(o,"Platform request");let{url:a,...i}=o,s=async()=>{let c=await(0, og.default)(a,i);if(ng(c.status))throw c;return c};try{let c=await(0, ag.backOff)(s,{retry:u=>{let l=u&&ng(u.status);return l&&n.info("Platform retrying request"),l}});if(c.status===419)throw n.info("Platform renewing token"),new xo;if(c.status===404)throw new jn(a,c.status);return n.info({response:c,requestInfo:o},"Platform response"),c}catch(c){return c.message==="Failed to fetch"?new jn(a):c}}static async preprocessRequest(t,r){let{origin:n,preprocessRequest:o,logger:a,requestMetadata:i}=r,{signal:s,...c}=t,u=Ni(c);try{let l=await o(t,n,i);return {...t,...l}}catch(l){a.error(l,"Platform request preprocessing failed. Returning default request options.");}return u}};function ig(e,t){let r=!t||!t.environment||t.environment==="prod"?"":t.environment,n=!t||!t.region||t.region==="us"?"":`-${t.region}`;return `https://${e}${r}${n}.cloud.coveo.com`}function Li(e,t="prod"){let r=t==="prod"?"":t,n=`https://${e}.org${r}.coveo.com`,o=`https://${e}.analytics.org${r}.coveo.com`,a=`${n}/rest/search/v2`,i=`https://${e}.admin.org${r}.coveo.com`;return {platform:n,analytics:o,search:a,admin:i}}function Js(e){return e?.multiRegionSubDomain?`https://${e.multiRegionSubDomain}.org.coveo.com`:ig("platform",e)}function Yd(e){return ig("analytics",e)}function JA(e){let{url:t,method:r,requestParams:n,contentType:o,accessToken:a,signal:i}=e,s=e.method==="POST"||e.method==="PUT",c=XA(n,o);return {url:t,method:r,headers:{"Content-Type":o,Authorization:`Bearer ${a}`,...e.headers},...s&&{body:c},signal:i}}function XA(e,t){return t==="application/x-www-form-urlencoded"?rg(e)?tg(e):"":JSON.stringify(e)}Xs.default.extend(cg.default);Xs.default.extend(sg.default);var Kd="/rest/search/v2",Jd="/rest/ua",Wr=()=>({organizationId:"",accessToken:"",platformUrl:Js(),search:{apiBaseUrl:`${Js()}${Kd}`,locale:"en-US",timezone:Xs.default.tz.guess(),authenticationProviders:[]},analytics:{enabled:!0,apiBaseUrl:`${Yd()}${Jd}`,nextApiBaseUrl:"",originContext:"Search",originLevel2:"default",originLevel3:"default",anonymous:!1,deviceId:"",userDisplayName:"",documentLocation:"",trackingId:"",analyticsMode:"legacy",source:{}}});function Ao(){return {contextValues:{}}}var Mt=()=>!1;function Ro(){return {contextValues:{}}}var Zs=()=>({correctedQuery:"",wordCorrections:[],originalQuery:""}),ug=()=>({correctedQuery:"",corrections:[],originalQuery:""});function ec(){return {enableDidYouMean:!1,wasCorrectedTo:"",wasAutomaticallyCorrected:!1,queryCorrection:Zs(),originalQuery:"",automaticallyCorrectQuery:!0,queryCorrectionMode:"legacy"}}function tc(){return {length:void 0}}function bo(){return {enabled:!0}}function vo(){return {freezeFacetOrder:!1,facets:{}}}function Yr(){return {desiredCount:5,numberOfValues:8,set:{}}}function Kr(){return {}}function Po(){return []}function rc(){return {}}function nc(){return {}}function lg(e){return {request:e,hasBreadcrumbs:!0}}function Jr(){return {}}function dg(e){return {request:e}}function Xr(){return {}}function pg(e){return {request:e}}function Zr(){return {}}var ep=["author","language","urihash","objecttype","collection","source","permanentid"],mg=[...ep,"date","filetype","parents"],ZA=[...mg,"ec_price","ec_name","ec_description","ec_brand","ec_category","ec_item_group_id","ec_shortdesc","ec_thumbnails","ec_images","ec_promo_price","ec_in_stock","ec_rating"],oc=()=>({fieldsToInclude:ep,fetchAllFields:!1,fieldsDescription:[]});var wo=()=>({enabled:!1,fields:{collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"},filterFieldRange:2,collections:{}});function Mi(){return {id:"",isVisible:!0,isLoading:!1,isStreaming:!1,citations:[],liked:!1,disliked:!1,responseFormat:{answerStyle:"default",contentFormat:["text/plain"]},feedbackModalOpen:!1,feedbackSubmitted:!1,fieldsToIncludeInCitations:[],isAnswerGenerated:!1,expanded:!1}}function ze(){return {firstResult:0,defaultNumberOfResults:10,numberOfResults:10,totalCountFiltered:0}}var Qt=()=>"";function Eo(){return {}}var ge=()=>({q:"",enableQuerySyntax:!1});var pt=()=>"default";function eR(e,t){let r=`
  The following properties are invalid:

    ${e.join(`
	`)}
  
  ${t}
  `;return new $n(r)}var $n=class extends Error{constructor(e){super(e),this.name="SchemaValidationError";}},$=class{constructor(e){this.definition=e;}validate(e={},t=""){let r={...this.default,...e},n=[];for(let o in this.definition){let a=this.definition[o].validate(r[o]);a&&n.push(`${o}: ${a}`);}if(n.length)throw eR(n,t);return r}get default(){let e={};for(let t in this.definition){let r=this.definition[t].default;r!==void 0&&(e[t]=r);}return e}},se=class{constructor(e={}){this.baseConfig=e;}validate(e){return this.baseConfig.required&&M(e)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return this.baseConfig.required===!0}};function ye(e){return e===void 0}function tR(e){return e===null}function M(e){return ye(e)||tR(e)}var I=class{constructor(e={}){this.config=e,this.value=new se(e);}validate(e){let t=this.value.validate(e);return t||(rR(e)?e<this.config.min?`minimum value of ${this.config.min} not respected.`:e>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}};function rR(e){return ye(e)||fg(e)}function fg(e){return typeof e=="number"&&!isNaN(e)}var Q=class{constructor(e={}){this.value=new se(e);}validate(e){let t=this.value.validate(e);return t||(nR(e)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}};function nR(e){return ye(e)||ac(e)}function ac(e){return typeof e=="boolean"}var oR=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i,x=class{constructor(e={}){this.config={emptyAllowed:!0,url:!1,...e},this.value=new se(this.config);}validate(e){let{emptyAllowed:t,url:r,regex:n,constrainTo:o}=this.config,a=this.value.validate(e);return a||(ye(e)?null:Io(e)?!t&&!e.length?"value is an empty string.":r&&!oR.test(e)?"value is not a valid URL.":n&&!n.test(e)?`value did not match provided regex ${n}`:o&&!o.includes(e)?`value should be one of: ${o.join(", ")}.`:null:"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}};function Io(e){return Object.prototype.toString.call(e)==="[object String]"}var E=class{constructor(e={}){this.config={options:{required:!1},values:{},...e};}validate(e){if(ye(e))return this.config.options.required?"value is required and is currently undefined":null;if(!gg(e))return "value is not an object";for(let[r,n]of Object.entries(this.config.values))if(n.required&&M(e[r]))return `value does not contain ${r}`;let t="";for(let[r,n]of Object.entries(this.config.values)){let o=e[r],a=n.validate(o);a!==null&&(t+=" "+a);}return t===""?null:t}get default(){}get required(){return !!this.config.options.required}};function gg(e){return e!==void 0&&typeof e=="object"}var B=class{constructor(e={}){this.config=e,this.value=new se(this.config);}validate(e){if(!M(e)&&!Array.isArray(e))return "value is not an array";let t=this.value.validate(e);if(t!==null)return t;if(M(e))return null;if(this.config.max!==void 0&&e.length>this.config.max)return `value contains more than ${this.config.max}`;if(this.config.min!==void 0&&e.length<this.config.min)return `value contains less than ${this.config.min}`;if(this.config.each!==void 0){let r="";return e.forEach(n=>{this.config.each.required&&M(n)&&(r=`value is null or undefined: ${e.join(",")}`);let o=this.validatePrimitiveValue(n,this.config.each);o!==null&&(r+=" "+o);}),r===""?null:r}return null}validatePrimitiveValue(e,t){return ac(e)||Io(e)||fg(e)||gg(e)?t.validate(e):"value is not a primitive value"}get default(){}get required(){return this.value.required}};function ko(e){return Array.isArray(e)}var bt=class{constructor(e){this.config=e,this.value=new se(e);}validate(e){let t=this.value.validate(e);return t!==null?t:ye(e)||Object.values(this.config.enum).find(n=>n===e)?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}};var ic=(r=>(r.Ascending="ascending",r.Descending="descending",r))(ic||{}),Oo=(a=>(a.Relevancy="relevancy",a.QRE="qre",a.Date="date",a.Field="field",a.NoSort="nosort",a))(Oo||{}),Pr=e=>{if(ko(e))return e.map(t=>Pr(t)).join(",");switch(e.by){case"relevancy":case"qre":case"nosort":return e.by;case"date":return `date ${e.order}`;case"field":return `@${e.field} ${e.order}`;default:return ""}},Qi=()=>({by:"relevancy"}),tp=e=>({by:"date",order:e}),rp=(e,t)=>({by:"field",order:t,field:e}),np=()=>({by:"qre"}),op=()=>({by:"nosort"}),Sg=new E({values:{by:new bt({enum:Oo,required:!0}),order:new bt({enum:ic}),field:new x}});function Ge(){return Pr(Qi())}function To(){return {}}function qo(){return {}}function sc(){return vt({})}function vt(e){return {context:e.context||Ao(),dictionaryFieldContext:e.dictionaryFieldContext||Ro(),facetSet:e.facetSet||Jr(),numericFacetSet:e.numericFacetSet||Zr(),dateFacetSet:e.dateFacetSet||Xr(),categoryFacetSet:e.categoryFacetSet||Kr(),automaticFacetSet:e.automaticFacetSet??Yr(),pagination:e.pagination||ze(),query:e.query||ge(),tabSet:e.tabSet||qo(),advancedSearchQueries:e.advancedSearchQueries||nt(),staticFilterSet:e.staticFilterSet||To(),querySet:e.querySet||Eo(),sortCriteria:e.sortCriteria||Ge(),pipeline:e.pipeline||Qt(),searchHub:e.searchHub||pt(),facetOptions:e.facetOptions||vo(),facetOrder:e.facetOrder??Po(),debug:e.debug??Mt()}}function cc(){return {}}var Bi=()=>({liked:!1,disliked:!1,expanded:!1,feedbackModalOpen:!1,relatedQuestions:[]});function uc(){return {queries:[],maxLength:10}}function lc(){return {results:[],maxLength:10}}function Ui(){return {uniqueId:"",content:"",isLoading:!1,position:-1,resultsWithPreview:[]}}function Do(){return {answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}}function je(){return {response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:Do(),pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],searchResponseId:"",requestId:"",questionAnswer:Do(),extendedResults:{}}}function dc(){return {}}var pc=()=>({redirectTo:"",query:"",executions:[],notifications:[],queryModification:{originalQuery:"",newQuery:"",queryToIgnore:""}});var yg={};_F(yg,{escape:()=>Vo,getHighlightedSuggestion:()=>ip,highlightString:()=>aR});function aR(e){if(Ws(e.openingDelimiter)||Ws(e.closingDelimiter))throw Error("delimiters should be a non-empty string");if(M(e.content)||Ws(e.content))return e.content;if(e.highlights.length===0)return Vo(e.content);let t=e.content.length,r="",n=0;for(let o=0;o<e.highlights.length;o++){let a=e.highlights[o],i=a.offset,s=i+a.length;if(s>t)break;r+=Vo(e.content.slice(n,i)),r+=e.openingDelimiter,r+=Vo(e.content.slice(i,s)),r+=e.closingDelimiter,n=s;}return n!==t&&(r+=Vo(e.content.slice(n))),r}function ip(e,t){return e=Vo(e),e.replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,(r,n,o,a)=>n?ap(n,t.notMatchDelimiters):o?ap(o,t.exactMatchDelimiters):a?ap(a,t.correctionDelimiters):r)}function ap(e,t){return t?t.open+e+t.close:e}function Vo(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r="(?:"+Object.keys(t).join("|")+")",n=RegExp(r),o=RegExp(r,"g");return n.test(e)?e.replace(o,a=>t[a]):e}function qe(e){return `Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var iR=typeof Symbol=="function"&&Symbol.observable||"@@observable",Cg=iR,sp=()=>Math.random().toString(36).substring(7).split("").join("."),sR={INIT:`@@redux/INIT${sp()}`,REPLACE:`@@redux/REPLACE${sp()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${sp()}`},mc=sR;function fc(e){if(typeof e!="object"||e===null)return !1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function cp(e,t,r){if(typeof e!="function")throw new Error(qe(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(qe(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(qe(1));return r(cp)(e,t)}let n=e,o=t,a=new Map,i=a,s=0,c=!1;function u(){i===a&&(i=new Map,a.forEach((y,A)=>{i.set(A,y);}));}function l(){if(c)throw new Error(qe(3));return o}function d(y){if(typeof y!="function")throw new Error(qe(4));if(c)throw new Error(qe(5));let A=!0;u();let w=s++;return i.set(w,y),function(){if(A){if(c)throw new Error(qe(6));A=!1,u(),i.delete(w),a=null;}}}function p(y){if(!fc(y))throw new Error(qe(7));if(typeof y.type>"u")throw new Error(qe(8));if(typeof y.type!="string")throw new Error(qe(17));if(c)throw new Error(qe(9));try{c=!0,o=n(o,y);}finally{c=!1;}return (a=i).forEach(w=>{w();}),y}function m(y){if(typeof y!="function")throw new Error(qe(10));n=y,p({type:mc.REPLACE});}function S(){let y=d;return {subscribe(A){if(typeof A!="object"||A===null)throw new Error(qe(11));function w(){let U=A;U.next&&U.next(l());}return w(),{unsubscribe:y(w)}},[Cg](){return this}}}return p({type:mc.INIT}),{dispatch:p,subscribe:d,getState:l,replaceReducer:m,[Cg]:S}}function cR(e){Object.keys(e).forEach(t=>{let r=e[t];if(typeof r(void 0,{type:mc.INIT})>"u")throw new Error(qe(12));if(typeof r(void 0,{type:mc.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(qe(13))});}function gc(e){let t=Object.keys(e),r={};for(let i=0;i<t.length;i++){let s=t[i];typeof e[s]=="function"&&(r[s]=e[s]);}let n=Object.keys(r),a;try{cR(r);}catch(i){a=i;}return function(s={},c){if(a)throw a;let u=!1,l={};for(let d=0;d<n.length;d++){let p=n[d],m=r[p],S=s[p],F=m(S,c);if(typeof F>"u"){throw new Error(qe(14))}l[p]=F,u=u||F!==S;}return u=u||n.length!==Object.keys(s).length,u?l:s}}function No(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function xg(...e){return t=>(r,n)=>{let o=t(r,n),a=()=>{throw new Error(qe(15))},i={getState:o.getState,dispatch:(c,...u)=>a(c,...u)},s=e.map(c=>c(i));return a=No(...s)(o.dispatch),{...o,dispatch:a}}}function Fg(e){return fc(e)&&"type"in e&&typeof e.type=="string"}var wg=Symbol.for("immer-nothing"),Ag=Symbol.for("immer-draftable"),at=Symbol.for("immer-state");function Pt(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Lo=Object.getPrototypeOf;function Bt(e){return !!e&&!!e[at]}function wt(e){return e?Eg(e)||Array.isArray(e)||!!e[Ag]||!!e.constructor?.[Ag]||Cc(e)||xc(e):!1}var uR=Object.prototype.constructor.toString();function Eg(e){if(!e||typeof e!="object")return !1;let t=Lo(e);if(t===null)return !0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===uR}function _i(e,t){yc(e)===0?Object.entries(e).forEach(([r,n])=>{t(r,n,e);}):e.forEach((r,n)=>t(n,r,e));}function yc(e){let t=e[at];return t?t.type_:Array.isArray(e)?1:Cc(e)?2:xc(e)?3:0}function dp(e,t){return yc(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Ig(e,t,r){let n=yc(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r;}function lR(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Cc(e){return e instanceof Map}function xc(e){return e instanceof Set}function Hn(e){return e.copy_||e.base_}function pp(e,t){if(Cc(e))return new Map(e);if(xc(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&Eg(e))return Lo(e)?{...e}:Object.assign(Object.create(null),e);let r=Object.getOwnPropertyDescriptors(e);delete r[at];let n=Reflect.ownKeys(r);for(let o=0;o<n.length;o++){let a=n[o],i=r[a];i.writable===!1&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(r[a]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[a]});}return Object.create(Lo(e),r)}function hp(e,t=!1){return Fc(e)||Bt(e)||!wt(e)||(yc(e)>1&&(e.set=e.add=e.clear=e.delete=dR),Object.freeze(e),t&&_i(e,(r,n)=>hp(n,!0))),e}function dR(){Pt(2);}function Fc(e){return Object.isFrozen(e)}var pR={};function zn(e){let t=pR[e];return t||Pt(0,e),t}var ji;function kg(){return ji}function mR(e,t){return {drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Rg(e,t){t&&(zn("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t);}function mp(e){fp(e),e.drafts_.forEach(fR),e.drafts_=null;}function fp(e){e===ji&&(ji=e.parent_);}function bg(e){return ji=mR(ji,e)}function fR(e){let t=e[at];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0;}function vg(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[at].modified_&&(mp(t),Pt(4)),wt(e)&&(e=Sc(t,e),t.parent_||hc(t,e)),t.patches_&&zn("Patches").generateReplacementPatches_(r[at].base_,e,t.patches_,t.inversePatches_)):e=Sc(t,r,[]),mp(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==wg?e:void 0}function Sc(e,t,r){if(Fc(t))return t;let n=t[at];if(!n)return _i(t,(o,a)=>Pg(e,n,t,o,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return hc(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let o=n.copy_,a=o,i=!1;n.type_===3&&(a=new Set(o),o.clear(),i=!0),_i(a,(s,c)=>Pg(e,n,o,s,c,r,i)),hc(e,o,!1),r&&e.patches_&&zn("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_);}return n.copy_}function Pg(e,t,r,n,o,a,i){if(Bt(o)){let s=a&&t&&t.type_!==3&&!dp(t.assigned_,n)?a.concat(n):void 0,c=Sc(e,o,s);if(Ig(r,n,c),Bt(c))e.canAutoFreeze_=!1;else return}else i&&r.add(o);if(wt(o)&&!Fc(o)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Sc(e,o),(!t||!t.scope_.parent_)&&hc(e,o);}}function hc(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&hp(t,r);}function gR(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:kg(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},o=n,a=yp;r&&(o=[n],a=$i);let{revoke:i,proxy:s}=Proxy.revocable(o,a);return n.draft_=s,n.revoke_=i,s}var yp={get(e,t){if(t===at)return e;let r=Hn(e);if(!dp(r,t))return SR(e,r,t);let n=r[t];return e.finalized_||!wt(n)?n:n===up(e.base_,t)?(lp(e),e.copy_[t]=Sp(n,e)):n},has(e,t){return t in Hn(e)},ownKeys(e){return Reflect.ownKeys(Hn(e))},set(e,t,r){let n=Og(Hn(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let o=up(Hn(e),t),a=o?.[at];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(lR(r,o)&&(r!==void 0||dp(e.base_,t)))return !0;lp(e),gp(e);}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return up(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,lp(e),gp(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=Hn(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Pt(11);},getPrototypeOf(e){return Lo(e.base_)},setPrototypeOf(){Pt(12);}},$i={};_i(yp,(e,t)=>{$i[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)};});$i.deleteProperty=function(e,t){return $i.set.call(this,e,t,void 0)};$i.set=function(e,t,r){return yp.set.call(this,e[0],t,r,e[0])};function up(e,t){let r=e[at];return (r?Hn(r):e)[t]}function SR(e,t,r){let n=Og(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function Og(e,t){if(!(t in e))return;let r=Lo(e);for(;r;){let n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Lo(r);}}function gp(e){e.modified_||(e.modified_=!0,e.parent_&&gp(e.parent_));}function lp(e){e.copy_||(e.copy_=pp(e.base_,e.scope_.immer_.useStrictShallowCopy_));}var hR=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){let a=r;r=t;let i=this;return function(c=a,...u){return i.produce(c,l=>r.call(this,l,...u))}}typeof r!="function"&&Pt(6),n!==void 0&&typeof n!="function"&&Pt(7);let o;if(wt(t)){let a=bg(this),i=Sp(t,void 0),s=!0;try{o=r(i),s=!1;}finally{s?mp(a):fp(a);}return Rg(a,n),vg(o,a)}else if(!t||typeof t!="object"){if(o=r(t),o===void 0&&(o=t),o===wg&&(o=void 0),this.autoFreeze_&&hp(o,!0),n){let a=[],i=[];zn("Patches").generateReplacementPatches_(t,o,a,i),n(a,i);}return o}else Pt(1,t);},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return (i,...s)=>this.produceWithPatches(i,c=>t(c,...s));let n,o;return [this.produce(t,r,(i,s)=>{n=i,o=s;}),n,o]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy);}createDraft(e){wt(e)||Pt(8),Bt(e)&&(e=Cp(e));let t=bg(this),r=Sp(e,void 0);return r[at].isManual_=!0,fp(t),r}finishDraft(e,t){let r=e&&e[at];(!r||!r.isManual_)&&Pt(9);let{scope_:n}=r;return Rg(n,t),vg(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e;}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e;}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let o=t[r];if(o.path.length===0&&o.op==="replace"){e=o.value;break}}r>-1&&(t=t.slice(r+1));let n=zn("Patches").applyPatches_;return Bt(e)?n(e,t):this.produce(e,o=>n(o,t))}};function Sp(e,t){let r=Cc(e)?zn("MapSet").proxyMap_(e,t):xc(e)?zn("MapSet").proxySet_(e,t):gR(e,t);return (t?t.scope_:kg()).drafts_.push(r),r}function Cp(e){return Bt(e)||Pt(10,e),Tg(e)}function Tg(e){if(!wt(e)||Fc(e))return e;let t=e[at],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=pp(e,t.scope_.immer_.useStrictShallowCopy_);}else r=pp(e,!0);return _i(r,(n,o)=>{Ig(r,n,Tg(o));}),t&&(t.finalized_=!1),r}var it=new hR,Ac=it.produce;it.produceWithPatches.bind(it);it.setAutoFreeze.bind(it);it.setUseStrictShallowCopy.bind(it);it.applyPatches.bind(it);it.createDraft.bind(it);it.finishDraft.bind(it);function yR(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function CR(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function xR(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){let r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var qg=e=>Array.isArray(e)?e:[e];function FR(e){let t=Array.isArray(e[0])?e[0]:e;return xR(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function AR(e,t){let r=[],{length:n}=e;for(let o=0;o<n;o++)r.push(e[o].apply(null,t));return r}var RR=class{constructor(e){this.value=e;}deref(){return this.value}},bR=typeof WeakRef<"u"?WeakRef:RR,vR=0,Dg=1;function Rc(){return {s:vR,v:void 0,o:null,p:null}}function Hi(e,t={}){let r=Rc(),{resultEqualityCheck:n}=t,o,a=0;function i(){let s=r,{length:c}=arguments;for(let d=0,p=c;d<p;d++){let m=arguments[d];if(typeof m=="function"||typeof m=="object"&&m!==null){let S=s.o;S===null&&(s.o=S=new WeakMap);let F=S.get(m);F===void 0?(s=Rc(),S.set(m,s)):s=F;}else {let S=s.p;S===null&&(s.p=S=new Map);let F=S.get(m);F===void 0?(s=Rc(),S.set(m,s)):s=F;}}let u=s,l;if(s.s===Dg?l=s.v:(l=e.apply(null,arguments),a++),u.s=Dg,n){let d=o?.deref?.()??o;d!=null&&n(d,l)&&(l=d,a!==0&&a--),o=typeof l=="object"&&l!==null||typeof l=="function"?new bR(l):l;}return u.v=l,l}return i.clearCache=()=>{r=Rc(),i.resetResultsCount();},i.resultsCount=()=>a,i.resetResultsCount=()=>{a=0;},i}function bc(e,...t){let r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...o)=>{let a=0,i=0,s,c={},u=o.pop();typeof u=="object"&&(c=u,u=o.pop()),yR(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);let l={...r,...c},{memoize:d,memoizeOptions:p=[],argsMemoize:m=Hi,argsMemoizeOptions:S=[],devModeChecks:F={}}=l,y=qg(p),A=qg(S),w=FR(o),V=d(function(){return a++,u.apply(null,arguments)},...y),Z=m(function(){i++;let te=AR(w,arguments);return s=V.apply(null,te),s},...A);return Object.assign(Z,{resultFunc:u,memoizedResultFunc:V,dependencies:w,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0;},lastResult:()=>s,recomputations:()=>a,resetRecomputations:()=>{a=0;},memoize:d,argsMemoize:m})};return Object.assign(n,{withTypes:()=>n}),n}var ie=bc(Hi),PR=Object.assign((e,t=ie)=>{CR(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e),n=r.map(a=>e[a]);return t(n,(...a)=>a.reduce((i,s,c)=>(i[r[c]]=s,i),{}))},{withTypes:()=>PR});function Vg(e){return ({dispatch:r,getState:n})=>o=>a=>typeof a=="function"?a(r,n,e):o(a)}var Ng=Vg(),Lg=Vg;var wR=(...e)=>{let t=bc(...e),r=Object.assign((...n)=>{let o=t(...n),a=(i,...s)=>o(Bt(i)?Cp(i):i,...s);return Object.assign(a,o),a},{withTypes:()=>r});return r};wR(Hi);var ER=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?No:No.apply(null,arguments)},IR=e=>e&&typeof e.match=="function";function f(e,t){function r(...n){if(t){let o=t(...n);if(!o)throw new Error(We(0));return {type:e,payload:o.payload,..."meta"in o&&{meta:o.meta},..."error"in o&&{error:o.error}}}return {type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>Fg(n)&&n.type===e,r}var Bg=class zi extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,zi.prototype);}static get[Symbol.species](){return zi}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new zi(...t[0].concat(this)):new zi(...t.concat(this))}};function Mg(e){return wt(e)?Ac(e,()=>{}):e}function kR(e){return typeof e=="boolean"}var OR=()=>function(t){let{thunk:r=!0,immutableCheck:n=!0,serializableCheck:o=!0,actionCreatorCheck:a=!0}=t??{},i=new Bg;return r&&(kR(r)?i.push(Ng):i.push(Lg(r.extraArgument))),i},TR="RTK_autoBatch";var Ug=e=>t=>{setTimeout(t,e);},qR=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Ug(10),DR=(e={type:"raf"})=>t=>(...r)=>{let n=t(...r),o=!0,a=!1,i=!1,s=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?qR:e.type==="callback"?e.queueNotification:Ug(e.timeout),u=()=>{i=!1,a&&(a=!1,s.forEach(l=>l()));};return Object.assign({},n,{subscribe(l){let d=()=>o&&l(),p=n.subscribe(d);return s.add(l),()=>{p(),s.delete(l);}},dispatch(l){try{return o=!l?.meta?.[TR],a=!o,a&&(i||(i=!0,c(u))),n.dispatch(l)}finally{o=!0;}}})},VR=e=>function(r){let{autoBatch:n=!0}=r??{},o=new Bg(e);return n&&o.push(DR(typeof n=="object"?n:void 0)),o},en=!0;function _g(e){let t=OR(),{reducer:r=void 0,middleware:n,devTools:o=!0,preloadedState:a=void 0,enhancers:i=void 0}=e||{},s;if(typeof r=="function")s=r;else if(fc(r))s=gc(r);else throw new Error(We(1));let c;if(typeof n=="function"){if(c=n(t),!en);}else c=t();let u=No;o&&(u=ER({trace:!en,...typeof o=="object"&&o}));let l=xg(...c),d=VR(l);let p=typeof i=="function"?i(d):d();let m=u(...p);return cp(s,a,m)}function NR(e){let t={},r=[],n,o={addCase(a,i){let s=typeof a=="string"?a:a.type;if(!s)throw new Error(We(28));if(s in t)throw new Error(We(29));return t[s]=i,o},addMatcher(a,i){return r.push({matcher:a,reducer:i}),o},addDefaultCase(a){return n=a,o}};return e(o),[t,r,n]}function LR(e){return typeof e=="function"}function k(e,t){let[r,n,o]=NR(t),a;if(LR(e))a=()=>Mg(e());else {let s=Mg(e);a=()=>s;}function i(s=a(),c){let u=[r[c.type],...n.filter(({matcher:l})=>l(c)).map(({reducer:l})=>l)];return u.filter(l=>!!l).length===0&&(u=[o]),u.reduce((l,d)=>{if(d)if(Bt(l)){let m=d(l,c);return m===void 0?l:m}else {if(wt(l))return Ac(l,p=>d(p,c));{let p=d(l,c);if(p===void 0){if(l===null)return l;throw new Error(We(9))}return p}}return l},s)}return i.getInitialState=a,i}var MR="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",jg=(e=21)=>{let t="",r=e;for(;r--;)t+=MR[Math.random()*64|0];return t},QR=(e,t)=>IR(e)?e.match(t):e(t);function BR(...e){return t=>e.some(r=>QR(r,t))}var UR=["name","message","stack","code"],xp=class{constructor(e,t){Ms(this,"_type");this.payload=e,this.meta=t;}},Qg=class{constructor(e,t){Ms(this,"_type");this.payload=e,this.meta=t;}},_R=e=>{if(typeof e=="object"&&e!==null){let t={};for(let r of UR)typeof e[r]=="string"&&(t[r]=e[r]);return t}return {message:String(e)}},N=(()=>{function e(t,r,n){let o=f(t+"/fulfilled",(c,u,l,d)=>({payload:c,meta:{...d||{},arg:l,requestId:u,requestStatus:"fulfilled"}})),a=f(t+"/pending",(c,u,l)=>({payload:void 0,meta:{...l||{},arg:u,requestId:c,requestStatus:"pending"}})),i=f(t+"/rejected",(c,u,l,d,p)=>({payload:d,error:(n&&n.serializeError||_R)(c||"Rejected"),meta:{...p||{},arg:l,requestId:u,rejectedWithValue:!!d,requestStatus:"rejected",aborted:c?.name==="AbortError",condition:c?.name==="ConditionError"}}));function s(c){return (u,l,d)=>{let p=n?.idGenerator?n.idGenerator(c):jg(),m=new AbortController,S,F;function y(w){F=w,m.abort();}let A=async function(){let w;try{let U=n?.condition?.(c,{getState:l,extra:d});if($R(U)&&(U=await U),U===!1||m.signal.aborted)throw {name:"ConditionError",message:"Aborted due to condition callback returning false."};let Z=new Promise((Y,te)=>{S=()=>{te({name:"AbortError",message:F||"Aborted"});},m.signal.addEventListener("abort",S);});u(a(p,c,n?.getPendingMeta?.({requestId:p,arg:c},{getState:l,extra:d}))),w=await Promise.race([Z,Promise.resolve(r(c,{dispatch:u,getState:l,extra:d,requestId:p,signal:m.signal,abort:y,rejectWithValue:(Y,te)=>new xp(Y,te),fulfillWithValue:(Y,te)=>new Qg(Y,te)})).then(Y=>{if(Y instanceof xp)throw Y;return Y instanceof Qg?o(Y.payload,p,c,Y.meta):o(Y,p,c)})]);}catch(U){w=U instanceof xp?i(null,p,c,U.payload,U.meta):i(U,p,c);}finally{S&&m.signal.removeEventListener("abort",S);}return n&&!n.dispatchConditionRejection&&i.match(w)&&w.meta.condition||u(w),w}();return Object.assign(A,{abort:y,requestId:p,arg:c,unwrap(){return A.then(jR)}})}}return Object.assign(s,{pending:a,rejected:i,fulfilled:o,settled:BR(i,o),typePrefix:t})}return e.withTypes=()=>e,e})();function jR(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function $R(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var zR=(e,t)=>{if(typeof e!="function")throw new Error(We(32))};var Fp="listenerMiddleware";var GR=e=>{let{type:t,actionCreator:r,matcher:n,predicate:o,effect:a}=e;if(t)o=f(t).match;else if(r)t=r.type,o=r.match;else if(n)o=n;else if(!o)throw new Error(We(21));return zR(a),{predicate:o,type:t,effect:a}},WR=Object.assign(e=>{let{type:t,predicate:r,effect:n}=GR(e);return {id:jg(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(We(22))}}},{withTypes:()=>WR});var YR=Object.assign(f(`${Fp}/add`),{withTypes:()=>YR});f(`${Fp}/removeAll`);var KR=Object.assign(f(`${Fp}/remove`),{withTypes:()=>KR});function We(e){return `Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}async function Wg(e,t){let r=e.getReader(),n;for(;!(n=await r.read()).done;)t(n.value);}function Yg(e){let t,r,n,o=!1;return function(i){t===void 0?(t=i,r=0,n=-1):t=JR(t,i);let s=t.length,c=0;for(;r<s;){o&&(t[r]===10&&(c=++r),o=!1);let u=-1;for(;r<s&&u===-1;++r)switch(t[r]){case 58:n===-1&&(n=r-c);break;case 13:o=!0;case 10:u=r;break}if(u===-1)break;e(t.subarray(c,u),n),c=r,n=-1;}c===s?t=void 0:c!==0&&(t=t.subarray(c),r-=c);}}function Kg(e,t,r){let n=Gg(),o=new TextDecoder;return function(i,s){if(i.length===0)r?.(n),n=Gg();else if(s>0){let c=o.decode(i.subarray(0,s)),u=s+(i[s+1]===32?2:1),l=o.decode(i.subarray(u));switch(c){case"data":n.data=n.data?n.data+`
`+l:l;break;case"event":n.event=l;break;case"id":e(n.id=l);break;case"retry":let d=parseInt(l,10);isNaN(d)||t(n.retry=d);break}}}}function JR(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function Gg(){return {data:"",event:"",id:"",retry:void 0}}var XR=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},vc="text/event-stream",ZR=1e3,Jg="last-event-id";function Xg(){}function Ap(e,t){var{signal:r,headers:n,onopen:o,onmessage:a,onclose:i,onerror:s,openWhenHidden:c,fetch:u}=t,l=XR(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise((d,p)=>{let m=Object.assign({},n);m.accept||(m.accept=vc);let S;function F(){S?.abort(),document.hidden||Z();}!c&&Xg()&&document.addEventListener("visibilitychange",F);let y=ZR,A=0;function w(){Xg()&&document.removeEventListener("visibilitychange",F),clearTimeout(A),S?.abort();}r?.addEventListener("abort",()=>{w(),d();});let V=u??V,U=o??eb;async function Z(){var Y;S=typeof AbortController>"u"?null:new AbortController;try{let te=await V(e,Object.assign(Object.assign({},l),{headers:m,signal:S?.signal}));await U(te),await Wg(te.body,Yg(Kg(K=>{K?m[Jg]=K:delete m[Jg];},K=>{y=K;},a))),i?.(),w(),d();}catch(te){if(!S?.signal.aborted)try{let K=(Y=s?.(te))!==null&&Y!==void 0?Y:y;clearTimeout(A),A=setTimeout(Z,K);}catch(K){w(),p(K);}}}Z();})}function eb(e){let t=e.headers.get("content-type");if(!t?.startsWith(vc))throw new Error(`Expected content-type to be ${vc}, Actual: ${t}`)}function Pc(){if(typeof window>"u"){let{AbortController:e}=eS();return new e}return typeof AbortController>"u"?null:new AbortController}var tn=class{constructor(t){this._params={};this._basePath=t;}addParam(t,r){this._params={...this.params,[t]:r};}get basePath(){return this._basePath}get params(){return this._params}get hasParams(){return Object.entries(this._params).length}get href(){return this.hasParams?`${this.basePath}?${Object.entries(this.params).map(([t,r])=>`${t}=${encodeURIComponent(r)}`).join("&")}`:this.basePath}},tS=e=>/^https:\/\/platform(dev|stg|hipaa)?(-)?(eu|au)?\.cloud\.coveo\.com/.test(e),rS=(e,t)=>{let r=bp(e);return r&&r.organizationId===t?r:null},bp=e=>{let t=e.match(/^https:\/\/(?<organizationId>\w+)\.org(?<environment>dev|stg|hipaa)?\.coveo\.com/);return t?.groups?t.groups:null};var tb=(e,t,r)=>new tn(`${e}/rest/organizations/${t}/machinelearning/streaming/${r}`).href,nS=3,rb=5e3,nb="text/event-stream",wp=1,vp=class extends Error{},Gi=class extends Error{constructor(r){super(r.message);this.payload=r;}},Pp=class{constructor(){this.timeouts=new Set;}add(t){this.timeouts.add(t);}remove(t){clearTimeout(t),this.timeouts.delete(t);}isActive(t){return this.timeouts.has(t)}},wc=class{constructor(t){this.logger=t.logger;}streamGeneratedAnswer(t,r){let{url:n,organizationId:o,streamId:a,accessToken:i}=t,{write:s,abort:c,close:u,resetAnswer:l}=r,d=new Pp;if(!a){this.logger.error("No stream ID found");return}let p=0,m,S=()=>{m&&!d.isActive(m)&&(y?.abort(),l(),A());},F=()=>{d.remove(m),m=eg(S,m,rb),d.add(m);},y=Pc(),A=()=>Ap(tb(n,o,a),{method:"GET",fetch,headers:{Authorization:`Bearer ${i}`,accept:"*/*"},openWhenHidden:!0,signal:y?.signal,async onopen(w){if(w.ok&&w.headers.get("content-type")===nb)return;throw w.status>=400&&w.status<500&&w.status!==429?new Gi({message:"Error opening stream",code:w.status}):new vp},onmessage:w=>{if(y?.signal.aborted)return;let V=JSON.parse(w.data);if(V.finishReason==="ERROR"){d.remove(m),y?.abort(),c({message:V.errorMessage,code:V.statusCode});return}s(V),p=0,V.finishReason==="COMPLETED"?(d.remove(m),u()):F();},onerror:w=>{if(!y?.signal.aborted){if(d.remove(m),w instanceof Gi)throw y?.abort(),c(w),w;if(++p>nS){this.logger.info("Maximum retry exceeded.");let V={message:"Failed to complete stream.",code:wp};throw y?.abort(),c(V),new Gi(V)}this.logger.info(`Retrying...(${p}/${nS})`),l();}}});return A(),y}};var Ec=e=>e;function wr(e){let{url:t,accessToken:r,organizationId:n,authentication:o,...a}=e;return a}var Er=e=>{let{response:t}=e;return t.body?ob(e):ab(t)},ob=e=>sb(e)?cb(e):ib(e)?e.body:{message:"unknown",statusCode:0,type:"unknown"},ab=e=>{let t=JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)));return {...t,message:`Client side error: ${t.message||""}`,statusCode:400,type:"ClientError"}};function ib(e){return e.body.statusCode!==void 0}function sb(e){return e.body.exception!==void 0}var cb=e=>({message:e.body.exception.code,statusCode:e.response.status,type:e.body.exception.code});var rn=class{constructor(){this.currentAbortController=null;}async enqueue(t,r){let n=this.currentAbortController,o=this.currentAbortController=Pc();n&&(r.warnOnAbort&&r.logger.warn("Cancelling current pending search query"),n.abort());try{return await t(o?.signal??null)}finally{this.currentAbortController===o&&(this.currentAbortController=null);}}};function oS(e){return ((e.headers.get("content-type")||"").split(";").find(n=>n.indexOf("charset=")!==-1)||"").split("=")[1]||"UTF-8"}var Ut=(e,t,r,n)=>{let o=new tn(`${e.url}${n}`);return o.addParam("organizationId",e.organizationId),e.authentication&&o.addParam("authentication",e.authentication),{accessToken:e.accessToken,method:t,contentType:r,url:o.href,origin:"searchApiFetch"}};var aS=(e,t)=>{let r=new tn(`${e.url}${t}`);return r.addParam("access_token",e.accessToken),r.addParam("organizationId",e.organizationId),r.addParam("uniqueId",e.uniqueId),e.q!==void 0&&r.addParam("q",e.q),e.enableNavigation!==void 0&&r.addParam("enableNavigation",`${e.enableNavigation}`),e.requestedOutputSize!==void 0&&r.addParam("requestedOutputSize",`${e.requestedOutputSize}`),e.visitorId!==void 0&&r.addParam("visitorId",`${e.visitorId}`),r.href},iS=async(e,t)=>{let r=await ot.call({...Ut(e,"POST","application/x-www-form-urlencoded","/html"),requestParams:wr(e),requestMetadata:{method:"html"},...t});if(r instanceof Error)throw r;let n=oS(r),o=await r.arrayBuffer(),i=new TextDecoder(n).decode(o);return ub(i)?{success:i}:{error:Er({response:r,body:i})}};function ub(e){return typeof e=="string"}function lb(e){return {statusCode:e.statusCode,type:e.name,message:e.message}}function db(e){return {statusCode:e.code,type:e.name,message:e.message,ignored:!0}}function Wi(e,t){if(t&&e.name==="AbortError")return {error:db(e)};if(e instanceof jn)return {error:lb(e)};throw e}var Ic=class{constructor(t){this.options=t;this.apiCallsQueues={unknown:new rn,mainSearch:new rn,facetValues:new rn,foldingCollection:new rn,instantResults:new rn};}async plan(t){let r=await ot.call({...Ut(t,"POST","application/json","/plan"),requestParams:wr(t),requestMetadata:{method:"plan"},...this.options});if(r instanceof Error)return Wi(r);let n=await r.json();return fb(n)?{success:n}:{error:Er({response:r,body:n})}}async querySuggest(t){let r=await ot.call({...Ut(t,"POST","application/json","/querySuggest"),requestMetadata:{method:"querySuggest"},requestParams:wr(t),...this.options});if(r instanceof Error)return Wi(r);let n=await r.json(),o={response:r,body:n};return mb(n)?{success:(await this.options.postprocessQuerySuggestResponseMiddleware(o)).body}:{error:Er(o)}}async search(t,r){let n=r?.origin??"unknown",o=await this.apiCallsQueues[n].enqueue(s=>ot.call({...Ut(t,"POST","application/json",""),requestParams:wr(t),requestMetadata:{method:"search",origin:r?.origin},...this.options,signal:s??void 0}),{logger:this.options.logger,warnOnAbort:!r?.disableAbortWarning});if(o instanceof Error)return Wi(o,r?.disableAbortWarning);let a=await o.json(),i={response:o,body:a};return Ep(a)?(i.body=pb(a),{success:(await this.options.postprocessSearchResponseMiddleware(i)).body}):{error:Er(i)}}async facetSearch(t){let r=await ot.call({...Ut(t,"POST","application/json","/facet"),requestParams:wr(t),requestMetadata:{method:"facetSearch"},...this.options});if(r instanceof Error)throw r;let n=await r.json(),o={response:r,body:n};return (await this.options.postprocessFacetSearchResponseMiddleware(o)).body}async recommendations(t){let r=await ot.call({...Ut(t,"POST","application/json",""),requestParams:wr(t),requestMetadata:{method:"recommendations"},...this.options});if(r instanceof Error)throw r;let n=await r.json();return Ep(n)?{success:n}:{error:Er({response:r,body:n})}}async html(t){return iS(t,{...this.options})}async productRecommendations(t){let r=await ot.call({...Ut(t,"POST","application/json",""),requestParams:wr(t),requestMetadata:{method:"productRecommendations"},...this.options});if(r instanceof Error)throw r;let n=await r.json();return Ep(n)?{success:n}:{error:Er({response:r,body:n})}}async fieldDescriptions(t){let r=await ot.call({...Ut(t,"GET","application/json","/fields"),requestParams:{},requestMetadata:{method:"fieldDescriptions"},...this.options});if(r instanceof Error)throw r;let n=await r.json();return gb(n)?{success:n}:{error:Er({response:r,body:n})}}},kc=e=>e.success!==void 0,Pe=e=>e.error!==void 0;function Ep(e){return e.results!==void 0}function pb(e){let t=Do();return M(e.questionAnswer)?(e.questionAnswer=t,e):(e.questionAnswer={...t,...e.questionAnswer},e)}function mb(e){return e.completions!==void 0}function fb(e){return e.preprocessingOutput!==void 0}function gb(e){return e.fields!==void 0}var sS=e=>e,cS=e=>e,uS=e=>e;var P=new x({required:!0,emptyAllowed:!1}),re=new x({required:!1,emptyAllowed:!1}),ce=new x({required:!0,emptyAllowed:!0}),lS=new x({required:!1,emptyAllowed:!0}),Oc=new B({each:P,required:!0}),dS=new x({required:!1,emptyAllowed:!1,regex:/^\d+\.\d+\.\d+$/}),Et=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),mt=(e,t)=>{if("required"in t)return {payload:new $({value:t}).validate({value:e}).value};let o=new E({options:{required:!0},values:t}).validate(e);if(o)throw new $n(o);return {payload:e}},g=(e,t)=>{try{return mt(e,t)}catch(r){return {payload:e,error:Et(r)}}},Ce=(e,t,r,n)=>{let o=`Check the initialState of ${n}`;return pS(e,t,r,o,"Controller initialization error")},ue=(e,t,r,n)=>{let o=`Check the options of ${n}`;return pS(e,t,r,o,"Controller initialization error")},pS=(e,t,r,n,o)=>{try{return t.validate(r,n)}catch(a){throw e.logger.error(a,o),a}};function Sb({config:e,environment:t,event:r,listenerManager:n}){let{url:o,token:a,mode:i}=e;i!=="disabled"&&(n.call(r),t.send(o,a,r));}var hb=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function yb(e){return typeof e=="string"&&hb.test(e)}function Cb(e){let t="visitorId";return {getClientId:()=>{let r=e.get(),n=r.storage,o=n.getItem(t),a=o&&yb(o)?o:r.generateUUID();return n.setItem(t,a),a},clear:()=>{e.get().storage.removeItem(t);}}}var fS="0.7.7";function xb(e){let{trackingId:t}=e;return {trackingId:t}}function Fb(e){return (e.source||[]).concat([`relay@${fS}`])}function gS(e,t,r,n){let{getReferrer:o,getLocation:a,getUserAgent:i}=r,s=xb(t),c=n.getClientId();return Object.freeze({type:e,config:s,ts:Date.now(),source:Fb(t),clientId:c,userAgent:i(),referrer:o(),location:a()})}function Ab(e,t,r,n,o){return {...t,meta:gS(e,r,n,o)}}var Rb="*";function bb(){let e=[];function t({type:c,callback:u}){return e.findIndex(l=>l.type===c&&l.callback===u)}function r(c,u){return c.type==="*"||u===c.type}function n(c){return t(c)<0&&e.push(c),()=>s(c.type,c.callback)}function o(c){e.forEach(u=>{if(r(u,c.meta.type))try{u.callback(c);}catch(l){console.error(l);}});}function a(c){if(c===Rb)e.length=0;else for(let u=e.length-1;u>=0;u--)e[u].type===c&&e.splice(u,1);}function i(c){let u=t(c);u>=0&&e.splice(u,1);}function s(c,u){u?i({type:c,callback:u}):a(c);}return {add:n,call:o,remove:s}}function mS({url:e,token:t,trackingId:r,...n}){return Object.freeze({url:e,token:t,trackingId:r,...!!n.mode&&{mode:n.mode},...!!n.source&&{source:n.source}})}function vb(e){let t=mS(e);return {get:()=>t,update:r=>{t=mS({...t,...r});}}}function Pb(){let e=typeof window<"u";return {sendMessage(t){e&&window.postMessage(t,"*");}}}var Ip=wb();function wb(){let e="coveo_",t=r=>{let n=r.split(".").slice(-2);return n.length==2?n.join("."):""};return {getItem(r){let n=`${e}${r}=`,o=document.cookie.split(";");for(let a of o){let i=a.replace(/^\s+/,"");if(i.lastIndexOf(n,0)===0)return i.substring(n.length,i.length)}return null},setItem(r,n,o){let a=t(window.location.hostname),i=`;expires=${new Date(new Date().getTime()+o).toUTCString()}`,s=a?`;domain=${a}`:"";document.cookie=`${e}${r}=${n}${i}${s};path=/;SameSite=Lax`;},removeItem(r){this.setItem(r,"",-1);}}}function Eb(){return {getItem(e){return Ip.getItem(e)||localStorage.getItem(e)},removeItem(e){Ip.removeItem(e),localStorage.removeItem(e);},setItem(e,t){localStorage.setItem(e,t),Ip.setItem(e,t,31556952e3);}}}function Ib(){let e=document.referrer;return e===""?null:e}function kb(){return {runtime:"browser",send:(e,t,r)=>{let n=navigator.sendBeacon(`${e}?access_token=${t}`,new Blob([JSON.stringify([r])],{type:"application/json"}));if(Pb().sendMessage({kind:"EVENT_PROTOCOL",event:r,url:e,token:t}),!n)throw new Error("Failed to send the event(s) because the payload size exceeded the maximum allowed size (32 KB). Please contact support if the problem persists.")},getReferrer:()=>Ib(),getLocation:()=>window.location.href,getUserAgent:()=>navigator.userAgent,generateUUID:()=>crypto.randomUUID(),storage:Eb()}}function Ob(){return {getItem(){return null},removeItem(){},setItem(){}}}function Tb(){return {runtime:"null",send:()=>{},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>"",storage:Ob()}}function qb(e){return e.get().mode!=="disabled"&&Db()?kb():Tb()}function Db(){try{return typeof window=="object"}catch{return !1}}function Vb(e){return {get:()=>Object.freeze(qb(e))}}function SS(e){let t=vb(e),r=bb(),n=Vb(t),o=Cb(n);return {emit:(a,i)=>{let s=t.get(),c=n.get(),u=Ab(a,i,s,c,o);return Sb({config:s,environment:c,event:u,listenerManager:r})},getMeta:a=>gS(a,t.get(),n.get(),o),on:(a,i)=>r.add({type:a,callback:i}),off:(a,i)=>r.remove(a,i),updateConfig:a=>t.update(a),version:fS,clearStorage:()=>{o.clear();}}}var Gn="2.63.3",hS=["@coveo/atomic","@coveo/quantic"];var Tc=ie(e=>e.source,e=>[`@coveo/headless@${Gn}`].concat(Object.entries(e).map(([t,r])=>`${t}@${r}`)));var Yi=ie(e=>e.configuration.accessToken,e=>e.configuration.analytics,e=>Tc(e.configuration.analytics),(e,{trackingId:t,nextApiBaseUrl:r,enabled:n},o)=>SS({mode:n?"emit":"disabled",url:r,token:e,trackingId:t,source:o}));function Ir(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function h(e,t,r,n){function o(a){return a instanceof r?a:new r(function(i){i(a);})}return new(r||(r=Promise))(function(a,i){function s(l){try{u(n.next(l));}catch(d){i(d);}}function c(l){try{u(n.throw(l));}catch(d){i(d);}}function u(l){l.done?a(l.value):o(l.value).then(s,c);}u((n=n.apply(e,t||[])).next());})}var ee;(function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect";})(ee||(ee={}));function yS(){return typeof window<"u"}function jp(){return typeof navigator<"u"}function Mo(){return typeof document<"u"}function Op(){try{return typeof localStorage<"u"}catch{return !1}}function Nb(){try{return typeof sessionStorage<"u"}catch{return !1}}function kS(){return jp()&&navigator.cookieEnabled}var Lb=[ee.click,ee.custom,ee.search,ee.view],Mb=(e,t)=>Lb.indexOf(e)!==-1?Object.assign({language:Mo()?document.documentElement.lang:"unknown",userAgent:jp()?navigator.userAgent:"unknown"},t):t,Xi=class e{static set(t,r,n){var o,a,i,s;n&&(a=new Date,a.setTime(a.getTime()+n)),s=window.location.hostname,s.indexOf(".")===-1?CS(t,r,a):(i=s.split("."),o=i[i.length-2]+"."+i[i.length-1],CS(t,r,a,o));}static get(t){for(var r=t+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){var a=n[o];if(a=a.replace(/^\s+/,""),a.lastIndexOf(r,0)===0)return a.substring(r.length,a.length)}return null}static erase(t){e.set(t,"",-1);}};function CS(e,t,r,n){document.cookie=`${e}=${t}`+(r?`;expires=${r.toUTCString()}`:"")+(n?`;domain=${n}`:"")+";path=/;SameSite=Lax";}function Qb(){return Op()?localStorage:kS()?new Zi:Nb()?sessionStorage:new Bo}var Zi=class e{getItem(t){return Xi.get(`${e.prefix}${t}`)}removeItem(t){Xi.erase(`${e.prefix}${t}`);}setItem(t,r,n){Xi.set(`${e.prefix}${t}`,r,n);}};Zi.prefix="coveo_";var Tp=class{constructor(){this.cookieStorage=new Zi;}getItem(t){return localStorage.getItem(t)||this.cookieStorage.getItem(t)}removeItem(t){this.cookieStorage.removeItem(t),localStorage.removeItem(t);}setItem(t,r){localStorage.setItem(t,r),this.cookieStorage.setItem(t,r,31556926e3);}},Bo=class{getItem(t){return null}removeItem(t){}setItem(t,r){}},Ki="__coveo.analytics.history",OS=20,TS=1e3*60,qS=75,Uo=class{constructor(t){this.store=t||Qb();}addElement(t){t.internalTime=new Date().getTime(),t=this.cropQueryElement(this.stripEmptyQuery(t));let r=this.getHistoryWithInternalTime();r!=null?this.isValidEntry(t)&&this.setHistory([t].concat(r)):this.setHistory([t]);}addElementAsync(t){return h(this,void 0,void 0,function*(){t.internalTime=new Date().getTime(),t=this.cropQueryElement(this.stripEmptyQuery(t));let r=yield this.getHistoryWithInternalTimeAsync();r!=null?this.isValidEntry(t)&&this.setHistory([t].concat(r)):this.setHistory([t]);})}getHistory(){let t=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(t))}getHistoryAsync(){return h(this,void 0,void 0,function*(){let t=yield this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(t))})}getHistoryWithInternalTime(){try{let t=this.store.getItem(Ki);return t&&typeof t=="string"?JSON.parse(t):[]}catch{return []}}getHistoryWithInternalTimeAsync(){return h(this,void 0,void 0,function*(){try{let t=yield this.store.getItem(Ki);return t?JSON.parse(t):[]}catch{return []}})}setHistory(t){try{this.store.setItem(Ki,JSON.stringify(t.slice(0,OS)));}catch{}}clear(){try{this.store.removeItem(Ki);}catch{}}getMostRecentElement(){let t=this.getHistoryWithInternalTime();return Array.isArray(t)?t.sort((n,o)=>(o.internalTime||0)-(n.internalTime||0))[0]:null}cropQueryElement(t){return t.name&&t.value&&t.name.toLowerCase()==="query"&&(t.value=t.value.slice(0,qS)),t}isValidEntry(t){let r=this.getMostRecentElement();return r&&r.value==t.value?(t.internalTime||0)-(r.internalTime||0)>TS:!0}stripInternalTime(t){return Array.isArray(t)?t.map(r=>{let{name:n,time:o,value:a}=r;return {name:n,time:o,value:a}}):[]}stripEmptyQuery(t){let{name:r,time:n,value:o}=t;return r&&typeof o=="string"&&r.toLowerCase()==="query"&&o.trim()===""?{name:r,time:n}:t}stripEmptyQueries(t){return t.map(r=>this.stripEmptyQuery(r))}},DS=Object.freeze({__proto__:null,HistoryStore:Uo,MAX_NUMBER_OF_HISTORY_ELEMENTS:OS,MAX_VALUE_SIZE:qS,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:TS,STORE_KEY:Ki,default:Uo}),Bb=(e,t)=>h(void 0,void 0,void 0,function*(){return e===ee.view?(yield Ub(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t}),Ub=e=>h(void 0,void 0,void 0,function*(){let t=new Uo,r={name:"PageView",value:e,time:new Date().toISOString()};yield t.addElementAsync(r);}),qc,_b=new Uint8Array(16);function jb(){if(!qc&&(qc=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!qc))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return qc(_b)}var $b=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Vc(e){return typeof e=="string"&&$b.test(e)}var De=[];for(let e=0;e<256;++e)De.push((e+256).toString(16).slice(1));function VS(e,t=0){return (De[e[t+0]]+De[e[t+1]]+De[e[t+2]]+De[e[t+3]]+"-"+De[e[t+4]]+De[e[t+5]]+"-"+De[e[t+6]]+De[e[t+7]]+"-"+De[e[t+8]]+De[e[t+9]]+"-"+De[e[t+10]]+De[e[t+11]]+De[e[t+12]]+De[e[t+13]]+De[e[t+14]]+De[e[t+15]]).toLowerCase()}function Hb(e){if(!Vc(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}function zb(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var Gb="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Wb="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Yb(e,t,r){function n(o,a,i,s){var c;if(typeof o=="string"&&(o=zb(o)),typeof a=="string"&&(a=Hb(a)),((c=a)===null||c===void 0?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+o.length);if(u.set(a),u.set(o,a.length),u=r(u),u[6]=u[6]&15|t,u[8]=u[8]&63|128,i){s=s||0;for(let l=0;l<16;++l)i[s+l]=u[l];return i}return VS(u)}try{n.name=e;}catch{}return n.DNS=Gb,n.URL=Wb,n}var Kb=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),xS={randomUUID:Kb};function Wn(e,t,r){if(xS.randomUUID&&!t&&!e)return xS.randomUUID();e=e||{};let n=e.random||(e.rng||jb)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(let o=0;o<16;++o)t[r+o]=n[o];return t}return VS(n)}function Jb(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function kp(e,t){return e<<t|e>>>32-t}function Xb(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){let i=unescape(encodeURIComponent(e));e=[];for(let s=0;s<i.length;++s)e.push(i.charCodeAt(s));}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=e.length/4+2,o=Math.ceil(n/16),a=new Array(o);for(let i=0;i<o;++i){let s=new Uint32Array(16);for(let c=0;c<16;++c)s[c]=e[i*64+c*4]<<24|e[i*64+c*4+1]<<16|e[i*64+c*4+2]<<8|e[i*64+c*4+3];a[i]=s;}a[o-1][14]=(e.length-1)*8/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=(e.length-1)*8&4294967295;for(let i=0;i<o;++i){let s=new Uint32Array(80);for(let m=0;m<16;++m)s[m]=a[i][m];for(let m=16;m<80;++m)s[m]=kp(s[m-3]^s[m-8]^s[m-14]^s[m-16],1);let c=r[0],u=r[1],l=r[2],d=r[3],p=r[4];for(let m=0;m<80;++m){let S=Math.floor(m/20),F=kp(c,5)+Jb(S,u,l,d)+p+t[S]+s[m]>>>0;p=d,d=l,l=kp(u,30)>>>0,u=c,c=F;}r[0]=r[0]+c>>>0,r[1]=r[1]+u>>>0,r[2]=r[2]+l>>>0,r[3]=r[3]+d>>>0,r[4]=r[4]+p>>>0;}return [r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var Zb=Yb("v5",80,Xb),FS=Zb,NS="2.30.2",Ji={pageview:"pageview",event:"event"},nn=class e{constructor(t,r){if(!Vc(t))throw Error("Not a valid uuid");this.clientId=t,this.creationDate=Math.floor(r/1e3);}toString(){return this.clientId.replace(/-/g,"")+"."+this.creationDate.toString()}get expired(){let t=Math.floor(Date.now()/1e3)-this.creationDate;return t<0||t>e.expirationTime}validate(t,r){return !this.expired&&this.matchReferrer(t,r)}matchReferrer(t,r){try{let n=new URL(t);return r.some(o=>new RegExp(o.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(n.host))}catch{return !1}}static fromString(t){let r=t.split(".");if(r.length!==2)return null;let[n,o]=r;if(n.length!==32||isNaN(parseInt(o)))return null;let a=n.substring(0,8)+"-"+n.substring(8,12)+"-"+n.substring(12,16)+"-"+n.substring(16,20)+"-"+n.substring(20,32);return Vc(a)?new e(a,Number.parseInt(o)*1e3):null}};nn.cvo_cid="cvo_cid";nn.expirationTime=120;var ft=Object.keys;function Dc(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}var Vp={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},ev=ft(Vp).map(e=>Vp[e]),tv=[...ev].join("|"),rv=new RegExp(`^(${tv}$)`),nv={svcAction:"svc_action",svcActionData:"svc_action_data"},av=e=>rv.test(e),iv=[av],RS={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},bS={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr",group:"group"},Ne={action:"pa",list:"pal",listSource:"pls"},Lc={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},sv=["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit"],Np={id:"quoteId",affiliation:"quoteAffiliation"},Lp={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},cv={add:Ne,bookmark_add:Ne,bookmark_remove:Ne,click:Ne,checkout:Ne,checkout_option:Ne,detail:Ne,impression:Ne,remove:Ne,refund:Object.assign(Object.assign({},Ne),Lc),purchase:Object.assign(Object.assign({},Ne),Lc),quickview:Ne,quote:Object.assign(Object.assign({},Ne),Np),review:Object.assign(Object.assign({},Ne),Lp)},uv=ft(RS).map(e=>RS[e]),lv=ft(bS).map(e=>bS[e]),dv=ft(Ne).map(e=>Ne[e]),pv=ft(Lc).map(e=>Lc[e]),mv=ft(Lp).map(e=>Lp[e]),fv=ft(Np).map(e=>Np[e]),gv=[...uv,"custom"].join("|"),Sv=[...lv,"custom"].join("|"),LS="(pr[0-9]+)",MS="(il[0-9]+pi[0-9]+)",hv=new RegExp(`^${LS}(${gv})$`),yv=new RegExp(`^(${MS}(${Sv}))|(il[0-9]+nm)$`),Cv=new RegExp(`^(${dv.join("|")})$`),xv=new RegExp(`^(${pv.join("|")})$`),Fv=new RegExp(`^${LS}custom$`),Av=new RegExp(`^${MS}custom$`),Rv=new RegExp(`^(${[...sv,...mv,...fv].join("|")})$`),bv=e=>hv.test(e),vv=e=>yv.test(e),Pv=e=>Cv.test(e),wv=e=>xv.test(e),Ev=e=>Rv.test(e),Iv=[vv,bv,Pv,wv,Ev],kv=[Fv,Av],Ov={anonymizeIp:"aip"},Tv={eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"},qv={hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"},Dv=["contentId","contentIdKey","contentType","searchHub","tab","searchUid","permanentId","contentLocale","trackingId"],Vv=Object.assign(Object.assign(Object.assign(Object.assign({},Ov),Tv),qv),Dv.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:t}),{})),Mp=Object.assign(Object.assign({},Vv),nv),Nv=e=>{let t=!!e.action&&cv[e.action]||{};return ft(e).reduce((r,n)=>{let o=t[n]||Mp[n]||n;return Object.assign(Object.assign({},r),{[o]:e[n]})},{})},Lv=ft(Mp).map(e=>Mp[e]),Mv=e=>Lv.indexOf(e)!==-1,Qv=e=>e==="custom",Bv=e=>[...Iv,...iv,Mv,Qv].some(t=>t(e)),Uv=e=>ft(e).reduce((t,r)=>{let n=_v(r);return n?Object.assign(Object.assign({},t),jv(n,e[r])):Object.assign(Object.assign({},t),{[r]:e[r]})},{}),_v=e=>{let t;return [...kv].every(r=>{var n;return t=(n=r.exec(e))===null||n===void 0?void 0:n[1],!t}),t},jv=(e,t)=>ft(t).reduce((r,n)=>Object.assign(Object.assign({},r),{[`${e}${n}`]:t[n]}),{}),Qp=class{constructor(t){this.opts=t;}sendEvent(t,r){return h(this,void 0,void 0,function*(){if(!this.isAvailable())throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');let{baseUrl:n,preprocessRequest:o}=this.opts,a=yield this.getQueryParamsForEventType(t),{url:i,payload:s}=yield this.preProcessRequestAsPotentialJSONString(`${n}/analytics/${t}?${a}`,r,o),c=this.encodeForEventType(t,s),u=new Blob([c],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(i,u);})}isAvailable(){return "sendBeacon"in navigator}deleteHttpCookieVisitorId(){return Promise.resolve()}preProcessRequestAsPotentialJSONString(t,r,n){return h(this,void 0,void 0,function*(){let o=t,a=r;if(n){let i=yield n({url:t,body:JSON.stringify(r)},"analyticsBeacon"),{url:s,body:c}=i;o=s||t;try{a=JSON.parse(c);}catch(u){console.error("Unable to process the request body as a JSON string",u);}}return {payload:a,url:o}})}encodeForEventType(t,r){return this.isEventTypeLegacy(t)?this.encodeEventToJson(t,r):this.encodeEventToJson(t,r,this.opts.token)}getQueryParamsForEventType(t){return h(this,void 0,void 0,function*(){let{token:r,visitorIdProvider:n}=this.opts,o=yield n.getCurrentVisitorId();return [r&&this.isEventTypeLegacy(t)?`access_token=${r}`:"",o?`visitorId=${o}`:"","discardVisitInfo=true"].filter(a=>!!a).join("&")})}isEventTypeLegacy(t){return [ee.click,ee.custom,ee.search,ee.view].indexOf(t)!==-1}encodeEventToJson(t,r,n){let o=`${t}Event=${encodeURIComponent(JSON.stringify(r))}`;return n&&(o=`access_token=${encodeURIComponent(n)}&${o}`),o}},Bp=class{sendEvent(t,r){return h(this,void 0,void 0,function*(){return Promise.resolve()})}deleteHttpCookieVisitorId(){return h(this,void 0,void 0,function*(){return Promise.resolve()})}},vS=window.fetch,Mc=class{constructor(t){this.opts=t;}sendEvent(t,r){return h(this,void 0,void 0,function*(){let{baseUrl:n,visitorIdProvider:o,preprocessRequest:a}=this.opts,i=this.shouldAppendVisitorId(t)?yield this.getVisitorIdParam():"",s={url:`${n}/analytics/${t}${i}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(r)},c=Object.assign(Object.assign({},s),a?yield a(s,"analyticsFetch"):{}),{url:u}=c,l=Ir(c,["url"]),d;try{d=yield vS(u,l);}catch(p){console.error("An error has occured when sending the event.",p);return}if(d.ok){let p=yield d.json();return p.visitorId&&o.setCurrentVisitorId(p.visitorId),p}else {try{d.json();}catch{}throw console.error(`An error has occured when sending the "${t}" event.`,d,r),new Error(`An error has occurred when sending the "${t}" event. Check the console logs for more details.`)}})}deleteHttpCookieVisitorId(){return h(this,void 0,void 0,function*(){let{baseUrl:t}=this.opts,r=`${t}/analytics/visit`;yield vS(r,{headers:this.getHeaders(),method:"DELETE"});})}shouldAppendVisitorId(t){return [ee.click,ee.custom,ee.search,ee.view].indexOf(t)!==-1}getVisitorIdParam(){return h(this,void 0,void 0,function*(){let{visitorIdProvider:t}=this.opts,r=yield t.getCurrentVisitorId();return r?`?visitor=${r}`:""})}getHeaders(){let{token:t}=this.opts;return Object.assign(Object.assign({},t?{Authorization:`Bearer ${t}`}:{}),{"Content-Type":"application/json"})}},Up=class{constructor(t,r){Op()&&kS()?this.storage=new Tp:Op()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new Bo),this.client=new Mc(t),this.beaconClient=new Qp(t),window.addEventListener("beforeunload",()=>{let n=r();for(let{eventType:o,payload:a}of n)this.beaconClient.sendEvent(o,a);});}getClientDependingOnEventType(t){return t==="click"&&this.beaconClient.isAvailable()?this.beaconClient:this.client}},_p=class{constructor(t,r){this.storage=r||new Bo,this.client=new Mc(t);}getClientDependingOnEventType(t){return this.client}},Qc=class{constructor(){this.storage=new Bo,this.client=new Bp;}getClientDependingOnEventType(t){return this.client}},$v="xx",Hv=e=>e?.startsWith($v)||!1,zv=`
        We've detected you're using React Native but have not provided the corresponding runtime, 
        for an optimal experience please use the "coveo.analytics/react-native" subpackage.
        Follow the Readme on how to set it up: https://github.com/coveo/coveo.analytics.js#using-react-native
    `;function Gv(){return typeof navigator<"u"&&navigator.product=="ReactNative"}var Wv=["1",1,"yes",!0];function Bc(){return jp()&&[navigator.globalPrivacyControl,navigator.doNotTrack,navigator.msDoNotTrack,window.doNotTrack].some(e=>Wv.indexOf(e)!==-1)}var QS="v15",BS={default:"https://analytics.cloud.coveo.com/rest/ua",production:"https://analytics.cloud.coveo.com/rest/ua",hipaa:"https://analyticshipaa.cloud.coveo.com/rest/ua"};function Yv(e=BS.default,t=QS,r=!1){if(e=e.replace(/\/$/,""),r)return `${e}/${t}`;let n=e.endsWith("/rest")||e.endsWith("/rest/ua");return `${e}${n?"":"/rest"}/${t}`}var Kv="38824e1f-37f5-42d3-8372-a4b8fa9df946",Or=class{get defaultOptions(){return {endpoint:BS.default,isCustomEndpoint:!1,token:"",version:QS,beforeSendHooks:[],afterSendHooks:[]}}get version(){return NS}constructor(t){if(this.acceptedLinkReferrers=[],!t)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),t),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[Bb,Mb].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};let r={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};Bc()?this.runtime=new Qc:this.runtime=this.options.runtimeEnvironment||this.initRuntime(r),this.addEventTypeMapping(ee.view,{newEventType:ee.view,addClientIdParameter:!0}),this.addEventTypeMapping(ee.click,{newEventType:ee.click,addClientIdParameter:!0}),this.addEventTypeMapping(ee.custom,{newEventType:ee.custom,addClientIdParameter:!0}),this.addEventTypeMapping(ee.search,{newEventType:ee.search,addClientIdParameter:!0});}initRuntime(t){return yS()&&Mo()?new Up(t,()=>{let r=[...this.bufferedRequests];return this.bufferedRequests=[],r}):(Gv()&&console.warn(zv),new _p(t))}get storage(){return this.runtime.storage}determineVisitorId(){return h(this,void 0,void 0,function*(){try{return yS()&&this.extractClientIdFromLink(window.location.href)||(yield this.storage.getItem("visitorId"))||Wn()}catch(t){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",t),Wn()}})}getCurrentVisitorId(){return h(this,void 0,void 0,function*(){if(!this.visitorId){let t=yield this.determineVisitorId();yield this.setCurrentVisitorId(t);}return this.visitorId})}setCurrentVisitorId(t){return h(this,void 0,void 0,function*(){this.visitorId=t,yield this.storage.setItem("visitorId",t);})}setClientId(t,r){return h(this,void 0,void 0,function*(){if(Vc(t))this.setCurrentVisitorId(t.toLowerCase());else {if(!r)throw Error("Cannot generate uuid client id without a specific namespace string.");this.setCurrentVisitorId(FS(t,FS(r,Kv)));}})}getParameters(t,...r){return h(this,void 0,void 0,function*(){return yield this.resolveParameters(t,...r)})}getPayload(t,...r){return h(this,void 0,void 0,function*(){let n=yield this.resolveParameters(t,...r);return yield this.resolvePayloadForParameters(t,n)})}get currentVisitorId(){return typeof(this.visitorId||this.storage.getItem("visitorId"))!="string"&&this.setCurrentVisitorId(Wn()),this.visitorId}set currentVisitorId(t){this.visitorId=t,this.storage.setItem("visitorId",t);}extractClientIdFromLink(t){if(Bc())return null;try{let r=new URL(t).searchParams.get(nn.cvo_cid);if(r==null)return null;let n=nn.fromString(r);return !n||!Mo()||!n.validate(document.referrer,this.acceptedLinkReferrers)?null:n.clientId}catch{}return null}resolveParameters(t,...r){return h(this,void 0,void 0,function*(){let{variableLengthArgumentsNames:n=[],addVisitorIdParameter:o=!1,usesMeasurementProtocol:a=!1,addClientIdParameter:i=!1}=this.eventTypeMapping[t]||{};return yield [m=>n.length>0?this.parseVariableArgumentsPayload(n,m):m[0],m=>h(this,void 0,void 0,function*(){return Object.assign(Object.assign({},m),{visitorId:o?yield this.getCurrentVisitorId():""})}),m=>h(this,void 0,void 0,function*(){return i?Object.assign(Object.assign({},m),{clientId:yield this.getCurrentVisitorId()}):m}),m=>a?this.ensureAnonymousUserWhenUsingApiKey(m):m,m=>this.beforeSendHooks.reduce((S,F)=>h(this,void 0,void 0,function*(){let y=yield S;return yield F(t,y)}),m)].reduce((m,S)=>h(this,void 0,void 0,function*(){let F=yield m;return yield S(F)}),Promise.resolve(r))})}resolvePayloadForParameters(t,r){return h(this,void 0,void 0,function*(){let{usesMeasurementProtocol:n=!1}=this.eventTypeMapping[t]||{};return yield [d=>this.setTrackingIdIfTrackingIdNotPresent(d),d=>this.removeEmptyPayloadValues(d,t),d=>this.validateParams(d,t),d=>n?Nv(d):d,d=>n?this.removeUnknownParameters(d):d,d=>n?this.processCustomParameters(d):this.mapCustomParametersToCustomData(d)].reduce((d,p)=>h(this,void 0,void 0,function*(){let m=yield d;return yield p(m)}),Promise.resolve(r))})}makeEvent(t,...r){return h(this,void 0,void 0,function*(){let{newEventType:n=t}=this.eventTypeMapping[t]||{},o=yield this.resolveParameters(t,...r),a=yield this.resolvePayloadForParameters(t,o);return {eventType:n,payload:a,log:i=>h(this,void 0,void 0,function*(){return this.bufferedRequests.push({eventType:n,payload:Object.assign(Object.assign({},a),i)}),yield Promise.all(this.afterSendHooks.map(s=>s(t,Object.assign(Object.assign({},o),i)))),yield this.deferExecution(),yield this.sendFromBuffer()})}})}sendEvent(t,...r){return h(this,void 0,void 0,function*(){return (yield this.makeEvent(t,...r)).log({})})}deferExecution(){return new Promise(t=>setTimeout(t,0))}sendFromBuffer(){return h(this,void 0,void 0,function*(){let t=this.bufferedRequests.shift();if(t){let{eventType:r,payload:n}=t;return this.runtime.getClientDependingOnEventType(r).sendEvent(r,n)}})}clear(){this.storage.removeItem("visitorId"),new Uo().clear();}deleteHttpOnlyVisitorId(){this.runtime.client.deleteHttpCookieVisitorId();}makeSearchEvent(t){return h(this,void 0,void 0,function*(){return this.makeEvent(ee.search,t)})}sendSearchEvent(t){var{searchQueryUid:r}=t,n=Ir(t,["searchQueryUid"]);return h(this,void 0,void 0,function*(){return (yield this.makeSearchEvent(n)).log({searchQueryUid:r})})}makeClickEvent(t){return h(this,void 0,void 0,function*(){return this.makeEvent(ee.click,t)})}sendClickEvent(t){var{searchQueryUid:r}=t,n=Ir(t,["searchQueryUid"]);return h(this,void 0,void 0,function*(){return (yield this.makeClickEvent(n)).log({searchQueryUid:r})})}makeCustomEvent(t){return h(this,void 0,void 0,function*(){return this.makeEvent(ee.custom,t)})}sendCustomEvent(t){var{lastSearchQueryUid:r}=t,n=Ir(t,["lastSearchQueryUid"]);return h(this,void 0,void 0,function*(){return (yield this.makeCustomEvent(n)).log({lastSearchQueryUid:r})})}makeViewEvent(t){return h(this,void 0,void 0,function*(){return this.makeEvent(ee.view,t)})}sendViewEvent(t){return h(this,void 0,void 0,function*(){return (yield this.makeViewEvent(t)).log({})})}getVisit(){return h(this,void 0,void 0,function*(){let r=yield (yield fetch(`${this.baseUrl}/analytics/visit`)).json();return this.visitorId=r.visitorId,r})}getHealth(){return h(this,void 0,void 0,function*(){return yield (yield fetch(`${this.baseUrl}/analytics/monitoring/health`)).json()})}registerBeforeSendEventHook(t){this.beforeSendHooks.push(t);}registerAfterSendEventHook(t){this.afterSendHooks.push(t);}addEventTypeMapping(t,r){this.eventTypeMapping[t]=r;}setAcceptedLinkReferrers(t){if(Array.isArray(t)&&t.every(r=>typeof r=="string"))this.acceptedLinkReferrers=t;else throw Error("Parameter should be an array of domain strings")}parseVariableArgumentsPayload(t,r){let n={};for(let o=0,a=r.length;o<a;o++){let i=r[o];if(typeof i=="string")n[t[o]]=i;else if(typeof i=="object")return Object.assign(Object.assign({},n),i)}return n}isKeyAllowedEmpty(t,r){return ({[ee.search]:["queryText"]}[t]||[]).indexOf(r)!==-1}removeEmptyPayloadValues(t,r){let n=o=>typeof o<"u"&&o!==null&&o!=="";return Object.keys(t).filter(o=>this.isKeyAllowedEmpty(r,o)||n(t[o])).reduce((o,a)=>Object.assign(Object.assign({},o),{[a]:t[a]}),{})}removeUnknownParameters(t){return Object.keys(t).filter(n=>{if(Bv(n))return !0;console.log(n,"is not processed by coveoua");}).reduce((n,o)=>Object.assign(Object.assign({},n),{[o]:t[o]}),{})}processCustomParameters(t){let{custom:r}=t,n=Ir(t,["custom"]),o={};r&&Dc(r)&&(o=this.lowercaseKeys(r));let a=Uv(n);return Object.assign(Object.assign({},o),a)}mapCustomParametersToCustomData(t){let{custom:r}=t,n=Ir(t,["custom"]);if(r&&Dc(r)){let o=this.lowercaseKeys(r);return Object.assign(Object.assign({},n),{customData:Object.assign(Object.assign({},o),t.customData)})}else return t}lowercaseKeys(t){let r=Object.keys(t),n={};return r.forEach(o=>{n[o.toLowerCase()]=t[o];}),n}validateParams(t,r){let{anonymizeIp:n}=t,o=Ir(t,["anonymizeIp"]);return n!==void 0&&["0","false","undefined","null","{}","[]",""].indexOf(`${n}`.toLowerCase())==-1&&(o.anonymizeIp=1),(r==ee.view||r==ee.click||r==ee.search||r==ee.custom)&&(o.originLevel3=this.limit(o.originLevel3,128)),r==ee.view&&(o.location=this.limit(o.location,128)),(r=="pageview"||r=="event")&&(o.referrer=this.limit(o.referrer,2048),o.location=this.limit(o.location,2048),o.page=this.limit(o.page,2048)),o}ensureAnonymousUserWhenUsingApiKey(t){let{userId:r}=t,n=Ir(t,["userId"]);return Hv(this.options.token)&&!r?(n.userId="anonymous",n):t}setTrackingIdIfTrackingIdNotPresent(t){let{trackingId:r}=t,n=Ir(t,["trackingId"]);return r?t:(n.hasOwnProperty("custom")&&Dc(n.custom)&&(n.custom.hasOwnProperty("context_website")||n.custom.hasOwnProperty("siteName"))&&(n.trackingId=n.custom.context_website||n.custom.siteName),n.hasOwnProperty("customData")&&Dc(n.customData)&&(n.customData.hasOwnProperty("context_website")||n.customData.hasOwnProperty("siteName"))&&(n.trackingId=n.customData.context_website||n.customData.siteName),n)}limit(t,r){return typeof t!="string"?t:t.substring(0,r)}get baseUrl(){return Yv(this.options.endpoint,this.options.version,this.options.isCustomEndpoint)}},kr;(function(e){e.contextChanged="contextChanged",e.expandToFullUI="expandToFullUI",e.openUserActions="openUserActions",e.showPrecedingSessions="showPrecedingSessions",e.showFollowingSessions="showFollowingSessions",e.clickViewedDocument="clickViewedDocument",e.clickPageView="clickPageView",e.createArticle="createArticle";})(kr||(kr={}));var C;(function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.undoTriggerQuery="undoQuery",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.staticFilterClearAll="staticFilterClearAll",e.staticFilterSelect="staticFilterSelect",e.staticFilterDeselect="staticFilterDeselect",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",e.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",e.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",e.openSmartSnippetSource="openSmartSnippetSource",e.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",e.openSmartSnippetInlineLink="openSmartSnippetInlineLink",e.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",e.recentQueryClick="recentQueriesClick",e.clearRecentQueries="clearRecentQueries",e.recentResultClick="recentResultClick",e.clearRecentResults="clearRecentResults",e.noResultsBack="noResultsBack",e.showMoreFoldedResults="showMoreFoldedResults",e.showLessFoldedResults="showLessFoldedResults",e.copyToClipboard="copyToClipboard",e.caseSendEmail="Case.SendEmail",e.feedItemTextPost="FeedItem.TextPost",e.caseAttach="caseAttach",e.caseDetach="caseDetach",e.retryGeneratedAnswer="retryGeneratedAnswer",e.likeGeneratedAnswer="likeGeneratedAnswer",e.dislikeGeneratedAnswer="dislikeGeneratedAnswer",e.openGeneratedAnswerSource="openGeneratedAnswerSource",e.generatedAnswerStreamEnd="generatedAnswerStreamEnd",e.generatedAnswerSourceHover="generatedAnswerSourceHover",e.generatedAnswerCopyToClipboard="generatedAnswerCopyToClipboard",e.generatedAnswerHideAnswers="generatedAnswerHideAnswers",e.generatedAnswerShowAnswers="generatedAnswerShowAnswers",e.generatedAnswerExpand="generatedAnswerExpand",e.generatedAnswerCollapse="generatedAnswerCollapse",e.generatedAnswerFeedbackSubmit="generatedAnswerFeedbackSubmit",e.rephraseGeneratedAnswer="rephraseGeneratedAnswer";})(C||(C={}));var PS={[C.triggerNotify]:"queryPipelineTriggers",[C.triggerExecute]:"queryPipelineTriggers",[C.triggerQuery]:"queryPipelineTriggers",[C.triggerRedirect]:"queryPipelineTriggers",[C.queryError]:"errors",[C.queryErrorBack]:"errors",[C.queryErrorClear]:"errors",[C.queryErrorRetry]:"errors",[C.pagerNext]:"getMoreResults",[C.pagerPrevious]:"getMoreResults",[C.pagerNumber]:"getMoreResults",[C.pagerResize]:"getMoreResults",[C.pagerScrolling]:"getMoreResults",[C.facetSearch]:"facet",[C.facetShowLess]:"facet",[C.facetShowMore]:"facet",[C.recommendation]:"recommendation",[C.likeSmartSnippet]:"smartSnippet",[C.dislikeSmartSnippet]:"smartSnippet",[C.expandSmartSnippet]:"smartSnippet",[C.collapseSmartSnippet]:"smartSnippet",[C.openSmartSnippetFeedbackModal]:"smartSnippet",[C.closeSmartSnippetFeedbackModal]:"smartSnippet",[C.sendSmartSnippetReason]:"smartSnippet",[C.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[C.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions",[C.showMoreSmartSnippetSuggestion]:"smartSnippetSuggestions",[C.showLessSmartSnippetSuggestion]:"smartSnippetSuggestions",[C.clearRecentQueries]:"recentQueries",[C.recentResultClick]:"recentlyClickedDocuments",[C.clearRecentResults]:"recentlyClickedDocuments",[C.showLessFoldedResults]:"folding",[C.caseDetach]:"case",[C.likeGeneratedAnswer]:"generatedAnswer",[C.dislikeGeneratedAnswer]:"generatedAnswer",[C.openGeneratedAnswerSource]:"generatedAnswer",[C.generatedAnswerStreamEnd]:"generatedAnswer",[C.generatedAnswerSourceHover]:"generatedAnswer",[C.generatedAnswerCopyToClipboard]:"generatedAnswer",[C.generatedAnswerHideAnswers]:"generatedAnswer",[C.generatedAnswerShowAnswers]:"generatedAnswer",[C.generatedAnswerExpand]:"generatedAnswer",[C.generatedAnswerCollapse]:"generatedAnswer",[C.generatedAnswerFeedbackSubmit]:"generatedAnswer",[kr.expandToFullUI]:"interface",[kr.openUserActions]:"User Actions",[kr.showPrecedingSessions]:"User Actions",[kr.showFollowingSessions]:"User Actions",[kr.clickViewedDocument]:"User Actions",[kr.clickPageView]:"User Actions",[kr.createArticle]:"createArticle"},_o=class{constructor(){this.runtime=new Qc,this.currentVisitorId="";}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}makeEvent(t){return Promise.resolve({eventType:t,payload:null,log:()=>Promise.resolve()})}sendEvent(){return Promise.resolve()}makeSearchEvent(){return this.makeEvent(ee.search)}sendSearchEvent(){return Promise.resolve()}makeClickEvent(){return this.makeEvent(ee.click)}sendClickEvent(){return Promise.resolve()}makeCustomEvent(){return this.makeEvent(ee.custom)}sendCustomEvent(){return Promise.resolve()}makeViewEvent(){return this.makeEvent(ee.view)}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}get version(){return NS}};function Jv(e){let t="";return e.filter(r=>{let n=r!==t;return t=r,n})}function Xv(e){return e.map(t=>t.replace(/;/g,""))}function US(e){let r=e.join(";");return r.length<=256?r:US(e.slice(1))}var wS=e=>{let t=Xv(e),r=Jv(t);return US(r)};function ES(e){let t=typeof e.partialQueries=="string"?e.partialQueries:wS(e.partialQueries),r=typeof e.suggestions=="string"?e.suggestions:wS(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}var on=class{constructor(t,r){this.opts=t,this.provider=r;let n=t.enableAnalytics===!1||Bc();this.coveoAnalyticsClient=n?new _o:new Or(t);}disable(){this.coveoAnalyticsClient=new _o;}enable(){this.coveoAnalyticsClient=new Or(this.opts);}makeInterfaceLoad(){return this.makeSearchEvent(C.interfaceLoad)}logInterfaceLoad(){return h(this,void 0,void 0,function*(){return (yield this.makeInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationInterfaceLoad(){return this.makeSearchEvent(C.recommendationInterfaceLoad)}logRecommendationInterfaceLoad(){return h(this,void 0,void 0,function*(){return (yield this.makeRecommendationInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendation(){return this.makeCustomEvent(C.recommendation)}logRecommendation(){return h(this,void 0,void 0,function*(){return (yield this.makeRecommendation()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationOpen(t,r){return this.makeClickEvent(C.recommendationOpen,t,r)}logRecommendationOpen(t,r){return h(this,void 0,void 0,function*(){return (yield this.makeRecommendationOpen(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterClearAll(t){return this.makeSearchEvent(C.staticFilterClearAll,t)}logStaticFilterClearAll(t){return h(this,void 0,void 0,function*(){return (yield this.makeStaticFilterClearAll(t)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterSelect(t){return this.makeSearchEvent(C.staticFilterSelect,t)}logStaticFilterSelect(t){return h(this,void 0,void 0,function*(){return (yield this.makeStaticFilterSelect(t)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterDeselect(t){return this.makeSearchEvent(C.staticFilterDeselect,t)}logStaticFilterDeselect(t){return h(this,void 0,void 0,function*(){return (yield this.makeStaticFilterDeselect(t)).log({searchUID:this.provider.getSearchUID()})})}makeFetchMoreResults(){return this.makeCustomEvent(C.pagerScrolling,{type:"getMoreResults"})}logFetchMoreResults(){return h(this,void 0,void 0,function*(){return (yield this.makeFetchMoreResults()).log({searchUID:this.provider.getSearchUID()})})}makeInterfaceChange(t){return this.makeSearchEvent(C.interfaceChange,t)}logInterfaceChange(t){return h(this,void 0,void 0,function*(){return (yield this.makeInterfaceChange(t)).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanAutomatic(){return this.makeSearchEvent(C.didyoumeanAutomatic)}logDidYouMeanAutomatic(){return h(this,void 0,void 0,function*(){return (yield this.makeDidYouMeanAutomatic()).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanClick(){return this.makeSearchEvent(C.didyoumeanClick)}logDidYouMeanClick(){return h(this,void 0,void 0,function*(){return (yield this.makeDidYouMeanClick()).log({searchUID:this.provider.getSearchUID()})})}makeResultsSort(t){return this.makeSearchEvent(C.resultsSort,t)}logResultsSort(t){return h(this,void 0,void 0,function*(){return (yield this.makeResultsSort(t)).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxSubmit(){return this.makeSearchEvent(C.searchboxSubmit)}logSearchboxSubmit(){return h(this,void 0,void 0,function*(){return (yield this.makeSearchboxSubmit()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxClear(){return this.makeSearchEvent(C.searchboxClear)}logSearchboxClear(){return h(this,void 0,void 0,function*(){return (yield this.makeSearchboxClear()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxAsYouType(){return this.makeSearchEvent(C.searchboxAsYouType)}logSearchboxAsYouType(){return h(this,void 0,void 0,function*(){return (yield this.makeSearchboxAsYouType()).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbFacet(t){return this.makeSearchEvent(C.breadcrumbFacet,t)}logBreadcrumbFacet(t){return h(this,void 0,void 0,function*(){return (yield this.makeBreadcrumbFacet(t)).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbResetAll(){return this.makeSearchEvent(C.breadcrumbResetAll)}logBreadcrumbResetAll(){return h(this,void 0,void 0,function*(){return (yield this.makeBreadcrumbResetAll()).log({searchUID:this.provider.getSearchUID()})})}makeDocumentQuickview(t,r){return this.makeClickEvent(C.documentQuickview,t,r)}logDocumentQuickview(t,r){return h(this,void 0,void 0,function*(){return (yield this.makeDocumentQuickview(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeDocumentOpen(t,r){return this.makeClickEvent(C.documentOpen,t,r)}logDocumentOpen(t,r){return h(this,void 0,void 0,function*(){return (yield this.makeDocumentOpen(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxAnalytics(t){return this.makeSearchEvent(C.omniboxAnalytics,ES(t))}logOmniboxAnalytics(t){return h(this,void 0,void 0,function*(){return (yield this.makeOmniboxAnalytics(t)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxFromLink(t){return this.makeSearchEvent(C.omniboxFromLink,ES(t))}logOmniboxFromLink(t){return h(this,void 0,void 0,function*(){return (yield this.makeOmniboxFromLink(t)).log({searchUID:this.provider.getSearchUID()})})}makeSearchFromLink(){return this.makeSearchEvent(C.searchFromLink)}logSearchFromLink(){return h(this,void 0,void 0,function*(){return (yield this.makeSearchFromLink()).log({searchUID:this.provider.getSearchUID()})})}makeTriggerNotify(t){return this.makeCustomEvent(C.triggerNotify,t)}logTriggerNotify(t){return h(this,void 0,void 0,function*(){return (yield this.makeTriggerNotify(t)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerExecute(t){return this.makeCustomEvent(C.triggerExecute,t)}logTriggerExecute(t){return h(this,void 0,void 0,function*(){return (yield this.makeTriggerExecute(t)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerQuery(){return this.makeCustomEvent(C.triggerQuery,{query:this.provider.getSearchEventRequestPayload().queryText},"queryPipelineTriggers")}logTriggerQuery(){return h(this,void 0,void 0,function*(){return (yield this.makeTriggerQuery()).log({searchUID:this.provider.getSearchUID()})})}makeUndoTriggerQuery(t){return this.makeSearchEvent(C.undoTriggerQuery,t)}logUndoTriggerQuery(t){return h(this,void 0,void 0,function*(){return (yield this.makeUndoTriggerQuery(t)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerRedirect(t){return this.makeCustomEvent(C.triggerRedirect,Object.assign(Object.assign({},t),{query:this.provider.getSearchEventRequestPayload().queryText}))}logTriggerRedirect(t){return h(this,void 0,void 0,function*(){return (yield this.makeTriggerRedirect(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerResize(t){return this.makeCustomEvent(C.pagerResize,t)}logPagerResize(t){return h(this,void 0,void 0,function*(){return (yield this.makePagerResize(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerNumber(t){return this.makeCustomEvent(C.pagerNumber,t)}logPagerNumber(t){return h(this,void 0,void 0,function*(){return (yield this.makePagerNumber(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerNext(t){return this.makeCustomEvent(C.pagerNext,t)}logPagerNext(t){return h(this,void 0,void 0,function*(){return (yield this.makePagerNext(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerPrevious(t){return this.makeCustomEvent(C.pagerPrevious,t)}logPagerPrevious(t){return h(this,void 0,void 0,function*(){return (yield this.makePagerPrevious(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerScrolling(){return this.makeCustomEvent(C.pagerScrolling)}logPagerScrolling(){return h(this,void 0,void 0,function*(){return (yield this.makePagerScrolling()).log({searchUID:this.provider.getSearchUID()})})}makeFacetClearAll(t){return this.makeSearchEvent(C.facetClearAll,t)}logFacetClearAll(t){return h(this,void 0,void 0,function*(){return (yield this.makeFacetClearAll(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSearch(t){return this.makeSearchEvent(C.facetSearch,t)}logFacetSearch(t){return h(this,void 0,void 0,function*(){return (yield this.makeFacetSearch(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelect(t){return this.makeSearchEvent(C.facetSelect,t)}logFacetSelect(t){return h(this,void 0,void 0,function*(){return (yield this.makeFacetSelect(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetDeselect(t){return this.makeSearchEvent(C.facetDeselect,t)}logFacetDeselect(t){return h(this,void 0,void 0,function*(){return (yield this.makeFacetDeselect(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetExclude(t){return this.makeSearchEvent(C.facetExclude,t)}logFacetExclude(t){return h(this,void 0,void 0,function*(){return (yield this.makeFacetExclude(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUnexclude(t){return this.makeSearchEvent(C.facetUnexclude,t)}logFacetUnexclude(t){return h(this,void 0,void 0,function*(){return (yield this.makeFacetUnexclude(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelectAll(t){return this.makeSearchEvent(C.facetSelectAll,t)}logFacetSelectAll(t){return h(this,void 0,void 0,function*(){return (yield this.makeFacetSelectAll(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUpdateSort(t){return this.makeSearchEvent(C.facetUpdateSort,t)}logFacetUpdateSort(t){return h(this,void 0,void 0,function*(){return (yield this.makeFacetUpdateSort(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowMore(t){return this.makeCustomEvent(C.facetShowMore,t)}logFacetShowMore(t){return h(this,void 0,void 0,function*(){return (yield this.makeFacetShowMore(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowLess(t){return this.makeCustomEvent(C.facetShowLess,t)}logFacetShowLess(t){return h(this,void 0,void 0,function*(){return (yield this.makeFacetShowLess(t)).log({searchUID:this.provider.getSearchUID()})})}makeQueryError(t){return this.makeCustomEvent(C.queryError,t)}logQueryError(t){return h(this,void 0,void 0,function*(){return (yield this.makeQueryError(t)).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorBack(){return h(this,void 0,void 0,function*(){let t=yield this.makeCustomEvent(C.queryErrorBack);return {description:t.description,log:()=>h(this,void 0,void 0,function*(){return yield t.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(C.queryErrorBack)})}})}logQueryErrorBack(){return h(this,void 0,void 0,function*(){return (yield this.makeQueryErrorBack()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorRetry(){return h(this,void 0,void 0,function*(){let t=yield this.makeCustomEvent(C.queryErrorRetry);return {description:t.description,log:()=>h(this,void 0,void 0,function*(){return yield t.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(C.queryErrorRetry)})}})}logQueryErrorRetry(){return h(this,void 0,void 0,function*(){return (yield this.makeQueryErrorRetry()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorClear(){return h(this,void 0,void 0,function*(){let t=yield this.makeCustomEvent(C.queryErrorClear);return {description:t.description,log:()=>h(this,void 0,void 0,function*(){return yield t.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(C.queryErrorClear)})}})}logQueryErrorClear(){return h(this,void 0,void 0,function*(){return (yield this.makeQueryErrorClear()).log({searchUID:this.provider.getSearchUID()})})}makeLikeSmartSnippet(){return this.makeCustomEvent(C.likeSmartSnippet)}logLikeSmartSnippet(){return h(this,void 0,void 0,function*(){return (yield this.makeLikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeDislikeSmartSnippet(){return this.makeCustomEvent(C.dislikeSmartSnippet)}logDislikeSmartSnippet(){return h(this,void 0,void 0,function*(){return (yield this.makeDislikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippet(){return this.makeCustomEvent(C.expandSmartSnippet)}logExpandSmartSnippet(){return h(this,void 0,void 0,function*(){return (yield this.makeExpandSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippet(){return this.makeCustomEvent(C.collapseSmartSnippet)}logCollapseSmartSnippet(){return h(this,void 0,void 0,function*(){return (yield this.makeCollapseSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetFeedbackModal(){return this.makeCustomEvent(C.openSmartSnippetFeedbackModal)}logOpenSmartSnippetFeedbackModal(){return h(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeCloseSmartSnippetFeedbackModal(){return this.makeCustomEvent(C.closeSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return h(this,void 0,void 0,function*(){return (yield this.makeCloseSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeSmartSnippetFeedbackReason(t,r){return this.makeCustomEvent(C.sendSmartSnippetReason,{reason:t,details:r})}logSmartSnippetFeedbackReason(t,r){return h(this,void 0,void 0,function*(){return (yield this.makeSmartSnippetFeedbackReason(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippetSuggestion(t){return this.makeCustomEvent(C.expandSmartSnippetSuggestion,"documentId"in t?t:{documentId:t})}logExpandSmartSnippetSuggestion(t){return h(this,void 0,void 0,function*(){return (yield this.makeExpandSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippetSuggestion(t){return this.makeCustomEvent(C.collapseSmartSnippetSuggestion,"documentId"in t?t:{documentId:t})}logCollapseSmartSnippetSuggestion(t){return h(this,void 0,void 0,function*(){return (yield this.makeCollapseSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreSmartSnippetSuggestion(t){return this.makeCustomEvent(C.showMoreSmartSnippetSuggestion,t)}logShowMoreSmartSnippetSuggestion(t){return h(this,void 0,void 0,function*(){return (yield this.makeShowMoreSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessSmartSnippetSuggestion(t){return this.makeCustomEvent(C.showLessSmartSnippetSuggestion,t)}logShowLessSmartSnippetSuggestion(t){return h(this,void 0,void 0,function*(){return (yield this.makeShowLessSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSource(t,r){return this.makeClickEvent(C.openSmartSnippetSource,t,r)}logOpenSmartSnippetSource(t,r){return h(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetSource(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionSource(t,r){return this.makeClickEvent(C.openSmartSnippetSuggestionSource,t,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},r)}makeCopyToClipboard(t,r){return this.makeClickEvent(C.copyToClipboard,t,r)}logCopyToClipboard(t,r){return h(this,void 0,void 0,function*(){return (yield this.makeCopyToClipboard(t,r)).log({searchUID:this.provider.getSearchUID()})})}logOpenSmartSnippetSuggestionSource(t,r){return h(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetSuggestionSource(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetInlineLink(t,r){return this.makeClickEvent(C.openSmartSnippetInlineLink,t,{contentIDKey:r.contentIDKey,contentIDValue:r.contentIDValue},r)}logOpenSmartSnippetInlineLink(t,r){return h(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetInlineLink(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionInlineLink(t,r){return this.makeClickEvent(C.openSmartSnippetSuggestionInlineLink,t,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},r)}logOpenSmartSnippetSuggestionInlineLink(t,r){return h(this,void 0,void 0,function*(){return (yield this.makeOpenSmartSnippetSuggestionInlineLink(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeRecentQueryClick(){return this.makeSearchEvent(C.recentQueryClick)}logRecentQueryClick(){return h(this,void 0,void 0,function*(){return (yield this.makeRecentQueryClick()).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentQueries(){return this.makeCustomEvent(C.clearRecentQueries)}logClearRecentQueries(){return h(this,void 0,void 0,function*(){return (yield this.makeClearRecentQueries()).log({searchUID:this.provider.getSearchUID()})})}makeRecentResultClick(t,r){return this.makeCustomEvent(C.recentResultClick,{info:t,identifier:r})}logRecentResultClick(t,r){return h(this,void 0,void 0,function*(){return (yield this.makeRecentResultClick(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentResults(){return this.makeCustomEvent(C.clearRecentResults)}logClearRecentResults(){return h(this,void 0,void 0,function*(){return (yield this.makeClearRecentResults()).log({searchUID:this.provider.getSearchUID()})})}makeNoResultsBack(){return this.makeSearchEvent(C.noResultsBack)}logNoResultsBack(){return h(this,void 0,void 0,function*(){return (yield this.makeNoResultsBack()).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreFoldedResults(t,r){return this.makeClickEvent(C.showMoreFoldedResults,t,r)}logShowMoreFoldedResults(t,r){return h(this,void 0,void 0,function*(){return (yield this.makeShowMoreFoldedResults(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessFoldedResults(){return this.makeCustomEvent(C.showLessFoldedResults)}logShowLessFoldedResults(){return h(this,void 0,void 0,function*(){return (yield this.makeShowLessFoldedResults()).log({searchUID:this.provider.getSearchUID()})})}makeEventDescription(t,r){var n;return {actionCause:r,customData:(n=t.payload)===null||n===void 0?void 0:n.customData}}makeCustomEvent(t,r,n=PS[t]){return h(this,void 0,void 0,function*(){let o=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),a=Object.assign(Object.assign({},yield this.getBaseEventRequest(o)),{eventType:n,eventValue:t}),i=yield this.coveoAnalyticsClient.makeCustomEvent(a);return {description:this.makeEventDescription(i,t),log:({searchUID:s})=>i.log({lastSearchQueryUid:s})}})}logCustomEvent(t,r,n=PS[t]){return h(this,void 0,void 0,function*(){return (yield this.makeCustomEvent(t,r,n)).log({searchUID:this.provider.getSearchUID()})})}makeCustomEventWithType(t,r,n){return h(this,void 0,void 0,function*(){let o=Object.assign(Object.assign({},this.provider.getBaseMetadata()),n),a=Object.assign(Object.assign({},yield this.getBaseEventRequest(o)),{eventType:r,eventValue:t}),i=yield this.coveoAnalyticsClient.makeCustomEvent(a);return {description:this.makeEventDescription(i,t),log:({searchUID:s})=>i.log({lastSearchQueryUid:s})}})}logCustomEventWithType(t,r,n){return h(this,void 0,void 0,function*(){return (yield this.makeCustomEventWithType(t,r,n)).log({searchUID:this.provider.getSearchUID()})})}logSearchEvent(t,r){return h(this,void 0,void 0,function*(){return (yield this.makeSearchEvent(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeSearchEvent(t,r){return h(this,void 0,void 0,function*(){let n=yield this.getBaseSearchEventRequest(t,r),o=yield this.coveoAnalyticsClient.makeSearchEvent(n);return {description:this.makeEventDescription(o,t),log:({searchUID:a})=>o.log({searchQueryUid:a})}})}makeClickEvent(t,r,n,o){return h(this,void 0,void 0,function*(){let a=Object.assign(Object.assign(Object.assign({},r),yield this.getBaseEventRequest(Object.assign(Object.assign({},n),o))),{queryPipeline:this.provider.getPipeline(),actionCause:t}),i=yield this.coveoAnalyticsClient.makeClickEvent(a);return {description:this.makeEventDescription(i,t),log:({searchUID:s})=>i.log({searchQueryUid:s})}})}logClickEvent(t,r,n,o){return h(this,void 0,void 0,function*(){return (yield this.makeClickEvent(t,r,n,o)).log({searchUID:this.provider.getSearchUID()})})}getBaseSearchEventRequest(t,r){var n,o;return h(this,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},r),(o=(n=this.provider).getGeneratedAnswerMetadata)===null||o===void 0?void 0:o.call(n)))),this.provider.getSearchEventRequestPayload()),{queryPipeline:this.provider.getPipeline(),actionCause:t})})}getBaseEventRequest(t){return h(this,void 0,void 0,function*(){let r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t);return Object.assign(Object.assign(Object.assign({},this.getOrigins()),this.getSplitTestRun()),{customData:r,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})})}getOrigins(){var t,r;return {originContext:(r=(t=this.provider).getOriginContext)===null||r===void 0?void 0:r.call(t),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof Or?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getSplitTestRun(){let t=this.provider.getSplitTestRunName?this.provider.getSplitTestRunName():"",r=this.provider.getSplitTestRunVersion?this.provider.getSplitTestRunVersion():"";return Object.assign(Object.assign({},t&&{splitTestRunName:t}),r&&{splitTestRunVersion:r})}makeLikeGeneratedAnswer(t){return this.makeCustomEvent(C.likeGeneratedAnswer,t)}logLikeGeneratedAnswer(t){return h(this,void 0,void 0,function*(){return (yield this.makeLikeGeneratedAnswer(t)).log({searchUID:this.provider.getSearchUID()})})}makeDislikeGeneratedAnswer(t){return this.makeCustomEvent(C.dislikeGeneratedAnswer,t)}logDislikeGeneratedAnswer(t){return h(this,void 0,void 0,function*(){return (yield this.makeDislikeGeneratedAnswer(t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenGeneratedAnswerSource(t){return this.makeCustomEvent(C.openGeneratedAnswerSource,t)}logOpenGeneratedAnswerSource(t){return h(this,void 0,void 0,function*(){return (yield this.makeOpenGeneratedAnswerSource(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerSourceHover(t){return this.makeCustomEvent(C.generatedAnswerSourceHover,t)}logGeneratedAnswerSourceHover(t){return h(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerSourceHover(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCopyToClipboard(t){return this.makeCustomEvent(C.generatedAnswerCopyToClipboard,t)}logGeneratedAnswerCopyToClipboard(t){return h(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerCopyToClipboard(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerHideAnswers(t){return this.makeCustomEvent(C.generatedAnswerHideAnswers,t)}logGeneratedAnswerHideAnswers(t){return h(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerHideAnswers(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerShowAnswers(t){return this.makeCustomEvent(C.generatedAnswerShowAnswers,t)}logGeneratedAnswerShowAnswers(t){return h(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerShowAnswers(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerExpand(t){return this.makeCustomEvent(C.generatedAnswerExpand,t)}logGeneratedAnswerExpand(t){return h(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerExpand(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCollapse(t){return this.makeCustomEvent(C.generatedAnswerCollapse,t)}logGeneratedAnswerCollapse(t){return h(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerCollapse(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerFeedbackSubmit(t){return this.makeCustomEvent(C.generatedAnswerFeedbackSubmit,t)}logGeneratedAnswerFeedbackSubmit(t){return h(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerFeedbackSubmit(t)).log({searchUID:this.provider.getSearchUID()})})}makeRephraseGeneratedAnswer(t){return this.makeSearchEvent(C.rephraseGeneratedAnswer,t)}logRephraseGeneratedAnswer(t){return h(this,void 0,void 0,function*(){return (yield this.makeRephraseGeneratedAnswer(t)).log({searchUID:this.provider.getSearchUID()})})}makeRetryGeneratedAnswer(){return this.makeSearchEvent(C.retryGeneratedAnswer)}logRetryGeneratedAnswer(){return h(this,void 0,void 0,function*(){return (yield this.makeRetryGeneratedAnswer()).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerStreamEnd(t){return this.makeCustomEvent(C.generatedAnswerStreamEnd,t)}logGeneratedAnswerStreamEnd(t){return h(this,void 0,void 0,function*(){return (yield this.makeGeneratedAnswerStreamEnd(t)).log({searchUID:this.provider.getSearchUID()})})}},Uc=Object.assign({},Ji);Object.keys(Uc).map(e=>Uc[e]);var _c;(function(e){e.click="click",e.flowStart="flowStart";})(_c||(_c={}));var It;(function(e){e.enterInterface="ticket_create_start",e.fieldUpdate="ticket_field_update",e.fieldSuggestionClick="ticket_classification_click",e.suggestionClick="suggestion_click",e.suggestionRate="suggestion_rate",e.nextCaseStep="ticket_next_stage",e.caseCancelled="ticket_cancel",e.caseSolved="ticket_cancel",e.caseCreated="ticket_create";})(It||(It={}));var jc;(function(e){e.quit="Quit",e.solved="Solved";})(jc||(jc={}));var we=e=>new Or(e).getCurrentVisitorId(),Ye=new DS.HistoryStore,Tr=(e,t)=>typeof t=="function"?(...r)=>{let n=Ni(r[0]);try{return t.apply(t,r)}catch(o){return e.error(o,"Error in analytics preprocessRequest. Returning original request."),n}}:void 0,qr=(e,t)=>(...r)=>{let n=Ni(r[1]);try{return t.apply(t,r)}catch(o){return e.error(o,"Error in analytics hook. Returning original request."),n}};var Hc=()=>({url:"",clientId:"",additionalFields:[],advancedParameters:{debug:!1},products:[],facets:{results:[]},error:null,isLoading:!1,responseId:""});var Zv=e=>{let t=e.configuration.search.locale.split("-")[0];return !t||t.length!==2?"en":t},Dr=class{constructor(t){this.getState=t;this.state=t();}getLanguage(){return Zv(this.state)}getBaseMetadata(){let{context:t,configuration:r}=this.state,n=t?.contextValues||{},o={};for(let[a,i]of Object.entries(n)){let s=`context_${a}`;o[s]=i;}return r.analytics.analyticsMode==="legacy"&&(o.coveoHeadlessVersion=Gn),o}getOriginContext(){return this.state.configuration.analytics.originContext}getOriginLevel1(){return this.state.searchHub||pt()}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3}getIsAnonymous(){return this.state.configuration.analytics.anonymous}};var _t=(e,t)=>{let r=n=>n.facetId===t;if("productListing"in e&&e.productListing&&"facets"in e.productListing&&"results"in e.productListing.facets)return e.productListing.facets.results.find(r);if("search"in e&&e.search)return e.search.response.facets.find(r)},$p=(e,t)=>e.facetSet[t]?.request;function eP(e,t){return !!t&&t.facetId in e.facetSet}var rs=(e,t)=>{let r=_t(e,t);if(eP(e,r))return r},$S=(e,t)=>{let r=rs(e,t);return r?r.values.filter(n=>n.state!=="idle"):[]},jt=e=>"productListing"in e?e.productListing.isLoading:e.search.isLoading;function HS(e){if(!e)return {parents:[],values:[]};let t=[],r=e;for(;r.length&&r[0].children.length;)t=[...t,...r],r=r[0].children;let n=r.find(o=>o.state==="selected");return n&&(t=[...t,n],r=[]),{parents:t,values:r}}function st(e){let{activeValue:t,ancestryMap:r}=rP(e);return t?nP(t,r):[]}function rP(e){let t=[...e],r=new Map;for(;t.length>0;){let n=t.shift();if(n.state==="selected")return {activeValue:n,ancestryMap:r};if(r)for(let o of n.children)r.set(o,n);t.unshift(...n.children);}return {}}function nP(e,t){let r=[];if(!e)return [];let n=e;do r.unshift(n),n=t.get(n);while(n);return r}function oP(e,t){return !!t&&t.facetId in e.categoryFacetSet}var Hp=(e,t)=>{let r=_t(e,t);if(oP(e,r))return r},zp=(e,t)=>e.categoryFacetSet[t]?.request,zS=(e,t)=>{let r=Hp(e,t);return st(r?.values??[])},Gp=(e,t)=>{let r=zp(e,t);return st(r?.currentValues??[])};var jo=(e,t)=>{let r=KS(t,e),n=r?r.field:"",o=Yp(n,e);return {facetId:e,facetField:n,facetTitle:o}};function $o(e,t){let{facetId:r,facetValue:n}=e,o=jo(r,t),a=JS(t,r);return {...o,facetValue:a==="hierarchical"?YS(t,r):n}}function ct(e){return {facetSet:e.facetSet??Jr(),categoryFacetSet:e.categoryFacetSet??Kr(),dateFacetSet:e.dateFacetSet??Xr(),numericFacetSet:e.numericFacetSet??Zr(),automaticFacetSet:e.automaticFacetSet??Yr()}}var Wp=e=>{let t=[];return sP(e).forEach((r,n)=>{let o=JS(e,r.facetId),a=pP(r,n+1);if(iP(r)){if(!!!Gp(e,r.facetId).length)return;t.push({...a,...lP(e,r.facetId),facetType:o,state:"selected"});return}r.currentValues.forEach((i,s)=>{if(i.state==="idle")return;let c=GS(i,s+1,o),u=aP(r)?WS(i):uP(i);t.push({...a,...c,...u});});}),cP(e).forEach((r,n)=>{let o=dP(r,n+1);r.values.forEach((a,i)=>{if(a.state==="idle")return;let s=GS(a,i+1,"specific"),c=WS(a);t.push({...o,...s,...c});});}),t},aP=e=>e.type==="specific",iP=e=>e.type==="hierarchical",sP=e=>[...Object.values(e.facetSet),...Object.values(e.categoryFacetSet),...Object.values(e.dateFacetSet),...Object.values(e.numericFacetSet)].map(t=>t.request),cP=e=>[...Object.values(e.automaticFacetSet.set)].map(t=>t.response),GS=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),uP=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),WS=e=>({displayValue:e.value,value:e.value}),YS=(e,t)=>Gp(e,t).map(n=>n.value).join(";"),lP=(e,t)=>{let n=YS(e,t);return {value:n,valuePosition:1,displayValue:n}},dP=(e,t)=>({title:Yp(e.field,e.field),field:e.field,id:e.field,facetPosition:t}),pP=(e,t)=>({title:Yp(e.field,e.facetId),field:e.field,id:e.facetId,facetPosition:t}),Yp=(e,t)=>`${e}_${t}`,KS=(e,t)=>e.facetSet[t]?.request||e.categoryFacetSet[t]?.request||e.dateFacetSet[t]?.request||e.numericFacetSet[t]?.request||e.automaticFacetSet.set[t]?.response,JS=(e,t)=>{let r=KS(e,t);return r?r.type:"specific"};var Yn=class extends Dr{constructor(){super(...arguments);this.initialState=Hc();}getPipeline(){return ""}getSearchEventRequestPayload(){return {queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){return this.getState().productListing?.responseId||this.initialState.responseId}mapResultsToAnalyticsDocument(){return this.state.productListing?.products.map(r=>({documentUri:r.documentUri,documentUriHash:r.documentUriHash,permanentid:r.permanentid}))}get numberOfResults(){return this.state.productListing.products.length}},XS=({logger:e,getState:t,analyticsClientMiddleware:r=(a,i)=>i,preprocessRequest:n,provider:o=new Yn(t)})=>{let a=t(),i=a.configuration.accessToken,s=a.configuration.analytics.apiBaseUrl,c=a.configuration.analytics.runtimeEnvironment,u=a.configuration.analytics.enabled,l=new on({token:i,endpoint:s,runtimeEnvironment:c,preprocessRequest:Tr(e,n),beforeSendHooks:[qr(e,r),(d,p)=>(e.info({...p,type:d,endpoint:s,token:i},"Analytics request"),p)]},o);return u||l.disable(),l};var ns=class ns extends Dr{constructor(){super(...arguments);this.getFacetRequest=r=>this.state.facetSet?.[r]?.request||this.state.categoryFacetSet?.[r]?.request||this.state.dateFacetSet?.[r]?.request||this.state.numericFacetSet?.[r]?.request||this.state.automaticFacetSet?.set[r]?.response;}getFacetState(){return Wp(ct(this.getState()))}getPipeline(){return this.state.pipeline||this.state.search?.response.pipeline||ns.fallbackPipelineName}getSearchEventRequestPayload(){return {queryText:this.queryText,responseTime:this.responseTime,results:this.resultURIs,numberOfResults:this.numberOfResults}}getSearchUID(){let r=this.getState();return r.search?.searchResponseId||r.search?.response.searchUid||je().response.searchUid}getSplitTestRunName(){return this.state.search?.response.splitTestRun}getSplitTestRunVersion(){let r=!!this.getSplitTestRunName(),n=this.state.search?.response.pipeline||this.state.pipeline||ns.fallbackPipelineName;return r?n:void 0}getBaseMetadata(){let r=this.getState(),n=super.getBaseMetadata(),o=r.search?.response?.extendedResults?.generativeQuestionAnsweringId;return o&&(n.generativeQuestionAnsweringId=o),n}getFacetMetadata(r,n){let a=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),facetId:r,facetField:a,facetValue:n,facetTitle:`${a}_${r}`}}getFacetClearAllMetadata(r){let o=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),facetId:r,facetField:o,facetTitle:`${o}_${r}`}}getFacetUpdateSortMetadata(r,n){let a=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),facetId:r,facetField:a,criteria:n,facetTitle:`${a}_${r}`}}getRangeBreadcrumbFacetMetadata(r,n){let a=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),facetId:r,facetField:a,facetRangeEnd:n.end,facetRangeEndInclusive:n.endInclusive,facetRangeStart:n.start,facetTitle:`${a}_${r}`}}getResultSortMetadata(){return {...this.getBaseMetadata(),resultsSortBy:this.state.sortCriteria??Ge()}}getStaticFilterToggleMetadata(r,n){return {...this.getBaseMetadata(),staticFilterId:r,staticFilterValue:n}}getStaticFilterClearAllMetadata(r){return {...this.getBaseMetadata(),staticFilterId:r}}getUndoTriggerQueryMetadata(r){return {...this.getBaseMetadata(),undoneQuery:r}}getCategoryBreadcrumbFacetMetadata(r,n){let a=this.getFacetRequest(r)?.field??"";return {...this.getBaseMetadata(),categoryFacetId:r,categoryFacetField:a,categoryFacetPath:n,categoryFacetTitle:`${a}_${r}`}}getOmniboxAnalyticsMetadata(r,n){let o=this.state.querySuggest&&this.state.querySuggest[r],a=o.completions.map(u=>u.expression),i=o.partialQueries.length-1,s=o.partialQueries[i]||"",c=o.responseId;return {...this.getBaseMetadata(),suggestionRanking:a.indexOf(n),partialQuery:s,partialQueries:o.partialQueries.length>0?o.partialQueries:"",suggestions:a.length>0?a:"",querySuggestResponseId:c}}getInterfaceChangeMetadata(){return {...this.getBaseMetadata(),interfaceChangeTo:this.state.configuration.analytics.originLevel2}}getOmniboxFromLinkMetadata(r){return {...this.getBaseMetadata(),...r}}getGeneratedAnswerMetadata(){let r=this.getState(),n={};return r.generatedAnswer?.isVisible!==void 0&&(n.showGeneratedAnswer=r.generatedAnswer.isVisible),n}get resultURIs(){return this.results?.map(r=>({documentUri:r.uri,documentUriHash:r.raw.urihash}))}get results(){return this.state.search?.response.results}get queryText(){return this.state.query?.q||ge().q}get responseTime(){return this.state.search?.duration||je().duration}get numberOfResults(){return this.state.search?.response.totalCountFiltered||je().response.totalCountFiltered}};ns.fallbackPipelineName="default";var an=ns,ZS=({logger:e,getState:t,analyticsClientMiddleware:r=(a,i)=>i,preprocessRequest:n,provider:o=new an(t)})=>{let a=t(),i=a.configuration.accessToken,s=a.configuration.analytics.apiBaseUrl,c=a.configuration.analytics.runtimeEnvironment,u=a.configuration.analytics.enabled,l=new on({token:i,endpoint:s,runtimeEnvironment:c,preprocessRequest:Tr(e,n),beforeSendHooks:[qr(e,r),(d,p)=>(e.info({...p,type:d,endpoint:s,token:i},"Analytics request"),p)]},o);return u||l.disable(),l},Kp=()=>{let t=Ye.getHistory().reverse().find(r=>r.name==="PageView"&&r.value);return t?t.value:""};function zc(e){let t=eh(e),r=[e,...t].filter(o=>o.parentResult).map(o=>o.parentResult);return Xf([e,...t,...r],o=>o.uniqueId)}function eh(e){return e.childResults?e.childResults.flatMap(t=>[t,...eh(t)]):[]}function th(e,t){return {...new an(t).getBaseMetadata(),actionCause:e,type:e}}function mP(e){return Object.assign(e,{instantlyCallable:!0})}function fP(e,t){let r=a=>mP(N(e,a)),n=r(async(a,{getState:i,extra:s})=>{let{analyticsClientMiddleware:c,preprocessRequest:u,logger:l}=s;return await(await t({getState:i,analyticsClientMiddleware:c,preprocessRequest:u,logger:l})).log({state:i(),extra:s})});return Object.assign(n,{prepare:async({getState:a,analyticsClientMiddleware:i,preprocessRequest:s,logger:c})=>{let{description:u,log:l}=await t({getState:a,analyticsClientMiddleware:i,preprocessRequest:s,logger:c});return {description:u,action:r(async(d,{getState:p,extra:m})=>await l({state:p(),extra:m}))}}}),n}var Gc=(e,t,r)=>{function n(...o){let a=o.length===1?{...o[0],__legacy__getBuilder:t(o[0].__legacy__getBuilder),analyticsConfigurator:e,providerClass:r}:{prefix:o[0],__legacy__getBuilder:t(o[1]),__legacy__provider:o[2],analyticsConfigurator:e,providerClass:r};return hP(a)}return n},gP=e=>e.configuration.analytics.analyticsMode==="legacy",SP=e=>e.configuration.analytics.analyticsMode==="next",hP=({prefix:e,__legacy__getBuilder:t,__legacy__provider:r,analyticsPayloadBuilder:n,analyticsType:o,analyticsConfigurator:a,providerClass:i})=>(r??(r=s=>new i(s)),fP(e,async({getState:s,analyticsClientMiddleware:c,preprocessRequest:u,logger:l})=>{let d=[],p={log:async({state:A})=>{for(let w of d)await w(A);}},m=s(),S=a({getState:s,logger:l,analyticsClientMiddleware:c,preprocessRequest:u,provider:r(s)}),F=await t(S,s());p.description=F?.description,d.push(async A=>{gP(A)&&await yP(F,r,A,l,S.coveoAnalyticsClient);});let{emit:y}=Yi(m);return d.push(async A=>{if(SP(A)&&o&&n){let w=n(A);await PP(y,o,w);}}),p}));async function yP(e,t,r,n,o){t(()=>r);let a=await e?.log({searchUID:t(()=>r).getSearchUID()});n.info({client:o,response:a},"Analytics response");}var b=Gc(ZS,e=>e,an);var rh=Gc(XS,e=>e,Yn);var xe=(e,t)=>{let r=a=>a+(t.pagination?.firstResult??0),n=-1,o=t.search?.results;return n=oh(e,o),n<0&&(n=vP(e,o)),n<0&&(n=0),xP(e,r(n),t)};function xP(e,t,r){let n=e.raw.collection;return {collectionName:typeof n=="string"?n:"default",documentAuthor:RP(e),documentPosition:t+1,documentTitle:e.title,documentUri:e.uri,documentUriHash:e.raw.urihash,documentUrl:e.clickUri,rankingModifier:e.rankingModifier||"",sourceName:bP(e),queryPipeline:r.pipeline||Qt()}}var Fe=e=>(e.raw.permanentid||console.warn("Missing field permanentid on result. This might cause many issues with your Coveo deployment. See https://docs.coveo.com/en/1913 and https://docs.coveo.com/en/1640 for more information.",e),{contentIDKey:"permanentid",contentIDValue:e.raw.permanentid||""}),nh={urihash:new x,sourcetype:new x,permanentid:new x},os={uniqueId:P,raw:new E({values:nh}),title:P,uri:P,clickUri:P,rankingModifier:new x({required:!1,emptyAllowed:!0})};function FP(e){return Object.assign({},...Object.keys(nh).map(t=>({[t]:e[t]})))}function AP(e){return Object.assign({},...Object.keys(os).map(t=>({[t]:e[t]})),{raw:FP(e.raw)})}function RP(e){let t=e.raw.author;return M(t)?"unknown":Array.isArray(t)?t.join(";"):`${t}`}function bP(e){let t=e.raw.source;return M(t)?"unknown":t}var Ke=e=>new $(os).validate(AP(e));function vP(e,t){for(let[r,n]of t.entries()){let o=zc(n);if(oh(e,o)!==-1)return r}return -1}function oh(e,t=[]){return t.findIndex(({uniqueId:r})=>r===e.uniqueId)}async function PP(e,t,r){await e(t,r);}var Wc=()=>b("analytics/interface/load",e=>e.makeInterfaceLoad()),sn=()=>b("analytics/interface/change",(e,t)=>e.makeInterfaceChange({interfaceChangeTo:t.configuration.analytics.originLevel2})),Yc=()=>b("analytics/interface/searchFromLink",e=>e.makeSearchFromLink()),Kc=e=>b("analytics/interface/omniboxFromLink",t=>t.makeOmniboxFromLink(e)),ch=()=>({actionCause:"interfaceLoad"}),Ho=()=>({actionCause:"interfaceChange"}),uh=()=>({actionCause:"searchFromLink"}),lh=()=>({actionCause:"omniboxFromLink"});var Xp=()=>re,dh=()=>P,$t=f("configuration/updateBasicConfiguration",e=>g(e,{accessToken:re,organizationId:re,platformUrl:re})),gt=f("configuration/updateSearchConfiguration",e=>g(e,{apiBaseUrl:re,pipeline:new x({required:!1,emptyAllowed:!0}),searchHub:re,timezone:re,locale:re,authenticationProviders:new B({required:!1,each:P})})),wP={enabled:new Q({default:!0}),originContext:Xp(),originLevel2:Xp(),originLevel3:Xp(),apiBaseUrl:re,nextApiBaseUrl:re,runtimeEnvironment:new se,anonymous:new Q({default:!1}),deviceId:re,userDisplayName:re,documentLocation:re,trackingId:re,analyticsMode:new x({constrainTo:["legacy","next"],required:!1,default:"legacy"}),source:new E({options:{required:!1},values:hS.reduce((e,t)=>(e[t]=dS,e),{})})},cn=f("configuration/updateAnalyticsConfiguration",e=>(Ks()&&(e.enabled=!1),g(e,wP))),zo=f("configuration/analytics/disable"),Go=f("configuration/analytics/enable"),Jc=f("configuration/analytics/originlevel2",e=>g(e,{originLevel2:dh()})),Xc=f("configuration/analytics/originlevel3",e=>g(e,{originLevel3:dh()}));var Zc={q:new x,enableQuerySyntax:new Q,aq:new x,cq:new x,firstResult:new I({min:0}),numberOfResults:new I({min:0}),sortCriteria:new x,f:new E,fExcluded:new E,cf:new E,nf:new E,df:new E,debug:new Q,sf:new E,tab:new x,af:new E};var oe=f("searchParameters/restore",e=>g(e,Zc));var un=f("debug/enable"),Wo=f("debug/disable");var Yo=k(Mt(),e=>{e.addCase(un,()=>!0).addCase(Wo,()=>!1).addCase(oe,(t,r)=>r.payload.debug??t);});var Zp=f("history/undo"),em=f("history/redo"),ut=f("history/snapshot"),as=N("history/back",async(e,{dispatch:t})=>{t(Zp()),await t(ne());}),eu=N("history/forward",async(e,{dispatch:t})=>{t(em()),await t(ne());}),ne=N("history/change",async(e,{getState:t})=>t().history.present);var Ko=f("pipeline/set",e=>g(e,new x({required:!0,emptyAllowed:!0})));var Jo=k(Qt(),e=>{e.addCase(Ko,(t,r)=>r.payload).addCase(ne.fulfilled,(t,r)=>r.payload?.pipeline??t).addCase(gt,(t,r)=>r.payload.pipeline||t);});var Xo=f("searchHub/set",e=>g(e,new x({required:!0,emptyAllowed:!0})));var Zo=k(pt(),e=>{e.addCase(Xo,(t,r)=>r.payload).addCase(ne.fulfilled,(t,r)=>r.payload?.searchHub??t).addCase(gt,(t,r)=>r.payload.searchHub||t);});var le=f("breadcrumb/deselectAll"),Ht=f("breadcrumb/deselectAllNonBreadcrumbs");var Je=f("facet/updateFacetAutoSelection",e=>g(e,{allow:new Q({required:!0})}));var is=class extends an{constructor(r){super(r);this.getState=r;}get activeInstantResultQuery(){let r=this.getState().instantResults;for(let n in r)for(let o in r[n].cache)if(r[n].cache[o].isActive)return r[n].q;return null}get activeInstantResultCache(){let r=this.getState().instantResults;for(let n in r)for(let o in r[n].cache)if(r[n].cache[o].isActive)return r[n].cache[o];return null}get results(){return this.activeInstantResultCache?.results}get queryText(){return this.activeInstantResultQuery??ge().q}get responseTime(){return this.activeInstantResultCache?.duration??je().duration}get numberOfResults(){return this.activeInstantResultCache?.totalCountFiltered??je().response.totalCountFiltered}getSearchUID(){return this.activeInstantResultCache?.searchUid||super.getSearchUID()}};var ph=e=>b({prefix:"analytics/instantResult/open",__legacy__getBuilder:(t,r)=>(Ke(e),t.makeDocumentOpen(xe(e,r),Fe(e))),__legacy__provider:t=>new is(t),analyticsType:"itemClick",analyticsPayloadBuilder:t=>{let r=xe(e,t),n=Fe(e);return {searchUid:t.search?.response.searchUid??"",position:r.documentPosition,actionCause:"open",itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}}),mh=()=>b("analytics/instantResult/searchboxAsYouType",e=>e.makeSearchboxAsYouType(),e=>new is(e)),fh=()=>({actionCause:"searchboxAsYouType"});var tm={id:P},EP={...tm,q:ce},ea=f("instantResults/register",e=>g(e,tm)),zt=f("instantResults/updateQuery",e=>g(e,EP)),ta=f("instantResults/clearExpired",e=>g(e,tm));var tu=new I({required:!0,min:0}),ra=f("pagination/registerNumberOfResults",e=>g(e,tu)),na=f("pagination/updateNumberOfResults",e=>g(e,tu)),oa=f("pagination/registerPage",e=>g(e,tu)),Xe=f("pagination/updatePage",e=>g(e,tu)),aa=f("pagination/nextPage"),ia=f("pagination/previousPage");var Me=f("query/updateQuery",e=>g(e,{q:new x,enableQuerySyntax:new Q}));var ln=async(e,t)=>{let r=e.analyticsMode==="next";return {analytics:{clientId:await we(e),clientTimestamp:new Date().toISOString(),documentReferrer:e.originLevel3,originContext:e.originContext,...t&&{actionCause:t.actionCause,customData:t.customData},...t&&!r&&{customData:t.customData},...e.userDisplayName&&{userDisplayName:e.userDisplayName},...e.documentLocation&&{documentLocation:e.documentLocation},...e.deviceId&&{deviceId:e.deviceId},...Kp()&&{pageId:Kp()},...r&&e.trackingId&&{trackingId:e.trackingId},capture:r,...r&&{source:Tc(e)}}}};var sa=async(e,t)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await we(e.configuration.analytics),actionsHistory:Ye.getHistory()},...e.advancedSearchQueries?.aq&&{aq:e.advancedSearchQueries.aq},...e.advancedSearchQueries?.cq&&{cq:e.advancedSearchQueries.cq},...e.advancedSearchQueries?.lq&&{lq:e.advancedSearchQueries.lq},...e.advancedSearchQueries?.dq&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await ln(e.configuration.analytics,t),...e.excerptLength&&!M(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});var ca=async(e,t)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await we(e.configuration.analytics),actionsHistory:Ye.getHistory()},...e.advancedSearchQueries?.aq&&{aq:e.advancedSearchQueries.aq},...e.advancedSearchQueries?.cq&&{cq:e.advancedSearchQueries.cq},...e.advancedSearchQueries?.lq&&{lq:e.advancedSearchQueries.lq},...e.advancedSearchQueries?.dq&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await ln(e.configuration.analytics,t),...e.excerptLength&&!M(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});var rm=()=>b("search/logFetchMoreResults",e=>e.makeFetchMoreResults()),Ve=e=>b("search/queryError",(t,r)=>t.makeQueryError({query:r.query?.q||ge().q,aq:r.advancedSearchQueries?.aq||nt().aq,cq:r.advancedSearchQueries?.cq||nt().cq,dq:r.advancedSearchQueries?.dq||nt().dq,errorType:e.type,errorMessage:e.message}));var us=He(Hs()),Ch=He(gh());var ru=He(Hs()),hh=He(Sh());ru.default.extend(hh.default);var ss="YYYY/MM/DD@HH:mm:ss",IP="1401-01-01";function Kn(e,t){let r=(0, ru.default)(e,t);return !r.isValid()&&!t?(0, ru.default)(e,ss):r}function cs(e){return e.format(ss)}function yh(e){return cs(Kn(e))===e}function nu(e,t){let r=Kn(e,t);if(!r.isValid()){let n=". Please provide a date format string in the configuration options. See https://day.js.org/docs/en/parse/string-format for more information.",o=` with the format "${t}"`;throw new Error(`Could not parse the provided date "${e}"${t?o:n}`)}sm(r);}function sm(e){if(e.isBefore(IP))throw new Error(`Date is before year 1401, which is unsupported by the API: ${e}`)}us.default.extend(Ch.default);var xh=["past","now","next"],Fh=["minute","hour","day","week","month","quarter","year"],kP=e=>{let t=e==="now";return {amount:new I({required:!t,min:1}),unit:new x({required:!t,constrainTo:Fh}),period:new x({required:!0,constrainTo:xh})}};function Jn(e){if(typeof e=="string"&&!Gt(e))throw new Error(`The value "${e}" is not respecting the relative date format "period-amount-unit"`);let t=typeof e=="string"?cm(e):e;new $(kP(t.period)).validate(t);let r=Rh(t),n=JSON.stringify(t);if(!r.isValid())throw new Error(`Date is invalid: ${n}`);sm(r);}function Ah(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":case"next":return `${t}-${r}-${n}`;case"now":return t}}function Rh(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":return (0, us.default)().subtract(r,n);case"next":return (0, us.default)().add(r,n);case"now":return (0, us.default)()}}function ls(e){return cs(Rh(cm(e)))}function bh(e){return e.toLocaleLowerCase().split("-")}function Gt(e){let[t,r,n]=bh(e);if(t==="now")return !0;if(!xh.includes(t)||!Fh.includes(n))return !1;let o=parseInt(r);return !(isNaN(o)||o<=0)}function vh(e){return !!e&&typeof e=="object"&&"period"in e}function cm(e){let[t,r,n]=bh(e);return t==="now"?{period:"now"}:{period:t,amount:r?parseInt(r):void 0,unit:n||void 0}}function OP(e){return Jn(e),cm(e)}function Ph(e){return e.type==="dateRange"}function wh(e){return `start${e}`}function Eh(e){return `end${e}`}var TP=()=>({dateFacetValueMap:{}});function qP(e,t,r){let n=e.start,o=e.end;return Gt(n)&&(n=ls(n),r.dateFacetValueMap[t][wh(n)]=e.start),Gt(o)&&(o=ls(o),r.dateFacetValueMap[t][Eh(o)]=e.end),{...e,start:n,end:o}}function DP(e,t){if(Ph(e)){let{facetId:r,currentValues:n}=e;return t.dateFacetValueMap[r]={},{...e,currentValues:n.map(o=>qP(o,r,t))}}return e}function ua(e){let t=TP();return {request:{...e,facets:e.facets?.map(n=>DP(n,t))},mappings:t}}function VP(e,t,r){return {...e,start:r.dateFacetValueMap[t][wh(e.start)]||e.start,end:r.dateFacetValueMap[t][Eh(e.end)]||e.end}}function NP(e,t){return e.facetId in t.dateFacetValueMap}function LP(e,t){return NP(e,t)?{...e,values:e.values.map(r=>VP(r,e.facetId,t))}:e}function ou(e,t){return "success"in e?{success:{...e.success,facets:e.success.facets?.map(n=>LP(n,t))}}:e}function la(e,t){let r={};e.forEach(a=>r[a.facetId]=a);let n=[];t.forEach(a=>{a in r&&(n.push(r[a]),delete r[a]);});let o=Object.values(r);return [...n,...o]}function Vr(e){return Object.values(e).map(t=>t.request)}var Ae=async(e,t)=>{let r=$P(e),n=MP(e),o=QP(e),a=e.configuration.analytics.analyticsMode==="legacy"?await ca(e,t):await sa(e,t),i=()=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0;return ua({...a,...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="next",options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="legacy"},...r&&{cq:r},...n.length&&{facets:n},...e.pagination&&{numberOfResults:i(),firstResult:e.pagination.firstResult},...e.facetOptions&&{facetOptions:{freezeFacetOrder:e.facetOptions.freezeFacetOrder}},...e.folding?.enabled&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.automaticFacetSet&&{generateAutomaticFacets:{desiredCount:e.automaticFacetSet.desiredCount,numberOfValues:e.automaticFacetSet.numberOfValues,currentFacets:o}},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})};function MP(e){return la(UP(e),e.facetOrder??[])}function QP(e){let t=e.automaticFacetSet?.set;return t?Object.values(t).map(r=>r.response).map(BP).filter(r=>r.currentValues.length>0):void 0}function BP(e){let{field:t,label:r,values:n}=e,o=n.filter(a=>a.state==="selected");return {field:t,label:r,currentValues:o}}function UP(e){return _P(e).filter(({facetId:t})=>e.facetOptions?.facets[t]?.enabled??!0)}function _P(e){return [...jP(e.facetSet??{}),...Ih(e.numericFacetSet??{}),...Ih(e.dateFacetSet??{}),...Vr(e.categoryFacetSet??{})]}function jP(e){return Vr(e).map(t=>t.sortCriteria==="alphanumericDescending"?{...t,sortCriteria:{type:"alphanumeric",order:"descending"}}:t)}function Ih(e){return Vr(e).map(t=>{let n=t.currentValues.some(({state:o})=>o!=="idle");return t.generateAutomaticRanges&&!n?{...t,currentValues:[]}:t})}function $P(e){let t=e.advancedSearchQueries?.cq.trim()||"",n=Object.values(e.tabSet||{}).find(a=>a.isActive)?.expression.trim()||"",o=HP(e);return [t,n,...o].filter(a=>!!a).join(" AND ")}function HP(e){return Object.values(e.staticFilterSet||{}).map(r=>{let n=r.values.filter(a=>a.state==="selected"&&!!a.expression.trim()),o=n.map(a=>a.expression).join(" OR ");return n.length>1?`(${o})`:o})}var da=f("didYouMean/enable"),iu=f("didYouMean/disable"),pa=f("didYouMean/automaticCorrections/disable"),su=f("didYouMean/automaticCorrections/enable"),St=f("didYouMean/correction",e=>g(e,P)),ma=f("didYouMean/automaticCorrections/mode",e=>g(e,new x({constrainTo:["next","legacy"],emptyAllowed:!1,required:!0})));var cu=()=>b("analytics/didyoumean/click",e=>e.makeDidYouMeanClick()),um=()=>b("analytics/didyoumean/automatic",e=>e.makeDidYouMeanAutomatic()),kh=()=>({actionCause:"didyoumeanClick"}),Oh=()=>({actionCause:"didyoumeanAutomatic"});var zP=new E({values:{undoneQuery:ce},options:{required:!0}}),uu=()=>b("analytics/trigger/query",(e,t)=>t.triggers?.queryModification.newQuery?e.makeTriggerQuery():null),lu=e=>b("analytics/trigger/query/undo",t=>(g(e,zP),t.makeUndoTriggerQuery(e))),du=()=>b("analytics/trigger/notify",(e,t)=>t.triggers?.notifications.length?e.makeTriggerNotify({notifications:t.triggers.notifications}):null),Th=()=>({actionCause:"undoQuery"});var dn=f("trigger/query/ignore",e=>g(e,new x({emptyAllowed:!0,required:!0}))),fa=f("trigger/query/modification",e=>g(e,new E({values:{originalQuery:re,modification:re}})));var pn=class{constructor(t,r=n=>{this.dispatch(Me({q:n}));}){this.config=t;this.onUpdateQueryForCorrection=r;}async fetchFromAPI({mappings:t,request:r},n){let o=new Date().getTime(),a=ou(await this.extra.apiClient.search(r,n),t),i=new Date().getTime()-o,s=this.getState().query?.q||"";return {response:a,duration:i,queryExecuted:s,requestExecuted:r}}async process(t){return this.processQueryErrorOrContinue(t)??await this.processQueryCorrectionsOrContinue(t)??await this.processQueryTriggersOrContinue(t)??this.processSuccessResponse(t)}processQueryErrorOrContinue(t){return Pe(t.response)?(this.dispatch(Ve(t.response.error)),this.rejectWithValue(t.response.error)):null}async processQueryCorrectionsOrContinue(t){let r=this.getState(),n=this.getSuccessResponse(t);if(!n||!r.didYouMean)return null;let{enableDidYouMean:o,automaticallyCorrectQuery:a}=r.didYouMean,{results:i,queryCorrections:s,queryCorrection:c}=n;if(!o||!a)return null;let u=i.length===0&&s&&s.length!==0,l=!M(c)&&!M(c.correctedQuery);if(!u&&!l)return null;let p=u?await this.processLegacyDidYouMeanAutoCorrection(t):this.processModernDidYouMeanAutoCorrection(t);return this.dispatch(ut(vt(this.getState()))),p}async processLegacyDidYouMeanAutoCorrection(t){let r=this.getCurrentQuery(),n=this.getSuccessResponse(t);if(!n.queryCorrections)return null;let{correctedQuery:o}=n.queryCorrections[0],a=await this.automaticallyRetryQueryWithCorrection(o);return Pe(a.response)?(this.dispatch(Ve(a.response.error)),this.rejectWithValue(a.response.error)):(this.logOriginalAnalyticsQueryBeforeAutoCorrection(t),this.dispatch(ut(vt(this.getState()))),{...a,response:{...a.response.success,queryCorrections:n.queryCorrections},automaticallyCorrected:!0,originalQuery:r,analyticsAction:um()})}processModernDidYouMeanAutoCorrection(t){let r=this.getSuccessResponse(t),{correctedQuery:n,originalQuery:o}=r.queryCorrection;return this.onUpdateQueryForCorrection(n),{...t,response:{...r},queryExecuted:n,automaticallyCorrected:!0,originalQuery:o,analyticsAction:um()}}logOriginalAnalyticsQueryBeforeAutoCorrection(t){let r=this.getState(),n=this.getSuccessResponse(t);this.analyticsAction&&this.analyticsAction()(this.dispatch,()=>this.getStateAfterResponse(t.queryExecuted,t.duration,r,n),this.extra);}async processQueryTriggersOrContinue(t){let r=this.getSuccessResponse(t);if(!r)return null;let n=r.triggers.find(s=>s.type==="query")?.content||"";if(!n)return null;if(this.getState().triggers?.queryModification.queryToIgnore===n)return this.dispatch(dn("")),null;this.analyticsAction&&await this.dispatch(this.analyticsAction);let a=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(n);return Pe(i.response)?(this.dispatch(Ve(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(ut(vt(this.getState()))),{...i,response:{...i.response.success},automaticallyCorrected:!1,originalQuery:a,analyticsAction:uu()})}getStateAfterResponse(t,r,n,o){return {...n,query:{q:t,enableQuerySyntax:n.query?.enableQuerySyntax??ge().enableQuerySyntax},search:{...je(),duration:r,response:o,results:o.results}}}processSuccessResponse(t){return this.dispatch(ut(vt(this.getState()))),{...t,response:this.getSuccessResponse(t),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(t){return kc(t.response)?t.response.success:null}async automaticallyRetryQueryWithCorrection(t){this.onUpdateQueryForCorrection(t);let r=await this.fetchFromAPI(await Ae(this.getState()),{origin:"mainSearch"});return this.dispatch(St(t)),r}async automaticallyRetryQueryWithTriggerModification(t){return this.dispatch(fa({newQuery:t,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(t),await this.fetchFromAPI(await Ae(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){let t=this.getState();return t.query?.q!==void 0?t.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get analyticsAction(){return this.config.analyticsAction}get rejectWithValue(){return this.config.rejectWithValue}};N("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;g(e,{q:new x,enableQuerySyntax:new Q,clearFilters:new Q}),e.clearFilters&&(r(le()),r(Ht())),r(Je({allow:!0})),r(Me({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(Xe(1));});var ga=N("search/executeSearch",async(e,t)=>{let r=t.getState();return await gu(r,t,e)}),Sa=N("search/fetchPage",async(e,t)=>{let r=t.getState();return await dm(r,t,e)}),ha=N("search/fetchMoreResults",async(e,t)=>{let r=t.getState();return await pm(t,r)}),fu=N("search/fetchFacetValues",async(e,t)=>{let r=t.getState();return await KP(t,e,r)});N("search/fetchInstantResults",async(e,t)=>lm(e,t));var GP=async(e,t)=>{let r=await Ae(e,t);return r.request={...r.request,firstResult:(e.pagination?.firstResult??0)+(e.search?.results.length??0)},r},WP=async(e,t,r)=>{let n=await ca(e);return ua({...n,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},YP=async(e,t)=>{let r=await Ae(e,t);return r.request.numberOfResults=0,r},Dh=e=>{e.configuration.analytics.enabled&&Ye.addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)});};async function lm(e,t){g(e,{id:P,q:P,maxResultsPerQuery:new I({required:!0,min:1}),cacheTimeout:new I});let{q:r,maxResultsPerQuery:n}=e,o=t.getState(),a=new pn({...t,analyticsAction:mh()},u=>{t.dispatch(zt({q:u,id:e.id}));}),i=await WP(o,r,n),s=await a.fetchFromAPI(i,{origin:"instantResults",disableAbortWarning:!0}),c=await a.process(s);return "response"in c?{results:c.response.results,searchUid:c.response.searchUid,analyticsAction:c.analyticsAction,totalCountFiltered:c.response.totalCountFiltered,duration:c.duration}:c}async function dm(e,t,r){Dh(e);let{analyticsClientMiddleware:n,preprocessRequest:o,logger:a}=t.extra,{description:i}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:o,logger:a}),s=new pn({...t,analyticsAction:r}),c=await Ae(e,i),u=await s.fetchFromAPI(c,{origin:"mainSearch"});return await s.process(u)}async function pm(e,t){let{analyticsClientMiddleware:r,preprocessRequest:n,logger:o}=e.extra,{description:a}=await rm().prepare({getState:()=>e.getState(),analyticsClientMiddleware:r,preprocessRequest:n,logger:o}),i=new pn({...e,analyticsAction:rm()}),s=await GP(t,a),c=await i.fetchFromAPI(s,{origin:"mainSearch"});return await i.process(c)}async function KP(e,t,r){let{analyticsClientMiddleware:n,preprocessRequest:o,logger:a}=e.extra,{description:i}=await t.prepare({getState:()=>e.getState(),analyticsClientMiddleware:n,preprocessRequest:o,logger:a}),s=new pn({...e,analyticsAction:t}),c=await YP(r,i),u=await s.fetchFromAPI(c,{origin:"facetValues"});return await s.process(u)}async function gu(e,t,r){Dh(e);let{analyticsClientMiddleware:n,preprocessRequest:o,logger:a}=t.extra,{description:i}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:o,logger:a}),s=await Ae(e,i),c=new pn({...t,analyticsAction:r}),u=await c.fetchFromAPI(s,{origin:"mainSearch"});return await c.process(u)}var mn=class{constructor(t,r=n=>{this.dispatch(Me({q:n}));}){this.config=t;this.onUpdateQueryForCorrection=r;}async fetchFromAPI({mappings:t,request:r},n){let o=new Date().getTime(),a=ou(await this.extra.apiClient.search(r,n),t),i=new Date().getTime()-o,s=this.getState().query?.q||"";return {response:a,duration:i,queryExecuted:s,requestExecuted:r}}async process(t){return this.processQueryErrorOrContinue(t)??await this.processQueryCorrectionsOrContinue(t)??await this.processQueryTriggersOrContinue(t)??this.processSuccessResponse(t)}processQueryErrorOrContinue(t){return Pe(t.response)?(this.dispatch(Ve(t.response.error)),this.rejectWithValue(t.response.error)):null}async processQueryCorrectionsOrContinue(t){let r=this.getState(),n=this.getSuccessResponse(t);if(!n||!r.didYouMean)return null;let{enableDidYouMean:o,automaticallyCorrectQuery:a}=r.didYouMean,{results:i,queryCorrections:s,queryCorrection:c}=n;if(!o||!a)return null;let u=i.length===0&&s&&s.length!==0,l=!M(c)&&!M(c.correctedQuery);if(!u&&!l)return null;let p=u?await this.processLegacyDidYouMeanAutoCorrection(t):this.processModernDidYouMeanAutoCorrection(t);return this.dispatch(ut(vt(this.getState()))),p}async processLegacyDidYouMeanAutoCorrection(t){let r=this.getCurrentQuery(),n=this.getSuccessResponse(t);if(!n.queryCorrections)return null;let{correctedQuery:o}=n.queryCorrections[0],a=await this.automaticallyRetryQueryWithCorrection(o);return Pe(a.response)?(this.dispatch(Ve(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(ut(vt(this.getState()))),{...a,response:{...a.response.success,queryCorrections:n.queryCorrections},automaticallyCorrected:!0,originalQuery:r})}processModernDidYouMeanAutoCorrection(t){let r=this.getSuccessResponse(t),{correctedQuery:n,originalQuery:o}=r.queryCorrection;return this.onUpdateQueryForCorrection(n),{...t,response:{...r},queryExecuted:n,automaticallyCorrected:!0,originalQuery:o}}async processQueryTriggersOrContinue(t){let r=this.getSuccessResponse(t);if(!r)return null;let n=r.triggers.find(s=>s.type==="query")?.content||"";if(!n)return null;if(this.getState().triggers?.queryModification.queryToIgnore===n)return this.dispatch(dn("")),null;let a=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(n);return Pe(i.response)?(this.dispatch(Ve(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(ut(vt(this.getState()))),{...i,response:{...i.response.success},automaticallyCorrected:!1,originalQuery:a})}processSuccessResponse(t){return this.dispatch(ut(vt(this.getState()))),{...t,response:this.getSuccessResponse(t),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery()}}getSuccessResponse(t){return kc(t.response)?t.response.success:null}async automaticallyRetryQueryWithCorrection(t){this.onUpdateQueryForCorrection(t);let r=this.getState(),{actionCause:n}=Oh(),o=await this.fetchFromAPI(await Ae(r,{actionCause:n}),{origin:"mainSearch"});return this.dispatch(St(t)),o}async automaticallyRetryQueryWithTriggerModification(t){return this.dispatch(fa({newQuery:t,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(t),await this.fetchFromAPI(await Ae(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){let t=this.getState();return t.query?.q!==void 0?t.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}};var Su=N("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;g(e,{q:new x,enableQuerySyntax:new Q,clearFilters:new Q}),e.clearFilters&&(r(le()),r(Ht())),r(Je({allow:!0})),r(Me({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(Xe(1));}),R=N("search/executeSearch",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return gu(r,t,e.legacy);Vh(r);let n=mm(e.next),o=await Ae(r,n),a=new mn({...t,analyticsAction:n}),i=await a.fetchFromAPI(o,{origin:"mainSearch"});return await a.process(i)}),Wt=N("search/fetchPage",async(e,t)=>{let r=t.getState();if(Vh(r),r.configuration.analytics.analyticsMode==="legacy"||!e.next)return dm(r,t,e.legacy);let n=new mn({...t,analyticsAction:e.next}),o=await Ae(r,e.next),a=await n.fetchFromAPI(o,{origin:"mainSearch"});return await n.process(a)}),fn=N("search/fetchMoreResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return pm(t,r);let n=th("pagerScrolling",t.getState),o=new mn({...t,analyticsAction:n}),a=await JP(r,n),i=await o.fetchFromAPI(a,{origin:"mainSearch"});return await o.process(i)}),Yt=N("search/fetchFacetValues",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return gu(r,t,e.legacy);let n=mm(e.next),o=new mn({...t,analyticsAction:n}),a=await ZP(r,n),i=await o.fetchFromAPI(a,{origin:"facetValues"});return await o.process(i)}),ya=N("search/fetchInstantResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return lm(e,t);g(e,{id:P,q:P,maxResultsPerQuery:new I({required:!0,min:1}),cacheTimeout:new I});let{q:n,maxResultsPerQuery:o}=e,a=mm(fh()),i=await XP(r,n,o,a),s=new mn({...t,analyticsAction:a},l=>{t.dispatch(zt({q:l,id:e.id}));}),c=await s.fetchFromAPI(i,{origin:"instantResults",disableAbortWarning:!0}),u=await s.process(c);return "response"in u?{results:u.response.results,searchUid:u.response.searchUid,totalCountFiltered:u.response.totalCountFiltered,duration:u.duration}:u}),JP=async(e,t)=>{let r=await Ae(e,t);return r.request={...r.request,firstResult:(e.pagination?.firstResult??0)+(e.search?.results.length??0)},r},XP=async(e,t,r,n)=>{let o=await sa(e,n);return ua({...o,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},ZP=async(e,t)=>{let r=await Ae(e,t);return r.request.numberOfResults=0,r},Vh=e=>{e.configuration.analytics.enabled&&Ye.addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)});},mm=e=>({actionCause:e.actionCause,type:e.actionCause});var gn=(e,t)=>{let r=e;return M(r[t])?M(e.raw[t])?null:e.raw[t]:r[t]},ew=e=>t=>e.every(r=>!M(gn(t,r))),tw=e=>t=>e.every(r=>M(gn(t,r))),rw=(e,t)=>r=>{let n=Nh(e,r);return t.some(o=>n.some(a=>`${a}`.toLowerCase()===o.toLowerCase()))},nw=(e,t)=>r=>{let n=Nh(e,r);return t.every(o=>n.every(a=>`${a}`.toLowerCase()!==o.toLowerCase()))},Nh=(e,t)=>{let r=gn(t,e);return Gs(r)?r:[r]},ow={getResultProperty:gn,fieldsMustBeDefined:ew,fieldsMustNotBeDefined:tw,fieldMustMatch:rw,fieldMustNotMatch:nw};function ds(e){return e.search.response.searchUid!==""}function Lh(e,t,r){return e.search.results.find(n=>gn(n,t)===r)}function fm(e,t){let r=t.payload??null;r&&(e.response=je().response,e.results=[],e.questionAnswer=Do()),e.error=r,e.isLoading=!1;}function Sm(e,t){e.error=null,e.response=t.payload.response,e.queryExecuted=t.payload.queryExecuted,e.duration=t.payload.duration,e.isLoading=!1;}function aw(e,t){Sm(e,t),e.results=t.payload.response.results,e.searchResponseId=t.payload.response.searchUid,e.questionAnswer=t.payload.response.questionAnswer,e.extendedResults=t.payload.response.extendedResults;}function gm(e,t){e.isLoading=!0,e.requestId=t.meta.requestId;}var j=k(je(),e=>{e.addCase(ga.rejected,(t,r)=>fm(t,r)),e.addCase(ha.rejected,(t,r)=>fm(t,r)),e.addCase(Sa.rejected,(t,r)=>fm(t,r)),e.addCase(ga.fulfilled,(t,r)=>{aw(t,r);}),e.addCase(ha.fulfilled,(t,r)=>{Sm(t,r),t.results=[...t.results,...r.payload.response.results];}),e.addCase(Sa.fulfilled,(t,r)=>{Sm(t,r),t.results=r.payload.response.results;}),e.addCase(fu.fulfilled,(t,r)=>{t.response.facets=r.payload.response.facets,t.response.searchUid=r.payload.response.searchUid;}),e.addCase(ga.pending,gm),e.addCase(ha.pending,gm),e.addCase(Sa.pending,gm);});var Mh=k(Gn,e=>e);function Qh(){return typeof window<"u"&&typeof document<"u"}function iw(e){let t=e.payload?.analyticsAction;return Bh(e)&&!M(t)}function Bh(e){return "type"in e}var Uh=e=>t=>r=>{let n;iw(r)&&(n=r.payload.analyticsAction,delete r.payload.analyticsAction);let o=t(r);return Bh(r)&&(r.type==="search/executeSearch/fullfilled"&&n===void 0&&console.error("No analytics action associated with search:",r),r.type==="recommendation/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with recommendation:",r),r.type==="productRecommendations/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with product recommendation:",r)),n!==void 0&&e.dispatch(n),o};var $h=He(jh());var Ca=f("tab/register",e=>{let t=new E({values:{id:P,expression:ce}});return g(e,t)}),kt=f("tab/updateActiveTab",e=>g(e,P));function cw(e,t){if(tS(e))return e.replace(/^(https:\/\/)platform/,"$1analytics")+Jd;let n=rS(e,t);return n?Li(t,n.environment).analytics:e}var hu=k(Wr(),e=>e.addCase($t,(t,r)=>{r.payload.accessToken&&(t.accessToken=r.payload.accessToken),r.payload.organizationId&&(t.organizationId=r.payload.organizationId),r.payload.platformUrl&&(t.platformUrl=r.payload.platformUrl,t.search.apiBaseUrl=`${r.payload.platformUrl}${Kd}`,t.analytics.apiBaseUrl=cw(r.payload.platformUrl,t.organizationId));}).addCase(gt,(t,r)=>{r.payload.apiBaseUrl&&(t.search.apiBaseUrl=r.payload.apiBaseUrl),r.payload.locale&&(t.search.locale=r.payload.locale),r.payload.timezone&&(t.search.timezone=r.payload.timezone),r.payload.authenticationProviders&&(t.search.authenticationProviders=r.payload.authenticationProviders);}).addCase(cn,(t,r)=>{M(r.payload.enabled)||(t.analytics.enabled=r.payload.enabled),M(r.payload.originContext)||(t.analytics.originContext=r.payload.originContext),M(r.payload.originLevel2)||(t.analytics.originLevel2=r.payload.originLevel2),M(r.payload.originLevel3)||(t.analytics.originLevel3=r.payload.originLevel3),M(r.payload.apiBaseUrl)||(t.analytics.apiBaseUrl=r.payload.apiBaseUrl),M(r.payload.nextApiBaseUrl)||(t.analytics.nextApiBaseUrl=r.payload.nextApiBaseUrl),M(r.payload.trackingId)||(t.analytics.trackingId=r.payload.trackingId),M(r.payload.analyticsMode)||(t.analytics.analyticsMode=r.payload.analyticsMode),M(r.payload.source)||(t.analytics.source=r.payload.source);let n=(0, $h.default)();n&&(t.analytics.analyticsMode="next",t.analytics.trackingId=n),M(r.payload.runtimeEnvironment)||(t.analytics.runtimeEnvironment=r.payload.runtimeEnvironment),M(r.payload.anonymous)||(t.analytics.anonymous=r.payload.anonymous),M(r.payload.deviceId)||(t.analytics.deviceId=r.payload.deviceId),M(r.payload.userDisplayName)||(t.analytics.userDisplayName=r.payload.userDisplayName),M(r.payload.documentLocation)||(t.analytics.documentLocation=r.payload.documentLocation);}).addCase(zo,t=>{t.analytics.enabled=!1;}).addCase(Go,t=>{t.analytics.enabled=!0;}).addCase(Jc,(t,r)=>{t.analytics.originLevel2=r.payload.originLevel2;}).addCase(Xc,(t,r)=>{t.analytics.originLevel3=r.payload.originLevel3;}).addCase(kt,(t,r)=>{t.analytics.originLevel2=r.payload;}).addCase(oe,(t,r)=>{t.analytics.originLevel2=r.payload.tab||t.analytics.originLevel2;}));var L=hu;function uw(e){return e.instantlyCallable}var Hh=()=>e=>t=>e(uw(t)?t():t);var zh=e=>()=>t=>r=>{let n=r;if(!n.error)return t(r);let o=n.error;if(n.payload?.ignored||e.error(o.stack||o.message||o.name||"Error",`Action dispatch error ${n.type}`,r),n.error.name!=="SchemaValidationError")return t(r)},Gh=e=>t=>r=>n=>(e.debug({action:n,nextState:t.getState()},`Action dispatched: ${n.type}`),r(n));function Wh(e,t){let r={...e},n,o=a=>(i,s)=>{let c=a(i,s);return n?n(c,s):c};return {get combinedReducer(){let a=Zf(Object.entries(t).filter(([i])=>!(i in r)).map(([i,s])=>[i,()=>s]));return o(gc({...a,...r}))},containsAll(a){return Object.keys(a).every(s=>s in r)},add(a){Object.keys(a).filter(i=>!(i in r)).forEach(i=>r[i]=a[i]);},addCrossReducer(a){n=a;}}}function yu(e,t,r){var n,o,a;t===void 0&&(t=50),r===void 0&&(r={});var i=(n=r.isImmediate)!=null&&n,s=(o=r.callback)!=null&&o,c=r.maxWait,u=Date.now(),l=[];function d(){if(c!==void 0){var m=Date.now()-u;if(m+t>=c)return c-m}return t}var p=function(){var m=[].slice.call(arguments),S=this;return new Promise(function(F,y){var A=i&&a===void 0;if(a!==void 0&&clearTimeout(a),a=setTimeout(function(){if(a=void 0,u=Date.now(),!i){var V=e.apply(S,m);s&&s(V),l.forEach(function(U){return (0, U.resolve)(V)}),l=[];}},d()),A){var w=e.apply(S,m);return s&&s(w),F(w)}l.push({resolve:F,reject:y});})};return p.cancel=function(m){a!==void 0&&clearTimeout(a),l.forEach(function(S){return (0, S.reject)(m)}),l=[];},p}function Yh(e,t){let r=0,n=yu(()=>r=0,500);return o=>a=>async i=>{if(!(typeof i=="function"))return a(i);let c=await a(i);if(!lw(c))return c;if(typeof t!="function")return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),c;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),c;r++,n();let u=await dw(t);o.dispatch($t({accessToken:u})),o.dispatch(i);}}function lw(e){return e?.error?.name===new xo().name}async function dw(e){try{return await e()}catch{return ""}}function Kh({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:n,name:o}){return _g({reducer:e,preloadedState:t,devTools:{stateSanitizer:a=>a.history?{...a,history:"<<OMIT>>"}:a,name:o,shouldHotReload:!1},middleware:a=>a({thunk:{extraArgument:n}}).prepend(...r).concat(Gh(n.logger))})}var pw={configuration:L,version:Mh};function mw(e,t){let r=e.organizationEndpoints?.analytics||void 0,{analyticsClientMiddleware:n,...o}=e.analytics??{},a={...o,nextApiBaseUrl:`${r}/rest/organizations/${e.organizationId}/events/v1`,apiBaseUrl:r};if(Ks())return t.info("Analytics disabled since doNotTrack is active."),{...a,enabled:!1};if(a.analyticsMode==="next"&&!o.trackingId)throw new hm('analytics.trackingId is required when analytics.analyticsMode="next"');return a}function Jh(e,t){let r=fw(e,t),{accessToken:n,organizationId:o}=e.configuration,{organizationEndpoints:a}=e.configuration,i=a?.platform||e.configuration.platformUrl;yw(e.configuration)&&r.logger.warn(`The \`platformUrl\` (${e.configuration.platformUrl}) option will be deprecated in the next major version. Consider using the \`organizationEndpoints\` option instead. See [Organization endpoints](https://docs.coveo.com/en/mcc80216).`),hw(e.configuration)?r.logger.warn("The `organizationEndpoints` options was not explicitly set in the Headless engine configuration. Coveo recommends setting this option, as it has resiliency benefits and simplifies the overall configuration for multi-region deployments. See [Organization endpoints](https://docs.coveo.com/en/mcc80216)."):Cw(e.configuration)&&r.logger.warn(`There is a mismatch between the \`organizationId\` option (${e.configuration.organizationId}) and the organization configured in the \`organizationEndpoints\` option (${e.configuration.organizationEndpoints?.platform}). This could lead to issues that are complex to troubleshoot. Please make sure both values match.`),r.dispatch($t({accessToken:n,organizationId:o,platformUrl:i}));let s=mw(e.configuration,r.logger);return s&&r.dispatch(cn(s)),r}function fw(e,t){let{reducers:r}=e,n=Wh({...pw,...r},e.preloadedState??{});e.crossReducer&&n.addCrossReducer(e.crossReducer);let o=t.logger,a=e.navigatorContextProvider??Qh()?If:js,i={...t,get relay(){return Yi(c.state)},get navigatorContext(){return a()}},s=gw(e,i,n),c={addReducers(u){n.containsAll(u)||(n.add(u),s.replaceReducer(n.combinedReducer));},dispatch:s.dispatch,subscribe:s.subscribe,enableAnalytics(){s.dispatch(Go());},disableAnalytics(){s.dispatch(zo());},get state(){return s.getState()},get relay(){return Yi(this.state)},get navigatorContext(){return a()},logger:o,store:s};return c}function gw(e,t,r){let{preloadedState:n,configuration:o}=e,a=o.name||"coveo-headless",i=Sw(e,t.logger);return Kh({preloadedState:n,reducer:r.combinedReducer,middlewares:i,thunkExtraArguments:t,name:a})}function Sw(e,t){let{renewAccessToken:r}=e.configuration,n=Yh(t,r);return [Hh,n,zh(t),Uh].concat(e.middlewares||[])}function hw(e){return ye(e.organizationEndpoints)}function yw(e){return !M(e.platformUrl)||M(e.organizationEndpoints?.platform)}function Cw(e){let{platform:t}=e.organizationEndpoints;if(ye(t))return !1;let r=bp(t);return r&&r.organizationId!==e.organizationId}var hm=class extends Error{constructor(t){super(t),this.name="InvalidEngineConfiguration";}};var Xh=He(qd());function Zh(e){return (0, Xh.default)({name:"@coveo/headless",level:e?.level||"warn",formatters:{log:e?.logFormatter}})}function ey(e,t){let r=xw(e),n=mt,o=Fw(e);return {analyticsClientMiddleware:r,validatePayload:n,preprocessRequest:o,logger:t}}function xw(e){let{analytics:t}=e,r=(n,o)=>o;return t?.analyticsClientMiddleware||r}function Fw(e){return e.preprocessRequest||Ec}var ny=He(Wd());var ym=(e,t,r,n,o,a)=>{let i=e[t];M(i)||M(o)||o!==i&&o!==n&&(a.warn(`Mismatch on access token (JWT Token) ${t} and engine configuration.`),a.warn(`To remove this warning, make sure that access token value [${i}] matches engine configuration value [${r}]`));},Cm=(e,t)=>!(M(e)||t===e),ps=e=>{try{let t=typeof atob<"u"?atob:ny.atob,n=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),o=t(n);if(!o)return !1;let a=decodeURIComponent(o.split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(a)}catch{return !1}},oy=(e,t)=>(Cm(e.searchHub,t.searchHub)&&(t.searchHub=e.searchHub),t),ty=(e,t,r,n)=>(ym(e,"searchHub",t.searchHub,pt(),r,n),oy(e,t)),ay=(e,t)=>(Cm(e.pipeline,t.pipeline)&&(t.pipeline=e.pipeline),t),ry=(e,t,r,n)=>(ym(e,"pipeline",t.pipeline,Qt(),r,n),ay(e,t)),iy=(e,t)=>(Cm(e.userDisplayName,t.configuration.analytics.userDisplayName)&&(t.configuration.analytics.userDisplayName=e.userDisplayName),t),Aw=(e,t,r,n)=>(ym(e,"userDisplayName",t.configuration.analytics.userDisplayName,Wr().analytics.userDisplayName,r,n),iy(e,t)),sy=e=>k({},t=>{t.addCase(Xo,(r,n)=>{let o=ps(r.configuration.accessToken);return o?ty(o,r,n.payload,e):r}).addCase(Ko,(r,n)=>{let o=ps(r.configuration.accessToken);return o?ry(o,r,n.payload,e):r}).addCase($t,(r,n)=>{if(r.configuration.accessToken!==n.payload.accessToken)return r;let{accessToken:o}=n.payload;if(!o)return r;let a=ps(o);return a?[ay,oy,iy].reduce((i,s)=>s(a,i),r):r}).addCase(gt,(r,n)=>{let o=ps(r.configuration.accessToken);if(!o)return r;let a=ty(o,r,n.payload.searchHub,e);return ry(o,a,n.payload?.pipeline,e)}).addCase(cn,(r,n)=>{let o=ps(r.configuration.accessToken);return o?Aw(o,r,n.payload.userDisplayName,e):r});});var cy={organizationId:P,accessToken:P,platformUrl:new x({required:!1,emptyAllowed:!1}),name:new x({required:!1,emptyAllowed:!1}),analytics:new E({options:{required:!1},values:{enabled:new Q({required:!1}),originContext:new x({required:!1}),originLevel2:new x({required:!1}),originLevel3:new x({required:!1}),analyticsMode:new x({constrainTo:["legacy","next"],required:!1})}})};var ly=new $({...cy,search:new E({options:{required:!1},values:{pipeline:new x({required:!1,emptyAllowed:!0}),searchHub:re,locale:re,timezone:re,authenticationProviders:new B({required:!1,each:P})}})});var Rw={debug:Yo,pipeline:Jo,searchHub:Zo,search:j};function bw(e){let t=e.configuration.search,r=e.configuration.organizationEndpoints?.search||void 0;return {...t,apiBaseUrl:r}}function vw(e){let t=Zh(e.loggerOptions);Pw(e.configuration,t);let r=ww(e.configuration,t),n=Ew(t),o={...ey(e.configuration,t),apiClient:r,streamingClient:n},a={...e,reducers:Rw,crossReducer:sy(t)},i=Jh(a,o),s=bw(e);return s&&i.dispatch(gt(s)),{...i,get state(){return i.state},executeFirstSearch(c=Wc()){if(ds(i.state))return;let u=R({legacy:c,next:ch()});i.dispatch(u);},executeFirstSearchAfterStandaloneSearchBoxRedirect(c){let{cause:u,metadata:l}=c;if(ds(i.state))return;let d=l&&u==="omniboxFromLink",p=R({legacy:d?Kc(l):Yc(),next:d?lh():uh()});i.dispatch(p);}}}function Pw(e,t){try{ly.validate(e);}catch(r){throw t.error(r,"Search engine configuration error"),r}}function ww(e,t){let{search:r}=e;return new Ic({logger:t,preprocessRequest:e.preprocessRequest||Ec,postprocessSearchResponseMiddleware:r?.preprocessSearchResponseMiddleware||sS,postprocessFacetSearchResponseMiddleware:r?.preprocessFacetSearchResponseMiddleware||cS,postprocessQuerySuggestResponseMiddleware:r?.preprocessQuerySuggestResponseMiddleware||uS})}function Ew(e){return new wc({logger:e})}function O(e){let t,r=new Map,n=()=>r.size===0,o=a=>{try{let i=JSON.stringify(a),s=t!==i;return t=i,s}catch(i){return console.warn('Could not detect if state has changed, check the controller "get state method"',i),!0}};return {subscribe(a){a();let i=Symbol(),s;return n()&&(t=JSON.stringify(this.state),s=e.subscribe(()=>{o(this.state)&&r.forEach(c=>c());})),r.set(i,a),()=>{r.delete(i),n()&&s&&s();}},get state(){return {}}}}var Sn=f("fields/registerFieldsToInclude",e=>g(e,Oc)),xa=f("fields/fetchall/enable"),Xn=f("fields/fetchall/disable"),Fa=N("fields/fetchDescription",async(e,{extra:t,getState:r,rejectWithValue:n})=>{let o=r(),{accessToken:a,organizationId:i}=o.configuration,{apiBaseUrl:s}=o.configuration.search,c=await t.apiClient.fieldDescriptions({accessToken:a,organizationId:i,url:s});return Pe(c)?n(c.error):c.success.fields});var xm={collectionField:new x({emptyAllowed:!1,required:!1}),parentField:new x({emptyAllowed:!1,required:!1}),childField:new x({emptyAllowed:!1,required:!1}),numberOfFoldedResults:new I({min:0,required:!1})},hn=f("folding/register",e=>g(e,xm)),yn=N("folding/loadCollection",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let o=t(),a=o.configuration.analytics.analyticsMode==="legacy"?await ca(o):await sa(o),i=await n.search({...a,q:Ow(o),enableQuerySyntax:!0,cq:`@${o.folding.fields.collection}="${e}"`,filterField:o.folding.fields.collection,childField:o.folding.fields.parent,parentField:o.folding.fields.child,filterFieldRange:100},{origin:"foldingCollection"});return Pe(i)?r(i.error):{collectionId:e,results:i.success.results,rootResult:o.folding.collections[e].result}});function Ow(e){return e.query.q===""?"":e.query.enableQuerySyntax?`${e.query.q} OR @uri`:`( <@- ${e.query.q} -@> ) OR @uri`}var Cn=k(oc(),e=>e.addCase(Sn,(t,r)=>{t.fieldsToInclude=[...new Set(t.fieldsToInclude.concat(r.payload))];}).addCase(xa,t=>{t.fetchAllFields=!0;}).addCase(Xn,t=>{t.fetchAllFields=!1;}).addCase(Fa.fulfilled,(t,{payload:r})=>{t.fieldsDescription=r;}).addCase(hn,(t,{payload:r})=>{let n=wo().fields;t.fieldsToInclude.push(r.collectionField??n.collection,r.parentField??n.parent,r.childField??n.child);}));new $({enabled:new Q({default:!1})});var Vw=new B({each:P,required:!0}),Sy=(e,t)=>(g(e,P),Io(t)?g(t,P):g(t,Vw),{payload:{contextKey:e,contextValue:t}}),Zn=f("context/set",e=>{for(let[t,r]of Object.entries(e))Sy(t,r);return {payload:e}}),eo=f("context/add",e=>Sy(e.contextKey,e.contextValue)),to=f("context/remove",e=>g(e,P));k(Ao(),e=>{e.addCase(Zn,(t,r)=>{t.contextValues=r.payload;}).addCase(eo,(t,r)=>{t.contextValues[r.payload.contextKey]=r.payload.contextValue;}).addCase(to,(t,r)=>{delete t.contextValues[r.payload];}).addCase(ne.fulfilled,(t,r)=>{r.payload&&(t.contextValues=r.payload.context.contextValues);});});new $({values:new E({options:{required:!1}})});var Aa=f("dictionaryFieldContext/set",e=>{let t=new E({options:{required:!0}}),r=g(e,t).error;if(r)return {payload:e,error:r};let n=Object.values(e),o=new B({each:ce}),a=g(n,o).error;return a?{payload:e,error:a}:{payload:e}}),Ra=f("dictionaryFieldContext/add",e=>{let t=new E({options:{required:!0},values:{field:ce,key:ce}});return g(e,t)}),ba=f("dictionaryFieldContext/remove",e=>g(e,ce));k(Ro(),e=>{e.addCase(Aa,(t,r)=>{t.contextValues=r.payload;}).addCase(Ra,(t,r)=>{let{field:n,key:o}=r.payload;t.contextValues[n]=o;}).addCase(ba,(t,r)=>{delete t.contextValues[r.payload];}).addCase(ne.fulfilled,(t,r)=>{r.payload&&(t.contextValues=r.payload.dictionaryFieldContext.contextValues);});});var yy=ie(e=>e.queryCorrection.correctedQuery!==""||e.wasCorrectedTo!=="",e=>e);var Cy=(e,t)=>{let r={...ug(),...t,correctedQuery:t?.correctedQuery||t?.corrections[0]?.correctedQuery||""};e.queryCorrection=r,e.wasCorrectedTo=r.correctedQuery;};var Fu=k(ec(),e=>{e.addCase(da,t=>{t.enableDidYouMean=!0;}).addCase(iu,t=>{t.enableDidYouMean=!1;}).addCase(su,t=>{t.automaticallyCorrectQuery=!0;}).addCase(pa,t=>{t.automaticallyCorrectQuery=!1;}).addCase(R.pending,t=>{t.queryCorrection=Zs(),t.wasAutomaticallyCorrected=!1,t.wasCorrectedTo="";}).addCase(R.fulfilled,(t,r)=>{let{queryCorrection:n,queryCorrections:o}=r.payload.response;if(t.queryCorrectionMode==="legacy"){let a=o&&o[0]?o[0]:Zs();t.queryCorrection=a;}t.queryCorrectionMode==="next"&&Cy(t,n),t.wasAutomaticallyCorrected=r.payload.automaticallyCorrected,t.originalQuery=r.payload.originalQuery;}).addCase(St,(t,r)=>{t.wasCorrectedTo=r.payload;}).addCase(ma,(t,r)=>{t.queryCorrectionMode=r.payload;});});function xy(e,t={}){if(!Hw(e));let r=O(e),{dispatch:n}=e;n(da()),t.options?.automaticallyCorrectQuery===!1&&n(pa()),n(ma(t.options?.queryCorrectionMode||"legacy"));let o=()=>e.state,a=()=>yy(o().didYouMean);return {...r,get state(){let i=o();return {originalQuery:i.didYouMean.originalQuery,wasCorrectedTo:i.didYouMean.wasCorrectedTo,wasAutomaticallyCorrected:i.didYouMean.wasAutomaticallyCorrected,queryCorrection:i.didYouMean.queryCorrection,hasQueryCorrection:a()}},applyCorrection(){n(St(this.state.queryCorrection.correctedQuery));}}}function Hw(e){return e.addReducers({configuration:L,didYouMean:Fu}),!0}function zw(e,t={}){let r=xy(e,t),{dispatch:n}=e;return {...r,get state(){return r.state},applyCorrection(){r.applyCorrection(),n(R({legacy:cu(),next:kh()}));}}}var H=P;var X=f("facetOptions/update",(e={freezeFacetOrder:!0})=>g(e,{freezeFacetOrder:new Q({required:!1})})),Qe=f("facetOptions/facet/enable",e=>g(e,H)),de=f("facetOptions/facet/disable",e=>g(e,H));var fs={facetId:H,captions:new E({options:{required:!1}}),numberOfValues:new I({required:!1,min:1}),query:new x({required:!1,emptyAllowed:!0})};var Gw={path:new B({required:!0,each:P}),displayValue:ce,rawValue:ce,count:new I({required:!0,min:0})},va=f("categoryFacet/selectSearchResult",e=>g(e,{facetId:H,value:new E({values:Gw})})),Pa=f("categoryFacetSearch/register",e=>g(e,fs));function wa(e,t){let{facetId:r,criterion:n}=t,o=e[r]?.request;o&&(o.sortCriteria=n);}function gs(e){e&&(e.currentValues=e.currentValues.map(t=>({...t,state:"idle"})),e.preventAutoSelect=!0);}function Au(e,t){e&&(e.numberOfValues=t);}function Ru(e,t){let r=e[t];r&&(r.request.numberOfValues=r.initialNumberOfValues,r.request.currentValues=[],r.request.preventAutoSelect=!0);}function Am(e,t,r){e.currentValues=Ww(t,r),e.numberOfValues=t.length?1:r,e.preventAutoSelect=!0;}function Ww(e,t){if(!e.length)return [];let r=Fy(e[0],t),n=r;for(let o of e.splice(1)){let a=Fy(o,t);n.children.push(a),n=a;}return n.state="selected",n.retrieveChildren=!0,[r]}function Fy(e,t){return {value:e,retrieveCount:t,children:[],state:"idle",retrieveChildren:!1}}var Yw={state:new se({required:!0}),numberOfResults:new I({required:!0,min:0}),value:new x({required:!0,emptyAllowed:!0}),path:new B({required:!0,each:P}),moreValuesAvailable:new Q({required:!1})};function Rm(e){e.children.forEach(t=>{Rm(t);}),mt({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},Yw);}var Ea={facetId:H,field:P,delimitingCharacter:new x({required:!1,emptyAllowed:!0}),filterFacetCount:new Q({required:!1}),injectionDepth:new I({required:!1,min:0}),numberOfValues:new I({required:!1,min:1}),sortCriteria:new se({required:!1}),basePath:new B({required:!1,each:P}),filterByBasePath:new Q({required:!1})};var Kt=f("categoryFacet/register",e=>g(e,Ea)),xn=f("categoryFacet/toggleSelectValue",e=>{try{return mt(e.facetId,P),Rm(e.selection),{payload:e,error:null}}catch(t){return {payload:e,error:Et(t)}}}),Jt=f("categoryFacet/deselectAll",e=>g(e,Ea.facetId)),ro=f("categoryFacet/updateNumberOfValues",e=>g(e,{facetId:Ea.facetId,numberOfValues:Ea.numberOfValues})),Ia=f("categoryFacet/updateSortCriterion",e=>g(e,{facetId:Ea.facetId,criterion:new se})),bu=f("categoryFacet/updateBasePath",e=>g(e,{facetId:Ea.facetId,basePath:new B({each:P})}));var Xt=k(Kr(),e=>{e.addCase(Kt,(t,r)=>{let n=r.payload,{facetId:o}=n;if(o in t)return;let a=Jw(n),i=a.numberOfValues;t[o]={request:a,initialNumberOfValues:i};}).addCase(ne.fulfilled,(t,r)=>r.payload?.categoryFacetSet??t).addCase(oe,(t,r)=>{let n=r.payload.cf||{};Object.keys(t).forEach(o=>{let a=t[o].request,i=n[o]||[];(i.length||a.currentValues.length)&&Am(a,i,t[o].initialNumberOfValues);});}).addCase(Ia,(t,r)=>{let{facetId:n,criterion:o}=r.payload,a=t[n]?.request;a&&(a.sortCriteria=o);}).addCase(bu,(t,r)=>{let{facetId:n,basePath:o}=r.payload,a=t[n]?.request;a&&(a.basePath=[...o]);}).addCase(xn,(t,r)=>{let{facetId:n,selection:o,retrieveCount:a}=r.payload,i=t[n]?.request;if(!i)return;let{path:s}=o,c=s.slice(0,s.length-1),u=Kw(i,c,a);if(u.length){let d=u[0];d.retrieveChildren=!0,d.state="selected",d.children=[];return}let l=Ry(o.value,a);l.state="selected",u.push(l),i.numberOfValues=1;}).addCase(Jt,(t,r)=>{let n=r.payload;Ru(t,n);}).addCase(le,t=>{Object.keys(t).forEach(r=>Ru(t,r));}).addCase(Je,(t,r)=>Object.keys(t).forEach(n=>{t[n].request.preventAutoSelect=!r.payload.allow;})).addCase(ro,(t,r)=>{let{facetId:n,numberOfValues:o}=r.payload,a=t[n]?.request;if(a){if(!a.currentValues.length)return Au(a,o);Xw(t,r.payload);}}).addCase(va,(t,r)=>{let{facetId:n,value:o}=r.payload,a=t[n];if(!a)return;let i=[...o.path,o.rawValue];Am(a.request,i,a.initialNumberOfValues);}).addCase(Yt.fulfilled,(t,r)=>{Ay(t,r.payload.response.facets);}).addCase(R.fulfilled,(t,r)=>{Ay(t,r.payload.response.facets);}).addCase(de,(t,r)=>{Ru(t,r.payload);});}),Ss={delimitingCharacter:";",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:5,sortCriteria:"occurrences",basePath:[],filterByBasePath:!0,resultsMustMatch:"atLeastOneValue"};function Kw(e,t,r){let n=e.currentValues;for(let o of t){let a=n[0];(!a||o!==a.value)&&(a=Ry(o,r),n.length=0,n.push(a)),a.retrieveChildren=!1,a.state="idle",n=a.children;}return n}function Jw(e){return {...Ss,currentValues:[],preventAutoSelect:!1,type:"hierarchical",...e}}function Ry(e,t){return {value:e,state:"idle",children:[],retrieveChildren:!0,retrieveCount:t}}function Ay(e,t){t.forEach(r=>{if(!Zw(e,r))return;let n=r.facetId,o=e[n]?.request;if(!o)return;let a=eE(o,r);o.currentValues=a?[]:o.currentValues,o.preventAutoSelect=!1;});}function Xw(e,t){let{facetId:r,numberOfValues:n}=t,o=e[r]?.request.currentValues[0];if(o){for(;o.children.length&&o?.state!=="selected";)o=o.children[0];o.retrieveCount=n;}}function Zw(e,t){return t.facetId in e}function eE(e,t){let r=st(e.currentValues),n=st(t.values);return r.length!==n.length}var vu=e=>tE(e.cartItems,e.cart);function tE(e,t){let r=e.reduce((n,o)=>{let{productId:a,quantity:i}=t[o];return a in n||(n[a]={productId:a,quantity:0}),n[a].quantity+=i,n},{});return [...Object.values(r)]}var ka=(r=>(r.Relevance="relevance",r.Fields="fields",r))(ka||{}),Pu=(r=>(r.Ascending="asc",r.Descending="desc",r))(Pu||{});new E({options:{required:!1},values:{by:new bt({enum:ka,required:!0}),fields:new B({each:new E({values:{name:new x,direction:new bt({enum:Pu})}})})}});new E({options:{required:!1},values:{by:new bt({enum:ka,required:!0}),fields:new B({each:new E({values:{field:new x({required:!0}),direction:new bt({enum:Pu}),displayName:new x}})})}});var Ot=async e=>({...await rE(e),facets:oE(e),...e.commerceSort&&{sort:aE(e.commerceSort.appliedSort)}}),rE=async(e,t)=>{let{view:r,user:n,...o}=e.commerceContext;return {accessToken:e.configuration.accessToken,url:e.configuration.platformUrl,organizationId:e.configuration.organizationId,trackingId:e.configuration.analytics.trackingId,...o,clientId:await we(e.configuration.analytics),context:{user:n,view:r,cart:vu(e.cart)},...nE(e,t)}},nE=(e,t)=>{let r=t?e.commercePagination?.recommendations[t]:e.commercePagination?.principal;return r&&{page:r.page,...r.perPage&&{perPage:r.perPage}}};function oE(e){return !e.facetOrder||!e.commerceFacetSet?[]:e.facetOrder.map(t=>e.commerceFacetSet[t].request).filter(t=>t.values.length>0)}function aE(e){return e.by==="relevance"?{sortCriteria:"relevance"}:{sortCriteria:"fields",fields:e.fields.map(({name:t,direction:r})=>({field:t,direction:r}))}}var by=async(e,t,r)=>{let o=`*${t.categoryFacetSearchSet[e].options.query}*`,a=t.commerceFacetSet[e]?.request,i=a&&iE(a)?a&&sE(a):[],s=i.length?[i]:[],c=t.commerceQuery?.query,{url:u,accessToken:l,organizationId:d,trackingId:p,language:m,country:S,currency:F,clientId:y,context:A,...w}=await Ot(t);return {url:u,accessToken:l,organizationId:d,facetId:e,facetQuery:o,ignorePaths:s,trackingId:p,language:m,country:S,currency:F,clientId:y,context:A,...!r&&{...w,query:c}}};function iE(e){return e.type==="hierarchical"}var sE=e=>{let t=[],r=e.values[0];for(;r;)t.push(r.value),r=r.children[0];return t};var vy=async(e,t,r)=>{let o=`*${t.facetSearchSet[e].options.query}*`,a=t.commerceQuery?.query;a===void 0&&(a="");let{url:i,accessToken:s,organizationId:c,trackingId:u,language:l,country:d,currency:p,clientId:m,context:S,...F}=await Ot(t);return {url:i,accessToken:s,organizationId:c,facetId:e,facetQuery:o,trackingId:u,language:l,country:d,currency:p,clientId:m,context:S,...!r&&{...F,query:a}}};var Py=e=>async(t,{getState:r,extra:{apiClient:n,validatePayload:o}})=>{let a=r();o(t,P);let i=cE(a,t)||uE(a,t)?vy(t,a,e):by(t,a,e),s=await n.facetSearch(await i);return {facetId:t,response:s}},Fn=N("commerce/facetSearch/executeSearch",Py(!1)),An=N("commerce/facetSearch/facetFieldSuggest",Py(!1)),cE=(e,t)=>"facetSearchSet"in e&&e.facetSearchSet[t]!==void 0&&e.commerceFacetSet[t]!==void 0,uE=(e,t)=>"fieldSuggestionsOrder"in e?e.fieldSuggestionsOrder.some(r=>r.facetId===t&&r.type==="regular"):!1;var Tt=e=>e.error!==void 0;var wu=ie(e=>e.commercePagination?.principal.perPage||0,e=>e);ie((e,t)=>e.commercePagination?.recommendations[t]?.perPage||0,e=>e);var Eu=ie(e=>e.commercePagination?.principal.totalEntries||0,e=>e);ie((e,t)=>e.commercePagination?.recommendations[t]?.totalEntries||0,e=>e);ie(e=>e.commercePagination?.principal.page||0,e=>e);ie((e,t)=>e.commercePagination?.recommendations[t]?.page||0,e=>e);ie(e=>e.productListing.responseId,e=>e);ie(e=>e.productListing.requestId,e=>e);var bm=ie(e=>e.productListing?.products.length||0,e=>e),wy=ie(e=>({total:Eu(e),current:bm(e)}),({current:e,total:t})=>e<t);ie(e=>e.productListing?.isLoading,e=>M(e)?!1:e);ie(e=>e.productListing?.error,e=>e);var Oa=N("commerce/productListing/fetch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:o})=>{let a=t(),{apiClient:i}=o,s=await i.getProductListing(await Ot(a));return Tt(s)?(r(Ve(s.error)),n(s.error)):{response:s.success}});N("commerce/productListing/fetchMoreProducts",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:o})=>{let a=t();if(!wy(a))return null;let{apiClient:s}=o,c=wu(a),l=bm(a)/c,d=await s.getProductListing({...await Ot(a),page:l});return Tt(d)?(r(Ve(d.error)),n(d.error)):{response:d.success}});var no={id:P},Ta=f("querySuggest/register",e=>g(e,{...no,count:new I({min:0})})),Ey=f("querySuggest/unregister",e=>g(e,no)),Zt=f("querySuggest/selectSuggestion",e=>g(e,{...no,expression:ce})),Rn=f("querySuggest/clear",e=>g(e,no)),bn=N("querySuggest/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:o}})=>{o(e,no);let a=e.id,i=await dE(a,t()),s=await n.querySuggest(i);return Pe(s)?r(s.error):{id:a,q:i.q,...s.success}}),dE=async(e,t)=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl,count:t.querySuggest[e].count,q:t.querySet[e],locale:t.configuration.search.locale,timezone:t.configuration.search.timezone,actionsHistory:t.configuration.analytics.enabled?Ye.getHistory():[],...t.context&&{context:t.context.contextValues},...t.pipeline&&{pipeline:t.pipeline},...t.searchHub&&{searchHub:t.searchHub},tab:t.configuration.analytics.originLevel2,...t.configuration.analytics.enabled&&{visitorId:await we(t.configuration.analytics),...t.configuration.analytics.enabled&&await ln(t.configuration.analytics)},...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")}});var vn=N("commerce/querySuggest/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:o}})=>{o(e,no);let a=t(),i=await pE(e.id,a),s=await n.querySuggest(i);return Tt(s)?r(s.error):{id:e.id,query:i.query,...s.success}}),pE=async(e,t)=>{let{view:r,user:n,...o}=t.commerceContext;return {accessToken:t.configuration.accessToken,url:t.configuration.platformUrl,organizationId:t.configuration.organizationId,trackingId:t.configuration.analytics.trackingId,query:t.querySet[e],...o,clientId:await we(t.configuration.analytics),context:{user:n,view:r,cart:vu(t.cart)}}};var Iy=f("query/updateQuery",e=>g(e,{query:new x}));ie(e=>e.commerceSearch.responseId,e=>e);ie(e=>e.commerceSearch.requestId,e=>e);var vm=ie(e=>e.commerceSearch?.products.length||0,e=>e),ky=ie(e=>({total:Eu(e),current:vm(e)}),({current:e,total:t})=>e<t);ie(e=>e.commerceSearch?.isLoading,e=>M(e)?!1:e);ie(e=>e.commerceSearch?.error,e=>e);var Iu=ie(e=>e.commerceQuery?.query,e=>e??"");ie(e=>e.commerceSearch?.queryExecuted,e=>e);var Pm=(e,t)=>t.queryCorrection?.correctedQuery!==void 0?t.queryCorrection?.correctedQuery:Iu(e);var qa=N("commerce/search/executeSearch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:o})=>{let a=t(),{apiClient:i}=o,s=Iu(a),c=await i.search({...await Ot(a),query:s});return Tt(c)?(r(Ve(c.error)),n(c.error)):{response:c.success,originalQuery:s,queryExecuted:Pm(a,c.success)}});N("commerce/search/fetchMoreProducts",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:o})=>{let a=t();if(!ky(a))return null;let{apiClient:s}=o,c=wu(a),l=vm(a)/c,d=Iu(a),p=await s.search({...await Ot(a),query:d,page:l});return Tt(p)?(r(Ve(p.error)),n(p.error)):{response:p.success,originalQuery:d,queryExecuted:Pm(a,p.success)}});N("commerce/search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;g(e,{query:new x,clearFilters:new Q}),e.clearFilters&&(r(le()),r(Ht())),r(Je({allow:!0})),r(Iy({query:e.query})),r(Xe(1));});N("commerce/search/fetchInstantProducts",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:o})=>{let a=t(),{q:i}=e,{apiClient:s}=o,c=await s.productSuggestions({...await Ot(a),query:i});if(Tt(c))return r(Ve(c.error)),n(c.error);let u=c.success.products.slice(0,5);return {response:{...c.success,products:u}}});function hs(e,t,r){let{facetId:n}=t;if(e[n])return;let o=!1,a={...Ze,...t},i=r();e[n]={options:a,isLoading:o,response:i,initialNumberOfValues:a.numberOfValues,requestId:""};}function ku(e,t){let{facetId:r,...n}=t,o=e[r];o&&(o.options={...o.options,...n});}function Pn(e,t,r){let n=e[t];n&&(n.requestId=r,n.isLoading=!0);}function wn(e,t){let r=e[t];r&&(r.isLoading=!1);}function Ou(e,t,r){let{facetId:n,response:o}=t,a=e[n];a&&a.requestId===r&&(a.isLoading=!1,a.response=o);}function Tu(e,t,r){let{facetId:n,response:o}=t,a=e[n];a&&a.requestId===r&&(a.isLoading=!1,"success"in o&&(a.response=o.success));}function qu(e,t,r,n){let{facetId:o,response:a}=t,i=e[o];if(!i)hs(e,{facetId:o},n),i=e[o];else if(i.requestId!==r)return;i.isLoading=!1,"success"in a&&(i.response=a.success);}function Oy(e,t,r,n){if(t.fieldSuggestionsFacets)for(let o of t.fieldSuggestionsFacets)o.facetId in e||o.type!=="regular"||(e[o.facetId]={options:{...Ze,query:t.query??""},isLoading:!1,response:n(),initialNumberOfValues:Ze.numberOfValues,requestId:r});}function Ty(e,t,r,n){if(t.fieldSuggestionsFacets)for(let o of t.fieldSuggestionsFacets)o.facetId in e||o.type!=="hierarchical"||(e[o.facetId]={options:{...Ze,query:t.query??""},isLoading:!1,response:n(),initialNumberOfValues:Ze.numberOfValues,requestId:r});}function ys(e,t,r){let{facetId:n}=t,o=e[n];o&&(o.requestId="",o.isLoading=!1,o.response=r(),o.options.numberOfValues=o.initialNumberOfValues,o.options.query=Ze.query);}function Nr(e,t){Object.keys(e).forEach(r=>ys(e,{facetId:r},t));}var Ze={captions:{},numberOfValues:10,query:""};var qy=async(e,t,r)=>{let n=t.categoryFacetSearchSet[e].options,o=t.categoryFacetSet[e].request,{captions:a,query:i,numberOfValues:s}=n,{field:c,delimitingCharacter:u,basePath:l,filterFacetCount:d}=o,p=mE(o),m=p.length?[p]:[],S=`*${i}*`;return {url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")},basePath:l,captions:a,numberOfValues:s,query:S,field:c,delimitingCharacter:u,ignorePaths:m,filterFacetCount:d,type:"hierarchical",...r?{}:{searchContext:(await Ae(t)).request}}},mE=e=>{let t=[],r=e.currentValues[0];for(;r;)t.push(r.value),r=r.children[0];return t};var Dy=async(e,t,r)=>{let{captions:n,query:o,numberOfValues:a}=t.facetSearchSet[e].options,{field:i,currentValues:s,filterFacetCount:c}=t.facetSet[e].request,u=s.filter(d=>d.state!=="idle").map(d=>d.value),l=`*${o}*`;return {url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders&&{authentication:t.configuration.search.authenticationProviders.join(",")},captions:n,numberOfValues:a,query:l,field:i,ignoreValues:u,filterFacetCount:c,type:"specific",...r?{}:{searchContext:(await Ae(t)).request}}};var Vy=e=>async(t,{getState:r,extra:{apiClient:n,validatePayload:o}})=>{let a=r(),i;o(t,P),fE(a,t)?i=await Dy(t,a,e):i=await qy(t,a,e);let s=await n.facetSearch(i);return {facetId:t,response:s}},Ee=N("facetSearch/executeSearch",Vy(!1)),er=N("facetSearch/executeSearch",Vy(!0)),Da=f("facetSearch/clearResults",e=>g(e,{facetId:H})),fE=(e,t)=>e.facetSearchSet!==void 0&&e.facetSet!==void 0&&e.facetSet[t]!==void 0;var Ny={facetId:H,value:new E({values:{displayValue:ce,rawValue:ce,count:new I({required:!0,min:0})}})},Du=f("facetSearch/register",e=>g(e,fs)),En=f("facetSearch/update",e=>g(e,fs)),oo=f("facetSearch/toggleSelectValue",e=>g(e,Ny)),ao=f("facetSearch/toggleExcludeValue",e=>g(e,Ny));var Va=k(rc(),e=>{e.addCase(Pa,(t,r)=>{let n=r.payload;hs(t,n,io);}).addCase(En,(t,r)=>{ku(t,r.payload);}).addCase(Fn.pending,(t,r)=>{let n=r.meta.arg;Pn(t,n,r.meta.requestId);}).addCase(An.pending,(t,r)=>{let n=r.meta.arg;Pn(t,n,r.meta.requestId);}).addCase(Ee.pending,(t,r)=>{let n=r.meta.arg;Pn(t,n,r.meta.requestId);}).addCase(Fn.rejected,(t,r)=>{let n=r.meta.arg;wn(t,n);}).addCase(An.rejected,(t,r)=>{let n=r.meta.arg;wn(t,n);}).addCase(Ee.rejected,(t,r)=>{let n=r.meta.arg;wn(t,n);}).addCase(Fn.fulfilled,(t,r)=>{Tu(t,r.payload,r.meta.requestId);}).addCase(An.fulfilled,(t,r)=>{qu(t,r.payload,r.meta.requestId,io);}).addCase(vn.fulfilled,(t,r)=>{Ty(t,r.payload,r.meta.requestId,io);}).addCase(Ee.fulfilled,(t,r)=>{Ou(t,r.payload,r.meta.requestId);}).addCase(Da,(t,{payload:{facetId:r}})=>{ys(t,{facetId:r},io);}).addCase(Oa.fulfilled,t=>Nr(t,io)).addCase(qa.fulfilled,t=>Nr(t,io)).addCase(R.fulfilled,t=>{Nr(t,io);});});function io(){return {moreValuesAvailable:!1,values:[]}}var Na=e=>b("analytics/facet/showMore",(t,r)=>{g(e,H);let n=jo(e,ct(r));return t.makeFacetShowMore(n)}),La=e=>b("analytics/facet/showLess",(t,r)=>{g(e,H);let n=jo(e,ct(r));return t.makeFacetShowLess(n)}),tr=e=>b("analytics/facet/sortChange",(t,r)=>{g(e,{facetId:H,criterion:new se({required:!0})});let{facetId:n,criterion:o}=e,a=ct(r),s={...jo(n,a),criteria:o};return t.makeFacetUpdateSort(s)}),Ie=e=>b("analytics/facet/reset",(t,r)=>{g(e,H);let n=ct(r),o=jo(e,n);return t.makeFacetClearAll(o)}),Se=e=>b("analytics/facet/select",(t,r)=>{g(e,{facetId:H,facetValue:P});let n=ct(r),o=$o(e,n);return t.makeFacetSelect(o)}),lt=e=>b("analytics/facet/exclude",(t,r)=>{g(e,{facetId:H,facetValue:P});let n=ct(r),o=$o(e,n);return t.makeFacetExclude(o)}),qt=e=>b("analytics/facet/deselect",(t,r)=>{g(e,{facetId:H,facetValue:P});let n=ct(r),o=$o(e,n);return t.makeFacetDeselect(o)}),Lr=e=>b("analytics/facet/unexclude",(t,r)=>{g(e,{facetId:H,facetValue:P});let n=ct(r),o=$o(e,n);return t.makeFacetUnexclude(o)}),Ma=e=>b("analytics/facet/breadcrumb",(t,r)=>{g(e,{facetId:H,facetValue:P});let n=$o(e,ct(r));return t.makeBreadcrumbFacet(n)}),In=()=>({actionCause:"facetUpdateSort"}),Be=()=>({actionCause:"facetClearAll"}),Re=()=>({actionCause:"facetSelect"}),rr=()=>({actionCause:"facetExclude"}),Mr=()=>({actionCause:"facetDeselect"}),wm=()=>({actionCause:"facetUnexclude"}),Vu=()=>({actionCause:"breadcrumbFacet"});var nr=(e,t)=>e.facetOptions.facets[t]?.enabled??!0;var or=new x({regex:/^[a-zA-Z0-9-_]+$/}),ar=new x({required:!0}),Ly=new B({each:new x}),My=new x,Qy=new Q,ir=new Q,sr=new I({min:0}),Dt=new I({min:1}),Nu=new Q({required:!0}),gE=new E,SE=new x,hE={captions:gE,numberOfValues:Dt,query:SE},Qa=new E({values:hE}),Lu=new E({options:{required:!1},values:{type:new x({constrainTo:["simple"],emptyAllowed:!1,required:!0}),values:new B({required:!0,max:25,each:new x({emptyAllowed:!1,required:!0})})}}),By=new Q,Mu=new B({min:1,max:25,required:!1,each:new x({emptyAllowed:!1,required:!0})});var so={value:P,numberOfResults:new I({min:0}),state:P};var yE={facetId:H,field:new x({required:!0,emptyAllowed:!0}),filterFacetCount:new Q({required:!1}),injectionDepth:new I({required:!1,min:0}),numberOfValues:new I({required:!1,min:1}),sortCriteria:new se({required:!1}),resultsMustMatch:new se({required:!1}),allowedValues:Lu,customSort:Mu},cr=f("facet/register",e=>g(e,yE)),ur=f("facet/toggleSelectValue",e=>g(e,{facetId:H,selection:new E({values:so})})),lr=f("facet/toggleExcludeValue",e=>g(e,{facetId:H,selection:new E({values:so})})),pe=f("facet/deselectAll",e=>g(e,H)),Ba=f("facet/updateSortCriterion",e=>g(e,{facetId:H,criterion:new se({required:!0})})),co=f("facet/updateNumberOfValues",e=>g(e,{facetId:H,numberOfValues:new I({required:!0,min:1})})),uo=f("facet/updateIsFieldExpanded",e=>g(e,{facetId:H,isFieldExpanded:new Q({required:!0})})),Qr=f("facet/updateFreezeCurrentValues",e=>g(e,{facetId:H,freezeCurrentValues:new Q({required:!0})}));function lo(e){let t=Uy(e.start,e),r=Uy(e.end,e),n=e.endInclusive??!1,o=e.state??"idle";return {start:t,end:r,endInclusive:n,state:o}}function Uy(e,t){let{dateFormat:r}=t;return vh(e)?(Jn(e),Ah(e)):typeof e=="string"&&Gt(e)?(Jn(e),e):(nu(e,r),cs(Kn(e,r)))}var Ua=f("rangeFacet/updateSortCriterion",e=>g(e,{facetId:H,criterion:new se({required:!0})}));var po={state:P,start:new I({required:!0}),end:new I({required:!0}),endInclusive:new Q({required:!0}),numberOfResults:new I({required:!0,min:0})},mo={start:P,end:P,endInclusive:new Q({required:!0}),state:P,numberOfResults:new I({required:!0,min:0})},fo=e=>({facetId:H,selection:typeof e.start=="string"?new E({values:mo}):new E({values:po})});var CE={start:P,end:P,endInclusive:new Q({required:!0}),state:P},xE={facetId:H,field:P,currentValues:new B({required:!1,each:new E({values:CE})}),generateAutomaticRanges:new Q({required:!0}),filterFacetCount:new Q({required:!1}),injectionDepth:new I({required:!1,min:0}),numberOfValues:new I({required:!1,min:1}),sortCriteria:new se({required:!1}),rangeAlgorithm:new se({required:!1})};function _y(e){return Gt(e)?ls(e):e}function Qu(e){e.currentValues&&e.currentValues.forEach(t=>{let{start:r,end:n}=lo(t);if(Kn(_y(r)).isAfter(Kn(_y(n))))throw new Error(`The start value is greater than the end value for the date range ${t.start} to ${t.end}`)});}var dr=f("dateFacet/register",e=>{try{return mt(e,xE),Qu(e),{payload:e,error:null}}catch(t){return {payload:e,error:Et(t)}}}),pr=f("dateFacet/toggleSelectValue",e=>g(e,{facetId:H,selection:new E({values:mo})})),mr=f("dateFacet/toggleExcludeValue",e=>g(e,{facetId:H,selection:new E({values:mo})})),Br=f("dateFacet/updateFacetValues",e=>{try{return mt(e,{facetId:H,values:new B({each:new E({values:mo})})}),Qu({currentValues:e.values}),{payload:e,error:null}}catch(t){return {payload:e,error:Et(t)}}}),Bu=Ua,Uu=pe;var FE={state:P,start:new I({required:!0}),end:new I({required:!0}),endInclusive:new Q({required:!0})},AE={facetId:H,field:P,currentValues:new B({required:!1,each:new E({values:FE})}),generateAutomaticRanges:new Q({required:!0}),filterFacetCount:new Q({required:!1}),injectionDepth:new I({required:!1,min:0}),numberOfValues:new I({required:!1,min:1}),sortCriteria:new se({required:!1}),rangeAlgorithm:new se({required:!1})};function _u(e){e.currentValues&&e.currentValues.forEach(({start:t,end:r})=>{if(t>r)throw new Error(`The start value is greater than the end value for the numeric range ${t} to ${r}`)});}var fr=f("numericFacet/register",e=>{try{return g(e,AE),_u(e),{payload:e,error:null}}catch(t){return {payload:e,error:Et(t)}}}),gr=f("numericFacet/toggleSelectValue",e=>g(e,{facetId:H,selection:new E({values:po})})),Sr=f("numericFacet/toggleExcludeValue",e=>g(e,{facetId:H,selection:new E({values:po})})),Ur=f("numericFacet/updateFacetValues",e=>{try{return mt(e,{facetId:H,values:new B({each:new E({values:po})})}),_u({currentValues:e.values}),{payload:e,error:null}}catch(t){return {payload:e,error:Et(t)}}}),ju=Ua,$u=pe;var ke=k(vo(),e=>{e.addCase(X,(t,r)=>({...t,...r.payload})).addCase(R.fulfilled,t=>{t.freezeFacetOrder=!1;}).addCase(R.rejected,t=>{t.freezeFacetOrder=!1;}).addCase(ne.fulfilled,(t,r)=>r.payload?.facetOptions??t).addCase(Kt,(t,r)=>{t.facets[r.payload.facetId]=bo();}).addCase(cr,(t,r)=>{t.facets[r.payload.facetId]=bo();}).addCase(dr,(t,r)=>{t.facets[r.payload.facetId]=bo();}).addCase(fr,(t,r)=>{t.facets[r.payload.facetId]=bo();}).addCase(Qe,(t,r)=>{t.facets[r.payload].enabled=!0;}).addCase(de,(t,r)=>{t.facets[r.payload].enabled=!1;}).addCase(oe,(t,r)=>{[...Object.keys(r.payload.f??{}),...Object.keys(r.payload.fExcluded??{}),...Object.keys(r.payload.cf??{}),...Object.keys(r.payload.nf??{}),...Object.keys(r.payload.df??{})].forEach(n=>{n in t||(t.facets[n]=bo()),t.facets[n].enabled=!0;});});});function jy(e,t){let{field:r,state:n}=e;if(!RE(e))return r;let o=`${r}_`,a=bE(o,n);return PE(r,t),`${o}${a}`}function RE(e){let{field:t,state:r}=e;return $y(r).some(o=>o&&t in o)}function bE(e,t){let n=$y(t).map(o=>Object.keys(o||{})).reduce((o,a)=>o.concat(a),[]);return vE(n,e)+1}function $y(e){let{facetSet:t,numericFacetSet:r,dateFacetSet:n,categoryFacetSet:o}=e;return [t,r,n,o]}function vE(e,t){return e.map(a=>{let i=a.split(t)[1],s=parseInt(i,10);return Number.isNaN(s)?0:s}).sort().pop()??0}function PE(e,t){let r=`A facet with field "${e}" already exists.
  To avoid unexpected behaviour, configure the #id option on the facet controller.`;t.warn(r);}function Ue(e,t){let{state:r,logger:n}=e,{field:o,facetId:a}=t;return a||jy({field:o,state:r},n)}var Hy=["alphanumeric","occurrences"];var zy=new $({field:ar,basePath:Ly,delimitingCharacter:My,facetId:or,facetSearch:Qa,filterByBasePath:Qy,filterFacetCount:ir,injectionDepth:sr,numberOfValues:Dt,sortCriteria:new x({constrainTo:Hy})});function Gy(e,t){if(!wE(e));let r=O(e),{dispatch:n}=e,o=Ue(e,t.options),a={...Ss,...Ys("facetSearch",t.options),field:t.options.field,facetId:o},i={facetSearch:{...Ze,...t.options.facetSearch},...a};ue(e,zy,i,"buildCategoryFacet");let s=()=>zp(e.state,o),c=()=>Hp(e.state,o),u=()=>jt(e.state),l=()=>nr(e.state,o);return n(Kt(a)),{...r,toggleSelect(d){let p=i.numberOfValues;n(xn({facetId:o,selection:d,retrieveCount:p})),n(X());},deselectAll(){n(Jt(o)),n(X());},sortBy(d){n(Ia({facetId:o,criterion:d})),n(X());},isSortedBy(d){return s().sortCriteria===d},showMoreValues(){let{numberOfValues:d}=i,{activeValue:p,valuesAsTrees:m}=this.state,S=(p?.children.length??m.length)+d;n(ro({facetId:o,numberOfValues:S})),n(X());},showLessValues(){let{numberOfValues:d}=i;n(ro({facetId:o,numberOfValues:d})),n(X());},enable(){n(Qe(o));},disable(){n(de(o));},get state(){let d=s(),p=c(),m=u(),S=l(),F=p?.values??[],y=F.some(K=>K.children.length>0)??!1,{parents:A,values:w}=HS(p?.values),V=st(F),U=V.length?V[V.length-1]:void 0,Z=!!U,Y=U?.moreValuesAvailable??p?.moreValuesAvailable??!1,te=U?U.children.length>i.numberOfValues:F.length>i.numberOfValues;return {facetId:o,parents:A,selectedValueAncestry:V,values:w,isHierarchical:y,valuesAsTrees:F,activeValue:U,isLoading:m,hasActiveValues:Z,canShowMoreValues:Y,canShowLessValues:te,sortCriteria:d.sortCriteria,enabled:S}}}}function wE(e){return e.addReducers({categoryFacetSet:Xt,categoryFacetSearchSet:Va,facetOptions:ke,configuration:L,search:j}),!0}function _a(e,t){let r=e.dispatch,{options:n,getFacetSearch:o,executeFacetSearchActionCreator:a,executeFieldSuggestActionCreator:i}=t,{facetId:s}=n;return {updateText(c){r(En({facetId:s,query:c,numberOfValues:o().initialNumberOfValues}));},showMoreResults(){let{initialNumberOfValues:c,options:u}=o();r(En({facetId:s,numberOfValues:u.numberOfValues+c})),r(t.isForFieldSuggestions?i(s):a(s));},search(){r(t.isForFieldSuggestions?i(s):a(s));},clear(){r(Da({facetId:s}));},updateCaptions(c){r(En({facetId:s,captions:c}));},get state(){let{response:c,isLoading:u,options:l}=o(),{query:d}=l,p=c.values;return {...c,values:p,isLoading:u,query:d}}}}function Wy(e,t){let{dispatch:r}=e,n={...Ze,...t.options},{facetId:o}=n,a=()=>"state"in e?e.state.categoryFacetSearchSet[o]:e[Ti].categoryFacetSearchSet[o];r(Pa(n));let i=_a(e,{options:n,getFacetSearch:a,isForFieldSuggestions:t.isForFieldSuggestions,executeFacetSearchActionCreator:t.executeFacetSearchActionCreator,executeFieldSuggestActionCreator:t.executeFieldSuggestActionCreator});return {...i,select(s){r(va({facetId:o,value:s})),t.select(s);},get state(){return i.state}}}function Hu(e,t){let{executeFacetSearchActionCreator:r,executeFieldSuggestActionCreator:n,select:o,isForFieldSuggestions:a}=t,{dispatch:i}=e,s={...Ze,...t.options},{facetId:c}=s,u=()=>e.state.categoryFacetSearchSet[c],l=Wy(e,{options:{...s},executeFacetSearchActionCreator:r,executeFieldSuggestActionCreator:n,select:o,isForFieldSuggestions:a});i(Pa(s));let d=_a(e,{options:s,getFacetSearch:u,isForFieldSuggestions:t.isForFieldSuggestions,executeFacetSearchActionCreator:Ee,executeFieldSuggestActionCreator:er});return {...d,...l,get state(){return {...d.state,...l.state}}}}function EE(e,t){if(!IE(e));let r=Gy(e,t),{dispatch:n}=e,o=()=>r.state.facetId,a=Hu(e,{options:{facetId:o(),...t.options.facetSearch},executeFacetSearchActionCreator:Ee,executeFieldSuggestActionCreator:er,select:c=>{n(X()),n(R({legacy:Se({facetId:o(),facetValue:c.rawValue}),next:Re()}));},isForFieldSuggestions:!1}),{state:i,...s}=a;return {...r,facetSearch:s,toggleSelect(c){r.toggleSelect(c),n(R({legacy:kE(o(),c),next:OE(c)}));},deselectAll(){r.deselectAll(),n(R({legacy:Ie(o()),next:Be()}));},sortBy(c){r.sortBy(c),n(R({legacy:tr({facetId:o(),criterion:c}),next:In()}));},showMoreValues(){r.showMoreValues(),n(Yt({legacy:Na(o())}));},showLessValues(){r.showLessValues(),n(Yt({legacy:La(o())}));},get state(){return {...r.state,facetSearch:a.state}}}}function IE(e){return e.addReducers({categoryFacetSet:Xt,categoryFacetSearchSet:Va,configuration:L,search:j}),!0}function kE(e,t){let r={facetId:e,facetValue:t.value};return t.state==="selected"?qt(r):Se(r)}function OE(e){return e.state==="selected"?Mr():Re()}var TE=Intl.supportedValuesOf("currency"),qE=new x({required:!0,emptyAllowed:!1,constrainTo:TE}),Em={url:P,referrer:lS},Im={userId:re,email:re,userIp:re,userAgent:re},DE=new E({options:{required:!0},values:{productId:re,sku:re,name:re,price:re,quantity:re}});({items:new B({each:DE})});var km={language:P,country:P,currency:qE,user:new E({values:Im}),view:new E({options:{required:!0},values:Em})};new $(km);f("commerce/setContext",e=>g(e,km));f("commerce/setUser",e=>M(e.userId)&&M(e.email)?{payload:e,error:Et(new $n("Either userId or email is required"))}:g(e,Im));var Yy=f("commerce/setView",e=>g(e,Em));var ja=k(nc(),e=>{e.addCase(Du,(t,r)=>{let n=r.payload;hs(t,n,kn);}).addCase(En,(t,r)=>{ku(t,r.payload);}).addCase(Fn.pending,(t,r)=>{let n=r.meta.arg;Pn(t,n,r.meta.requestId);}).addCase(An.pending,(t,r)=>{let n=r.meta.arg;Pn(t,n,r.meta.requestId);}).addCase(Ee.pending,(t,r)=>{let n=r.meta.arg;Pn(t,n,r.meta.requestId);}).addCase(Fn.rejected,(t,r)=>{let n=r.meta.arg;wn(t,n);}).addCase(An.rejected,(t,r)=>{let n=r.meta.arg;wn(t,n);}).addCase(Ee.rejected,(t,r)=>{let n=r.meta.arg;wn(t,n);}).addCase(Fn.fulfilled,(t,r)=>{Tu(t,r.payload,r.meta.requestId);}).addCase(An.fulfilled,(t,r)=>{qu(t,r.payload,r.meta.requestId,kn);}).addCase(vn.fulfilled,(t,r)=>{Oy(t,r.payload,r.meta.requestId,kn);}).addCase(Ee.fulfilled,(t,r)=>{Ou(t,r.payload,r.meta.requestId);}).addCase(Da,(t,{payload:r})=>{ys(t,r,kn);}).addCase(R.fulfilled,t=>{Nr(t,kn);}).addCase(Oa.fulfilled,t=>Nr(t,kn)).addCase(qa.fulfilled,t=>Nr(t,kn)).addCase(Yy,t=>Nr(t,kn));});function kn(){return {moreValuesAvailable:!1,values:[]}}var Ky=()=>rh("analytics/productListing/load",e=>e.makeInterfaceLoad(),e=>new Yn(e));f("productlisting/setUrl",e=>g(e,{url:new x({required:!0,url:!0})}));f("productlisting/setAdditionalFields",e=>g(e,{additionalFields:new B({required:!0,each:new x({required:!0,emptyAllowed:!1})})}));var On=N("productlisting/fetch",async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:o})=>{let a=t(),{apiClient:i}=o,s=await i.getProducts(await VE(a));return Tt(s)?(r(Ve(s.error)),n(s.error)):{response:s.success,analyticsAction:Ky()}}),VE=async e=>{let t=LE(e),r=await we(e.configuration.analytics);return {accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,platformUrl:e.configuration.platformUrl,url:e.productListing?.url,...e.configuration.analytics.enabled&&r?{clientId:r}:{},...e.productListing.additionalFields?.length?{additionalFields:e.productListing.additionalFields}:{},...e.productListing.advancedParameters&&NE(e.productListing.advancedParameters)?{advancedParameters:e.productListing.advancedParameters||{}}:{},...t.length&&{facets:{requests:t}},...e.pagination&&{pagination:{numberOfValues:e.pagination.numberOfResults,page:Math.ceil(e.pagination.firstResult/(e.pagination.numberOfResults||1))+1}},...(e.sort?.by||"relevance")!=="relevance"&&{sort:e.sort},...e.context&&{userContext:e.context.contextValues}}};function NE(e){return e.debug}function LE(e){return la(ME(e),e.facetOrder??[])}function ME(e){return [...Vr(e.facetSet??{}),...Vr(e.numericFacetSet??{}),...Vr(e.dateFacetSet??{}),...Vr(e.categoryFacetSet??{})]}var hr=k(Jr(),e=>{e.addCase(cr,(t,r)=>{let{facetId:n}=r.payload;n in t||(t[n]=lg(QE(r.payload)));}).addCase(ne.fulfilled,(t,r)=>{if(r.payload&&Object.keys(r.payload.facetSet).length!==0)return r.payload.facetSet}).addCase(oe,(t,r)=>{let n=r.payload.f||{},o=r.payload.fExcluded||{};Object.keys(t).forEach(i=>{let{request:s}=t[i],c=n[i]||[],u=o[i]||[],l=c.length+u.length,d=s.currentValues.filter(p=>!c.includes(p.value)&&!u.includes(p.value));s.currentValues=[...c.map(Jy),...u.map(Xy),...d.map(UE)],s.preventAutoSelect=l>0,s.numberOfValues=Math.max(l,s.numberOfValues);});}).addCase(ur,(t,r)=>{let{facetId:n,selection:o}=r.payload,a=t[n]?.request;if(!a)return;a.preventAutoSelect=!0;let i=a.currentValues.find(c=>c.value===o.value);if(!i){zu(a,o);return}let s=i.state==="selected";i.state=s?"idle":"selected",a.freezeCurrentValues=!0;}).addCase(lr,(t,r)=>{let{facetId:n,selection:o}=r.payload,a=t[n]?.request;if(!a)return;a.preventAutoSelect=!0;let i=a.currentValues.find(c=>c.value===o.value);if(!i){zu(a,o);return}let s=i.state==="excluded";i.state=s?"idle":"excluded",a.freezeCurrentValues=!0;}).addCase(Qr,(t,r)=>{let{facetId:n,freezeCurrentValues:o}=r.payload,a=t[n]?.request;a&&(a.freezeCurrentValues=o);}).addCase(pe,(t,r)=>{gs(t[r.payload]?.request);}).addCase(le,t=>{Object.values(t).filter(r=>r.hasBreadcrumbs).forEach(({request:r})=>gs(r));}).addCase(Ht,t=>{Object.values(t).filter(r=>!r.hasBreadcrumbs).forEach(({request:r})=>gs(r));}).addCase(Je,(t,r)=>Object.values(t).forEach(n=>{n.request.preventAutoSelect=!r.payload.allow;})).addCase(Ba,(t,r)=>{wa(t,r.payload);}).addCase(co,(t,r)=>{let{facetId:n,numberOfValues:o}=r.payload;Au(t[n]?.request,o);}).addCase(uo,(t,r)=>{let{facetId:n,isFieldExpanded:o}=r.payload,a=t[n]?.request;a&&(a.isFieldExpanded=o);}).addCase(R.fulfilled,(t,r)=>{r.payload.response.facets.forEach(o=>Om(t[o.facetId]?.request,o));}).addCase(On.fulfilled,(t,r)=>{(r.payload.response?.facets?.results||[]).forEach(o=>Om(t[o.facetId]?.request,o));}).addCase(Yt.fulfilled,(t,r)=>{r.payload.response.facets.forEach(o=>Om(t[o.facetId]?.request,o));}).addCase(oo,(t,r)=>{let{facetId:n,value:o}=r.payload,a=t[n]?.request;if(!a)return;let{rawValue:i}=o,{currentValues:s}=a,c=s.find(l=>l.value===i);if(c){c.state="selected";return}let u=Jy(i);zu(a,u),a.freezeCurrentValues=!0,a.preventAutoSelect=!0;}).addCase(ao,(t,r)=>{let{facetId:n,value:o}=r.payload,a=t[n]?.request;if(!a)return;let{rawValue:i}=o,{currentValues:s}=a,c=s.find(l=>l.value===i);if(c){c.state="excluded";return}let u=Xy(i);zu(a,u),a.freezeCurrentValues=!0,a.preventAutoSelect=!0;}).addCase(de,(t,r)=>{if(!(r.payload in t))return;let{request:n}=t[r.payload];gs(n);});});function zu(e,t){let{currentValues:r}=e,n=r.findIndex(s=>s.state==="idle"),o=n===-1?r.length:n,a=r.slice(0,o),i=r.slice(o+1);e.currentValues=[...a,t,...i],e.numberOfValues=e.currentValues.length;}function Om(e,t){e&&(e.currentValues=t.values.map(BE),e.freezeCurrentValues=!1,e.preventAutoSelect=!1);}var Cs={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"automatic",resultsMustMatch:"atLeastOneValue"};function QE(e){return {...Cs,type:"specific",currentValues:[],freezeCurrentValues:!1,isFieldExpanded:!1,preventAutoSelect:!1,...e}}function BE(e){let{value:t,state:r}=e;return {value:t,state:r}}function Jy(e){return {value:e,state:"selected"}}function Xy(e){return {value:e,state:"excluded"}}function UE(e){return {...e,state:"idle"}}var Gu=e=>e.state==="selected",Wu=e=>e.state==="excluded",Yu=(e,t)=>{let r={facetId:e,facetValue:t.value};return Gu(t)?qt(r):Se(r)},Ku=e=>Gu(e)?Mr():Re(),Zy=(e,t)=>{let r={facetId:e,facetValue:t.value};return Wu(t)?Lr(r):lt(r)},eC=e=>Wu(e)?wm():rr();function Ju(e,t){let{dispatch:r}=e,{options:n,select:o,exclude:a,isForFieldSuggestions:i,executeFacetSearchActionCreator:s,executeFieldSuggestActionCreator:c}=t,{facetId:u}=n,l=()=>"state"in e?e.state.facetSearchSet[u]:e[Ti].facetSearchSet[u];r(Du(n));let d=_a(e,{options:n,getFacetSearch:l,isForFieldSuggestions:i,executeFacetSearchActionCreator:s,executeFieldSuggestActionCreator:c});return {...d,select(p){r(oo({facetId:u,value:p})),o(p);},exclude(p){r(ao({facetId:u,value:p})),a(p);},singleSelect(p){r(pe(u)),r(oo({facetId:u,value:p})),o(p);},singleExclude(p){r(pe(u)),r(ao({facetId:u,value:p})),a(p);},get state(){let{values:p}=d.state;return {...d.state,values:p.map(({count:m,displayValue:S,rawValue:F})=>({count:m,displayValue:S,rawValue:F}))}}}}var tC={facetId:H,selection:new E({values:so})},rC=N("facet/executeToggleSelect",({facetId:e,selection:t},r)=>{let{dispatch:n,extra:{validatePayload:o}}=r;o({facetId:e,selection:t},tC),n(ur({facetId:e,selection:t})),n(X());}),nC=N("facet/executeToggleExclude",({facetId:e,selection:t},r)=>{let{dispatch:n,extra:{validatePayload:o}}=r;o({facetId:e,selection:t},tC),n(lr({facetId:e,selection:t})),n(X());});var $a=["allValues","atLeastOneValue"];var Xu=["score","alphanumeric","alphanumericDescending","occurrences","automatic"];var oC=new $({facetId:or,field:ar,filterFacetCount:ir,injectionDepth:sr,numberOfValues:Dt,sortCriteria:new x({constrainTo:Xu}),resultsMustMatch:new x({constrainTo:$a}),facetSearch:Qa});function aC(e,t,r=oC){if(!_E(e));let{dispatch:n}=e,o=O(e),a=Ue(e,t.options),i={...Cs,...Ys("facetSearch",t.options),field:t.options.field,facetId:a},s={facetSearch:{...Ze,...t.options.facetSearch},...i};ue(e,r,s,"buildFacet");let c=()=>$p(e.state,a),u=()=>rs(e.state,a),l=()=>jt(e.state),d=()=>nr(e.state,a),p=()=>{let{currentValues:S}=c();return S.filter(F=>F.state!=="idle").length},m=()=>{let{currentValues:S}=c(),F=s.numberOfValues,y=!!S.find(A=>A.state==="idle");return F<S.length&&y};return n(cr(i)),{...o,toggleSelect:S=>n(rC({facetId:s.facetId,selection:S})),toggleExclude:S=>n(nC({facetId:s.facetId,selection:S})),toggleSingleSelect:function(S){S.state==="idle"&&n(pe(a)),this.toggleSelect(S);},toggleSingleExclude:function(S){S.state==="idle"&&n(pe(a)),this.toggleExclude(S);},isValueSelected:Gu,isValueExcluded:Wu,deselectAll(){n(pe(a)),n(X());},sortBy(S){n(Ba({facetId:a,criterion:S})),n(X());},isSortedBy(S){return this.state.sortCriterion===S},showMoreValues(){let S=c().numberOfValues,F=s.numberOfValues,y=F-S%F,A=S+y;n(co({facetId:a,numberOfValues:A})),n(uo({facetId:a,isFieldExpanded:!0})),n(X());},showLessValues(){let S=s.numberOfValues,F=Math.max(S,p());n(co({facetId:a,numberOfValues:F})),n(uo({facetId:a,isFieldExpanded:!1})),n(X());},enable(){n(Qe(a));},disable(){n(de(a));},get state(){let S=c(),F=u(),y=l(),A=d(),w;typeof S.sortCriteria=="object"?w=S.sortCriteria.order==="descending"?"alphanumericDescending":"alphanumeric":w=S.sortCriteria;let V=F?F.values:[],U=V.some(te=>te.state!=="idle"),Z=F?F.moreValuesAvailable:!1,Y=S.resultsMustMatch;return {label:F?.label,facetId:a,values:V,sortCriterion:w,resultsMustMatch:Y,isLoading:y,hasActiveValues:U,canShowMoreValues:Z,canShowLessValues:m(),enabled:A}}}}function _E(e){return e.addReducers({facetSet:hr,facetOptions:ke,configuration:L,facetSearchSet:ja}),!0}var iC=new $({facetId:or,field:ar,filterFacetCount:ir,injectionDepth:sr,numberOfValues:Dt,sortCriteria:new x({constrainTo:Xu}),resultsMustMatch:new x({constrainTo:$a}),facetSearch:Qa,allowedValues:Lu,hasBreadcrumbs:By,customSort:Mu});function jE(e,t){if(!$E(e));let{dispatch:r}=e,n=aC(e,{...t,options:{...t.options,...t.options.allowedValues&&{allowedValues:{type:"simple",values:t.options.allowedValues}}}},iC),o=()=>n.state.facetId,i=(()=>{let{facetSearch:u}=t.options;return Ju(e,{options:{facetId:o(),...u},select:l=>{r(X()),r(R({legacy:Se({facetId:o(),facetValue:l.rawValue}),next:Re()}));},exclude:l=>{r(X()),r(R({legacy:lt({facetId:o(),facetValue:l.rawValue}),next:rr()}));},isForFieldSuggestions:!1,executeFacetSearchActionCreator:Ee,executeFieldSuggestActionCreator:er})})(),{state:s,...c}=i;return {...n,facetSearch:c,toggleSelect(u){n.toggleSelect(u),r(R({legacy:Yu(o(),u),next:Ku(u)}));},toggleExclude(u){n.toggleExclude(u),r(R({legacy:Zy(o(),u),next:eC(u)}));},deselectAll(){n.deselectAll(),r(R({legacy:Ie(o()),next:Be()}));},sortBy(u){n.sortBy(u),r(R({legacy:tr({facetId:o(),criterion:u}),next:In()}));},isSortedBy(u){return this.state.sortCriterion===u},showMoreValues(){n.showMoreValues(),r(Yt({legacy:Na(o())}));},showLessValues(){n.showLessValues(),r(Yt({legacy:La(o())}));},get state(){return {...n.state,facetSearch:i.state}}}}function $E(e){return e.addReducers({facetSet:hr,configuration:L,facetSearchSet:ja,search:j}),!0}var Zu=e=>e.state==="selected",Tm=e=>e.state==="excluded",el=(e,t)=>{let r=`${t.start}..${t.end}`,n={facetId:e,facetValue:r};return Zu(t)?qt(n):Se(n)},tl=e=>Zu(e)?Mr():Re(),sC=(e,t)=>{let r=`${t.start}..${t.end}`,n={facetId:e,facetValue:r};return Tm(t)?Lr(n):lt(n)};var rl=f("rangeFacet/executeToggleSelect",e=>g(e,fo(e.selection))),nl=f("rangeFacet/executeToggleExclude",e=>g(e,fo(e.selection)));var cC={facetId:H,selection:new E({values:mo})},uC=N("dateFacet/executeToggleSelect",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,cC),t(pr(e)),t(rl(e)),t(X());}),lC=N("dateFacet/executeToggleExclude",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,cC),t(mr(e)),t(nl(e)),t(X());});var al={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"ascending",rangeAlgorithm:"even",resultsMustMatch:"atLeastOneValue"};function il(e,t){let{request:r}=t,{facetId:n}=r;if(n in e)return;let o=dC(r);r.numberOfValues=o,e[n]=t;}function sl(e,t,r){let n=e[t]?.request;n&&(n.currentValues=r,n.numberOfValues=dC(n));}function cl(e,t,r){let n=e[t]?.request;if(!n)return;let o=ol(n.currentValues,r);if(!o)return;let a=o.state==="selected";o.state=a?"idle":"selected",n.preventAutoSelect=!0;}function ul(e,t,r){let n=e[t]?.request;if(!n)return;let o=ol(n.currentValues,r);if(!o)return;let a=o.state==="excluded";o.state=a?"idle":"excluded",n.preventAutoSelect=!0;}function Tn(e,t){let r=e[t]?.request;r&&r.currentValues.forEach(n=>n.state="idle");}function ll(e,t){Object.entries(e).forEach(([r,{request:n}])=>{let o=t[r]||[];n.currentValues.forEach(s=>{let c=!!ol(o,s);return s.state=c?"selected":"idle",s});let a=o.filter(s=>!ol(n.currentValues,s)),i=n.currentValues;i.push(...a),n.numberOfValues=Math.max(n.numberOfValues,i.length);});}function Ha(e,t,r){t.forEach(n=>{let o=n.facetId,a=e[o]?.request;if(!a)return;let i=r(n.values);a.currentValues=i,a.preventAutoSelect=!1;});}function ol(e,t){let{start:r,end:n}=t;return e.find(o=>o.start===r&&o.end===n)}function dC(e){let{generateAutomaticRanges:t,currentValues:r,numberOfValues:n}=e;return t?Math.max(n,r.length):r.length}var yr=k(Xr(),e=>{e.addCase(dr,(t,r)=>{let{payload:n}=r,o=HE(n);il(t,dg(o));}).addCase(ne.fulfilled,(t,r)=>r.payload?.dateFacetSet??t).addCase(oe,(t,r)=>{let n=r.payload.df||{};ll(t,n);}).addCase(pr,(t,r)=>{let{facetId:n,selection:o}=r.payload;cl(t,n,o);}).addCase(mr,(t,r)=>{let{facetId:n,selection:o}=r.payload;ul(t,n,o);}).addCase(Br,(t,r)=>{let{facetId:n,values:o}=r.payload;sl(t,n,o);}).addCase(Uu,(t,r)=>{Tn(t,r.payload);}).addCase(le,t=>{Object.keys(t).forEach(r=>{Tn(t,r);});}).addCase(Bu,(t,r)=>{wa(t,r.payload);}).addCase(R.fulfilled,(t,r)=>{let n=r.payload.response.facets;Ha(t,n,pC);}).addCase(On.fulfilled,(t,r)=>{let n=r.payload.response?.facets?.results||[];Ha(t,n,pC);}).addCase(de,(t,r)=>{Tn(t,r.payload);});});function HE(e){return {...al,currentValues:[],preventAutoSelect:!1,type:"dateRange",...e}}function pC(e){return e.map(t=>{let{numberOfResults:r,...n}=t;return n})}function dl(e,t){let{facetId:r,getRequest:n}=t,o=O(e),a=e.dispatch,i=()=>nr(e.state,r);return {...o,isValueSelected:Zu,isValueExcluded:Tm,deselectAll(){a(pe(r)),a(X());},sortBy(s){a(Ua({facetId:r,criterion:s})),a(X());},isSortedBy(s){return this.state.sortCriterion===s},enable(){a(Qe(r));},disable(){a(de(r));},get state(){let s=n(),c=_t(e.state,r),u=s.sortCriteria,l=s.resultsMustMatch,d=c?c.values:[],p=jt(e.state),m=i(),S=d.some(F=>F.state!=="idle");return {facetId:r,values:d,sortCriterion:u,resultsMustMatch:l,hasActiveValues:S,isLoading:p,enabled:m}}}}function pl(e,t){if(!e.generateAutomaticRanges&&e.currentValues===void 0){let r=`currentValues should be specified for ${t} when generateAutomaticRanges is false.`;throw new Error(r)}}var ml=["idle","selected","excluded"];var fl=["ascending","descending"],gl=["even","equiprobable"];var zE={start:new x,end:new x,endInclusive:new Q,state:new x({constrainTo:ml})},GE=new $({facetId:or,field:ar,generateAutomaticRanges:Nu,filterFacetCount:ir,injectionDepth:sr,numberOfValues:Dt,currentValues:new B({each:new E({values:zE})}),sortCriteria:new x({constrainTo:fl}),rangeAlgorithm:new x({constrainTo:gl})});function Sl(e,t){ue(e,GE,t,"buildDateFacet"),Qu(t);}function mC(e,t){if(!WE(e));pl(t.options,"buildDateFacet");let r=e.dispatch,n=Ue(e,t.options),o={currentValues:[],...t.options,facetId:n};Sl(e,o),r(dr(o));let a=dl(e,{facetId:n,getRequest:()=>e.state.dateFacetSet[n].request});return {...a,toggleSelect:i=>r(uC({facetId:n,selection:i})),toggleSingleSelect:function(i){i.state==="idle"&&r(pe(n)),this.toggleSelect(i);},toggleExclude:i=>r(lC({facetId:n,selection:i})),toggleSingleExclude:function(i){i.state==="idle"&&r(pe(n)),this.toggleExclude(i);},get state(){return a.state}}}function WE(e){return e.addReducers({configuration:L,search:j,dateFacetSet:yr,facetOptions:ke}),!0}function YE(e,t){let r=mC(e,t),n=e.dispatch,o=()=>r.state.facetId;return {...r,deselectAll(){r.deselectAll(),n(R({legacy:Ie(o()),next:Be()}));},sortBy(a){r.sortBy(a),n(R({legacy:tr({facetId:o(),criterion:a}),next:In()}));},toggleSelect:a=>{r.toggleSelect(a),n(R({legacy:el(o(),a),next:tl(a)}));},toggleExclude:a=>{r.toggleExclude(a),n(R({legacy:sC(o(),a)}));},get state(){return r.state}}}var ht=k(Zr(),e=>{e.addCase(fr,(t,r)=>{let{payload:n}=r,o=KE(n);il(t,pg(o));}).addCase(ne.fulfilled,(t,r)=>r.payload?.numericFacetSet??t).addCase(oe,(t,r)=>{let n=r.payload.nf||{};ll(t,n);}).addCase(gr,(t,r)=>{let{facetId:n,selection:o}=r.payload;cl(t,n,o);}).addCase(Sr,(t,r)=>{let{facetId:n,selection:o}=r.payload;ul(t,n,o);}).addCase(Ur,(t,r)=>{let{facetId:n,values:o}=r.payload;sl(t,n,o);}).addCase($u,(t,r)=>{Tn(t,r.payload);}).addCase(le,t=>{Object.keys(t).forEach(r=>{Tn(t,r);});}).addCase(ju,(t,r)=>{wa(t,r.payload);}).addCase(R.fulfilled,(t,r)=>{let n=r.payload.response.facets;Ha(t,n,fC);}).addCase(On.fulfilled,(t,r)=>{let n=r.payload.response?.facets?.results||[];Ha(t,n,fC);}).addCase(de,(t,r)=>{Tn(t,r.payload);});});function KE(e){return {...al,currentValues:[],preventAutoSelect:!1,type:"numericalRange",...e}}function fC(e){return e.map(t=>{let{numberOfResults:r,...n}=t;return n})}var gC={facetId:H,selection:new E({values:po})},SC=N("numericFacet/executeToggleSelect",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,gC),t(gr(e)),t(rl(e)),t(X());});N("numericFacet/executeToggleExclude",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,gC),t(Sr(e)),t(nl(e)),t(X());});var JE={start:new I,end:new I,endInclusive:new Q,state:new x({constrainTo:ml})},XE=new $({facetId:or,field:ar,generateAutomaticRanges:Nu,filterFacetCount:ir,injectionDepth:sr,numberOfValues:Dt,currentValues:new B({each:new E({values:JE})}),sortCriteria:new x({constrainTo:fl}),resultsMustMatch:new x({constrainTo:$a}),rangeAlgorithm:new x({constrainTo:gl})});function hl(e,t){ue(e,XE,t,"buildNumericFacet"),_u(t);}function xs(e){return {endInclusive:!1,state:"idle",...e}}function hC(e,t){if(!ZE(e));pl(t.options,"buildNumericFacet");let r=e.dispatch,n=Ue(e,t.options),o={currentValues:[],...t.options,facetId:n};hl(e,o),r(fr(o));let a=dl(e,{facetId:n,getRequest:()=>e.state.numericFacetSet[n].request});return {...a,toggleSelect:i=>r(SC({facetId:n,selection:i})),toggleSingleSelect(i){i.state==="idle"&&r(pe(n)),this.toggleSelect(i);},get state(){return a.state}}}function ZE(e){return e.addReducers({numericFacetSet:ht,facetOptions:ke,configuration:L,search:j}),!0}function eI(e,t){if(!tI(e));let r=hC(e,t),n=e.dispatch,o=()=>r.state.facetId;return {...r,deselectAll(){r.deselectAll(),n(R({legacy:Ie(o()),next:Be()}));},sortBy(a){r.sortBy(a),n(R({legacy:tr({facetId:o(),criterion:a}),next:In()}));},toggleSelect:a=>{r.toggleSelect(a),n(R({legacy:el(o(),a),next:tl(a)}));},get state(){return {...r.state}}}}function tI(e){return e.addReducers({numericFacetSet:ht,configuration:L,search:j}),!0}function rI(e,t){return !!t&&t.facetId in e.numericFacetSet}var yC=(e,t)=>{let r=_t(e,t);if(rI(e,r))return r},CC=(e,t)=>(yC(e,t)||{values:[]}).values.filter(n=>n.state!=="idle"),xC=(e,t)=>(yC(e,t)||{values:[]}).values.filter(n=>n.state==="selected");function FC(e,t){if(!nI(e));let r=O(e),{dispatch:n}=e,o=()=>e.state,a=Ue(e,t.options),i={...t.options,currentValues:t.initialState?.range?[{...t.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:a};hl(e,i),n(fr(i));let s=()=>nr(e.state,a);return {...r,clear:()=>{n(Ur({facetId:a,values:[]})),n(X());},setRange:c=>{let u={...c,state:"selected",numberOfResults:0,endInclusive:!0},l=Ur({facetId:a,values:[u]});return l.error?!1:(n(l),n(X()),!0)},enable(){n(Qe(a));},disable(){n(de(a));},get state(){let c=jt(o()),u=s(),l=xC(o(),a),d=l.length?l[0]:void 0;return {facetId:a,isLoading:c,range:d,enabled:u}}}}function nI(e){return e.addReducers({numericFacetSet:ht,facetOptions:ke,configuration:L,search:j}),!0}function oI(e,t){if(!aI(e));let r=FC(e,t),{dispatch:n}=e,o=()=>r.state.facetId;return {...r,clear:()=>{r.clear(),n(R({legacy:Ie(o()),next:Be()}));},setRange:a=>{let i=r.setRange(a);return i&&n(R({legacy:Se({facetId:o(),facetValue:`${a.start}..${a.end}`}),next:Re()})),i},get state(){return {...r.state}}}}function aI(e){return e.addReducers({numericFacetSet:ht,configuration:L,search:j}),!0}function iI(e,t){return !!t&&t.facetId in e.dateFacetSet}var AC=(e,t)=>{let r=_t(e,t);if(iI(e,r))return r},RC=(e,t)=>(AC(e,t)||{values:[]}).values.filter(n=>n.state==="selected"),bC=(e,t)=>(AC(e,t)||{values:[]}).values.filter(n=>n.state!=="idle");function vC(e,t){if(!sI(e));let r=O(e),{dispatch:n}=e,o=()=>e.state,a=Ue(e,t.options),i={...t.options,currentValues:t.initialState?.range?[{...t.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:a};Sl(e,i),n(dr(i));let s=()=>nr(e.state,a);return {...r,clear:()=>{n(Br({facetId:a,values:[]})),n(X());},setRange:c=>{let u={...c,state:"selected",numberOfResults:0,endInclusive:!0},l=Br({facetId:a,values:[u]});return l.error?!1:(n(l),n(X()),!0)},enable(){n(Qe(a));},disable(){n(de(a));},get state(){let c=jt(o()),u=s(),l=RC(o(),a),d=l.length?l[0]:void 0;return {facetId:a,isLoading:c,range:d,enabled:u}}}}function sI(e){return e.addReducers({dateFacetSet:yr,facetOptions:ke,configuration:L,search:j}),!0}function cI(e,t){if(!uI(e));let r=vC(e,t),{dispatch:n}=e,o=()=>r.state.facetId;return {...r,clear:()=>{r.clear(),n(R({legacy:Ie(o()),next:Be()}));},setRange:a=>{let i=r.setRange(a);return i&&n(R({legacy:Se({facetId:o(),facetValue:`${a.start}..${a.end}`}),next:Re()})),i},get state(){return {...r.state}}}}function uI(e){return e.addReducers({dateFacetSet:yr,configuration:L,search:j}),!0}var yl=k(Po(),e=>{e.addCase(R.fulfilled,qm).addCase(Oa.fulfilled,qm).addCase(qa.fulfilled,qm).addCase(ne.fulfilled,(t,r)=>r.payload?.facetOrder??t);});function qm(e,t){return t.payload.response.facets.map(r=>r.facetId)}var Cl=()=>b("history/analytics/forward",e=>e.makeSearchEvent("historyForward")),xl=()=>b("history/analytics/backward",e=>e.makeSearchEvent("historyBackward")),Fl=()=>b("history/analytics/noresultsback",e=>e.makeNoResultsBack()),PC=()=>({actionCause:"historyForward"}),wC=()=>({actionCause:"historyBackward"}),EC=()=>({actionCause:"noResultsBack"});var lI=Object.getOwnPropertyNames,dI=Object.getOwnPropertySymbols,pI=Object.prototype.hasOwnProperty;function IC(e,t){return function(n,o,a){return e(n,o,a)&&t(n,o,a)}}function Al(e){return function(r,n,o){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,o);var a=o.cache,i=a.get(r),s=a.get(n);if(i&&s)return i===n&&s===r;a.set(r,n),a.set(n,r);var c=e(r,n,o);return a.delete(r),a.delete(n),c}}function kC(e){return lI(e).concat(dI(e))}var LC=Object.hasOwn||function(e,t){return pI.call(e,t)};function za(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var MC="_owner",OC=Object.getOwnPropertyDescriptor,TC=Object.keys;function mI(e,t,r){var n=e.length;if(t.length!==n)return !1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return !1;return !0}function fI(e,t){return za(e.getTime(),t.getTime())}function qC(e,t,r){if(e.size!==t.size)return !1;for(var n={},o=e.entries(),a=0,i,s;(i=o.next())&&!i.done;){for(var c=t.entries(),u=!1,l=0;(s=c.next())&&!s.done;){var d=i.value,p=d[0],m=d[1],S=s.value,F=S[0],y=S[1];!u&&!n[l]&&(u=r.equals(p,F,a,l,e,t,r)&&r.equals(m,y,p,F,e,t,r))&&(n[l]=!0),l++;}if(!u)return !1;a++;}return !0}function gI(e,t,r){var n=TC(e),o=n.length;if(TC(t).length!==o)return !1;for(var a;o-- >0;)if(a=n[o],a===MC&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!LC(t,a)||!r.equals(e[a],t[a],a,a,e,t,r))return !1;return !0}function Fs(e,t,r){var n=kC(e),o=n.length;if(kC(t).length!==o)return !1;for(var a,i,s;o-- >0;)if(a=n[o],a===MC&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!LC(t,a)||!r.equals(e[a],t[a],a,a,e,t,r)||(i=OC(e,a),s=OC(t,a),(i||s)&&(!i||!s||i.configurable!==s.configurable||i.enumerable!==s.enumerable||i.writable!==s.writable)))return !1;return !0}function SI(e,t){return za(e.valueOf(),t.valueOf())}function hI(e,t){return e.source===t.source&&e.flags===t.flags}function DC(e,t,r){if(e.size!==t.size)return !1;for(var n={},o=e.values(),a,i;(a=o.next())&&!a.done;){for(var s=t.values(),c=!1,u=0;(i=s.next())&&!i.done;)!c&&!n[u]&&(c=r.equals(a.value,i.value,a.value,i.value,e,t,r))&&(n[u]=!0),u++;if(!c)return !1}return !0}function yI(e,t){var r=e.length;if(t.length!==r)return !1;for(;r-- >0;)if(e[r]!==t[r])return !1;return !0}var CI="[object Arguments]",xI="[object Boolean]",FI="[object Date]",AI="[object Map]",RI="[object Number]",bI="[object Object]",vI="[object RegExp]",PI="[object Set]",wI="[object String]",EI=Array.isArray,VC=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,NC=Object.assign,II=Object.prototype.toString.call.bind(Object.prototype.toString);function kI(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areMapsEqual,o=e.areObjectsEqual,a=e.arePrimitiveWrappersEqual,i=e.areRegExpsEqual,s=e.areSetsEqual,c=e.areTypedArraysEqual;return function(l,d,p){if(l===d)return !0;if(l==null||d==null||typeof l!="object"||typeof d!="object")return l!==l&&d!==d;var m=l.constructor;if(m!==d.constructor)return !1;if(m===Object)return o(l,d,p);if(EI(l))return t(l,d,p);if(VC!=null&&VC(l))return c(l,d,p);if(m===Date)return r(l,d,p);if(m===RegExp)return i(l,d,p);if(m===Map)return n(l,d,p);if(m===Set)return s(l,d,p);var S=II(l);return S===FI?r(l,d,p):S===vI?i(l,d,p):S===AI?n(l,d,p):S===PI?s(l,d,p):S===bI?typeof l.then!="function"&&typeof d.then!="function"&&o(l,d,p):S===CI?o(l,d,p):S===xI||S===RI||S===wI?a(l,d,p):!1}}function OI(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,o={areArraysEqual:n?Fs:mI,areDatesEqual:fI,areMapsEqual:n?IC(qC,Fs):qC,areObjectsEqual:n?Fs:gI,arePrimitiveWrappersEqual:SI,areRegExpsEqual:hI,areSetsEqual:n?IC(DC,Fs):DC,areTypedArraysEqual:n?Fs:yI};if(r&&(o=NC({},o,r(o))),t){var a=Al(o.areArraysEqual),i=Al(o.areMapsEqual),s=Al(o.areObjectsEqual),c=Al(o.areSetsEqual);o=NC({},o,{areArraysEqual:a,areMapsEqual:i,areObjectsEqual:s,areSetsEqual:c});}return o}function TI(e){return function(t,r,n,o,a,i,s){return e(t,r,s)}}function qI(e){var t=e.circular,r=e.comparator,n=e.createState,o=e.equals,a=e.strict;if(n)return function(c,u){var l=n(),d=l.cache,p=d===void 0?t?new WeakMap:void 0:d,m=l.meta;return r(c,u,{cache:p,equals:o,meta:m,strict:a})};if(t)return function(c,u){return r(c,u,{cache:new WeakMap,equals:o,meta:void 0,strict:a})};var i={cache:void 0,equals:o,meta:void 0,strict:a};return function(c,u){return r(c,u,i)}}Cr();Cr({strict:!0});Cr({circular:!0});Cr({circular:!0,strict:!0});Cr({createInternalComparator:function(){return za}});Cr({strict:!0,createInternalComparator:function(){return za}});Cr({circular:!0,createInternalComparator:function(){return za}});Cr({circular:!0,createInternalComparator:function(){return za},strict:!0});function Cr(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,o=e.createState,a=e.strict,i=a===void 0?!1:a,s=OI(e),c=kI(s),u=n?n(c):TI(c);return qI({circular:r,comparator:c,createState:o,equals:u,strict:i})}function go(e,t,r=(n,o)=>n===o){return e.length===t.length&&e.findIndex((n,o)=>!r(t[o],n))===-1}function DI(e,t){return e.length!==t.length?!1:e.every(r=>t.findIndex(n=>As(r,n))!==-1)}var As=Cr({createCustomConfig:e=>({...e,areArraysEqual:DI})});var VI=k(sc(),e=>{e.addCase(ut,(t,r)=>NI(t,r.payload)?void 0:r.payload);}),NI=(e,t)=>LI(e.context,t.context)&&MI(e.dictionaryFieldContext,t.dictionaryFieldContext)&&HI(e.advancedSearchQueries,t.advancedSearchQueries)&&QI(e.tabSet,t.tabSet)&&BI(e.staticFilterSet,t.staticFilterSet)&&Dm(e.facetSet,t.facetSet)&&Dm(e.dateFacetSet,t.dateFacetSet)&&Dm(e.numericFacetSet,t.numericFacetSet)&&_I(e.automaticFacetSet,t.automaticFacetSet)&&UI(e.categoryFacetSet,t.categoryFacetSet)&&jI(e.pagination,t.pagination)&&$I(e.query,t.query)&&zI(e,t)&&GI(e.pipeline,t.pipeline)&&WI(e.searchHub,t.searchHub)&&YI(e.facetOrder,t.facetOrder)&&KI(e.debug,t.debug),LI=(e,t)=>JSON.stringify(e.contextValues)===JSON.stringify(t.contextValues),MI=(e,t)=>JSON.stringify(e.contextValues)===JSON.stringify(t.contextValues),QI=(e,t)=>{let r=QC(e),n=QC(t);return r?.id===n?.id},QC=e=>Object.values(e).find(t=>t.isActive),BI=(e,t)=>{for(let[r,n]of Object.entries(t)){if(!e[r])return !1;let o=BC(e[r]),a=BC(n);if(JSON.stringify(o)!==JSON.stringify(a))return !1}return !0},BC=e=>e.values.filter(t=>t.state!=="idle"),Dm=(e,t)=>{for(let[r,n]of Object.entries(t)){if(!e[r])return !1;let o=e[r].request.currentValues.filter(i=>i.state!=="idle"),a=n.request.currentValues.filter(i=>i.state!=="idle");if(JSON.stringify(o)!==JSON.stringify(a))return !1}return !0},UI=(e,t)=>{for(let[r,n]of Object.entries(t)){if(!e[r])return !1;let o=st(e[r]?.request.currentValues).map(({value:i})=>i),a=st(n?.request.currentValues).map(({value:i})=>i);if(JSON.stringify(o)!==JSON.stringify(a))return !1}return !0},_I=(e,t)=>{for(let[r,n]of Object.entries(t.set)){if(!e.set[r])return !1;let o=e.set[r].response.values.filter(i=>i.state!=="idle"),a=n.response.values.filter(i=>i.state!=="idle");if(JSON.stringify(o)!==JSON.stringify(a))return !1}return !0},jI=(e,t)=>e.firstResult===t.firstResult&&e.numberOfResults===t.numberOfResults,$I=(e,t)=>JSON.stringify(e)===JSON.stringify(t),HI=(e,t)=>JSON.stringify(e)===JSON.stringify(t),zI=(e,t)=>e.sortCriteria===t.sortCriteria,GI=(e,t)=>e===t,WI=(e,t)=>e===t,YI=(e,t)=>go(e,t),KI=(e,t)=>e===t,Rl=qf({actionTypes:{redo:em.type,undo:Zp.type,snapshot:ut.type},reducer:VI});function JI(e){if(!XI(e));let t=O(e),{dispatch:r}=e,n=()=>e.state,o=a=>a.past.length>0&&!M(a.present);return {...t,subscribe(a){a();let i=JSON.stringify(n().history.present),s=()=>{let c=JSON.stringify(n().history.present);i!==c&&(i=c,a());};return e.subscribe(()=>s())},get state(){return n().history},async back(){o(this.state)&&(await r(as()),r(R({legacy:xl(),next:wC()})));},async forward(){!this.state.future.length||!this.state.present||(await r(eu()),r(R({legacy:Cl(),next:PC()})));},async backOnNoResults(){o(this.state)&&(await r(as()),r(R({legacy:Fl(),next:EC()})));}}}function XI(e){return e.addReducers({history:Rl,configuration:L,facetOrder:yl}),!0}var rk=new I({min:1,default:8,required:!1}),nk=new I({min:1,max:20,default:5,required:!1}),ok={desiredCount:nk,numberOfValues:rk},bl=f("automaticFacet/setOptions",e=>g(e,ok)),vl=f("automaticFacet/deselectAll",e=>g(e,H)),ak=P,qn=f("automaticFacet/toggleSelectValue",e=>g(e,{field:ak,selection:new E({values:so})}));var xr=k(ze(),e=>{e.addCase(ra,(t,r)=>{let n=Vm(t),o=r.payload;t.defaultNumberOfResults=t.numberOfResults=o,t.firstResult=Rs(n,o);}).addCase(na,(t,r)=>{t.numberOfResults=r.payload,t.firstResult=0;}).addCase(kt,t=>{t.firstResult=0;}).addCase(oa,(t,r)=>{let n=r.payload;t.firstResult=Rs(n,t.numberOfResults);}).addCase(Xe,(t,r)=>{let n=r.payload;t.firstResult=Rs(n,t.numberOfResults);}).addCase(ia,t=>{let r=Vm(t),n=Math.max(r-1,1);t.firstResult=Rs(n,t.numberOfResults);}).addCase(aa,t=>{let r=Vm(t),n=ik(t),o=Math.min(r+1,n);t.firstResult=Rs(o,t.numberOfResults);}).addCase(ne.fulfilled,(t,r)=>{r.payload&&(t.numberOfResults=r.payload.pagination.numberOfResults,t.firstResult=r.payload.pagination.firstResult);}).addCase(oe,(t,r)=>{t.firstResult=r.payload.firstResult??t.firstResult,t.numberOfResults=r.payload.numberOfResults??t.defaultNumberOfResults;}).addCase(R.fulfilled,(t,r)=>{let{response:n}=r.payload;t.totalCountFiltered=n.totalCountFiltered;}).addCase(On.fulfilled,(t,r)=>{let{response:n}=r.payload;t.totalCountFiltered=n.pagination.totalCount;}).addCase(pe,t=>{_e(t);}).addCase(mr,t=>{_e(t);}).addCase(lr,t=>{_e(t);}).addCase(Sr,t=>{_e(t);}).addCase(ao,t=>{_e(t);}).addCase(ur,t=>{_e(t);}).addCase(Jt,t=>{_e(t);}).addCase(xn,t=>{_e(t);}).addCase(va,t=>{_e(t);}).addCase(pr,t=>{_e(t);}).addCase(gr,t=>{_e(t);}).addCase(le,t=>{_e(t);}).addCase(Br,t=>{_e(t);}).addCase(Ur,t=>{_e(t);}).addCase(oo,t=>{_e(t);}).addCase(qn,t=>{_e(t);});});function _e(e){e.firstResult=ze().firstResult;}function Vm(e){let{firstResult:t,numberOfResults:r}=e;return Nm(t,r)}function ik(e){let{totalCountFiltered:t,numberOfResults:r}=e;return Lm(t,r)}function Rs(e,t){return (e-1)*t}function Nm(e,t){return Math.round(e/t)+1}function Lm(e,t){let r=Math.min(e,5e3);return Math.ceil(r/t)}function sk(e){return e.pagination.firstResult}function UC(e){return e.pagination.numberOfResults}function ck(e){return e.pagination.totalCountFiltered}var Dn=e=>{let t=sk(e),r=UC(e);return Nm(t,r)},Pl=e=>{let t=ck(e),r=UC(e);return Lm(t,r)},Mm=(e,t)=>{let r=Dn(e),n=Pl(e),o=uk(r,t);return o=lk(o),o=dk(o,n),pk(o)};function uk(e,t){let r=t%2===0,n=Math.floor(t/2),o=r?n-1:n,a=e-n,i=e+o;return {start:a,end:i}}function lk(e){let t=Math.max(1-e.start,0),r=e.start+t,n=e.end+t;return {start:r,end:n}}function dk(e,t){let r=Math.max(e.end-t,0),n=Math.max(e.start-r,1),o=e.end-r;return {start:n,end:o}}function pk(e){let t=[];for(let r=e.start;r<=e.end;++r)t.push(r);return t}var Wa=()=>b("analytics/pager/resize",(e,t)=>e.makePagerResize({currentResultsPerPage:t.pagination?.numberOfResults||ze().numberOfResults})),Ya=()=>b("analytics/pager/number",(e,t)=>e.makePagerNumber({pagerNumber:Dn(t)})),wl=()=>b("analytics/pager/next",(e,t)=>e.makePagerNext({pagerNumber:Dn(t)})),El=()=>b("analytics/pager/previous",(e,t)=>e.makePagerPrevious({pagerNumber:Dn(t)}));var mk=new $({numberOfPages:new I({default:5,min:0})}),fk=new $({page:new I({min:1})});function _C(e,t={}){if(!gk(e));let r=O(e),{dispatch:n}=e,o=ue(e,mk,t.options,"buildPager"),i=Ce(e,fk,t.initialState,"buildPager").page;i&&n(oa(i));let s=()=>Dn(e.state),c=()=>{let{numberOfPages:l}=o;return Mm(e.state,l)},u=()=>Pl(e.state);return {...r,get state(){let l=s(),d=u(),p=l>1&&d>0,m=l<d;return {currentPage:l,currentPages:c(),maxPage:d,hasPreviousPage:p,hasNextPage:m}},selectPage(l){n(Xe(l));},nextPage(){n(aa());},previousPage(){n(ia());},isCurrentPage(l){return l===this.state.currentPage}}}function gk(e){return e.addReducers({configuration:L,pagination:xr}),!0}function Sk(e,t={}){let{dispatch:r}=e,n=_C(e,t);return {...n,get state(){return n.state},selectPage(o){n.selectPage(o),r(Wt({legacy:Ya()}));},nextPage(){n.nextPage(),r(Wt({legacy:wl()}));},previousPage(){n.previousPage(),r(Wt({legacy:El()}));}}}function jC(e){if(!hk(e));let t=O(e),r=()=>e.state;return {...t,get state(){return {hasError:r().search.error!==null,error:r().search.error}}}}function hk(e){return e.addReducers({search:j}),!0}function yk(e){return jC(e)}function Ka(e){if(!Ck(e));let t=O(e),r=()=>e.state;return {...t,get state(){let n=r();return {hasError:n.search.error!==null,isLoading:n.search.isLoading,hasResults:!!n.search.results.length,firstSearchExecuted:ds(n)}}}}function Ck(e){return e.addReducers({search:j}),!0}function $C(e){if(!xk(e));let t=O(e),r=Ka(e),n=()=>e.state,o=()=>{let a=n().search.duration/1e3;return Math.round((a+Number.EPSILON)*100)/100};return {...t,get state(){return {...r.state,durationInMilliseconds:n().search.duration,durationInSeconds:o(),firstResult:n().pagination.firstResult+1,hasDuration:n().search.duration!==0,hasQuery:n().search.queryExecuted!=="",lastResult:n().pagination.firstResult+n().search.results.length,query:n().search.queryExecuted,total:n().pagination.totalCountFiltered}}}}function xk(e){return e.addReducers({search:j,pagination:xr}),!0}function Fk(e){return $C(e)}var Ak=new $({fieldsToInclude:new B({required:!1,each:new x({required:!0,emptyAllowed:!1})})});function Il(e,t){if(!Rk(e));let r=O(e),n=Ka(e),{dispatch:o}=e,a=()=>e.state,i=ue(e,Ak,t?.options,"buildCoreResultList");i.fieldsToInclude&&o(Sn(i.fieldsToInclude));let s=()=>e.state.search.results.length<e.state.search.response.totalCountFiltered,c=0,u=0,l=5,d=200,p=!1;return {...r,get state(){let S=a();return {...n.state,results:S.search.results,moreResultsAvailable:s(),searchResponseId:S.search.searchResponseId}},fetchMoreResults:async()=>{if(e.state.search.isLoading)return;if(!s()){e.logger.info("No more results are available for the result list to fetch.");return}if(Date.now()-c<d){if(u++,u>=l){c=Date.now(),!p&&e.logger.error(`The result list method "fetchMoreResults" execution prevented because it has been triggered consecutively ${l} times, with little delay. Please verify the conditions under which the function is called.`),p=!0;return}}else u=0;p=!1,t?.fetchMoreResultsActionCreator&&(await o(t?.fetchMoreResultsActionCreator()),c=Date.now());}}}function Rk(e){return e.addReducers({search:j,configuration:L,fields:Cn}),!0}function bk(e,t){return Il(e,{...t,fetchMoreResultsActionCreator:fn})}var vk={results:new B({required:!0,each:new E({values:os})}),maxLength:new I({required:!0,min:1,default:10})},Ja=f("recentResults/registerRecentResults",e=>g(e,vk)),yt=f("recentResults/pushRecentResult",e=>(Ke(e),{payload:e})),Xa=f("recentResults/clearRecentResults");var kl=e=>b({prefix:"analytics/result/open",__legacy__getBuilder:(t,r)=>(Ke(e),t.makeDocumentOpen(xe(e,r),Fe(e))),analyticsType:"itemClick",analyticsPayloadBuilder:t=>{let r=xe(e,t),n=Fe(e);return {searchUid:t.search?.response.searchUid??"",position:r.documentPosition,itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}});function et(e,t,r){if(!Pk(e));let n=1e3,o={selectionDelay:n,debounceWait:n,...t.options},a;return {select:yu(r,o.debounceWait,{isImmediate:!0}),beginDelayedSelect(){a=setTimeout(r,o.selectionDelay);},cancelPendingSelect(){a&&clearTimeout(a);}}}function Pk(e){return e.addReducers({configuration:L}),!0}function wk(e,t){let r=!1,n=()=>{r||(r=!0,e.dispatch(kl(t.options.result)));};return et(e,t,()=>{n(),e.dispatch(yt(t.options.result));})}function Ek(e,t){let r=!1,n=()=>{r||(r=!0,e.dispatch(ph(t.options.result)));};return et(e,t,()=>{n(),e.dispatch(yt(t.options.result));})}var Ik=new $({numberOfResults:new I({min:0})});function HC(e,t={}){if(!kk(e));let r=O(e),{dispatch:n}=e,o=()=>e.state,i=Ce(e,Ik,t.initialState,"buildResultsPerPage").numberOfResults;return i!==void 0&&n(ra(i)),{...r,get state(){return {numberOfResults:o().pagination.numberOfResults}},set(s){n(na(s));},isSetTo(s){return s===this.state.numberOfResults}}}function kk(e){return e.addReducers({pagination:xr,configuration:L}),!0}function Ok(e,t={}){if(!Tk(e));let r=HC(e,t),{dispatch:n}=e;return {...r,get state(){return {...r.state}},set(o){r.set(o),n(Wt({legacy:Wa()}));}}}function Tk(e){return e.addReducers({pagination:xr,configuration:L}),!0}var Vn=()=>b("analytics/searchbox/submit",e=>e.makeSearchboxSubmit()),Ol=()=>({actionCause:"searchboxSubmit"});var zC={id:P,query:ce},Za=f("querySet/register",e=>g(e,zC)),So=f("querySet/update",e=>g(e,zC));var GC={q:new x},WC={};var YC=f("commerce/searchParameters/restore",e=>g(e,GC));f("commerce/productListingParameters/restore",e=>g(e,WC));var ei=k(Eo(),e=>{e.addCase(Za,(t,r)=>{let{id:n,query:o}=r.payload;n in t||(t[n]=o);}).addCase(So,(t,r)=>{let{id:n,query:o}=r.payload;Qm(t,n,o);}).addCase(Zt,(t,r)=>{let{id:n,expression:o}=r.payload;Qm(t,n,o);}).addCase(R.fulfilled,(t,r)=>{let{queryExecuted:n}=r.payload;JC(t,n);}).addCase(oe,KC).addCase(YC,KC).addCase(ne.fulfilled,(t,r)=>{if(r.payload)for(let[n,o]of Object.entries(r.payload.querySet))Qm(t,n,o);});});function KC(e,t){M(t.payload.q)||JC(e,t.payload.q);}function JC(e,t){Object.keys(e).forEach(r=>e[r]=t);}var Qm=(e,t,r)=>{t in e&&(e[t]=r);};var Tl=e=>b("analytics/querySuggest",(t,r)=>{let n=Bm(r,e);return t.makeOmniboxAnalytics(n)}),XC=()=>({actionCause:"omniboxAnalytics"});function Bm(e,t){let{id:r,suggestion:n}=t,o=e.querySuggest&&e.querySuggest[r];if(!o)throw new Error(`Unable to determine the query suggest analytics metadata to send because no query suggest with id "${r}" was found. Please check the sent #id.`);let a=o.completions.map(u=>u.expression),i=o.partialQueries.length-1,s=o.partialQueries[i]||"",c=o.responseId;return {suggestionRanking:a.indexOf(n),partialQuery:s,partialQueries:o.partialQueries,suggestions:a,querySuggestResponseId:c}}var ZC=()=>({});var ti=k(ZC(),e=>e.addCase(Ta,(t,r)=>{let n=r.payload.id;n in t||(t[n]=qk(r.payload));}).addCase(Ey,(t,r)=>{delete t[r.payload.id];}).addCase(bn.pending,ex).addCase(bn.fulfilled,(t,r)=>{let n=t[r.meta.arg.id];if(!n||r.meta.requestId!==n.currentRequestId)return;let{q:o}=r.payload;o&&n.partialQueries.push(o.replace(/;/,encodeURIComponent(";"))),n.responseId=r.payload.responseId,n.completions=r.payload.completions,n.isLoading=!1,n.error=null;}).addCase(bn.rejected,tx).addCase(vn.pending,ex).addCase(vn.fulfilled,(t,r)=>{let n=t[r.meta.arg.id];if(!n||r.meta.requestId!==n.currentRequestId)return;let{query:o}=r.payload;o&&n.partialQueries.push(o.replace(/;/,encodeURIComponent(";"))),n.responseId=r.payload.responseId,n.completions=r.payload.completions.map(a=>({expression:a.expression,highlighted:a.highlighted,score:0,executableConfidence:0})),n.isLoading=!1,n.error=null;}).addCase(vn.rejected,tx).addCase(Rn,(t,r)=>{let n=t[r.payload.id];n&&(n.responseId="",n.completions=[],n.partialQueries=[]);}));function qk(e){return {id:"",completions:[],responseId:"",count:5,currentRequestId:"",error:null,partialQueries:[],isLoading:!1,...e}}function ex(e,t){let r=e[t.meta.arg.id];r&&(r.currentRequestId=t.meta.requestId,r.isLoading=!0);}function tx(e,t){let r=e[t.meta.arg.id];r&&(r.error=t.payload||null,r.isLoading=!1);}var Ct=k(ge(),e=>e.addCase(Me,(t,r)=>({...t,...r.payload})).addCase(St,(t,r)=>{t.q=r.payload;}).addCase(Zt,(t,r)=>{t.q=r.payload.expression;}).addCase(ne.fulfilled,(t,r)=>r.payload?.query??t).addCase(oe,(t,r)=>{t.q=r.payload.q??t.q,t.enableQuerySyntax=r.payload.enableQuerySyntax??t.enableQuerySyntax;}));var ql={enableQuerySyntax:!1,numberOfSuggestions:5,clearFilters:!0},Um={open:new x,close:new x},_m={id:P,numberOfSuggestions:new I({min:0}),enableQuerySyntax:new Q,highlightOptions:new E({values:{notMatchDelimiters:new E({values:Um}),exactMatchDelimiters:new E({values:Um}),correctionDelimiters:new E({values:Um})}}),clearFilters:new Q},rx=new $(_m);function nx(e,t){if(!Vk(e));let r=O(e),{dispatch:n}=e,o=()=>e.state,a=t.options?.id||Gr("search_box"),i={id:a,highlightOptions:{...t.options?.highlightOptions},...ql,...t.options};ue(e,rx,i,"buildSearchBox"),n(Za({id:a,query:e.state.query.q})),i.numberOfSuggestions&&n(Ta({id:a,count:i.numberOfSuggestions}));let s=()=>e.state.querySet[i.id],c=async u=>{let{enableQuerySyntax:l,clearFilters:d}=i;n(Su({q:s(),enableQuerySyntax:l,clearFilters:d})),t.isNextAnalyticsReady?n(t.executeSearchActionCreator(u)):n(t.executeSearchActionCreator(u.legacy));};return {...r,updateText(u){n(So({id:a,query:u})),this.showSuggestions();},clear(){n(So({id:a,query:""})),n(Rn({id:a}));},showSuggestions(){i.numberOfSuggestions&&n(t.fetchQuerySuggestionsActionCreator({id:a}));},selectSuggestion(u){n(Zt({id:a,expression:u})),c({legacy:Tl({id:a,suggestion:u}),next:XC()}).then(()=>{n(Rn({id:a}));});},submit(u=Vn(),l){c({legacy:u,next:l}),n(Rn({id:a}));},get state(){let u=o(),l=u.querySuggest[i.id],d=Dk(l,i.highlightOptions),p=l?l.isLoading:!1;return {value:s(),suggestions:d,isLoading:u.search.isLoading,isLoadingSuggestions:p}}}}function Dk(e,t){return e?e.completions.map(r=>({highlightedValue:ip(r.highlighted,t),rawValue:r.expression})):[]}function Vk(e){return e.addReducers({query:Ct,querySuggest:ti,configuration:L,querySet:ei,search:j}),!0}function jm(e,t={}){let r=nx(e,{...t,executeSearchActionCreator:R,fetchQuerySuggestionsActionCreator:bn,isNextAnalyticsReady:!0});return {...r,submit(){r.submit(Vn(),Ol());},get state(){return r.state}}}function Dl(e){return e?e.expiresAt&&Date.now()>=e.expiresAt:!1}var ox=(e,t)=>{let{id:r}=e;if(!t[r])return t[r]={q:"",cache:{}},t},ax=(e,t)=>{let{q:r,id:n}=e;r&&(t[n].q=r);},ix=(e,t)=>{let{id:r}=e;Object.entries(t[r].cache).forEach(([n,o])=>{Dl(o)&&delete t[r].cache[n];});},sx=(e,t,r)=>{for(let o in t)for(let a in t[o].cache)t[o].cache[a].isActive=!1;if(!$m(e,t)){Nk(e,t,r);return}let n=$m(e,t);n.isLoading=!0,n.isActive=!0,n.error=null;},cx=(e,t,r)=>{let{id:n,q:o,searchUid:a,cacheTimeout:i,totalCountFiltered:s,duration:c}=e;t[n].cache[o]={...$m(e,t),...r,isActive:!0,searchUid:a,isLoading:!1,error:null,expiresAt:i?i+Date.now():0,totalCountFiltered:s,duration:c};},ux=(e,t)=>{let{id:r,q:n,error:o}=e;t[r].cache[n].error=o||null,t[r].cache[n].isLoading=!1,t[r].cache[n].isActive=!1;},$m=(e,t)=>{let{q:r,id:n}=e;return t[n].cache[r]||null},Nk=(e,t,r)=>{let{q:n,id:o}=e;t[o].cache[n]={isLoading:!0,error:null,expiresAt:0,isActive:!0,searchUid:"",totalCountFiltered:0,duration:0,...r};};var Vl=k(cc(),e=>{e.addCase(ea,(t,r)=>{ox(r.payload,t);}),e.addCase(zt,(t,r)=>{ax(r.payload,t);}),e.addCase(ta,(t,r)=>{ix(r.payload,t);}),e.addCase(ya.pending,(t,r)=>{sx(r.meta.arg,t,{results:[]});}),e.addCase(ya.fulfilled,(t,r)=>{let{results:n}=r.payload;cx({...r.payload,...r.meta.arg},t,{results:n});}),e.addCase(ya.rejected,(t,r)=>{ux(r.meta.arg,t);});});var Lk={searchBoxId:re,maxResultsPerQuery:new I({required:!0,min:1}),cacheTimeout:new I},lx=new $(Lk);function Mk(e,t){if(!Qk(e));let r=O(e),{dispatch:n}=e,o=()=>e.state,a={searchBoxId:t.options.searchBoxId||Gr("instant-results-"),cacheTimeout:t.options.cacheTimeout||6e4,maxResultsPerQuery:t.options.maxResultsPerQuery};ue(e,lx,a,"buildInstantResults");let i=a.searchBoxId;n(ea({id:i}));let s=()=>o().instantResults[i],c=d=>s().cache[d],u=()=>s().q,l=()=>{let d=c(u());return d?d.isLoading?[]:d.results:[]};return {...r,updateQuery(d){if(!d)return;let p=c(d);(!p||!p.isLoading&&(p.error||Dl(p)))&&n(ya({id:i,q:d,maxResultsPerQuery:a.maxResultsPerQuery,cacheTimeout:a.cacheTimeout})),n(zt({id:i,q:d}));},clearExpired(){n(ta({id:i}));},get state(){let d=u(),p=c(d);return {q:d,isLoading:p?.isLoading||!1,error:p?.error||null,results:l()}}}}function Qk(e){return e.addReducers({instantResults:Vl}),!0}var ri=()=>b("analytics/sort/results",(e,t)=>e.makeResultsSort({resultsSortBy:t.sortCriteria||Ge()})),Nl=()=>({actionCause:"resultsSort"});var dx={by:new bt({enum:Oo,required:!0})},ni=f("sortCriteria/register",e=>px(e)),oi=f("sortCriteria/update",e=>px(e)),px=e=>ko(e)?(e.forEach(t=>g(t,dx)),{payload:e}):g(e,dx);var Ll=k(Ge(),e=>{e.addCase(ni,(t,r)=>Pr(r.payload)).addCase(oi,(t,r)=>Pr(r.payload)).addCase(ne.fulfilled,(t,r)=>r.payload?.sortCriteria??t).addCase(oe,(t,r)=>r.payload.sortCriteria??t);});function Bk(e,t){if(!t)return;let r=new $({criterion:new B({each:Sg})}),n=Uk(t),o={...t,criterion:n};Ce(e,r,o,"buildSort");}function Uk(e){return e.criterion?ko(e.criterion)?e.criterion:[e.criterion]:[]}function mx(e,t){if(!_k(e));let r=O(e),{dispatch:n}=e,o=()=>e.state;Bk(e,t.initialState);let a=t.initialState?.criterion;return a&&n(ni(a)),{...r,sortBy(i){n(oi(i)),n(Xe(1));},isSortedBy(i){return this.state.sortCriteria===Pr(i)},get state(){return {sortCriteria:o().sortCriteria}}}}function _k(e){return e.addReducers({configuration:L,sortCriteria:Ll}),!0}function jk(e,t={}){let{dispatch:r}=e,n=mx(e,t),o=()=>r(R({legacy:ri(),next:Nl()}));return {...n,get state(){return n.state},sortBy(a){n.sortBy(a),o();}}}var ho=P,Ml=new E({options:{required:!0},values:{caption:ce,expression:ce,state:new x({constrainTo:["idle","selected","excluded"]})}}),Ql=new B({required:!0,each:Ml});var ai=f("staticFilter/register",e=>g(e,{id:ho,values:Ql})),_r=f("staticFilter/toggleSelect",e=>g(e,{id:ho,value:Ml})),jr=f("staticFilter/toggleExclude",e=>g(e,{id:ho,value:Ml})),Nn=f("staticFilter/deselectAllFilterValues",e=>g(e,ho)),ii=e=>b("analytics/staticFilter/deselect",t=>t.makeStaticFilterDeselect(e)),_l=()=>({actionCause:"staticFilterDeselect"});k(To(),e=>e.addCase(ai,(t,r)=>{let n=r.payload,{id:o}=n;o in t||(t[o]=n);}).addCase(_r,(t,r)=>{let{id:n,value:o}=r.payload,a=t[n];if(!a)return;let i=a.values.find(c=>c.caption===o.caption);if(!i)return;let s=i.state==="selected";i.state=s?"idle":"selected";}).addCase(jr,(t,r)=>{let{id:n,value:o}=r.payload,a=t[n];if(!a)return;let i=a.values.find(c=>c.caption===o.caption);if(!i)return;let s=i.state==="excluded";i.state=s?"idle":"excluded";}).addCase(Nn,(t,r)=>{let n=r.payload,o=t[n];o&&o.values.forEach(a=>a.state="idle");}).addCase(le,t=>{Object.values(t).forEach(r=>{r.values.forEach(n=>n.state="idle");});}).addCase(oe,(t,r)=>{let n=r.payload.sf||{};Object.entries(t).forEach(([o,a])=>{let i=n[o]||[];a.values.forEach(s=>{s.state=i.includes(s.caption)?"selected":"idle";});});}));new $({id:ho,values:Ql});var zl=k(qo(),e=>{e.addCase(Ca,(t,r)=>{let n=r.payload,{id:o}=n;o in t||(t[o]={...n,isActive:!1});}).addCase(kt,(t,r)=>{let n=r.payload;hx(t,n);}).addCase(oe,(t,r)=>{let n=r.payload.tab||"";hx(t,n);}).addCase(ne.fulfilled,(t,r)=>r.payload?.tabSet??t);});function hx(e,t){t in e&&Object.keys(e).forEach(n=>{e[n].isActive=n===t;});}var Gk=new $({expression:ce,id:P}),Wk=new $({isActive:new Q});function yx(e,t){if(Kk(t.options.id),!Yk(e));let r=O(e),{dispatch:n}=e;ue(e,Gk,t.options,"buildTab");let o=Ce(e,Wk,t.initialState,"buildTab"),{id:a,expression:i}=t.options;return n(Ca({id:a,expression:i})),o.isActive&&n(kt(a)),{...r,select(){n(kt(a));},get state(){return {isActive:e.state.tabSet[a]?.isActive}}}}function Yk(e){return e.addReducers({configuration:L,tabSet:zl}),!0}function Kk(e){let t=Wr().analytics.originLevel2;if(e===t)throw new Error(`The #id option on the Tab controller cannot use the reserved value "${t}". Please specify a different value.`)}function Jk(e,t){let{dispatch:r}=e,n=yx(e,t),o=()=>r(R({legacy:sn(),next:Ho()}));return {...n,get state(){return n.state},select(){n.select(),o();}}}function Cx(e){if(!Xk(e));let t=O(e),r=()=>e.state;return {...t,sort(n){return la(n,this.state.facetIds)},get state(){return {facetIds:r().search.response.facets.map(a=>a.facetId)}}}}function Xk(e){return e.addReducers({search:j,facetOptions:ke}),!0}function Zk(e){return Cx(e)}var eO={categoryFacetId:H,categoryFacetPath:new B({required:!0,each:P})},tO=(e,{categoryFacetId:t,categoryFacetPath:r})=>{let o=e.categoryFacetSet[t]?.request.field,a=`${o}_${t}`;return {categoryFacetId:t,categoryFacetPath:r,categoryFacetField:o,categoryFacetTitle:a}},Gl=e=>b("analytics/categoryFacet/breadcrumb",(t,r)=>(g(e,eO),t.makeBreadcrumbFacet(tO(r,e)))),xx=()=>({actionCause:"breadcrumbFacet"});var Wl=()=>b("analytics/facet/deselectAllBreadcrumbs",e=>e.makeBreadcrumbResetAll()),Fx=()=>({actionCause:"breadcrumbResetAll"});var Yl=(e,{facetId:t,selection:r})=>{let o=(e.dateFacetSet[t]||e.numericFacetSet[t]).request.field,a=`${o}_${t}`;return {facetId:t,facetField:o,facetTitle:a,facetRangeEndInclusive:r.endInclusive,facetRangeEnd:`${r.end}`,facetRangeStart:`${r.start}`}},Kl=()=>({actionCause:"breadcrumbFacet"});var bs=e=>b("analytics/dateFacet/breadcrumb",(t,r)=>{g(e,fo(e.selection));let n=Yl(r,e);return t.makeBreadcrumbFacet(n)}),Hm=Kl;var vs=e=>b("analytics/numericFacet/breadcrumb",(t,r)=>{g(e,fo(e.selection));let n=Yl(r,e);return t.makeBreadcrumbFacet(n)}),zm=Kl;var Jl=e=>Object.keys(e.facetSet).map(t=>{let r=e.facetValuesSelector(e.engine.state,t).map(n=>({value:n,deselect:()=>{n.state==="selected"?e.executeToggleSelect({facetId:t,selection:n}):n.state==="excluded"&&e.executeToggleExclude({facetId:t,selection:n});}}));return {facetId:t,field:e.facetSet[t].request.field,values:r}}).filter(t=>t.values.length);function Ax(e){let t=O(e),{dispatch:r}=e;return {...t,get state(){return {facetBreadcrumbs:[],categoryFacetBreadcrumbs:[],numericFacetBreadcrumbs:[],dateFacetBreadcrumbs:[],staticFilterBreadcrumbs:[],hasBreadcrumbs:!1}},deselectAll:()=>{r(le());},deselectBreadcrumb(n){n.deselect();}}}function rO(e){if(!nO(e));let t=Ax(e),{dispatch:r}=e,n=()=>e.state,o=()=>{let y={engine:e,facetSet:n().facetSet,executeToggleSelect:({facetId:A,selection:w})=>{r(ur({facetId:A,selection:w})),r(Qr({facetId:A,freezeCurrentValues:!1})),r(R({legacy:Ma({facetId:A,facetValue:w.value}),next:Vu()}));},executeToggleExclude:({facetId:A,selection:w})=>{r(lr({facetId:A,selection:w})),r(Qr({facetId:A,freezeCurrentValues:!1})),r(R({legacy:Ma({facetId:A,facetValue:w.value}),next:Vu()}));},facetValuesSelector:$S};return Jl(y)},a=()=>{let y={engine:e,facetSet:n().numericFacetSet,executeToggleSelect:A=>{r(gr(A)),r(R({legacy:vs(A),next:zm()}));},executeToggleExclude:A=>{r(Sr(A)),r(R({legacy:vs(A),next:zm()}));},facetValuesSelector:CC};return Jl(y)},i=()=>{let y={engine:e,facetSet:n().dateFacetSet,executeToggleSelect:A=>{r(pr(A)),r(R({legacy:bs(A),next:Hm()}));},executeToggleExclude:A=>{r(mr(A)),r(R({legacy:bs(A),next:Hm()}));},facetValuesSelector:bC};return Jl(y)},s=()=>Object.keys(n().categoryFacetSet).map(c).filter(y=>y.path.length),c=y=>{let A=zS(n(),y);return {facetId:y,field:n().categoryFacetSet[y].request.field,path:A,deselect:()=>{r(Jt(y)),r(R({legacy:Gl({categoryFacetPath:A.map(w=>w.value),categoryFacetId:y}),next:xx()}));}}},u=()=>{let y=n().staticFilterSet??{};return Object.values(y).map(l)},l=y=>{let{id:A,values:w}=y,V=w.filter(U=>U.state!=="idle").map(U=>d(A,U));return {id:A,values:V}},d=(y,A)=>({value:A,deselect:()=>{let{caption:w,expression:V}=A;A.state==="selected"?r(_r({id:y,value:A})):A.state==="excluded"&&r(jr({id:y,value:A})),r(R({legacy:ii({staticFilterId:y,staticFilterValue:{caption:w,expression:V}}),next:_l()}));}}),p=()=>{let y=n().automaticFacetSet?.set??{};return Object.values(y).map(A=>m(A.response))},m=y=>{let{field:A,label:w}=y,V=y.values.filter(U=>U.state==="selected").map(U=>S(A,U));return {facetId:A,field:A,label:w,values:V}},S=(y,A)=>({value:A,deselect:()=>{r(qn({field:y,selection:A})),r(R({legacy:Ma({facetId:y,facetValue:A.value}),next:Vu()}));}});function F(){return !![...o(),...a(),...i(),...s(),...u(),...p()].length}return {...t,get state(){return {facetBreadcrumbs:o(),categoryFacetBreadcrumbs:s(),numericFacetBreadcrumbs:a(),dateFacetBreadcrumbs:i(),staticFilterBreadcrumbs:u(),automaticFacetBreadcrumbs:p(),hasBreadcrumbs:F()}},deselectAll:()=>{t.deselectAll(),r(R({legacy:Wl(),next:Fx()}));}}}function nO(e){return e.addReducers({configuration:L,search:j,facetSet:hr,numericFacetSet:ht,dateFacetSet:yr,categoryFacetSet:Xt}),!0}function Rx(e){return e.type==="redirect"}var Xl=class{constructor(t){this.response=t;}get basicExpression(){return this.response.parsedInput.basicExpression}get largeExpression(){return this.response.parsedInput.largeExpression}get redirectionUrl(){let t=this.response.preprocessingOutput.triggers.filter(Rx);return t.length?t[0].content:null}};var si=f("standaloneSearchBox/register",e=>g(e,{id:P,redirectionUrl:P})),ci=f("standaloneSearchBox/reset",e=>g(e,{id:P})),ui=f("standaloneSearchBox/updateAnalyticsToSearchFromLink",e=>g(e,{id:P})),li=f("standaloneSearchBox/updateAnalyticsToOmniboxFromLink"),Ln=N("standaloneSearchBox/fetchRedirect",async(e,{dispatch:t,getState:r,rejectWithValue:n,extra:{apiClient:o,validatePayload:a}})=>{a(e,{id:new x({emptyAllowed:!1})});let i=await aO(r()),s=await o.plan(i);if(Pe(s))return n(s.error);let{redirectionUrl:c}=new Xl(s.success);return c&&t(oO(c)),c||""}),oO=e=>b("analytics/standaloneSearchBox/redirect",t=>t.makeTriggerRedirect({redirectedTo:e})),aO=async e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,timezone:e.configuration.search.timezone,q:e.query.q,...e.context&&{context:e.context.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub},...e.configuration.analytics.enabled&&{visitorId:await we(e.configuration.analytics)},...e.configuration.analytics.enabled&&await ln(e.configuration.analytics),...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});var Zl=k(dc(),e=>e.addCase(si,(t,r)=>{let{id:n,redirectionUrl:o}=r.payload;n in t||(t[n]=bx(o));}).addCase(ci,(t,r)=>{let{id:n}=r.payload,o=t[n];if(o){t[n]=bx(o.defaultRedirectionUrl);return}}).addCase(Ln.pending,(t,r)=>{let n=t[r.meta.arg.id];n&&(n.isLoading=!0);}).addCase(Ln.fulfilled,(t,r)=>{let n=r.payload,o=t[r.meta.arg.id];o&&(o.redirectTo=n||o.defaultRedirectionUrl,o.isLoading=!1);}).addCase(Ln.rejected,(t,r)=>{let n=t[r.meta.arg.id];n&&(n.isLoading=!1);}).addCase(ui,(t,r)=>{let n=t[r.payload.id];n&&(n.analytics.cause="searchFromLink");}).addCase(li,(t,r)=>{let n=t[r.payload.id];n&&(n.analytics.cause="omniboxFromLink",n.analytics.metadata=r.payload.metadata);}));function bx(e){return {defaultRedirectionUrl:e,redirectTo:"",isLoading:!1,analytics:{cause:"",metadata:null}}}var vx=new $({..._m,redirectionUrl:new x({required:!0,emptyAllowed:!1})});function iO(e,t){if(!sO(e));let{dispatch:r}=e,n=()=>e.state,o=t.options.id||Gr("standalone_search_box"),a={id:o,highlightOptions:{...t.options.highlightOptions},...ql,...t.options};ue(e,vx,a,"buildStandaloneSearchBox");let i=jm(e,{options:a});return r(si({id:o,redirectionUrl:a.redirectionUrl})),{...i,updateText(s){i.updateText(s),r(ui({id:o}));},selectSuggestion(s){let c=Bm(n(),{id:o,suggestion:s});r(Zt({id:o,expression:s})),r(li({id:o,metadata:c})),this.submit();},afterRedirection(){r(ci({id:o}));},submit(){r(Me({q:this.state.value,enableQuerySyntax:a.enableQuerySyntax})),r(Ln({id:o}));},get state(){let c=n().standaloneSearchBoxSet[o];return {...i.state,isLoading:c.isLoading,redirectTo:c.redirectTo,analytics:c.analytics}}}}function sO(e){return e.addReducers({standaloneSearchBoxSet:Zl,configuration:L,query:Ct,querySuggest:ti}),!0}function wx(e,t){return e.q!==t.q?Vn():e.sortCriteria!==t.sortCriteria?ri():e.firstResult!==t.firstResult?Ya():e.numberOfResults!==t.numberOfResults?Wa():xt(e.f,t.f)?Ps(e.f,t.f):xt(e.fExcluded,t.fExcluded)?Ps(e.fExcluded,t.fExcluded,!0):xt(e.cf,t.cf)?Ps(e.cf,t.cf):xt(e.af,t.af)?Ps(e.af,t.af):xt(e.nf,t.nf)?Px(e.nf,t.nf):xt(e.df,t.df)?Px(e.df,t.df):sn()}function Ps(e={},t={},r=!1){let n=Object.keys(e),o=Object.keys(t),a=n.filter(p=>!o.includes(p));if(a.length){let p=a[0];switch(!0){case e[p].length>1:return Ie(p);case r:return Lr({facetId:p,facetValue:e[p][0]});default:return qt({facetId:p,facetValue:e[p][0]})}}let i=o.filter(p=>!n.includes(p));if(i.length){let p=i[0];return r?lt({facetId:p,facetValue:t[p][0]}):Se({facetId:p,facetValue:t[p][0]})}let s=o.find(p=>t[p].filter(m=>e[p].includes(m)));if(!s)return sn();let c=e[s],u=t[s],l=u.filter(p=>!c.includes(p));if(l.length)return r?lt({facetId:s,facetValue:l[0]}):Se({facetId:s,facetValue:l[0]});let d=c.filter(p=>!u.includes(p));return d.length?r?Lr({facetId:s,facetValue:d[0]}):qt({facetId:s,facetValue:d[0]}):sn()}function Px(e={},t={}){return Ps(pi(e),pi(t))}function Ex(e,t){return e.q!==t.q?Ol():e.sortCriteria!==t.sortCriteria?Nl():xt(e.f,t.f)?di(e.f,t.f):xt(e.fExcluded,t.fExcluded)?di(e.fExcluded,t.fExcluded,!0):xt(e.cf,t.cf)?di(e.cf,t.cf):xt(e.af,t.af)?di(e.af,t.af):xt(e.nf,t.nf)?di(pi(e.nf),pi(t.nf)):xt(e.df,t.df)?di(pi(e.df),pi(t.df)):Ho()}function xt(e={},t={}){return JSON.stringify(e)!==JSON.stringify(t)}function di(e={},t={},r=!1){let n=Object.keys(e),o=Object.keys(t),a=n.filter(p=>!o.includes(p));if(a.length){let p=a[0];return e[p].length>1?Be():Mr()}if(o.filter(p=>!n.includes(p)).length)return r?rr():Re();let s=o.find(p=>t[p].filter(m=>e[p].includes(m)));if(!s)return Ho();let c=e[s],u=t[s];return u.filter(p=>!c.includes(p)).length?r?rr():Re():c.filter(p=>!u.includes(p)).length?Mr():Ho()}function pi(e={}){let t={};return Object.keys(e).forEach(r=>t[r]=e[r].map(n=>`${n.start}..${n.end}`)),t}function Ix(e){return {q:ge().q,enableQuerySyntax:ge().enableQuerySyntax,aq:e.advancedSearchQueries?.defaultFilters.aq??nt().defaultFilters.aq,cq:e.advancedSearchQueries?.defaultFilters.cq??nt().defaultFilters.cq,firstResult:ze().firstResult,numberOfResults:e.pagination?.defaultNumberOfResults??ze().defaultNumberOfResults,sortCriteria:Ge(),f:{},fExcluded:{},cf:{},nf:{},df:{},debug:Mt(),sf:{},tab:"",af:{}}}var cO=new $({parameters:new E({options:{required:!0},values:Zc})});function Ox(e,t){let{dispatch:r}=e,n=O(e);return Ce(e,cO,t.initialState,"buildSearchParameterManager"),r(oe(t.initialState.parameters)),{...n,synchronize(o){let a=ed(e,o);r(oe(a));},get state(){return {parameters:Gm(e)}}}}function ed(e,t){return {...Ix(e.state),...t}}function Tx(e,t){return dO(e,t)}function Gm(e){let t=e.state;return {...uO(t),...lO(t),...pO(t),...kx(t,qx,"f"),...kx(t,mO,"fExcluded"),...fO(t),...gO(t),...SO(t),...hO(t)}}function uO(e){if(e.query===void 0)return {};let t=e.query.q;return t!==ge().q?{q:t}:{}}function lO(e){let t=Object.values(e.tabSet??{}).find(r=>r.isActive);return t?{tab:t.id}:{}}function dO(e,t){let r=e.state.tabSet,n=t.tab;if(!r||!Object.entries(r).length||!n)return !0;let o=n in r;return o||e.logger.warn(`The tab search parameter "${n}" is invalid. Ignoring change.`),o}function pO(e){if(e.sortCriteria===void 0)return {};let t=e.sortCriteria;return t!==Ge()?{sortCriteria:t}:{}}function kx(e,t,r){if(e.facetSet===void 0)return {};let n=Object.entries(e.facetSet).filter(([o])=>e.facetOptions?.facets[o]?.enabled??!0).map(([o,{request:a}])=>{let i=t(a.currentValues);return i.length?{[o]:i}:{}}).reduce((o,a)=>({...o,...a}),{});return Object.keys(n).length?{[r]:n}:{}}function qx(e){return e.filter(t=>t.state==="selected").map(t=>t.value)}function mO(e){return e.filter(t=>t.state==="excluded").map(t=>t.value)}function fO(e){if(e.categoryFacetSet===void 0)return {};let t=Object.entries(e.categoryFacetSet).filter(([r])=>e.facetOptions?.facets[r]?.enabled??!0).map(([r,n])=>{let a=st(n.request.currentValues).map(i=>i.value);return a.length?{[r]:a}:{}}).reduce((r,n)=>({...r,...n}),{});return Object.keys(t).length?{cf:t}:{}}function gO(e){if(e.numericFacetSet===void 0)return {};let t=Object.entries(e.numericFacetSet).filter(([r])=>e.facetOptions?.facets[r]?.enabled??!0).map(([r,{request:n}])=>{let o=Dx(n.currentValues);return o.length?{[r]:o}:{}}).reduce((r,n)=>({...r,...n}),{});return Object.keys(t).length?{nf:t}:{}}function SO(e){if(e.dateFacetSet===void 0)return {};let t=Object.entries(e.dateFacetSet).filter(([r])=>e.facetOptions?.facets[r]?.enabled??!0).map(([r,{request:n}])=>{let o=Dx(n.currentValues);return o.length?{[r]:o}:{}}).reduce((r,n)=>({...r,...n}),{});return Object.keys(t).length?{df:t}:{}}function Dx(e){return e.filter(t=>t.state==="selected")}function hO(e){let t=e.automaticFacetSet?.set;if(t===void 0)return {};let r=Object.entries(t).map(([n,{response:o}])=>{let a=qx(o.values);return a.length?{[n]:a}:{}}).reduce((n,o)=>({...n,...o}),{});return Object.keys(r).length?{af:r}:{}}function Wm(e,t){let{dispatch:r}=e,n=Ox(e,t);return {...n,synchronize(o){let a=Vx(e),i=ed(e,a),s=ed(e,o);As(i,s)||Tx(e,s)&&(n.synchronize(o),r(R({legacy:wx(i,s),next:Ex(i,s)})));},get state(){return {parameters:Vx(e)}}}}function Vx(e){let t=e.state;return {...Gm(e),...yO(t),...CO(t),...xO(t),...FO(t),...AO(t),...vO(t),...RO(t)}}function yO(e){if(e.query===void 0)return {};let t=e.query.enableQuerySyntax;return t!==void 0&&t!==ge().enableQuerySyntax?{enableQuerySyntax:t}:{}}function CO(e){if(e.advancedSearchQueries===void 0)return {};let{aq:t,defaultFilters:r}=e.advancedSearchQueries;return t!==r.aq?{aq:t}:{}}function xO(e){if(e.advancedSearchQueries===void 0)return {};let{cq:t,defaultFilters:r}=e.advancedSearchQueries;return t!==r.cq?{cq:t}:{}}function FO(e){if(e.pagination===void 0)return {};let t=e.pagination.firstResult;return t!==ze().firstResult?{firstResult:t}:{}}function AO(e){if(e.pagination===void 0)return {};let{numberOfResults:t,defaultNumberOfResults:r}=e.pagination;return t!==r?{numberOfResults:t}:{}}function RO(e){if(e.staticFilterSet===void 0)return {};let t=Object.entries(e.staticFilterSet).map(([r,n])=>{let o=bO(n.values);return o.length?{[r]:o}:{}}).reduce((r,n)=>({...r,...n}),{});return Object.keys(t).length?{sf:t}:{}}function bO(e){return e.filter(t=>t.state==="selected").map(t=>t.caption)}function vO(e){if(e.debug===void 0)return {};let t=e.debug;return t!==Mt()?{debug:t}:{}}var Lx="..",Ym="...",PO=/^(f|fExcluded|cf|nf|df|sf|af)-(.+)$/,wO={f:!0,fExcluded:!0,cf:!0,sf:!0,af:!0,nf:!0,df:!0},td="&",ws="=";function rd(){return {serialize:kO(OO),deserialize:LO}}function Es(e){return e in wO}function EO(e){return e in{q:!0,aq:!0,cq:!0,enableQuerySyntax:!0,firstResult:!0,numberOfResults:!0,sortCriteria:!0,debug:!0,tab:!0}}function IO(e){let r=e in{nf:!0,df:!0};return Es(e)&&r}function Mx(e){return EO(e)||Es(e)}var kO=e=>t=>Object.entries(t).map(e).filter(r=>r).join(td);function OO(e){let[t,r]=e;return Mx(t)?Es(t)&&!IO(t)?qO(r)?VO(t,r):"":t==="nf"||t==="df"?DO(r)?NO(t,r):"":TO(t,r):""}function TO(e,t){return `${e}${ws}${encodeURIComponent(t)}`}function qO(e){return Km(e)?Qx(e,r=>typeof r=="string"):!1}function DO(e){return Km(e)?Qx(e,r=>Km(r)&&"start"in r&&"end"in r):!1}function Km(e){return !!(e&&typeof e=="object")}function Qx(e,t){return Object.entries(e).filter(n=>{let o=n[1];return !Array.isArray(o)||!o.every(t)}).length===0}function VO(e,t){return Object.entries(t).map(([r,n])=>`${e}-${r}${ws}${n.map(o=>encodeURIComponent(o)).join(",")}`).join(td)}function NO(e,t){return Object.entries(t).map(([r,n])=>{let o=n.map(({start:a,end:i,endInclusive:s})=>`${a}${s?Ym:Lx}${i}`).join(",");return `${e}-${r}${ws}${o}`}).join(td)}function LO(e){return e.split(td).map(n=>MO(n)).map(QO).filter(jO).map(n=>$O(n)).reduce((n,o)=>{let[a,i]=o;if(Es(a)){let s={...n[a],...i};return {...n,[a]:s}}return {...n,[a]:i}},{})}function MO(e){let[t,...r]=e.split(ws),n=r.join(ws);return [t,n]}function QO(e){let[t,r]=e,n=PO.exec(t);if(!n)return e;let o=n[1],a=n[2],i=r.split(","),s=BO(o,i),c={[a]:s};return [o,JSON.stringify(c)]}function BO(e,t){return e==="nf"?UO(t):e==="df"?_O(t):t}function UO(e){return e.map(t=>{let{startAsString:r,endAsString:n,isEndInclusive:o}=Bx(t);return {start:parseFloat(r),end:parseFloat(n),endInclusive:o}}).filter(({start:t,end:r})=>Number.isFinite(t)&&Number.isFinite(r)).map(({start:t,end:r,endInclusive:n})=>xs({start:t,end:r,state:"selected",endInclusive:n}))}function Nx(e){try{return yh(e)?(nu(e,ss),!0):Gt(e)?(Jn(e),!0):!1}catch{return !1}}function _O(e){return e.map(t=>{let{isEndInclusive:r,startAsString:n,endAsString:o}=Bx(t);return {start:n,end:o,endInclusive:r}}).filter(({start:t,end:r})=>Nx(t)&&Nx(r)).map(({start:t,end:r,endInclusive:n})=>lo({start:t,end:r,state:"selected",endInclusive:n}))}function jO(e){let t=Mx(e[0]),r=e.length===2;return t&&r}function $O(e,t=!0){let[r,n]=e;return r==="enableQuerySyntax"?[r,n==="true"]:r==="debug"?[r,n==="true"]:r==="firstResult"?[r,parseInt(n)]:r==="numberOfResults"?[r,parseInt(n)]:Es(r)?[r,HO(n)]:[r,t?decodeURIComponent(n):n]}function HO(e){let t=JSON.parse(e),r={};return Object.entries(t).forEach(n=>{let[o,a]=n;r[o]=a.map(i=>Io(i)?decodeURIComponent(i):i);}),r}function Bx(e){let t=e.indexOf(Ym)!==-1,[r,n]=e.split(t?Ym:Lx);return {isEndInclusive:t,startAsString:r,endAsString:n}}var zO=new $({fragment:new x});function GO(e,t){let r;function n(){r=e.state.search.requestId;}function o(){return r!==e.state.search.requestId}if(!YO(e));Ce(e,zO,t.initialState,"buildUrlManager");let a=O(e),i=t.initialState.fragment;n();let s=Wm(e,{initialState:{parameters:nd(i)}});return {...a,subscribe(c){let u=()=>{let l=this.state.fragment;!WO(i,l)&&o()&&(i=l,c()),n();};return u(),e.subscribe(u)},get state(){return {fragment:rd().serialize(s.state.parameters)}},synchronize(c){i=c;let u=nd(c);s.synchronize(u);}}}function WO(e,t){if(e===t)return !0;let r=nd(e),n=nd(t);return As(r,n)}function nd(e){return rd().deserialize(e)}function YO(e){return e.addReducers({configuration:L}),!0}function KO(e){return Ka(e)}async function od(e,t){let{search:r,accessToken:n,organizationId:o,analytics:a}=e.configuration,i=e.query?.q||"";return {url:r.apiBaseUrl,accessToken:n,organizationId:o,enableNavigation:!1,...a.enabled&&{visitorId:await we(e.configuration.analytics)},q:i,...t,requestedOutputSize:t.requestedOutputSize||0,...r.authenticationProviders.length&&{authentication:r.authenticationProviders.join(",")}}}var yo=N("resultPreview/fetchResultContent",async(e,{extra:t,getState:r,rejectWithValue:n})=>{let o=r(),a=await od(o,e),i=await t.apiClient.html(a);return Pe(i)?n(i.error):{content:i.success,uniqueId:e.uniqueId}}),mi=f("resultPreview/next"),fi=f("resultPreview/previous"),gi=f("resultPreview/prepare",e=>g(e,{results:new B({required:!0})})),Ux=2048,Si=N("resultPreview/updateContentURL",async(e,{getState:t,extra:r})=>{let n=t(),o=aS(await e.buildResultPreviewRequest(n,{uniqueId:e.uniqueId,requestedOutputSize:e.requestedOutputSize}),e.path);return o?.length>Ux&&r.logger.error(`The content URL was truncated as it exceeds the maximum allowed length of ${Ux} characters.`),{contentURL:o}});var _x=e=>b({prefix:"analytics/resultPreview/open",__legacy__getBuilder:(t,r)=>{Ke(e);let n=xe(e,r),o=Fe(e);return t.makeDocumentQuickview(n,o)},analyticsType:"itemClick",analyticsPayloadBuilder:t=>{let r=xe(e,t),n=Fe(e);return {searchUid:t.search?.response.searchUid??"",position:r.documentPosition,actionCause:"preview",itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}});var Jm=e=>{let{content:t,isLoading:r,uniqueId:n,contentURL:o}=Ui();e.content=t,e.isLoading=r,e.uniqueId=n,e.contentURL=o;},Xm=e=>e.filter(t=>t.hasHtmlVersion).map(t=>t.uniqueId),ad=k(Ui(),e=>{e.addCase(yo.pending,t=>{t.isLoading=!0;}).addCase(yo.fulfilled,(t,r)=>{let{content:n,uniqueId:o}=r.payload;t.position=t.resultsWithPreview.indexOf(o),t.content=n,t.uniqueId=o,t.isLoading=!1;}).addCase(R.fulfilled,(t,r)=>{Jm(t),t.resultsWithPreview=Xm(r.payload.response.results);}).addCase(fn.fulfilled,(t,r)=>{Jm(t),t.resultsWithPreview=t.resultsWithPreview.concat(Xm(r.payload.response.results));}).addCase(Wt.fulfilled,Jm).addCase(gi,(t,r)=>{t.resultsWithPreview=Xm(r.payload.results);}).addCase(mi,t=>{if(t.isLoading)return;let r=t.position+1;r>t.resultsWithPreview.length-1&&(r=0),t.position=r;}).addCase(fi,t=>{if(t.isLoading)return;let r=t.position-1;r<0&&(r=t.resultsWithPreview.length-1),t.position=r;}).addCase(Si.fulfilled,(t,r)=>{t.contentURL=r.payload.contentURL;});});function jx(e,t,r,n,o){if(!JO(e));let{dispatch:a}=e,i=()=>e.state,s=O(e),{result:c,maximumPreviewSize:u}=t.options,l=()=>{let{resultsWithPreview:p,position:m}=i().resultPreview;return p[m]},d=p=>{a(Si({uniqueId:p,requestedOutputSize:u,buildResultPreviewRequest:r,path:n})),t.options.onlyContentURL||a(yo({uniqueId:p,requestedOutputSize:u})),o&&o();};return {...s,fetchResultContent(){d(c.uniqueId);},next(){a(mi()),d(l());},previous(){a(fi()),d(l());},get state(){let p=i(),m=c.hasHtmlVersion,S=p.resultPreview,F=c.uniqueId===S.uniqueId?S.content:"",y=S.isLoading,A=S.contentURL,w=l();return {content:F,resultHasPreview:m,isLoading:y,contentURL:A,currentResultUniqueId:w}}}}function JO(e){return e.addReducers({configuration:L,resultPreview:ad}),!0}function XO(e,t){if(!ZO(e));let{dispatch:r}=e,n=()=>e.state,o=()=>n().search.results,s=jx(e,t,od,"/html",()=>{e.dispatch(_x(t.options.result));});return r(gi({results:o()})),{...s,get state(){return {...s.state,currentResult:o().findIndex(c=>c.uniqueId===s.state.currentResultUniqueId)+1,totalResults:o().length}}}}function ZO(e){return e.addReducers({search:j}),!0}var eT=e=>b("analytics/folding/showMore",(t,r)=>(Ke(e),t.makeShowMoreFoldedResults(xe(e,r),Fe(e)))),tT=()=>b("analytics/folding/showLess",e=>e.makeShowLessFoldedResults()),$x={logShowMoreFoldedResults:eT,logShowLessFoldedResults:tT};function rT(e,t){return e.raw[t.collection]}function Zm(e,t){return e.raw[t.parent]}function Is(e,t){let r=e.raw[t.child];return Gs(r)?r[0]:r}function nT(e,t){return (e||t)!==void 0&&e===t}function zx(e,t,r,n=[]){let o=Is(e,r);return o?n.indexOf(o)!==-1?[]:t.filter(a=>{let i=Is(a,r)===Is(e,r);return Zm(a,r)===o&&!i}).map(a=>({result:a,children:zx(a,t,r,[...n,o])})):[]}function oT(e,t){return e.find(r=>{let n=Zm(r,t)===void 0,o=nT(Zm(r,t),Is(r,t));return n||o})}function Gx(e){return e.parentResult?Gx(e.parentResult):e}function aT(e,t,r){let n=zc(e),o=r??oT(n,t)??Gx(e);return {result:o,children:zx(o,n,t),moreResultsAvailable:!0,isLoadingMoreResults:!1}}function id(e,t,r){let n={};return e.forEach(o=>{let a=rT(o,t);a&&(!Is(o,t)&&!o.parentResult||(n[a]=aT(o,t,r)));}),n}function Hx(e,t){if(!e.collections[t])throw new Error(`Missing collection ${t} from ${Object.keys(e.collections)}: Folding most probably in an invalid state...`);return e.collections[t]}var sd=k(wo(),e=>e.addCase(R.fulfilled,(t,{payload:r})=>{t.collections=t.enabled?id(r.response.results,t.fields):{};}).addCase(Wt.fulfilled,(t,{payload:r})=>{t.collections=t.enabled?id(r.response.results,t.fields):{};}).addCase(fn.fulfilled,(t,{payload:r})=>{t.collections=t.enabled?{...t.collections,...id(r.response.results,t.fields)}:{};}).addCase(hn,(t,{payload:r})=>t.enabled?t:{enabled:!0,collections:{},fields:{collection:r.collectionField??t.fields.collection,parent:r.parentField??t.fields.parent,child:r.childField??t.fields.child},filterFieldRange:r.numberOfFoldedResults??t.filterFieldRange}).addCase(yn.pending,(t,{meta:r})=>{let n=r.arg;Hx(t,n).isLoadingMoreResults=!0;}).addCase(yn.rejected,(t,{meta:r})=>{let n=r.arg;Hx(t,n).isLoadingMoreResults=!1;}).addCase(yn.fulfilled,(t,{payload:{collectionId:r,results:n,rootResult:o}})=>{let a=id(n,t.fields,o);if(!a||!a[r])throw new Error(`Unable to create collection ${r} from received results: ${JSON.stringify(n)}. Folding most probably in an invalid state... `);t.collections[r]=a[r],t.collections[r].moreResultsAvailable=!1;}));var iT=new $(xm);function Wx(e,t,r){if(!sT(e));let n=Il(e,t),{dispatch:o}=e,a=()=>e.state,i=t.options?.folding?ue(e,iT,t.options.folding,"buildFoldedResultList"):{};return o(hn({...i})),{...n,loadCollection:s=>{o(t.loadCollectionActionCreator(s.result.raw[e.state.folding.fields.collection])),o(r.logShowMoreFoldedResults(s.result));},logShowMoreFoldedResults:s=>{o(r.logShowMoreFoldedResults(s));},logShowLessFoldedResults:()=>{o(r.logShowLessFoldedResults());},findResultById(s){return ef(this.state.results,c=>c.result.uniqueId===s.result.uniqueId)},findResultByCollection(s){return ef(this.state.results,c=>c.result.raw.foldingcollection===s.result.raw.foldingcollection)},get state(){let s=a();return {...n.state,results:n.state.results.map(c=>{let u=c.raw[s.folding.fields.collection];return !u||!s.folding.collections[u]?{result:c,moreResultsAvailable:!1,isLoadingMoreResults:!1,children:[]}:s.folding.collections[u]})}}}}function sT(e){return e.addReducers({search:j,configuration:hu,folding:sd,query:Ct}),!0}function ef(e,t){for(let r=0;r<e.length;r++){let n=e[r];if(t(n))return n;if(n.children.length){let o=ef(n.children,t);if(o)return o}}return null}function cT(e,t={}){let r=Wx(e,{...t,loadCollectionActionCreator:yn,fetchMoreResultsActionCreator:fn},$x);return {...r,get state(){return r.state}}}function Yx(e){return e.query="",e.queryModification={originalQuery:"",newQuery:"",queryToIgnore:e.queryModification.queryToIgnore},e}function Kx(e,t){let r=[],n=[],o=[],a=[];return t.forEach(i=>{switch(i.type){case"redirect":r.push(i.content);break;case"query":n.push(i.content);break;case"execute":o.push({functionName:i.content.name,params:i.content.params});break;case"notify":a.push(i.content);break}}),e.redirectTo=r[0]??"",e.query=e.queryModification.newQuery,e.executions=o,e.notifications=a,e}function Jx(e,t){return e.queryModification={...t,queryToIgnore:""},e}function Xx(e,t){return e.queryModification.queryToIgnore=t,e}var Mn=k(pc(),e=>e.addCase(R.pending,Yx).addCase(R.fulfilled,(t,r)=>Kx(t,r.payload.response.triggers)).addCase(fa,(t,r)=>Jx(t,r.payload)).addCase(dn,(t,r)=>Xx(t,r.payload)));function dT(e){if(!pT(e));let t=O(e),{dispatch:r}=e,n=()=>e.state,o=()=>n().triggers.queryModification.newQuery,a=()=>n().triggers.queryModification.originalQuery;return {...t,get state(){return {newQuery:o(),originalQuery:a(),wasQueryModified:o()!==""}},undo(){r(dn(o())),r(Me({q:a()})),r(R({legacy:lu({undoneQuery:o()}),next:Th()}));}}}function pT(e){return e.addReducers({triggers:Mn,query:Ct}),!0}function gT(e){if(!ST(e));let t=O(e),{dispatch:r}=e,n=()=>e.state,o=n().triggers.notifications;return {...t,subscribe(a){let i=()=>{let s=!go(o,this.state.notifications);o=this.state.notifications,s&&(a(),r(du()));};return i(),e.subscribe(i)},get state(){return {notifications:n().triggers.notifications}}}}function ST(e){return e.addReducers({triggers:Mn}),!0}var cd=()=>new E({values:{questionAnswerId:P},options:{required:!0}}),tf=()=>new E({values:{linkText:ce,linkURL:ce},options:{required:!0}});function hi(e){return g(e,cd())}function Vt(e,t){let r=t??e.search?.questionAnswer?.documentId;return r&&e.search&&Lh(e,r.contentIdKey,r.contentIdValue)}function $r(e,t){let r=e.questionAnswering?.relatedQuestions.findIndex(o=>o.questionAnswerId===t)??-1;return r===-1?null:e.search?.questionAnswer?.relatedQuestions?.[r]??null}var rf=()=>b({prefix:"analytics/smartSnippet/expand",__legacy__getBuilder:e=>e.makeExpandSmartSnippet(),analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"expand",answer:{responseId:e.search?.response.searchUid||"",type:"SmartSnippet"}})}),nf=()=>b({prefix:"analytics/smartSnippet/collapse",__legacy__getBuilder:e=>e.makeCollapseSmartSnippet(),analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"collapse",answer:{responseId:e.search?.response.searchUid||"",type:"SmartSnippet"}})}),of=()=>b({prefix:"analytics/smartSnippet/like",__legacy__getBuilder:e=>e.makeLikeSmartSnippet(),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>({answer:{responseId:e.search?.response.searchUid||"",type:"SmartSnippet"},feedback:{liked:!0}})}),af=()=>b({prefix:"analytics/smartSnippet/dislike",__legacy__getBuilder:e=>e.makeDislikeSmartSnippet(),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>({answer:{responseId:e.search?.response.searchUid||"",type:"SmartSnippet"},feedback:{liked:!1}})}),sf=()=>b({prefix:"analytics/smartSnippet/source/open",__legacy__getBuilder:(e,t)=>{let r=Vt(t);return e.makeOpenSmartSnippetSource(xe(r,t),Fe(r))},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:e=>{let t=Vt(e),r=Fe(t);return {answer:{responseId:e.search?.response.searchUid||"",type:"SmartSnippet"},citation:{id:r.contentIDValue,type:"Source"}}}}),ks=e=>b({prefix:"analytics/smartSnippet/source/open",__legacy__getBuilder:(t,r)=>{g(e,tf());let n=Vt(r);return n?t.makeOpenSmartSnippetInlineLink(xe(n,r),{...Fe(n),...e}):null},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:t=>{let r=Vt(t),n=Fe(r);return {answer:{responseId:t.search?.response.searchUid||"",type:"SmartSnippet"},citation:{id:n.contentIDValue,type:"InlineLink"}}}}),cf=()=>b("analytics/smartSnippet/feedbackModal/open",e=>e.makeOpenSmartSnippetFeedbackModal()),uf=()=>b("analytics/smartSnippet/feedbackModal/close",e=>e.makeCloseSmartSnippetFeedbackModal()),lf=e=>b({prefix:"analytics/smartSnippet/sendFeedback",__legacy__getBuilder:t=>t.makeSmartSnippetFeedbackReason(e),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>({answer:{responseId:t.search?.response.searchUid||"",type:"SmartSnippet"},feedback:{liked:!1,reason:e}})}),df=e=>b({prefix:"analytics/smartSnippet/sendFeedback",__legacy__getBuilder:t=>t.makeSmartSnippetFeedbackReason("other",e),analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>({answer:{responseId:t.search?.response.searchUid||"",type:"SmartSnippet"},feedback:{liked:!1,reason:"other",details:e}})}),pf=e=>b({prefix:"analytics/smartSnippetSuggestion/expand",__legacy__getBuilder:(t,r)=>{hi(e);let n=$r(r,e.questionAnswerId);return n?t.makeExpandSmartSnippetSuggestion({question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId}):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:t=>({action:"expand",answer:{responseId:t.search?.response.searchUid||"",type:"SmartSnippetSuggestion"}})}),mf=e=>b({prefix:"analytics/smartSnippetSuggestion/collapse",__legacy__getBuilder:(t,r)=>{hi(e);let n=$r(r,e.questionAnswerId);return n?t.makeCollapseSmartSnippetSuggestion({question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId}):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:t=>({action:"collapse",answer:{responseId:t.search?.response.searchUid||"",type:"SmartSnippetSuggestion"}})}),Os=e=>b({prefix:"analytics/smartSnippetSuggestion/source/open",__legacy__getBuilder:(t,r)=>{g(e,cd());let n=$r(r,e.questionAnswerId);if(!n)return null;let o=Vt(r,n.documentId);return o?t.makeOpenSmartSnippetSuggestionSource(xe(o,r),{question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId}):null},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:t=>{let r=$r(t,e.questionAnswerId);return {answer:{responseId:t.search?.response.searchUid||"",type:"SmartSnippetSuggestion"},citation:{id:r?.documentId.contentIdValue||"",type:"Source"}}}}),ud=(e,t)=>b({prefix:"analytics/smartSnippetSuggestion/source/open",__legacy__getBuilder:(r,n)=>{g(e,cd()),g(t,tf());let o=$r(n,e.questionAnswerId);if(!o)return null;let a=Vt(n,o.documentId);return a?r.makeOpenSmartSnippetSuggestionInlineLink(xe(a,n),{question:o.question,answerSnippet:o.answerSnippet,documentId:o.documentId,linkText:t.linkText,linkURL:t.linkURL}):null},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:r=>{let n=$r(r,e.questionAnswerId);return {answer:{responseId:r.search?.response.searchUid||"",type:"SmartSnippetSuggestion"},citation:{id:n?.documentId.contentIdValue||"",type:"InlineLink"}}}}),ld={logExpandSmartSnippet:rf,logCollapseSmartSnippet:nf,logLikeSmartSnippet:of,logDislikeSmartSnippet:af,logOpenSmartSnippetSource:sf,logOpenSmartSnippetInlineLink:ks,logOpenSmartSnippetFeedbackModal:cf,logCloseSmartSnippetFeedbackModal:uf,logSmartSnippetFeedback:lf,logSmartSnippetDetailedFeedback:df,logExpandSmartSnippetSuggestion:pf,logCollapseSmartSnippetSuggestion:mf,logOpenSmartSnippetSuggestionSource:Os};var yi=f("smartSnippet/expand"),Ci=f("smartSnippet/collapse"),xi=f("smartSnippet/like"),Fi=f("smartSnippet/dislike"),Ai=f("smartSnippet/feedbackModal/open"),Qn=f("smartSnippet/feedbackModal/close"),Ri=f("smartSnippet/related/expand",e=>hi(e)),bi=f("smartSnippet/related/collapse",e=>hi(e));var Zx=(e,t)=>e.findIndex(r=>r.questionAnswerId===t.questionAnswerId);function eF({question:e,answerSnippet:t,documentId:{contentIdKey:r,contentIdValue:n}}){return Fo({question:e,answerSnippet:t,contentIdKey:r,contentIdValue:n})}function hT(e,t){let r=eF(e);return t&&r===t.questionAnswerId?t:{contentIdKey:e.documentId.contentIdKey,contentIdValue:e.documentId.contentIdValue,expanded:!1,questionAnswerId:r}}var Fr=k(Bi(),e=>e.addCase(yi,t=>{t.expanded=!0;}).addCase(Ci,t=>{t.expanded=!1;}).addCase(xi,t=>{t.liked=!0,t.disliked=!1,t.feedbackModalOpen=!1;}).addCase(Fi,t=>{t.liked=!1,t.disliked=!0;}).addCase(Ai,t=>{t.feedbackModalOpen=!0;}).addCase(Qn,t=>{t.feedbackModalOpen=!1;}).addCase(R.fulfilled,(t,r)=>{let n=r.payload.response.questionAnswer.relatedQuestions.map((a,i)=>hT(a,t.relatedQuestions[i])),o=eF(r.payload.response.questionAnswer);return t.questionAnswerId===o?{...t,relatedQuestions:n}:{...Bi(),relatedQuestions:n,questionAnswerId:o}}).addCase(Ri,(t,r)=>{let n=Zx(t.relatedQuestions,r.payload);n!==-1&&(t.relatedQuestions[n].expanded=!0);}).addCase(bi,(t,r)=>{let n=Zx(t.relatedQuestions,r.payload);n!==-1&&(t.relatedQuestions[n].expanded=!1);}));function tF(e,t,r){if(!yT(e));let n=O(e),o=()=>e.state,a=()=>Vt(o()),i=null,s=et(e,{options:{selectionDelay:r?.options?.selectionDelay}},()=>{let c=a();if(!c){i=null;return}let{searchResponseId:u}=o().search;i!==u&&(i=u,e.dispatch(t.logOpenSmartSnippetSource()),e.dispatch(yt(c)));});return {...n,get state(){let c=o();return {question:c.search.questionAnswer.question,answer:c.search.questionAnswer.answerSnippet,documentId:c.search.questionAnswer.documentId,expanded:c.questionAnswering.expanded,answerFound:c.search.questionAnswer.answerSnippet!=="",liked:c.questionAnswering.liked,disliked:c.questionAnswering.disliked,feedbackModalOpen:c.questionAnswering.feedbackModalOpen,source:a()}},expand(){e.dispatch(t.logExpandSmartSnippet()),e.dispatch(yi());},collapse(){e.dispatch(t.logCollapseSmartSnippet()),e.dispatch(Ci());},like(){e.dispatch(t.logLikeSmartSnippet()),e.dispatch(xi());},dislike(){e.dispatch(t.logDislikeSmartSnippet()),e.dispatch(Fi());},openFeedbackModal(){e.dispatch(t.logOpenSmartSnippetFeedbackModal()),e.dispatch(Ai());},closeFeedbackModal(){e.dispatch(t.logCloseSmartSnippetFeedbackModal()),e.dispatch(Qn());},sendFeedback(c){e.dispatch(t.logSmartSnippetFeedback(c)),e.dispatch(Qn());},sendDetailedFeedback(c){e.dispatch(t.logSmartSnippetDetailedFeedback(c)),e.dispatch(Qn());},selectSource(){s.select();},beginDelayedSelectSource(){s.beginDelayedSelect();},cancelPendingSelectSource(){s.cancelPendingSelect();}}}function yT(e){return e.addReducers({search:j,questionAnswering:Fr}),!0}function dd(e,t){if(!CT(e));let r=()=>e.state,n=new Set,o=l=>n.has(l)?!0:(n.add(l),!1),a=null,i=l=>{a!==l&&(a=l,c={},n.clear());},s=(l,d,p)=>et(e,{options:{selectionDelay:t?.options?.selectionDelay}},()=>{o(d)||e.dispatch(p?ud({questionAnswerId:p},l):ks(l));}),c={},u=(l,d)=>{let{searchResponseId:p}=r().search;i(p);let m=Fo({...l,questionAnswerId:d});return m in c||(c[m]=s(l,m,d)),c[m]};return {selectInlineLink(l,d){u(l,d)?.select();},beginDelayedSelectInlineLink(l,d){u(l,d)?.beginDelayedSelect();},cancelPendingSelectInlineLink(l,d){u(l,d)?.cancelPendingSelect();}}}function CT(e){return e.addReducers({search:j,questionAnswering:Fr}),!0}function xT(e,t){let r=tF(e,ld,t),n=dd(e,{options:{selectionDelay:t?.options?.selectionDelay}});return {...r,get state(){return r.state},selectInlineLink(o){n.selectInlineLink(o);},beginDelayedSelectInlineLink(o){n.beginDelayedSelectInlineLink(o);},cancelPendingSelectInlineLink(o){n.cancelPendingSelectInlineLink(o);}}}function rF(e,t){if(!FT(e));let r=O(e),n=()=>e.state,o=a=>{let{contentIdKey:i,contentIdValue:s}=a;return e.state.search.results.find(c=>gn(c,i)===s)};return {...r,get state(){let a=n();return {questions:a.search.questionAnswer.relatedQuestions.map((i,s)=>({question:i.question,answer:i.answerSnippet,documentId:i.documentId,questionAnswerId:a.questionAnswering.relatedQuestions[s].questionAnswerId,expanded:a.questionAnswering.relatedQuestions[s].expanded,source:o(i.documentId)}))}},expand(a){let i={questionAnswerId:a};e.dispatch(t.logExpandSmartSnippetSuggestion(i)),e.dispatch(Ri(i));},collapse(a){let i={questionAnswerId:a};e.dispatch(t.logCollapseSmartSnippetSuggestion(i)),e.dispatch(bi(i));}}}function FT(e){return e.addReducers({search:j,questionAnswering:Fr}),!0}function nF(e,t){if(!AT(e));let r=()=>e.state,n=d=>{let p=r(),m=$r(p,d);return m?Vt(p,m.documentId):null},o=new Set,a=d=>o.has(d)?!0:(o.add(d),!1),i=null,s=d=>{i!==d&&(i=d,u={},o.clear());},c=(d,p)=>et(e,{options:{selectionDelay:t?.options?.selectionDelay}},()=>{a(p)||(e.dispatch(Os({questionAnswerId:p})),e.dispatch(yt(d)));}),u={},l=d=>{let{searchResponseId:p}=r().search;s(p);let m=n(d);return m?(d in u||(u[d]=c(m,d)),u[d]):null};return {selectSource(d){l(d)?.select();},beginDelayedSelectSource(d){l(d)?.beginDelayedSelect();},cancelPendingSelectSource(d){l(d)?.cancelPendingSelect();}}}function AT(e){return e.addReducers({search:j,questionAnswering:Fr}),!0}function RT(e,t){let r=rF(e,ld),n=dd(e,{options:{selectionDelay:t?.options?.selectionDelay}}),o=nF(e,{options:{selectionDelay:t?.options?.selectionDelay}});return {...r,get state(){return r.state},selectSource(a){o.selectSource(a);},beginDelayedSelectSource(a){o.beginDelayedSelectSource(a);},cancelPendingSelectSource(a){o.cancelPendingSelectSource(a);},selectInlineLink(a,i){n.selectInlineLink(i,a);},beginDelayedSelectInlineLink(a,i){n.beginDelayedSelectInlineLink(i,a);},cancelPendingSelectInlineLink(a,i){n.cancelPendingSelectInlineLink(i,a);}}}var bT={queries:new B({required:!0,each:new x({emptyAllowed:!1})}),maxLength:new I({required:!0,min:1,default:10})},vi=f("recentQueries/registerRecentQueries",e=>g(e,bT)),Pi=f("recentQueries/clearRecentQueries");var oF=()=>b("analytics/recentQueries/clear",e=>e.makeClearRecentQueries()),aF=()=>b("analytics/recentQueries/click",e=>e.makeRecentQueryClick()),iF=()=>({actionCause:"recentQueriesClick"});var pd=k(uc(),e=>{e.addCase(vi,vT).addCase(Pi,PT).addCase(R.fulfilled,(t,r)=>{let n=r.payload.queryExecuted.trim(),o=r.payload.response.results;!n.length||!o.length||wT(n,t);});});function vT(e,t){e.queries=t.payload.queries.slice(0,t.payload.maxLength),e.maxLength=t.payload.maxLength;}function PT(e){e.queries=[];}function wT(e,t){t.queries=t.queries.filter(n=>n!==e);let r=t.queries.slice(0,t.maxLength-1);t.queries=[e,...r];}var ET={queries:[]},IT={maxLength:10,clearFilters:!0},kT=new $({queries:new B({required:!0})}),OT=new $({maxLength:new I({required:!0,min:1}),clearFilters:new Q});function TT(e,t){ue(e,OT,t?.options,"buildRecentQueriesList"),Ce(e,kT,t?.initialState,"buildRecentQueriesList");}function qT(e,t){if(!DT(e));let r=O(e),{dispatch:n}=e,o=()=>e.state,a={...IT,...t?.options},i={...ET,...t?.initialState};TT(e,{options:a,initialState:i});let s={queries:i.queries,maxLength:a.maxLength};return n(vi(s)),{...r,get state(){let c=o();return {...c.recentQueries,analyticsEnabled:c.configuration.analytics.enabled}},clear(){n(oF()),n(Pi());},executeRecentQuery(c){let u=new I({required:!0,min:0,max:this.state.queries.length}).validate(c);if(u)throw new Error(u);let l={q:this.state.queries[c],clearFilters:a.clearFilters};ac(e.state.query?.enableQuerySyntax)&&(l.enableQuerySyntax=e.state.query.enableQuerySyntax),n(Su(l)),n(R({legacy:aF(),next:iF()}));}}}function DT(e){return e.addReducers({search:j,recentQueries:pd}),!0}k(lc(),e=>{e.addCase(Ja,(t,r)=>{t.results=r.payload.results.slice(0,r.payload.maxLength),t.maxLength=r.payload.maxLength;}).addCase(Xa,t=>{t.results=[];}).addCase(yt,(t,r)=>{let n=r.payload;t.results=t.results.filter(a=>a.uniqueId!==n.uniqueId);let o=t.results.slice(0,t.maxLength-1);t.results=[n,...o];});});new $({results:new B({required:!0})});new $({maxLength:new I({required:!0,min:1})});function _T(e,t){if(!jT(e));let r=p=>e.state.facetOptions.facets[p]?.enabled??!1,n=p=>e.state.facetSet?.[p]?.request?.currentValues??e.state.categoryFacetSet?.[p]?.request?.currentValues??e.state.numericFacetSet?.[p]?.request?.currentValues??e.state.dateFacetSet?.[p]?.request?.currentValues??null,o=p=>p in e.state.facetOptions.facets,a=()=>Fo({isFacetRegistered:o(t.facetId),parentFacets:t.conditions.map(({parentFacetId:p})=>o(p)?{enabled:r(p),values:n(p)}:null)}),i=()=>{let p=a();return p===l?!1:(l=p,!0)},s=()=>t.conditions.some(p=>{if(!r(p.parentFacetId))return !1;let m=n(p.parentFacetId);return m===null?!1:p.condition(m)}),c=()=>{e.state.facetSet&&Object.entries(e.state.facetSet).forEach(([p,m])=>m.request.freezeCurrentValues&&e.dispatch(Qr({facetId:p,freezeCurrentValues:!1})));},u=()=>{if(!o(t.facetId))return;let p=r(t.facetId),m=s();p!==m&&(e.dispatch(m?Qe(t.facetId):de(t.facetId)),c());};if(!t.conditions.length)return {stopWatching(){}};let l=a(),d=e.subscribe(()=>{i()&&u();});return u(),{stopWatching(){d();}}}function jT(e){return e.addReducers({facetOptions:ke}),!0}var uF=k(Yr(),e=>{e.addCase(R.fulfilled,(t,r)=>{t.set={},r.payload.response.generateAutomaticFacets?.facets?.forEach(o=>{t.set[o.field]={response:o};});}).addCase(bl,(t,r)=>{r.payload.desiredCount&&(t.desiredCount=r.payload.desiredCount),r.payload.numberOfValues&&(t.numberOfValues=r.payload.numberOfValues);}).addCase(qn,(t,r)=>{let{field:n,selection:o}=r.payload,a=t.set[n]?.response;if(!a)return;let i=a.values.find(c=>c.value===o.value);if(!i)return;let s=i.state==="selected";i.state=s?"idle":"selected";}).addCase(vl,(t,r)=>{let n=r.payload,o=t.set[n]?.response;if(o)for(let a of o.values)a.state="idle";}).addCase(oe,(t,r)=>{let n=r.payload.af??{},o=Object.keys(t.set);for(let a in n)if(!t.set[a]){let i=WT(a),s=n[a].map(c=>YT(c));i.values.push(...s),t.set[a]={response:i};}for(let a of o)if(!(a in n)){let i=t.set[a]?.response;for(let s of i.values)s.state="idle";}for(let a in n){let i=t.set[a]?.response;if(i){let s=i.values;for(let c of s)n[a].includes(c.value)?c.state==="idle"&&(c.state="selected"):c.state="idle";}}}).addCase(ne.fulfilled,(t,r)=>{if(r.payload&&Object.keys(r.payload.automaticFacetSet.set).length!==0)return r.payload.automaticFacetSet}).addCase(le,t=>{Object.values(t.set).forEach(({response:r})=>{r.values.forEach(n=>n.state="idle");});});});function WT(e){return {field:e,values:[],moreValuesAvailable:!1,label:"",indexScore:0}}function YT(e){return {value:e,state:"selected",numberOfResults:0}}function lF(e,t){let{dispatch:r}=e,n=O(e),{field:o}=t;return {...n,toggleSelect(a){r(qn({field:o,selection:a})),r(R({legacy:Yu(o,a),next:Ku(a)}));},deselectAll(){r(vl(o)),r(R({legacy:Ie(o),next:Be()}));},get state(){let a=e.state.automaticFacetSet?.set[o]?.response;return a?{field:a.field,label:a.label,values:a.values}:{field:"",values:[],label:""}}}}function dF(e){return {desiredCount:e.desiredCount,numberOfValues:e.numberOfValues}}function KT(e,t){if(!JT(e));let{dispatch:r}=e,n=dF(t.options);return r(bl(n)),{...O(e),get state(){return {automaticFacets:e.state.search.response.generateAutomaticFacets?.facets.map(i=>lF(e,{field:i.field}))??[]}}}}function JT(e){return e.addReducers({automaticFacetSet:uF,configuration:L,search:j}),!0}function ff(e,t){return e.generatedAnswer?.citations?.find(r=>r.id===t)}function tt(e){return e.search?.response?.extendedResults?.generativeQuestionAnsweringId}var Nt="RGA",XT=()=>b("analytics/generatedAnswer/retry",e=>e.makeRetryGeneratedAnswer()),ZT=e=>b("analytics/generatedAnswer/rephrase",(t,r)=>{let n=tt(r);return n?t.makeRephraseGeneratedAnswer({generativeQuestionAnsweringId:n,rephraseFormat:e.answerStyle}):null}),eq=e=>b({prefix:"analytics/generatedAnswer/openAnswerSource",__legacy__getBuilder:(t,r)=>{let n=tt(r),o=ff(r,e);return !n||!o?null:t.makeOpenGeneratedAnswerSource({generativeQuestionAnsweringId:n,permanentId:o.permanentid,citationId:o.id})},analyticsType:"Qna.CitationClick",analyticsPayloadBuilder:t=>({answer:{responseId:t.search?.response.searchUid||"",type:Nt},citation:{id:e,type:"Source"}})}),tq=(e,t)=>b({prefix:"analytics/generatedAnswer/hoverCitation",__legacy__getBuilder:(r,n)=>{let o=tt(n),a=ff(n,e);return !o||!a?null:r.makeGeneratedAnswerSourceHover({generativeQuestionAnsweringId:o,permanentId:a.permanentid,citationId:a.id,citationHoverTimeMs:t})},analyticsType:"Qna.CitationHover",analyticsPayloadBuilder:r=>({answer:{responseId:r.search?.response.searchUid||"",type:Nt},citation:{id:e,type:"Source"},citationHoverTimeInMs:t})}),rq=()=>b({prefix:"analytics/generatedAnswer/like",__legacy__getBuilder:(e,t)=>{let r=tt(t);return r?e.makeLikeGeneratedAnswer({generativeQuestionAnsweringId:r}):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>({answer:{responseId:e.search?.response.searchUid||"",type:Nt},feedback:{liked:!0}})}),nq=()=>b({prefix:"analytics/generatedAnswer/dislike",__legacy__getBuilder:(e,t)=>{let r=tt(t);return r?e.makeDislikeGeneratedAnswer({generativeQuestionAnsweringId:r}):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:e=>({answer:{responseId:e.search?.response.searchUid||"",type:Nt},feedback:{liked:!1}})}),oq=e=>b({prefix:"analytics/generatedAnswer/sendFeedback",__legacy__getBuilder:(t,r)=>{let n=tt(r);return n?t.makeGeneratedAnswerFeedbackSubmit({generativeQuestionAnsweringId:n,reason:e}):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>({answer:{responseId:t.search?.response.searchUid||"",type:Nt},feedback:{liked:!1,reason:e}})}),aq=e=>b({prefix:"analytics/generatedAnswer/sendFeedback",__legacy__getBuilder:(t,r)=>{let n=tt(r);return n?t.makeGeneratedAnswerFeedbackSubmit({generativeQuestionAnsweringId:n,reason:"other",details:e}):null},analyticsType:"Qna.SubmitFeedback",analyticsPayloadBuilder:t=>({answer:{responseId:t.search?.response.searchUid||"",type:Nt},feedback:{liked:!1,reason:"other",details:e}})}),gf=e=>b("analytics/generatedAnswer/streamEnd",(t,r)=>{let n=tt(r),o=e?!r.generatedAnswer?.answer||!r.generatedAnswer?.answer.length:void 0;return n?t.makeGeneratedAnswerStreamEnd({generativeQuestionAnsweringId:n,answerGenerated:e,answerTextIsEmpty:o}):null}),iq=()=>b({prefix:"analytics/generatedAnswer/show",__legacy__getBuilder:(e,t)=>{let r=tt(t);return r?e.makeGeneratedAnswerShowAnswers({generativeQuestionAnsweringId:r}):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"show",answer:{responseId:e.search?.response.searchUid||"",type:Nt}})}),sq=()=>b({prefix:"analytics/generatedAnswer/hide",__legacy__getBuilder:(e,t)=>{let r=tt(t);return r?e.makeGeneratedAnswerHideAnswers({generativeQuestionAnsweringId:r}):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"hide",answer:{responseId:e.search?.response.searchUid||"",type:Nt}})}),cq=()=>b({prefix:"analytics/generatedAnswer/expand",__legacy__getBuilder:(e,t)=>{let r=tt(t);return r?e.makeGeneratedAnswerExpand({generativeQuestionAnsweringId:r}):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"expand",answer:{responseId:e.search?.response.searchUid||"",type:Nt}})}),uq=()=>b({prefix:"analytics/generatedAnswer/collapse",__legacy__getBuilder:(e,t)=>{let r=tt(t);return r?e.makeGeneratedAnswerCollapse({generativeQuestionAnsweringId:r}):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"collapse",answer:{responseId:e.search?.response.searchUid||"",type:Nt}})}),lq=()=>b({prefix:"analytics/generatedAnswer/copy",__legacy__getBuilder:(e,t)=>{let r=tt(t);return r?e.makeGeneratedAnswerCopyToClipboard({generativeQuestionAnsweringId:r}):null},analyticsType:"Qna.AnswerAction",analyticsPayloadBuilder:e=>({action:"copyToClipboard",answer:{responseId:e.search?.response.searchUid||"",type:Nt}})});var wi={logCopyGeneratedAnswer:lq,logGeneratedAnswerHideAnswers:sq,logGeneratedAnswerShowAnswers:iq,logGeneratedAnswerStreamEnd:gf,logGeneratedAnswerDetailedFeedback:aq,logGeneratedAnswerFeedback:oq,logDislikeGeneratedAnswer:nq,logLikeGeneratedAnswer:rq,logHoverCitation:tq,logOpenGeneratedAnswerSource:eq,logRetryGeneratedAnswer:XT,logRephraseGeneratedAnswer:ZT,logGeneratedAnswerExpand:cq,logGeneratedAnswerCollapse:uq};var pF=async e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.platformUrl,streamId:e.search.extendedResults?.generativeQuestionAnsweringId});var mF=["default","bullet","step","concise"],fF=["text/plain","text/markdown"];var Ts=new x({required:!0}),gF=new x,gd=new Q({required:!0}),dq={id:Ts,title:Ts,uri:Ts,permanentid:Ts,clickUri:gF},SF=new x({required:!0,constrainTo:fF}),Ei=f("generatedAnswer/setIsVisible",e=>g(e,gd)),Sf=f("generatedAnswer/updateMessage",e=>g(e,{textDelta:Ts})),hf=f("generatedAnswer/updateCitations",e=>g(e,{citations:new B({required:!0,each:new E({values:dq})})})),yf=f("generatedAnswer/updateError",e=>g(e,{message:gF,code:new I({min:0})})),Co=f("generatedAnswer/resetAnswer"),Sd=f("generatedAnswer/like"),hd=f("generatedAnswer/dislike"),yd=f("generatedAnswer/feedbackModal/open"),Ds=f("generatedAnswer/expand"),Cd=f("generatedAnswer/collapse"),xd=f("generatedAnswer/setId",e=>g(e,{id:new x({required:!0})})),Fd=f("generatedAnswer/feedbackModal/close"),Vs=f("generatedAnswer/sendFeedback"),qs=f("generatedAnswer/setIsLoading",e=>g(e,gd)),fd=f("generatedAnswer/setIsStreaming",e=>g(e,gd)),Cf=f("generatedAnswer/setAnswerContentFormat",e=>g(e,SF)),Ns=f("generatedAnswer/updateResponseFormat",e=>g(e,{answerStyle:new x({required:!0,constrainTo:mF}),contentFormat:new B({each:SF,default:["text/plain"]})})),Ad=f("generatedAnswer/registerFieldsToIncludeInCitations",e=>g(e,Oc)),xf=f("generatedAnswer/setIsAnswerGenerated",e=>g(e,gd)),hF=N("generatedAnswer/streamAnswer",async(e,t)=>{let r=t.getState(),{dispatch:n,extra:o}=t,{setAbortControllerRef:a}=e,i=await pF(r),s=(l,d)=>{switch(l){case"genqa.headerMessageType":{let p=JSON.parse(d);n(Cf(p.contentFormat));break}case"genqa.messageType":n(Sf(JSON.parse(d)));break;case"genqa.citationsType":n(hf(JSON.parse(d)));break;case"genqa.endOfStreamType":{let p=JSON.parse(d).answerGenerated;n(fd(!1)),n(xf(p)),n(gf(p));break}default:r.debug&&o.logger.warn(`Unknown payloadType: "${l}"`);}};n(qs(!0));let c=l=>l.streamId===t.getState().search.extendedResults.generativeQuestionAnsweringId,u=o.streamingClient?.streamGeneratedAnswer(i,{write:l=>{c(i)&&(n(qs(!1)),l.payload&&l.payloadType&&s(l.payloadType,l.payload));},abort:l=>{c(i)&&n(yf(l));},close:()=>{c(i)&&n(fd(!1));},resetAnswer:()=>{c(i)&&n(Co());}});u?a(u):n(qs(!1));});var Rd=k(Mi(),e=>e.addCase(Ei,(t,{payload:r})=>{t.isVisible=r;}).addCase(xd,(t,{payload:r})=>{t.id=r.id;}).addCase(Sf,(t,{payload:r})=>{t.isLoading=!1,t.isStreaming=!0,t.answer||(t.answer=""),t.answer+=r.textDelta,delete t.error;}).addCase(hf,(t,{payload:r})=>{t.isLoading=!1,t.isStreaming=!0,t.citations=t.citations.concat(r.citations),delete t.error;}).addCase(yf,(t,{payload:r})=>{t.isLoading=!1,t.isStreaming=!1,t.error={...r,isRetryable:r.code===wp},t.citations=[],delete t.answer;}).addCase(Sd,t=>{t.liked=!0,t.disliked=!1;}).addCase(hd,t=>{t.liked=!1,t.disliked=!0;}).addCase(yd,t=>{t.feedbackModalOpen=!0;}).addCase(Fd,t=>{t.feedbackModalOpen=!1;}).addCase(Vs,t=>{t.feedbackSubmitted=!0;}).addCase(Co,t=>({...Mi(),responseFormat:t.responseFormat,fieldsToIncludeInCitations:t.fieldsToIncludeInCitations,isVisible:t.isVisible,id:t.id})).addCase(qs,(t,{payload:r})=>{t.isLoading=r;}).addCase(fd,(t,{payload:r})=>{t.isStreaming=r;}).addCase(Cf,(t,{payload:r})=>{t.answerContentFormat=r;}).addCase(Ns,(t,{payload:r})=>{t.responseFormat=r;}).addCase(Ad,(t,r)=>{t.fieldsToIncludeInCitations=[...new Set(t.fieldsToIncludeInCitations.concat(r.payload))];}).addCase(xf,(t,{payload:r})=>{t.isAnswerGenerated=r;}).addCase(Ds,t=>{t.expanded=!0;}).addCase(Cd,t=>{t.expanded=!1;}));var dt={engines:{},setAbortControllerRef:(e,t)=>{dt.engines[t].abortController=e;},getIsStreamInProgress:e=>!dt.engines[e].abortController||dt.engines[e].abortController?.signal.aborted?(dt.engines[e].abortController=void 0,!1):!0,subscribeToSearchRequests:e=>{let t=()=>{let r=e.state,n=r.search.requestId,o=r.search.extendedResults.generativeQuestionAnsweringId,a=r.generatedAnswer.id;dt.engines[a].lastRequestId!==n&&(dt.engines[a].lastRequestId=n,dt.engines[a].abortController?.abort(),e.dispatch(Co())),!dt.getIsStreamInProgress(a)&&o&&o!==dt.engines[a].lastStreamId&&(dt.engines[a].lastStreamId=o,e.dispatch(hF({setAbortControllerRef:s=>dt.setAbortControllerRef(s,a)})));};return e.subscribe(t)}};function yF(e,t,r={}){if(!pq(e));let{dispatch:n}=e,o=O(e),a=()=>e.state;if(!e.state.generatedAnswer.id){let l=Gr("genQA-",12);n(xd({id:l})),dt.engines[l]={abortController:void 0,lastRequestId:"",lastStreamId:""};}let i=r.initialState?.isVisible;i!==void 0&&n(Ei(i));let s=r.initialState?.responseFormat;s&&n(Ns(s));let c=r.fieldsToIncludeInCitations;return c&&n(Ad(c)),r.initialState?.expanded&&n(Ds()),dt.subscribeToSearchRequests(e),{...o,get state(){return a().generatedAnswer},like(){this.state.liked||(n(Sd()),n(t.logLikeGeneratedAnswer()));},dislike(){this.state.disliked||(n(hd()),n(t.logDislikeGeneratedAnswer()));},openFeedbackModal(){n(yd());},closeFeedbackModal(){n(Fd());},sendFeedback(l){n(t.logGeneratedAnswerFeedback(l)),n(Vs());},sendDetailedFeedback(l){n(t.logGeneratedAnswerDetailedFeedback(l)),n(Vs());},logCitationClick(l){n(t.logOpenGeneratedAnswerSource(l));},logCitationHover(l,d){n(t.logHoverCitation(l,d));},rephrase(l){n(Ns(l));},show(){this.state.isVisible||(n(Ei(!0)),n(t.logGeneratedAnswerShowAnswers()));},hide(){this.state.isVisible&&(n(Ei(!1)),n(t.logGeneratedAnswerHideAnswers()));},expand(){this.state.expanded||(n(Ds()),n(t.logGeneratedAnswerExpand()));},collapse(){this.state.expanded&&(n(Cd()),n(t.logGeneratedAnswerCollapse()));},logCopyToClipboard(){n(t.logCopyGeneratedAnswer());},retry(){}}}function pq(e){return e.addReducers({generatedAnswer:Rd}),!0}function mq(e,t={}){let{dispatch:r}=e,n=yF(e,wi,t);return {...n,get state(){return n.state},retry(){r(R({legacy:wi.logRetryGeneratedAnswer()}));},rephrase(o){n.rephrase(o),r(R({legacy:wi.logRephraseGeneratedAnswer(o)}));}}}function CF(e,t,r){let n=!1,o=()=>{n||(n=!0,e.dispatch(t.logOpenGeneratedAnswerSource(r.options.citation.id)));};return et(e,r,()=>{o();})}function fq(e,t){return CF(e,wi,t)}var Bn=()=>new x({required:!1,emptyAllowed:!0}),bd=f("advancedSearchQueries/update",e=>g(e,{aq:Bn(),cq:Bn(),lq:Bn(),dq:Bn()})),vd=f("advancedSearchQueries/register",e=>g(e,{aq:Bn(),cq:Bn(),lq:Bn(),dq:Bn()}));k(nt(),e=>{e.addCase(bd,(t,r)=>{let{aq:n,cq:o,lq:a,dq:i}=r.payload;ye(n)||(t.aq=n,t.aqWasSet=!0),ye(o)||(t.cq=o,t.cqWasSet=!0),ye(a)||(t.lq=a,t.lqWasSet=!0),ye(i)||(t.dq=i,t.dqWasSet=!0);}).addCase(vd,(t,r)=>{let{aq:n,cq:o,lq:a,dq:i}=r.payload;ye(n)||(t.defaultFilters.aq=n,t.aqWasSet||(t.aq=n)),ye(o)||(t.defaultFilters.cq=o,t.cqWasSet||(t.cq=o)),ye(a)||(t.defaultFilters.lq=a,t.lqWasSet||(t.lq=a)),ye(i)||(t.defaultFilters.dq=i,t.dqWasSet||(t.dq=i));}).addCase(ne.fulfilled,(t,r)=>r.payload?.advancedSearchQueries??t).addCase(oe,(t,r)=>{let{aq:n,cq:o}=r.payload;ye(n)||(t.aq=n,t.aqWasSet=!0),ye(o)||(t.cq=o,t.cqWasSet=!0);});});function afe(e){return e.addReducers({configuration:L,pipeline:Jo,searchHub:Zo}),{updateSearchConfiguration:gt}}function wfe(e){return e.addReducers({dateFacetSet:yr}),{deselectAllDateFacetValues:Uu,registerDateFacet:dr,toggleSelectDateFacetValue:pr,toggleExcludeDateFacetValue:mr,updateDateFacetSortCriterion:Bu,updateDateFacetValues:Br}}function jfe(e){return e.addReducers({fields:Cn}),{registerFieldsToInclude:Sn,enableFetchAllFields:xa,disableFetchAllFields:Xn,fetchFieldsDescription:Fa}}function rge(e){return e.addReducers({numericFacetSet:ht}),{deselectAllNumericFacetValues:$u,registerNumericFacet:fr,toggleSelectNumericFacetValue:gr,toggleExcludeNumericFacetValue:Sr,updateNumericFacetSortCriterion:ju,updateNumericFacetValues:Ur}}function Age(e){return e.addReducers({query:Ct}),{updateQuery:Me}}function Wge(e){return e.addReducers({querySuggest:ti,querySet:ei}),{clearQuerySuggest:Rn,fetchQuerySuggestions:bn,registerQuerySuggest:Ta,selectQuerySuggestion:Zt}}var Pd=f("excerptLength/set",e=>g(e,new I({min:0,required:!0})));k(tc(),e=>{e.addCase(Pd,(t,r)=>{t.length=r.payload;});});var gq=new $({content:new se({required:!0}),conditions:new se({required:!0}),priority:new I({required:!1,default:0,min:0}),fields:new B({required:!1,each:P})});function AF(){let e=[],t=r=>{let n=gq.validate(r);if(!r.conditions.every(a=>a instanceof Function))throw new $n("Each template condition should be a function that takes a Result or Product as an argument and returns a boolean");return n};return {registerTemplates(...r){r.forEach(n=>{let o={...t(n),fields:n.fields||[]};e.push(o);}),e.sort((n,o)=>o.priority-n.priority);},selectTemplate(r){let n=e.find(o=>o.conditions.every(a=>a(r)));return n?n.content:null}}}function Sq(e){if(!hq(e));let{registerTemplates:t,selectTemplate:r}=AF();return {registerTemplates:(...n)=>{t(...n);let o=[];n.forEach(a=>{a.fields&&o.push(...a.fields);}),e.dispatch(Sn(o));},selectTemplate:r}}function hq(e){return e.addReducers({fields:Cn}),!0}var RF=N("analytics/addPageViewEntry",async(e,{getState:t})=>{t().configuration.analytics.enabled&&Ye.addElement({name:"PageView",value:e,time:JSON.stringify(new Date)});});function Fye(e){return e.addReducers({}),{addPageViewEntryInActionsHistory:RF}}function yq(e){let{by:t,order:r}=e;switch(t){case"relevancy":return Qi();case"qre":return np();case"nosort":return op();case"date":if(!r)throw new Error('An order (i.e., ascending or descending) should be specified for a sort criterion sorted by "date"');return tp(r);default:if(!r)throw new Error(`An order (i.e., ascending or descending) should be specified for a sort criterion sorted by a field, such as "${t}"`);return rp(t,r)}}function Cq(e){return e===void 0||e==="ascending"||e==="descending"}function xq(e){let t=e.split(","),r=new Error(`Wrong criterion expression format for "${e}"`);if(!t.length)throw r;return t.map(n=>{let o=n.trim().split(" "),a=o[0].toLowerCase(),i=o[1]&&o[1].toLowerCase();if(o.length>2||a==="")throw r;if(!Cq(i))throw new Error(`Wrong criterion sort order "${i}" in expression "${e}". Order should either be "ascending" or "descending"`);return yq({by:a,order:i})})}Ff();/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

export { KT as $, Age as A, vw as B, GO as C, ZA as D, EE as E, Fye as F, Gn as G, xT as H, jk as I, Jk as J, KO as K, Li as L, Mk as M, xq as N, Ok as O, OP as P, cI as Q, RT as R, Sq as S, wfe as T, yg as U, qT as V, Wge as W, XO as X, YE as Y, Zk as Z, _T as _, Fk as a, bk as b, cT as c, dT as d, JI as e, fq as f, gT as g, eI as h, oI as i, jE as j, rge as k, lo as l, mq as m, Sk as n, ow as o, iO as p, jm as q, rO as r, ss as s, Ek as t, afe as u, jfe as v, wk as w, xs as x, yk as y, zw as z };

//# sourceMappingURL=headless.esm-88bad35d.js.map