{"version":3,"names":["atomicResultFieldsListCss","AtomicResultFieldsListStyle0","AtomicResultFieldsList","constructor","hostRef","this","updatingChildren","rows","connectedCallback","window","ResizeObserver","resizeObserver","update","observe","host","parentElement","disconnectedCallback","_a","disconnect","componentDidRender","showDividers","showChildren","hideChildrenToFit","hideDividersAtEndOfRows","children","Array","from","isOverflowing","scrollWidth","clientWidth","scrollHeight","clientHeight","getSortedChildrenBySize","sort","a","b","offsetWidth","hide","element","style","display","show","isChildHidden","setHideDivider","hideDivider","classList","toggle","forEach","child","i","length","previousChild","filter","row","offsetTop","indexOf","push","render","h","Host","key","__decorate","ResultContext"],"sources":["src/components/search/result-template-components/atomic-result-fields-list/atomic-result-fields-list.pcss?tag=atomic-result-fields-list","src/components/search/result-template-components/atomic-result-fields-list/atomic-result-fields-list.tsx"],"sourcesContent":["@import '../../../../global/global.pcss';\n\natomic-result-fields-list {\n  display: flex;\n  flex-wrap: wrap;\n  width: 100%;\n  height: 100%;\n\n  > * {\n    &::after {\n      display: block;\n      content: ' ';\n      width: 1px;\n      height: 1rem;\n      margin: 0 1rem;\n      background-color: var(--atomic-neutral);\n      vertical-align: middle;\n    }\n\n    &.hide-divider::after {\n      visibility: hidden;\n    }\n  }\n}\n","import {Result} from '@coveo/headless';\nimport {Component, h, Element, Host} from '@stencil/core';\nimport {ResultContext} from '../result-template-decorators';\n\n/**\n * The `atomic-result-fields-list` component selectively renders its children to ensure they fit the parent element and adds dividers between them.\n */\n@Component({\n  tag: 'atomic-result-fields-list',\n  styleUrl: 'atomic-result-fields-list.pcss',\n  shadow: false,\n})\nexport class AtomicResultFieldsList {\n  @ResultContext()\n  protected result!: Result;\n\n  private resizeObserver?: ResizeObserver;\n\n  private updatingChildren = false;\n  private rows: number[] = [];\n  @Element() private host!: HTMLElement;\n\n  public connectedCallback() {\n    if (window.ResizeObserver) {\n      this.resizeObserver = new ResizeObserver(() => this.update());\n      this.resizeObserver.observe(this.host.parentElement!);\n    }\n  }\n\n  public disconnectedCallback() {\n    this.resizeObserver?.disconnect();\n  }\n\n  public componentDidRender() {\n    this.update();\n  }\n\n  public update() {\n    if (this.updatingChildren) {\n      return;\n    }\n    this.updatingChildren = true;\n    this.showDividers();\n    this.showChildren();\n    this.hideChildrenToFit();\n    this.hideDividersAtEndOfRows();\n    this.updatingChildren = false;\n  }\n\n  private get children() {\n    return Array.from(this.host.children) as HTMLElement[];\n  }\n\n  private get isOverflowing() {\n    return (\n      this.host.scrollWidth > this.host.clientWidth ||\n      this.host.scrollHeight > this.host.clientHeight\n    );\n  }\n\n  private getSortedChildrenBySize() {\n    return this.children.sort((a, b) => a.offsetWidth - b.offsetWidth);\n  }\n\n  private hide(element: HTMLElement) {\n    element.style.display = 'none';\n  }\n\n  private show(element: HTMLElement) {\n    element.style.display = '';\n  }\n\n  private isChildHidden(element: HTMLElement) {\n    return element.style.display === 'none';\n  }\n\n  private setHideDivider(element: HTMLElement, hideDivider: boolean) {\n    element.classList.toggle('hide-divider', hideDivider);\n  }\n\n  private showChildren() {\n    this.children.forEach((child) => this.show(child));\n  }\n\n  private showDividers() {\n    this.children.forEach((child) => this.setHideDivider(child, false));\n  }\n\n  private hideChildrenToFit() {\n    const children = this.getSortedChildrenBySize();\n    for (let i = children.length - 1; this.isOverflowing && i >= 0; i--) {\n      this.hide(children[i]);\n    }\n  }\n\n  private hideDividersAtEndOfRows() {\n    this.rows = [];\n    let previousChild: HTMLElement | null = null;\n    this.children\n      .filter((child) => !this.isChildHidden(child))\n      .forEach((child) => {\n        const row = child.offsetTop;\n        if (this.rows.indexOf(row) === -1) {\n          this.rows.push(row);\n          if (previousChild) {\n            this.setHideDivider(previousChild, true);\n          }\n        }\n        previousChild = child;\n      });\n    if (previousChild) {\n      this.setHideDivider(previousChild, true);\n    }\n  }\n\n  render() {\n    return <Host></Host>;\n  }\n}\n"],"mappings":"wLAAA,MAAMA,EAA4B,qxuCAClC,MAAAC,EAAeD,E,iXCWFE,EAAsB,MALnC,WAAAC,CAAAC,G,UAWUC,KAAAC,iBAAmB,MACnBD,KAAAE,KAAiB,E,CAGlB,iBAAAC,GACL,GAAIC,OAAOC,eAAgB,CACzBL,KAAKM,eAAiB,IAAID,gBAAe,IAAML,KAAKO,WACpDP,KAAKM,eAAeE,QAAQR,KAAKS,KAAKC,c,EAInC,oBAAAC,G,OACLC,EAAAZ,KAAKM,kBAAc,MAAAM,SAAA,SAAAA,EAAEC,Y,CAGhB,kBAAAC,GACLd,KAAKO,Q,CAGA,MAAAA,GACL,GAAIP,KAAKC,iBAAkB,CACzB,M,CAEFD,KAAKC,iBAAmB,KACxBD,KAAKe,eACLf,KAAKgB,eACLhB,KAAKiB,oBACLjB,KAAKkB,0BACLlB,KAAKC,iBAAmB,K,CAG1B,YAAYkB,GACV,OAAOC,MAAMC,KAAKrB,KAAKS,KAAKU,S,CAG9B,iBAAYG,GACV,OACEtB,KAAKS,KAAKc,YAAcvB,KAAKS,KAAKe,aAClCxB,KAAKS,KAAKgB,aAAezB,KAAKS,KAAKiB,Y,CAI/B,uBAAAC,GACN,OAAO3B,KAAKmB,SAASS,MAAK,CAACC,EAAGC,IAAMD,EAAEE,YAAcD,EAAEC,a,CAGhD,IAAAC,CAAKC,GACXA,EAAQC,MAAMC,QAAU,M,CAGlB,IAAAC,CAAKH,GACXA,EAAQC,MAAMC,QAAU,E,CAGlB,aAAAE,CAAcJ,GACpB,OAAOA,EAAQC,MAAMC,UAAY,M,CAG3B,cAAAG,CAAeL,EAAsBM,GAC3CN,EAAQO,UAAUC,OAAO,eAAgBF,E,CAGnC,YAAAvB,GACNhB,KAAKmB,SAASuB,SAASC,GAAU3C,KAAKoC,KAAKO,I,CAGrC,YAAA5B,GACNf,KAAKmB,SAASuB,SAASC,GAAU3C,KAAKsC,eAAeK,EAAO,Q,CAGtD,iBAAA1B,GACN,MAAME,EAAWnB,KAAK2B,0BACtB,IAAK,IAAIiB,EAAIzB,EAAS0B,OAAS,EAAG7C,KAAKsB,eAAiBsB,GAAK,EAAGA,IAAK,CACnE5C,KAAKgC,KAAKb,EAASyB,G,EAIf,uBAAA1B,GACNlB,KAAKE,KAAO,GACZ,IAAI4C,EAAoC,KACxC9C,KAAKmB,SACF4B,QAAQJ,IAAW3C,KAAKqC,cAAcM,KACtCD,SAASC,IACR,MAAMK,EAAML,EAAMM,UAClB,GAAIjD,KAAKE,KAAKgD,QAAQF,MAAU,EAAG,CACjChD,KAAKE,KAAKiD,KAAKH,GACf,GAAIF,EAAe,CACjB9C,KAAKsC,eAAeQ,EAAe,K,EAGvCA,EAAgBH,CAAK,IAEzB,GAAIG,EAAe,CACjB9C,KAAKsC,eAAeQ,EAAe,K,EAIvC,MAAAM,GACE,OAAOC,EAACC,EAAI,CAAAC,IAAA,4C,6BAtGJC,EAAA,CADTC,K"}