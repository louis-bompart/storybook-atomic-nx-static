/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var e=Object.create;var t=Object.defineProperty;var r=Object.getOwnPropertyDescriptor;var n=Object.getOwnPropertyNames;var i=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty;var a=(e,r,n)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n;var s=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):e)((function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}));var u=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),c=(e,r)=>{for(var n in r)t(e,n,{get:r[n],enumerable:!0})},l=(e,i,a,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let u of n(i))!o.call(e,u)&&u!==a&&t(e,u,{get:()=>i[u],enumerable:!(s=r(i,u))||s.enumerable});return e};var d=(r,n,o)=>(o=r!=null?e(i(r)):{},l(n||!r||!r.__esModule?t(o,"default",{value:r,enumerable:!0}):o,r));var h=(e,t,r)=>a(e,typeof t!="symbol"?t+"":t,r);var f=u(((e,t)=>{function r(e){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");if(e=`${e}`,e=e.replace(/[ \t\n\f\r]/g,""),e.length%4===0&&(e=e.replace(/==?$/,"")),e.length%4===1||/[^+/0-9A-Za-z]/.test(e))return null;let t="",r=0,n=0;for(let o=0;o<e.length;o++)r<<=6,r|=i(e[o]),n+=6,n===24&&(t+=String.fromCharCode((r&16711680)>>16),t+=String.fromCharCode((r&65280)>>8),t+=String.fromCharCode(r&255),r=n=0);return n===12?(r>>=4,t+=String.fromCharCode(r)):n===18&&(r>>=2,t+=String.fromCharCode((r&65280)>>8),t+=String.fromCharCode(r&255)),t}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function i(e){let t=n.indexOf(e);return t<0?void 0:t}t.exports=r}));var p=u(((e,t)=>{function r(e){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");let t;for(e=`${e}`,t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return null;let r="";for(t=0;t<e.length;t+=3){let n=[void 0,void 0,void 0,void 0];n[0]=e.charCodeAt(t)>>2,n[1]=(e.charCodeAt(t)&3)<<4,e.length>t+1&&(n[1]|=e.charCodeAt(t+1)>>4,n[2]=(e.charCodeAt(t+1)&15)<<2),e.length>t+2&&(n[2]|=e.charCodeAt(t+2)>>6,n[3]=e.charCodeAt(t+2)&63);for(let e=0;e<n.length;e++)typeof n[e]>"u"?r+="=":r+=i(n[e])}return r}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function i(e){if(e>=0&&e<64)return n[e]}t.exports=r}));var v=u(((e,t)=>{var r=f(),n=p();t.exports={atob:r,btoa:n}}));var y=u(((e,t)=>{t.exports=fetch}));var g=u((e=>{var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var r={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};function n(e){var n=t(t({},r),e);return n.numOfAttempts<1&&(n.numOfAttempts=1),n}e.getSanitizedOptions=n}));var m=u((e=>{Object.defineProperty(e,"__esModule",{value:!0});function t(e){var t=Math.random()*e;return Math.round(t)}e.fullJitter=t}));var w=u((e=>{Object.defineProperty(e,"__esModule",{value:!0});function t(e){return e}e.noJitter=t}));var b=u((e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=m(),r=w();function n(e){switch(e.jitter){case"full":return t.fullJitter;case"none":default:return r.noJitter}}e.JitterFactory=n}));var S=u((e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=b(),r=function(){function e(e){this.options=e,this.attempt=0}return e.prototype.apply=function(){var e=this;return new Promise((function(t){return setTimeout(t,e.jitteredDelay)}))},e.prototype.setAttemptNumber=function(e){this.attempt=e},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){var e=t.JitterFactory(this.options);return e(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var e=this.options.startingDelay,t=this.options.timeMultiple,r=this.numOfDelayedAttempts,n=e*Math.pow(t,r);return Math.min(n,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}();e.Delay=r}));var I=u((e=>{var t=e&&e.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),r=e&&e.__awaiter||function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){e.done?r(e.value):i(e.value).then(a,s)}u((n=n.apply(e,t||[])).next())}))},n=e&&e.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(e){return function(t){return u([e,t])}}function u(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=a[0]&2?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[a[0]&2,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(a[0]===6&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],i=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var i=S(),o=function(e){t(i,e);function i(){return e!==null&&e.apply(this,arguments)||this}return i.prototype.apply=function(){return r(this,void 0,void 0,(function(){return n(this,(function(t){return[2,this.isFirstAttempt?!0:e.prototype.apply.call(this)]}))}))},Object.defineProperty(i.prototype,"isFirstAttempt",{get:function(){return this.attempt===0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),i}(i.Delay);e.SkipFirstDelay=o}));var q=u((e=>{var t=e&&e.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=S(),n=function(e){t(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r}(r.Delay);e.AlwaysDelay=n}));var O=u((e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=I(),r=q();function n(e,t){var r=i(e);return r.setAttemptNumber(t),r}e.DelayFactory=n;function i(e){return e.delayFirstAttempt?new r.AlwaysDelay(e):new t.SkipFirstDelay(e)}}));var k=u((e=>{var t=e&&e.__awaiter||function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){e.done?r(e.value):i(e.value).then(a,s)}u((n=n.apply(e,t||[])).next())}))},r=e&&e.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(e){return function(t){return u([e,t])}}function u(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=a[0]&2?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[a[0]&2,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(a[0]===6&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],i=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var n=g(),i=O();function o(e,i){return i===void 0&&(i={}),t(this,void 0,void 0,(function(){var t,o;return r(this,(function(r){switch(r.label){case 0:return t=n.getSanitizedOptions(i),o=new a(e,t),[4,o.execute()];case 1:return[2,r.sent()]}}))}))}e.backOff=o;var a=function(){function e(e,t){this.request=e,this.options=t,this.attemptNumber=0}return e.prototype.execute=function(){return t(this,void 0,void 0,(function(){var e,t;return r(this,(function(r){switch(r.label){case 0:if(this.attemptLimitReached)return[3,7];r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return r.sent(),[4,this.request()];case 3:return[2,r.sent()];case 4:return e=r.sent(),this.attemptNumber++,[4,this.options.retry(e,this.attemptNumber)];case 5:if(t=r.sent(),!t||this.attemptLimitReached)throw e;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}}))}))},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return t(this,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return e=i.DelayFactory(this.options,this.attemptNumber),[4,e.apply()];case 1:return t.sent(),[2]}}))}))},e}()}));var A=u(((e,t)=>{var r=typeof self<"u"?self:typeof window<"u"?window:void 0;if(!r)throw new Error("Unable to find global scope. Are you sure this is running in the browser?");if(!r.AbortController)throw new Error('Could not find "AbortController" in the global scope. You need to polyfill it first');t.exports.AbortController=r.AbortController}));var C=u(((e,t)=>{var r=/(^|; )Coveo-Pendragon=([^;]*)/;t.exports=()=>r.exec(document.cookie)?.pop()||null}));var j=u(((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs=n()})(e,(function(){var e=1e3,t=6e4,r=36e5,n="millisecond",i="second",o="minute",a="hour",s="day",u="week",c="month",l="quarter",d="year",h="date",f="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}},g=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},m={s:g,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),i=r%60;return(t<=0?"+":"-")+g(n,2,"0")+":"+g(i,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),i=t.clone().add(n,c),o=r-i<0,a=t.clone().add(n+(o?-1:1),c);return+(-(n+(r-i)/(o?i-a:a-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:d,w:u,d:s,D:h,h:a,m:o,s:i,ms:n,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return e===void 0}},w="en",b={};b[w]=y;var S="$isDayjsObject",I=function(e){return e instanceof A||!(!e||!e[S])},q=function e(t,r,n){var i;if(!t)return w;if(typeof t=="string"){var o=t.toLowerCase();b[o]&&(i=o),r&&(b[o]=r,i=o);var a=t.split("-");if(!i&&a.length>1)return e(a[0])}else{var s=t.name;b[s]=t,i=s}return!n&&i&&(w=i),i||!n&&w},O=function(e,t){if(I(e))return e.clone();var r=typeof t=="object"?t:{};return r.date=e,r.args=arguments,new A(r)},k=m;k.l=q,k.i=I,k.w=function(e,t){return O(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var A=function(){function y(e){this.$L=q(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[S]=!0}var g=y.prototype;return g.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(t===null)return new Date(NaN);if(k.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var n=t.match(p);if(n){var i=n[2]-1||0,o=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(t)}(e),this.init()},g.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},g.$utils=function(){return k},g.isValid=function(){return this.$d.toString()!==f},g.isSame=function(e,t){var r=O(e);return this.startOf(t)<=r&&r<=this.endOf(t)},g.isAfter=function(e,t){return O(e)<this.startOf(t)},g.isBefore=function(e,t){return this.endOf(t)<O(e)},g.$g=function(e,t,r){return k.u(e)?this[t]:this.set(r,e)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(e,t){var r=this,n=!!k.u(t)||t,l=k.p(e),f=function(e,t){var i=k.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return n?i:i.endOf(s)},p=function(e,t){return k.w(r.toDate()[e].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},v=this.$W,y=this.$M,g=this.$D,m="set"+(this.$u?"UTC":"");switch(l){case d:return n?f(1,0):f(31,11);case c:return n?f(1,y):f(0,y+1);case u:var w=this.$locale().weekStart||0,b=(v<w?v+7:v)-w;return f(n?g-b:g+(6-b),y);case s:case h:return p(m+"Hours",0);case a:return p(m+"Minutes",1);case o:return p(m+"Seconds",2);case i:return p(m+"Milliseconds",3);default:return this.clone()}},g.endOf=function(e){return this.startOf(e,!1)},g.$set=function(e,t){var r,u=k.p(e),l="set"+(this.$u?"UTC":""),f=(r={},r[s]=l+"Date",r[h]=l+"Date",r[c]=l+"Month",r[d]=l+"FullYear",r[a]=l+"Hours",r[o]=l+"Minutes",r[i]=l+"Seconds",r[n]=l+"Milliseconds",r)[u],p=u===s?this.$D+(t-this.$W):t;if(u===c||u===d){var v=this.clone().set(h,1);v.$d[f](p),v.init(),this.$d=v.set(h,Math.min(this.$D,v.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},g.set=function(e,t){return this.clone().$set(e,t)},g.get=function(e){return this[k.p(e)]()},g.add=function(n,l){var h,f=this;n=Number(n);var p=k.p(l),v=function(e){var t=O(f);return k.w(t.date(t.date()+Math.round(e*n)),f)};if(p===c)return this.set(c,this.$M+n);if(p===d)return this.set(d,this.$y+n);if(p===s)return v(1);if(p===u)return v(7);var y=(h={},h[o]=t,h[a]=r,h[i]=e,h)[p]||1,g=this.$d.getTime()+n*y;return k.w(g,this)},g.subtract=function(e,t){return this.add(-1*e,t)},g.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||f;var n=e||"YYYY-MM-DDTHH:mm:ssZ",i=k.z(this),o=this.$H,a=this.$m,s=this.$M,u=r.weekdays,c=r.months,l=r.meridiem,d=function(e,r,i,o){return e&&(e[r]||e(t,n))||i[r].slice(0,o)},h=function(e){return k.s(o%12||12,e,"0")},p=l||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(v,(function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return k.s(t.$y,4,"0");case"M":return s+1;case"MM":return k.s(s+1,2,"0");case"MMM":return d(r.monthsShort,s,c,3);case"MMMM":return d(c,s);case"D":return t.$D;case"DD":return k.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(r.weekdaysMin,t.$W,u,2);case"ddd":return d(r.weekdaysShort,t.$W,u,3);case"dddd":return u[t.$W];case"H":return String(o);case"HH":return k.s(o,2,"0");case"h":return h(1);case"hh":return h(2);case"a":return p(o,a,!0);case"A":return p(o,a,!1);case"m":return String(a);case"mm":return k.s(a,2,"0");case"s":return String(t.$s);case"ss":return k.s(t.$s,2,"0");case"SSS":return k.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")}))},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(n,h,f){var p,v=this,y=k.p(h),g=O(n),m=(g.utcOffset()-this.utcOffset())*t,w=this-g,b=function(){return k.m(v,g)};switch(y){case d:p=b()/12;break;case c:p=b();break;case l:p=b()/3;break;case u:p=(w-m)/6048e5;break;case s:p=(w-m)/864e5;break;case a:p=w/r;break;case o:p=w/t;break;case i:p=w/e;break;default:p=w}return f?p:k.a(p)},g.daysInMonth=function(){return this.endOf(c).$D},g.$locale=function(){return b[this.$L]},g.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=q(e,t,!0);return n&&(r.$L=n),r},g.clone=function(){return k.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},y}(),C=A.prototype;return O.prototype=C,[["$ms",n],["$s",i],["$m",o],["$H",a],["$W",s],["$M",c],["$y",d],["$D",h]].forEach((function(e){C[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),O.extend=function(e,t){return e.$i||(e(t,A,O),e.$i=!0),O},O.locale=q,O.isDayjs=I,O.unix=function(e){return O(1e3*e)},O.en=b[w],O.Ls=b,O.p={},O}))}));var R=u(((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_timezone=n()})(e,(function(){var e={year:0,month:1,day:2,hour:3,minute:4,second:5},t={};return function(r,n,i){var o,a=function(e,r,n){n===void 0&&(n={});var i=new Date(e),o=function(e,r){r===void 0&&(r={});var n=r.timeZoneName||"short",i=e+"|"+n,o=t[i];return o||(o=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:n}),t[i]=o),o}(r,n);return o.formatToParts(i)},s=function(t,r){for(var n=a(t,r),o=[],s=0;s<n.length;s+=1){var u=n[s],c=u.type,l=u.value,d=e[c];d>=0&&(o[d]=parseInt(l,10))}var h=o[3],f=h===24?0:h,p=o[0]+"-"+o[1]+"-"+o[2]+" "+f+":"+o[4]+":"+o[5]+":000",v=+t;return(i.utc(p).valueOf()-(v-=v%1e3))/6e4},u=n.prototype;u.tz=function(e,t){e===void 0&&(e=o);var r=this.utcOffset(),n=this.toDate(),a=n.toLocaleString("en-US",{timeZone:e}),s=Math.round((n-new Date(a))/1e3/60),u=i(a,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(n.getTimezoneOffset()/15)-s,!0);if(t){var c=u.utcOffset();u=u.add(r-c,"minute")}return u.$x.$timezone=e,u},u.offsetName=function(e){var t=this.$x.$timezone||i.tz.guess(),r=a(this.valueOf(),t,{timeZoneName:e}).find((function(e){return e.type.toLowerCase()==="timezonename"}));return r&&r.value};var c=u.startOf;u.startOf=function(e,t){if(!this.$x||!this.$x.$timezone)return c.call(this,e,t);var r=i(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return c.call(r,e,t).tz(this.$x.$timezone,!0)},i.tz=function(e,t,r){var n=r&&t,a=r||t||o,u=s(+i(),a);if(typeof e!="string")return i(e).tz(a);var c=function(e,t,r){var n=e-60*t*1e3,i=s(n,r);if(t===i)return[n,t];var o=s(n-=60*(i-t)*1e3,r);return i===o?[n,i]:[e-60*Math.min(i,o)*1e3,Math.max(i,o)]}(i.utc(e,n).valueOf(),u,a),l=c[0],d=c[1],h=i(l).utcOffset(d);return h.$x.$timezone=a,h},i.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},i.tz.setDefault=function(e){o=e}}}))}));var D=u(((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_utc=n()})(e,(function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(n,i,o){var a=i.prototype;o.utc=function(e){var t={date:e,utc:!0,args:arguments};return new i(t)},a.utc=function(t){var r=o(this.toDate(),{locale:this.$L,utc:!0});return t?r.add(this.utcOffset(),e):r},a.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var s=a.parse;a.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),s.call(this,e)};var u=a.init;a.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else u.call(this)};var c=a.utcOffset;a.utcOffset=function(n,i){var o=this.$utils().u;if(o(n))return this.$u?0:o(this.$offset)?c.call(this):this.$offset;if(typeof n=="string"&&(n=function(e){e===void 0&&(e="");var n=e.match(t);if(!n)return null;var i=(""+n[0]).match(r)||["-",0,0],o=i[0],a=60*+i[1]+ +i[2];return a===0?0:o==="+"?a:-a}(n),n===null))return this;var a=Math.abs(n)<=16?60*n:n,s=this;if(i)return s.$offset=a,s.$u=n===0,s;if(n!==0){var u=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(a+u,e)).$offset=a,s.$x.$localOffset=u}else s=this.utc();return s};var l=a.format;a.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,t)},a.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var d=a.toDate;a.toDate=function(e){return e==="s"&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var h=a.diff;a.diff=function(e,t,r){if(e&&this.$u===e.$u)return h.call(this,e,t,r);var n=this.local(),i=o(e).local();return h.call(n,i,t,r)}}}))}));var M=u(((e,t)=>{function r(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}t.exports=n;function n(e,t,n){var i=n&&n.stringify||r,o=1;if(typeof e=="object"&&e!==null){var a=t.length+o;if(a===1)return e;var s=new Array(a);s[0]=i(e);for(var u=1;u<a;u++)s[u]=i(t[u]);return s.join(" ")}if(typeof e!="string")return e;var c=t.length;if(c===0)return e;for(var l="",d=1-o,h=-1,f=e&&e.length||0,p=0;p<f;){if(e.charCodeAt(p)===37&&p+1<f){switch(h=h>-1?h:0,e.charCodeAt(p+1)){case 100:case 102:if(d>=c||t[d]==null)break;h<p&&(l+=e.slice(h,p)),l+=Number(t[d]),h=p+2,p++;break;case 105:if(d>=c||t[d]==null)break;h<p&&(l+=e.slice(h,p)),l+=Math.floor(Number(t[d])),h=p+2,p++;break;case 79:case 111:case 106:if(d>=c||t[d]===void 0)break;h<p&&(l+=e.slice(h,p));var v=typeof t[d];if(v==="string"){l+="'"+t[d]+"'",h=p+2,p++;break}if(v==="function"){l+=t[d].name||"<anonymous>",h=p+2,p++;break}l+=i(t[d]),h=p+2,p++;break;case 115:if(d>=c)break;h<p&&(l+=e.slice(h,p)),l+=String(t[d]),h=p+2,p++;break;case 37:h<p&&(l+=e.slice(h,p)),l+="%",h=p+2,p++,d--;break}++d}++p}return h===-1?e:(h<f&&(l+=e.slice(h)),l)}}));var E=u(((e,t)=>{var r=M();t.exports=h;var n=x().console||{},i={mapHttpRequest:k,mapHttpResponse:k,wrapRequestSerializer:A,wrapResponseSerializer:A,wrapErrorSerializer:A,req:k,res:k,err:q,errWithCause:q};function o(e,t){return e==="silent"?1/0:t.levels.values[e]}var a=Symbol("pino.logFuncs"),s=Symbol("pino.hierarchy"),u={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function c(e,t){let r={logger:t,parent:e[s]};t[s]=r}function l(e,t,r){let i={};t.forEach((e=>{i[e]=r[e]?r[e]:n[e]||n[u[e]||"log"]||C})),e[a]=i}function d(e,t){return Array.isArray(e)?e.filter((function(e){return e!=="!stdSerializers.err"})):e===!0?Object.keys(t):!1}function h(e){e=e||{},e.browser=e.browser||{};let t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");let r=e.browser.write||n;e.browser.write&&(e.browser.asObject=!0);let i=e.serializers||{},a=d(e.browser.serialize,i),s=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);let u=Object.keys(e.customLevels||{}),h=["error","fatal","warn","info","debug","trace"].concat(u);typeof r=="function"&&h.forEach((function(e){r[e]=r})),(e.enabled===!1||e.browser.disabled)&&(e.level="silent");let p=e.level||"info",v=Object.create(r);v.log||(v.log=C),l(v,h,r),c({},v),Object.defineProperty(v,"levelVal",{get:m}),Object.defineProperty(v,"level",{get:w,set:S});let g={transmit:t,serialize:a,asObject:e.browser.asObject,formatters:e.browser.formatters,levels:h,timestamp:O(e)};v.levels=f(e),v.level=p,v.setMaxListeners=v.getMaxListeners=v.emit=v.addListener=v.on=v.prependListener=v.once=v.prependOnceListener=v.removeListener=v.removeAllListeners=v.listeners=v.listenerCount=v.eventNames=v.write=v.flush=C,v.serializers=i,v._serialize=a,v._stdErrSerialize=s,v.child=q,t&&(v._logEvent=I());function m(){return o(this.level,this)}function w(){return this._level}function S(e){if(e!=="silent"&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,y(this,g,v,"error"),y(this,g,v,"fatal"),y(this,g,v,"warn"),y(this,g,v,"info"),y(this,g,v,"debug"),y(this,g,v,"trace"),u.forEach((e=>{y(this,g,v,e)}))}function q(r,n){if(!r)throw new Error("missing bindings for child Pino");n=n||{},a&&r.serializers&&(n.serializers=r.serializers);let o=n.serializers;if(a&&o){var s=Object.assign({},i,o),u=e.browser.serialize===!0?Object.keys(s):a;delete r.serializers,b([r],u,s,this._stdErrSerialize)}function l(e){this._childLevel=(e._childLevel|0)+1,this.bindings=r,s&&(this.serializers=s,this._serialize=u),t&&(this._logEvent=I([].concat(e._logEvent.bindings,r)))}l.prototype=this;let d=new l(this);return c(this,d),d.level=this.level,d}return v}function f(e){let t=e.customLevels||{},r=Object.assign({},h.levels.values,t),n=Object.assign({},h.levels.labels,p(t));return{values:r,labels:n}}function p(e){let t={};return Object.keys(e).forEach((function(r){t[e[r]]=r})),t}h.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};h.stdSerializers=i;h.stdTimeFunctions=Object.assign({},{nullTime:j,epochTime:R,unixTime:D,isoTime:E});function v(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[s];for(;r.parent;)r=r.parent,r.logger.bindings&&t.push(r.logger.bindings);return t.reverse()}function y(e,t,r,n){if(Object.defineProperty(e,n,{value:o(e.level,r)>o(n,r)?C:r[a][n],writable:!0,enumerable:!0,configurable:!0}),!t.transmit&&e[n]===C)return;e[n]=m(e,t,r,n);let i=v(e);i.length!==0&&(e[n]=g(i,e[n]))}function g(e,t){return function(){return t.apply(this,[...e,...arguments])}}function m(e,t,r,i){return function(a){return function(){let s=t.timestamp(),u=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===n?n:this;for(var l=0;l<u.length;l++)u[l]=arguments[l];if(t.serialize&&!t.asObject&&b(u,this._serialize,this.serializers,this._stdErrSerialize),t.asObject||t.formatters?a.call(c,w(this,i,u,s,t.formatters)):a.apply(c,u),t.transmit){let n=t.transmit.level||e._level,a=r.levels.values[n],c=r.levels.values[i];if(c<a)return;S(this,{ts:s,methodLevel:i,methodValue:c,transmitLevel:n,transmitValue:r.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:o(e._level,r)},u)}}}(e[a][i])}function w(e,t,n,i,o={}){let{level:a=(()=>e.levels.values[t]),log:s=(e=>e)}=o;e._serialize&&b(n,e._serialize,e.serializers,e._stdErrSerialize);let u=n.slice(),c=u[0],l={};i&&(l.time=i),l.level=a(t,e.levels.values[t]);let d=(e._childLevel|0)+1;if(d<1&&(d=1),c!==null&&typeof c=="object"){for(;d--&&typeof u[0]=="object";)Object.assign(l,u.shift());c=u.length?r(u.shift(),u):void 0}else typeof c=="string"&&(c=r(u.shift(),u));return c!==void 0&&(l.msg=c),s(l)}function b(e,t,r,n){for(let i in e)if(n&&e[i]instanceof Error)e[i]=h.stdSerializers.err(e[i]);else if(typeof e[i]=="object"&&!Array.isArray(e[i]))for(let n in e[i])t&&t.indexOf(n)>-1&&n in r&&(e[i][n]=r[n](e[i][n]))}function S(e,t,r){let n=t.send,i=t.ts,o=t.methodLevel,a=t.methodValue,s=t.val,u=e._logEvent.bindings;b(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter((function(e){return u.indexOf(e)===-1})),e._logEvent.level.label=o,e._logEvent.level.value=a,n(o,e._logEvent,s),e._logEvent=I(u)}function I(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function q(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)t[r]===void 0&&(t[r]=e[r]);return t}function O(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?j:R}function k(){return{}}function A(e){return e}function C(){}function j(){return!1}function R(){return Date.now()}function D(){return Math.round(Date.now()/1e3)}function E(){return new Date(Date.now()).toISOString()}function x(){function e(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}t.exports.default=h;t.exports.pino=h}));var x=u(((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_customParseFormat=n()})(e,(function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,n=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,o={},a=function(e){return(e=+e)+(e>68?1900:2e3)},s=function(e){return function(t){this[e]=+t}},u=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e||e==="Z")return 0;var t=e.match(/([+-]|\d\d)/g),r=60*t[1]+(+t[2]||0);return r===0?0:t[0]==="+"?-r:r}(e)}],c=function(e){var t=o[e];return t&&(t.indexOf?t:t.s.concat(t.f))},l=function(e,t){var r,n=o.meridiem;if(n){for(var i=1;i<=24;i+=1)if(e.indexOf(n(i,0,t))>-1){r=i>12;break}}else r=e===(t?"pm":"PM");return r},d={A:[i,function(e){this.afternoon=l(e,!1)}],a:[i,function(e){this.afternoon=l(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[r,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[n,s("seconds")],ss:[n,s("seconds")],m:[n,s("minutes")],mm:[n,s("minutes")],H:[n,s("hours")],h:[n,s("hours")],HH:[n,s("hours")],hh:[n,s("hours")],D:[n,s("day")],DD:[r,s("day")],Do:[i,function(e){var t=o.ordinal,r=e.match(/\d+/);if(this.day=r[0],t)for(var n=1;n<=31;n+=1)t(n).replace(/\[|\]/g,"")===e&&(this.day=n)}],M:[n,s("month")],MM:[r,s("month")],MMM:[i,function(e){var t=c("months"),r=(c("monthsShort")||t.map((function(e){return e.slice(0,3)}))).indexOf(e)+1;if(r<1)throw new Error;this.month=r%12||r}],MMMM:[i,function(e){var t=c("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,s("year")],YY:[r,function(e){this.year=a(e)}],YYYY:[/\d{4}/,s("year")],Z:u,ZZ:u};function h(r){var n,i;n=r,i=o&&o.formats;for(var a=(r=n.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,r,n){var o=n&&n.toUpperCase();return r||i[n]||e[n]||i[o].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,r){return t||r.slice(1)}))}))).match(t),s=a.length,u=0;u<s;u+=1){var c=a[u],l=d[c],h=l&&l[0],f=l&&l[1];a[u]=f?{regex:h,parser:f}:c.replace(/^\[|\]$/g,"")}return function(e){for(var t={},r=0,n=0;r<s;r+=1){var i=a[r];if(typeof i=="string")n+=i.length;else{var o=i.regex,u=i.parser,c=e.slice(n),l=o.exec(c)[0];u.call(t,l),e=e.replace(l,"")}}return function(e){var t=e.afternoon;if(t!==void 0){var r=e.hours;t?r<12&&(e.hours+=12):r===12&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,r){r.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(a=e.parseTwoDigitYear);var n=t.prototype,i=n.parse;n.parse=function(e){var t=e.date,n=e.utc,a=e.args;this.$u=n;var s=a[1];if(typeof s=="string"){var u=a[2]===!0,c=a[3]===!0,l=u||c,d=a[2];c&&(d=a[2]),o=this.$locale(),!u&&d&&(o=r.Ls[d]),this.$d=function(e,t,r){try{if(["x","X"].indexOf(t)>-1)return new Date((t==="X"?1e3:1)*e);var n=h(t)(e),i=n.year,o=n.month,a=n.day,s=n.hours,u=n.minutes,c=n.seconds,l=n.milliseconds,d=n.zone,f=new Date,p=a||(i||o?1:f.getDate()),v=i||f.getFullYear(),y=0;i&&!o||(y=o>0?o-1:f.getMonth());var g=s||0,m=u||0,w=c||0,b=l||0;return d?new Date(Date.UTC(v,y,p,g,m,w,b+60*d.offset*1e3)):r?new Date(Date.UTC(v,y,p,g,m,w,b)):new Date(v,y,p,g,m,w,b)}catch{return new Date("")}}(t,s,n),this.init(),d&&d!==!0&&(this.$L=this.locale(d).$L),l&&t!=this.format(s)&&(this.$d=new Date("")),o={}}else if(s instanceof Array)for(var f=s.length,p=1;p<=f;p+=1){a[1]=s[p-1];var v=r.apply(this,a);if(v.isValid()){this.$d=v.$d,this.$L=v.$L,this.init();break}p===f&&(this.$d=new Date(""))}else i.call(this,e)}}}))}));var T=u(((e,t)=>{(function(r,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_quarterOfYear=n()})(e,(function(){var e="month",t="quarter";return function(r,n){var i=n.prototype;i.quarter=function(e){return this.$utils().u(e)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(e-1))};var o=i.add;i.add=function(r,n){return r=Number(r),this.$utils().p(n)===t?this.add(3*r,e):o.bind(this)(r,n)};var a=i.startOf;i.startOf=function(r,n){var i=this.$utils(),o=!!i.u(n)||n;if(i.p(r)===t){var s=this.quarter()-1;return o?this.month(3*s).startOf(e).startOf("day"):this.month(3*s+2).endOf(e).endOf("day")}return a.bind(this)(r,n)}}}))}));var U=()=>global.crypto,F=()=>{typeof window<"u"||(U()||(global.crypto=s("crypto")),!U().getRandomValues&&U().webcrypto&&(global.crypto.getRandomValues=U().webcrypto.getRandomValues.bind(U().webcrypto)))};var $={};c($,{escape:()=>pe,getHighlightedSuggestion:()=>he,highlightString:()=>de});function P(e,t){let r=`\n  The following properties are invalid:\n\n    ${e.join(`\n\t`)}\n  \n  ${t}\n  `;return new _(r)}var _=class extends Error{constructor(e){super(e),this.name="SchemaValidationError"}},V=class{constructor(e){this.definition=e}validate(e={},t=""){let r={...this.default,...e},n=[];for(let e in this.definition){let t=this.definition[e].validate(r[e]);t&&n.push(`${e}: ${t}`)}if(n.length)throw P(n,t);return r}get default(){let e={};for(let t in this.definition){let r=this.definition[t].default;r!==void 0&&(e[t]=r)}return e}},Q=class{constructor(e={}){this.baseConfig=e}validate(e){return this.baseConfig.required&&Y(e)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return this.baseConfig.required===!0}};function L(e){return e===void 0}function N(e){return e===null}function Y(e){return L(e)||N(e)}var z=class{constructor(e={}){this.config=e,this.value=new Q(e)}validate(e){let t=this.value.validate(e);return t||(H(e)?e<this.config.min?`minimum value of ${this.config.min} not respected.`:e>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}};function H(e){return L(e)||B(e)}function B(e){return typeof e=="number"&&!isNaN(e)}var W=class{constructor(e={}){this.value=new Q(e)}validate(e){let t=this.value.validate(e);return t||(G(e)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}};function G(e){return L(e)||J(e)}function J(e){return typeof e=="boolean"}var Z=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i,K=class{constructor(e={}){this.config={emptyAllowed:!0,url:!1,...e},this.value=new Q(this.config)}validate(e){let{emptyAllowed:t,url:r,regex:n,constrainTo:i}=this.config,o=this.value.validate(e);return o||(L(e)?null:X(e)?!t&&!e.length?"value is an empty string.":r&&!Z.test(e)?"value is not a valid URL.":n&&!n.test(e)?`value did not match provided regex ${n}`:i&&!i.includes(e)?`value should be one of: ${i.join(", ")}.`:null:"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}};function X(e){return Object.prototype.toString.call(e)==="[object String]"}var ee=class{constructor(e={}){this.config={options:{required:!1},values:{},...e}}validate(e){if(L(e))return this.config.options.required?"value is required and is currently undefined":null;if(!te(e))return"value is not an object";for(let[t,r]of Object.entries(this.config.values))if(r.required&&Y(e[t]))return`value does not contain ${t}`;let t="";for(let[r,n]of Object.entries(this.config.values)){let i=e[r],o=n.validate(i);o!==null&&(t+=" "+o)}return t===""?null:t}get default(){}get required(){return!!this.config.options.required}};function te(e){return e!==void 0&&typeof e=="object"}var re=class{constructor(e={}){this.config=e,this.value=new Q(this.config)}validate(e){if(!Y(e)&&!Array.isArray(e))return"value is not an array";let t=this.value.validate(e);if(t!==null)return t;if(Y(e))return null;if(this.config.max!==void 0&&e.length>this.config.max)return`value contains more than ${this.config.max}`;if(this.config.min!==void 0&&e.length<this.config.min)return`value contains less than ${this.config.min}`;if(this.config.each!==void 0){let t="";return e.forEach((r=>{this.config.each.required&&Y(r)&&(t=`value is null or undefined: ${e.join(",")}`);let n=this.validatePrimitiveValue(r,this.config.each);n!==null&&(t+=" "+n)})),t===""?null:t}return null}validatePrimitiveValue(e,t){return J(e)||X(e)||B(e)||te(e)?t.validate(e):"value is not a primitive value"}get default(){}get required(){return this.value.required}};function ne(e){return Array.isArray(e)}var ie=class{constructor(e){this.config=e,this.value=new Q(e)}validate(e){let t=this.value.validate(e);return t!==null?t:L(e)||Object.values(this.config.enum).find((t=>t===e))?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}};d(v());function oe(e){return e.trim()===""}function ae(e,t){return[...e.reduce(((e,r)=>{let n=t(r);return e.has(n)||e.set(n,r),e}),new Map).values()]}var se=new Set(["1",1,"yes",!0]);function ue(){if(typeof navigator>"u"||typeof window>"u")return!1;let e=navigator,t=window;return[e.globalPrivacyControl,e.doNotTrack,e.msDoNotTrack,t.doNotTrack].some((e=>se.has(e)))}function ce(e){let t={};for(let[r,n]of e)t[r]=n;return t}function le(e){if(typeof e!="object"||!e)return e;try{return JSON.parse(JSON.stringify(e))}catch{return e}}function de(e){if(oe(e.openingDelimiter)||oe(e.closingDelimiter))throw Error("delimiters should be a non-empty string");if(Y(e.content)||oe(e.content))return e.content;if(e.highlights.length===0)return pe(e.content);let t=e.content.length,r="",n=0;for(let i=0;i<e.highlights.length;i++){let o=e.highlights[i],a=o.offset,s=a+o.length;if(s>t)break;r+=pe(e.content.slice(n,a)),r+=e.openingDelimiter,r+=pe(e.content.slice(a,s)),r+=e.closingDelimiter,n=s}return n!==t&&(r+=pe(e.content.slice(n))),r}function he(e,t){return e=pe(e),e.replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,((e,r,n,i)=>r?fe(r,t.notMatchDelimiters):n?fe(n,t.exactMatchDelimiters):i?fe(i,t.correctionDelimiters):e))}function fe(e,t){return t?t.open+e+t.close:e}function pe(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r="(?:"+Object.keys(t).join("|")+")",n=RegExp(r),i=RegExp(r,"g");return n.test(e)?e.replace(i,(e=>t[e])):e}var ve=e=>e;function ye(){return{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}}function ge(){return{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:ye(),pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],searchResponseId:"",requestId:"",questionAnswer:ye(),extendedResults:{}}}function me(e){let{url:t,accessToken:r,organizationId:n,authentication:i,...o}=e;return o}var we=e=>{let{response:t}=e;return t.body?be(e):Se(t)},be=e=>qe(e)?Oe(e):Ie(e)?e.body:{message:"unknown",statusCode:0,type:"unknown"},Se=e=>{let t=JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)));return{...t,message:`Client side error: ${t.message||""}`,statusCode:400,type:"ClientError"}};function Ie(e){return e.body.statusCode!==void 0}function qe(e){return e.body.exception!==void 0}var Oe=e=>({message:e.body.exception.code,statusCode:e.response.status,type:e.body.exception.code});var ke=d(y()),Ae=d(k());var Ce=class extends Error{constructor(){super(),this.name="ExpiredToken",this.message="The token being used to perform the request is expired."}},je=class extends Error{constructor(e,t){super(),this.name="Disconnected",this.message=`Client could not connect to the following URL: ${e}`,this.statusCode=t??0}};function Re(e){let t=[];for(let r in e){let n=encodeURIComponent(r),i=encodeURIComponent(e[r]);t.push(`${n}=${i}`)}return t.join("&")}function De(e){return typeof e!="object"||!e?!1:Object.values(e).every(Me)}function Me(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function Ee(e){return e===429}var xe=class e{static async call(t){let r=Pe(t),{logger:n}=t,i=await e.preprocessRequest(r,t);n.info(i,"Platform request");let{url:o,...a}=i,s=async()=>{let e=await(0,ke.default)(o,a);if(Ee(e.status))throw e;return e};try{let e=await(0,Ae.backOff)(s,{retry:e=>{let t=e&&Ee(e.status);return t&&n.info("Platform retrying request"),t}});if(e.status===419)throw n.info("Platform renewing token"),new Ce;if(e.status===404)throw new je(o,e.status);return n.info({response:e,requestInfo:i},"Platform response"),e}catch(e){return e.message==="Failed to fetch"?new je(o):e}}static async preprocessRequest(e,t){let{origin:r,preprocessRequest:n,logger:i,requestMetadata:o}=t,{signal:a,...s}=e,u=le(s);try{let t=await n(e,r,o);return{...e,...t}}catch(e){i.error(e,"Platform request preprocessing failed. Returning default request options.")}return u}};function Te(e,t){let r=!t||!t.environment||t.environment==="prod"?"":t.environment,n=!t||!t.region||t.region==="us"?"":`-${t.region}`;return`https://${e}${r}${n}.cloud.coveo.com`}function Ue(e,t="prod"){let r=t==="prod"?"":t,n=`https://${e}.org${r}.coveo.com`,i=`https://${e}.analytics.org${r}.coveo.com`,o=`${n}/rest/search/v2`,a=`https://${e}.admin.org${r}.coveo.com`;return{platform:n,analytics:i,search:o,admin:a}}function Fe(e){return e?.multiRegionSubDomain?`https://${e.multiRegionSubDomain}.org.coveo.com`:Te("platform",e)}function $e(e){return Te("analytics",e)}function Pe(e){let{url:t,method:r,requestParams:n,contentType:i,accessToken:o,signal:a}=e,s=e.method==="POST"||e.method==="PUT",u=_e(n,i);return{url:t,method:r,headers:{"Content-Type":i,Authorization:`Bearer ${o}`,...e.headers},...s&&{body:u},signal:a}}function _e(e,t){return t==="application/x-www-form-urlencoded"?De(e)?Re(e):"":JSON.stringify(e)}function Ve(){if(typeof window>"u"){let{AbortController:e}=A();return new e}return typeof AbortController>"u"?null:new AbortController}var Qe=class{constructor(){this.currentAbortController=null}async enqueue(e,t){let r=this.currentAbortController,n=this.currentAbortController=Ve();r&&(t.warnOnAbort&&t.logger.warn("Cancelling current pending search query"),r.abort());try{return await e(n?.signal??null)}finally{this.currentAbortController===n&&(this.currentAbortController=null)}}};var Le=class{constructor(e){this._params={};this._basePath=e}addParam(e,t){this._params={...this.params,[e]:t}}get basePath(){return this._basePath}get params(){return this._params}get hasParams(){return Object.entries(this._params).length}get href(){return this.hasParams?`${this.basePath}?${Object.entries(this.params).map((([e,t])=>`${e}=${encodeURIComponent(t)}`)).join("&")}`:this.basePath}},Ne=e=>/^https:\/\/platform(dev|stg|hipaa)?(-)?(eu|au)?\.cloud\.coveo\.com/.test(e),Ye=(e,t)=>{let r=ze(e);return r&&r.organizationId===t?r:null},ze=e=>{let t=e.match(/^https:\/\/(?<organizationId>\w+)\.org(?<environment>dev|stg|hipaa)?\.coveo\.com/);return t?.groups?t.groups:null};function He(e){return((e.headers.get("content-type")||"").split(";").find((e=>e.indexOf("charset=")!==-1))||"").split("=")[1]||"UTF-8"}var Be=(e,t,r,n)=>{let i=new Le(`${e.url}${n}`);return i.addParam("organizationId",e.organizationId),e.authentication&&i.addParam("authentication",e.authentication),{accessToken:e.accessToken,method:t,contentType:r,url:i.href,origin:"searchApiFetch"}};var We=async(e,t)=>{let r=await xe.call({...Be(e,"POST","application/x-www-form-urlencoded","/html"),requestParams:me(e),requestMetadata:{method:"html"},...t});if(r instanceof Error)throw r;let n=He(r),i=await r.arrayBuffer(),o=new TextDecoder(n).decode(i);return Ge(o)?{success:o}:{error:we({response:r,body:o})}};function Ge(e){return typeof e=="string"}function Je(e){return{statusCode:e.statusCode,type:e.name,message:e.message}}function Ze(e){return{statusCode:e.code,type:e.name,message:e.message,ignored:!0}}function Ke(e,t){if(t&&e.name==="AbortError")return{error:Ze(e)};if(e instanceof je)return{error:Je(e)};throw e}var Xe=class{constructor(e){this.options=e;this.apiCallsQueues={unknown:new Qe,mainSearch:new Qe,facetValues:new Qe,foldingCollection:new Qe,instantResults:new Qe}}async plan(e){let t=await xe.call({...Be(e,"POST","application/json","/plan"),requestParams:me(e),requestMetadata:{method:"plan"},...this.options});if(t instanceof Error)return Ke(t);let r=await t.json();return ot(r)?{success:r}:{error:we({response:t,body:r})}}async querySuggest(e){let t=await xe.call({...Be(e,"POST","application/json","/querySuggest"),requestMetadata:{method:"querySuggest"},requestParams:me(e),...this.options});if(t instanceof Error)return Ke(t);let r=await t.json(),n={response:t,body:r};return it(r)?{success:(await this.options.postprocessQuerySuggestResponseMiddleware(n)).body}:{error:we(n)}}async search(e,t){let r=t?.origin??"unknown",n=await this.apiCallsQueues[r].enqueue((r=>xe.call({...Be(e,"POST","application/json",""),requestParams:me(e),requestMetadata:{method:"search",origin:t?.origin},...this.options,signal:r??void 0})),{logger:this.options.logger,warnOnAbort:!t?.disableAbortWarning});if(n instanceof Error)return Ke(n,t?.disableAbortWarning);let i=await n.json(),o={response:n,body:i};return rt(i)?(o.body=nt(i),{success:(await this.options.postprocessSearchResponseMiddleware(o)).body}):{error:we(o)}}async facetSearch(e){let t=await xe.call({...Be(e,"POST","application/json","/facet"),requestParams:me(e),requestMetadata:{method:"facetSearch"},...this.options});if(t instanceof Error)throw t;let r=await t.json(),n={response:t,body:r};return(await this.options.postprocessFacetSearchResponseMiddleware(n)).body}async recommendations(e){let t=await xe.call({...Be(e,"POST","application/json",""),requestParams:me(e),requestMetadata:{method:"recommendations"},...this.options});if(t instanceof Error)throw t;let r=await t.json();return rt(r)?{success:r}:{error:we({response:t,body:r})}}async html(e){return We(e,{...this.options})}async productRecommendations(e){let t=await xe.call({...Be(e,"POST","application/json",""),requestParams:me(e),requestMetadata:{method:"productRecommendations"},...this.options});if(t instanceof Error)throw t;let r=await t.json();return rt(r)?{success:r}:{error:we({response:t,body:r})}}async fieldDescriptions(e){let t=await xe.call({...Be(e,"GET","application/json","/fields"),requestParams:{},requestMetadata:{method:"fieldDescriptions"},...this.options});if(t instanceof Error)throw t;let r=await t.json();return at(r)?{success:r}:{error:we({response:t,body:r})}}},et=e=>e.success!==void 0,tt=e=>e.error!==void 0;function rt(e){return e.results!==void 0}function nt(e){let t=ye();return Y(e.questionAnswer)?(e.questionAnswer=t,e):(e.questionAnswer={...t,...e.questionAnswer},e)}function it(e){return e.completions!==void 0}function ot(e){return e.preprocessingOutput!==void 0}function at(e){return e.fields!==void 0}var st=e=>e,ut=e=>e,ct=e=>e;function lt(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var dt=typeof Symbol=="function"&&Symbol.observable||"@@observable",ht=dt,ft=()=>Math.random().toString(36).substring(7).split("").join("."),pt={INIT:`@@redux/INIT${ft()}`,REPLACE:`@@redux/REPLACE${ft()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${ft()}`},vt=pt;function yt(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function gt(e,t,r){if(typeof e!="function")throw new Error(lt(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(lt(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(lt(1));return r(gt)(e,t)}let n=e,i=t,o=new Map,a=o,s=0,u=!1;function c(){a===o&&(a=new Map,o.forEach(((e,t)=>{a.set(t,e)})))}function l(){if(u)throw new Error(lt(3));return i}function d(e){if(typeof e!="function")throw new Error(lt(4));if(u)throw new Error(lt(5));let t=!0;c();let r=s++;return a.set(r,e),function(){if(t){if(u)throw new Error(lt(6));t=!1,c(),a.delete(r),o=null}}}function h(e){if(!yt(e))throw new Error(lt(7));if(typeof e.type>"u")throw new Error(lt(8));if(typeof e.type!="string")throw new Error(lt(17));if(u)throw new Error(lt(9));try{u=!0,i=n(i,e)}finally{u=!1}return(o=a).forEach((e=>{e()})),e}function f(e){if(typeof e!="function")throw new Error(lt(10));n=e,h({type:vt.REPLACE})}function p(){let e=d;return{subscribe(t){if(typeof t!="object"||t===null)throw new Error(lt(11));function r(){let e=t;e.next&&e.next(l())}return r(),{unsubscribe:e(r)}},[ht](){return this}}}return h({type:vt.INIT}),{dispatch:h,subscribe:d,getState:l,replaceReducer:f,[ht]:p}}function mt(e){Object.keys(e).forEach((t=>{let r=e[t];if(typeof r(void 0,{type:vt.INIT})>"u")throw new Error(lt(12));if(typeof r(void 0,{type:vt.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(lt(13))}))}function wt(e){let t=Object.keys(e),r={};for(let n=0;n<t.length;n++){let i=t[n];typeof e[i]=="function"&&(r[i]=e[i])}let n=Object.keys(r),i;try{mt(r)}catch(e){i=e}return function(e={},t){if(i)throw i;let o=!1,a={};for(let i=0;i<n.length;i++){let s=n[i],u=r[s],c=e[s],l=u(c,t);if(typeof l>"u"){throw new Error(lt(14))}a[s]=l,o=o||l!==c}return o=o||n.length!==Object.keys(e).length,o?a:e}}function bt(...e){return e.length===0?e=>e:e.length===1?e[0]:e.reduce(((e,t)=>(...r)=>e(t(...r))))}function St(...e){return t=>(r,n)=>{let i=t(r,n),o=()=>{throw new Error(lt(15))},a={getState:i.getState,dispatch:(e,...t)=>o(e,...t)},s=e.map((e=>e(a)));return o=bt(...s)(i.dispatch),{...i,dispatch:o}}}function It(e){return yt(e)&&"type"in e&&typeof e.type=="string"}var qt=Symbol.for("immer-nothing"),Ot=Symbol.for("immer-draftable"),kt=Symbol.for("immer-state");function At(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Ct=Object.getPrototypeOf;function jt(e){return!!e&&!!e[kt]}function Rt(e){return e?Mt(e)||Array.isArray(e)||!!e[Ot]||!!e.constructor?.[Ot]||$t(e)||Pt(e):!1}var Dt=Object.prototype.constructor.toString();function Mt(e){if(!e||typeof e!="object")return!1;let t=Ct(e);if(t===null)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Dt}function Et(e,t){xt(e)===0?Object.entries(e).forEach((([r,n])=>{t(r,n,e)})):e.forEach(((r,n)=>t(n,r,e)))}function xt(e){let t=e[kt];return t?t.type_:Array.isArray(e)?1:$t(e)?2:Pt(e)?3:0}function Tt(e,t){return xt(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Ut(e,t,r){let n=xt(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Ft(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function $t(e){return e instanceof Map}function Pt(e){return e instanceof Set}function _t(e){return e.copy_||e.base_}function Vt(e,t){if($t(e))return new Map(e);if(Pt(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&Mt(e))return Ct(e)?{...e}:Object.assign(Object.create(null),e);let r=Object.getOwnPropertyDescriptors(e);delete r[kt];let n=Reflect.ownKeys(r);for(let t=0;t<n.length;t++){let i=n[t],o=r[i];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Ct(e),r)}function Qt(e,t=!1){return Nt(e)||jt(e)||!Rt(e)||(xt(e)>1&&(e.set=e.add=e.clear=e.delete=Lt),Object.freeze(e),t&&Et(e,((e,t)=>Qt(t,!0)))),e}function Lt(){At(2)}function Nt(e){return Object.isFrozen(e)}var Yt={};function zt(e){let t=Yt[e];return t||At(0,e),t}var Ht;function Bt(){return Ht}function Wt(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Gt(e,t){t&&(zt("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Jt(e){Zt(e),e.drafts_.forEach(Xt),e.drafts_=null}function Zt(e){e===Ht&&(Ht=e.parent_)}function Kt(e){return Ht=Wt(Ht,e)}function Xt(e){let t=e[kt];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function er(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[kt].modified_&&(Jt(t),At(4)),Rt(e)&&(e=tr(t,e),t.parent_||nr(t,e)),t.patches_&&zt("Patches").generateReplacementPatches_(r[kt].base_,e,t.patches_,t.inversePatches_)):e=tr(t,r,[]),Jt(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==qt?e:void 0}function tr(e,t,r){if(Nt(t))return t;let n=t[kt];if(!n)return Et(t,((i,o)=>rr(e,n,t,i,o,r))),t;if(n.scope_!==e)return t;if(!n.modified_)return nr(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let t=n.copy_,i=t,o=!1;n.type_===3&&(i=new Set(t),t.clear(),o=!0),Et(i,((i,a)=>rr(e,n,t,i,a,r,o))),nr(e,t,!1),r&&e.patches_&&zt("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function rr(e,t,r,n,i,o,a){if(jt(i)){let a=o&&t&&t.type_!==3&&!Tt(t.assigned_,n)?o.concat(n):void 0,s=tr(e,i,a);if(Ut(r,n,s),jt(s))e.canAutoFreeze_=!1;else return}else a&&r.add(i);if(Rt(i)&&!Nt(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;tr(e,i),(!t||!t.scope_.parent_)&&nr(e,i)}}function nr(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Qt(t,r)}function ir(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Bt(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},i=n,o=or;r&&(i=[n],o=ar);let{revoke:a,proxy:s}=Proxy.revocable(i,o);return n.draft_=s,n.revoke_=a,s}var or={get(e,t){if(t===kt)return e;let r=_t(e);if(!Tt(r,t))return ur(e,r,t);let n=r[t];return e.finalized_||!Rt(n)?n:n===sr(e.base_,t)?(dr(e),e.copy_[t]=fr(n,e)):n},has(e,t){return t in _t(e)},ownKeys(e){return Reflect.ownKeys(_t(e))},set(e,t,r){let n=cr(_t(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let n=sr(_t(e),t),i=n?.[kt];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Ft(r,n)&&(r!==void 0||Tt(e.base_,t)))return!0;dr(e),lr(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return sr(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,dr(e),lr(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=_t(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){At(11)},getPrototypeOf(e){return Ct(e.base_)},setPrototypeOf(){At(12)}},ar={};Et(or,((e,t)=>{ar[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}));ar.deleteProperty=function(e,t){return ar.set.call(this,e,t,void 0)};ar.set=function(e,t,r){return or.set.call(this,e[0],t,r,e[0])};function sr(e,t){let r=e[kt];return(r?_t(r):e)[t]}function ur(e,t,r){let n=cr(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function cr(e,t){if(!(t in e))return;let r=Ct(e);for(;r;){let e=Object.getOwnPropertyDescriptor(r,t);if(e)return e;r=Ct(r)}}function lr(e){e.modified_||(e.modified_=!0,e.parent_&&lr(e.parent_))}function dr(e){e.copy_||(e.copy_=Vt(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var hr=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){let r=t;t=e;let n=this;return function(e=r,...i){return n.produce(e,(e=>t.call(this,e,...i)))}}typeof t!="function"&&At(6),r!==void 0&&typeof r!="function"&&At(7);let n;if(Rt(e)){let i=Kt(this),o=fr(e,void 0),a=!0;try{n=t(o),a=!1}finally{a?Jt(i):Zt(i)}return Gt(i,r),er(n,i)}else if(!e||typeof e!="object"){if(n=t(e),n===void 0&&(n=e),n===qt&&(n=void 0),this.autoFreeze_&&Qt(n,!0),r){let t=[],i=[];zt("Patches").generateReplacementPatches_(e,n,t,i),r(t,i)}return n}else At(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(t,...r)=>this.produceWithPatches(t,(t=>e(t,...r)));let r,n;return[this.produce(e,t,((e,t)=>{r=e,n=t})),r,n]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Rt(e)||At(8),jt(e)&&(e=pr(e));let t=Kt(this),r=fr(e,void 0);return r[kt].isManual_=!0,Zt(t),r}finishDraft(e,t){let r=e&&e[kt];(!r||!r.isManual_)&&At(9);let{scope_:n}=r;return Gt(n,t),er(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let n=t[r];if(n.path.length===0&&n.op==="replace"){e=n.value;break}}r>-1&&(t=t.slice(r+1));let n=zt("Patches").applyPatches_;return jt(e)?n(e,t):this.produce(e,(e=>n(e,t)))}};function fr(e,t){let r=$t(e)?zt("MapSet").proxyMap_(e,t):Pt(e)?zt("MapSet").proxySet_(e,t):ir(e,t);return(t?t.scope_:Bt()).drafts_.push(r),r}function pr(e){return jt(e)||At(10,e),vr(e)}function vr(e){if(!Rt(e)||Nt(e))return e;let t=e[kt],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Vt(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Vt(e,!0);return Et(r,((e,t)=>{Ut(r,e,vr(t))})),t&&(t.finalized_=!1),r}var yr=new hr,gr=yr.produce;yr.produceWithPatches.bind(yr);yr.setAutoFreeze.bind(yr);yr.setUseStrictShallowCopy.bind(yr);yr.applyPatches.bind(yr);yr.createDraft.bind(yr);yr.finishDraft.bind(yr);function mr(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function wr(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function br(e,t="expected all items to be functions, instead received the following types: "){if(!e.every((e=>typeof e=="function"))){let r=e.map((e=>typeof e=="function"?`function ${e.name||"unnamed"}()`:typeof e)).join(", ");throw new TypeError(`${t}[${r}]`)}}var Sr=e=>Array.isArray(e)?e:[e];function Ir(e){let t=Array.isArray(e[0])?e[0]:e;return br(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function qr(e,t){let r=[],{length:n}=e;for(let i=0;i<n;i++)r.push(e[i].apply(null,t));return r}var Or=class{constructor(e){this.value=e}deref(){return this.value}},kr=typeof WeakRef<"u"?WeakRef:Or,Ar=0,Cr=1;function jr(){return{s:Ar,v:void 0,o:null,p:null}}function Rr(e,t={}){let r=jr(),{resultEqualityCheck:n}=t,i,o=0;function a(){let t=r,{length:a}=arguments;for(let e=0,r=a;e<r;e++){let r=arguments[e];if(typeof r=="function"||typeof r=="object"&&r!==null){let e=t.o;e===null&&(t.o=e=new WeakMap);let n=e.get(r);n===void 0?(t=jr(),e.set(r,t)):t=n}else{let e=t.p;e===null&&(t.p=e=new Map);let n=e.get(r);n===void 0?(t=jr(),e.set(r,t)):t=n}}let s=t,u;if(t.s===Cr?u=t.v:(u=e.apply(null,arguments),o++),s.s=Cr,n){let e=i?.deref?.()??i;e!=null&&n(e,u)&&(u=e,o!==0&&o--),i=typeof u=="object"&&u!==null||typeof u=="function"?new kr(u):u}return s.v=u,u}return a.clearCache=()=>{r=jr(),a.resetResultsCount()},a.resultsCount=()=>o,a.resetResultsCount=()=>{o=0},a}function Dr(e,...t){let r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...e)=>{let t=0,n=0,i,o={},a=e.pop();typeof a=="object"&&(o=a,a=e.pop()),mr(a,`createSelector expects an output function after the inputs, but received: [${typeof a}]`);let s={...r,...o},{memoize:u,memoizeOptions:c=[],argsMemoize:l=Rr,argsMemoizeOptions:d=[],devModeChecks:h={}}=s,f=Sr(c),p=Sr(d),v=Ir(e),y=u((function(){return t++,a.apply(null,arguments)}),...f),g=l((function(){n++;let e=qr(v,arguments);return i=y.apply(null,e),i}),...p);return Object.assign(g,{resultFunc:a,memoizedResultFunc:y,dependencies:v,dependencyRecomputations:()=>n,resetDependencyRecomputations:()=>{n=0},lastResult:()=>i,recomputations:()=>t,resetRecomputations:()=>{t=0},memoize:u,argsMemoize:l})};return Object.assign(n,{withTypes:()=>n}),n}var Mr=Dr(Rr),Er=Object.assign(((e,t=Mr)=>{wr(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e),n=r.map((t=>e[t]));return t(n,((...e)=>e.reduce(((e,t,n)=>(e[r[n]]=t,e)),{})))}),{withTypes:()=>Er});function xr(e){return({dispatch:t,getState:r})=>n=>i=>typeof i=="function"?i(t,r,e):n(i)}var Tr=xr(),Ur=xr;var Fr=(...e)=>{let t=Dr(...e),r=Object.assign(((...e)=>{let r=t(...e),n=(e,...t)=>r(jt(e)?pr(e):e,...t);return Object.assign(n,r),n}),{withTypes:()=>r});return r};Fr(Rr);var $r=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?bt:bt.apply(null,arguments)},Pr=e=>e&&typeof e.match=="function";function _r(e,t){function r(...r){if(t){let n=t(...r);if(!n)throw new Error(mn(0));return{type:e,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:e,payload:r[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=t=>It(t)&&t.type===e,r}var Vr=class e extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(...e){return super.concat.apply(this,e)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new e(...t[0].concat(this)):new e(...t.concat(this))}};function Qr(e){return Rt(e)?gr(e,(()=>{})):e}function Lr(e){return typeof e=="boolean"}var Nr=()=>function(e){let{thunk:t=!0,immutableCheck:r=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=e??{},o=new Vr;return t&&(Lr(t)?o.push(Tr):o.push(Ur(t.extraArgument))),o},Yr="RTK_autoBatch";var zr=e=>t=>{setTimeout(t,e)},Hr=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:zr(10),Br=(e={type:"raf"})=>t=>(...r)=>{let n=t(...r),i=!0,o=!1,a=!1,s=new Set,u=e.type==="tick"?queueMicrotask:e.type==="raf"?Hr:e.type==="callback"?e.queueNotification:zr(e.timeout),c=()=>{a=!1,o&&(o=!1,s.forEach((e=>e())))};return Object.assign({},n,{subscribe(e){let t=()=>i&&e(),r=n.subscribe(t);return s.add(e),()=>{r(),s.delete(e)}},dispatch(e){try{return i=!e?.meta?.[Yr],o=!i,o&&(a||(a=!0,u(c))),n.dispatch(e)}finally{i=!0}}})},Wr=e=>function(t){let{autoBatch:r=!0}=t??{},n=new Vr(e);return r&&n.push(Br(typeof r=="object"?r:void 0)),n},Gr=!0;function Jr(e){let t=Nr(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:o=void 0,enhancers:a=void 0}=e||{},s;if(typeof r=="function")s=r;else if(yt(r))s=wt(r);else throw new Error(mn(1));let u;if(typeof n=="function"){if(u=n(t),!Gr);}else u=t();let c=bt;i&&(c=$r({trace:!Gr,...typeof i=="object"&&i}));let l=St(...u),d=Wr(l);let h=typeof a=="function"?a(d):d();let f=c(...h);return gt(s,o,f)}function Zr(e){let t={},r=[],n,i={addCase(e,r){let n=typeof e=="string"?e:e.type;if(!n)throw new Error(mn(28));if(n in t)throw new Error(mn(29));return t[n]=r,i},addMatcher(e,t){return r.push({matcher:e,reducer:t}),i},addDefaultCase(e){return n=e,i}};return e(i),[t,r,n]}function Kr(e){return typeof e=="function"}function Xr(e,t){let[r,n,i]=Zr(t),o;if(Kr(e))o=()=>Qr(e());else{let t=Qr(e);o=()=>t}function a(e=o(),t){let a=[r[t.type],...n.filter((({matcher:e})=>e(t))).map((({reducer:e})=>e))];return a.filter((e=>!!e)).length===0&&(a=[i]),a.reduce(((e,r)=>{if(r)if(jt(e)){let n=r(e,t);return n===void 0?e:n}else{if(Rt(e))return gr(e,(e=>r(e,t)));{let n=r(e,t);if(n===void 0){if(e===null)return e;throw new Error(mn(9))}return n}}return e}),e)}return a.getInitialState=o,a}var en="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",tn=(e=21)=>{let t="",r=e;for(;r--;)t+=en[Math.random()*64|0];return t},rn=(e,t)=>Pr(e)?e.match(t):e(t);function nn(...e){return t=>e.some((e=>rn(e,t)))}var on=["name","message","stack","code"],an=class{constructor(e,t){h(this,"_type");this.payload=e,this.meta=t}},sn=class{constructor(e,t){h(this,"_type");this.payload=e,this.meta=t}},un=e=>{if(typeof e=="object"&&e!==null){let t={};for(let r of on)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},cn=(()=>{function e(e,t,r){let n=_r(e+"/fulfilled",((e,t,r,n)=>({payload:e,meta:{...n||{},arg:r,requestId:t,requestStatus:"fulfilled"}}))),i=_r(e+"/pending",((e,t,r)=>({payload:void 0,meta:{...r||{},arg:t,requestId:e,requestStatus:"pending"}}))),o=_r(e+"/rejected",((e,t,n,i,o)=>({payload:i,error:(r&&r.serializeError||un)(e||"Rejected"),meta:{...o||{},arg:n,requestId:t,rejectedWithValue:!!i,requestStatus:"rejected",aborted:e?.name==="AbortError",condition:e?.name==="ConditionError"}})));function a(e){return(a,s,u)=>{let c=r?.idGenerator?r.idGenerator(e):tn(),l=new AbortController,d,h;function f(e){h=e,l.abort()}let p=async function(){let p;try{let o=r?.condition?.(e,{getState:s,extra:u});if(dn(o)&&(o=await o),o===!1||l.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};let v=new Promise(((e,t)=>{d=()=>{t({name:"AbortError",message:h||"Aborted"})},l.signal.addEventListener("abort",d)}));a(i(c,e,r?.getPendingMeta?.({requestId:c,arg:e},{getState:s,extra:u}))),p=await Promise.race([v,Promise.resolve(t(e,{dispatch:a,getState:s,extra:u,requestId:c,signal:l.signal,abort:f,rejectWithValue:(e,t)=>new an(e,t),fulfillWithValue:(e,t)=>new sn(e,t)})).then((t=>{if(t instanceof an)throw t;return t instanceof sn?n(t.payload,c,e,t.meta):n(t,c,e)}))])}catch(t){p=t instanceof an?o(null,c,e,t.payload,t.meta):o(t,c,e)}finally{d&&l.signal.removeEventListener("abort",d)}return r&&!r.dispatchConditionRejection&&o.match(p)&&p.meta.condition||a(p),p}();return Object.assign(p,{abort:f,requestId:c,arg:e,unwrap(){return p.then(ln)}})}}return Object.assign(a,{pending:i,rejected:o,fulfilled:n,settled:nn(o,n),typePrefix:e})}return e.withTypes=()=>e,e})();function ln(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function dn(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var hn=(e,t)=>{if(typeof e!="function")throw new Error(mn(32))};var fn="listenerMiddleware";var pn=e=>{let{type:t,actionCreator:r,matcher:n,predicate:i,effect:o}=e;if(t)i=_r(t).match;else if(r)t=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(mn(21));return hn(o),{predicate:i,type:t,effect:o}},vn=Object.assign((e=>{let{type:t,predicate:r,effect:n}=pn(e);return{id:tn(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(mn(22))}}}),{withTypes:()=>vn});var yn=Object.assign(_r(`${fn}/add`),{withTypes:()=>yn});_r(`${fn}/removeAll`);var gn=Object.assign(_r(`${fn}/remove`),{withTypes:()=>gn});function mn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var wn=new K({required:!0,emptyAllowed:!1}),bn=new K({required:!1,emptyAllowed:!1}),Sn=new K({required:!0,emptyAllowed:!0});new K({required:!1,emptyAllowed:!0});var In=new re({each:wn,required:!0}),qn=new K({required:!1,emptyAllowed:!1,regex:/^\d+\.\d+\.\d+$/}),On=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),kn=(e,t)=>{if("required"in t)return{payload:new V({value:t}).validate({value:e}).value};let r=new ee({options:{required:!0},values:t}).validate(e);if(r)throw new _(r);return{payload:e}},An=(e,t)=>{try{return kn(e,t)}catch(t){return{payload:e,error:On(t)}}},Cn=(e,t,r,n)=>{let i=`Check the options of ${n}`;return jn(e,t,r,i,"Controller initialization error")},jn=(e,t,r,n,i)=>{try{return t.validate(r,n)}catch(t){throw e.logger.error(t,i),t}};var Rn="2.63.4",Dn=["@coveo/atomic","@coveo/quantic"];var Mn=()=>bn,En=()=>wn,xn=_r("configuration/updateBasicConfiguration",(e=>An(e,{accessToken:bn,organizationId:bn,platformUrl:bn}))),Tn=_r("configuration/updateSearchConfiguration",(e=>An(e,{apiBaseUrl:bn,pipeline:new K({required:!1,emptyAllowed:!0}),searchHub:bn,timezone:bn,locale:bn,authenticationProviders:new re({required:!1,each:wn})}))),Un={enabled:new W({default:!0}),originContext:Mn(),originLevel2:Mn(),originLevel3:Mn(),apiBaseUrl:bn,nextApiBaseUrl:bn,runtimeEnvironment:new Q,anonymous:new W({default:!1}),deviceId:bn,userDisplayName:bn,documentLocation:bn,trackingId:bn,analyticsMode:new K({constrainTo:["legacy","next"],required:!1,default:"legacy"}),source:new ee({options:{required:!1},values:Dn.reduce(((e,t)=>(e[t]=qn,e)),{})})},Fn=_r("configuration/updateAnalyticsConfiguration",(e=>(ue()&&(e.enabled=!1),An(e,Un)))),$n=_r("configuration/analytics/disable"),Pn=_r("configuration/analytics/enable"),_n=_r("configuration/analytics/originlevel2",(e=>An(e,{originLevel2:En()}))),Vn=_r("configuration/analytics/originlevel3",(e=>An(e,{originLevel3:En()})));var Qn={q:new K,enableQuerySyntax:new W,aq:new K,cq:new K,firstResult:new z({min:0}),numberOfResults:new z({min:0}),sortCriteria:new K,f:new ee,fExcluded:new ee,cf:new ee,nf:new ee,df:new ee,debug:new W,sf:new ee,tab:new K,af:new ee};var Ln=_r("searchParameters/restore",(e=>An(e,Qn)));var Nn=_r("debug/enable"),Yn=_r("debug/disable");var zn=()=>!1;var Hn=Xr(zn(),(e=>{e.addCase(Nn,(()=>!0)).addCase(Yn,(()=>!1)).addCase(Ln,((e,t)=>t.payload.debug??e))}));var Bn=_r("pipeline/set",(e=>An(e,new K({required:!0,emptyAllowed:!0}))));var Wn=_r("history/undo"),Gn=_r("history/redo"),Jn=_r("history/snapshot");cn("history/back",(async(e,{dispatch:t})=>{t(Wn()),await t(Zn())}));cn("history/forward",(async(e,{dispatch:t})=>{t(Gn()),await t(Zn())}));var Zn=cn("history/change",(async(e,{getState:t})=>t().history.present));var Kn=()=>"";var Xn=Xr(Kn(),(e=>{e.addCase(Bn,((e,t)=>t.payload)).addCase(Zn.fulfilled,((e,t)=>t.payload?.pipeline??e)).addCase(Tn,((e,t)=>t.payload.pipeline||e))}));function ei(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function ti(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){e.done?r(e.value):i(e.value).then(a,s)}u((n=n.apply(e,t||[])).next())}))}var ri;(function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect"})(ri||(ri={}));function ni(){return typeof window<"u"}function ii(){return typeof navigator<"u"}function oi(){return typeof document<"u"}function ai(){try{return typeof localStorage<"u"}catch{return!1}}function si(){try{return typeof sessionStorage<"u"}catch{return!1}}function ui(){return ii()&&navigator.cookieEnabled}var ci=[ri.click,ri.custom,ri.search,ri.view],li=(e,t)=>ci.indexOf(e)!==-1?Object.assign({language:oi()?document.documentElement.lang:"unknown",userAgent:ii()?navigator.userAgent:"unknown"},t):t,di=class e{static set(e,t,r){var n,i,o,a;r&&(i=new Date,i.setTime(i.getTime()+r)),a=window.location.hostname,a.indexOf(".")===-1?hi(e,t,i):(o=a.split("."),n=o[o.length-2]+"."+o[o.length-1],hi(e,t,i,n))}static get(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){var i=r[n];if(i=i.replace(/^\s+/,""),i.lastIndexOf(t,0)===0)return i.substring(t.length,i.length)}return null}static erase(t){e.set(t,"",-1)}};function hi(e,t,r,n){document.cookie=`${e}=${t}`+(r?`;expires=${r.toUTCString()}`:"")+(n?`;domain=${n}`:"")+";path=/;SameSite=Lax"}function fi(){return ai()?localStorage:ui()?new pi:si()?sessionStorage:new yi}var pi=class e{getItem(t){return di.get(`${e.prefix}${t}`)}removeItem(t){di.erase(`${e.prefix}${t}`)}setItem(t,r,n){di.set(`${e.prefix}${t}`,r,n)}};pi.prefix="coveo_";var vi=class{constructor(){this.cookieStorage=new pi}getItem(e){return localStorage.getItem(e)||this.cookieStorage.getItem(e)}removeItem(e){this.cookieStorage.removeItem(e),localStorage.removeItem(e)}setItem(e,t){localStorage.setItem(e,t),this.cookieStorage.setItem(e,t,31556926e3)}},yi=class{getItem(e){return null}removeItem(e){}setItem(e,t){}},gi="__coveo.analytics.history",mi=20,wi=1e3*60,bi=75,Si=class{constructor(e){this.store=e||fi()}addElement(e){e.internalTime=(new Date).getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=this.getHistoryWithInternalTime();t!=null?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}addElementAsync(e){return ti(this,void 0,void 0,(function*(){e.internalTime=(new Date).getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=yield this.getHistoryWithInternalTimeAsync();t!=null?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}))}getHistory(){let e=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(e))}getHistoryAsync(){return ti(this,void 0,void 0,(function*(){let e=yield this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(e))}))}getHistoryWithInternalTime(){try{let e=this.store.getItem(gi);return e&&typeof e=="string"?JSON.parse(e):[]}catch{return[]}}getHistoryWithInternalTimeAsync(){return ti(this,void 0,void 0,(function*(){try{let e=yield this.store.getItem(gi);return e?JSON.parse(e):[]}catch{return[]}}))}setHistory(e){try{this.store.setItem(gi,JSON.stringify(e.slice(0,mi)))}catch{}}clear(){try{this.store.removeItem(gi)}catch{}}getMostRecentElement(){let e=this.getHistoryWithInternalTime();return Array.isArray(e)?e.sort(((e,t)=>(t.internalTime||0)-(e.internalTime||0)))[0]:null}cropQueryElement(e){return e.name&&e.value&&e.name.toLowerCase()==="query"&&(e.value=e.value.slice(0,bi)),e}isValidEntry(e){let t=this.getMostRecentElement();return t&&t.value==e.value?(e.internalTime||0)-(t.internalTime||0)>wi:!0}stripInternalTime(e){return Array.isArray(e)?e.map((e=>{let{name:t,time:r,value:n}=e;return{name:t,time:r,value:n}})):[]}stripEmptyQuery(e){let{name:t,time:r,value:n}=e;return t&&typeof n=="string"&&t.toLowerCase()==="query"&&n.trim()===""?{name:t,time:r}:e}stripEmptyQueries(e){return e.map((e=>this.stripEmptyQuery(e)))}},Ii=Object.freeze({__proto__:null,HistoryStore:Si,MAX_NUMBER_OF_HISTORY_ELEMENTS:mi,MAX_VALUE_SIZE:bi,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:wi,STORE_KEY:gi,default:Si}),qi=(e,t)=>ti(void 0,void 0,void 0,(function*(){return e===ri.view?(yield Oi(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t})),Oi=e=>ti(void 0,void 0,void 0,(function*(){let t=new Si,r={name:"PageView",value:e,time:(new Date).toISOString()};yield t.addElementAsync(r)})),ki,Ai=new Uint8Array(16);function Ci(){if(!ki&&(ki=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ki))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ki(Ai)}var ji=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Ri(e){return typeof e=="string"&&ji.test(e)}var Di=[];for(let e=0;e<256;++e)Di.push((e+256).toString(16).slice(1));function Mi(e,t=0){return(Di[e[t+0]]+Di[e[t+1]]+Di[e[t+2]]+Di[e[t+3]]+"-"+Di[e[t+4]]+Di[e[t+5]]+"-"+Di[e[t+6]]+Di[e[t+7]]+"-"+Di[e[t+8]]+Di[e[t+9]]+"-"+Di[e[t+10]]+Di[e[t+11]]+Di[e[t+12]]+Di[e[t+13]]+Di[e[t+14]]+Di[e[t+15]]).toLowerCase()}function Ei(e){if(!Ri(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}function xi(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var Ti="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Ui="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Fi(e,t,r){function n(e,n,i,o){var a;if(typeof e=="string"&&(e=xi(e)),typeof n=="string"&&(n=Ei(n)),((a=n)===null||a===void 0?void 0:a.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let s=new Uint8Array(16+e.length);if(s.set(n),s.set(e,n.length),s=r(s),s[6]=s[6]&15|t,s[8]=s[8]&63|128,i){o=o||0;for(let e=0;e<16;++e)i[o+e]=s[e];return i}return Mi(s)}try{n.name=e}catch{}return n.DNS=Ti,n.URL=Ui,n}var $i=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Pi={randomUUID:$i};function _i(e,t,r){if(Pi.randomUUID&&!t&&!e)return Pi.randomUUID();e=e||{};let n=e.random||(e.rng||Ci)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return Mi(n)}function Vi(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function Qi(e,t){return e<<t|e>>>32-t}function Li(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){let t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=e.length/4+2,i=Math.ceil(n/16),o=new Array(i);for(let t=0;t<i;++t){let r=new Uint32Array(16);for(let n=0;n<16;++n)r[n]=e[t*64+n*4]<<24|e[t*64+n*4+1]<<16|e[t*64+n*4+2]<<8|e[t*64+n*4+3];o[t]=r}o[i-1][14]=(e.length-1)*8/Math.pow(2,32),o[i-1][14]=Math.floor(o[i-1][14]),o[i-1][15]=(e.length-1)*8&4294967295;for(let e=0;e<i;++e){let n=new Uint32Array(80);for(let t=0;t<16;++t)n[t]=o[e][t];for(let e=16;e<80;++e)n[e]=Qi(n[e-3]^n[e-8]^n[e-14]^n[e-16],1);let i=r[0],a=r[1],s=r[2],u=r[3],c=r[4];for(let e=0;e<80;++e){let r=Math.floor(e/20),o=Qi(i,5)+Vi(r,a,s,u)+c+t[r]+n[e]>>>0;c=u,u=s,s=Qi(a,30)>>>0,a=i,i=o}r[0]=r[0]+i>>>0,r[1]=r[1]+a>>>0,r[2]=r[2]+s>>>0,r[3]=r[3]+u>>>0,r[4]=r[4]+c>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var Ni=Fi("v5",80,Li),Yi=Ni,zi="2.30.2",Hi={pageview:"pageview",event:"event"},Bi=class e{constructor(e,t){if(!Ri(e))throw Error("Not a valid uuid");this.clientId=e,this.creationDate=Math.floor(t/1e3)}toString(){return this.clientId.replace(/-/g,"")+"."+this.creationDate.toString()}get expired(){let t=Math.floor(Date.now()/1e3)-this.creationDate;return t<0||t>e.expirationTime}validate(e,t){return!this.expired&&this.matchReferrer(e,t)}matchReferrer(e,t){try{let r=new URL(e);return t.some((e=>new RegExp(e.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(r.host)))}catch{return!1}}static fromString(t){let r=t.split(".");if(r.length!==2)return null;let[n,i]=r;if(n.length!==32||isNaN(parseInt(i)))return null;let o=n.substring(0,8)+"-"+n.substring(8,12)+"-"+n.substring(12,16)+"-"+n.substring(16,20)+"-"+n.substring(20,32);return Ri(o)?new e(o,Number.parseInt(i)*1e3):null}};Bi.cvo_cid="cvo_cid";Bi.expirationTime=120;var Wi=Object.keys;function Gi(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}var Ji={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},Zi=Wi(Ji).map((e=>Ji[e])),Ki=[...Zi].join("|"),Xi=new RegExp(`^(${Ki}$)`),eo={svcAction:"svc_action",svcActionData:"svc_action_data"},to=e=>Xi.test(e),ro=[to],no={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},io={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr",group:"group"},oo={action:"pa",list:"pal",listSource:"pls"},ao={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},so=["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit"],uo={id:"quoteId",affiliation:"quoteAffiliation"},co={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},lo={add:oo,bookmark_add:oo,bookmark_remove:oo,click:oo,checkout:oo,checkout_option:oo,detail:oo,impression:oo,remove:oo,refund:Object.assign(Object.assign({},oo),ao),purchase:Object.assign(Object.assign({},oo),ao),quickview:oo,quote:Object.assign(Object.assign({},oo),uo),review:Object.assign(Object.assign({},oo),co)},ho=Wi(no).map((e=>no[e])),fo=Wi(io).map((e=>io[e])),po=Wi(oo).map((e=>oo[e])),vo=Wi(ao).map((e=>ao[e])),yo=Wi(co).map((e=>co[e])),go=Wi(uo).map((e=>uo[e])),mo=[...ho,"custom"].join("|"),wo=[...fo,"custom"].join("|"),bo="(pr[0-9]+)",So="(il[0-9]+pi[0-9]+)",Io=new RegExp(`^${bo}(${mo})$`),qo=new RegExp(`^(${So}(${wo}))|(il[0-9]+nm)$`),Oo=new RegExp(`^(${po.join("|")})$`),ko=new RegExp(`^(${vo.join("|")})$`),Ao=new RegExp(`^${bo}custom$`),Co=new RegExp(`^${So}custom$`),jo=new RegExp(`^(${[...so,...yo,...go].join("|")})$`),Ro=e=>Io.test(e),Do=e=>qo.test(e),Mo=e=>Oo.test(e),Eo=e=>ko.test(e),xo=e=>jo.test(e),To=[Do,Ro,Mo,Eo,xo],Uo=[Ao,Co],Fo={anonymizeIp:"aip"},$o={eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"},Po={hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"},_o=["contentId","contentIdKey","contentType","searchHub","tab","searchUid","permanentId","contentLocale","trackingId"],Vo=Object.assign(Object.assign(Object.assign(Object.assign({},Fo),$o),Po),_o.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:t})),{})),Qo=Object.assign(Object.assign({},Vo),eo),Lo=e=>{let t=!!e.action&&lo[e.action]||{};return Wi(e).reduce(((r,n)=>{let i=t[n]||Qo[n]||n;return Object.assign(Object.assign({},r),{[i]:e[n]})}),{})},No=Wi(Qo).map((e=>Qo[e])),Yo=e=>No.indexOf(e)!==-1,zo=e=>e==="custom",Ho=e=>[...To,...ro,Yo,zo].some((t=>t(e))),Bo=e=>Wi(e).reduce(((t,r)=>{let n=Wo(r);return n?Object.assign(Object.assign({},t),Go(n,e[r])):Object.assign(Object.assign({},t),{[r]:e[r]})}),{}),Wo=e=>{let t;return[...Uo].every((r=>{var n;return t=(n=r.exec(e))===null||n===void 0?void 0:n[1],!t})),t},Go=(e,t)=>Wi(t).reduce(((r,n)=>Object.assign(Object.assign({},r),{[`${e}${n}`]:t[n]})),{}),Jo=class{constructor(e){this.opts=e}sendEvent(e,t){return ti(this,void 0,void 0,(function*(){if(!this.isAvailable())throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');let{baseUrl:r,preprocessRequest:n}=this.opts,i=yield this.getQueryParamsForEventType(e),{url:o,payload:a}=yield this.preProcessRequestAsPotentialJSONString(`${r}/analytics/${e}?${i}`,t,n),s=this.encodeForEventType(e,a),u=new Blob([s],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(o,u)}))}isAvailable(){return"sendBeacon"in navigator}deleteHttpCookieVisitorId(){return Promise.resolve()}preProcessRequestAsPotentialJSONString(e,t,r){return ti(this,void 0,void 0,(function*(){let n=e,i=t;if(r){let o=yield r({url:e,body:JSON.stringify(t)},"analyticsBeacon"),{url:a,body:s}=o;n=a||e;try{i=JSON.parse(s)}catch(e){console.error("Unable to process the request body as a JSON string",e)}}return{payload:i,url:n}}))}encodeForEventType(e,t){return this.isEventTypeLegacy(e)?this.encodeEventToJson(e,t):this.encodeEventToJson(e,t,this.opts.token)}getQueryParamsForEventType(e){return ti(this,void 0,void 0,(function*(){let{token:t,visitorIdProvider:r}=this.opts,n=yield r.getCurrentVisitorId();return[t&&this.isEventTypeLegacy(e)?`access_token=${t}`:"",n?`visitorId=${n}`:"","discardVisitInfo=true"].filter((e=>!!e)).join("&")}))}isEventTypeLegacy(e){return[ri.click,ri.custom,ri.search,ri.view].indexOf(e)!==-1}encodeEventToJson(e,t,r){let n=`${e}Event=${encodeURIComponent(JSON.stringify(t))}`;return r&&(n=`access_token=${encodeURIComponent(r)}&${n}`),n}},Zo=class{sendEvent(e,t){return ti(this,void 0,void 0,(function*(){return Promise.resolve()}))}deleteHttpCookieVisitorId(){return ti(this,void 0,void 0,(function*(){return Promise.resolve()}))}},Ko=window.fetch,Xo=class{constructor(e){this.opts=e}sendEvent(e,t){return ti(this,void 0,void 0,(function*(){let{baseUrl:r,visitorIdProvider:n,preprocessRequest:i}=this.opts,o=this.shouldAppendVisitorId(e)?yield this.getVisitorIdParam():"",a={url:`${r}/analytics/${e}${o}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(t)},s=Object.assign(Object.assign({},a),i?yield i(a,"analyticsFetch"):{}),{url:u}=s,c=ei(s,["url"]),l;try{l=yield Ko(u,c)}catch(e){console.error("An error has occured when sending the event.",e);return}if(l.ok){let e=yield l.json();return e.visitorId&&n.setCurrentVisitorId(e.visitorId),e}else{try{l.json()}catch{}throw console.error(`An error has occured when sending the "${e}" event.`,l,t),new Error(`An error has occurred when sending the "${e}" event. Check the console logs for more details.`)}}))}deleteHttpCookieVisitorId(){return ti(this,void 0,void 0,(function*(){let{baseUrl:e}=this.opts,t=`${e}/analytics/visit`;yield Ko(t,{headers:this.getHeaders(),method:"DELETE"})}))}shouldAppendVisitorId(e){return[ri.click,ri.custom,ri.search,ri.view].indexOf(e)!==-1}getVisitorIdParam(){return ti(this,void 0,void 0,(function*(){let{visitorIdProvider:e}=this.opts,t=yield e.getCurrentVisitorId();return t?`?visitor=${t}`:""}))}getHeaders(){let{token:e}=this.opts;return Object.assign(Object.assign({},e?{Authorization:`Bearer ${e}`}:{}),{"Content-Type":"application/json"})}},ea=class{constructor(e,t){ai()&&ui()?this.storage=new vi:ai()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new yi),this.client=new Xo(e),this.beaconClient=new Jo(e),window.addEventListener("beforeunload",(()=>{let e=t();for(let{eventType:t,payload:r}of e)this.beaconClient.sendEvent(t,r)}))}getClientDependingOnEventType(e){return e==="click"&&this.beaconClient.isAvailable()?this.beaconClient:this.client}},ta=class{constructor(e,t){this.storage=t||new yi,this.client=new Xo(e)}getClientDependingOnEventType(e){return this.client}},ra=class{constructor(){this.storage=new yi,this.client=new Zo}getClientDependingOnEventType(e){return this.client}},na="xx",ia=e=>e?.startsWith(na)||!1,oa=`\n        We've detected you're using React Native but have not provided the corresponding runtime, \n        for an optimal experience please use the "coveo.analytics/react-native" subpackage.\n        Follow the Readme on how to set it up: https://github.com/coveo/coveo.analytics.js#using-react-native\n    `;function aa(){return typeof navigator<"u"&&navigator.product=="ReactNative"}var sa=["1",1,"yes",!0];function ua(){return ii()&&[navigator.globalPrivacyControl,navigator.doNotTrack,navigator.msDoNotTrack,window.doNotTrack].some((e=>sa.indexOf(e)!==-1))}var ca="v15",la={default:"https://analytics.cloud.coveo.com/rest/ua",production:"https://analytics.cloud.coveo.com/rest/ua",hipaa:"https://analyticshipaa.cloud.coveo.com/rest/ua"};function da(e=la.default,t=ca,r=!1){if(e=e.replace(/\/$/,""),r)return`${e}/${t}`;let n=e.endsWith("/rest")||e.endsWith("/rest/ua");return`${e}${n?"":"/rest"}/${t}`}var ha="38824e1f-37f5-42d3-8372-a4b8fa9df946",fa=class{get defaultOptions(){return{endpoint:la.default,isCustomEndpoint:!1,token:"",version:ca,beforeSendHooks:[],afterSendHooks:[]}}get version(){return zi}constructor(e){if(this.acceptedLinkReferrers=[],!e)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[qi,li].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};let t={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};ua()?this.runtime=new ra:this.runtime=this.options.runtimeEnvironment||this.initRuntime(t),this.addEventTypeMapping(ri.view,{newEventType:ri.view,addClientIdParameter:!0}),this.addEventTypeMapping(ri.click,{newEventType:ri.click,addClientIdParameter:!0}),this.addEventTypeMapping(ri.custom,{newEventType:ri.custom,addClientIdParameter:!0}),this.addEventTypeMapping(ri.search,{newEventType:ri.search,addClientIdParameter:!0})}initRuntime(e){return ni()&&oi()?new ea(e,(()=>{let e=[...this.bufferedRequests];return this.bufferedRequests=[],e})):(aa()&&console.warn(oa),new ta(e))}get storage(){return this.runtime.storage}determineVisitorId(){return ti(this,void 0,void 0,(function*(){try{return ni()&&this.extractClientIdFromLink(window.location.href)||(yield this.storage.getItem("visitorId"))||_i()}catch(e){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",e),_i()}}))}getCurrentVisitorId(){return ti(this,void 0,void 0,(function*(){if(!this.visitorId){let e=yield this.determineVisitorId();yield this.setCurrentVisitorId(e)}return this.visitorId}))}setCurrentVisitorId(e){return ti(this,void 0,void 0,(function*(){this.visitorId=e,yield this.storage.setItem("visitorId",e)}))}setClientId(e,t){return ti(this,void 0,void 0,(function*(){if(Ri(e))this.setCurrentVisitorId(e.toLowerCase());else{if(!t)throw Error("Cannot generate uuid client id without a specific namespace string.");this.setCurrentVisitorId(Yi(e,Yi(t,ha)))}}))}getParameters(e,...t){return ti(this,void 0,void 0,(function*(){return yield this.resolveParameters(e,...t)}))}getPayload(e,...t){return ti(this,void 0,void 0,(function*(){let r=yield this.resolveParameters(e,...t);return yield this.resolvePayloadForParameters(e,r)}))}get currentVisitorId(){return typeof(this.visitorId||this.storage.getItem("visitorId"))!="string"&&this.setCurrentVisitorId(_i()),this.visitorId}set currentVisitorId(e){this.visitorId=e,this.storage.setItem("visitorId",e)}extractClientIdFromLink(e){if(ua())return null;try{let t=new URL(e).searchParams.get(Bi.cvo_cid);if(t==null)return null;let r=Bi.fromString(t);return!r||!oi()||!r.validate(document.referrer,this.acceptedLinkReferrers)?null:r.clientId}catch{}return null}resolveParameters(e,...t){return ti(this,void 0,void 0,(function*(){let{variableLengthArgumentsNames:r=[],addVisitorIdParameter:n=!1,usesMeasurementProtocol:i=!1,addClientIdParameter:o=!1}=this.eventTypeMapping[e]||{};return yield[e=>r.length>0?this.parseVariableArgumentsPayload(r,e):e[0],e=>ti(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},e),{visitorId:n?yield this.getCurrentVisitorId():""})})),e=>ti(this,void 0,void 0,(function*(){return o?Object.assign(Object.assign({},e),{clientId:yield this.getCurrentVisitorId()}):e})),e=>i?this.ensureAnonymousUserWhenUsingApiKey(e):e,t=>this.beforeSendHooks.reduce(((t,r)=>ti(this,void 0,void 0,(function*(){let n=yield t;return yield r(e,n)}))),t)].reduce(((e,t)=>ti(this,void 0,void 0,(function*(){let r=yield e;return yield t(r)}))),Promise.resolve(t))}))}resolvePayloadForParameters(e,t){return ti(this,void 0,void 0,(function*(){let{usesMeasurementProtocol:r=!1}=this.eventTypeMapping[e]||{};return yield[e=>this.setTrackingIdIfTrackingIdNotPresent(e),t=>this.removeEmptyPayloadValues(t,e),t=>this.validateParams(t,e),e=>r?Lo(e):e,e=>r?this.removeUnknownParameters(e):e,e=>r?this.processCustomParameters(e):this.mapCustomParametersToCustomData(e)].reduce(((e,t)=>ti(this,void 0,void 0,(function*(){let r=yield e;return yield t(r)}))),Promise.resolve(t))}))}makeEvent(e,...t){return ti(this,void 0,void 0,(function*(){let{newEventType:r=e}=this.eventTypeMapping[e]||{},n=yield this.resolveParameters(e,...t),i=yield this.resolvePayloadForParameters(e,n);return{eventType:r,payload:i,log:t=>ti(this,void 0,void 0,(function*(){return this.bufferedRequests.push({eventType:r,payload:Object.assign(Object.assign({},i),t)}),yield Promise.all(this.afterSendHooks.map((r=>r(e,Object.assign(Object.assign({},n),t))))),yield this.deferExecution(),yield this.sendFromBuffer()}))}}))}sendEvent(e,...t){return ti(this,void 0,void 0,(function*(){return(yield this.makeEvent(e,...t)).log({})}))}deferExecution(){return new Promise((e=>setTimeout(e,0)))}sendFromBuffer(){return ti(this,void 0,void 0,(function*(){let e=this.bufferedRequests.shift();if(e){let{eventType:t,payload:r}=e;return this.runtime.getClientDependingOnEventType(t).sendEvent(t,r)}}))}clear(){this.storage.removeItem("visitorId"),(new Si).clear()}deleteHttpOnlyVisitorId(){this.runtime.client.deleteHttpCookieVisitorId()}makeSearchEvent(e){return ti(this,void 0,void 0,(function*(){return this.makeEvent(ri.search,e)}))}sendSearchEvent(e){var{searchQueryUid:t}=e,r=ei(e,["searchQueryUid"]);return ti(this,void 0,void 0,(function*(){return(yield this.makeSearchEvent(r)).log({searchQueryUid:t})}))}makeClickEvent(e){return ti(this,void 0,void 0,(function*(){return this.makeEvent(ri.click,e)}))}sendClickEvent(e){var{searchQueryUid:t}=e,r=ei(e,["searchQueryUid"]);return ti(this,void 0,void 0,(function*(){return(yield this.makeClickEvent(r)).log({searchQueryUid:t})}))}makeCustomEvent(e){return ti(this,void 0,void 0,(function*(){return this.makeEvent(ri.custom,e)}))}sendCustomEvent(e){var{lastSearchQueryUid:t}=e,r=ei(e,["lastSearchQueryUid"]);return ti(this,void 0,void 0,(function*(){return(yield this.makeCustomEvent(r)).log({lastSearchQueryUid:t})}))}makeViewEvent(e){return ti(this,void 0,void 0,(function*(){return this.makeEvent(ri.view,e)}))}sendViewEvent(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeViewEvent(e)).log({})}))}getVisit(){return ti(this,void 0,void 0,(function*(){let e=yield(yield fetch(`${this.baseUrl}/analytics/visit`)).json();return this.visitorId=e.visitorId,e}))}getHealth(){return ti(this,void 0,void 0,(function*(){return yield(yield fetch(`${this.baseUrl}/analytics/monitoring/health`)).json()}))}registerBeforeSendEventHook(e){this.beforeSendHooks.push(e)}registerAfterSendEventHook(e){this.afterSendHooks.push(e)}addEventTypeMapping(e,t){this.eventTypeMapping[e]=t}setAcceptedLinkReferrers(e){if(Array.isArray(e)&&e.every((e=>typeof e=="string")))this.acceptedLinkReferrers=e;else throw Error("Parameter should be an array of domain strings")}parseVariableArgumentsPayload(e,t){let r={};for(let n=0,i=t.length;n<i;n++){let i=t[n];if(typeof i=="string")r[e[n]]=i;else if(typeof i=="object")return Object.assign(Object.assign({},r),i)}return r}isKeyAllowedEmpty(e,t){return({[ri.search]:["queryText"]}[e]||[]).indexOf(t)!==-1}removeEmptyPayloadValues(e,t){let r=e=>typeof e<"u"&&e!==null&&e!=="";return Object.keys(e).filter((n=>this.isKeyAllowedEmpty(t,n)||r(e[n]))).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{})}removeUnknownParameters(e){return Object.keys(e).filter((e=>{if(Ho(e))return!0;console.log(e,"is not processed by coveoua")})).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{})}processCustomParameters(e){let{custom:t}=e,r=ei(e,["custom"]),n={};t&&Gi(t)&&(n=this.lowercaseKeys(t));let i=Bo(r);return Object.assign(Object.assign({},n),i)}mapCustomParametersToCustomData(e){let{custom:t}=e,r=ei(e,["custom"]);if(t&&Gi(t)){let n=this.lowercaseKeys(t);return Object.assign(Object.assign({},r),{customData:Object.assign(Object.assign({},n),e.customData)})}else return e}lowercaseKeys(e){let t=Object.keys(e),r={};return t.forEach((t=>{r[t.toLowerCase()]=e[t]})),r}validateParams(e,t){let{anonymizeIp:r}=e,n=ei(e,["anonymizeIp"]);return r!==void 0&&["0","false","undefined","null","{}","[]",""].indexOf(`${r}`.toLowerCase())==-1&&(n.anonymizeIp=1),(t==ri.view||t==ri.click||t==ri.search||t==ri.custom)&&(n.originLevel3=this.limit(n.originLevel3,128)),t==ri.view&&(n.location=this.limit(n.location,128)),(t=="pageview"||t=="event")&&(n.referrer=this.limit(n.referrer,2048),n.location=this.limit(n.location,2048),n.page=this.limit(n.page,2048)),n}ensureAnonymousUserWhenUsingApiKey(e){let{userId:t}=e,r=ei(e,["userId"]);return ia(this.options.token)&&!t?(r.userId="anonymous",r):e}setTrackingIdIfTrackingIdNotPresent(e){let{trackingId:t}=e,r=ei(e,["trackingId"]);return t?e:(r.hasOwnProperty("custom")&&Gi(r.custom)&&(r.custom.hasOwnProperty("context_website")||r.custom.hasOwnProperty("siteName"))&&(r.trackingId=r.custom.context_website||r.custom.siteName),r.hasOwnProperty("customData")&&Gi(r.customData)&&(r.customData.hasOwnProperty("context_website")||r.customData.hasOwnProperty("siteName"))&&(r.trackingId=r.customData.context_website||r.customData.siteName),r)}limit(e,t){return typeof e!="string"?e:e.substring(0,t)}get baseUrl(){return da(this.options.endpoint,this.options.version,this.options.isCustomEndpoint)}},pa;(function(e){e.contextChanged="contextChanged",e.expandToFullUI="expandToFullUI",e.openUserActions="openUserActions",e.showPrecedingSessions="showPrecedingSessions",e.showFollowingSessions="showFollowingSessions",e.clickViewedDocument="clickViewedDocument",e.clickPageView="clickPageView",e.createArticle="createArticle"})(pa||(pa={}));var va;(function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.undoTriggerQuery="undoQuery",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.staticFilterClearAll="staticFilterClearAll",e.staticFilterSelect="staticFilterSelect",e.staticFilterDeselect="staticFilterDeselect",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",e.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",e.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",e.openSmartSnippetSource="openSmartSnippetSource",e.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",e.openSmartSnippetInlineLink="openSmartSnippetInlineLink",e.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",e.recentQueryClick="recentQueriesClick",e.clearRecentQueries="clearRecentQueries",e.recentResultClick="recentResultClick",e.clearRecentResults="clearRecentResults",e.noResultsBack="noResultsBack",e.showMoreFoldedResults="showMoreFoldedResults",e.showLessFoldedResults="showLessFoldedResults",e.copyToClipboard="copyToClipboard",e.caseSendEmail="Case.SendEmail",e.feedItemTextPost="FeedItem.TextPost",e.caseAttach="caseAttach",e.caseDetach="caseDetach",e.retryGeneratedAnswer="retryGeneratedAnswer",e.likeGeneratedAnswer="likeGeneratedAnswer",e.dislikeGeneratedAnswer="dislikeGeneratedAnswer",e.openGeneratedAnswerSource="openGeneratedAnswerSource",e.generatedAnswerStreamEnd="generatedAnswerStreamEnd",e.generatedAnswerSourceHover="generatedAnswerSourceHover",e.generatedAnswerCopyToClipboard="generatedAnswerCopyToClipboard",e.generatedAnswerHideAnswers="generatedAnswerHideAnswers",e.generatedAnswerShowAnswers="generatedAnswerShowAnswers",e.generatedAnswerExpand="generatedAnswerExpand",e.generatedAnswerCollapse="generatedAnswerCollapse",e.generatedAnswerFeedbackSubmit="generatedAnswerFeedbackSubmit",e.rephraseGeneratedAnswer="rephraseGeneratedAnswer"})(va||(va={}));var ya={[va.triggerNotify]:"queryPipelineTriggers",[va.triggerExecute]:"queryPipelineTriggers",[va.triggerQuery]:"queryPipelineTriggers",[va.triggerRedirect]:"queryPipelineTriggers",[va.queryError]:"errors",[va.queryErrorBack]:"errors",[va.queryErrorClear]:"errors",[va.queryErrorRetry]:"errors",[va.pagerNext]:"getMoreResults",[va.pagerPrevious]:"getMoreResults",[va.pagerNumber]:"getMoreResults",[va.pagerResize]:"getMoreResults",[va.pagerScrolling]:"getMoreResults",[va.facetSearch]:"facet",[va.facetShowLess]:"facet",[va.facetShowMore]:"facet",[va.recommendation]:"recommendation",[va.likeSmartSnippet]:"smartSnippet",[va.dislikeSmartSnippet]:"smartSnippet",[va.expandSmartSnippet]:"smartSnippet",[va.collapseSmartSnippet]:"smartSnippet",[va.openSmartSnippetFeedbackModal]:"smartSnippet",[va.closeSmartSnippetFeedbackModal]:"smartSnippet",[va.sendSmartSnippetReason]:"smartSnippet",[va.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[va.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions",[va.showMoreSmartSnippetSuggestion]:"smartSnippetSuggestions",[va.showLessSmartSnippetSuggestion]:"smartSnippetSuggestions",[va.clearRecentQueries]:"recentQueries",[va.recentResultClick]:"recentlyClickedDocuments",[va.clearRecentResults]:"recentlyClickedDocuments",[va.showLessFoldedResults]:"folding",[va.caseDetach]:"case",[va.likeGeneratedAnswer]:"generatedAnswer",[va.dislikeGeneratedAnswer]:"generatedAnswer",[va.openGeneratedAnswerSource]:"generatedAnswer",[va.generatedAnswerStreamEnd]:"generatedAnswer",[va.generatedAnswerSourceHover]:"generatedAnswer",[va.generatedAnswerCopyToClipboard]:"generatedAnswer",[va.generatedAnswerHideAnswers]:"generatedAnswer",[va.generatedAnswerShowAnswers]:"generatedAnswer",[va.generatedAnswerExpand]:"generatedAnswer",[va.generatedAnswerCollapse]:"generatedAnswer",[va.generatedAnswerFeedbackSubmit]:"generatedAnswer",[pa.expandToFullUI]:"interface",[pa.openUserActions]:"User Actions",[pa.showPrecedingSessions]:"User Actions",[pa.showFollowingSessions]:"User Actions",[pa.clickViewedDocument]:"User Actions",[pa.clickPageView]:"User Actions",[pa.createArticle]:"createArticle"},ga=class{constructor(){this.runtime=new ra,this.currentVisitorId=""}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}makeEvent(e){return Promise.resolve({eventType:e,payload:null,log:()=>Promise.resolve()})}sendEvent(){return Promise.resolve()}makeSearchEvent(){return this.makeEvent(ri.search)}sendSearchEvent(){return Promise.resolve()}makeClickEvent(){return this.makeEvent(ri.click)}sendClickEvent(){return Promise.resolve()}makeCustomEvent(){return this.makeEvent(ri.custom)}sendCustomEvent(){return Promise.resolve()}makeViewEvent(){return this.makeEvent(ri.view)}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}get version(){return zi}};function ma(e){let t="";return e.filter((e=>{let r=e!==t;return t=e,r}))}function wa(e){return e.map((e=>e.replace(/;/g,"")))}function ba(e){let t=e.join(";");return t.length<=256?t:ba(e.slice(1))}var Sa=e=>{let t=wa(e),r=ma(t);return ba(r)};function Ia(e){let t=typeof e.partialQueries=="string"?e.partialQueries:Sa(e.partialQueries),r=typeof e.suggestions=="string"?e.suggestions:Sa(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}var qa=class{constructor(e,t){this.opts=e,this.provider=t;let r=e.enableAnalytics===!1||ua();this.coveoAnalyticsClient=r?new ga:new fa(e)}disable(){this.coveoAnalyticsClient=new ga}enable(){this.coveoAnalyticsClient=new fa(this.opts)}makeInterfaceLoad(){return this.makeSearchEvent(va.interfaceLoad)}logInterfaceLoad(){return ti(this,void 0,void 0,(function*(){return(yield this.makeInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})}))}makeRecommendationInterfaceLoad(){return this.makeSearchEvent(va.recommendationInterfaceLoad)}logRecommendationInterfaceLoad(){return ti(this,void 0,void 0,(function*(){return(yield this.makeRecommendationInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})}))}makeRecommendation(){return this.makeCustomEvent(va.recommendation)}logRecommendation(){return ti(this,void 0,void 0,(function*(){return(yield this.makeRecommendation()).log({searchUID:this.provider.getSearchUID()})}))}makeRecommendationOpen(e,t){return this.makeClickEvent(va.recommendationOpen,e,t)}logRecommendationOpen(e,t){return ti(this,void 0,void 0,(function*(){return(yield this.makeRecommendationOpen(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeStaticFilterClearAll(e){return this.makeSearchEvent(va.staticFilterClearAll,e)}logStaticFilterClearAll(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeStaticFilterClearAll(e)).log({searchUID:this.provider.getSearchUID()})}))}makeStaticFilterSelect(e){return this.makeSearchEvent(va.staticFilterSelect,e)}logStaticFilterSelect(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeStaticFilterSelect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeStaticFilterDeselect(e){return this.makeSearchEvent(va.staticFilterDeselect,e)}logStaticFilterDeselect(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeStaticFilterDeselect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFetchMoreResults(){return this.makeCustomEvent(va.pagerScrolling,{type:"getMoreResults"})}logFetchMoreResults(){return ti(this,void 0,void 0,(function*(){return(yield this.makeFetchMoreResults()).log({searchUID:this.provider.getSearchUID()})}))}makeInterfaceChange(e){return this.makeSearchEvent(va.interfaceChange,e)}logInterfaceChange(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeInterfaceChange(e)).log({searchUID:this.provider.getSearchUID()})}))}makeDidYouMeanAutomatic(){return this.makeSearchEvent(va.didyoumeanAutomatic)}logDidYouMeanAutomatic(){return ti(this,void 0,void 0,(function*(){return(yield this.makeDidYouMeanAutomatic()).log({searchUID:this.provider.getSearchUID()})}))}makeDidYouMeanClick(){return this.makeSearchEvent(va.didyoumeanClick)}logDidYouMeanClick(){return ti(this,void 0,void 0,(function*(){return(yield this.makeDidYouMeanClick()).log({searchUID:this.provider.getSearchUID()})}))}makeResultsSort(e){return this.makeSearchEvent(va.resultsSort,e)}logResultsSort(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeResultsSort(e)).log({searchUID:this.provider.getSearchUID()})}))}makeSearchboxSubmit(){return this.makeSearchEvent(va.searchboxSubmit)}logSearchboxSubmit(){return ti(this,void 0,void 0,(function*(){return(yield this.makeSearchboxSubmit()).log({searchUID:this.provider.getSearchUID()})}))}makeSearchboxClear(){return this.makeSearchEvent(va.searchboxClear)}logSearchboxClear(){return ti(this,void 0,void 0,(function*(){return(yield this.makeSearchboxClear()).log({searchUID:this.provider.getSearchUID()})}))}makeSearchboxAsYouType(){return this.makeSearchEvent(va.searchboxAsYouType)}logSearchboxAsYouType(){return ti(this,void 0,void 0,(function*(){return(yield this.makeSearchboxAsYouType()).log({searchUID:this.provider.getSearchUID()})}))}makeBreadcrumbFacet(e){return this.makeSearchEvent(va.breadcrumbFacet,e)}logBreadcrumbFacet(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeBreadcrumbFacet(e)).log({searchUID:this.provider.getSearchUID()})}))}makeBreadcrumbResetAll(){return this.makeSearchEvent(va.breadcrumbResetAll)}logBreadcrumbResetAll(){return ti(this,void 0,void 0,(function*(){return(yield this.makeBreadcrumbResetAll()).log({searchUID:this.provider.getSearchUID()})}))}makeDocumentQuickview(e,t){return this.makeClickEvent(va.documentQuickview,e,t)}logDocumentQuickview(e,t){return ti(this,void 0,void 0,(function*(){return(yield this.makeDocumentQuickview(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeDocumentOpen(e,t){return this.makeClickEvent(va.documentOpen,e,t)}logDocumentOpen(e,t){return ti(this,void 0,void 0,(function*(){return(yield this.makeDocumentOpen(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOmniboxAnalytics(e){return this.makeSearchEvent(va.omniboxAnalytics,Ia(e))}logOmniboxAnalytics(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeOmniboxAnalytics(e)).log({searchUID:this.provider.getSearchUID()})}))}makeOmniboxFromLink(e){return this.makeSearchEvent(va.omniboxFromLink,Ia(e))}logOmniboxFromLink(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeOmniboxFromLink(e)).log({searchUID:this.provider.getSearchUID()})}))}makeSearchFromLink(){return this.makeSearchEvent(va.searchFromLink)}logSearchFromLink(){return ti(this,void 0,void 0,(function*(){return(yield this.makeSearchFromLink()).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerNotify(e){return this.makeCustomEvent(va.triggerNotify,e)}logTriggerNotify(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeTriggerNotify(e)).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerExecute(e){return this.makeCustomEvent(va.triggerExecute,e)}logTriggerExecute(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeTriggerExecute(e)).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerQuery(){return this.makeCustomEvent(va.triggerQuery,{query:this.provider.getSearchEventRequestPayload().queryText},"queryPipelineTriggers")}logTriggerQuery(){return ti(this,void 0,void 0,(function*(){return(yield this.makeTriggerQuery()).log({searchUID:this.provider.getSearchUID()})}))}makeUndoTriggerQuery(e){return this.makeSearchEvent(va.undoTriggerQuery,e)}logUndoTriggerQuery(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeUndoTriggerQuery(e)).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerRedirect(e){return this.makeCustomEvent(va.triggerRedirect,Object.assign(Object.assign({},e),{query:this.provider.getSearchEventRequestPayload().queryText}))}logTriggerRedirect(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeTriggerRedirect(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerResize(e){return this.makeCustomEvent(va.pagerResize,e)}logPagerResize(e){return ti(this,void 0,void 0,(function*(){return(yield this.makePagerResize(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerNumber(e){return this.makeCustomEvent(va.pagerNumber,e)}logPagerNumber(e){return ti(this,void 0,void 0,(function*(){return(yield this.makePagerNumber(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerNext(e){return this.makeCustomEvent(va.pagerNext,e)}logPagerNext(e){return ti(this,void 0,void 0,(function*(){return(yield this.makePagerNext(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerPrevious(e){return this.makeCustomEvent(va.pagerPrevious,e)}logPagerPrevious(e){return ti(this,void 0,void 0,(function*(){return(yield this.makePagerPrevious(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerScrolling(){return this.makeCustomEvent(va.pagerScrolling)}logPagerScrolling(){return ti(this,void 0,void 0,(function*(){return(yield this.makePagerScrolling()).log({searchUID:this.provider.getSearchUID()})}))}makeFacetClearAll(e){return this.makeSearchEvent(va.facetClearAll,e)}logFacetClearAll(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeFacetClearAll(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetSearch(e){return this.makeSearchEvent(va.facetSearch,e)}logFacetSearch(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeFacetSearch(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetSelect(e){return this.makeSearchEvent(va.facetSelect,e)}logFacetSelect(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeFacetSelect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetDeselect(e){return this.makeSearchEvent(va.facetDeselect,e)}logFacetDeselect(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeFacetDeselect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetExclude(e){return this.makeSearchEvent(va.facetExclude,e)}logFacetExclude(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeFacetExclude(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetUnexclude(e){return this.makeSearchEvent(va.facetUnexclude,e)}logFacetUnexclude(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeFacetUnexclude(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetSelectAll(e){return this.makeSearchEvent(va.facetSelectAll,e)}logFacetSelectAll(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeFacetSelectAll(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetUpdateSort(e){return this.makeSearchEvent(va.facetUpdateSort,e)}logFacetUpdateSort(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeFacetUpdateSort(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetShowMore(e){return this.makeCustomEvent(va.facetShowMore,e)}logFacetShowMore(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeFacetShowMore(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetShowLess(e){return this.makeCustomEvent(va.facetShowLess,e)}logFacetShowLess(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeFacetShowLess(e)).log({searchUID:this.provider.getSearchUID()})}))}makeQueryError(e){return this.makeCustomEvent(va.queryError,e)}logQueryError(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeQueryError(e)).log({searchUID:this.provider.getSearchUID()})}))}makeQueryErrorBack(){return ti(this,void 0,void 0,(function*(){let e=yield this.makeCustomEvent(va.queryErrorBack);return{description:e.description,log:()=>ti(this,void 0,void 0,(function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(va.queryErrorBack)}))}}))}logQueryErrorBack(){return ti(this,void 0,void 0,(function*(){return(yield this.makeQueryErrorBack()).log({searchUID:this.provider.getSearchUID()})}))}makeQueryErrorRetry(){return ti(this,void 0,void 0,(function*(){let e=yield this.makeCustomEvent(va.queryErrorRetry);return{description:e.description,log:()=>ti(this,void 0,void 0,(function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(va.queryErrorRetry)}))}}))}logQueryErrorRetry(){return ti(this,void 0,void 0,(function*(){return(yield this.makeQueryErrorRetry()).log({searchUID:this.provider.getSearchUID()})}))}makeQueryErrorClear(){return ti(this,void 0,void 0,(function*(){let e=yield this.makeCustomEvent(va.queryErrorClear);return{description:e.description,log:()=>ti(this,void 0,void 0,(function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(va.queryErrorClear)}))}}))}logQueryErrorClear(){return ti(this,void 0,void 0,(function*(){return(yield this.makeQueryErrorClear()).log({searchUID:this.provider.getSearchUID()})}))}makeLikeSmartSnippet(){return this.makeCustomEvent(va.likeSmartSnippet)}logLikeSmartSnippet(){return ti(this,void 0,void 0,(function*(){return(yield this.makeLikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeDislikeSmartSnippet(){return this.makeCustomEvent(va.dislikeSmartSnippet)}logDislikeSmartSnippet(){return ti(this,void 0,void 0,(function*(){return(yield this.makeDislikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeExpandSmartSnippet(){return this.makeCustomEvent(va.expandSmartSnippet)}logExpandSmartSnippet(){return ti(this,void 0,void 0,(function*(){return(yield this.makeExpandSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeCollapseSmartSnippet(){return this.makeCustomEvent(va.collapseSmartSnippet)}logCollapseSmartSnippet(){return ti(this,void 0,void 0,(function*(){return(yield this.makeCollapseSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetFeedbackModal(){return this.makeCustomEvent(va.openSmartSnippetFeedbackModal)}logOpenSmartSnippetFeedbackModal(){return ti(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})}))}makeCloseSmartSnippetFeedbackModal(){return this.makeCustomEvent(va.closeSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return ti(this,void 0,void 0,(function*(){return(yield this.makeCloseSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})}))}makeSmartSnippetFeedbackReason(e,t){return this.makeCustomEvent(va.sendSmartSnippetReason,{reason:e,details:t})}logSmartSnippetFeedbackReason(e,t){return ti(this,void 0,void 0,(function*(){return(yield this.makeSmartSnippetFeedbackReason(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeExpandSmartSnippetSuggestion(e){return this.makeCustomEvent(va.expandSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logExpandSmartSnippetSuggestion(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeExpandSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeCollapseSmartSnippetSuggestion(e){return this.makeCustomEvent(va.collapseSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logCollapseSmartSnippetSuggestion(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeCollapseSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeShowMoreSmartSnippetSuggestion(e){return this.makeCustomEvent(va.showMoreSmartSnippetSuggestion,e)}logShowMoreSmartSnippetSuggestion(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeShowMoreSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeShowLessSmartSnippetSuggestion(e){return this.makeCustomEvent(va.showLessSmartSnippetSuggestion,e)}logShowLessSmartSnippetSuggestion(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeShowLessSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetSource(e,t){return this.makeClickEvent(va.openSmartSnippetSource,e,t)}logOpenSmartSnippetSource(e,t){return ti(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetSource(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetSuggestionSource(e,t){return this.makeClickEvent(va.openSmartSnippetSuggestionSource,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}makeCopyToClipboard(e,t){return this.makeClickEvent(va.copyToClipboard,e,t)}logCopyToClipboard(e,t){return ti(this,void 0,void 0,(function*(){return(yield this.makeCopyToClipboard(e,t)).log({searchUID:this.provider.getSearchUID()})}))}logOpenSmartSnippetSuggestionSource(e,t){return ti(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetSuggestionSource(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetInlineLink(e,t){return this.makeClickEvent(va.openSmartSnippetInlineLink,e,{contentIDKey:t.contentIDKey,contentIDValue:t.contentIDValue},t)}logOpenSmartSnippetInlineLink(e,t){return ti(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetSuggestionInlineLink(e,t){return this.makeClickEvent(va.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}logOpenSmartSnippetSuggestionInlineLink(e,t){return ti(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetSuggestionInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeRecentQueryClick(){return this.makeSearchEvent(va.recentQueryClick)}logRecentQueryClick(){return ti(this,void 0,void 0,(function*(){return(yield this.makeRecentQueryClick()).log({searchUID:this.provider.getSearchUID()})}))}makeClearRecentQueries(){return this.makeCustomEvent(va.clearRecentQueries)}logClearRecentQueries(){return ti(this,void 0,void 0,(function*(){return(yield this.makeClearRecentQueries()).log({searchUID:this.provider.getSearchUID()})}))}makeRecentResultClick(e,t){return this.makeCustomEvent(va.recentResultClick,{info:e,identifier:t})}logRecentResultClick(e,t){return ti(this,void 0,void 0,(function*(){return(yield this.makeRecentResultClick(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeClearRecentResults(){return this.makeCustomEvent(va.clearRecentResults)}logClearRecentResults(){return ti(this,void 0,void 0,(function*(){return(yield this.makeClearRecentResults()).log({searchUID:this.provider.getSearchUID()})}))}makeNoResultsBack(){return this.makeSearchEvent(va.noResultsBack)}logNoResultsBack(){return ti(this,void 0,void 0,(function*(){return(yield this.makeNoResultsBack()).log({searchUID:this.provider.getSearchUID()})}))}makeShowMoreFoldedResults(e,t){return this.makeClickEvent(va.showMoreFoldedResults,e,t)}logShowMoreFoldedResults(e,t){return ti(this,void 0,void 0,(function*(){return(yield this.makeShowMoreFoldedResults(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeShowLessFoldedResults(){return this.makeCustomEvent(va.showLessFoldedResults)}logShowLessFoldedResults(){return ti(this,void 0,void 0,(function*(){return(yield this.makeShowLessFoldedResults()).log({searchUID:this.provider.getSearchUID()})}))}makeEventDescription(e,t){var r;return{actionCause:t,customData:(r=e.payload)===null||r===void 0?void 0:r.customData}}makeCustomEvent(e,t,r=ya[e]){return ti(this,void 0,void 0,(function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),i=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:r,eventValue:e}),o=yield this.coveoAnalyticsClient.makeCustomEvent(i);return{description:this.makeEventDescription(o,e),log:({searchUID:e})=>o.log({lastSearchQueryUid:e})}}))}logCustomEvent(e,t,r=ya[e]){return ti(this,void 0,void 0,(function*(){return(yield this.makeCustomEvent(e,t,r)).log({searchUID:this.provider.getSearchUID()})}))}makeCustomEventWithType(e,t,r){return ti(this,void 0,void 0,(function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),i=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:t,eventValue:e}),o=yield this.coveoAnalyticsClient.makeCustomEvent(i);return{description:this.makeEventDescription(o,e),log:({searchUID:e})=>o.log({lastSearchQueryUid:e})}}))}logCustomEventWithType(e,t,r){return ti(this,void 0,void 0,(function*(){return(yield this.makeCustomEventWithType(e,t,r)).log({searchUID:this.provider.getSearchUID()})}))}logSearchEvent(e,t){return ti(this,void 0,void 0,(function*(){return(yield this.makeSearchEvent(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeSearchEvent(e,t){return ti(this,void 0,void 0,(function*(){let r=yield this.getBaseSearchEventRequest(e,t),n=yield this.coveoAnalyticsClient.makeSearchEvent(r);return{description:this.makeEventDescription(n,e),log:({searchUID:e})=>n.log({searchQueryUid:e})}}))}makeClickEvent(e,t,r,n){return ti(this,void 0,void 0,(function*(){let i=Object.assign(Object.assign(Object.assign({},t),yield this.getBaseEventRequest(Object.assign(Object.assign({},r),n))),{queryPipeline:this.provider.getPipeline(),actionCause:e}),o=yield this.coveoAnalyticsClient.makeClickEvent(i);return{description:this.makeEventDescription(o,e),log:({searchUID:e})=>o.log({searchQueryUid:e})}}))}logClickEvent(e,t,r,n){return ti(this,void 0,void 0,(function*(){return(yield this.makeClickEvent(e,t,r,n)).log({searchUID:this.provider.getSearchUID()})}))}getBaseSearchEventRequest(e,t){var r,n;return ti(this,void 0,void 0,(function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},t),(n=(r=this.provider).getGeneratedAnswerMetadata)===null||n===void 0?void 0:n.call(r)))),this.provider.getSearchEventRequestPayload()),{queryPipeline:this.provider.getPipeline(),actionCause:e})}))}getBaseEventRequest(e){return ti(this,void 0,void 0,(function*(){let t=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign(Object.assign({},this.getOrigins()),this.getSplitTestRun()),{customData:t,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})}))}getOrigins(){var e,t;return{originContext:(t=(e=this.provider).getOriginContext)===null||t===void 0?void 0:t.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof fa?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getSplitTestRun(){let e=this.provider.getSplitTestRunName?this.provider.getSplitTestRunName():"",t=this.provider.getSplitTestRunVersion?this.provider.getSplitTestRunVersion():"";return Object.assign(Object.assign({},e&&{splitTestRunName:e}),t&&{splitTestRunVersion:t})}makeLikeGeneratedAnswer(e){return this.makeCustomEvent(va.likeGeneratedAnswer,e)}logLikeGeneratedAnswer(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeLikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})}))}makeDislikeGeneratedAnswer(e){return this.makeCustomEvent(va.dislikeGeneratedAnswer,e)}logDislikeGeneratedAnswer(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeDislikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenGeneratedAnswerSource(e){return this.makeCustomEvent(va.openGeneratedAnswerSource,e)}logOpenGeneratedAnswerSource(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeOpenGeneratedAnswerSource(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerSourceHover(e){return this.makeCustomEvent(va.generatedAnswerSourceHover,e)}logGeneratedAnswerSourceHover(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerSourceHover(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerCopyToClipboard(e){return this.makeCustomEvent(va.generatedAnswerCopyToClipboard,e)}logGeneratedAnswerCopyToClipboard(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerCopyToClipboard(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerHideAnswers(e){return this.makeCustomEvent(va.generatedAnswerHideAnswers,e)}logGeneratedAnswerHideAnswers(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerHideAnswers(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerShowAnswers(e){return this.makeCustomEvent(va.generatedAnswerShowAnswers,e)}logGeneratedAnswerShowAnswers(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerShowAnswers(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerExpand(e){return this.makeCustomEvent(va.generatedAnswerExpand,e)}logGeneratedAnswerExpand(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerExpand(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerCollapse(e){return this.makeCustomEvent(va.generatedAnswerCollapse,e)}logGeneratedAnswerCollapse(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerCollapse(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerFeedbackSubmit(e){return this.makeCustomEvent(va.generatedAnswerFeedbackSubmit,e)}logGeneratedAnswerFeedbackSubmit(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerFeedbackSubmit(e)).log({searchUID:this.provider.getSearchUID()})}))}makeRephraseGeneratedAnswer(e){return this.makeSearchEvent(va.rephraseGeneratedAnswer,e)}logRephraseGeneratedAnswer(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeRephraseGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})}))}makeRetryGeneratedAnswer(){return this.makeSearchEvent(va.retryGeneratedAnswer)}logRetryGeneratedAnswer(){return ti(this,void 0,void 0,(function*(){return(yield this.makeRetryGeneratedAnswer()).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerStreamEnd(e){return this.makeCustomEvent(va.generatedAnswerStreamEnd,e)}logGeneratedAnswerStreamEnd(e){return ti(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerStreamEnd(e)).log({searchUID:this.provider.getSearchUID()})}))}},Oa=Object.assign({},Hi);Object.keys(Oa).map((e=>Oa[e]));var ka;(function(e){e.click="click",e.flowStart="flowStart"})(ka||(ka={}));var Aa;(function(e){e.enterInterface="ticket_create_start",e.fieldUpdate="ticket_field_update",e.fieldSuggestionClick="ticket_classification_click",e.suggestionClick="suggestion_click",e.suggestionRate="suggestion_rate",e.nextCaseStep="ticket_next_stage",e.caseCancelled="ticket_cancel",e.caseSolved="ticket_cancel",e.caseCreated="ticket_create"})(Aa||(Aa={}));var Ca;(function(e){e.quit="Quit",e.solved="Solved"})(Ca||(Ca={}));var ja=e=>new fa(e).getCurrentVisitorId(),Ra=new Ii.HistoryStore,Da=(e,t)=>typeof t=="function"?(...r)=>{let n=le(r[0]);try{return t.apply(t,r)}catch(t){return e.error(t,"Error in analytics preprocessRequest. Returning original request."),n}}:void 0,Ma=(e,t)=>(...r)=>{let n=le(r[1]);try{return t.apply(t,r)}catch(t){return e.error(t,"Error in analytics hook. Returning original request."),n}};var Ea=Mr((e=>e.source),(e=>[`@coveo/headless@${Rn}`].concat(Object.entries(e).map((([e,t])=>`${e}@${t}`)))));function xa(){return{desiredCount:5,numberOfValues:8,set:{}}}function Ta(e){let{activeValue:t,ancestryMap:r}=Ua(e);return t?Fa(t,r):[]}function Ua(e){let t=[...e],r=new Map;for(;t.length>0;){let e=t.shift();if(e.state==="selected")return{activeValue:e,ancestryMap:r};if(r)for(let t of e.children)r.set(t,e);t.unshift(...e.children)}return{}}function Fa(e,t){let r=[];if(!e)return[];let n=e;do{r.unshift(n),n=t.get(n)}while(n);return r}var $a=(e,t)=>e.categoryFacetSet[t]?.request;var Pa=(e,t)=>{let r=$a(e,t);return Ta(r?.currentValues??[])};function _a(){return{}}function Va(){return{}}function Qa(){return{}}function La(){return{}}function Na(e){return{facetSet:e.facetSet??La(),categoryFacetSet:e.categoryFacetSet??_a(),dateFacetSet:e.dateFacetSet??Va(),numericFacetSet:e.numericFacetSet??Qa(),automaticFacetSet:e.automaticFacetSet??xa()}}var Ya=e=>{let t=[];return Ba(e).forEach(((r,n)=>{let i=is(e,r.facetId),o=ts(r,n+1);if(Ha(r)){if(!!!Pa(e,r.facetId).length)return;t.push({...o,...Xa(e,r.facetId),facetType:i,state:"selected"});return}r.currentValues.forEach(((e,n)=>{if(e.state==="idle")return;let a=Ga(e,n+1,i),s=za(r)?Za(e):Ja(e);t.push({...o,...a,...s})}))})),Wa(e).forEach(((e,r)=>{let n=es(e,r+1);e.values.forEach(((e,r)=>{if(e.state==="idle")return;let i=Ga(e,r+1,"specific"),o=Za(e);t.push({...n,...i,...o})}))})),t},za=e=>e.type==="specific",Ha=e=>e.type==="hierarchical",Ba=e=>[...Object.values(e.facetSet),...Object.values(e.categoryFacetSet),...Object.values(e.dateFacetSet),...Object.values(e.numericFacetSet)].map((e=>e.request)),Wa=e=>[...Object.values(e.automaticFacetSet.set)].map((e=>e.response)),Ga=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),Ja=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),Za=e=>({displayValue:e.value,value:e.value}),Ka=(e,t)=>Pa(e,t).map((e=>e.value)).join(";"),Xa=(e,t)=>{let r=Ka(e,t);return{value:r,valuePosition:1,displayValue:r}},es=(e,t)=>({title:rs(e.field,e.field),field:e.field,id:e.field,facetPosition:t}),ts=(e,t)=>({title:rs(e.field,e.facetId),field:e.field,id:e.facetId,facetPosition:t}),rs=(e,t)=>`${e}_${t}`,ns=(e,t)=>e.facetSet[t]?.request||e.categoryFacetSet[t]?.request||e.dateFacetSet[t]?.request||e.numericFacetSet[t]?.request||e.automaticFacetSet.set[t]?.response,is=(e,t)=>{let r=ns(e,t);return r?r.type:"specific"};var os=()=>({q:"",enableQuerySyntax:!1});var as=(e=>(e.Ascending="ascending",e.Descending="descending",e))(as||{}),ss=(e=>(e.Relevancy="relevancy",e.QRE="qre",e.Date="date",e.Field="field",e.NoSort="nosort",e))(ss||{}),us=e=>{if(ne(e))return e.map((e=>us(e))).join(",");switch(e.by){case"relevancy":case"qre":case"nosort":return e.by;case"date":return`date ${e.order}`;case"field":return`@${e.field} ${e.order}`;default:return""}},cs=()=>({by:"relevancy"});new ee({values:{by:new ie({enum:ss,required:!0}),order:new ie({enum:as}),field:new K}});function ls(){return us(cs())}var ds=()=>"default";var hs=e=>{let t=e.configuration.search.locale.split("-")[0];return!t||t.length!==2?"en":t},fs=class{constructor(e){this.getState=e;this.state=e()}getLanguage(){return hs(this.state)}getBaseMetadata(){let{context:e,configuration:t}=this.state,r=e?.contextValues||{},n={};for(let[e,t]of Object.entries(r)){let r=`context_${e}`;n[r]=t}return t.analytics.analyticsMode==="legacy"&&(n.coveoHeadlessVersion=Rn),n}getOriginContext(){return this.state.configuration.analytics.originContext}getOriginLevel1(){return this.state.searchHub||ds()}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3}getIsAnonymous(){return this.state.configuration.analytics.anonymous}};var ps=class e extends fs{constructor(){super(...arguments);this.getFacetRequest=e=>this.state.facetSet?.[e]?.request||this.state.categoryFacetSet?.[e]?.request||this.state.dateFacetSet?.[e]?.request||this.state.numericFacetSet?.[e]?.request||this.state.automaticFacetSet?.set[e]?.response}getFacetState(){return Ya(Na(this.getState()))}getPipeline(){return this.state.pipeline||this.state.search?.response.pipeline||e.fallbackPipelineName}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.resultURIs,numberOfResults:this.numberOfResults}}getSearchUID(){let e=this.getState();return e.search?.searchResponseId||e.search?.response.searchUid||ge().response.searchUid}getSplitTestRunName(){return this.state.search?.response.splitTestRun}getSplitTestRunVersion(){let t=!!this.getSplitTestRunName(),r=this.state.search?.response.pipeline||this.state.pipeline||e.fallbackPipelineName;return t?r:void 0}getBaseMetadata(){let e=this.getState(),t=super.getBaseMetadata(),r=e.search?.response?.extendedResults?.generativeQuestionAnsweringId;return r&&(t.generativeQuestionAnsweringId=r),t}getFacetMetadata(e,t){let r=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),facetId:e,facetField:r,facetValue:t,facetTitle:`${r}_${e}`}}getFacetClearAllMetadata(e){let t=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),facetId:e,facetField:t,facetTitle:`${t}_${e}`}}getFacetUpdateSortMetadata(e,t){let r=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),facetId:e,facetField:r,criteria:t,facetTitle:`${r}_${e}`}}getRangeBreadcrumbFacetMetadata(e,t){let r=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),facetId:e,facetField:r,facetRangeEnd:t.end,facetRangeEndInclusive:t.endInclusive,facetRangeStart:t.start,facetTitle:`${r}_${e}`}}getResultSortMetadata(){return{...this.getBaseMetadata(),resultsSortBy:this.state.sortCriteria??ls()}}getStaticFilterToggleMetadata(e,t){return{...this.getBaseMetadata(),staticFilterId:e,staticFilterValue:t}}getStaticFilterClearAllMetadata(e){return{...this.getBaseMetadata(),staticFilterId:e}}getUndoTriggerQueryMetadata(e){return{...this.getBaseMetadata(),undoneQuery:e}}getCategoryBreadcrumbFacetMetadata(e,t){let r=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),categoryFacetId:e,categoryFacetField:r,categoryFacetPath:t,categoryFacetTitle:`${r}_${e}`}}getOmniboxAnalyticsMetadata(e,t){let r=this.state.querySuggest&&this.state.querySuggest[e],n=r.completions.map((e=>e.expression)),i=r.partialQueries.length-1,o=r.partialQueries[i]||"",a=r.responseId;return{...this.getBaseMetadata(),suggestionRanking:n.indexOf(t),partialQuery:o,partialQueries:r.partialQueries.length>0?r.partialQueries:"",suggestions:n.length>0?n:"",querySuggestResponseId:a}}getInterfaceChangeMetadata(){return{...this.getBaseMetadata(),interfaceChangeTo:this.state.configuration.analytics.originLevel2}}getOmniboxFromLinkMetadata(e){return{...this.getBaseMetadata(),...e}}getGeneratedAnswerMetadata(){let e=this.getState(),t={};return e.generatedAnswer?.isVisible!==void 0&&(t.showGeneratedAnswer=e.generatedAnswer.isVisible),t}get resultURIs(){return this.results?.map((e=>({documentUri:e.uri,documentUriHash:e.raw.urihash})))}get results(){return this.state.search?.response.results}get queryText(){return this.state.query?.q||os().q}get responseTime(){return this.state.search?.duration||ge().duration}get numberOfResults(){return this.state.search?.response.totalCountFiltered||ge().response.totalCountFiltered}};ps.fallbackPipelineName="default";var vs=ps,ys=({logger:e,getState:t,analyticsClientMiddleware:r=((e,t)=>t),preprocessRequest:n,provider:i=new vs(t)})=>{let o=t(),a=o.configuration.accessToken,s=o.configuration.analytics.apiBaseUrl,u=o.configuration.analytics.runtimeEnvironment,c=o.configuration.analytics.enabled,l=new qa({token:a,endpoint:s,runtimeEnvironment:u,preprocessRequest:Da(e,n),beforeSendHooks:[Ma(e,r),(t,r)=>(e.info({...r,type:t,endpoint:s,token:a},"Analytics request"),r)]},i);return c||l.disable(),l},gs=()=>{let e=Ra.getHistory().reverse().find((e=>e.name==="PageView"&&e.value));return e?e.value:""};var ms=async(e,t)=>{let r=e.analyticsMode==="next",n=e.originLevel3==="default";return{analytics:{clientId:await ja(e),clientTimestamp:(new Date).toISOString(),documentReferrer:r&&n?null:e.originLevel3,originContext:e.originContext,...t&&{actionCause:t.actionCause,customData:t.customData},...t&&!r&&{customData:t.customData},...e.userDisplayName&&{userDisplayName:e.userDisplayName},...e.documentLocation&&{documentLocation:e.documentLocation},...e.deviceId&&{deviceId:e.deviceId},...gs()&&{pageId:gs()},...r&&e.trackingId&&{trackingId:e.trackingId},capture:r,...r&&{source:Ea(e)}}}};var ws=()=>({duration:0,error:null,isLoading:!1,id:"Recommendation",recommendations:[],searchUid:"",splitTestRun:"",pipeline:""});var bs=class extends fs{getPipeline(){return this.state.pipeline||this.state.recommendation?.pipeline||"default"}getSearchEventRequestPayload(){return{queryText:os().q,responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){return this.getState().recommendation?.searchUid||ws().searchUid}getSplitTestRunName(){return this.state.recommendation?.splitTestRun}getSplitTestRunVersion(){let e=!!this.getSplitTestRunName(),t=this.state.recommendation?.pipeline||this.state.pipeline||"default";return e?t:void 0}get responseTime(){return this.state.recommendation?.duration||ws().duration}mapResultsToAnalyticsDocument(){return this.state.recommendation?.recommendations.map((e=>({documentUri:e.uri,documentUriHash:e.raw.urihash})))}get numberOfResults(){return this.state.recommendation?.recommendations.length||ws().recommendations.length}};function Ss({config:e,environment:t,event:r,listenerManager:n}){let{url:i,token:o,mode:a}=e;a!=="disabled"&&(n.call(r),t.send(i,o,r))}var Is=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function qs(e){return typeof e=="string"&&Is.test(e)}function Os(e){let t="visitorId";return{getClientId:()=>{let r=e.get(),n=r.storage,i=n.getItem(t),o=i&&qs(i)?i:r.generateUUID();return n.setItem(t,o),o},clear:()=>{e.get().storage.removeItem(t)}}}var ks="0.7.7";function As(e){let{trackingId:t}=e;return{trackingId:t}}function Cs(e){return(e.source||[]).concat([`relay@${ks}`])}function js(e,t,r,n){let{getReferrer:i,getLocation:o,getUserAgent:a}=r,s=As(t),u=n.getClientId();return Object.freeze({type:e,config:s,ts:Date.now(),source:Cs(t),clientId:u,userAgent:a(),referrer:i(),location:o()})}function Rs(e,t,r,n,i){return{...t,meta:js(e,r,n,i)}}var Ds="*";function Ms(){let e=[];function t({type:t,callback:r}){return e.findIndex((e=>e.type===t&&e.callback===r))}function r(e,t){return e.type==="*"||t===e.type}function n(r){return t(r)<0&&e.push(r),()=>s(r.type,r.callback)}function i(t){e.forEach((e=>{if(r(e,t.meta.type))try{e.callback(t)}catch(e){console.error(e)}}))}function o(t){if(t===Ds)e.length=0;else for(let r=e.length-1;r>=0;r--)e[r].type===t&&e.splice(r,1)}function a(r){let n=t(r);n>=0&&e.splice(n,1)}function s(e,t){t?a({type:e,callback:t}):o(e)}return{add:n,call:i,remove:s}}function Es({url:e,token:t,trackingId:r,...n}){return Object.freeze({url:e,token:t,trackingId:r,...!!n.mode&&{mode:n.mode},...!!n.source&&{source:n.source}})}function xs(e){let t=Es(e);return{get:()=>t,update:e=>{t=Es({...t,...e})}}}function Ts(){let e=typeof window<"u";return{sendMessage(t){e&&window.postMessage(t,"*")}}}var Us=Fs();function Fs(){let e="coveo_",t=e=>{let t=e.split(".").slice(-2);return t.length==2?t.join("."):""};return{getItem(t){let r=`${e}${t}=`,n=document.cookie.split(";");for(let e of n){let t=e.replace(/^\s+/,"");if(t.lastIndexOf(r,0)===0)return t.substring(r.length,t.length)}return null},setItem(r,n,i){let o=t(window.location.hostname),a=`;expires=${new Date((new Date).getTime()+i).toUTCString()}`,s=o?`;domain=${o}`:"";document.cookie=`${e}${r}=${n}${a}${s};path=/;SameSite=Lax`},removeItem(e){this.setItem(e,"",-1)}}}function $s(){return{getItem(e){return Us.getItem(e)||localStorage.getItem(e)},removeItem(e){Us.removeItem(e),localStorage.removeItem(e)},setItem(e,t){localStorage.setItem(e,t),Us.setItem(e,t,31556952e3)}}}function Ps(){let e=document.referrer;return e===""?null:e}function _s(){return{runtime:"browser",send:(e,t,r)=>{let n=navigator.sendBeacon(`${e}?access_token=${t}`,new Blob([JSON.stringify([r])],{type:"application/json"}));if(Ts().sendMessage({kind:"EVENT_PROTOCOL",event:r,url:e,token:t}),!n)throw new Error("Failed to send the event(s) because the payload size exceeded the maximum allowed size (32 KB). Please contact support if the problem persists.")},getReferrer:()=>Ps(),getLocation:()=>window.location.href,getUserAgent:()=>navigator.userAgent,generateUUID:()=>crypto.randomUUID(),storage:$s()}}function Vs(){return{getItem(){return null},removeItem(){},setItem(){}}}function Qs(){return{runtime:"null",send:()=>{},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>"",storage:Vs()}}function Ls(e){return e.get().mode!=="disabled"&&Ns()?_s():Qs()}function Ns(){try{return typeof window=="object"}catch{return!1}}function Ys(e){return{get:()=>Object.freeze(Ls(e))}}function zs(e){let t=xs(e),r=Ms(),n=Ys(t),i=Os(n);return{emit:(e,o)=>{let a=t.get(),s=n.get(),u=Rs(e,o,a,s,i);return Ss({config:a,environment:s,event:u,listenerManager:r})},getMeta:e=>js(e,t.get(),n.get(),i),on:(e,t)=>r.add({type:e,callback:t}),off:(e,t)=>r.remove(e,t),updateConfig:e=>t.update(e),version:ks,clearStorage:()=>{i.clear()}}}var Hs=Mr((e=>e.configuration.accessToken),(e=>e.configuration.analytics),(e=>Ea(e.configuration.analytics)),((e,{trackingId:t,nextApiBaseUrl:r,enabled:n},i)=>zs({mode:n?"emit":"disabled",url:r,token:e,trackingId:t,source:i})));var Bs=()=>({url:"",clientId:"",additionalFields:[],advancedParameters:{debug:!1},products:[],facets:{results:[]},error:null,isLoading:!1,responseId:""});var Ws=class extends fs{constructor(){super(...arguments);this.initialState=Bs()}getPipeline(){return""}getSearchEventRequestPayload(){return{queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){return this.getState().productListing?.responseId||this.initialState.responseId}mapResultsToAnalyticsDocument(){return this.state.productListing?.products.map((e=>({documentUri:e.documentUri,documentUriHash:e.documentUriHash,permanentid:e.permanentid})))}get numberOfResults(){return this.state.productListing.products.length}},Gs=({logger:e,getState:t,analyticsClientMiddleware:r=((e,t)=>t),preprocessRequest:n,provider:i=new Ws(t)})=>{let o=t(),a=o.configuration.accessToken,s=o.configuration.analytics.apiBaseUrl,u=o.configuration.analytics.runtimeEnvironment,c=o.configuration.analytics.enabled,l=new qa({token:a,endpoint:s,runtimeEnvironment:u,preprocessRequest:Da(e,n),beforeSendHooks:[Ma(e,r),(t,r)=>(e.info({...r,type:t,endpoint:s,token:a},"Analytics request"),r)]},i);return c||l.disable(),l};function Js(e){let t=Zs(e),r=[e,...t].filter((e=>e.parentResult)).map((e=>e.parentResult));return ae([e,...t,...r],(e=>e.uniqueId))}function Zs(e){return e.childResults?e.childResults.flatMap((e=>[e,...Zs(e)])):[]}function Ks(e,t){return{...new vs(t).getBaseMetadata(),actionCause:e,type:e}}function Xs(e){return Object.assign(e,{instantlyCallable:!0})}function eu(e,t){let r=t=>Xs(cn(e,t)),n=r((async(e,{getState:r,extra:n})=>{let{analyticsClientMiddleware:i,preprocessRequest:o,logger:a}=n;return await(await t({getState:r,analyticsClientMiddleware:i,preprocessRequest:o,logger:a})).log({state:r(),extra:n})}));return Object.assign(n,{prepare:async({getState:e,analyticsClientMiddleware:n,preprocessRequest:i,logger:o})=>{let{description:a,log:s}=await t({getState:e,analyticsClientMiddleware:n,preprocessRequest:i,logger:o});return{description:a,action:r((async(e,{getState:t,extra:r})=>await s({state:t(),extra:r})))}}}),n}var tu=(e,t,r)=>{function n(...n){let i=n.length===1?{...n[0],__legacy__getBuilder:t(n[0].__legacy__getBuilder),analyticsConfigurator:e,providerClass:r}:{prefix:n[0],__legacy__getBuilder:t(n[1]),__legacy__provider:n[2],analyticsConfigurator:e,providerClass:r};return iu(i)}return n},ru=e=>e.configuration.analytics.analyticsMode==="legacy",nu=e=>e.configuration.analytics.analyticsMode==="next",iu=({prefix:e,__legacy__getBuilder:t,__legacy__provider:r,analyticsPayloadBuilder:n,analyticsType:i,analyticsConfigurator:o,providerClass:a})=>(r??(r=e=>new a(e)),eu(e,(async({getState:e,analyticsClientMiddleware:a,preprocessRequest:s,logger:u})=>{let c=[],l={log:async({state:e})=>{for(let t of c)await t(e)}},d=e(),h=o({getState:e,logger:u,analyticsClientMiddleware:a,preprocessRequest:s,provider:r(e)}),f=await t(h,e());l.description=f?.description,c.push((async e=>{ru(e)&&await ou(f,r,e,u,h.coveoAnalyticsClient)}));let{emit:p}=Hs(d);return c.push((async e=>{if(nu(e)&&i&&n){let t=n(e);await Su(p,i,t)}})),l})));async function ou(e,t,r,n,i){t((()=>r));let o=await(e?.log({searchUID:t((()=>r)).getSearchUID()}));n.info({client:i,response:o},"Analytics response")}var au=tu(ys,(e=>e),vs);var su=tu(Gs,(e=>e),Ws);var uu=(e,t)=>{let r=e=>e+(t.pagination?.firstResult??0),n=-1,i=t.search?.results;return n=bu(e,i),n<0&&(n=wu(e,i)),n<0&&(n=0),lu(e,r(n),t)},cu=(e,t)=>{let r=t.recommendation?.recommendations.findIndex((({uniqueId:t})=>e.uniqueId===t))||0;return lu(e,r,t)};function lu(e,t,r){let n=e.raw.collection;return{collectionName:typeof n=="string"?n:"default",documentAuthor:yu(e),documentPosition:t+1,documentTitle:e.title,documentUri:e.uri,documentUriHash:e.raw.urihash,documentUrl:e.clickUri,rankingModifier:e.rankingModifier||"",sourceName:gu(e),queryPipeline:r.pipeline||Kn()}}var du=e=>(e.raw.permanentid||console.warn("Missing field permanentid on result. This might cause many issues with your Coveo deployment. See https://docs.coveo.com/en/1913 and https://docs.coveo.com/en/1640 for more information.",e),{contentIDKey:"permanentid",contentIDValue:e.raw.permanentid||""}),hu={urihash:new K,sourcetype:new K,permanentid:new K},fu={uniqueId:wn,raw:new ee({values:hu}),title:wn,uri:wn,clickUri:wn,rankingModifier:new K({required:!1,emptyAllowed:!0})};function pu(e){return Object.assign({},...Object.keys(hu).map((t=>({[t]:e[t]}))))}function vu(e){return Object.assign({},...Object.keys(fu).map((t=>({[t]:e[t]}))),{raw:pu(e.raw)})}function yu(e){let t=e.raw.author;return Y(t)?"unknown":Array.isArray(t)?t.join(";"):`${t}`}function gu(e){let t=e.raw.source;return Y(t)?"unknown":t}var mu=e=>new V(fu).validate(vu(e));function wu(e,t){for(let[r,n]of t.entries()){let t=Js(n);if(bu(e,t)!==-1)return r}return-1}function bu(e,t=[]){return t.findIndex((({uniqueId:t})=>t===e.uniqueId))}async function Su(e,t,r){await e(t,r)}var Iu=()=>au("analytics/recommendation/update",(e=>e.makeRecommendationInterfaceLoad()),(e=>new bs(e))),qu=()=>({actionCause:"recommendationInterfaceLoad"}),Ou=e=>au({prefix:"analytics/recommendation/open",__legacy__getBuilder:(t,r)=>(mu(e),t.makeRecommendationOpen(cu(e,r),du(e))),__legacy__provider:e=>new bs(e),analyticsType:"itemClick",analyticsPayloadBuilder:t=>{let r=uu(e,t),n=du(e);return{searchUid:t.search?.response.searchUid??"",position:r.documentPosition,itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}});var ku=_r("recommendation/set",(e=>An(e,{id:wn}))),Au=cn("recommendation/get",(async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let i=t(),o=(new Date).getTime(),a=await Cu(i),s=await n.recommendations(a),u=(new Date).getTime()-o;return tt(s)?r(s.error):{recommendations:s.success.results,analyticsAction:Iu(),duration:u,searchUid:s.success.searchUid,splitTestRun:s.success.splitTestRun,pipeline:s.success.pipeline}})),Cu=async e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,recommendation:e.recommendation.id,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,locale:e.configuration.search.locale,actionsHistory:e.configuration.analytics.enabled?Ra.getHistory():[],...e.advancedSearchQueries&&{aq:e.advancedSearchQueries.aq,cq:e.advancedSearchQueries.cq},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub},...e.context&&{context:e.context.contextValues},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.fields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.configuration.analytics.enabled&&{visitorId:await ja(e.configuration.analytics)},...e.configuration.analytics.enabled&&await ju(e,qu()),...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")},...e.pagination&&{numberOfResults:e.pagination.numberOfResults}}),ju=async(e,t)=>{let r=e.configuration.analytics.analyticsMode==="legacy"?void 0:{actionCause:t.actionCause,type:t.actionCause};return await ms(e.configuration.analytics,r)};var Ru=Xr(ws(),(e=>{e.addCase(ku,((e,t)=>{e.id=t.payload.id})).addCase(Au.rejected,((e,t)=>{e.error=t.payload?t.payload:null,e.isLoading=!1})).addCase(Au.fulfilled,((e,t)=>{e.error=null,e.recommendations=t.payload.recommendations,e.duration=t.payload.duration,e.isLoading=!1,e.searchUid=t.payload.searchUid,e.splitTestRun=t.payload.splitTestRun,e.pipeline=t.payload.pipeline})).addCase(Au.pending,(e=>{e.isLoading=!0}))}));var Du=_r("searchHub/set",(e=>An(e,new K({required:!0,emptyAllowed:!0}))));var Mu=Xr(ds(),(e=>{e.addCase(Du,((e,t)=>t.payload)).addCase(Zn.fulfilled,((e,t)=>t.payload?.searchHub??e)).addCase(Tn,((e,t)=>t.payload.searchHub||e))}));var Eu=Xr(Rn,(e=>e));function xu(){return typeof window<"u"&&typeof document<"u"}function Tu(e){let t=e.payload?.analyticsAction;return Uu(e)&&!Y(t)}function Uu(e){return"type"in e}var Fu=e=>t=>r=>{let n;Tu(r)&&(n=r.payload.analyticsAction,delete r.payload.analyticsAction);let i=t(r);return Uu(r)&&(r.type==="search/executeSearch/fullfilled"&&n===void 0&&console.error("No analytics action associated with search:",r),r.type==="recommendation/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with recommendation:",r),r.type==="productRecommendations/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with product recommendation:",r)),n!==void 0&&e.dispatch(n),i};var $u=d(C());_r("tab/register",(e=>{let t=new ee({values:{id:wn,expression:Sn}});return An(e,t)}));var Pu=_r("tab/updateActiveTab",(e=>An(e,wn)));var _u=d(j()),Vu=d(R()),Qu=d(D());_u.default.extend(Qu.default);_u.default.extend(Vu.default);var Lu="/rest/search/v2",Nu="/rest/ua",Yu=()=>({organizationId:"",accessToken:"",platformUrl:Fe(),search:{apiBaseUrl:`${Fe()}${Lu}`,locale:"en-US",timezone:_u.default.tz.guess(),authenticationProviders:[]},analytics:{enabled:!0,apiBaseUrl:`${$e()}${Nu}`,nextApiBaseUrl:"",originContext:"Search",originLevel2:"default",originLevel3:"default",anonymous:!1,deviceId:"",userDisplayName:"",documentLocation:"",trackingId:"",analyticsMode:"legacy",source:{}}});function zu(e,t){if(Ne(e))return e.replace(/^(https:\/\/)platform/,"$1analytics")+Nu;let r=Ye(e,t);return r?Ue(t,r.environment).analytics:e}var Hu=Xr(Yu(),(e=>e.addCase(xn,((e,t)=>{t.payload.accessToken&&(e.accessToken=t.payload.accessToken),t.payload.organizationId&&(e.organizationId=t.payload.organizationId),t.payload.platformUrl&&(e.platformUrl=t.payload.platformUrl,e.search.apiBaseUrl=`${t.payload.platformUrl}${Lu}`,e.analytics.apiBaseUrl=zu(t.payload.platformUrl,e.organizationId))})).addCase(Tn,((e,t)=>{t.payload.apiBaseUrl&&(e.search.apiBaseUrl=t.payload.apiBaseUrl),t.payload.locale&&(e.search.locale=t.payload.locale),t.payload.timezone&&(e.search.timezone=t.payload.timezone),t.payload.authenticationProviders&&(e.search.authenticationProviders=t.payload.authenticationProviders)})).addCase(Fn,((e,t)=>{Y(t.payload.enabled)||(e.analytics.enabled=t.payload.enabled),Y(t.payload.originContext)||(e.analytics.originContext=t.payload.originContext),Y(t.payload.originLevel2)||(e.analytics.originLevel2=t.payload.originLevel2),Y(t.payload.originLevel3)||(e.analytics.originLevel3=t.payload.originLevel3),Y(t.payload.apiBaseUrl)||(e.analytics.apiBaseUrl=t.payload.apiBaseUrl),Y(t.payload.nextApiBaseUrl)||(e.analytics.nextApiBaseUrl=t.payload.nextApiBaseUrl),Y(t.payload.trackingId)||(e.analytics.trackingId=t.payload.trackingId),Y(t.payload.analyticsMode)||(e.analytics.analyticsMode=t.payload.analyticsMode),Y(t.payload.source)||(e.analytics.source=t.payload.source);let r=(0,$u.default)();r&&(e.analytics.analyticsMode="next",e.analytics.trackingId=r),Y(t.payload.runtimeEnvironment)||(e.analytics.runtimeEnvironment=t.payload.runtimeEnvironment),Y(t.payload.anonymous)||(e.analytics.anonymous=t.payload.anonymous),Y(t.payload.deviceId)||(e.analytics.deviceId=t.payload.deviceId),Y(t.payload.userDisplayName)||(e.analytics.userDisplayName=t.payload.userDisplayName),Y(t.payload.documentLocation)||(e.analytics.documentLocation=t.payload.documentLocation)})).addCase($n,(e=>{e.analytics.enabled=!1})).addCase(Pn,(e=>{e.analytics.enabled=!0})).addCase(_n,((e,t)=>{e.analytics.originLevel2=t.payload.originLevel2})).addCase(Vn,((e,t)=>{e.analytics.originLevel3=t.payload.originLevel3})).addCase(Pu,((e,t)=>{e.analytics.originLevel2=t.payload})).addCase(Ln,((e,t)=>{e.analytics.originLevel2=t.payload.tab||e.analytics.originLevel2}))));var Bu=Hu;function Wu(e){return e.instantlyCallable}var Gu=()=>e=>t=>e(Wu(t)?t():t);var Ju=e=>()=>t=>r=>{let n=r;if(!n.error)return t(r);let i=n.error;if(n.payload?.ignored||e.error(i.stack||i.message||i.name||"Error",`Action dispatch error ${n.type}`,r),n.error.name!=="SchemaValidationError")return t(r)},Zu=e=>t=>r=>n=>(e.debug({action:n,nextState:t.getState()},`Action dispatched: ${n.type}`),r(n));var Ku=()=>({referrer:document.referrer,userAgent:navigator.userAgent,location:window.location.href}),Xu=()=>({referrer:"default",userAgent:"Node.js",location:"default"});function ec(e,t){let r={...e},n,i=e=>(t,r)=>{let i=e(t,r);return n?n(i,r):i};return{get combinedReducer(){let e=ce(Object.entries(t).filter((([e])=>!(e in r))).map((([e,t])=>[e,()=>t])));return i(wt({...e,...r}))},containsAll(e){return Object.keys(e).every((e=>e in r))},add(e){Object.keys(e).filter((e=>!(e in r))).forEach((t=>r[t]=e[t]))},addCrossReducer(e){n=e}}}function tc(e,t,r){var n,i,o;t===void 0&&(t=50),r===void 0&&(r={});var a=(n=r.isImmediate)!=null&&n,s=(i=r.callback)!=null&&i,u=r.maxWait,c=Date.now(),l=[];function d(){if(u!==void 0){var e=Date.now()-c;if(e+t>=u)return u-e}return t}var h=function(){var t=[].slice.call(arguments),r=this;return new Promise((function(n,i){var u=a&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout((function(){if(o=void 0,c=Date.now(),!a){var n=e.apply(r,t);s&&s(n),l.forEach((function(e){return(0,e.resolve)(n)})),l=[]}}),d()),u){var h=e.apply(r,t);return s&&s(h),n(h)}l.push({resolve:n,reject:i})}))};return h.cancel=function(e){o!==void 0&&clearTimeout(o),l.forEach((function(t){return(0,t.reject)(e)})),l=[]},h}function rc(e,t){let r=0,n=tc((()=>r=0),500);return i=>o=>async a=>{if(!(typeof a=="function"))return o(a);let s=await o(a);if(!nc(s))return s;if(typeof t!="function")return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),s;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),s;r++,n();let u=await ic(t);i.dispatch(xn({accessToken:u})),i.dispatch(a)}}function nc(e){return e?.error?.name===(new Ce).name}async function ic(e){try{return await e()}catch{return""}}function oc({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:n,name:i}){return Jr({reducer:e,preloadedState:t,devTools:{stateSanitizer:e=>e.history?{...e,history:"<<OMIT>>"}:e,name:i,shouldHotReload:!1},middleware:e=>e({thunk:{extraArgument:n}}).prepend(...r).concat(Zu(n.logger))})}var ac={configuration:Bu,version:Eu};function sc(e,t){let r=e.organizationEndpoints?.analytics||void 0,{analyticsClientMiddleware:n,...i}=e.analytics??{},o={...i,nextApiBaseUrl:`${r}/rest/organizations/${e.organizationId}/events/v1`,apiBaseUrl:r};if(ue())return t.info("Analytics disabled since doNotTrack is active."),{...o,enabled:!1};if(o.analyticsMode==="next"&&!i.trackingId)throw new vc('analytics.trackingId is required when analytics.analyticsMode="next"');return o}function uc(e,t){let r=cc(e,t),{accessToken:n,organizationId:i}=e.configuration,{organizationEndpoints:o}=e.configuration,a=o?.platform||e.configuration.platformUrl;fc(e.configuration)&&r.logger.warn(`The \`platformUrl\` (${e.configuration.platformUrl}) option will be deprecated in the next major version. Consider using the \`organizationEndpoints\` option instead. See [Organization endpoints](https://docs.coveo.com/en/mcc80216).`),hc(e.configuration)?r.logger.warn("The `organizationEndpoints` options was not explicitly set in the Headless engine configuration. Coveo recommends setting this option, as it has resiliency benefits and simplifies the overall configuration for multi-region deployments. See [Organization endpoints](https://docs.coveo.com/en/mcc80216)."):pc(e.configuration)&&r.logger.warn(`There is a mismatch between the \`organizationId\` option (${e.configuration.organizationId}) and the organization configured in the \`organizationEndpoints\` option (${e.configuration.organizationEndpoints?.platform}). This could lead to issues that are complex to troubleshoot. Please make sure both values match.`),r.dispatch(xn({accessToken:n,organizationId:i,platformUrl:a}));let s=sc(e.configuration,r.logger);return s&&r.dispatch(Fn(s)),r}function cc(e,t){let{reducers:r}=e,n=ec({...ac,...r},e.preloadedState??{});e.crossReducer&&n.addCrossReducer(e.crossReducer);let i=t.logger,o=e.navigatorContextProvider??xu()?Ku:Xu,a={...t,get relay(){return Hs(u.state)},get navigatorContext(){return o()}},s=lc(e,a,n),u={addReducers(e){n.containsAll(e)||(n.add(e),s.replaceReducer(n.combinedReducer))},dispatch:s.dispatch,subscribe:s.subscribe,enableAnalytics(){s.dispatch(Pn())},disableAnalytics(){s.dispatch($n())},get state(){return s.getState()},get relay(){return Hs(this.state)},get navigatorContext(){return o()},logger:i,store:s};return u}function lc(e,t,r){let{preloadedState:n,configuration:i}=e,o=i.name||"coveo-headless",a=dc(e,t.logger);return oc({preloadedState:n,reducer:r.combinedReducer,middlewares:a,thunkExtraArguments:t,name:o})}function dc(e,t){let{renewAccessToken:r}=e.configuration,n=rc(t,r);return[Gu,n,Ju(t),Fu].concat(e.middlewares||[])}function hc(e){return L(e.organizationEndpoints)}function fc(e){return!Y(e.platformUrl)||Y(e.organizationEndpoints?.platform)}function pc(e){let{platform:t}=e.organizationEndpoints;if(L(t))return!1;let r=ze(t);return r&&r.organizationId!==e.organizationId}var vc=class extends Error{constructor(e){super(e),this.name="InvalidEngineConfiguration"}};var yc=d(E());function gc(e){return(0,yc.default)({name:"@coveo/headless",level:e?.level||"warn",formatters:{log:e?.logFormatter}})}function mc(e,t){let r=wc(e),n=kn,i=bc(e);return{analyticsClientMiddleware:r,validatePayload:n,preprocessRequest:i,logger:t}}function wc(e){let{analytics:t}=e,r=(e,t)=>t;return t?.analyticsClientMiddleware||r}function bc(e){return e.preprocessRequest||ve}var Sc={organizationId:wn,accessToken:wn,platformUrl:new K({required:!1,emptyAllowed:!1}),name:new K({required:!1,emptyAllowed:!1}),analytics:new ee({options:{required:!1},values:{enabled:new W({required:!1}),originContext:new K({required:!1}),originLevel2:new K({required:!1}),originLevel3:new K({required:!1}),analyticsMode:new K({constrainTo:["legacy","next"],required:!1})}})};var Ic=new V({...Sc,pipeline:new K({required:!1,emptyAllowed:!0}),searchHub:bn,locale:bn,timezone:bn});var qc={debug:Hn,pipeline:Xn,searchHub:Mu,recommendation:Ru};function Oc(e){let t=gc(e.loggerOptions);kc(e.configuration,t);let r=Ac(e.configuration,t),n={...mc(e.configuration,t),apiClient:r},i={...e,reducers:qc},o=uc(i,n),{pipeline:a,searchHub:s,timezone:u,locale:c}=e.configuration;return o.dispatch(Tn({timezone:u,locale:c})),Y(a)||o.dispatch(Bn(a)),Y(s)||o.dispatch(Du(s)),{...o,get state(){return o.state}}}function kc(e,t){try{Ic.validate(e)}catch(e){throw t.error(e,"Recommendation engine configuration error"),e}}function Ac(e,t){return new Xe({logger:t,preprocessRequest:e.preprocessRequest||ve,postprocessSearchResponseMiddleware:st,postprocessFacetSearchResponseMiddleware:ut,postprocessQuerySuggestResponseMiddleware:ct})}function Cc(e){return e.addReducers({configuration:Bu}),{disableAnalytics:$n,enableAnalytics:Pn,setOriginLevel2:_n,setOriginLevel3:Vn,updateAnalyticsConfiguration:Fn,updateBasicConfiguration:xn}}function jc(e){return e.addReducers({configuration:Bu,pipeline:Xn,searchHub:Mu}),{updateSearchConfiguration:Tn}}var Rc=()=>new K({required:!1,emptyAllowed:!0}),Dc=_r("advancedSearchQueries/update",(e=>An(e,{aq:Rc(),cq:Rc(),lq:Rc(),dq:Rc()}))),Mc=_r("advancedSearchQueries/register",(e=>An(e,{aq:Rc(),cq:Rc(),lq:Rc(),dq:Rc()})));var Ec=()=>({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,lq:"",lqWasSet:!1,dq:"",dqWasSet:!1,defaultFilters:{cq:"",aq:"",lq:"",dq:""}});Xr(Ec(),(e=>{e.addCase(Dc,((e,t)=>{let{aq:r,cq:n,lq:i,dq:o}=t.payload;L(r)||(e.aq=r,e.aqWasSet=!0),L(n)||(e.cq=n,e.cqWasSet=!0),L(i)||(e.lq=i,e.lqWasSet=!0),L(o)||(e.dq=o,e.dqWasSet=!0)})).addCase(Mc,((e,t)=>{let{aq:r,cq:n,lq:i,dq:o}=t.payload;L(r)||(e.defaultFilters.aq=r,e.aqWasSet||(e.aq=r)),L(n)||(e.defaultFilters.cq=n,e.cqWasSet||(e.cq=n)),L(i)||(e.defaultFilters.lq=i,e.lqWasSet||(e.lq=i)),L(o)||(e.defaultFilters.dq=o,e.dqWasSet||(e.dq=o))})).addCase(Zn.fulfilled,((e,t)=>t.payload?.advancedSearchQueries??e)).addCase(Ln,((e,t)=>{let{aq:r,cq:n}=t.payload;L(r)||(e.aq=r,e.aqWasSet=!0),L(n)||(e.cq=n,e.cqWasSet=!0)}))}));var xc=new re({each:wn,required:!0}),Tc=(e,t)=>(An(e,wn),X(t)?An(t,wn):An(t,xc),{payload:{contextKey:e,contextValue:t}}),Uc=_r("context/set",(e=>{for(let[t,r]of Object.entries(e))Tc(t,r);return{payload:e}})),Fc=_r("context/add",(e=>Tc(e.contextKey,e.contextValue))),$c=_r("context/remove",(e=>An(e,wn)));function Pc(){return{contextValues:{}}}Xr(Pc(),(e=>{e.addCase(Uc,((e,t)=>{e.contextValues=t.payload})).addCase(Fc,((e,t)=>{e.contextValues[t.payload.contextKey]=t.payload.contextValue})).addCase($c,((e,t)=>{delete e.contextValues[t.payload]})).addCase(Zn.fulfilled,((e,t)=>{t.payload&&(e.contextValues=t.payload.context.contextValues)}))}));var _c=_r("dictionaryFieldContext/set",(e=>{let t=new ee({options:{required:!0}}),r=An(e,t).error;if(r)return{payload:e,error:r};let n=Object.values(e),i=new re({each:Sn}),o=An(n,i).error;return o?{payload:e,error:o}:{payload:e}})),Vc=_r("dictionaryFieldContext/add",(e=>{let t=new ee({options:{required:!0},values:{field:Sn,key:Sn}});return An(e,t)})),Qc=_r("dictionaryFieldContext/remove",(e=>An(e,Sn)));function Lc(){return{contextValues:{}}}Xr(Lc(),(e=>{e.addCase(_c,((e,t)=>{e.contextValues=t.payload})).addCase(Vc,((e,t)=>{let{field:r,key:n}=t.payload;e.contextValues[r]=n})).addCase(Qc,((e,t)=>{delete e.contextValues[t.payload]})).addCase(Zn.fulfilled,((e,t)=>{t.payload&&(e.contextValues=t.payload.dictionaryFieldContext.contextValues)}))}));var Nc=async(e,t)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await ja(e.configuration.analytics),actionsHistory:Ra.getHistory()},...e.advancedSearchQueries?.aq&&{aq:e.advancedSearchQueries.aq},...e.advancedSearchQueries?.cq&&{cq:e.advancedSearchQueries.cq},...e.advancedSearchQueries?.lq&&{lq:e.advancedSearchQueries.lq},...e.advancedSearchQueries?.dq&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await ms(e.configuration.analytics,t),...e.excerptLength&&!Y(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});var Yc=async(e,t)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await ja(e.configuration.analytics),actionsHistory:Ra.getHistory()},...e.advancedSearchQueries?.aq&&{aq:e.advancedSearchQueries.aq},...e.advancedSearchQueries?.cq&&{cq:e.advancedSearchQueries.cq},...e.advancedSearchQueries?.lq&&{lq:e.advancedSearchQueries.lq},...e.advancedSearchQueries?.dq&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await ms(e.configuration.analytics,t),...e.excerptLength&&!Y(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});var zc={collectionField:new K({emptyAllowed:!1,required:!1}),parentField:new K({emptyAllowed:!1,required:!1}),childField:new K({emptyAllowed:!1,required:!1}),numberOfFoldedResults:new z({min:0,required:!1})},Hc=_r("folding/register",(e=>An(e,zc)));cn("folding/loadCollection",(async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let i=t(),o=i.configuration.analytics.analyticsMode==="legacy"?await Nc(i):await Yc(i),a=await n.search({...o,q:Bc(i),enableQuerySyntax:!0,cq:`@${i.folding.fields.collection}="${e}"`,filterField:i.folding.fields.collection,childField:i.folding.fields.parent,parentField:i.folding.fields.child,filterFieldRange:100},{origin:"foldingCollection"});return tt(a)?r(a.error):{collectionId:e,results:a.success.results,rootResult:i.folding.collections[e].result}}));function Bc(e){return e.query.q===""?"":e.query.enableQuerySyntax?`${e.query.q} OR @uri`:`( <@- ${e.query.q} -@> ) OR @uri`}var Wc=()=>({enabled:!1,fields:{collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"},filterFieldRange:2,collections:{}});var Gc=_r("fields/registerFieldsToInclude",(e=>An(e,In))),Jc=_r("fields/fetchall/enable"),Zc=_r("fields/fetchall/disable"),Kc=cn("fields/fetchDescription",(async(e,{extra:t,getState:r,rejectWithValue:n})=>{let i=r(),{accessToken:o,organizationId:a}=i.configuration,{apiBaseUrl:s}=i.configuration.search,u=await t.apiClient.fieldDescriptions({accessToken:o,organizationId:a,url:s});return tt(u)?n(u.error):u.success.fields}));var Xc=["author","language","urihash","objecttype","collection","source","permanentid"],el=[...Xc,"date","filetype","parents"],tl=[...el,"ec_price","ec_name","ec_description","ec_brand","ec_category","ec_item_group_id","ec_shortdesc","ec_thumbnails","ec_images","ec_promo_price","ec_in_stock","ec_rating"],rl=()=>({fieldsToInclude:Xc,fetchAllFields:!1,fieldsDescription:[]});var nl=Xr(rl(),(e=>e.addCase(Gc,((e,t)=>{e.fieldsToInclude=[...new Set(e.fieldsToInclude.concat(t.payload))]})).addCase(Jc,(e=>{e.fetchAllFields=!0})).addCase(Zc,(e=>{e.fetchAllFields=!1})).addCase(Kc.fulfilled,((e,{payload:t})=>{e.fieldsDescription=t})).addCase(Hc,((e,{payload:t})=>{let r=Wc().fields;e.fieldsToInclude.push(t.collectionField??r.collection,t.parentField??r.parent,t.childField??r.child)}))));function il(e){return e.addReducers({fields:nl}),{registerFieldsToInclude:Gc,enableFetchAllFields:Jc,disableFetchAllFields:Zc,fetchFieldsDescription:Kc}}function ol(e){return e.addReducers({recommendation:Ru}),{getRecommendations:Au,setRecommendationId:ku}}var al=_r("breadcrumb/deselectAll"),sl=_r("breadcrumb/deselectAllNonBreadcrumbs");var ul={value:wn,numberOfResults:new z({min:0}),state:wn};var cl=wn;var ll=new z({min:1,default:8,required:!1}),dl=new z({min:1,max:20,default:5,required:!1}),hl={desiredCount:dl,numberOfValues:ll};_r("automaticFacet/setOptions",(e=>An(e,hl)));_r("automaticFacet/deselectAll",(e=>An(e,cl)));var fl=wn,pl=_r("automaticFacet/toggleSelectValue",(e=>An(e,{field:fl,selection:new ee({values:ul})})));var vl={state:new Q({required:!0}),numberOfResults:new z({required:!0,min:0}),value:new K({required:!0,emptyAllowed:!0}),path:new re({required:!0,each:wn}),moreValuesAvailable:new W({required:!1})};function yl(e){e.children.forEach((e=>{yl(e)})),kn({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},vl)}var gl={facetId:cl,field:wn,delimitingCharacter:new K({required:!1,emptyAllowed:!0}),filterFacetCount:new W({required:!1}),injectionDepth:new z({required:!1,min:0}),numberOfValues:new z({required:!1,min:1}),sortCriteria:new Q({required:!1}),basePath:new re({required:!1,each:wn}),filterByBasePath:new W({required:!1})};_r("categoryFacet/register",(e=>An(e,gl)));var ml=_r("categoryFacet/toggleSelectValue",(e=>{try{return kn(e.facetId,wn),yl(e.selection),{payload:e,error:null}}catch(t){return{payload:e,error:On(t)}}})),wl=_r("categoryFacet/deselectAll",(e=>An(e,gl.facetId)));_r("categoryFacet/updateNumberOfValues",(e=>An(e,{facetId:gl.facetId,numberOfValues:gl.numberOfValues})));_r("categoryFacet/updateSortCriterion",(e=>An(e,{facetId:gl.facetId,criterion:new Q})));_r("categoryFacet/updateBasePath",(e=>An(e,{facetId:gl.facetId,basePath:new re({each:wn})})));var bl={facetId:cl,captions:new ee({options:{required:!1}}),numberOfValues:new z({required:!1,min:1}),query:new K({required:!1,emptyAllowed:!0})};var Sl={path:new re({required:!0,each:wn}),displayValue:Sn,rawValue:Sn,count:new z({required:!0,min:0})},Il=_r("categoryFacet/selectSearchResult",(e=>An(e,{facetId:cl,value:new ee({values:Sl})})));_r("categoryFacetSearch/register",(e=>An(e,bl)));var ql={facetId:cl,value:new ee({values:{displayValue:Sn,rawValue:Sn,count:new z({required:!0,min:0})}})};_r("facetSearch/register",(e=>An(e,bl)));_r("facetSearch/update",(e=>An(e,bl)));var Ol=_r("facetSearch/toggleSelectValue",(e=>An(e,ql))),kl=_r("facetSearch/toggleExcludeValue",(e=>An(e,ql)));var Al=d(j()),Cl=d(x());Al.default.extend(Cl.default);var jl="YYYY/MM/DD@HH:mm:ss",Rl="1401-01-01";function Dl(e,t){let r=(0,Al.default)(e,t);return!r.isValid()&&!t?(0,Al.default)(e,jl):r}function Ml(e){return e.format(jl)}function El(e,t){let r=Dl(e,t);if(!r.isValid()){let r=". Please provide a date format string in the configuration options. See https://day.js.org/docs/en/parse/string-format for more information.",n=` with the format "${t}"`;throw new Error(`Could not parse the provided date "${e}"${t?n:r}`)}xl(r)}function xl(e){if(e.isBefore(Rl))throw new Error(`Date is before year 1401, which is unsupported by the API: ${e}`)}var Tl=d(j()),Ul=d(T());Tl.default.extend(Ul.default);var Fl=["past","now","next"],$l=["minute","hour","day","week","month","quarter","year"],Pl=e=>{let t=e==="now";return{amount:new z({required:!t,min:1}),unit:new K({required:!t,constrainTo:$l}),period:new K({required:!0,constrainTo:Fl})}};function _l(e){if(typeof e=="string"&&!Yl(e))throw new Error(`The value "${e}" is not respecting the relative date format "period-amount-unit"`);let t=typeof e=="string"?Hl(e):e;new V(Pl(t.period)).validate(t);let r=Ql(t),n=JSON.stringify(t);if(!r.isValid())throw new Error(`Date is invalid: ${n}`);xl(r)}function Vl(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":case"next":return`${t}-${r}-${n}`;case"now":return t}}function Ql(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":return(0,Tl.default)().subtract(r,n);case"next":return(0,Tl.default)().add(r,n);case"now":return(0,Tl.default)()}}function Ll(e){return Ml(Ql(Hl(e)))}function Nl(e){return e.toLocaleLowerCase().split("-")}function Yl(e){let[t,r,n]=Nl(e);if(t==="now")return!0;if(!Fl.includes(t)||!$l.includes(n))return!1;let i=parseInt(r);return!(isNaN(i)||i<=0)}function zl(e){return!!e&&typeof e=="object"&&"period"in e}function Hl(e){let[t,r,n]=Nl(e);return t==="now"?{period:"now"}:{period:t,amount:r?parseInt(r):void 0,unit:n||void 0}}function Bl(e){let t=Wl(e.start,e),r=Wl(e.end,e),n=e.endInclusive??!1,i=e.state??"idle";return{start:t,end:r,endInclusive:n,state:i}}function Wl(e,t){let{dateFormat:r}=t;return zl(e)?(_l(e),Vl(e)):typeof e=="string"&&Yl(e)?(_l(e),e):(El(e,r),Ml(Dl(e,r)))}new K({regex:/^[a-zA-Z0-9-_]+$/});new K({required:!0});new re({each:new K});new K;new W;new W;new z({min:0});var Gl=new z({min:1});new W({required:!0});var Jl=new ee,Zl=new K,Kl={captions:Jl,numberOfValues:Gl,query:Zl};new ee({values:Kl});var Xl=new ee({options:{required:!1},values:{type:new K({constrainTo:["simple"],emptyAllowed:!1,required:!0}),values:new re({required:!0,max:25,each:new K({emptyAllowed:!1,required:!0})})}});new W;var ed=new re({min:1,max:25,required:!1,each:new K({emptyAllowed:!1,required:!0})});var td={facetId:cl,field:new K({required:!0,emptyAllowed:!0}),filterFacetCount:new W({required:!1}),injectionDepth:new z({required:!1,min:0}),numberOfValues:new z({required:!1,min:1}),sortCriteria:new Q({required:!1}),resultsMustMatch:new Q({required:!1}),allowedValues:Xl,customSort:ed};_r("facet/register",(e=>An(e,td)));var rd=_r("facet/toggleSelectValue",(e=>An(e,{facetId:cl,selection:new ee({values:ul})}))),nd=_r("facet/toggleExcludeValue",(e=>An(e,{facetId:cl,selection:new ee({values:ul})}))),id=_r("facet/deselectAll",(e=>An(e,cl)));_r("facet/updateSortCriterion",(e=>An(e,{facetId:cl,criterion:new Q({required:!0})})));_r("facet/updateNumberOfValues",(e=>An(e,{facetId:cl,numberOfValues:new z({required:!0,min:1})})));_r("facet/updateIsFieldExpanded",(e=>An(e,{facetId:cl,isFieldExpanded:new W({required:!0})})));_r("facet/updateFreezeCurrentValues",(e=>An(e,{facetId:cl,freezeCurrentValues:new W({required:!0})})));_r("rangeFacet/updateSortCriterion",(e=>An(e,{facetId:cl,criterion:new Q({required:!0})})));var od={state:wn,start:new z({required:!0}),end:new z({required:!0}),endInclusive:new W({required:!0}),numberOfResults:new z({required:!0,min:0})},ad={start:wn,end:wn,endInclusive:new W({required:!0}),state:wn,numberOfResults:new z({required:!0,min:0})};var sd={start:wn,end:wn,endInclusive:new W({required:!0}),state:wn},ud={facetId:cl,field:wn,currentValues:new re({required:!1,each:new ee({values:sd})}),generateAutomaticRanges:new W({required:!0}),filterFacetCount:new W({required:!1}),injectionDepth:new z({required:!1,min:0}),numberOfValues:new z({required:!1,min:1}),sortCriteria:new Q({required:!1}),rangeAlgorithm:new Q({required:!1})};function cd(e){return Yl(e)?Ll(e):e}function ld(e){e.currentValues&&e.currentValues.forEach((e=>{let{start:t,end:r}=Bl(e);if(Dl(cd(t)).isAfter(Dl(cd(r))))throw new Error(`The start value is greater than the end value for the date range ${e.start} to ${e.end}`)}))}_r("dateFacet/register",(e=>{try{return kn(e,ud),ld(e),{payload:e,error:null}}catch(t){return{payload:e,error:On(t)}}}));var dd=_r("dateFacet/toggleSelectValue",(e=>An(e,{facetId:cl,selection:new ee({values:ad})}))),hd=_r("dateFacet/toggleExcludeValue",(e=>An(e,{facetId:cl,selection:new ee({values:ad})}))),fd=_r("dateFacet/updateFacetValues",(e=>{try{return kn(e,{facetId:cl,values:new re({each:new ee({values:ad})})}),ld({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:On(t)}}}));var pd={state:wn,start:new z({required:!0}),end:new z({required:!0}),endInclusive:new W({required:!0})},vd={facetId:cl,field:wn,currentValues:new re({required:!1,each:new ee({values:pd})}),generateAutomaticRanges:new W({required:!0}),filterFacetCount:new W({required:!1}),injectionDepth:new z({required:!1,min:0}),numberOfValues:new z({required:!1,min:1}),sortCriteria:new Q({required:!1}),rangeAlgorithm:new Q({required:!1})};function yd(e){e.currentValues&&e.currentValues.forEach((({start:e,end:t})=>{if(e>t)throw new Error(`The start value is greater than the end value for the numeric range ${e} to ${t}`)}))}_r("numericFacet/register",(e=>{try{return An(e,vd),yd(e),{payload:e,error:null}}catch(t){return{payload:e,error:On(t)}}}));var gd=_r("numericFacet/toggleSelectValue",(e=>An(e,{facetId:cl,selection:new ee({values:od})}))),md=_r("numericFacet/toggleExcludeValue",(e=>An(e,{facetId:cl,selection:new ee({values:od})}))),wd=_r("numericFacet/updateFacetValues",(e=>{try{return kn(e,{facetId:cl,values:new re({each:new ee({values:od})})}),yd({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:On(t)}}}));var bd=e=>e.error!==void 0;function Sd(e,t){let r={};e.forEach((e=>r[e.facetId]=e));let n=[];t.forEach((e=>{e in r&&(n.push(r[e]),delete r[e])}));let i=Object.values(r);return[...n,...i]}function Id(e){return Object.values(e).map((e=>e.request))}var qd=()=>au("search/logFetchMoreResults",(e=>e.makeFetchMoreResults())),Od=e=>au("search/queryError",((t,r)=>t.makeQueryError({query:r.query?.q||os().q,aq:r.advancedSearchQueries?.aq||Ec().aq,cq:r.advancedSearchQueries?.cq||Ec().cq,dq:r.advancedSearchQueries?.dq||Ec().dq,errorType:e.type,errorMessage:e.message})));var kd=(e=>(e.Relevance="relevance",e.Fields="fields",e))(kd||{}),Ad=(e=>(e.Ascending="asc",e.Descending="desc",e))(Ad||{});new ee({options:{required:!1},values:{by:new ie({enum:kd,required:!0}),fields:new re({each:new ee({values:{name:new K,direction:new ie({enum:Ad})}})})}});var Cd=()=>su("analytics/productListing/load",(e=>e.makeInterfaceLoad()),(e=>new Ws(e)));_r("productlisting/setUrl",(e=>An(e,{url:new K({required:!0,url:!0})})));_r("productlisting/setAdditionalFields",(e=>An(e,{additionalFields:new re({required:!0,each:new K({required:!0,emptyAllowed:!1})})})));var jd=cn("productlisting/fetch",(async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:i})=>{let o=t(),{apiClient:a}=i,s=await a.getProducts(await Rd(o));return bd(s)?(r(Od(s.error)),n(s.error)):{response:s.success,analyticsAction:Cd()}})),Rd=async e=>{let t=Md(e),r=await ja(e.configuration.analytics);return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,platformUrl:e.configuration.platformUrl,url:e.productListing?.url,...e.configuration.analytics.enabled&&r?{clientId:r}:{},...e.productListing.additionalFields?.length?{additionalFields:e.productListing.additionalFields}:{},...e.productListing.advancedParameters&&Dd(e.productListing.advancedParameters)?{advancedParameters:e.productListing.advancedParameters||{}}:{},...t.length&&{facets:{requests:t}},...e.pagination&&{pagination:{numberOfValues:e.pagination.numberOfResults,page:Math.ceil(e.pagination.firstResult/(e.pagination.numberOfResults||1))+1}},...(e.sort?.by||"relevance")!=="relevance"&&{sort:e.sort},...e.context&&{userContext:e.context.contextValues}}};function Dd(e){return e.debug}function Md(e){return Sd(Ed(e),e.facetOrder??[])}function Ed(e){return[...Id(e.facetSet??{}),...Id(e.numericFacetSet??{}),...Id(e.dateFacetSet??{}),...Id(e.categoryFacetSet??{})]}var xd=_r("facet/updateFacetAutoSelection",(e=>An(e,{allow:new W({required:!0})})));var Td=class extends vs{constructor(e){super(e);this.getState=e}get activeInstantResultQuery(){let e=this.getState().instantResults;for(let t in e)for(let r in e[t].cache)if(e[t].cache[r].isActive)return e[t].q;return null}get activeInstantResultCache(){let e=this.getState().instantResults;for(let t in e)for(let r in e[t].cache)if(e[t].cache[r].isActive)return e[t].cache[r];return null}get results(){return this.activeInstantResultCache?.results}get queryText(){return this.activeInstantResultQuery??os().q}get responseTime(){return this.activeInstantResultCache?.duration??ge().duration}get numberOfResults(){return this.activeInstantResultCache?.totalCountFiltered??ge().response.totalCountFiltered}getSearchUID(){return this.activeInstantResultCache?.searchUid||super.getSearchUID()}};var Ud=()=>au("analytics/instantResult/searchboxAsYouType",(e=>e.makeSearchboxAsYouType()),(e=>new Td(e))),Fd=()=>({actionCause:"searchboxAsYouType"});var $d={id:wn},Pd={...$d,q:Sn};_r("instantResults/register",(e=>An(e,$d)));var _d=_r("instantResults/updateQuery",(e=>An(e,Pd)));_r("instantResults/clearExpired",(e=>An(e,$d)));var Vd=new z({required:!0,min:0}),Qd=_r("pagination/registerNumberOfResults",(e=>An(e,Vd))),Ld=_r("pagination/updateNumberOfResults",(e=>An(e,Vd))),Nd=_r("pagination/registerPage",(e=>An(e,Vd))),Yd=_r("pagination/updatePage",(e=>An(e,Vd))),zd=_r("pagination/nextPage"),Hd=_r("pagination/previousPage");var Bd=_r("query/updateQuery",(e=>An(e,{q:new K,enableQuerySyntax:new W})));function Wd(e){return e.type==="dateRange"}function Gd(e){return`start${e}`}function Jd(e){return`end${e}`}var Zd=()=>({dateFacetValueMap:{}});function Kd(e,t,r){let n=e.start,i=e.end;return Yl(n)&&(n=Ll(n),r.dateFacetValueMap[t][Gd(n)]=e.start),Yl(i)&&(i=Ll(i),r.dateFacetValueMap[t][Jd(i)]=e.end),{...e,start:n,end:i}}function Xd(e,t){if(Wd(e)){let{facetId:r,currentValues:n}=e;return t.dateFacetValueMap[r]={},{...e,currentValues:n.map((e=>Kd(e,r,t)))}}return e}function eh(e){let t=Zd();return{request:{...e,facets:e.facets?.map((e=>Xd(e,t)))},mappings:t}}function th(e,t,r){return{...e,start:r.dateFacetValueMap[t][Gd(e.start)]||e.start,end:r.dateFacetValueMap[t][Jd(e.end)]||e.end}}function rh(e,t){return e.facetId in t.dateFacetValueMap}function nh(e,t){return rh(e,t)?{...e,values:e.values.map((r=>th(r,e.facetId,t)))}:e}function ih(e,t){return"success"in e?{success:{...e.success,facets:e.success.facets?.map((e=>nh(e,t)))}}:e}var oh=async(e,t)=>{let r=fh(e),n=ah(e),i=sh(e),o=e.configuration.analytics.analyticsMode==="legacy"?await Nc(e,t):await Yc(e,t),a=()=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0;return eh({...o,...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="next",options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="legacy"},...r&&{cq:r},...n.length&&{facets:n},...e.pagination&&{numberOfResults:a(),firstResult:e.pagination.firstResult},...e.facetOptions&&{facetOptions:{freezeFacetOrder:e.facetOptions.freezeFacetOrder}},...e.folding?.enabled&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.automaticFacetSet&&{generateAutomaticFacets:{desiredCount:e.automaticFacetSet.desiredCount,numberOfValues:e.automaticFacetSet.numberOfValues,currentFacets:i}},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})};function ah(e){return Sd(ch(e),e.facetOrder??[])}function sh(e){let t=e.automaticFacetSet?.set;return t?Object.values(t).map((e=>e.response)).map(uh).filter((e=>e.currentValues.length>0)):void 0}function uh(e){let{field:t,label:r,values:n}=e,i=n.filter((e=>e.state==="selected"));return{field:t,label:r,currentValues:i}}function ch(e){return lh(e).filter((({facetId:t})=>e.facetOptions?.facets[t]?.enabled??!0))}function lh(e){return[...dh(e.facetSet??{}),...hh(e.numericFacetSet??{}),...hh(e.dateFacetSet??{}),...Id(e.categoryFacetSet??{})]}function dh(e){return Id(e).map((e=>e.sortCriteria==="alphanumericDescending"?{...e,sortCriteria:{type:"alphanumeric",order:"descending"}}:e))}function hh(e){return Id(e).map((e=>{let t=e.currentValues.some((({state:e})=>e!=="idle"));return e.generateAutomaticRanges&&!t?{...e,currentValues:[]}:e}))}function fh(e){let t=e.advancedSearchQueries?.cq.trim()||"",r=Object.values(e.tabSet||{}).find((e=>e.isActive))?.expression.trim()||"",n=ph(e);return[t,r,...n].filter((e=>!!e)).join(" AND ")}function ph(e){return Object.values(e.staticFilterSet||{}).map((e=>{let t=e.values.filter((e=>e.state==="selected"&&!!e.expression.trim())),r=t.map((e=>e.expression)).join(" OR ");return t.length>1?`(${r})`:r}))}_r("didYouMean/enable");_r("didYouMean/disable");_r("didYouMean/automaticCorrections/disable");_r("didYouMean/automaticCorrections/enable");var vh=_r("didYouMean/correction",(e=>An(e,wn)));_r("didYouMean/automaticCorrections/mode",(e=>An(e,new K({constrainTo:["next","legacy"],emptyAllowed:!1,required:!0}))));var yh=()=>au("analytics/didyoumean/automatic",(e=>e.makeDidYouMeanAutomatic()));var gh=()=>({actionCause:"didyoumeanAutomatic"});function mh(){return{freezeFacetOrder:!1,facets:{}}}function wh(){return[]}function bh(){return{firstResult:0,defaultNumberOfResults:10,numberOfResults:10,totalCountFiltered:0}}function Sh(){return{}}function Ih(){return{}}function qh(){return{}}function Oh(e){return{context:e.context||Pc(),dictionaryFieldContext:e.dictionaryFieldContext||Lc(),facetSet:e.facetSet||La(),numericFacetSet:e.numericFacetSet||Qa(),dateFacetSet:e.dateFacetSet||Va(),categoryFacetSet:e.categoryFacetSet||_a(),automaticFacetSet:e.automaticFacetSet??xa(),pagination:e.pagination||bh(),query:e.query||os(),tabSet:e.tabSet||qh(),advancedSearchQueries:e.advancedSearchQueries||Ec(),staticFilterSet:e.staticFilterSet||Ih(),querySet:e.querySet||Sh(),sortCriteria:e.sortCriteria||ls(),pipeline:e.pipeline||Kn(),searchHub:e.searchHub||ds(),facetOptions:e.facetOptions||mh(),facetOrder:e.facetOrder??wh(),debug:e.debug??zn()}}new ee({values:{undoneQuery:Sn},options:{required:!0}});var kh=()=>au("analytics/trigger/query",((e,t)=>t.triggers?.queryModification.newQuery?e.makeTriggerQuery():null));var Ah=_r("trigger/query/ignore",(e=>An(e,new K({emptyAllowed:!0,required:!0})))),Ch=_r("trigger/query/modification",(e=>An(e,new ee({values:{originalQuery:bn,modification:bn}}))));var jh=class{constructor(e,t=(e=>{this.dispatch(Bd({q:e}))})){this.config=e;this.onUpdateQueryForCorrection=t}async fetchFromAPI({mappings:e,request:t},r){let n=(new Date).getTime(),i=ih(await this.extra.apiClient.search(t,r),e),o=(new Date).getTime()-n,a=this.getState().query?.q||"";return{response:i,duration:o,queryExecuted:a,requestExecuted:t}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return tt(e.response)?(this.dispatch(Od(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:i}=t.didYouMean,{results:o,queryCorrections:a,queryCorrection:s}=r;if(!n||!i)return null;let u=o.length===0&&a&&a.length!==0,c=!Y(s)&&!Y(s.correctedQuery);if(!u&&!c)return null;let l=u?await this.processLegacyDidYouMeanAutoCorrection(e):this.processModernDidYouMeanAutoCorrection(e);return this.dispatch(Jn(Oh(this.getState()))),l}async processLegacyDidYouMeanAutoCorrection(e){let t=this.getCurrentQuery(),r=this.getSuccessResponse(e);if(!r.queryCorrections)return null;let{correctedQuery:n}=r.queryCorrections[0],i=await this.automaticallyRetryQueryWithCorrection(n);return tt(i.response)?(this.dispatch(Od(i.response.error)),this.rejectWithValue(i.response.error)):(this.logOriginalAnalyticsQueryBeforeAutoCorrection(e),this.dispatch(Jn(Oh(this.getState()))),{...i,response:{...i.response.success,queryCorrections:r.queryCorrections},automaticallyCorrected:!0,originalQuery:t,analyticsAction:yh()})}processModernDidYouMeanAutoCorrection(e){let t=this.getSuccessResponse(e),{correctedQuery:r,originalQuery:n}=t.queryCorrection;return this.onUpdateQueryForCorrection(r),{...e,response:{...t},queryExecuted:r,automaticallyCorrected:!0,originalQuery:n,analyticsAction:yh()}}logOriginalAnalyticsQueryBeforeAutoCorrection(e){let t=this.getState(),r=this.getSuccessResponse(e);this.analyticsAction&&this.analyticsAction()(this.dispatch,(()=>this.getStateAfterResponse(e.queryExecuted,e.duration,t,r)),this.extra)}async processQueryTriggersOrContinue(e){let t=this.getSuccessResponse(e);if(!t)return null;let r=t.triggers.find((e=>e.type==="query"))?.content||"";if(!r)return null;if(this.getState().triggers?.queryModification.queryToIgnore===r)return this.dispatch(Ah("")),null;this.analyticsAction&&await this.dispatch(this.analyticsAction);let n=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(r);return tt(i.response)?(this.dispatch(Od(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(Jn(Oh(this.getState()))),{...i,response:{...i.response.success},automaticallyCorrected:!1,originalQuery:n,analyticsAction:kh()})}getStateAfterResponse(e,t,r,n){return{...r,query:{q:e,enableQuerySyntax:r.query?.enableQuerySyntax??os().enableQuerySyntax},search:{...ge(),duration:t,response:n,results:n.results}}}processSuccessResponse(e){return this.dispatch(Jn(Oh(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(e){return et(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let t=await this.fetchFromAPI(await oh(this.getState()),{origin:"mainSearch"});return this.dispatch(vh(e)),t}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(Ch({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await oh(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){let e=this.getState();return e.query?.q!==void 0?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get analyticsAction(){return this.config.analyticsAction}get rejectWithValue(){return this.config.rejectWithValue}};cn("search/prepareForSearchWithQuery",((e,t)=>{let{dispatch:r}=t;An(e,{q:new K,enableQuerySyntax:new W,clearFilters:new W}),e.clearFilters&&(r(al()),r(sl())),r(xd({allow:!0})),r(Bd({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(Yd(1))}));cn("search/executeSearch",(async(e,t)=>{let r=t.getState();return await $h(r,t,e)}));cn("search/fetchPage",(async(e,t)=>{let r=t.getState();return await Th(r,t,e)}));cn("search/fetchMoreResults",(async(e,t)=>{let r=t.getState();return await Uh(t,r)}));cn("search/fetchFacetValues",(async(e,t)=>{let r=t.getState();return await Fh(t,e,r)}));cn("search/fetchInstantResults",(async(e,t)=>xh(e,t)));var Rh=async(e,t)=>{let r=await oh(e,t);return r.request={...r.request,firstResult:(e.pagination?.firstResult??0)+(e.search?.results.length??0)},r},Dh=async(e,t,r)=>{let n=await Nc(e);return eh({...n,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},Mh=async(e,t)=>{let r=await oh(e,t);return r.request.numberOfResults=0,r},Eh=e=>{e.configuration.analytics.enabled&&Ra.addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)})};async function xh(e,t){An(e,{id:wn,q:wn,maxResultsPerQuery:new z({required:!0,min:1}),cacheTimeout:new z});let{q:r,maxResultsPerQuery:n}=e,i=t.getState(),o=new jh({...t,analyticsAction:Ud()},(r=>{t.dispatch(_d({q:r,id:e.id}))})),a=await Dh(i,r,n),s=await o.fetchFromAPI(a,{origin:"instantResults",disableAbortWarning:!0}),u=await o.process(s);return"response"in u?{results:u.response.results,searchUid:u.response.searchUid,analyticsAction:u.analyticsAction,totalCountFiltered:u.response.totalCountFiltered,duration:u.duration}:u}async function Th(e,t,r){Eh(e);let{analyticsClientMiddleware:n,preprocessRequest:i,logger:o}=t.extra,{description:a}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:i,logger:o}),s=new jh({...t,analyticsAction:r}),u=await oh(e,a),c=await s.fetchFromAPI(u,{origin:"mainSearch"});return await s.process(c)}async function Uh(e,t){let{analyticsClientMiddleware:r,preprocessRequest:n,logger:i}=e.extra,{description:o}=await qd().prepare({getState:()=>e.getState(),analyticsClientMiddleware:r,preprocessRequest:n,logger:i}),a=new jh({...e,analyticsAction:qd()}),s=await Rh(t,o),u=await a.fetchFromAPI(s,{origin:"mainSearch"});return await a.process(u)}async function Fh(e,t,r){let{analyticsClientMiddleware:n,preprocessRequest:i,logger:o}=e.extra,{description:a}=await t.prepare({getState:()=>e.getState(),analyticsClientMiddleware:n,preprocessRequest:i,logger:o}),s=new jh({...e,analyticsAction:t}),u=await Mh(r,a),c=await s.fetchFromAPI(u,{origin:"facetValues"});return await s.process(c)}async function $h(e,t,r){Eh(e);let{analyticsClientMiddleware:n,preprocessRequest:i,logger:o}=t.extra,{description:a}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:i,logger:o}),s=await oh(e,a),u=new jh({...t,analyticsAction:r}),c=await u.fetchFromAPI(s,{origin:"mainSearch"});return await u.process(c)}var Ph=class{constructor(e,t=(e=>{this.dispatch(Bd({q:e}))})){this.config=e;this.onUpdateQueryForCorrection=t}async fetchFromAPI({mappings:e,request:t},r){let n=(new Date).getTime(),i=ih(await this.extra.apiClient.search(t,r),e),o=(new Date).getTime()-n,a=this.getState().query?.q||"";return{response:i,duration:o,queryExecuted:a,requestExecuted:t}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return tt(e.response)?(this.dispatch(Od(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:i}=t.didYouMean,{results:o,queryCorrections:a,queryCorrection:s}=r;if(!n||!i)return null;let u=o.length===0&&a&&a.length!==0,c=!Y(s)&&!Y(s.correctedQuery);if(!u&&!c)return null;let l=u?await this.processLegacyDidYouMeanAutoCorrection(e):this.processModernDidYouMeanAutoCorrection(e);return this.dispatch(Jn(Oh(this.getState()))),l}async processLegacyDidYouMeanAutoCorrection(e){let t=this.getCurrentQuery(),r=this.getSuccessResponse(e);if(!r.queryCorrections)return null;let{correctedQuery:n}=r.queryCorrections[0],i=await this.automaticallyRetryQueryWithCorrection(n);return tt(i.response)?(this.dispatch(Od(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(Jn(Oh(this.getState()))),{...i,response:{...i.response.success,queryCorrections:r.queryCorrections},automaticallyCorrected:!0,originalQuery:t})}processModernDidYouMeanAutoCorrection(e){let t=this.getSuccessResponse(e),{correctedQuery:r,originalQuery:n}=t.queryCorrection;return this.onUpdateQueryForCorrection(r),{...e,response:{...t},queryExecuted:r,automaticallyCorrected:!0,originalQuery:n}}async processQueryTriggersOrContinue(e){let t=this.getSuccessResponse(e);if(!t)return null;let r=t.triggers.find((e=>e.type==="query"))?.content||"";if(!r)return null;if(this.getState().triggers?.queryModification.queryToIgnore===r)return this.dispatch(Ah("")),null;let n=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(r);return tt(i.response)?(this.dispatch(Od(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(Jn(Oh(this.getState()))),{...i,response:{...i.response.success},automaticallyCorrected:!1,originalQuery:n})}processSuccessResponse(e){return this.dispatch(Jn(Oh(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery()}}getSuccessResponse(e){return et(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let t=this.getState(),{actionCause:r}=gh(),n=await this.fetchFromAPI(await oh(t,{actionCause:r}),{origin:"mainSearch"});return this.dispatch(vh(e)),n}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(Ch({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await oh(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){let e=this.getState();return e.query?.q!==void 0?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}};cn("search/prepareForSearchWithQuery",((e,t)=>{let{dispatch:r}=t;An(e,{q:new K,enableQuerySyntax:new W,clearFilters:new W}),e.clearFilters&&(r(al()),r(sl())),r(xd({allow:!0})),r(Bd({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(Yd(1))}));var _h=cn("search/executeSearch",(async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return $h(r,t,e.legacy);Nh(r);let n=Yh(e.next),i=await oh(r,n),o=new Ph({...t,analyticsAction:n}),a=await o.fetchFromAPI(i,{origin:"mainSearch"});return await o.process(a)}));cn("search/fetchPage",(async(e,t)=>{let r=t.getState();if(Nh(r),r.configuration.analytics.analyticsMode==="legacy"||!e.next)return Th(r,t,e.legacy);let n=new Ph({...t,analyticsAction:e.next}),i=await oh(r,e.next),o=await n.fetchFromAPI(i,{origin:"mainSearch"});return await n.process(o)}));cn("search/fetchMoreResults",(async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return Uh(t,r);let n=Ks("pagerScrolling",t.getState),i=new Ph({...t,analyticsAction:n}),o=await Vh(r,n),a=await i.fetchFromAPI(o,{origin:"mainSearch"});return await i.process(a)}));cn("search/fetchFacetValues",(async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!e.next)return $h(r,t,e.legacy);let n=Yh(e.next),i=new Ph({...t,analyticsAction:n}),o=await Lh(r,n),a=await i.fetchFromAPI(o,{origin:"facetValues"});return await i.process(a)}));cn("search/fetchInstantResults",(async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return xh(e,t);An(e,{id:wn,q:wn,maxResultsPerQuery:new z({required:!0,min:1}),cacheTimeout:new z});let{q:n,maxResultsPerQuery:i}=e,o=Yh(Fd()),a=await Qh(r,n,i,o),s=new Ph({...t,analyticsAction:o},(r=>{t.dispatch(_d({q:r,id:e.id}))})),u=await s.fetchFromAPI(a,{origin:"instantResults",disableAbortWarning:!0}),c=await s.process(u);return"response"in c?{results:c.response.results,searchUid:c.response.searchUid,totalCountFiltered:c.response.totalCountFiltered,duration:c.duration}:c}));var Vh=async(e,t)=>{let r=await oh(e,t);return r.request={...r.request,firstResult:(e.pagination?.firstResult??0)+(e.search?.results.length??0)},r},Qh=async(e,t,r,n)=>{let i=await Yc(e,n);return eh({...i,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},Lh=async(e,t)=>{let r=await oh(e,t);return r.request.numberOfResults=0,r},Nh=e=>{e.configuration.analytics.enabled&&Ra.addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)})},Yh=e=>({actionCause:e.actionCause,type:e.actionCause});var zh=Xr(bh(),(e=>{e.addCase(Qd,((e,t)=>{let r=Bh(e),n=t.payload;e.defaultNumberOfResults=e.numberOfResults=n,e.firstResult=Gh(r,n)})).addCase(Ld,((e,t)=>{e.numberOfResults=t.payload,e.firstResult=0})).addCase(Pu,(e=>{e.firstResult=0})).addCase(Nd,((e,t)=>{let r=t.payload;e.firstResult=Gh(r,e.numberOfResults)})).addCase(Yd,((e,t)=>{let r=t.payload;e.firstResult=Gh(r,e.numberOfResults)})).addCase(Hd,(e=>{let t=Bh(e),r=Math.max(t-1,1);e.firstResult=Gh(r,e.numberOfResults)})).addCase(zd,(e=>{let t=Bh(e),r=Wh(e),n=Math.min(t+1,r);e.firstResult=Gh(n,e.numberOfResults)})).addCase(Zn.fulfilled,((e,t)=>{t.payload&&(e.numberOfResults=t.payload.pagination.numberOfResults,e.firstResult=t.payload.pagination.firstResult)})).addCase(Ln,((e,t)=>{e.firstResult=t.payload.firstResult??e.firstResult,e.numberOfResults=t.payload.numberOfResults??e.defaultNumberOfResults})).addCase(_h.fulfilled,((e,t)=>{let{response:r}=t.payload;e.totalCountFiltered=r.totalCountFiltered})).addCase(jd.fulfilled,((e,t)=>{let{response:r}=t.payload;e.totalCountFiltered=r.pagination.totalCount})).addCase(id,(e=>{Hh(e)})).addCase(hd,(e=>{Hh(e)})).addCase(nd,(e=>{Hh(e)})).addCase(md,(e=>{Hh(e)})).addCase(kl,(e=>{Hh(e)})).addCase(rd,(e=>{Hh(e)})).addCase(wl,(e=>{Hh(e)})).addCase(ml,(e=>{Hh(e)})).addCase(Il,(e=>{Hh(e)})).addCase(dd,(e=>{Hh(e)})).addCase(gd,(e=>{Hh(e)})).addCase(al,(e=>{Hh(e)})).addCase(fd,(e=>{Hh(e)})).addCase(wd,(e=>{Hh(e)})).addCase(Ol,(e=>{Hh(e)})).addCase(pl,(e=>{Hh(e)}))}));function Hh(e){e.firstResult=bh().firstResult}function Bh(e){let{firstResult:t,numberOfResults:r}=e;return Jh(t,r)}function Wh(e){let{totalCountFiltered:t,numberOfResults:r}=e;return Zh(t,r)}function Gh(e,t){return(e-1)*t}function Jh(e,t){return Math.round(e/t)+1}function Zh(e,t){let r=Math.min(e,5e3);return Math.ceil(r/t)}function Kh(e){return e.addReducers({pagination:zh}),{nextPage:zd,previousPage:Hd,registerNumberOfResults:Qd,registerPage:Nd,updateNumberOfResults:Ld,updatePage:Yd}}function Xh(e){let t,r=new Map,n=()=>r.size===0,i=e=>{try{let r=JSON.stringify(e),n=t!==r;return t=r,n}catch(e){return console.warn('Could not detect if state has changed, check the controller "get state method"',e),!0}};return{subscribe(o){o();let a=Symbol(),s;return n()&&(t=JSON.stringify(this.state),s=e.subscribe((()=>{i(this.state)&&r.forEach((e=>e()))}))),r.set(a,o),()=>{r.delete(a),n()&&s&&s()}},get state(){return{}}}}var ef=new V({id:new K({emptyAllowed:!0,required:!1,default:""}),numberOfRecommendations:new z({min:0})});function tf(e,t={}){if(!rf(e));let r=Xh(e),{dispatch:n}=e,i=()=>e.state,o=Cn(e,ef,t.options,"buildRecommendationList");return o.id!==""&&n(ku({id:o.id})),o.numberOfRecommendations&&n(Kh(e).updateNumberOfResults(o.numberOfRecommendations)),{...r,refresh(){n(Au())},get state(){let e=i();return{recommendations:e.recommendation.recommendations,error:e.recommendation.error,isLoading:e.recommendation.isLoading,searchResponseId:e.recommendation.searchUid}}}}function rf(e){return e.addReducers({recommendation:Ru,configuration:Bu}),!0}function nf(e,t,r){if(!of(e));let n=1e3,i={selectionDelay:n,debounceWait:n,...t.options},o;return{select:tc(r,i.debounceWait,{isImmediate:!0}),beginDelayedSelect(){o=setTimeout(r,i.selectionDelay)},cancelPendingSelect(){o&&clearTimeout(o)}}}function of(e){return e.addReducers({configuration:Bu}),!0}function af(e,t){let r=!1,n=()=>{r||(r=!0,e.dispatch(Ou(t.options.result)))};return nf(e,t,(()=>{n()}))}new V({values:new ee({options:{required:!1}})});new V({content:new Q({required:!0}),conditions:new Q({required:!0}),priority:new z({required:!1,default:0,min:0}),fields:new re({required:!1,each:wn})});F();
/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */export{tf as F,tl as I,ol as O,jc as _,Cc as a,Oc as b,af as c,Ue as g,il as p};
//# sourceMappingURL=p-7da6179c.js.map